var Tee=Object.defineProperty;var kee=(t,e,r)=>e in t?Tee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Pee=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var cT=(t,e,r)=>kee(t,typeof e!="symbol"?e+"":e,r);var Ott=Pee((vrt,lb)=>{function Aee(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var L1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var OU={exports:{}},lE={},MU={exports:{}},kt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ny=Symbol.for("react.element"),Iee=Symbol.for("react.portal"),Oee=Symbol.for("react.fragment"),Mee=Symbol.for("react.strict_mode"),Nee=Symbol.for("react.profiler"),Dee=Symbol.for("react.provider"),Fee=Symbol.for("react.context"),Hee=Symbol.for("react.forward_ref"),Lee=Symbol.for("react.suspense"),$ee=Symbol.for("react.memo"),Bee=Symbol.for("react.lazy"),H$=Symbol.iterator;function Vee(t){return t===null||typeof t!="object"?null:(t=H$&&t[H$]||t["@@iterator"],typeof t=="function"?t:null)}var NU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},DU=Object.assign,FU={};function Rp(t,e,r){this.props=t,this.context=e,this.refs=FU,this.updater=r||NU}Rp.prototype.isReactComponent={};Rp.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Rp.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function HU(){}HU.prototype=Rp.prototype;function R2(t,e,r){this.props=t,this.context=e,this.refs=FU,this.updater=r||NU}var T2=R2.prototype=new HU;T2.constructor=R2;DU(T2,Rp.prototype);T2.isPureReactComponent=!0;var L$=Array.isArray,LU=Object.prototype.hasOwnProperty,k2={current:null},$U={key:!0,ref:!0,__self:!0,__source:!0};function BU(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)LU.call(e,n)&&!$U.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:Ny,type:t,key:s,ref:o,props:i,_owner:k2.current}}function Wee(t,e){return{$$typeof:Ny,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function P2(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ny}function jee(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var $$=/\/+/g;function hT(t,e){return typeof t=="object"&&t!==null&&t.key!=null?jee(""+t.key):e.toString(36)}function hx(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ny:case Iee:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+hT(o,0):n,L$(i)?(r="",t!=null&&(r=t.replace($$,"$&/")+"/"),hx(i,e,r,"",function(u){return u})):i!=null&&(P2(i)&&(i=Wee(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace($$,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",L$(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+hT(s,a);o+=hx(s,e,r,l,i)}else if(l=Vee(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+hT(s,a++),o+=hx(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function $1(t,e,r){if(t==null)return t;var n=[],i=0;return hx(t,n,"","",function(s){return e.call(r,s,i++)}),n}function Uee(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ns={current:null},fx={transition:null},zee={ReactCurrentDispatcher:ns,ReactCurrentBatchConfig:fx,ReactCurrentOwner:k2};function VU(){throw Error("act(...) is not supported in production builds of React.")}kt.Children={map:$1,forEach:function(t,e,r){$1(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return $1(t,function(){e++}),e},toArray:function(t){return $1(t,function(e){return e})||[]},only:function(t){if(!P2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};kt.Component=Rp;kt.Fragment=Oee;kt.Profiler=Nee;kt.PureComponent=R2;kt.StrictMode=Mee;kt.Suspense=Lee;kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zee;kt.act=VU;kt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=DU({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=k2.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)LU.call(e,l)&&!$U.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:Ny,type:t.type,key:i,ref:s,props:n,_owner:o}};kt.createContext=function(t){return t={$$typeof:Fee,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Dee,_context:t},t.Consumer=t};kt.createElement=BU;kt.createFactory=function(t){var e=BU.bind(null,t);return e.type=t,e};kt.createRef=function(){return{current:null}};kt.forwardRef=function(t){return{$$typeof:Hee,render:t}};kt.isValidElement=P2;kt.lazy=function(t){return{$$typeof:Bee,_payload:{_status:-1,_result:t},_init:Uee}};kt.memo=function(t,e){return{$$typeof:$ee,type:t,compare:e===void 0?null:e}};kt.startTransition=function(t){var e=fx.transition;fx.transition={};try{t()}finally{fx.transition=e}};kt.unstable_act=VU;kt.useCallback=function(t,e){return ns.current.useCallback(t,e)};kt.useContext=function(t){return ns.current.useContext(t)};kt.useDebugValue=function(){};kt.useDeferredValue=function(t){return ns.current.useDeferredValue(t)};kt.useEffect=function(t,e){return ns.current.useEffect(t,e)};kt.useId=function(){return ns.current.useId()};kt.useImperativeHandle=function(t,e,r){return ns.current.useImperativeHandle(t,e,r)};kt.useInsertionEffect=function(t,e){return ns.current.useInsertionEffect(t,e)};kt.useLayoutEffect=function(t,e){return ns.current.useLayoutEffect(t,e)};kt.useMemo=function(t,e){return ns.current.useMemo(t,e)};kt.useReducer=function(t,e,r){return ns.current.useReducer(t,e,r)};kt.useRef=function(t){return ns.current.useRef(t)};kt.useState=function(t){return ns.current.useState(t)};kt.useSyncExternalStore=function(t,e,r){return ns.current.useSyncExternalStore(t,e,r)};kt.useTransition=function(){return ns.current.useTransition()};kt.version="18.3.1";MU.exports=kt;var pe=MU.exports;const Ge=aE(pe),Gee=Aee({__proto__:null,default:Ge},[pe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yee=pe,Kee=Symbol.for("react.element"),Xee=Symbol.for("react.fragment"),qee=Object.prototype.hasOwnProperty,Jee=Yee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qee={key:!0,ref:!0,__self:!0,__source:!0};function WU(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)qee.call(e,n)&&!Qee.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Kee,type:t,key:s,ref:o,props:i,_owner:Jee.current}}lE.Fragment=Xee;lE.jsx=WU;lE.jsxs=WU;OU.exports=lE;var j=OU.exports,bI={},jU={exports:{}},lo={},UU={exports:{}},zU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ge,Q){var ye=ge.length;ge.push(Q);e:for(;0<ye;){var Re=ye-1>>>1,W=ge[Re];if(0<i(W,Q))ge[Re]=Q,ge[ye]=W,ye=Re;else break e}}function r(ge){return ge.length===0?null:ge[0]}function n(ge){if(ge.length===0)return null;var Q=ge[0],ye=ge.pop();if(ye!==Q){ge[0]=ye;e:for(var Re=0,W=ge.length,C=W>>>1;Re<C;){var S=2*(Re+1)-1,_=ge[S],D=S+1,U=ge[D];if(0>i(_,ye))D<W&&0>i(U,_)?(ge[Re]=U,ge[D]=ye,Re=D):(ge[Re]=_,ge[S]=ye,Re=S);else if(D<W&&0>i(U,ye))ge[Re]=U,ge[D]=ye,Re=D;else break e}}return Q}function i(ge,Q){var ye=ge.sortIndex-Q.sortIndex;return ye!==0?ye:ge.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,f=3,d=!1,g=!1,m=!1,p=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ge){for(var Q=r(u);Q!==null;){if(Q.callback===null)n(u);else if(Q.startTime<=ge)n(u),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=r(u)}}function b(ge){if(m=!1,y(ge),!g)if(r(l)!==null)g=!0,Ee(T);else{var Q=r(u);Q!==null&&Ce(b,Q.startTime-ge)}}function T(ge,Q){g=!1,m&&(m=!1,w(P),P=-1),d=!0;var ye=f;try{for(y(Q),h=r(l);h!==null&&(!(h.expirationTime>Q)||ge&&!Y());){var Re=h.callback;if(typeof Re=="function"){h.callback=null,f=h.priorityLevel;var W=Re(h.expirationTime<=Q);Q=t.unstable_now(),typeof W=="function"?h.callback=W:h===r(l)&&n(l),y(Q)}else n(l);h=r(l)}if(h!==null)var C=!0;else{var S=r(u);S!==null&&Ce(b,S.startTime-Q),C=!1}return C}finally{h=null,f=ye,d=!1}}var E=!1,x=null,P=-1,A=5,O=-1;function Y(){return!(t.unstable_now()-O<A)}function L(){if(x!==null){var ge=t.unstable_now();O=ge;var Q=!0;try{Q=x(!0,ge)}finally{Q?ie():(E=!1,x=null)}}else E=!1}var ie;if(typeof v=="function")ie=function(){v(L)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,he=ce.port2;ce.port1.onmessage=L,ie=function(){he.postMessage(null)}}else ie=function(){p(L,0)};function Ee(ge){x=ge,E||(E=!0,ie())}function Ce(ge,Q){P=p(function(){ge(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ge){ge.callback=null},t.unstable_continueExecution=function(){g||d||(g=!0,Ee(T))},t.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ge?Math.floor(1e3/ge):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ge){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var ye=f;f=Q;try{return ge()}finally{f=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ge,Q){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var ye=f;f=ge;try{return Q()}finally{f=ye}},t.unstable_scheduleCallback=function(ge,Q,ye){var Re=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Re+ye:Re):ye=Re,ge){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=ye+W,ge={id:c++,callback:Q,priorityLevel:ge,startTime:ye,expirationTime:W,sortIndex:-1},ye>Re?(ge.sortIndex=ye,e(u,ge),r(l)===null&&ge===r(u)&&(m?(w(P),P=-1):m=!0,Ce(b,ye-Re))):(ge.sortIndex=W,e(l,ge),g||d||(g=!0,Ee(T))),ge},t.unstable_shouldYield=Y,t.unstable_wrapCallback=function(ge){var Q=f;return function(){var ye=f;f=Q;try{return ge.apply(this,arguments)}finally{f=ye}}}})(zU);UU.exports=zU;var Zee=UU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ete=pe,ro=Zee;function Te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GU=new Set,xw={};function Bd(t,e){ep(t,e),ep(t+"Capture",e)}function ep(t,e){for(xw[t]=e,t=0;t<e.length;t++)GU.add(e[t])}var Bu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_I=Object.prototype.hasOwnProperty,tte=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B$={},V$={};function rte(t){return _I.call(V$,t)?!0:_I.call(B$,t)?!1:tte.test(t)?V$[t]=!0:(B$[t]=!0,!1)}function nte(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ite(t,e,r,n){if(e===null||typeof e>"u"||nte(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function is(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ci={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ci[t]=new is(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ci[e]=new is(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ci[t]=new is(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ci[t]=new is(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ci[t]=new is(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ci[t]=new is(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ci[t]=new is(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ci[t]=new is(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ci[t]=new is(t,5,!1,t.toLowerCase(),null,!1,!1)});var A2=/[\-:]([a-z])/g;function I2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(A2,I2);ci[e]=new is(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(A2,I2);ci[e]=new is(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(A2,I2);ci[e]=new is(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ci[t]=new is(t,1,!1,t.toLowerCase(),null,!1,!1)});ci.xlinkHref=new is("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ci[t]=new is(t,1,!1,t.toLowerCase(),null,!0,!0)});function O2(t,e,r,n){var i=ci.hasOwnProperty(e)?ci[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ite(e,r,i,n)&&(r=null),n||i===null?rte(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Qu=ete.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B1=Symbol.for("react.element"),hm=Symbol.for("react.portal"),fm=Symbol.for("react.fragment"),M2=Symbol.for("react.strict_mode"),EI=Symbol.for("react.profiler"),YU=Symbol.for("react.provider"),KU=Symbol.for("react.context"),N2=Symbol.for("react.forward_ref"),RI=Symbol.for("react.suspense"),TI=Symbol.for("react.suspense_list"),D2=Symbol.for("react.memo"),Dc=Symbol.for("react.lazy"),XU=Symbol.for("react.offscreen"),W$=Symbol.iterator;function t0(t){return t===null||typeof t!="object"?null:(t=W$&&t[W$]||t["@@iterator"],typeof t=="function"?t:null)}var Kr=Object.assign,fT;function pv(t){if(fT===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);fT=e&&e[1]||""}return`
`+fT+t}var dT=!1;function gT(t,e){if(!t||dT)return"";dT=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{dT=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?pv(t):""}function ste(t){switch(t.tag){case 5:return pv(t.type);case 16:return pv("Lazy");case 13:return pv("Suspense");case 19:return pv("SuspenseList");case 0:case 2:case 15:return t=gT(t.type,!1),t;case 11:return t=gT(t.type.render,!1),t;case 1:return t=gT(t.type,!0),t;default:return""}}function kI(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case fm:return"Fragment";case hm:return"Portal";case EI:return"Profiler";case M2:return"StrictMode";case RI:return"Suspense";case TI:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case KU:return(t.displayName||"Context")+".Consumer";case YU:return(t._context.displayName||"Context")+".Provider";case N2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case D2:return e=t.displayName||null,e!==null?e:kI(t.type)||"Memo";case Dc:e=t._payload,t=t._init;try{return kI(t(e))}catch{}}return null}function ote(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kI(e);case 8:return e===M2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qU(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ate(t){var e=qU(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function V1(t){t._valueTracker||(t._valueTracker=ate(t))}function JU(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=qU(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function ub(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function PI(t,e){var r=e.checked;return Kr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function j$(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=bh(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function QU(t,e){e=e.checked,e!=null&&O2(t,"checked",e,!1)}function AI(t,e){QU(t,e);var r=bh(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?II(t,e.type,r):e.hasOwnProperty("defaultValue")&&II(t,e.type,bh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function U$(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function II(t,e,r){(e!=="number"||ub(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var vv=Array.isArray;function Dm(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+bh(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function OI(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Te(91));return Kr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function z$(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Te(92));if(vv(r)){if(1<r.length)throw Error(Te(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:bh(r)}}function ZU(t,e){var r=bh(e.value),n=bh(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function G$(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function e5(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function MI(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?e5(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var W1,t5=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(W1=W1||document.createElement("div"),W1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=W1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bw(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ov={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lte=["Webkit","ms","Moz","O"];Object.keys(Ov).forEach(function(t){lte.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ov[e]=Ov[t]})});function r5(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ov.hasOwnProperty(t)&&Ov[t]?(""+e).trim():e+"px"}function n5(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=r5(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var ute=Kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function NI(t,e){if(e){if(ute[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Te(62))}}function DI(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var FI=null;function F2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var HI=null,Fm=null,Hm=null;function Y$(t){if(t=Hy(t)){if(typeof HI!="function")throw Error(Te(280));var e=t.stateNode;e&&(e=dE(e),HI(t.stateNode,t.type,e))}}function i5(t){Fm?Hm?Hm.push(t):Hm=[t]:Fm=t}function s5(){if(Fm){var t=Fm,e=Hm;if(Hm=Fm=null,Y$(t),e)for(t=0;t<e.length;t++)Y$(e[t])}}function o5(t,e){return t(e)}function a5(){}var mT=!1;function l5(t,e,r){if(mT)return t(e,r);mT=!0;try{return o5(t,e,r)}finally{mT=!1,(Fm!==null||Hm!==null)&&(a5(),s5())}}function _w(t,e){var r=t.stateNode;if(r===null)return null;var n=dE(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Te(231,e,typeof r));return r}var LI=!1;if(Bu)try{var r0={};Object.defineProperty(r0,"passive",{get:function(){LI=!0}}),window.addEventListener("test",r0,r0),window.removeEventListener("test",r0,r0)}catch{LI=!1}function cte(t,e,r,n,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(c){this.onError(c)}}var Mv=!1,cb=null,hb=!1,$I=null,hte={onError:function(t){Mv=!0,cb=t}};function fte(t,e,r,n,i,s,o,a,l){Mv=!1,cb=null,cte.apply(hte,arguments)}function dte(t,e,r,n,i,s,o,a,l){if(fte.apply(this,arguments),Mv){if(Mv){var u=cb;Mv=!1,cb=null}else throw Error(Te(198));hb||(hb=!0,$I=u)}}function Vd(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function u5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function K$(t){if(Vd(t)!==t)throw Error(Te(188))}function gte(t){var e=t.alternate;if(!e){if(e=Vd(t),e===null)throw Error(Te(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return K$(i),t;if(s===n)return K$(i),e;s=s.sibling}throw Error(Te(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(Te(189))}}if(r.alternate!==n)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?t:e}function c5(t){return t=gte(t),t!==null?h5(t):null}function h5(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=h5(t);if(e!==null)return e;t=t.sibling}return null}var f5=ro.unstable_scheduleCallback,X$=ro.unstable_cancelCallback,mte=ro.unstable_shouldYield,pte=ro.unstable_requestPaint,gn=ro.unstable_now,vte=ro.unstable_getCurrentPriorityLevel,H2=ro.unstable_ImmediatePriority,d5=ro.unstable_UserBlockingPriority,fb=ro.unstable_NormalPriority,wte=ro.unstable_LowPriority,g5=ro.unstable_IdlePriority,uE=null,Il=null;function yte(t){if(Il&&typeof Il.onCommitFiberRoot=="function")try{Il.onCommitFiberRoot(uE,t,void 0,(t.current.flags&128)===128)}catch{}}var Pa=Math.clz32?Math.clz32:xte,Cte=Math.log,Ste=Math.LN2;function xte(t){return t>>>=0,t===0?32:31-(Cte(t)/Ste|0)|0}var j1=64,U1=4194304;function wv(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function db(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=wv(a):(s&=o,s!==0&&(n=wv(s)))}else o=r&~i,o!==0?n=wv(o):s!==0&&(n=wv(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Pa(e),i=1<<r,n|=t[r],e&=~i;return n}function bte(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _te(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Pa(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=bte(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function BI(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function m5(){var t=j1;return j1<<=1,!(j1&4194240)&&(j1=64),t}function pT(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Dy(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pa(e),t[e]=r}function Ete(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Pa(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function L2(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Pa(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var lr=0;function p5(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var v5,$2,w5,y5,C5,VI=!1,z1=[],uh=null,ch=null,hh=null,Ew=new Map,Rw=new Map,jc=[],Rte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function q$(t,e){switch(t){case"focusin":case"focusout":uh=null;break;case"dragenter":case"dragleave":ch=null;break;case"mouseover":case"mouseout":hh=null;break;case"pointerover":case"pointerout":Ew.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rw.delete(e.pointerId)}}function n0(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Hy(e),e!==null&&$2(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Tte(t,e,r,n,i){switch(e){case"focusin":return uh=n0(uh,t,e,r,n,i),!0;case"dragenter":return ch=n0(ch,t,e,r,n,i),!0;case"mouseover":return hh=n0(hh,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Ew.set(s,n0(Ew.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Rw.set(s,n0(Rw.get(s)||null,t,e,r,n,i)),!0}return!1}function S5(t){var e=zf(t.target);if(e!==null){var r=Vd(e);if(r!==null){if(e=r.tag,e===13){if(e=u5(r),e!==null){t.blockedOn=e,C5(t.priority,function(){w5(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function dx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=WI(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);FI=n,r.target.dispatchEvent(n),FI=null}else return e=Hy(r),e!==null&&$2(e),t.blockedOn=r,!1;e.shift()}return!0}function J$(t,e,r){dx(t)&&r.delete(e)}function kte(){VI=!1,uh!==null&&dx(uh)&&(uh=null),ch!==null&&dx(ch)&&(ch=null),hh!==null&&dx(hh)&&(hh=null),Ew.forEach(J$),Rw.forEach(J$)}function i0(t,e){t.blockedOn===e&&(t.blockedOn=null,VI||(VI=!0,ro.unstable_scheduleCallback(ro.unstable_NormalPriority,kte)))}function Tw(t){function e(i){return i0(i,t)}if(0<z1.length){i0(z1[0],t);for(var r=1;r<z1.length;r++){var n=z1[r];n.blockedOn===t&&(n.blockedOn=null)}}for(uh!==null&&i0(uh,t),ch!==null&&i0(ch,t),hh!==null&&i0(hh,t),Ew.forEach(e),Rw.forEach(e),r=0;r<jc.length;r++)n=jc[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<jc.length&&(r=jc[0],r.blockedOn===null);)S5(r),r.blockedOn===null&&jc.shift()}var Lm=Qu.ReactCurrentBatchConfig,gb=!0;function Pte(t,e,r,n){var i=lr,s=Lm.transition;Lm.transition=null;try{lr=1,B2(t,e,r,n)}finally{lr=i,Lm.transition=s}}function Ate(t,e,r,n){var i=lr,s=Lm.transition;Lm.transition=null;try{lr=4,B2(t,e,r,n)}finally{lr=i,Lm.transition=s}}function B2(t,e,r,n){if(gb){var i=WI(t,e,r,n);if(i===null)RT(t,e,n,mb,r),q$(t,n);else if(Tte(i,t,e,r,n))n.stopPropagation();else if(q$(t,n),e&4&&-1<Rte.indexOf(t)){for(;i!==null;){var s=Hy(i);if(s!==null&&v5(s),s=WI(t,e,r,n),s===null&&RT(t,e,n,mb,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else RT(t,e,n,null,r)}}var mb=null;function WI(t,e,r,n){if(mb=null,t=F2(n),t=zf(t),t!==null)if(e=Vd(t),e===null)t=null;else if(r=e.tag,r===13){if(t=u5(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return mb=t,null}function x5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vte()){case H2:return 1;case d5:return 4;case fb:case wte:return 16;case g5:return 536870912;default:return 16}default:return 16}}var Kc=null,V2=null,gx=null;function b5(){if(gx)return gx;var t,e=V2,r=e.length,n,i="value"in Kc?Kc.value:Kc.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return gx=i.slice(t,1<n?1-n:void 0)}function mx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function G1(){return!0}function Q$(){return!1}function uo(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?G1:Q$,this.isPropagationStopped=Q$,this}return Kr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=G1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=G1)},persist:function(){},isPersistent:G1}),e}var Tp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},W2=uo(Tp),Fy=Kr({},Tp,{view:0,detail:0}),Ite=uo(Fy),vT,wT,s0,cE=Kr({},Fy,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:j2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==s0&&(s0&&t.type==="mousemove"?(vT=t.screenX-s0.screenX,wT=t.screenY-s0.screenY):wT=vT=0,s0=t),vT)},movementY:function(t){return"movementY"in t?t.movementY:wT}}),Z$=uo(cE),Ote=Kr({},cE,{dataTransfer:0}),Mte=uo(Ote),Nte=Kr({},Fy,{relatedTarget:0}),yT=uo(Nte),Dte=Kr({},Tp,{animationName:0,elapsedTime:0,pseudoElement:0}),Fte=uo(Dte),Hte=Kr({},Tp,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Lte=uo(Hte),$te=Kr({},Tp,{data:0}),e4=uo($te),Bte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wte={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jte(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Wte[t])?!!e[t]:!1}function j2(){return jte}var Ute=Kr({},Fy,{key:function(t){if(t.key){var e=Bte[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Vte[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:j2,charCode:function(t){return t.type==="keypress"?mx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),zte=uo(Ute),Gte=Kr({},cE,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t4=uo(Gte),Yte=Kr({},Fy,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:j2}),Kte=uo(Yte),Xte=Kr({},Tp,{propertyName:0,elapsedTime:0,pseudoElement:0}),qte=uo(Xte),Jte=Kr({},cE,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Qte=uo(Jte),Zte=[9,13,27,32],U2=Bu&&"CompositionEvent"in window,Nv=null;Bu&&"documentMode"in document&&(Nv=document.documentMode);var ere=Bu&&"TextEvent"in window&&!Nv,_5=Bu&&(!U2||Nv&&8<Nv&&11>=Nv),r4=" ",n4=!1;function E5(t,e){switch(t){case"keyup":return Zte.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function R5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var dm=!1;function tre(t,e){switch(t){case"compositionend":return R5(e);case"keypress":return e.which!==32?null:(n4=!0,r4);case"textInput":return t=e.data,t===r4&&n4?null:t;default:return null}}function rre(t,e){if(dm)return t==="compositionend"||!U2&&E5(t,e)?(t=b5(),gx=V2=Kc=null,dm=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _5&&e.locale!=="ko"?null:e.data;default:return null}}var nre={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i4(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nre[t.type]:e==="textarea"}function T5(t,e,r,n){i5(n),e=pb(e,"onChange"),0<e.length&&(r=new W2("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Dv=null,kw=null;function ire(t){L5(t,0)}function hE(t){var e=pm(t);if(JU(e))return t}function sre(t,e){if(t==="change")return e}var k5=!1;if(Bu){var CT;if(Bu){var ST="oninput"in document;if(!ST){var s4=document.createElement("div");s4.setAttribute("oninput","return;"),ST=typeof s4.oninput=="function"}CT=ST}else CT=!1;k5=CT&&(!document.documentMode||9<document.documentMode)}function o4(){Dv&&(Dv.detachEvent("onpropertychange",P5),kw=Dv=null)}function P5(t){if(t.propertyName==="value"&&hE(kw)){var e=[];T5(e,kw,t,F2(t)),l5(ire,e)}}function ore(t,e,r){t==="focusin"?(o4(),Dv=e,kw=r,Dv.attachEvent("onpropertychange",P5)):t==="focusout"&&o4()}function are(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hE(kw)}function lre(t,e){if(t==="click")return hE(e)}function ure(t,e){if(t==="input"||t==="change")return hE(e)}function cre(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Da=typeof Object.is=="function"?Object.is:cre;function Pw(t,e){if(Da(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!_I.call(e,i)||!Da(t[i],e[i]))return!1}return!0}function a4(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function l4(t,e){var r=a4(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=a4(r)}}function A5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?A5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function I5(){for(var t=window,e=ub();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=ub(t.document)}return e}function z2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function hre(t){var e=I5(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&A5(r.ownerDocument.documentElement,r)){if(n!==null&&z2(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=l4(r,s);var o=l4(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fre=Bu&&"documentMode"in document&&11>=document.documentMode,gm=null,jI=null,Fv=null,UI=!1;function u4(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;UI||gm==null||gm!==ub(n)||(n=gm,"selectionStart"in n&&z2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fv&&Pw(Fv,n)||(Fv=n,n=pb(jI,"onSelect"),0<n.length&&(e=new W2("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=gm)))}function Y1(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var mm={animationend:Y1("Animation","AnimationEnd"),animationiteration:Y1("Animation","AnimationIteration"),animationstart:Y1("Animation","AnimationStart"),transitionend:Y1("Transition","TransitionEnd")},xT={},O5={};Bu&&(O5=document.createElement("div").style,"AnimationEvent"in window||(delete mm.animationend.animation,delete mm.animationiteration.animation,delete mm.animationstart.animation),"TransitionEvent"in window||delete mm.transitionend.transition);function fE(t){if(xT[t])return xT[t];if(!mm[t])return t;var e=mm[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in O5)return xT[t]=e[r];return t}var M5=fE("animationend"),N5=fE("animationiteration"),D5=fE("animationstart"),F5=fE("transitionend"),H5=new Map,c4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mh(t,e){H5.set(t,e),Bd(e,[t])}for(var bT=0;bT<c4.length;bT++){var _T=c4[bT],dre=_T.toLowerCase(),gre=_T[0].toUpperCase()+_T.slice(1);Mh(dre,"on"+gre)}Mh(M5,"onAnimationEnd");Mh(N5,"onAnimationIteration");Mh(D5,"onAnimationStart");Mh("dblclick","onDoubleClick");Mh("focusin","onFocus");Mh("focusout","onBlur");Mh(F5,"onTransitionEnd");ep("onMouseEnter",["mouseout","mouseover"]);ep("onMouseLeave",["mouseout","mouseover"]);ep("onPointerEnter",["pointerout","pointerover"]);ep("onPointerLeave",["pointerout","pointerover"]);Bd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mre=new Set("cancel close invalid load scroll toggle".split(" ").concat(yv));function h4(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,dte(n,e,void 0,t),t.currentTarget=null}function L5(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;h4(i,a,u),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;h4(i,a,u),s=l}}}if(hb)throw t=$I,hb=!1,$I=null,t}function Er(t,e){var r=e[XI];r===void 0&&(r=e[XI]=new Set);var n=t+"__bubble";r.has(n)||($5(e,t,2,!1),r.add(n))}function ET(t,e,r){var n=0;e&&(n|=4),$5(r,t,n,e)}var K1="_reactListening"+Math.random().toString(36).slice(2);function Aw(t){if(!t[K1]){t[K1]=!0,GU.forEach(function(r){r!=="selectionchange"&&(mre.has(r)||ET(r,!1,t),ET(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[K1]||(e[K1]=!0,ET("selectionchange",!1,e))}}function $5(t,e,r,n){switch(x5(e)){case 1:var i=Pte;break;case 4:i=Ate;break;default:i=B2}r=i.bind(null,e,r,t),i=void 0,!LI||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function RT(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=zf(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}l5(function(){var u=s,c=F2(r),h=[];e:{var f=H5.get(t);if(f!==void 0){var d=W2,g=t;switch(t){case"keypress":if(mx(r)===0)break e;case"keydown":case"keyup":d=zte;break;case"focusin":g="focus",d=yT;break;case"focusout":g="blur",d=yT;break;case"beforeblur":case"afterblur":d=yT;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=Z$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=Mte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=Kte;break;case M5:case N5:case D5:d=Fte;break;case F5:d=qte;break;case"scroll":d=Ite;break;case"wheel":d=Qte;break;case"copy":case"cut":case"paste":d=Lte;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=t4}var m=(e&4)!==0,p=!m&&t==="scroll",w=m?f!==null?f+"Capture":null:f;m=[];for(var v=u,y;v!==null;){y=v;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,w!==null&&(b=_w(v,w),b!=null&&m.push(Iw(v,b,y)))),p)break;v=v.return}0<m.length&&(f=new d(f,g,null,r,c),h.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",f&&r!==FI&&(g=r.relatedTarget||r.fromElement)&&(zf(g)||g[Vu]))break e;if((d||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,d?(g=r.relatedTarget||r.toElement,d=u,g=g?zf(g):null,g!==null&&(p=Vd(g),g!==p||g.tag!==5&&g.tag!==6)&&(g=null)):(d=null,g=u),d!==g)){if(m=Z$,b="onMouseLeave",w="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=t4,b="onPointerLeave",w="onPointerEnter",v="pointer"),p=d==null?f:pm(d),y=g==null?f:pm(g),f=new m(b,v+"leave",d,r,c),f.target=p,f.relatedTarget=y,b=null,zf(c)===u&&(m=new m(w,v+"enter",g,r,c),m.target=y,m.relatedTarget=p,b=m),p=b,d&&g)t:{for(m=d,w=g,v=0,y=m;y;y=lg(y))v++;for(y=0,b=w;b;b=lg(b))y++;for(;0<v-y;)m=lg(m),v--;for(;0<y-v;)w=lg(w),y--;for(;v--;){if(m===w||w!==null&&m===w.alternate)break t;m=lg(m),w=lg(w)}m=null}else m=null;d!==null&&f4(h,f,d,m,!1),g!==null&&p!==null&&f4(h,p,g,m,!0)}}e:{if(f=u?pm(u):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var T=sre;else if(i4(f))if(k5)T=ure;else{T=are;var E=ore}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=lre);if(T&&(T=T(t,u))){T5(h,T,r,c);break e}E&&E(t,f,u),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&II(f,"number",f.value)}switch(E=u?pm(u):window,t){case"focusin":(i4(E)||E.contentEditable==="true")&&(gm=E,jI=u,Fv=null);break;case"focusout":Fv=jI=gm=null;break;case"mousedown":UI=!0;break;case"contextmenu":case"mouseup":case"dragend":UI=!1,u4(h,r,c);break;case"selectionchange":if(fre)break;case"keydown":case"keyup":u4(h,r,c)}var x;if(U2)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else dm?E5(t,r)&&(P="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(_5&&r.locale!=="ko"&&(dm||P!=="onCompositionStart"?P==="onCompositionEnd"&&dm&&(x=b5()):(Kc=c,V2="value"in Kc?Kc.value:Kc.textContent,dm=!0)),E=pb(u,P),0<E.length&&(P=new e4(P,t,null,r,c),h.push({event:P,listeners:E}),x?P.data=x:(x=R5(r),x!==null&&(P.data=x)))),(x=ere?tre(t,r):rre(t,r))&&(u=pb(u,"onBeforeInput"),0<u.length&&(c=new e4("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=x))}L5(h,e)})}function Iw(t,e,r){return{instance:t,listener:e,currentTarget:r}}function pb(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=_w(t,r),s!=null&&n.unshift(Iw(t,s,i)),s=_w(t,e),s!=null&&n.push(Iw(t,s,i))),t=t.return}return n}function lg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function f4(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,u=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&u!==null&&(a=u,i?(l=_w(r,s),l!=null&&o.unshift(Iw(r,l,a))):i||(l=_w(r,s),l!=null&&o.push(Iw(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var pre=/\r\n?/g,vre=/\u0000|\uFFFD/g;function d4(t){return(typeof t=="string"?t:""+t).replace(pre,`
`).replace(vre,"")}function X1(t,e,r){if(e=d4(e),d4(t)!==e&&r)throw Error(Te(425))}function vb(){}var zI=null,GI=null;function YI(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var KI=typeof setTimeout=="function"?setTimeout:void 0,wre=typeof clearTimeout=="function"?clearTimeout:void 0,g4=typeof Promise=="function"?Promise:void 0,yre=typeof queueMicrotask=="function"?queueMicrotask:typeof g4<"u"?function(t){return g4.resolve(null).then(t).catch(Cre)}:KI;function Cre(t){setTimeout(function(){throw t})}function TT(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Tw(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Tw(e)}function fh(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function m4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var kp=Math.random().toString(36).slice(2),bl="__reactFiber$"+kp,Ow="__reactProps$"+kp,Vu="__reactContainer$"+kp,XI="__reactEvents$"+kp,Sre="__reactListeners$"+kp,xre="__reactHandles$"+kp;function zf(t){var e=t[bl];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Vu]||r[bl]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=m4(t);t!==null;){if(r=t[bl])return r;t=m4(t)}return e}t=r,r=t.parentNode}return null}function Hy(t){return t=t[bl]||t[Vu],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function pm(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Te(33))}function dE(t){return t[Ow]||null}var qI=[],vm=-1;function Nh(t){return{current:t}}function Tr(t){0>vm||(t.current=qI[vm],qI[vm]=null,vm--)}function xr(t,e){vm++,qI[vm]=t.current,t.current=e}var _h={},Mi=Nh(_h),Es=Nh(!1),dd=_h;function tp(t,e){var r=t.type.contextTypes;if(!r)return _h;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Rs(t){return t=t.childContextTypes,t!=null}function wb(){Tr(Es),Tr(Mi)}function p4(t,e,r){if(Mi.current!==_h)throw Error(Te(168));xr(Mi,e),xr(Es,r)}function B5(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Te(108,ote(t)||"Unknown",i));return Kr({},r,n)}function yb(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_h,dd=Mi.current,xr(Mi,t),xr(Es,Es.current),!0}function v4(t,e,r){var n=t.stateNode;if(!n)throw Error(Te(169));r?(t=B5(t,e,dd),n.__reactInternalMemoizedMergedChildContext=t,Tr(Es),Tr(Mi),xr(Mi,t)):Tr(Es),xr(Es,r)}var wu=null,gE=!1,kT=!1;function V5(t){wu===null?wu=[t]:wu.push(t)}function bre(t){gE=!0,V5(t)}function Dh(){if(!kT&&wu!==null){kT=!0;var t=0,e=lr;try{var r=wu;for(lr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}wu=null,gE=!1}catch(i){throw wu!==null&&(wu=wu.slice(t+1)),f5(H2,Dh),i}finally{lr=e,kT=!1}}return null}var wm=[],ym=0,Cb=null,Sb=0,Mo=[],No=0,gd=null,Cu=1,Su="";function Df(t,e){wm[ym++]=Sb,wm[ym++]=Cb,Cb=t,Sb=e}function W5(t,e,r){Mo[No++]=Cu,Mo[No++]=Su,Mo[No++]=gd,gd=t;var n=Cu;t=Su;var i=32-Pa(n)-1;n&=~(1<<i),r+=1;var s=32-Pa(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Cu=1<<32-Pa(e)+i|r<<i|n,Su=s+t}else Cu=1<<s|r<<i|n,Su=t}function G2(t){t.return!==null&&(Df(t,1),W5(t,1,0))}function Y2(t){for(;t===Cb;)Cb=wm[--ym],wm[ym]=null,Sb=wm[--ym],wm[ym]=null;for(;t===gd;)gd=Mo[--No],Mo[No]=null,Su=Mo[--No],Mo[No]=null,Cu=Mo[--No],Mo[No]=null}var eo=null,Js=null,Nr=!1,xa=null;function j5(t,e){var r=Lo(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function w4(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,eo=t,Js=fh(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,eo=t,Js=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=gd!==null?{id:Cu,overflow:Su}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Lo(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,eo=t,Js=null,!0):!1;default:return!1}}function JI(t){return(t.mode&1)!==0&&(t.flags&128)===0}function QI(t){if(Nr){var e=Js;if(e){var r=e;if(!w4(t,e)){if(JI(t))throw Error(Te(418));e=fh(r.nextSibling);var n=eo;e&&w4(t,e)?j5(n,r):(t.flags=t.flags&-4097|2,Nr=!1,eo=t)}}else{if(JI(t))throw Error(Te(418));t.flags=t.flags&-4097|2,Nr=!1,eo=t}}}function y4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;eo=t}function q1(t){if(t!==eo)return!1;if(!Nr)return y4(t),Nr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!YI(t.type,t.memoizedProps)),e&&(e=Js)){if(JI(t))throw U5(),Error(Te(418));for(;e;)j5(t,e),e=fh(e.nextSibling)}if(y4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Js=fh(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Js=null}}else Js=eo?fh(t.stateNode.nextSibling):null;return!0}function U5(){for(var t=Js;t;)t=fh(t.nextSibling)}function rp(){Js=eo=null,Nr=!1}function K2(t){xa===null?xa=[t]:xa.push(t)}var _re=Qu.ReactCurrentBatchConfig;function o0(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var n=r.stateNode}if(!n)throw Error(Te(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,t))}return t}function J1(t,e){throw t=Object.prototype.toString.call(e),Error(Te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function C4(t){var e=t._init;return e(t._payload)}function z5(t){function e(w,v){if(t){var y=w.deletions;y===null?(w.deletions=[v],w.flags|=16):y.push(v)}}function r(w,v){if(!t)return null;for(;v!==null;)e(w,v),v=v.sibling;return null}function n(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function i(w,v){return w=ph(w,v),w.index=0,w.sibling=null,w}function s(w,v,y){return w.index=y,t?(y=w.alternate,y!==null?(y=y.index,y<v?(w.flags|=2,v):y):(w.flags|=2,v)):(w.flags|=1048576,v)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,v,y,b){return v===null||v.tag!==6?(v=DT(y,w.mode,b),v.return=w,v):(v=i(v,y),v.return=w,v)}function l(w,v,y,b){var T=y.type;return T===fm?c(w,v,y.props.children,b,y.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Dc&&C4(T)===v.type)?(b=i(v,y.props),b.ref=o0(w,v,y),b.return=w,b):(b=xx(y.type,y.key,y.props,null,w.mode,b),b.ref=o0(w,v,y),b.return=w,b)}function u(w,v,y,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=FT(y,w.mode,b),v.return=w,v):(v=i(v,y.children||[]),v.return=w,v)}function c(w,v,y,b,T){return v===null||v.tag!==7?(v=nd(y,w.mode,b,T),v.return=w,v):(v=i(v,y),v.return=w,v)}function h(w,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=DT(""+v,w.mode,y),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case B1:return y=xx(v.type,v.key,v.props,null,w.mode,y),y.ref=o0(w,null,v),y.return=w,y;case hm:return v=FT(v,w.mode,y),v.return=w,v;case Dc:var b=v._init;return h(w,b(v._payload),y)}if(vv(v)||t0(v))return v=nd(v,w.mode,y,null),v.return=w,v;J1(w,v)}return null}function f(w,v,y,b){var T=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return T!==null?null:a(w,v,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case B1:return y.key===T?l(w,v,y,b):null;case hm:return y.key===T?u(w,v,y,b):null;case Dc:return T=y._init,f(w,v,T(y._payload),b)}if(vv(y)||t0(y))return T!==null?null:c(w,v,y,b,null);J1(w,y)}return null}function d(w,v,y,b,T){if(typeof b=="string"&&b!==""||typeof b=="number")return w=w.get(y)||null,a(v,w,""+b,T);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case B1:return w=w.get(b.key===null?y:b.key)||null,l(v,w,b,T);case hm:return w=w.get(b.key===null?y:b.key)||null,u(v,w,b,T);case Dc:var E=b._init;return d(w,v,y,E(b._payload),T)}if(vv(b)||t0(b))return w=w.get(y)||null,c(v,w,b,T,null);J1(v,b)}return null}function g(w,v,y,b){for(var T=null,E=null,x=v,P=v=0,A=null;x!==null&&P<y.length;P++){x.index>P?(A=x,x=null):A=x.sibling;var O=f(w,x,y[P],b);if(O===null){x===null&&(x=A);break}t&&x&&O.alternate===null&&e(w,x),v=s(O,v,P),E===null?T=O:E.sibling=O,E=O,x=A}if(P===y.length)return r(w,x),Nr&&Df(w,P),T;if(x===null){for(;P<y.length;P++)x=h(w,y[P],b),x!==null&&(v=s(x,v,P),E===null?T=x:E.sibling=x,E=x);return Nr&&Df(w,P),T}for(x=n(w,x);P<y.length;P++)A=d(x,w,P,y[P],b),A!==null&&(t&&A.alternate!==null&&x.delete(A.key===null?P:A.key),v=s(A,v,P),E===null?T=A:E.sibling=A,E=A);return t&&x.forEach(function(Y){return e(w,Y)}),Nr&&Df(w,P),T}function m(w,v,y,b){var T=t0(y);if(typeof T!="function")throw Error(Te(150));if(y=T.call(y),y==null)throw Error(Te(151));for(var E=T=null,x=v,P=v=0,A=null,O=y.next();x!==null&&!O.done;P++,O=y.next()){x.index>P?(A=x,x=null):A=x.sibling;var Y=f(w,x,O.value,b);if(Y===null){x===null&&(x=A);break}t&&x&&Y.alternate===null&&e(w,x),v=s(Y,v,P),E===null?T=Y:E.sibling=Y,E=Y,x=A}if(O.done)return r(w,x),Nr&&Df(w,P),T;if(x===null){for(;!O.done;P++,O=y.next())O=h(w,O.value,b),O!==null&&(v=s(O,v,P),E===null?T=O:E.sibling=O,E=O);return Nr&&Df(w,P),T}for(x=n(w,x);!O.done;P++,O=y.next())O=d(x,w,P,O.value,b),O!==null&&(t&&O.alternate!==null&&x.delete(O.key===null?P:O.key),v=s(O,v,P),E===null?T=O:E.sibling=O,E=O);return t&&x.forEach(function(L){return e(w,L)}),Nr&&Df(w,P),T}function p(w,v,y,b){if(typeof y=="object"&&y!==null&&y.type===fm&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case B1:e:{for(var T=y.key,E=v;E!==null;){if(E.key===T){if(T=y.type,T===fm){if(E.tag===7){r(w,E.sibling),v=i(E,y.props.children),v.return=w,w=v;break e}}else if(E.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Dc&&C4(T)===E.type){r(w,E.sibling),v=i(E,y.props),v.ref=o0(w,E,y),v.return=w,w=v;break e}r(w,E);break}else e(w,E);E=E.sibling}y.type===fm?(v=nd(y.props.children,w.mode,b,y.key),v.return=w,w=v):(b=xx(y.type,y.key,y.props,null,w.mode,b),b.ref=o0(w,v,y),b.return=w,w=b)}return o(w);case hm:e:{for(E=y.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(w,v.sibling),v=i(v,y.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else e(w,v);v=v.sibling}v=FT(y,w.mode,b),v.return=w,w=v}return o(w);case Dc:return E=y._init,p(w,v,E(y._payload),b)}if(vv(y))return g(w,v,y,b);if(t0(y))return m(w,v,y,b);J1(w,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(w,v.sibling),v=i(v,y),v.return=w,w=v):(r(w,v),v=DT(y,w.mode,b),v.return=w,w=v),o(w)):r(w,v)}return p}var np=z5(!0),G5=z5(!1),xb=Nh(null),bb=null,Cm=null,X2=null;function q2(){X2=Cm=bb=null}function J2(t){var e=xb.current;Tr(xb),t._currentValue=e}function ZI(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function $m(t,e){bb=t,X2=Cm=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(bs=!0),t.firstContext=null)}function jo(t){var e=t._currentValue;if(X2!==t)if(t={context:t,memoizedValue:e,next:null},Cm===null){if(bb===null)throw Error(Te(308));Cm=t,bb.dependencies={lanes:0,firstContext:t}}else Cm=Cm.next=t;return e}var Gf=null;function Q2(t){Gf===null?Gf=[t]:Gf.push(t)}function Y5(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Q2(e)):(r.next=i.next,i.next=r),e.interleaved=r,Wu(t,n)}function Wu(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Fc=!1;function Z2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K5(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ou(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function dh(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Wt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Wu(t,r)}return i=n.interleaved,i===null?(e.next=e,Q2(n)):(e.next=i.next,i.next=e),n.interleaved=e,Wu(t,r)}function px(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,L2(t,r)}}function S4(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function _b(t,e,r,n){var i=t.updateQueue;Fc=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,c=u=l=null,a=s;do{var f=a.lane,d=a.eventTime;if((n&f)===f){c!==null&&(c=c.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,m=a;switch(f=e,d=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(d,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,f=typeof g=="function"?g.call(d,h,f):g,f==null)break e;h=Kr({},h,f);break e;case 2:Fc=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else d={eventTime:d,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=d,l=h):c=c.next=d,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);pd|=o,t.lanes=o,t.memoizedState=h}}function x4(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Te(191,i));i.call(n)}}}var Ly={},Ol=Nh(Ly),Mw=Nh(Ly),Nw=Nh(Ly);function Yf(t){if(t===Ly)throw Error(Te(174));return t}function eN(t,e){switch(xr(Nw,e),xr(Mw,t),xr(Ol,Ly),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:MI(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=MI(e,t)}Tr(Ol),xr(Ol,e)}function ip(){Tr(Ol),Tr(Mw),Tr(Nw)}function X5(t){Yf(Nw.current);var e=Yf(Ol.current),r=MI(e,t.type);e!==r&&(xr(Mw,t),xr(Ol,r))}function tN(t){Mw.current===t&&(Tr(Ol),Tr(Mw))}var Wr=Nh(0);function Eb(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var PT=[];function rN(){for(var t=0;t<PT.length;t++)PT[t]._workInProgressVersionPrimary=null;PT.length=0}var vx=Qu.ReactCurrentDispatcher,AT=Qu.ReactCurrentBatchConfig,md=0,Gr=null,$n=null,Kn=null,Rb=!1,Hv=!1,Dw=0,Ere=0;function fi(){throw Error(Te(321))}function nN(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Da(t[r],e[r]))return!1;return!0}function iN(t,e,r,n,i,s){if(md=s,Gr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vx.current=t===null||t.memoizedState===null?Pre:Are,t=r(n,i),Hv){s=0;do{if(Hv=!1,Dw=0,25<=s)throw Error(Te(301));s+=1,Kn=$n=null,e.updateQueue=null,vx.current=Ire,t=r(n,i)}while(Hv)}if(vx.current=Tb,e=$n!==null&&$n.next!==null,md=0,Kn=$n=Gr=null,Rb=!1,e)throw Error(Te(300));return t}function sN(){var t=Dw!==0;return Dw=0,t}function pl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?Gr.memoizedState=Kn=t:Kn=Kn.next=t,Kn}function Uo(){if($n===null){var t=Gr.alternate;t=t!==null?t.memoizedState:null}else t=$n.next;var e=Kn===null?Gr.memoizedState:Kn.next;if(e!==null)Kn=e,$n=t;else{if(t===null)throw Error(Te(310));$n=t,t={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},Kn===null?Gr.memoizedState=Kn=t:Kn=Kn.next=t}return Kn}function Fw(t,e){return typeof e=="function"?e(t):e}function IT(t){var e=Uo(),r=e.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=t;var n=$n,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((md&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,Gr.lanes|=c,pd|=c}u=u.next}while(u!==null&&u!==s);l===null?o=n:l.next=a,Da(n,e.memoizedState)||(bs=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Gr.lanes|=s,pd|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function OT(t){var e=Uo(),r=e.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Da(s,e.memoizedState)||(bs=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function q5(){}function J5(t,e){var r=Gr,n=Uo(),i=e(),s=!Da(n.memoizedState,i);if(s&&(n.memoizedState=i,bs=!0),n=n.queue,oN(ez.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Kn!==null&&Kn.memoizedState.tag&1){if(r.flags|=2048,Hw(9,Z5.bind(null,r,n,i,e),void 0,null),Zn===null)throw Error(Te(349));md&30||Q5(r,e,i)}return i}function Q5(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Z5(t,e,r,n){e.value=r,e.getSnapshot=n,tz(e)&&rz(t)}function ez(t,e,r){return r(function(){tz(e)&&rz(t)})}function tz(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Da(t,r)}catch{return!0}}function rz(t){var e=Wu(t,1);e!==null&&Aa(e,t,1,-1)}function b4(t){var e=pl();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fw,lastRenderedState:t},e.queue=t,t=t.dispatch=kre.bind(null,Gr,t),[e.memoizedState,t]}function Hw(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function nz(){return Uo().memoizedState}function wx(t,e,r,n){var i=pl();Gr.flags|=t,i.memoizedState=Hw(1|e,r,void 0,n===void 0?null:n)}function mE(t,e,r,n){var i=Uo();n=n===void 0?null:n;var s=void 0;if($n!==null){var o=$n.memoizedState;if(s=o.destroy,n!==null&&nN(n,o.deps)){i.memoizedState=Hw(e,r,s,n);return}}Gr.flags|=t,i.memoizedState=Hw(1|e,r,s,n)}function _4(t,e){return wx(8390656,8,t,e)}function oN(t,e){return mE(2048,8,t,e)}function iz(t,e){return mE(4,2,t,e)}function sz(t,e){return mE(4,4,t,e)}function oz(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function az(t,e,r){return r=r!=null?r.concat([t]):null,mE(4,4,oz.bind(null,e,t),r)}function aN(){}function lz(t,e){var r=Uo();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&nN(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function uz(t,e){var r=Uo();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&nN(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function cz(t,e,r){return md&21?(Da(r,e)||(r=m5(),Gr.lanes|=r,pd|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,bs=!0),t.memoizedState=r)}function Rre(t,e){var r=lr;lr=r!==0&&4>r?r:4,t(!0);var n=AT.transition;AT.transition={};try{t(!1),e()}finally{lr=r,AT.transition=n}}function hz(){return Uo().memoizedState}function Tre(t,e,r){var n=mh(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},fz(t))dz(e,r);else if(r=Y5(t,e,r,n),r!==null){var i=Qi();Aa(r,t,n,i),gz(r,e,n)}}function kre(t,e,r){var n=mh(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(fz(t))dz(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,Da(a,o)){var l=e.interleaved;l===null?(i.next=i,Q2(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Y5(t,e,i,n),r!==null&&(i=Qi(),Aa(r,t,n,i),gz(r,e,n))}}function fz(t){var e=t.alternate;return t===Gr||e!==null&&e===Gr}function dz(t,e){Hv=Rb=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function gz(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,L2(t,r)}}var Tb={readContext:jo,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},Pre={readContext:jo,useCallback:function(t,e){return pl().memoizedState=[t,e===void 0?null:e],t},useContext:jo,useEffect:_4,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,wx(4194308,4,oz.bind(null,e,t),r)},useLayoutEffect:function(t,e){return wx(4194308,4,t,e)},useInsertionEffect:function(t,e){return wx(4,2,t,e)},useMemo:function(t,e){var r=pl();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=pl();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Tre.bind(null,Gr,t),[n.memoizedState,t]},useRef:function(t){var e=pl();return t={current:t},e.memoizedState=t},useState:b4,useDebugValue:aN,useDeferredValue:function(t){return pl().memoizedState=t},useTransition:function(){var t=b4(!1),e=t[0];return t=Rre.bind(null,t[1]),pl().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Gr,i=pl();if(Nr){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=e(),Zn===null)throw Error(Te(349));md&30||Q5(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,_4(ez.bind(null,n,s,t),[t]),n.flags|=2048,Hw(9,Z5.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=pl(),e=Zn.identifierPrefix;if(Nr){var r=Su,n=Cu;r=(n&~(1<<32-Pa(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Dw++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Ere++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Are={readContext:jo,useCallback:lz,useContext:jo,useEffect:oN,useImperativeHandle:az,useInsertionEffect:iz,useLayoutEffect:sz,useMemo:uz,useReducer:IT,useRef:nz,useState:function(){return IT(Fw)},useDebugValue:aN,useDeferredValue:function(t){var e=Uo();return cz(e,$n.memoizedState,t)},useTransition:function(){var t=IT(Fw)[0],e=Uo().memoizedState;return[t,e]},useMutableSource:q5,useSyncExternalStore:J5,useId:hz,unstable_isNewReconciler:!1},Ire={readContext:jo,useCallback:lz,useContext:jo,useEffect:oN,useImperativeHandle:az,useInsertionEffect:iz,useLayoutEffect:sz,useMemo:uz,useReducer:OT,useRef:nz,useState:function(){return OT(Fw)},useDebugValue:aN,useDeferredValue:function(t){var e=Uo();return $n===null?e.memoizedState=t:cz(e,$n.memoizedState,t)},useTransition:function(){var t=OT(Fw)[0],e=Uo().memoizedState;return[t,e]},useMutableSource:q5,useSyncExternalStore:J5,useId:hz,unstable_isNewReconciler:!1};function wa(t,e){if(t&&t.defaultProps){e=Kr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function eO(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Kr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var pE={isMounted:function(t){return(t=t._reactInternals)?Vd(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Qi(),i=mh(t),s=Ou(n,i);s.payload=e,r!=null&&(s.callback=r),e=dh(t,s,i),e!==null&&(Aa(e,t,i,n),px(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Qi(),i=mh(t),s=Ou(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=dh(t,s,i),e!==null&&(Aa(e,t,i,n),px(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Qi(),n=mh(t),i=Ou(r,n);i.tag=2,e!=null&&(i.callback=e),e=dh(t,i,n),e!==null&&(Aa(e,t,n,r),px(e,t,n))}};function E4(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Pw(r,n)||!Pw(i,s):!0}function mz(t,e,r){var n=!1,i=_h,s=e.contextType;return typeof s=="object"&&s!==null?s=jo(s):(i=Rs(e)?dd:Mi.current,n=e.contextTypes,s=(n=n!=null)?tp(t,i):_h),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pE,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function R4(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&pE.enqueueReplaceState(e,e.state,null)}function tO(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Z2(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=jo(s):(s=Rs(e)?dd:Mi.current,i.context=tp(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(eO(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&pE.enqueueReplaceState(i,i.state,null),_b(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function sp(t,e){try{var r="",n=e;do r+=ste(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function MT(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function rO(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Ore=typeof WeakMap=="function"?WeakMap:Map;function pz(t,e,r){r=Ou(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Pb||(Pb=!0,fO=n),rO(t,e)},r}function vz(t,e,r){r=Ou(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){rO(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){rO(t,e),typeof n!="function"&&(gh===null?gh=new Set([this]):gh.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function T4(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Ore;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=Gre.bind(null,t,e,r),e.then(t,t))}function k4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function P4(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ou(-1,1),e.tag=2,dh(r,e,1))),r.lanes|=1),t)}var Mre=Qu.ReactCurrentOwner,bs=!1;function Ui(t,e,r,n){e.child=t===null?G5(e,null,r,n):np(e,t.child,r,n)}function A4(t,e,r,n,i){r=r.render;var s=e.ref;return $m(e,i),n=iN(t,e,r,n,s,i),r=sN(),t!==null&&!bs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ju(t,e,i)):(Nr&&r&&G2(e),e.flags|=1,Ui(t,e,n,i),e.child)}function I4(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!mN(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,wz(t,e,s,n,i)):(t=xx(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Pw,r(o,n)&&t.ref===e.ref)return ju(t,e,i)}return e.flags|=1,t=ph(s,n),t.ref=e.ref,t.return=e,e.child=t}function wz(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Pw(s,n)&&t.ref===e.ref)if(bs=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(bs=!0);else return e.lanes=t.lanes,ju(t,e,i)}return nO(t,e,r,n,i)}function yz(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(xm,Gs),Gs|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xr(xm,Gs),Gs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,xr(xm,Gs),Gs|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,xr(xm,Gs),Gs|=n;return Ui(t,e,i,r),e.child}function Cz(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function nO(t,e,r,n,i){var s=Rs(r)?dd:Mi.current;return s=tp(e,s),$m(e,i),r=iN(t,e,r,n,s,i),n=sN(),t!==null&&!bs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ju(t,e,i)):(Nr&&n&&G2(e),e.flags|=1,Ui(t,e,r,i),e.child)}function O4(t,e,r,n,i){if(Rs(r)){var s=!0;yb(e)}else s=!1;if($m(e,i),e.stateNode===null)yx(t,e),mz(e,r,n),tO(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=jo(u):(u=Rs(r)?dd:Mi.current,u=tp(e,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==u)&&R4(e,o,n,u),Fc=!1;var f=e.memoizedState;o.state=f,_b(e,n,o,i),l=e.memoizedState,a!==n||f!==l||Es.current||Fc?(typeof c=="function"&&(eO(e,r,c,n),l=e.memoizedState),(a=Fc||E4(e,r,a,n,f,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,K5(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:wa(e.type,a),o.props=u,h=e.pendingProps,f=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=jo(l):(l=Rs(r)?dd:Mi.current,l=tp(e,l));var d=r.getDerivedStateFromProps;(c=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&R4(e,o,n,l),Fc=!1,f=e.memoizedState,o.state=f,_b(e,n,o,i);var g=e.memoizedState;a!==h||f!==g||Es.current||Fc?(typeof d=="function"&&(eO(e,r,d,n),g=e.memoizedState),(u=Fc||E4(e,r,u,n,f,g,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),o.props=n,o.state=g,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return iO(t,e,r,n,s,i)}function iO(t,e,r,n,i,s){Cz(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&v4(e,r,!1),ju(t,e,s);n=e.stateNode,Mre.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=np(e,t.child,null,s),e.child=np(e,null,a,s)):Ui(t,e,a,s),e.memoizedState=n.state,i&&v4(e,r,!0),e.child}function Sz(t){var e=t.stateNode;e.pendingContext?p4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&p4(t,e.context,!1),eN(t,e.containerInfo)}function M4(t,e,r,n,i){return rp(),K2(i),e.flags|=256,Ui(t,e,r,n),e.child}var sO={dehydrated:null,treeContext:null,retryLane:0};function oO(t){return{baseLanes:t,cachePool:null,transitions:null}}function xz(t,e,r){var n=e.pendingProps,i=Wr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),xr(Wr,i&1),t===null)return QI(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=yE(o,n,0,null),t=nd(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=oO(r),e.memoizedState=sO,t):lN(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Nre(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=ph(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ph(a,s):(s=nd(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?oO(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=sO,n}return s=t.child,t=s.sibling,n=ph(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function lN(t,e){return e=yE({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Q1(t,e,r,n){return n!==null&&K2(n),np(e,t.child,null,r),t=lN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Nre(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=MT(Error(Te(422))),Q1(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=yE({mode:"visible",children:n.children},i,0,null),s=nd(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&np(e,t.child,null,o),e.child.memoizedState=oO(o),e.memoizedState=sO,s);if(!(e.mode&1))return Q1(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(Te(419)),n=MT(s,n,void 0),Q1(t,e,o,n)}if(a=(o&t.childLanes)!==0,bs||a){if(n=Zn,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Wu(t,i),Aa(n,t,i,-1))}return gN(),n=MT(Error(Te(421))),Q1(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Yre.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Js=fh(i.nextSibling),eo=e,Nr=!0,xa=null,t!==null&&(Mo[No++]=Cu,Mo[No++]=Su,Mo[No++]=gd,Cu=t.id,Su=t.overflow,gd=e),e=lN(e,n.children),e.flags|=4096,e)}function N4(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),ZI(t.return,e,r)}function NT(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function bz(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Ui(t,e,n.children,r),n=Wr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&N4(t,r,e);else if(t.tag===19)N4(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(xr(Wr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Eb(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),NT(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Eb(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}NT(e,!0,r,null,s);break;case"together":NT(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ju(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),pd|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Te(153));if(e.child!==null){for(t=e.child,r=ph(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ph(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Dre(t,e,r){switch(e.tag){case 3:Sz(e),rp();break;case 5:X5(e);break;case 1:Rs(e.type)&&yb(e);break;case 4:eN(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;xr(xb,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(xr(Wr,Wr.current&1),e.flags|=128,null):r&e.child.childLanes?xz(t,e,r):(xr(Wr,Wr.current&1),t=ju(t,e,r),t!==null?t.sibling:null);xr(Wr,Wr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return bz(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xr(Wr,Wr.current),n)break;return null;case 22:case 23:return e.lanes=0,yz(t,e,r)}return ju(t,e,r)}var _z,aO,Ez,Rz;_z=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};aO=function(){};Ez=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Yf(Ol.current);var s=null;switch(r){case"input":i=PI(t,i),n=PI(t,n),s=[];break;case"select":i=Kr({},i,{value:void 0}),n=Kr({},n,{value:void 0}),s=[];break;case"textarea":i=OI(t,i),n=OI(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=vb)}NI(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(xw.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(a=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(xw.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Er("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Rz=function(t,e,r,n){r!==n&&(e.flags|=4)};function a0(t,e){if(!Nr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function di(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Fre(t,e,r){var n=e.pendingProps;switch(Y2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return di(e),null;case 1:return Rs(e.type)&&wb(),di(e),null;case 3:return n=e.stateNode,ip(),Tr(Es),Tr(Mi),rN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(q1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xa!==null&&(mO(xa),xa=null))),aO(t,e),di(e),null;case 5:tN(e);var i=Yf(Nw.current);if(r=e.type,t!==null&&e.stateNode!=null)Ez(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Te(166));return di(e),null}if(t=Yf(Ol.current),q1(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[bl]=e,n[Ow]=s,t=(e.mode&1)!==0,r){case"dialog":Er("cancel",n),Er("close",n);break;case"iframe":case"object":case"embed":Er("load",n);break;case"video":case"audio":for(i=0;i<yv.length;i++)Er(yv[i],n);break;case"source":Er("error",n);break;case"img":case"image":case"link":Er("error",n),Er("load",n);break;case"details":Er("toggle",n);break;case"input":j$(n,s),Er("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Er("invalid",n);break;case"textarea":z$(n,s),Er("invalid",n)}NI(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&X1(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&X1(n.textContent,a,t),i=["children",""+a]):xw.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Er("scroll",n)}switch(r){case"input":V1(n),U$(n,s,!0);break;case"textarea":V1(n),G$(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=vb)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=e5(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[bl]=e,t[Ow]=n,_z(t,e,!1,!1),e.stateNode=t;e:{switch(o=DI(r,n),r){case"dialog":Er("cancel",t),Er("close",t),i=n;break;case"iframe":case"object":case"embed":Er("load",t),i=n;break;case"video":case"audio":for(i=0;i<yv.length;i++)Er(yv[i],t);i=n;break;case"source":Er("error",t),i=n;break;case"img":case"image":case"link":Er("error",t),Er("load",t),i=n;break;case"details":Er("toggle",t),i=n;break;case"input":j$(t,n),i=PI(t,n),Er("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Kr({},n,{value:void 0}),Er("invalid",t);break;case"textarea":z$(t,n),i=OI(t,n),Er("invalid",t);break;default:i=n}NI(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?n5(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&t5(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&bw(t,l):typeof l=="number"&&bw(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(xw.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Er("scroll",t):l!=null&&O2(t,s,l,o))}switch(r){case"input":V1(t),U$(t,n,!1);break;case"textarea":V1(t),G$(t);break;case"option":n.value!=null&&t.setAttribute("value",""+bh(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Dm(t,!!n.multiple,s,!1):n.defaultValue!=null&&Dm(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=vb)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return di(e),null;case 6:if(t&&e.stateNode!=null)Rz(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Te(166));if(r=Yf(Nw.current),Yf(Ol.current),q1(e)){if(n=e.stateNode,r=e.memoizedProps,n[bl]=e,(s=n.nodeValue!==r)&&(t=eo,t!==null))switch(t.tag){case 3:X1(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&X1(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[bl]=e,e.stateNode=n}return di(e),null;case 13:if(Tr(Wr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Nr&&Js!==null&&e.mode&1&&!(e.flags&128))U5(),rp(),e.flags|=98560,s=!1;else if(s=q1(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Te(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Te(317));s[bl]=e}else rp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;di(e),s=!1}else xa!==null&&(mO(xa),xa=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Wr.current&1?Vn===0&&(Vn=3):gN())),e.updateQueue!==null&&(e.flags|=4),di(e),null);case 4:return ip(),aO(t,e),t===null&&Aw(e.stateNode.containerInfo),di(e),null;case 10:return J2(e.type._context),di(e),null;case 17:return Rs(e.type)&&wb(),di(e),null;case 19:if(Tr(Wr),s=e.memoizedState,s===null)return di(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)a0(s,!1);else{if(Vn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Eb(t),o!==null){for(e.flags|=128,a0(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return xr(Wr,Wr.current&1|2),e.child}t=t.sibling}s.tail!==null&&gn()>op&&(e.flags|=128,n=!0,a0(s,!1),e.lanes=4194304)}else{if(!n)if(t=Eb(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),a0(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Nr)return di(e),null}else 2*gn()-s.renderingStartTime>op&&r!==1073741824&&(e.flags|=128,n=!0,a0(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=gn(),e.sibling=null,r=Wr.current,xr(Wr,n?r&1|2:r&1),e):(di(e),null);case 22:case 23:return dN(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Gs&1073741824&&(di(e),e.subtreeFlags&6&&(e.flags|=8192)):di(e),null;case 24:return null;case 25:return null}throw Error(Te(156,e.tag))}function Hre(t,e){switch(Y2(e),e.tag){case 1:return Rs(e.type)&&wb(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ip(),Tr(Es),Tr(Mi),rN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return tN(e),null;case 13:if(Tr(Wr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Te(340));rp()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Tr(Wr),null;case 4:return ip(),null;case 10:return J2(e.type._context),null;case 22:case 23:return dN(),null;case 24:return null;default:return null}}var Z1=!1,_i=!1,Lre=typeof WeakSet=="function"?WeakSet:Set,Be=null;function Sm(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rn(t,e,n)}else r.current=null}function lO(t,e,r){try{r()}catch(n){rn(t,e,n)}}var D4=!1;function $re(t,e){if(zI=gb,t=I5(),z2(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var d;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===t)break t;if(f===r&&++u===i&&(a=o),f===s&&++c===n&&(l=o),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(GI={focusedElem:t,selectionRange:r},gb=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,p=g.memoizedState,w=e.stateNode,v=w.getSnapshotBeforeUpdate(e.elementType===e.type?m:wa(e.type,m),p);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(b){rn(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return g=D4,D4=!1,g}function Lv(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&lO(e,r,s)}i=i.next}while(i!==n)}}function vE(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function uO(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Tz(t){var e=t.alternate;e!==null&&(t.alternate=null,Tz(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[bl],delete e[Ow],delete e[XI],delete e[Sre],delete e[xre])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function kz(t){return t.tag===5||t.tag===3||t.tag===4}function F4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||kz(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cO(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=vb));else if(n!==4&&(t=t.child,t!==null))for(cO(t,e,r),t=t.sibling;t!==null;)cO(t,e,r),t=t.sibling}function hO(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(hO(t,e,r),t=t.sibling;t!==null;)hO(t,e,r),t=t.sibling}var oi=null,ya=!1;function gc(t,e,r){for(r=r.child;r!==null;)Pz(t,e,r),r=r.sibling}function Pz(t,e,r){if(Il&&typeof Il.onCommitFiberUnmount=="function")try{Il.onCommitFiberUnmount(uE,r)}catch{}switch(r.tag){case 5:_i||Sm(r,e);case 6:var n=oi,i=ya;oi=null,gc(t,e,r),oi=n,ya=i,oi!==null&&(ya?(t=oi,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):oi.removeChild(r.stateNode));break;case 18:oi!==null&&(ya?(t=oi,r=r.stateNode,t.nodeType===8?TT(t.parentNode,r):t.nodeType===1&&TT(t,r),Tw(t)):TT(oi,r.stateNode));break;case 4:n=oi,i=ya,oi=r.stateNode.containerInfo,ya=!0,gc(t,e,r),oi=n,ya=i;break;case 0:case 11:case 14:case 15:if(!_i&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&lO(r,e,o),i=i.next}while(i!==n)}gc(t,e,r);break;case 1:if(!_i&&(Sm(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){rn(r,e,a)}gc(t,e,r);break;case 21:gc(t,e,r);break;case 22:r.mode&1?(_i=(n=_i)||r.memoizedState!==null,gc(t,e,r),_i=n):gc(t,e,r);break;default:gc(t,e,r)}}function H4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Lre),e.forEach(function(n){var i=Kre.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ta(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:oi=a.stateNode,ya=!1;break e;case 3:oi=a.stateNode.containerInfo,ya=!0;break e;case 4:oi=a.stateNode.containerInfo,ya=!0;break e}a=a.return}if(oi===null)throw Error(Te(160));Pz(s,o,i),oi=null,ya=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){rn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Az(e,t),e=e.sibling}function Az(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ta(e,t),za(t),n&4){try{Lv(3,t,t.return),vE(3,t)}catch(m){rn(t,t.return,m)}try{Lv(5,t,t.return)}catch(m){rn(t,t.return,m)}}break;case 1:ta(e,t),za(t),n&512&&r!==null&&Sm(r,r.return);break;case 5:if(ta(e,t),za(t),n&512&&r!==null&&Sm(r,r.return),t.flags&32){var i=t.stateNode;try{bw(i,"")}catch(m){rn(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&QU(i,s),DI(a,o);var u=DI(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?n5(i,h):c==="dangerouslySetInnerHTML"?t5(i,h):c==="children"?bw(i,h):O2(i,c,h,u)}switch(a){case"input":AI(i,s);break;case"textarea":ZU(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Dm(i,!!s.multiple,d,!1):f!==!!s.multiple&&(s.defaultValue!=null?Dm(i,!!s.multiple,s.defaultValue,!0):Dm(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ow]=s}catch(m){rn(t,t.return,m)}}break;case 6:if(ta(e,t),za(t),n&4){if(t.stateNode===null)throw Error(Te(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){rn(t,t.return,m)}}break;case 3:if(ta(e,t),za(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Tw(e.containerInfo)}catch(m){rn(t,t.return,m)}break;case 4:ta(e,t),za(t);break;case 13:ta(e,t),za(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(hN=gn())),n&4&&H4(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(_i=(u=_i)||c,ta(e,t),_i=u):ta(e,t),za(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Be=t,c=t.child;c!==null;){for(h=Be=c;Be!==null;){switch(f=Be,d=f.child,f.tag){case 0:case 11:case 14:case 15:Lv(4,f,f.return);break;case 1:Sm(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){rn(n,r,m)}}break;case 5:Sm(f,f.return);break;case 22:if(f.memoizedState!==null){$4(h);continue}}d!==null?(d.return=f,Be=d):$4(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=r5("display",o))}catch(m){rn(t,t.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){rn(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ta(e,t),za(t),n&4&&H4(t);break;case 21:break;default:ta(e,t),za(t)}}function za(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(kz(r)){var n=r;break e}r=r.return}throw Error(Te(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(bw(i,""),n.flags&=-33);var s=F4(t);hO(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=F4(t);cO(t,a,o);break;default:throw Error(Te(161))}}catch(l){rn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Bre(t,e,r){Be=t,Iz(t)}function Iz(t,e,r){for(var n=(t.mode&1)!==0;Be!==null;){var i=Be,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Z1;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||_i;a=Z1;var u=_i;if(Z1=o,(_i=l)&&!u)for(Be=i;Be!==null;)o=Be,l=o.child,o.tag===22&&o.memoizedState!==null?B4(i):l!==null?(l.return=o,Be=l):B4(i);for(;s!==null;)Be=s,Iz(s),s=s.sibling;Be=i,Z1=a,_i=u}L4(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Be=s):L4(t)}}function L4(t){for(;Be!==null;){var e=Be;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:_i||vE(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!_i)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:wa(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&x4(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}x4(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Tw(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}_i||e.flags&512&&uO(e)}catch(f){rn(e,e.return,f)}}if(e===t){Be=null;break}if(r=e.sibling,r!==null){r.return=e.return,Be=r;break}Be=e.return}}function $4(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Be=r;break}Be=e.return}}function B4(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{vE(4,e)}catch(l){rn(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){rn(e,i,l)}}var s=e.return;try{uO(e)}catch(l){rn(e,s,l)}break;case 5:var o=e.return;try{uO(e)}catch(l){rn(e,o,l)}}}catch(l){rn(e,e.return,l)}if(e===t){Be=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Be=a;break}Be=e.return}}var Vre=Math.ceil,kb=Qu.ReactCurrentDispatcher,uN=Qu.ReactCurrentOwner,Bo=Qu.ReactCurrentBatchConfig,Wt=0,Zn=null,kn=null,ui=0,Gs=0,xm=Nh(0),Vn=0,Lw=null,pd=0,wE=0,cN=0,$v=null,xs=null,hN=0,op=1/0,du=null,Pb=!1,fO=null,gh=null,eC=!1,Xc=null,Ab=0,Bv=0,dO=null,Cx=-1,Sx=0;function Qi(){return Wt&6?gn():Cx!==-1?Cx:Cx=gn()}function mh(t){return t.mode&1?Wt&2&&ui!==0?ui&-ui:_re.transition!==null?(Sx===0&&(Sx=m5()),Sx):(t=lr,t!==0||(t=window.event,t=t===void 0?16:x5(t.type)),t):1}function Aa(t,e,r,n){if(50<Bv)throw Bv=0,dO=null,Error(Te(185));Dy(t,r,n),(!(Wt&2)||t!==Zn)&&(t===Zn&&(!(Wt&2)&&(wE|=r),Vn===4&&Uc(t,ui)),Ts(t,n),r===1&&Wt===0&&!(e.mode&1)&&(op=gn()+500,gE&&Dh()))}function Ts(t,e){var r=t.callbackNode;_te(t,e);var n=db(t,t===Zn?ui:0);if(n===0)r!==null&&X$(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&X$(r),e===1)t.tag===0?bre(V4.bind(null,t)):V5(V4.bind(null,t)),yre(function(){!(Wt&6)&&Dh()}),r=null;else{switch(p5(n)){case 1:r=H2;break;case 4:r=d5;break;case 16:r=fb;break;case 536870912:r=g5;break;default:r=fb}r=$z(r,Oz.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Oz(t,e){if(Cx=-1,Sx=0,Wt&6)throw Error(Te(327));var r=t.callbackNode;if(Bm()&&t.callbackNode!==r)return null;var n=db(t,t===Zn?ui:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ib(t,n);else{e=n;var i=Wt;Wt|=2;var s=Nz();(Zn!==t||ui!==e)&&(du=null,op=gn()+500,rd(t,e));do try{Ure();break}catch(a){Mz(t,a)}while(!0);q2(),kb.current=s,Wt=i,kn!==null?e=0:(Zn=null,ui=0,e=Vn)}if(e!==0){if(e===2&&(i=BI(t),i!==0&&(n=i,e=gO(t,i))),e===1)throw r=Lw,rd(t,0),Uc(t,n),Ts(t,gn()),r;if(e===6)Uc(t,n);else{if(i=t.current.alternate,!(n&30)&&!Wre(i)&&(e=Ib(t,n),e===2&&(s=BI(t),s!==0&&(n=s,e=gO(t,s))),e===1))throw r=Lw,rd(t,0),Uc(t,n),Ts(t,gn()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Te(345));case 2:Ff(t,xs,du);break;case 3:if(Uc(t,n),(n&130023424)===n&&(e=hN+500-gn(),10<e)){if(db(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Qi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=KI(Ff.bind(null,t,xs,du),e);break}Ff(t,xs,du);break;case 4:if(Uc(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-Pa(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=gn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Vre(n/1960))-n,10<n){t.timeoutHandle=KI(Ff.bind(null,t,xs,du),n);break}Ff(t,xs,du);break;case 5:Ff(t,xs,du);break;default:throw Error(Te(329))}}}return Ts(t,gn()),t.callbackNode===r?Oz.bind(null,t):null}function gO(t,e){var r=$v;return t.current.memoizedState.isDehydrated&&(rd(t,e).flags|=256),t=Ib(t,e),t!==2&&(e=xs,xs=r,e!==null&&mO(e)),t}function mO(t){xs===null?xs=t:xs.push.apply(xs,t)}function Wre(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Da(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Uc(t,e){for(e&=~cN,e&=~wE,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Pa(e),n=1<<r;t[r]=-1,e&=~n}}function V4(t){if(Wt&6)throw Error(Te(327));Bm();var e=db(t,0);if(!(e&1))return Ts(t,gn()),null;var r=Ib(t,e);if(t.tag!==0&&r===2){var n=BI(t);n!==0&&(e=n,r=gO(t,n))}if(r===1)throw r=Lw,rd(t,0),Uc(t,e),Ts(t,gn()),r;if(r===6)throw Error(Te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ff(t,xs,du),Ts(t,gn()),null}function fN(t,e){var r=Wt;Wt|=1;try{return t(e)}finally{Wt=r,Wt===0&&(op=gn()+500,gE&&Dh())}}function vd(t){Xc!==null&&Xc.tag===0&&!(Wt&6)&&Bm();var e=Wt;Wt|=1;var r=Bo.transition,n=lr;try{if(Bo.transition=null,lr=1,t)return t()}finally{lr=n,Bo.transition=r,Wt=e,!(Wt&6)&&Dh()}}function dN(){Gs=xm.current,Tr(xm)}function rd(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,wre(r)),kn!==null)for(r=kn.return;r!==null;){var n=r;switch(Y2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&wb();break;case 3:ip(),Tr(Es),Tr(Mi),rN();break;case 5:tN(n);break;case 4:ip();break;case 13:Tr(Wr);break;case 19:Tr(Wr);break;case 10:J2(n.type._context);break;case 22:case 23:dN()}r=r.return}if(Zn=t,kn=t=ph(t.current,null),ui=Gs=e,Vn=0,Lw=null,cN=wE=pd=0,xs=$v=null,Gf!==null){for(e=0;e<Gf.length;e++)if(r=Gf[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Gf=null}return t}function Mz(t,e){do{var r=kn;try{if(q2(),vx.current=Tb,Rb){for(var n=Gr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Rb=!1}if(md=0,Kn=$n=Gr=null,Hv=!1,Dw=0,uN.current=null,r===null||r.return===null){Vn=1,Lw=e,kn=null;break}e:{var s=t,o=r.return,a=r,l=e;if(e=ui,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=k4(o);if(d!==null){d.flags&=-257,P4(d,o,a,s,e),d.mode&1&&T4(s,u,e),e=d,l=u;var g=e.updateQueue;if(g===null){var m=new Set;m.add(l),e.updateQueue=m}else g.add(l);break e}else{if(!(e&1)){T4(s,u,e),gN();break e}l=Error(Te(426))}}else if(Nr&&a.mode&1){var p=k4(o);if(p!==null){!(p.flags&65536)&&(p.flags|=256),P4(p,o,a,s,e),K2(sp(l,a));break e}}s=l=sp(l,a),Vn!==4&&(Vn=2),$v===null?$v=[s]:$v.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=pz(s,l,e);S4(s,w);break e;case 1:a=l;var v=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(gh===null||!gh.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=vz(s,a,e);S4(s,b);break e}}s=s.return}while(s!==null)}Fz(r)}catch(T){e=T,kn===r&&r!==null&&(kn=r=r.return);continue}break}while(!0)}function Nz(){var t=kb.current;return kb.current=Tb,t===null?Tb:t}function gN(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),Zn===null||!(pd&268435455)&&!(wE&268435455)||Uc(Zn,ui)}function Ib(t,e){var r=Wt;Wt|=2;var n=Nz();(Zn!==t||ui!==e)&&(du=null,rd(t,e));do try{jre();break}catch(i){Mz(t,i)}while(!0);if(q2(),Wt=r,kb.current=n,kn!==null)throw Error(Te(261));return Zn=null,ui=0,Vn}function jre(){for(;kn!==null;)Dz(kn)}function Ure(){for(;kn!==null&&!mte();)Dz(kn)}function Dz(t){var e=Lz(t.alternate,t,Gs);t.memoizedProps=t.pendingProps,e===null?Fz(t):kn=e,uN.current=null}function Fz(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Hre(r,e),r!==null){r.flags&=32767,kn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Vn=6,kn=null;return}}else if(r=Fre(r,e,Gs),r!==null){kn=r;return}if(e=e.sibling,e!==null){kn=e;return}kn=e=t}while(e!==null);Vn===0&&(Vn=5)}function Ff(t,e,r){var n=lr,i=Bo.transition;try{Bo.transition=null,lr=1,zre(t,e,r,n)}finally{Bo.transition=i,lr=n}return null}function zre(t,e,r,n){do Bm();while(Xc!==null);if(Wt&6)throw Error(Te(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Te(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Ete(t,s),t===Zn&&(kn=Zn=null,ui=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||eC||(eC=!0,$z(fb,function(){return Bm(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Bo.transition,Bo.transition=null;var o=lr;lr=1;var a=Wt;Wt|=4,uN.current=null,$re(t,r),Az(r,t),hre(GI),gb=!!zI,GI=zI=null,t.current=r,Bre(r),pte(),Wt=a,lr=o,Bo.transition=s}else t.current=r;if(eC&&(eC=!1,Xc=t,Ab=i),s=t.pendingLanes,s===0&&(gh=null),yte(r.stateNode),Ts(t,gn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Pb)throw Pb=!1,t=fO,fO=null,t;return Ab&1&&t.tag!==0&&Bm(),s=t.pendingLanes,s&1?t===dO?Bv++:(Bv=0,dO=t):Bv=0,Dh(),null}function Bm(){if(Xc!==null){var t=p5(Ab),e=Bo.transition,r=lr;try{if(Bo.transition=null,lr=16>t?16:t,Xc===null)var n=!1;else{if(t=Xc,Xc=null,Ab=0,Wt&6)throw Error(Te(331));var i=Wt;for(Wt|=4,Be=t.current;Be!==null;){var s=Be,o=s.child;if(Be.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Be=u;Be!==null;){var c=Be;switch(c.tag){case 0:case 11:case 15:Lv(8,c,s)}var h=c.child;if(h!==null)h.return=c,Be=h;else for(;Be!==null;){c=Be;var f=c.sibling,d=c.return;if(Tz(c),c===u){Be=null;break}if(f!==null){f.return=d,Be=f;break}Be=d}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var p=m.sibling;m.sibling=null,m=p}while(m!==null)}}Be=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Be=o;else e:for(;Be!==null;){if(s=Be,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Lv(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Be=w;break e}Be=s.return}}var v=t.current;for(Be=v;Be!==null;){o=Be;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,Be=y;else e:for(o=v;Be!==null;){if(a=Be,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:vE(9,a)}}catch(T){rn(a,a.return,T)}if(a===o){Be=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,Be=b;break e}Be=a.return}}if(Wt=i,Dh(),Il&&typeof Il.onPostCommitFiberRoot=="function")try{Il.onPostCommitFiberRoot(uE,t)}catch{}n=!0}return n}finally{lr=r,Bo.transition=e}}return!1}function W4(t,e,r){e=sp(r,e),e=pz(t,e,1),t=dh(t,e,1),e=Qi(),t!==null&&(Dy(t,1,e),Ts(t,e))}function rn(t,e,r){if(t.tag===3)W4(t,t,r);else for(;e!==null;){if(e.tag===3){W4(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(gh===null||!gh.has(n))){t=sp(r,t),t=vz(e,t,1),e=dh(e,t,1),t=Qi(),e!==null&&(Dy(e,1,t),Ts(e,t));break}}e=e.return}}function Gre(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Qi(),t.pingedLanes|=t.suspendedLanes&r,Zn===t&&(ui&r)===r&&(Vn===4||Vn===3&&(ui&130023424)===ui&&500>gn()-hN?rd(t,0):cN|=r),Ts(t,e)}function Hz(t,e){e===0&&(t.mode&1?(e=U1,U1<<=1,!(U1&130023424)&&(U1=4194304)):e=1);var r=Qi();t=Wu(t,e),t!==null&&(Dy(t,e,r),Ts(t,r))}function Yre(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Hz(t,r)}function Kre(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Te(314))}n!==null&&n.delete(e),Hz(t,r)}var Lz;Lz=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Es.current)bs=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return bs=!1,Dre(t,e,r);bs=!!(t.flags&131072)}else bs=!1,Nr&&e.flags&1048576&&W5(e,Sb,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;yx(t,e),t=e.pendingProps;var i=tp(e,Mi.current);$m(e,r),i=iN(null,e,n,t,i,r);var s=sN();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rs(n)?(s=!0,yb(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Z2(e),i.updater=pE,e.stateNode=i,i._reactInternals=e,tO(e,n,t,r),e=iO(null,e,n,!0,s,r)):(e.tag=0,Nr&&s&&G2(e),Ui(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(yx(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=qre(n),t=wa(n,t),i){case 0:e=nO(null,e,n,t,r);break e;case 1:e=O4(null,e,n,t,r);break e;case 11:e=A4(null,e,n,t,r);break e;case 14:e=I4(null,e,n,wa(n.type,t),r);break e}throw Error(Te(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:wa(n,i),nO(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:wa(n,i),O4(t,e,n,i,r);case 3:e:{if(Sz(e),t===null)throw Error(Te(387));n=e.pendingProps,s=e.memoizedState,i=s.element,K5(t,e),_b(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=sp(Error(Te(423)),e),e=M4(t,e,n,r,i);break e}else if(n!==i){i=sp(Error(Te(424)),e),e=M4(t,e,n,r,i);break e}else for(Js=fh(e.stateNode.containerInfo.firstChild),eo=e,Nr=!0,xa=null,r=G5(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(rp(),n===i){e=ju(t,e,r);break e}Ui(t,e,n,r)}e=e.child}return e;case 5:return X5(e),t===null&&QI(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,YI(n,i)?o=null:s!==null&&YI(n,s)&&(e.flags|=32),Cz(t,e),Ui(t,e,o,r),e.child;case 6:return t===null&&QI(e),null;case 13:return xz(t,e,r);case 4:return eN(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=np(e,null,n,r):Ui(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:wa(n,i),A4(t,e,n,i,r);case 7:return Ui(t,e,e.pendingProps,r),e.child;case 8:return Ui(t,e,e.pendingProps.children,r),e.child;case 12:return Ui(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,xr(xb,n._currentValue),n._currentValue=o,s!==null)if(Da(s.value,o)){if(s.children===i.children&&!Es.current){e=ju(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ou(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),ZI(s.return,r,e),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Te(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),ZI(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ui(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,$m(e,r),i=jo(i),n=n(i),e.flags|=1,Ui(t,e,n,r),e.child;case 14:return n=e.type,i=wa(n,e.pendingProps),i=wa(n.type,i),I4(t,e,n,i,r);case 15:return wz(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:wa(n,i),yx(t,e),e.tag=1,Rs(n)?(t=!0,yb(e)):t=!1,$m(e,r),mz(e,n,i),tO(e,n,i,r),iO(null,e,n,!0,t,r);case 19:return bz(t,e,r);case 22:return yz(t,e,r)}throw Error(Te(156,e.tag))};function $z(t,e){return f5(t,e)}function Xre(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lo(t,e,r,n){return new Xre(t,e,r,n)}function mN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qre(t){if(typeof t=="function")return mN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===N2)return 11;if(t===D2)return 14}return 2}function ph(t,e){var r=t.alternate;return r===null?(r=Lo(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function xx(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")mN(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case fm:return nd(r.children,i,s,e);case M2:o=8,i|=8;break;case EI:return t=Lo(12,r,e,i|2),t.elementType=EI,t.lanes=s,t;case RI:return t=Lo(13,r,e,i),t.elementType=RI,t.lanes=s,t;case TI:return t=Lo(19,r,e,i),t.elementType=TI,t.lanes=s,t;case XU:return yE(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case YU:o=10;break e;case KU:o=9;break e;case N2:o=11;break e;case D2:o=14;break e;case Dc:o=16,n=null;break e}throw Error(Te(130,t==null?t:typeof t,""))}return e=Lo(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function nd(t,e,r,n){return t=Lo(7,t,n,e),t.lanes=r,t}function yE(t,e,r,n){return t=Lo(22,t,n,e),t.elementType=XU,t.lanes=r,t.stateNode={isHidden:!1},t}function DT(t,e,r){return t=Lo(6,t,null,e),t.lanes=r,t}function FT(t,e,r){return e=Lo(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Jre(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pT(0),this.expirationTimes=pT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pT(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function pN(t,e,r,n,i,s,o,a,l){return t=new Jre(t,e,r,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Lo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Z2(s),t}function Qre(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hm,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Bz(t){if(!t)return _h;t=t._reactInternals;e:{if(Vd(t)!==t||t.tag!==1)throw Error(Te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Te(171))}if(t.tag===1){var r=t.type;if(Rs(r))return B5(t,r,e)}return e}function Vz(t,e,r,n,i,s,o,a,l){return t=pN(r,n,!0,t,i,s,o,a,l),t.context=Bz(null),r=t.current,n=Qi(),i=mh(r),s=Ou(n,i),s.callback=e??null,dh(r,s,i),t.current.lanes=i,Dy(t,i,n),Ts(t,n),t}function CE(t,e,r,n){var i=e.current,s=Qi(),o=mh(i);return r=Bz(r),e.context===null?e.context=r:e.pendingContext=r,e=Ou(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=dh(i,e,o),t!==null&&(Aa(t,i,o,s),px(t,i,o)),o}function Ob(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function j4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function vN(t,e){j4(t,e),(t=t.alternate)&&j4(t,e)}function Zre(){return null}var Wz=typeof reportError=="function"?reportError:function(t){console.error(t)};function wN(t){this._internalRoot=t}SE.prototype.render=wN.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Te(409));CE(t,e,null,null)};SE.prototype.unmount=wN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vd(function(){CE(null,t,null,null)}),e[Vu]=null}};function SE(t){this._internalRoot=t}SE.prototype.unstable_scheduleHydration=function(t){if(t){var e=y5();t={blockedOn:null,target:t,priority:e};for(var r=0;r<jc.length&&e!==0&&e<jc[r].priority;r++);jc.splice(r,0,t),r===0&&S5(t)}};function yN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function xE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function U4(){}function ene(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=Ob(o);s.call(u)}}var o=Vz(e,n,t,0,null,!1,!1,"",U4);return t._reactRootContainer=o,t[Vu]=o.current,Aw(t.nodeType===8?t.parentNode:t),vd(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var u=Ob(l);a.call(u)}}var l=pN(t,0,!1,null,null,!1,!1,"",U4);return t._reactRootContainer=l,t[Vu]=l.current,Aw(t.nodeType===8?t.parentNode:t),vd(function(){CE(e,l,r,n)}),l}function bE(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ob(o);a.call(l)}}CE(e,o,t,i)}else o=ene(r,e,t,i,n);return Ob(o)}v5=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=wv(e.pendingLanes);r!==0&&(L2(e,r|1),Ts(e,gn()),!(Wt&6)&&(op=gn()+500,Dh()))}break;case 13:vd(function(){var n=Wu(t,1);if(n!==null){var i=Qi();Aa(n,t,1,i)}}),vN(t,1)}};$2=function(t){if(t.tag===13){var e=Wu(t,134217728);if(e!==null){var r=Qi();Aa(e,t,134217728,r)}vN(t,134217728)}};w5=function(t){if(t.tag===13){var e=mh(t),r=Wu(t,e);if(r!==null){var n=Qi();Aa(r,t,e,n)}vN(t,e)}};y5=function(){return lr};C5=function(t,e){var r=lr;try{return lr=t,e()}finally{lr=r}};HI=function(t,e,r){switch(e){case"input":if(AI(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=dE(n);if(!i)throw Error(Te(90));JU(n),AI(n,i)}}}break;case"textarea":ZU(t,r);break;case"select":e=r.value,e!=null&&Dm(t,!!r.multiple,e,!1)}};o5=fN;a5=vd;var tne={usingClientEntryPoint:!1,Events:[Hy,pm,dE,i5,s5,fN]},l0={findFiberByHostInstance:zf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rne={bundleType:l0.bundleType,version:l0.version,rendererPackageName:l0.rendererPackageName,rendererConfig:l0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qu.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=c5(t),t===null?null:t.stateNode},findFiberByHostInstance:l0.findFiberByHostInstance||Zre,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tC.isDisabled&&tC.supportsFiber)try{uE=tC.inject(rne),Il=tC}catch{}}lo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tne;lo.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yN(e))throw Error(Te(200));return Qre(t,e,null,r)};lo.createRoot=function(t,e){if(!yN(t))throw Error(Te(299));var r=!1,n="",i=Wz;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=pN(t,1,!1,null,null,r,!1,n,i),t[Vu]=e.current,Aw(t.nodeType===8?t.parentNode:t),new wN(e)};lo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Te(188)):(t=Object.keys(t).join(","),Error(Te(268,t)));return t=c5(e),t=t===null?null:t.stateNode,t};lo.flushSync=function(t){return vd(t)};lo.hydrate=function(t,e,r){if(!xE(e))throw Error(Te(200));return bE(null,t,e,!0,r)};lo.hydrateRoot=function(t,e,r){if(!yN(t))throw Error(Te(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Wz;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Vz(e,null,t,1,r??null,i,!1,s,o),t[Vu]=e.current,Aw(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new SE(e)};lo.render=function(t,e,r){if(!xE(e))throw Error(Te(200));return bE(null,t,e,!1,r)};lo.unmountComponentAtNode=function(t){if(!xE(t))throw Error(Te(40));return t._reactRootContainer?(vd(function(){bE(null,null,t,!1,function(){t._reactRootContainer=null,t[Vu]=null})}),!0):!1};lo.unstable_batchedUpdates=fN;lo.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!xE(r))throw Error(Te(200));if(t==null||t._reactInternals===void 0)throw Error(Te(38));return bE(t,e,r,!1,n)};lo.version="18.3.1-next-f1338f8080-20240426";function jz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jz)}catch(t){console.error(t)}}jz(),jU.exports=lo;var Uz=jU.exports;const zz=aE(Uz);var z4=Uz;bI.createRoot=z4.createRoot,bI.hydrateRoot=z4.hydrateRoot;var Gz={exports:{}},Yz={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $y=pe;function nne(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ine=typeof Object.is=="function"?Object.is:nne,sne=$y.useSyncExternalStore,one=$y.useRef,ane=$y.useEffect,lne=$y.useMemo,une=$y.useDebugValue;Yz.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=one(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=lne(function(){function l(d){if(!u){if(u=!0,c=d,d=n(d),i!==void 0&&o.hasValue){var g=o.value;if(i(g,d))return h=g}return h=d}if(g=h,ine(c,d))return g;var m=n(d);return i!==void 0&&i(g,m)?(c=d,g):(c=d,h=m)}var u=!1,c,h,f=r===void 0?null:r;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,r,n,i]);var a=sne(t,s[0],s[1]);return ane(function(){o.hasValue=!0,o.value=a},[a]),une(a),a};Gz.exports=Yz;var cne=Gz.exports;function hne(t){t()}function fne(){let t=null,e=null;return{clear(){t=null,e=null},notify(){hne(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var G4={notify(){},get:()=>[]};function dne(t,e){let r,n=G4,i=0,s=!1;function o(m){c();const p=n.subscribe(m);let w=!1;return()=>{w||(w=!0,p(),h())}}function a(){n.notify()}function l(){g.onStateChange&&g.onStateChange()}function u(){return s}function c(){i++,r||(r=t.subscribe(l),n=fne())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=G4)}function f(){s||(s=!0,c())}function d(){s&&(s=!1,h())}const g={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:u,trySubscribe:f,tryUnsubscribe:d,getListeners:()=>n};return g}var gne=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",mne=gne(),pne=()=>typeof navigator<"u"&&navigator.product==="ReactNative",vne=pne(),wne=()=>mne||vne?pe.useLayoutEffect:pe.useEffect,yne=wne(),HT=Symbol.for("react-redux-context"),LT=typeof globalThis<"u"?globalThis:{};function Cne(){if(!pe.createContext)return{};const t=LT[HT]??(LT[HT]=new Map);let e=t.get(pe.createContext);return e||(e=pe.createContext(null),t.set(pe.createContext,e)),e}var Eh=Cne();function Sne(t){const{children:e,context:r,serverState:n,store:i}=t,s=pe.useMemo(()=>{const l=dne(i);return{store:i,subscription:l,getServerState:n?()=>n:void 0}},[i,n]),o=pe.useMemo(()=>i.getState(),[i]);yne(()=>{const{subscription:l}=s;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[s,o]);const a=r||Eh;return pe.createElement(a.Provider,{value:s},e)}var xne=Sne;function CN(t=Eh){return function(){return pe.useContext(t)}}var Kz=CN();function Xz(t=Eh){const e=t===Eh?Kz:CN(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var bne=Xz();function _ne(t=Eh){const e=t===Eh?bne:Xz(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var By=_ne(),Ene=(t,e)=>t===e;function Rne(t=Eh){const e=t===Eh?Kz:CN(t),r=(n,i={})=>{const{equalityFn:s=Ene}=typeof i=="function"?{equalityFn:i}:i,o=e(),{store:a,subscription:l,getServerState:u}=o;pe.useRef(!0);const c=pe.useCallback({[n.name](f){return n(f)}}[n.name],[n]),h=cne.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,u||a.getState,c,s);return pe.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var Vy=Rne();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $w(){return $w=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$w.apply(this,arguments)}var qc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(qc||(qc={}));const Y4="popstate";function Tne(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return pO("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Mb(i)}return Pne(e,r,null,t)}function Yr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qz(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function kne(){return Math.random().toString(36).substr(2,8)}function K4(t,e){return{usr:t.state,key:t.key,idx:e}}function pO(t,e,r,n){return r===void 0&&(r=null),$w({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Pp(e):e,{state:r,key:e&&e.key||n||kne()})}function Mb(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Pp(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Pne(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=qc.Pop,l=null,u=c();u==null&&(u=0,o.replaceState($w({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=qc.Pop;let p=c(),w=p==null?null:p-u;u=p,l&&l({action:a,location:m.location,delta:w})}function f(p,w){a=qc.Push;let v=pO(m.location,p,w);u=c()+1;let y=K4(v,u),b=m.createHref(v);try{o.pushState(y,"",b)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(b)}s&&l&&l({action:a,location:m.location,delta:1})}function d(p,w){a=qc.Replace;let v=pO(m.location,p,w);u=c();let y=K4(v,u),b=m.createHref(v);o.replaceState(y,"",b),s&&l&&l({action:a,location:m.location,delta:0})}function g(p){let w=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof p=="string"?p:Mb(p);return v=v.replace(/ $/,"%20"),Yr(w,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,w)}let m={get action(){return a},get location(){return t(i,o)},listen(p){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Y4,h),l=p,()=>{i.removeEventListener(Y4,h),l=null}},createHref(p){return e(i,p)},createURL:g,encodeLocation(p){let w=g(p);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:d,go(p){return o.go(p)}};return m}var X4;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(X4||(X4={}));function Ane(t,e,r){return r===void 0&&(r="/"),Ine(t,e,r)}function Ine(t,e,r,n){let i=typeof e=="string"?Pp(e):e,s=ap(i.pathname||"/",r);if(s==null)return null;let o=Jz(t);One(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=jne(s);a=Vne(o[l],u)}return a}function Jz(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Yr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=vh([n,l.relativePath]),c=r.concat(l);s.children&&s.children.length>0&&(Yr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Jz(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:$ne(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of Qz(s.path))i(s,o,l)}),e}function Qz(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=Qz(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function One(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Bne(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Mne=/^:[\w-]+$/,Nne=3,Dne=2,Fne=1,Hne=10,Lne=-2,q4=t=>t==="*";function $ne(t,e){let r=t.split("/"),n=r.length;return r.some(q4)&&(n+=Lne),e&&(n+=Dne),r.filter(i=>!q4(i)).reduce((i,s)=>i+(Mne.test(s)?Nne:s===""?Fne:Hne),n)}function Bne(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Vne(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],u=a===n.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=vO({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),f=l.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:vh([s,h.pathname]),pathnameBase:Yne(vh([s,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(s=vh([s,h.pathnameBase]))}return o}function vO(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=Wne(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((u,c,h)=>{let{paramName:f,isOptional:d}=c;if(f==="*"){let m=a[h]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=a[h];return d&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function Wne(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),qz(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function jne(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qz(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ap(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function Une(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Pp(t):t;return{pathname:r?r.startsWith("/")?r:zne(r,e):e,search:Kne(n),hash:Xne(i)}}function zne(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function $T(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Gne(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function SN(t,e){let r=Gne(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function xN(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Pp(t):(i=$w({},t),Yr(!i.pathname||!i.pathname.includes("?"),$T("?","pathname","search",i)),Yr(!i.pathname||!i.pathname.includes("#"),$T("#","pathname","hash",i)),Yr(!i.search||!i.search.includes("#"),$T("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;i.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=Une(i,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const vh=t=>t.join("/").replace(/\/\/+/g,"/"),Yne=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Kne=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Xne=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function qne(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Zz=["post","put","patch","delete"];new Set(Zz);const Jne=["get",...Zz];new Set(Jne);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bw(){return Bw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bw.apply(this,arguments)}const _E=pe.createContext(null),e7=pe.createContext(null),Zu=pe.createContext(null),EE=pe.createContext(null),ec=pe.createContext({outlet:null,matches:[],isDataRoute:!1}),t7=pe.createContext(null);function Qne(t,e){let{relative:r}=e===void 0?{}:e;Ap()||Yr(!1);let{basename:n,navigator:i}=pe.useContext(Zu),{hash:s,pathname:o,search:a}=TE(t,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:vh([n,o])),i.createHref({pathname:l,search:a,hash:s})}function Ap(){return pe.useContext(EE)!=null}function Fh(){return Ap()||Yr(!1),pe.useContext(EE).location}function r7(t){pe.useContext(Zu).static||pe.useLayoutEffect(t)}function RE(){let{isDataRoute:t}=pe.useContext(ec);return t?die():Zne()}function Zne(){Ap()||Yr(!1);let t=pe.useContext(_E),{basename:e,future:r,navigator:n}=pe.useContext(Zu),{matches:i}=pe.useContext(ec),{pathname:s}=Fh(),o=JSON.stringify(SN(i,r.v7_relativeSplatPath)),a=pe.useRef(!1);return r7(()=>{a.current=!0}),pe.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){n.go(u);return}let h=xN(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:vh([e,h.pathname])),(c.replace?n.replace:n.push)(h,c.state,c)},[e,n,o,s,t])}const eie=pe.createContext(null);function tie(t){let e=pe.useContext(ec).outlet;return e&&pe.createElement(eie.Provider,{value:t},e)}function TE(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=pe.useContext(Zu),{matches:i}=pe.useContext(ec),{pathname:s}=Fh(),o=JSON.stringify(SN(i,n.v7_relativeSplatPath));return pe.useMemo(()=>xN(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function rie(t,e){return nie(t,e)}function nie(t,e,r,n){Ap()||Yr(!1);let{navigator:i}=pe.useContext(Zu),{matches:s}=pe.useContext(ec),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Fh(),c;if(e){var h;let p=typeof e=="string"?Pp(e):e;l==="/"||(h=p.pathname)!=null&&h.startsWith(l)||Yr(!1),c=p}else c=u;let f=c.pathname||"/",d=f;if(l!=="/"){let p=l.replace(/^\//,"").split("/");d="/"+f.replace(/^\//,"").split("/").slice(p.length).join("/")}let g=Ane(t,{pathname:d}),m=lie(g&&g.map(p=>Object.assign({},p,{params:Object.assign({},a,p.params),pathname:vh([l,i.encodeLocation?i.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?l:vh([l,i.encodeLocation?i.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),s,r,n);return e&&m?pe.createElement(EE.Provider,{value:{location:Bw({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:qc.Pop}},m):m}function iie(){let t=fie(),e=qne(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return pe.createElement(pe.Fragment,null,pe.createElement("h2",null,"Unexpected Application Error!"),pe.createElement("h3",{style:{fontStyle:"italic"}},e),r?pe.createElement("pre",{style:i},r):null,null)}const sie=pe.createElement(iie,null);class oie extends pe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?pe.createElement(ec.Provider,{value:this.props.routeContext},pe.createElement(t7.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function aie(t){let{routeContext:e,match:r,children:n}=t,i=pe.useContext(_E);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),pe.createElement(ec.Provider,{value:e},n)}function lie(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let c=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);c>=0||Yr(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<o.length;c++){let h=o[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:f,errors:d}=r,g=h.route.loader&&f[h.route.id]===void 0&&(!d||d[h.route.id]===void 0);if(h.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,h,f)=>{let d,g=!1,m=null,p=null;r&&(d=a&&h.route.id?a[h.route.id]:void 0,m=h.route.errorElement||sie,l&&(u<0&&f===0?(gie("route-fallback"),g=!0,p=null):u===f&&(g=!0,p=h.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,f+1)),v=()=>{let y;return d?y=m:g?y=p:h.route.Component?y=pe.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=c,pe.createElement(aie,{match:h,routeContext:{outlet:c,matches:w,isDataRoute:r!=null},children:y})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?pe.createElement(oie,{location:r.location,revalidation:r.revalidation,component:m,error:d,children:v(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):v()},null)}var n7=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(n7||{}),i7=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(i7||{});function uie(t){let e=pe.useContext(_E);return e||Yr(!1),e}function cie(t){let e=pe.useContext(e7);return e||Yr(!1),e}function hie(t){let e=pe.useContext(ec);return e||Yr(!1),e}function s7(t){let e=hie(),r=e.matches[e.matches.length-1];return r.route.id||Yr(!1),r.route.id}function fie(){var t;let e=pe.useContext(t7),r=cie(),n=s7();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function die(){let{router:t}=uie(n7.UseNavigateStable),e=s7(i7.UseNavigateStable),r=pe.useRef(!1);return r7(()=>{r.current=!0}),pe.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Bw({fromRouteId:e},s)))},[t,e])}const J4={};function gie(t,e,r){J4[t]||(J4[t]=!0)}function mie(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function pie(t){let{to:e,replace:r,state:n,relative:i}=t;Ap()||Yr(!1);let{future:s,static:o}=pe.useContext(Zu),{matches:a}=pe.useContext(ec),{pathname:l}=Fh(),u=RE(),c=xN(e,SN(a,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(c);return pe.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:i}),[u,h,i,r,n]),null}function o7(t){return tie(t.context)}function Vi(t){Yr(!1)}function vie(t){let{basename:e="/",children:r=null,location:n,navigationType:i=qc.Pop,navigator:s,static:o=!1,future:a}=t;Ap()&&Yr(!1);let l=e.replace(/^\/*/,"/"),u=pe.useMemo(()=>({basename:l,navigator:s,static:o,future:Bw({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof n=="string"&&(n=Pp(n));let{pathname:c="/",search:h="",hash:f="",state:d=null,key:g="default"}=n,m=pe.useMemo(()=>{let p=ap(c,l);return p==null?null:{location:{pathname:p,search:h,hash:f,state:d,key:g},navigationType:i}},[l,c,h,f,d,g,i]);return m==null?null:pe.createElement(Zu.Provider,{value:u},pe.createElement(EE.Provider,{children:r,value:m}))}function wie(t){let{children:e,location:r}=t;return rie(wO(e),r)}new Promise(()=>{});function wO(t,e){e===void 0&&(e=[]);let r=[];return pe.Children.forEach(t,(n,i)=>{if(!pe.isValidElement(n))return;let s=[...e,i];if(n.type===pe.Fragment){r.push.apply(r,wO(n.props.children,s));return}n.type!==Vi&&Yr(!1),!n.props.index||!n.props.children||Yr(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=wO(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nb(){return Nb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nb.apply(this,arguments)}function a7(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function yie(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Cie(t,e){return t.button===0&&(!e||e==="_self")&&!yie(t)}const Sie=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],xie=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],bie="6";try{window.__reactRouterVersion=bie}catch{}const _ie=pe.createContext({isTransitioning:!1}),Eie="startTransition",Q4=Gee[Eie];function Rie(t){let{basename:e,children:r,future:n,window:i}=t,s=pe.useRef();s.current==null&&(s.current=Tne({window:i,v5Compat:!0}));let o=s.current,[a,l]=pe.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},c=pe.useCallback(h=>{u&&Q4?Q4(()=>l(h)):l(h)},[l,u]);return pe.useLayoutEffect(()=>o.listen(c),[o,c]),pe.useEffect(()=>mie(n),[n]),pe.createElement(vie,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const Tie=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hc=pe.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h}=e,f=a7(e,Sie),{basename:d}=pe.useContext(Zu),g,m=!1;if(typeof u=="string"&&kie.test(u)&&(g=u,Tie))try{let y=new URL(window.location.href),b=u.startsWith("//")?new URL(y.protocol+u):new URL(u),T=ap(b.pathname,d);b.origin===y.origin&&T!=null?u=T+b.search+b.hash:m=!0}catch{}let p=Qne(u,{relative:i}),w=Aie(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:i,viewTransition:h});function v(y){n&&n(y),y.defaultPrevented||w(y)}return pe.createElement("a",Nb({},f,{href:g||p,onClick:m||s?n:v,ref:r,target:l}))}),Zg=pe.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:o=!1,style:a,to:l,viewTransition:u,children:c}=e,h=a7(e,xie),f=TE(l,{relative:h.relative}),d=Fh(),g=pe.useContext(e7),{navigator:m,basename:p}=pe.useContext(Zu),w=g!=null&&Iie(f)&&u===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=d.pathname,b=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;i||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=ap(b,p)||b);const T=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let E=y===v||!o&&y.startsWith(v)&&y.charAt(T)==="/",x=b!=null&&(b===v||!o&&b.startsWith(v)&&b.charAt(v.length)==="/"),P={isActive:E,isPending:x,isTransitioning:w},A=E?n:void 0,O;typeof s=="function"?O=s(P):O=[s,E?"active":null,x?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let Y=typeof a=="function"?a(P):a;return pe.createElement(Hc,Nb({},h,{"aria-current":A,className:O,ref:r,style:Y,to:l,viewTransition:u}),typeof c=="function"?c(P):c)});var yO;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(yO||(yO={}));var Z4;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Z4||(Z4={}));function Pie(t){let e=pe.useContext(_E);return e||Yr(!1),e}function Aie(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=RE(),u=Fh(),c=TE(t,{relative:o});return pe.useCallback(h=>{if(Cie(h,r)){h.preventDefault();let f=n!==void 0?n:Mb(u)===Mb(c);l(t,{replace:f,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,c,n,i,r,t,s,o,a])}function Iie(t,e){e===void 0&&(e={});let r=pe.useContext(_ie);r==null&&Yr(!1);let{basename:n}=Pie(yO.useViewTransitionState),i=TE(t,{relative:e.relative});if(!r.isTransitioning)return!1;let s=ap(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=ap(r.nextLocation.pathname,n)||r.nextLocation.pathname;return vO(i.pathname,o)!=null||vO(i.pathname,s)!=null}function bx(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bx=function(r){return typeof r}:bx=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},bx(t)}function Oie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Nie(t,e,r){return e&&Mie(t.prototype,e),t}function Die(t,e){return e&&(bx(e)==="object"||typeof e=="function")?e:_x(t)}function CO(t){return CO=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},CO(t)}function _x(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fie(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&SO(t,e)}function SO(t,e){return SO=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},SO(t,e)}function Ex(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l7=function(t){Fie(e,t);function e(){var r,n;Oie(this,e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n=Die(this,(r=CO(e)).call.apply(r,[this].concat(s))),Ex(_x(n),"state",{bootstrapped:!1}),Ex(_x(n),"_unsubscribe",void 0),Ex(_x(n),"handlePersistorState",function(){var a=n.props.persistor,l=a.getState(),u=l.bootstrapped;u&&(n.props.onBeforeLift?Promise.resolve(n.props.onBeforeLift()).finally(function(){return n.setState({bootstrapped:!0})}):n.setState({bootstrapped:!0}),n._unsubscribe&&n._unsubscribe())}),n}return Nie(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(pe.PureComponent);Ex(l7,"defaultProps",{children:null,loading:null});function u7(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=u7(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function id(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=u7(t))&&(n&&(n+=" "),n+=e);return n}function Hie(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}Hie(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Wy=t=>typeof t=="number"&&!isNaN(t),wd=t=>typeof t=="string",Uu=t=>typeof t=="function",Lie=t=>wd(t)||Wy(t),xO=t=>wd(t)||Uu(t)?t:null,$ie=(t,e)=>t===!1||Wy(t)&&t>0?t:e,bO=t=>pe.isValidElement(t)||wd(t)||Uu(t)||Wy(t);function Bie(t,e,r=300){let{scrollHeight:n,style:i}=t;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,r)})})}function Vie({enter:t,exit:e,appendPosition:r=!1,collapse:n=!0,collapseDuration:i=300}){return function({children:s,position:o,preventExitTransition:a,done:l,nodeRef:u,isIn:c,playToast:h}){let f=r?`${t}--${o}`:t,d=r?`${e}--${o}`:e,g=pe.useRef(0);return pe.useLayoutEffect(()=>{let m=u.current,p=f.split(" "),w=v=>{v.target===u.current&&(h(),m.removeEventListener("animationend",w),m.removeEventListener("animationcancel",w),g.current===0&&v.type!=="animationcancel"&&m.classList.remove(...p))};m.classList.add(...p),m.addEventListener("animationend",w),m.addEventListener("animationcancel",w)},[]),pe.useEffect(()=>{let m=u.current,p=()=>{m.removeEventListener("animationend",p),n?Bie(m,l,i):l()};c||(a?p():(g.current=1,m.className+=` ${d}`,m.addEventListener("animationend",p)))},[c]),Ge.createElement(Ge.Fragment,null,s)}}function e3(t,e){return{content:c7(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function c7(t,e,r=!1){return pe.isValidElement(t)&&!wd(t.type)?pe.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):Uu(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):t}function Wie({closeToast:t,theme:e,ariaLabel:r="close"}){return Ge.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:n=>{n.stopPropagation(),t(!0)},"aria-label":r},Ge.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ge.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function jie({delay:t,isRunning:e,closeToast:r,type:n="default",hide:i,className:s,controlledProgress:o,progress:a,rtl:l,isIn:u,theme:c}){let h=i||o&&a===0,f={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};o&&(f.transform=`scaleX(${a})`);let d=id("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${c}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":l}),g=Uu(s)?s({rtl:l,type:n,defaultClassName:d}):id(d,s),m={[o&&a>=1?"onTransitionEnd":"onAnimationEnd"]:o&&a<1?null:()=>{u&&r()}};return Ge.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},Ge.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${c} Toastify__progress-bar--${n}`}),Ge.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:g,style:f,...m}))}var Uie=1,h7=()=>`${Uie++}`;function zie(t,e,r){let n=1,i=0,s=[],o=[],a=e,l=new Map,u=new Set,c=v=>(u.add(v),()=>u.delete(v)),h=()=>{o=Array.from(l.values()),u.forEach(v=>v())},f=({containerId:v,toastId:y,updateId:b})=>{let T=v?v!==t:t!==1,E=l.has(y)&&b==null;return T||E},d=(v,y)=>{l.forEach(b=>{var T;(y==null||y===b.props.toastId)&&((T=b.toggle)==null||T.call(b,v))})},g=v=>{var y,b;(b=(y=v.props)==null?void 0:y.onClose)==null||b.call(y,v.removalReason),v.isActive=!1},m=v=>{if(v==null)l.forEach(g);else{let y=l.get(v);y&&g(y)}h()},p=()=>{i-=s.length,s=[]},w=v=>{var y,b;let{toastId:T,updateId:E}=v.props,x=E==null;v.staleId&&l.delete(v.staleId),v.isActive=!0,l.set(T,v),h(),r(e3(v,x?"added":"updated")),x&&((b=(y=v.props).onOpen)==null||b.call(y))};return{id:t,props:a,observe:c,toggle:d,removeToast:m,toasts:l,clearQueue:p,buildToast:(v,y)=>{if(f(y))return;let{toastId:b,updateId:T,data:E,staleId:x,delay:P}=y,A=T==null;A&&i++;let O={...a,style:a.toastStyle,key:n++,...Object.fromEntries(Object.entries(y).filter(([L,ie])=>ie!=null)),toastId:b,updateId:T,data:E,isIn:!1,className:xO(y.className||a.toastClassName),progressClassName:xO(y.progressClassName||a.progressClassName),autoClose:y.isLoading?!1:$ie(y.autoClose,a.autoClose),closeToast(L){l.get(b).removalReason=L,m(b)},deleteToast(){let L=l.get(b);if(L!=null){if(r(e3(L,"removed")),l.delete(b),i--,i<0&&(i=0),s.length>0){w(s.shift());return}h()}}};O.closeButton=a.closeButton,y.closeButton===!1||bO(y.closeButton)?O.closeButton=y.closeButton:y.closeButton===!0&&(O.closeButton=bO(a.closeButton)?a.closeButton:!0);let Y={content:v,props:O,staleId:x};a.limit&&a.limit>0&&i>a.limit&&A?s.push(Y):Wy(P)?setTimeout(()=>{w(Y)},P):w(Y)},setProps(v){a=v},setToggle:(v,y)=>{let b=l.get(v);b&&(b.toggle=y)},isToastActive:v=>{var y;return(y=l.get(v))==null?void 0:y.isActive},getSnapshot:()=>o}}var Ji=new Map,Vw=[],_O=new Set,Gie=t=>_O.forEach(e=>e(t)),f7=()=>Ji.size>0;function Yie(){Vw.forEach(t=>g7(t.content,t.options)),Vw=[]}var Kie=(t,{containerId:e})=>{var r;return(r=Ji.get(e||1))==null?void 0:r.toasts.get(t)};function d7(t,e){var r;if(e)return!!((r=Ji.get(e))!=null&&r.isToastActive(t));let n=!1;return Ji.forEach(i=>{i.isToastActive(t)&&(n=!0)}),n}function Xie(t){if(!f7()){Vw=Vw.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||Lie(t))Ji.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=Ji.get(t.containerId);e?e.removeToast(t.id):Ji.forEach(r=>{r.removeToast(t.id)})}}var qie=(t={})=>{Ji.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function g7(t,e){bO(t)&&(f7()||Vw.push({content:t,options:e}),Ji.forEach(r=>{r.buildToast(t,e)}))}function Jie(t){var e;(e=Ji.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function m7(t,e){Ji.forEach(r=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===r.id)&&r.toggle(t,e==null?void 0:e.id)})}function Qie(t){let e=t.containerId||1;return{subscribe(r){let n=zie(e,t,Gie);Ji.set(e,n);let i=n.observe(r);return Yie(),()=>{i(),Ji.delete(e)}},setProps(r){var n;(n=Ji.get(e))==null||n.setProps(r)},getSnapshot(){var r;return(r=Ji.get(e))==null?void 0:r.getSnapshot()}}}function Zie(t){return _O.add(t),()=>{_O.delete(t)}}function ese(t){return t&&(wd(t.toastId)||Wy(t.toastId))?t.toastId:h7()}function jy(t,e){return g7(t,e),e.toastId}function kE(t,e){return{...e,type:e&&e.type||t,toastId:ese(e)}}function PE(t){return(e,r)=>jy(e,kE(t,r))}function Tt(t,e){return jy(t,kE("default",e))}Tt.loading=(t,e)=>jy(t,kE("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function tse(t,{pending:e,error:r,success:n},i){let s;e&&(s=wd(e)?Tt.loading(e,i):Tt.loading(e.render,{...i,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=(u,c,h)=>{if(c==null){Tt.dismiss(s);return}let f={type:u,...o,...i,data:h},d=wd(c)?{render:c}:c;return s?Tt.update(s,{...f,...d}):Tt(d.render,{...f,...d}),h},l=Uu(t)?t():t;return l.then(u=>a("success",n,u)).catch(u=>a("error",r,u)),l}Tt.promise=tse;Tt.success=PE("success");Tt.info=PE("info");Tt.error=PE("error");Tt.warning=PE("warning");Tt.warn=Tt.warning;Tt.dark=(t,e)=>jy(t,kE("default",{theme:"dark",...e}));function rse(t){Xie(t)}Tt.dismiss=rse;Tt.clearWaitingQueue=qie;Tt.isActive=d7;Tt.update=(t,e={})=>{let r=Kie(t,e);if(r){let{props:n,content:i}=r,s={delay:100,...n,...e,toastId:e.toastId||t,updateId:h7()};s.toastId!==t&&(s.staleId=t);let o=s.render||i;delete s.render,jy(o,s)}};Tt.done=t=>{Tt.update(t,{progress:1})};Tt.onChange=Zie;Tt.play=t=>m7(!0,t);Tt.pause=t=>m7(!1,t);function nse(t){var e;let{subscribe:r,getSnapshot:n,setProps:i}=pe.useRef(Qie(t)).current;i(t);let s=(e=pe.useSyncExternalStore(r,n,n))==null?void 0:e.slice();function o(a){if(!s)return[];let l=new Map;return t.newestOnTop&&s.reverse(),s.forEach(u=>{let{position:c}=u.props;l.has(c)||l.set(c,[]),l.get(c).push(u)}),Array.from(l,u=>a(u[0],u[1]))}return{getToastToRender:o,isToastActive:d7,count:s==null?void 0:s.length}}function ise(t){let[e,r]=pe.useState(!1),[n,i]=pe.useState(!1),s=pe.useRef(null),o=pe.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:u,onClick:c,closeOnClick:h}=t;Jie({id:t.toastId,containerId:t.containerId,fn:r}),pe.useEffect(()=>{if(t.pauseOnFocusLoss)return f(),()=>{d()}},[t.pauseOnFocusLoss]);function f(){document.hasFocus()||w(),window.addEventListener("focus",p),window.addEventListener("blur",w)}function d(){window.removeEventListener("focus",p),window.removeEventListener("blur",w)}function g(x){if(t.draggable===!0||t.draggable===x.pointerType){v();let P=s.current;o.canCloseOnClick=!0,o.canDrag=!0,P.style.transition="none",t.draggableDirection==="x"?(o.start=x.clientX,o.removalDistance=P.offsetWidth*(t.draggablePercent/100)):(o.start=x.clientY,o.removalDistance=P.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function m(x){let{top:P,bottom:A,left:O,right:Y}=s.current.getBoundingClientRect();x.nativeEvent.type!=="touchend"&&t.pauseOnHover&&x.clientX>=O&&x.clientX<=Y&&x.clientY>=P&&x.clientY<=A?w():p()}function p(){r(!0)}function w(){r(!1)}function v(){o.didMove=!1,document.addEventListener("pointermove",b),document.addEventListener("pointerup",T)}function y(){document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",T)}function b(x){let P=s.current;if(o.canDrag&&P){o.didMove=!0,e&&w(),t.draggableDirection==="x"?o.delta=x.clientX-o.start:o.delta=x.clientY-o.start,o.start!==x.clientX&&(o.canCloseOnClick=!1);let A=t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;P.style.transform=`translate3d(${A},0)`,P.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function T(){y();let x=s.current;if(o.canDrag&&o.didMove&&x){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){i(!0),t.closeToast(!0),t.collapseAll();return}x.style.transition="transform 0.2s, opacity 0.2s",x.style.removeProperty("transform"),x.style.removeProperty("opacity")}}let E={onPointerDown:g,onPointerUp:m};return a&&l&&(E.onMouseEnter=w,t.stacked||(E.onMouseLeave=p)),h&&(E.onClick=x=>{c&&c(x),o.canCloseOnClick&&u(!0)}),{playToast:p,pauseToast:w,isRunning:e,preventExitTransition:n,toastRef:s,eventHandlers:E}}var sse=typeof window<"u"?pe.useLayoutEffect:pe.useEffect,AE=({theme:t,type:e,isLoading:r,...n})=>Ge.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...n});function ose(t){return Ge.createElement(AE,{...t},Ge.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function ase(t){return Ge.createElement(AE,{...t},Ge.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function lse(t){return Ge.createElement(AE,{...t},Ge.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function use(t){return Ge.createElement(AE,{...t},Ge.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function cse(){return Ge.createElement("div",{className:"Toastify__spinner"})}var EO={info:ase,warning:ose,success:lse,error:use,spinner:cse},hse=t=>t in EO;function fse({theme:t,type:e,isLoading:r,icon:n}){let i=null,s={theme:t,type:e};return n===!1||(Uu(n)?i=n({...s,isLoading:r}):pe.isValidElement(n)?i=pe.cloneElement(n,s):r?i=EO.spinner():hse(e)&&(i=EO[e](s))),i}var dse=t=>{let{isRunning:e,preventExitTransition:r,toastRef:n,eventHandlers:i,playToast:s}=ise(t),{closeButton:o,children:a,autoClose:l,onClick:u,type:c,hideProgressBar:h,closeToast:f,transition:d,position:g,className:m,style:p,progressClassName:w,updateId:v,role:y,progress:b,rtl:T,toastId:E,deleteToast:x,isIn:P,isLoading:A,closeOnClick:O,theme:Y,ariaLabel:L}=t,ie=id("Toastify__toast",`Toastify__toast-theme--${Y}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":T},{"Toastify__toast--close-on-click":O}),ce=Uu(m)?m({rtl:T,position:g,type:c,defaultClassName:ie}):id(ie,m),he=fse(t),Ee=!!b||!l,Ce={closeToast:f,type:c,theme:Y},ge=null;return o===!1||(Uu(o)?ge=o(Ce):pe.isValidElement(o)?ge=pe.cloneElement(o,Ce):ge=Wie(Ce)),Ge.createElement(d,{isIn:P,done:x,position:g,preventExitTransition:r,nodeRef:n,playToast:s},Ge.createElement("div",{id:E,tabIndex:0,onClick:u,"data-in":P,className:ce,...i,style:p,ref:n,...P&&{role:y,"aria-label":L}},he!=null&&Ge.createElement("div",{className:id("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!A})},he),c7(a,t,!e),ge,!t.customProgressBar&&Ge.createElement(jie,{...v&&!Ee?{key:`p-${v}`}:{},rtl:T,theme:Y,delay:l,isRunning:e,isIn:P,closeToast:f,hide:h,type:c,className:w,controlledProgress:Ee,progress:b||0})))},gse=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),mse=Vie(gse("bounce",!0)),pse={position:"top-right",transition:mse,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function vse(t){let e={...pse,...t},r=t.stacked,[n,i]=pe.useState(!0),s=pe.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=nse(e),{className:u,style:c,rtl:h,containerId:f,hotKeys:d}=e;function g(p){let w=id("Toastify__toast-container",`Toastify__toast-container--${p}`,{"Toastify__toast-container--rtl":h});return Uu(u)?u({position:p,rtl:h,defaultClassName:w}):id(w,xO(u))}function m(){r&&(i(!0),Tt.play())}return sse(()=>{var p;if(r){let w=s.current.querySelectorAll('[data-in="true"]'),v=12,y=(p=e.position)==null?void 0:p.includes("top"),b=0,T=0;Array.from(w).reverse().forEach((E,x)=>{let P=E;P.classList.add("Toastify__toast--stacked"),x>0&&(P.dataset.collapsed=`${n}`),P.dataset.pos||(P.dataset.pos=y?"top":"bot");let A=b*(n?.2:1)+(n?0:v*x);P.style.setProperty("--y",`${y?A:A*-1}px`),P.style.setProperty("--g",`${v}`),P.style.setProperty("--s",`${1-(n?T:0)}`),b+=P.offsetHeight,T+=.025})}},[n,l,r]),pe.useEffect(()=>{function p(w){var v;let y=s.current;d(w)&&((v=y.querySelector('[tabIndex="0"]'))==null||v.focus(),i(!1),Tt.pause()),w.key==="Escape"&&(document.activeElement===y||y!=null&&y.contains(document.activeElement))&&(i(!0),Tt.play())}return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[d]),Ge.createElement("section",{ref:s,className:"Toastify",id:f,onMouseEnter:()=>{r&&(i(!1),Tt.pause())},onMouseLeave:m,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((p,w)=>{let v=w.length?{...c}:{...c,pointerEvents:"none"};return Ge.createElement("div",{tabIndex:-1,className:g(p),"data-stacked":r,style:v,key:`c-${p}`},w.map(({content:y,props:b})=>Ge.createElement(dse,{...b,stacked:r,collapseAll:m,isIn:a(b.toastId,b.containerId),key:`t-${b.key}`},y)))}))}function si(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var wse=typeof Symbol=="function"&&Symbol.observable||"@@observable",t3=wse,BT=()=>Math.random().toString(36).substring(7).split("").join("."),yse={INIT:`@@redux/INIT${BT()}`,REPLACE:`@@redux/REPLACE${BT()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${BT()}`},Db=yse;function bN(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function _N(t,e,r){if(typeof t!="function")throw new Error(si(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(si(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(si(1));return r(_N)(t,e)}let n=t,i=e,s=new Map,o=s,a=0,l=!1;function u(){o===s&&(o=new Map,s.forEach((p,w)=>{o.set(w,p)}))}function c(){if(l)throw new Error(si(3));return i}function h(p){if(typeof p!="function")throw new Error(si(4));if(l)throw new Error(si(5));let w=!0;u();const v=a++;return o.set(v,p),function(){if(w){if(l)throw new Error(si(6));w=!1,u(),o.delete(v),s=null}}}function f(p){if(!bN(p))throw new Error(si(7));if(typeof p.type>"u")throw new Error(si(8));if(typeof p.type!="string")throw new Error(si(17));if(l)throw new Error(si(9));try{l=!0,i=n(i,p)}finally{l=!1}return(s=o).forEach(v=>{v()}),p}function d(p){if(typeof p!="function")throw new Error(si(10));n=p,f({type:Db.REPLACE})}function g(){const p=h;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(si(11));function v(){const b=w;b.next&&b.next(c())}return v(),{unsubscribe:p(v)}},[t3](){return this}}}return f({type:Db.INIT}),{dispatch:f,subscribe:h,getState:c,replaceReducer:d,[t3]:g}}function Cse(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Db.INIT})>"u")throw new Error(si(12));if(typeof r(void 0,{type:Db.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(si(13))})}function p7(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let i;try{Cse(r)}catch(s){i=s}return function(o={},a){if(i)throw i;let l=!1;const u={};for(let c=0;c<n.length;c++){const h=n[c],f=r[h],d=o[h],g=f(d,a);if(typeof g>"u")throw a&&a.type,new Error(si(14));u[h]=g,l=l||g!==d}return l=l||n.length!==Object.keys(o).length,l?u:o}}function Fb(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function Sse(...t){return e=>(r,n)=>{const i=e(r,n);let s=()=>{throw new Error(si(15))};const o={getState:i.getState,dispatch:(l,...u)=>s(l,...u)},a=t.map(l=>l(o));return s=Fb(...a)(i.dispatch),{...i,dispatch:s}}}function xse(t){return bN(t)&&"type"in t&&typeof t.type=="string"}var v7=Symbol.for("immer-nothing"),r3=Symbol.for("immer-draftable"),no=Symbol.for("immer-state");function _a(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var lp=Object.getPrototypeOf;function yd(t){return!!t&&!!t[no]}function zu(t){var e;return t?w7(t)||Array.isArray(t)||!!t[r3]||!!((e=t.constructor)!=null&&e[r3])||OE(t)||ME(t):!1}var bse=Object.prototype.constructor.toString();function w7(t){if(!t||typeof t!="object")return!1;const e=lp(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===bse}function Hb(t,e){IE(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function IE(t){const e=t[no];return e?e.type_:Array.isArray(t)?1:OE(t)?2:ME(t)?3:0}function RO(t,e){return IE(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function y7(t,e,r){const n=IE(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function _se(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function OE(t){return t instanceof Map}function ME(t){return t instanceof Set}function Hf(t){return t.copy_||t.base_}function TO(t,e){if(OE(t))return new Map(t);if(ME(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=w7(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[no];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],a=n[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(lp(t),n)}else{const n=lp(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function EN(t,e=!1){return NE(t)||yd(t)||!zu(t)||(IE(t)>1&&(t.set=t.add=t.clear=t.delete=Ese),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>EN(n,!0))),t}function Ese(){_a(2)}function NE(t){return Object.isFrozen(t)}var Rse={};function Cd(t){const e=Rse[t];return e||_a(0,t),e}var Ww;function C7(){return Ww}function Tse(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function n3(t,e){e&&(Cd("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function kO(t){PO(t),t.drafts_.forEach(kse),t.drafts_=null}function PO(t){t===Ww&&(Ww=t.parent_)}function i3(t){return Ww=Tse(Ww,t)}function kse(t){const e=t[no];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function s3(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[no].modified_&&(kO(e),_a(4)),zu(t)&&(t=Lb(e,t),e.parent_||$b(e,t)),e.patches_&&Cd("Patches").generateReplacementPatches_(r[no].base_,t,e.patches_,e.inversePatches_)):t=Lb(e,r,[]),kO(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==v7?t:void 0}function Lb(t,e,r){if(NE(e))return e;const n=e[no];if(!n)return Hb(e,(i,s)=>o3(t,n,e,i,s,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return $b(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let s=i,o=!1;n.type_===3&&(s=new Set(i),i.clear(),o=!0),Hb(s,(a,l)=>o3(t,n,i,a,l,r,o)),$b(t,i,!1),r&&t.patches_&&Cd("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function o3(t,e,r,n,i,s,o){if(yd(i)){const a=s&&e&&e.type_!==3&&!RO(e.assigned_,n)?s.concat(n):void 0,l=Lb(t,i,a);if(y7(r,n,l),yd(l))t.canAutoFreeze_=!1;else return}else o&&r.add(i);if(zu(i)&&!NE(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Lb(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&$b(t,i)}}function $b(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&EN(e,r)}function Pse(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:C7(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=RN;r&&(i=[n],s=jw);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return n.draft_=a,n.revoke_=o,a}var RN={get(t,e){if(e===no)return t;const r=Hf(t);if(!RO(r,e))return Ase(t,r,e);const n=r[e];return t.finalized_||!zu(n)?n:n===VT(t.base_,e)?(WT(t),t.copy_[e]=IO(n,t)):n},has(t,e){return e in Hf(t)},ownKeys(t){return Reflect.ownKeys(Hf(t))},set(t,e,r){const n=S7(Hf(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=VT(Hf(t),e),s=i==null?void 0:i[no];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(_se(r,i)&&(r!==void 0||RO(t.base_,e)))return!0;WT(t),AO(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return VT(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,WT(t),AO(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Hf(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){_a(11)},getPrototypeOf(t){return lp(t.base_)},setPrototypeOf(){_a(12)}},jw={};Hb(RN,(t,e)=>{jw[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});jw.deleteProperty=function(t,e){return jw.set.call(this,t,e,void 0)};jw.set=function(t,e,r){return RN.set.call(this,t[0],e,r,t[0])};function VT(t,e){const r=t[no];return(r?Hf(r):t)[e]}function Ase(t,e,r){var i;const n=S7(e,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(t.draft_):void 0}function S7(t,e){if(!(e in t))return;let r=lp(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=lp(r)}}function AO(t){t.modified_||(t.modified_=!0,t.parent_&&AO(t.parent_))}function WT(t){t.copy_||(t.copy_=TO(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Ise=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(l=s,...u){return o.produce(l,c=>r.call(this,c,...u))}}typeof r!="function"&&_a(6),n!==void 0&&typeof n!="function"&&_a(7);let i;if(zu(e)){const s=i3(this),o=IO(e,void 0);let a=!0;try{i=r(o),a=!1}finally{a?kO(s):PO(s)}return n3(s,n),s3(i,s)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===v7&&(i=void 0),this.autoFreeze_&&EN(i,!0),n){const s=[],o=[];Cd("Patches").generateReplacementPatches_(e,i,s,o),n(s,o)}return i}else _a(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let n,i;return[this.produce(e,r,(o,a)=>{n=o,i=a}),n,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){zu(t)||_a(8),yd(t)&&(t=Ose(t));const e=i3(this),r=IO(t,void 0);return r[no].isManual_=!0,PO(e),r}finishDraft(t,e){const r=t&&t[no];(!r||!r.isManual_)&&_a(9);const{scope_:n}=r;return n3(n,e),s3(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=Cd("Patches").applyPatches_;return yd(t)?n(t,e):this.produce(t,i=>n(i,e))}};function IO(t,e){const r=OE(t)?Cd("MapSet").proxyMap_(t,e):ME(t)?Cd("MapSet").proxySet_(t,e):Pse(t,e);return(e?e.scope_:C7()).drafts_.push(r),r}function Ose(t){return yd(t)||_a(10,t),x7(t)}function x7(t){if(!zu(t)||NE(t))return t;const e=t[no];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=TO(t,e.scope_.immer_.useStrictShallowCopy_)}else r=TO(t,!0);return Hb(r,(n,i)=>{y7(r,n,x7(i))}),e&&(e.finalized_=!1),r}var io=new Ise,b7=io.produce;io.produceWithPatches.bind(io);io.setAutoFreeze.bind(io);io.setUseStrictShallowCopy.bind(io);io.applyPatches.bind(io);io.createDraft.bind(io);io.finishDraft.bind(io);function _7(t){return({dispatch:r,getState:n})=>i=>s=>typeof s=="function"?s(r,n,t):i(s)}var Mse=_7(),Nse=_7,Dse=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Fb:Fb.apply(null,arguments)},Fse=t=>t&&typeof t.match=="function";function Vv(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Mu(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>xse(n)&&n.type===t,r}var E7=class Cv extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Cv.prototype)}static get[Symbol.species](){return Cv}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Cv(...e[0].concat(this)):new Cv(...e.concat(this))}};function a3(t){return zu(t)?b7(t,()=>{}):t}function rC(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function Hse(t){return typeof t=="boolean"}var Lse=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=e??{};let o=new E7;return r&&(Hse(r)?o.push(Mse):o.push(Nse(r.extraArgument))),o},$se="RTK_autoBatch",l3=t=>e=>{setTimeout(e,t)},Bse=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,s=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:l3(10):t.type==="callback"?t.queueNotification:l3(t.timeout),u=()=>{o=!1,s&&(s=!1,a.forEach(c=>c()))};return Object.assign({},n,{subscribe(c){const h=()=>i&&c(),f=n.subscribe(h);return a.add(c),()=>{f(),a.delete(c)}},dispatch(c){var h;try{return i=!((h=c==null?void 0:c.meta)!=null&&h[$se]),s=!i,s&&(o||(o=!0,l(u))),n.dispatch(c)}finally{i=!0}}})},Vse=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new E7(t);return n&&i.push(Bse(typeof n=="object"?n:void 0)),i};function Wse(t){const e=Lse(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let a;if(typeof r=="function")a=r;else if(bN(r))a=p7(r);else throw new Error(Mu(1));let l;typeof n=="function"?l=n(e):l=e();let u=Fb;i&&(u=Dse({trace:!1,...typeof i=="object"&&i}));const c=Sse(...l),h=Vse(c);let f=typeof o=="function"?o(h):h();const d=u(...f);return _N(a,s,d)}function R7(t){const e={},r=[];let n;const i={addCase(s,o){const a=typeof s=="string"?s:s.type;if(!a)throw new Error(Mu(28));if(a in e)throw new Error(Mu(29));return e[a]=o,i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return n=s,i}};return t(i),[e,r,n]}function jse(t){return typeof t=="function"}function Use(t,e){let[r,n,i]=R7(e),s;if(jse(t))s=()=>a3(t());else{const a=a3(t);s=()=>a}function o(a=s(),l){let u=[r[l.type],...n.filter(({matcher:c})=>c(l)).map(({reducer:c})=>c)];return u.filter(c=>!!c).length===0&&(u=[i]),u.reduce((c,h)=>{if(h)if(yd(c)){const d=h(c,l);return d===void 0?c:d}else{if(zu(c))return b7(c,f=>h(f,l));{const f=h(c,l);if(f===void 0){if(c===null)return c;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return c},a)}return o.getInitialState=s,o}var zse=(t,e)=>Fse(t)?t.match(e):t(e);function Gse(...t){return e=>t.some(r=>zse(r,e))}var Yse="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Kse=(t=21)=>{let e="",r=t;for(;r--;)e+=Yse[Math.random()*64|0];return e},Xse=["name","message","stack","code"],jT=class{constructor(t,e){cT(this,"_type");this.payload=t,this.meta=e}},u3=class{constructor(t,e){cT(this,"_type");this.payload=t,this.meta=e}},qse=t=>{if(typeof t=="object"&&t!==null){const e={};for(const r of Xse)typeof t[r]=="string"&&(e[r]=t[r]);return e}return{message:String(t)}},c3="External signal was aborted",TN=(()=>{function t(e,r,n){const i=Vv(e+"/fulfilled",(l,u,c,h)=>({payload:l,meta:{...h||{},arg:c,requestId:u,requestStatus:"fulfilled"}})),s=Vv(e+"/pending",(l,u,c)=>({payload:void 0,meta:{...c||{},arg:u,requestId:l,requestStatus:"pending"}})),o=Vv(e+"/rejected",(l,u,c,h,f)=>({payload:h,error:(n&&n.serializeError||qse)(l||"Rejected"),meta:{...f||{},arg:c,requestId:u,rejectedWithValue:!!h,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function a(l,{signal:u}={}){return(c,h,f)=>{const d=n!=null&&n.idGenerator?n.idGenerator(l):Kse(),g=new AbortController;let m,p;function w(y){p=y,g.abort()}u&&(u.aborted?w(c3):u.addEventListener("abort",()=>w(c3),{once:!0}));const v=async function(){var T,E;let y;try{let x=(T=n==null?void 0:n.condition)==null?void 0:T.call(n,l,{getState:h,extra:f});if(Qse(x)&&(x=await x),x===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const P=new Promise((A,O)=>{m=()=>{O({name:"AbortError",message:p||"Aborted"})},g.signal.addEventListener("abort",m)});c(s(d,l,(E=n==null?void 0:n.getPendingMeta)==null?void 0:E.call(n,{requestId:d,arg:l},{getState:h,extra:f}))),y=await Promise.race([P,Promise.resolve(r(l,{dispatch:c,getState:h,extra:f,requestId:d,signal:g.signal,abort:w,rejectWithValue:(A,O)=>new jT(A,O),fulfillWithValue:(A,O)=>new u3(A,O)})).then(A=>{if(A instanceof jT)throw A;return A instanceof u3?i(A.payload,d,l,A.meta):i(A,d,l)})])}catch(x){y=x instanceof jT?o(null,d,l,x.payload,x.meta):o(x,d,l)}finally{m&&g.signal.removeEventListener("abort",m)}return n&&!n.dispatchConditionRejection&&o.match(y)&&y.meta.condition||c(y),y}();return Object.assign(v,{abort:w,requestId:d,arg:l,unwrap(){return v.then(Jse)}})}}return Object.assign(a,{pending:s,rejected:o,fulfilled:i,settled:Gse(o,i),typePrefix:e})}return t.withTypes=()=>t,t})();function Jse(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function Qse(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var Zse=Symbol.for("rtk-slice-createasyncthunk");function eoe(t,e){return`${t}/${e}`}function toe({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[Zse];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(Mu(11));const a=(typeof i.reducers=="function"?i.reducers(noe()):i.reducers)||{},l=Object.keys(a),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(b,T){const E=typeof b=="string"?b:b.type;if(!E)throw new Error(Mu(12));if(E in u.sliceCaseReducersByType)throw new Error(Mu(13));return u.sliceCaseReducersByType[E]=T,c},addMatcher(b,T){return u.sliceMatchers.push({matcher:b,reducer:T}),c},exposeAction(b,T){return u.actionCreators[b]=T,c},exposeCaseReducer(b,T){return u.sliceCaseReducersByName[b]=T,c}};l.forEach(b=>{const T=a[b],E={reducerName:b,type:eoe(s,b),createNotation:typeof i.reducers=="function"};soe(T)?aoe(E,T,c,e):ioe(E,T,c)});function h(){const[b={},T=[],E=void 0]=typeof i.extraReducers=="function"?R7(i.extraReducers):[i.extraReducers],x={...b,...u.sliceCaseReducersByType};return Use(i.initialState,P=>{for(let A in x)P.addCase(A,x[A]);for(let A of u.sliceMatchers)P.addMatcher(A.matcher,A.reducer);for(let A of T)P.addMatcher(A.matcher,A.reducer);E&&P.addDefaultCase(E)})}const f=b=>b,d=new Map,g=new WeakMap;let m;function p(b,T){return m||(m=h()),m(b,T)}function w(){return m||(m=h()),m.getInitialState()}function v(b,T=!1){function E(P){let A=P[b];return typeof A>"u"&&T&&(A=rC(g,E,w)),A}function x(P=f){const A=rC(d,T,()=>new WeakMap);return rC(A,P,()=>{const O={};for(const[Y,L]of Object.entries(i.selectors??{}))O[Y]=roe(L,P,()=>rC(g,P,w),T);return O})}return{reducerPath:b,getSelectors:x,get selectors(){return x(E)},selectSlice:E}}const y={name:s,reducer:p,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:w,...v(o),injectInto(b,{reducerPath:T,...E}={}){const x=T??o;return b.inject({reducerPath:x,reducer:p},E),{...y,...v(x,!0)}}};return y}}function roe(t,e,r,n){function i(s,...o){let a=e(s);return typeof a>"u"&&n&&(a=r()),t(a,...o)}return i.unwrapped=t,i}var T7=toe();function noe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function ioe({type:t,reducerName:e,createNotation:r},n,i){let s,o;if("reducer"in n){if(r&&!ooe(n))throw new Error(Mu(17));s=n.reducer,o=n.prepare}else s=n;i.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?Vv(t,o):Vv(t))}function soe(t){return t._reducerDefinitionType==="asyncThunk"}function ooe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function aoe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Mu(18));const{payloadCreator:s,fulfilled:o,pending:a,rejected:l,settled:u,options:c}=r,h=i(t,s,c);n.exposeAction(e,h),o&&n.addCase(h.fulfilled,o),a&&n.addCase(h.pending,a),l&&n.addCase(h.rejected,l),u&&n.addMatcher(h.settled,u),n.exposeCaseReducer(e,{fulfilled:o||nC,pending:a||nC,rejected:l||nC,settled:u||nC})}function nC(){}function Mu(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const h3=localStorage.getItem("user"),loe=h3?{isAuthenticated:!0,user:JSON.parse(h3)}:{isAuthenticated:!1,user:null},k7=T7({name:"auth",initialState:loe,reducers:{login:(t,e)=>{const{email:r,password:n}=e.payload;r==="exsample@mail.ru"&&n==="password"?(t.isAuthenticated=!0,t.user={name:"Иван Петров",email:r},localStorage.setItem("user",JSON.stringify(t.user))):alert("Неверные данные. Используйте e-mail: exsample@mail.ru, пароль: password")},logout:t=>{t.isAuthenticated=!1,t.user=null,localStorage.removeItem("user")}}}),{login:uoe,logout:kN}=k7.actions,coe=k7.reducer,hoe="_header_1v7jh_1",foe="_header__logoContainer_1v7jh_25",doe="_header__logo_1v7jh_25",goe="_header__logoText_1v7jh_53",moe="_header__right_1v7jh_67",poe="_header__navButtons_1v7jh_77",voe="_header__navButton_1v7jh_77",woe="_header__icon_1v7jh_131",yoe="_header__lkIcon_1v7jh_143",Coe="_header__gridIcon_1v7jh_153",Soe="_header__userBlock_1v7jh_163",xoe="_header__userName_1v7jh_179",boe="_header__avatar_1v7jh_197",_oe="_header__menu_1v7jh_337",Eoe="_header__menuItem_1v7jh_381",gr={header:hoe,header__logoContainer:foe,header__logo:doe,header__logoText:goe,header__right:moe,header__navButtons:poe,header__navButton:voe,header__icon:woe,header__lkIcon:yoe,header__gridIcon:Coe,header__userBlock:Soe,header__userName:xoe,header__avatar:boe,"header__navButton--active":"_header__navButton--active_1v7jh_225","header__navButton--inactive":"_header__navButton--inactive_1v7jh_237",header__menu:_oe,"header__menu--open":"_header__menu--open_1v7jh_369",header__menuItem:Eoe},Roe=()=>{const t=Fh(),e=By(),{isAuthenticated:r,user:n}=Vy(c=>c.auth),[i,s]=pe.useState(t.pathname.startsWith("/lk")?"lk":"work"),[o,a]=pe.useState(!1),l=pe.useRef(null);pe.useEffect(()=>{const c=h=>{l.current&&!l.current.contains(h.target)&&a(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]);const u=()=>{e(kN()),a(!1)};return j.jsxs("header",{className:gr.header,children:[j.jsxs(Hc,{to:"/",className:gr.header__logoContainer,children:[j.jsx("div",{className:gr.header__logo,"aria-hidden":"true"}),j.jsx("span",{className:gr.header__logoText,children:"Profgeo"})]}),j.jsxs("div",{className:gr.header__right,children:[j.jsx("div",{className:gr.header__navButtons,children:r?j.jsxs(j.Fragment,{children:[j.jsxs(Hc,{to:"/lk",className:`${gr.header__navButton} ${i==="lk"?gr["header__navButton--active"]:gr["header__navButton--inactive"]}`,onClick:()=>s("lk"),children:[j.jsx("div",{className:`${gr.header__icon} ${gr.header__lkIcon}`}),j.jsx("span",{children:"Личный кабинет"})]}),j.jsxs(Hc,{to:"/work",className:`${gr.header__navButton} ${i==="work"?gr["header__navButton--active"]:gr["header__navButton--inactive"]}`,onClick:()=>s("work"),children:[j.jsx("div",{className:`${gr.header__icon} ${gr.header__gridIcon}`}),j.jsx("span",{children:"Рабочий кабинет"})]})]}):j.jsxs(j.Fragment,{children:[j.jsx(Hc,{to:"/login",className:`${gr.header__navButton} ${gr["header__navButton--active"]}`,children:j.jsx("span",{children:"Войти"})}),j.jsx(Hc,{to:"/register",className:`${gr.header__navButton} ${gr["header__navButton--active"]}`,children:j.jsx("span",{children:"Зарегистрироваться"})})]})}),r&&j.jsxs("div",{className:gr.header__userBlock,ref:l,children:[j.jsx("span",{className:gr.header__userName,children:(n==null?void 0:n.name)||"Без имени"}),j.jsx("button",{type:"button",className:gr.header__avatar,onClick:()=>a(!o),children:n!=null&&n.name?n.name.split(" ").map(c=>c[0]).join("").toUpperCase():"?"}),j.jsxs("div",{className:`${gr.header__menu} ${o?gr["header__menu--open"]:""}`,children:[j.jsx(Hc,{to:"/lk",className:gr.header__menuItem,children:"Профиль"}),j.jsx("button",{onClick:u,className:gr.header__menuItem,style:{width:"100%",textAlign:"left",background:"none",border:"none",cursor:"pointer"},children:"Выйти"})]})]})]})]})},f3={"title-container":"_title-container_1xk2p_1"},Toe=()=>{const t=Fh(),e=Vy(n=>n.auth.isAuthenticated);let r="";return e?t.pathname.startsWith("/work")?r="Перечень графических приложений":r="Модуль1":r="Добро пожаловать на сайт Profgeo! Пожалуйста, зарегистрируйтесь или авторизуйтесь.",j.jsx("div",{className:f3["title-container"],children:j.jsx("h1",{className:f3["title-container__text"],children:r})})},koe="_sidebar_1bqot_1",Poe="_sidebar__menuContainer_1bqot_23",Aoe="_sidebar__menu_1bqot_23",Ioe="_sidebar__menuItem_1bqot_45",Ooe="_sidebar__icon_1bqot_75",Moe="_sidebar__iconList_1bqot_87",Noe="_sidebar__iconInfo_1bqot_97",Doe="_sidebar__iconCreditCard_1bqot_107",Foe="_sidebar__iconUsers_1bqot_117",Hoe="_sidebar__iconSettings_1bqot_127",Loe="_sidebar__footer_1bqot_137",$oe="_sidebar__logout_1bqot_145",Boe="_sidebar__iconLogout_1bqot_183",Voe="_active_1bqot_259",mr={sidebar:koe,sidebar__menuContainer:Poe,sidebar__menu:Aoe,sidebar__menuItem:Ioe,sidebar__icon:Ooe,sidebar__iconList:Moe,sidebar__iconInfo:Noe,sidebar__iconCreditCard:Doe,sidebar__iconUsers:Foe,sidebar__iconSettings:Hoe,sidebar__footer:Loe,sidebar__logout:$oe,sidebar__iconLogout:Boe,active:Voe},Woe=()=>{const t=By();return j.jsxs("aside",{className:mr.sidebar,children:[j.jsx("div",{className:mr.sidebar__menuContainer,children:j.jsxs("ul",{className:mr.sidebar__menu,children:[j.jsx("li",{children:j.jsxs(Zg,{to:"/lk",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[j.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconList}`}),j.jsx("span",{children:"Объекты"})]})}),j.jsx("li",{children:j.jsxs(Zg,{to:"/account",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[j.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconInfo}`}),j.jsx("span",{children:"Аккаунт"})]})}),j.jsx("li",{children:j.jsxs(Zg,{to:"/subscription",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[j.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconCreditCard}`}),j.jsx("span",{children:"Подписка"})]})}),j.jsx("li",{children:j.jsxs(Zg,{to:"/users",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[j.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconUsers}`}),j.jsx("span",{children:"Список пользователей"})]})}),j.jsx("li",{children:j.jsxs(Zg,{to:"/settings",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[j.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconSettings}`}),j.jsx("span",{children:"Настройки"})]})})]})}),j.jsx("div",{className:mr.sidebar__footer,children:j.jsxs("button",{className:mr.sidebar__logout,onClick:()=>t(kN()),children:[j.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconLogout}`}),j.jsx("span",{children:"Выйти"})]})})]})},joe="_mainContent_226eh_1",Uoe="_content_226eh_21",d3={mainContent:joe,content:Uoe},zoe=()=>j.jsxs("div",{className:d3.mainContent,children:[j.jsx(Woe,{}),j.jsx("section",{className:d3.content,children:j.jsx(o7,{})})]}),Goe="_sidebar_qld18_1",Yoe="_sidebar__menuContainer_qld18_23",Koe="_sidebar__menuItem_qld18_49",Xoe="_sidebar__footer_qld18_103",qoe="_sidebar__logout_qld18_111",Joe="_sidebar__icon_qld18_141",Qoe="_sidebar__iconLogout_qld18_153",Zoe="_active_qld18_223",Ga={sidebar:Goe,sidebar__menuContainer:Yoe,sidebar__menuItem:Koe,sidebar__footer:Xoe,sidebar__logout:qoe,sidebar__icon:Joe,sidebar__iconLogout:Qoe,active:Zoe},eae=()=>{const t=By(),e=RE(),r=()=>{t(kN()),e("/")};return j.jsxs("aside",{className:Ga.sidebar,children:[j.jsx("div",{className:Ga.sidebar__menuContainer,children:j.jsxs(Zg,{to:"/work/app1",className:({isActive:n})=>`${Ga.sidebar__menuItem} ${n?Ga.active:""}`,children:[j.jsx("div",{className:`${Ga.sidebar__icon} ${Ga.sidebar__iconList}`}),j.jsx("span",{children:"Модуль1 - ModuleExcelEditor"})]})}),j.jsx("div",{className:Ga.sidebar__footer,children:j.jsxs("button",{type:"button",className:Ga.sidebar__logout,onClick:r,children:[j.jsx("div",{className:`${Ga.sidebar__icon} ${Ga.sidebar__iconLogout}`}),j.jsx("span",{children:"Выйти"})]})})]})},tae="_mainContent_1rgp8_1",rae="_content_1rgp8_17",g3={mainContent:tae,content:rae},nae=()=>j.jsxs("div",{className:g3.mainContent,children:[j.jsx(eae,{}),j.jsx("section",{className:g3.content,children:j.jsx(o7,{})})]}),PN=()=>By(),iae=Vy,sae="modulepreload",oae=function(t){return"/my-profgeo-app/"+t},m3={},aae=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=oae(l),l in m3)return;m3[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":sae,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,d)=>{h.addEventListener("load",f),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function P7(t,e){return function(){return t.apply(e,arguments)}}const{toString:lae}=Object.prototype,{getPrototypeOf:AN}=Object,{iterator:DE,toStringTag:A7}=Symbol,FE=(t=>e=>{const r=lae.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ba=t=>(t=t.toLowerCase(),e=>FE(e)===t),HE=t=>e=>typeof e===t,{isArray:Ip}=Array,Uw=HE("undefined");function Uy(t){return t!==null&&!Uw(t)&&t.constructor!==null&&!Uw(t.constructor)&&ks(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const I7=Ba("ArrayBuffer");function uae(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&I7(t.buffer),e}const cae=HE("string"),ks=HE("function"),O7=HE("number"),zy=t=>t!==null&&typeof t=="object",hae=t=>t===!0||t===!1,Rx=t=>{if(FE(t)!=="object")return!1;const e=AN(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(A7 in t)&&!(DE in t)},fae=t=>{if(!zy(t)||Uy(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},dae=Ba("Date"),gae=Ba("File"),mae=Ba("Blob"),pae=Ba("FileList"),vae=t=>zy(t)&&ks(t.pipe),wae=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||ks(t.append)&&((e=FE(t))==="formdata"||e==="object"&&ks(t.toString)&&t.toString()==="[object FormData]"))},yae=Ba("URLSearchParams"),[Cae,Sae,xae,bae]=["ReadableStream","Request","Response","Headers"].map(Ba),_ae=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gy(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,i;if(typeof t!="object"&&(t=[t]),Ip(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{if(Uy(t))return;const s=r?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(n=0;n<o;n++)a=s[n],e.call(null,t[a],a,t)}}function M7(t,e){if(Uy(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,i;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const Kf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,N7=t=>!Uw(t)&&t!==Kf;function OO(){const{caseless:t}=N7(this)&&this||{},e={},r=(n,i)=>{const s=t&&M7(e,i)||i;Rx(e[s])&&Rx(n)?e[s]=OO(e[s],n):Rx(n)?e[s]=OO({},n):Ip(n)?e[s]=n.slice():e[s]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Gy(arguments[n],r);return e}const Eae=(t,e,r,{allOwnKeys:n}={})=>(Gy(e,(i,s)=>{r&&ks(i)?t[s]=P7(i,r):t[s]=i},{allOwnKeys:n}),t),Rae=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Tae=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},kae=(t,e,r,n)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!n||n(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&AN(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},Pae=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},Aae=t=>{if(!t)return null;if(Ip(t))return t;let e=t.length;if(!O7(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},Iae=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&AN(Uint8Array)),Oae=(t,e)=>{const n=(t&&t[DE]).call(t);let i;for(;(i=n.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},Mae=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},Nae=Ba("HTMLFormElement"),Dae=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),p3=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),Fae=Ba("RegExp"),D7=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Gy(r,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(n[s]=o||i)}),Object.defineProperties(t,n)},Hae=t=>{D7(t,(e,r)=>{if(ks(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(ks(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Lae=(t,e)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return Ip(t)?n(t):n(String(t).split(e)),r},$ae=()=>{},Bae=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Vae(t){return!!(t&&ks(t.append)&&t[A7]==="FormData"&&t[DE])}const Wae=t=>{const e=new Array(10),r=(n,i)=>{if(zy(n)){if(e.indexOf(n)>=0)return;if(Uy(n))return n;if(!("toJSON"in n)){e[i]=n;const s=Ip(n)?[]:{};return Gy(n,(o,a)=>{const l=r(o,i+1);!Uw(l)&&(s[a]=l)}),e[i]=void 0,s}}return n};return r(t,0)},jae=Ba("AsyncFunction"),Uae=t=>t&&(zy(t)||ks(t))&&ks(t.then)&&ks(t.catch),F7=((t,e)=>t?setImmediate:e?((r,n)=>(Kf.addEventListener("message",({source:i,data:s})=>{i===Kf&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Kf.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ks(Kf.postMessage)),zae=typeof queueMicrotask<"u"?queueMicrotask.bind(Kf):typeof process<"u"&&process.nextTick||F7,Gae=t=>t!=null&&ks(t[DE]),me={isArray:Ip,isArrayBuffer:I7,isBuffer:Uy,isFormData:wae,isArrayBufferView:uae,isString:cae,isNumber:O7,isBoolean:hae,isObject:zy,isPlainObject:Rx,isEmptyObject:fae,isReadableStream:Cae,isRequest:Sae,isResponse:xae,isHeaders:bae,isUndefined:Uw,isDate:dae,isFile:gae,isBlob:mae,isRegExp:Fae,isFunction:ks,isStream:vae,isURLSearchParams:yae,isTypedArray:Iae,isFileList:pae,forEach:Gy,merge:OO,extend:Eae,trim:_ae,stripBOM:Rae,inherits:Tae,toFlatObject:kae,kindOf:FE,kindOfTest:Ba,endsWith:Pae,toArray:Aae,forEachEntry:Oae,matchAll:Mae,isHTMLForm:Nae,hasOwnProperty:p3,hasOwnProp:p3,reduceDescriptors:D7,freezeMethods:Hae,toObjectSet:Lae,toCamelCase:Dae,noop:$ae,toFiniteNumber:Bae,findKey:M7,global:Kf,isContextDefined:N7,isSpecCompliantForm:Vae,toJSONObject:Wae,isAsyncFn:jae,isThenable:Uae,setImmediate:F7,asap:zae,isIterable:Gae};function ft(t,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}me.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:me.toJSONObject(this.config),code:this.code,status:this.status}}});const H7=ft.prototype,L7={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{L7[t]={value:t}});Object.defineProperties(ft,L7);Object.defineProperty(H7,"isAxiosError",{value:!0});ft.from=(t,e,r,n,i,s)=>{const o=Object.create(H7);return me.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),ft.call(o,t.message,e,r,n,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const Yae=null;function MO(t){return me.isPlainObject(t)||me.isArray(t)}function $7(t){return me.endsWith(t,"[]")?t.slice(0,-2):t}function v3(t,e,r){return t?t.concat(e).map(function(i,s){return i=$7(i),!r&&s?"["+i+"]":i}).join(r?".":""):e}function Kae(t){return me.isArray(t)&&!t.some(MO)}const Xae=me.toFlatObject(me,{},null,function(e){return/^is[A-Z]/.test(e)});function LE(t,e,r){if(!me.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=me.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,p){return!me.isUndefined(p[m])});const n=r.metaTokens,i=r.visitor||c,s=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&me.isSpecCompliantForm(e);if(!me.isFunction(i))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(me.isDate(g))return g.toISOString();if(me.isBoolean(g))return g.toString();if(!l&&me.isBlob(g))throw new ft("Blob is not supported. Use a Buffer instead.");return me.isArrayBuffer(g)||me.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,m,p){let w=g;if(g&&!p&&typeof g=="object"){if(me.endsWith(m,"{}"))m=n?m:m.slice(0,-2),g=JSON.stringify(g);else if(me.isArray(g)&&Kae(g)||(me.isFileList(g)||me.endsWith(m,"[]"))&&(w=me.toArray(g)))return m=$7(m),w.forEach(function(y,b){!(me.isUndefined(y)||y===null)&&e.append(o===!0?v3([m],b,s):o===null?m:m+"[]",u(y))}),!1}return MO(g)?!0:(e.append(v3(p,m,s),u(g)),!1)}const h=[],f=Object.assign(Xae,{defaultVisitor:c,convertValue:u,isVisitable:MO});function d(g,m){if(!me.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(g),me.forEach(g,function(w,v){(!(me.isUndefined(w)||w===null)&&i.call(e,w,me.isString(v)?v.trim():v,m,f))===!0&&d(w,m?m.concat(v):[v])}),h.pop()}}if(!me.isObject(t))throw new TypeError("data must be an object");return d(t),e}function w3(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function IN(t,e){this._pairs=[],t&&LE(t,this,e)}const B7=IN.prototype;B7.append=function(e,r){this._pairs.push([e,r])};B7.toString=function(e){const r=e?function(n){return e.call(this,n,w3)}:w3;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function qae(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function V7(t,e,r){if(!e)return t;const n=r&&r.encode||qae;me.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(e,r):s=me.isURLSearchParams(e)?e.toString():new IN(e,r).toString(n),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class y3{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){me.forEach(this.handlers,function(n){n!==null&&e(n)})}}const W7={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Jae=typeof URLSearchParams<"u"?URLSearchParams:IN,Qae=typeof FormData<"u"?FormData:null,Zae=typeof Blob<"u"?Blob:null,ele={isBrowser:!0,classes:{URLSearchParams:Jae,FormData:Qae,Blob:Zae},protocols:["http","https","file","blob","url","data"]},ON=typeof window<"u"&&typeof document<"u",NO=typeof navigator=="object"&&navigator||void 0,tle=ON&&(!NO||["ReactNative","NativeScript","NS"].indexOf(NO.product)<0),rle=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",nle=ON&&window.location.href||"http://localhost",ile=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ON,hasStandardBrowserEnv:tle,hasStandardBrowserWebWorkerEnv:rle,navigator:NO,origin:nle},Symbol.toStringTag,{value:"Module"})),Ti={...ile,...ele};function sle(t,e){return LE(t,new Ti.classes.URLSearchParams,{visitor:function(r,n,i,s){return Ti.isNode&&me.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function ole(t){return me.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function ale(t){const e={},r=Object.keys(t);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],e[s]=t[s];return e}function j7(t){function e(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=r.length;return o=!o&&me.isArray(i)?i.length:o,l?(me.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!a):((!i[o]||!me.isObject(i[o]))&&(i[o]=[]),e(r,n,i[o],s)&&me.isArray(i[o])&&(i[o]=ale(i[o])),!a)}if(me.isFormData(t)&&me.isFunction(t.entries)){const r={};return me.forEachEntry(t,(n,i)=>{e(ole(n),i,r,0)}),r}return null}function lle(t,e,r){if(me.isString(t))try{return(e||JSON.parse)(t),me.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const Yy={transitional:W7,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=me.isObject(e);if(s&&me.isHTMLForm(e)&&(e=new FormData(e)),me.isFormData(e))return i?JSON.stringify(j7(e)):e;if(me.isArrayBuffer(e)||me.isBuffer(e)||me.isStream(e)||me.isFile(e)||me.isBlob(e)||me.isReadableStream(e))return e;if(me.isArrayBufferView(e))return e.buffer;if(me.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return sle(e,this.formSerializer).toString();if((a=me.isFileList(e))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return LE(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),lle(e)):e}],transformResponse:[function(e){const r=this.transitional||Yy.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(me.isResponse(e)||me.isReadableStream(e))return e;if(e&&me.isString(e)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?ft.from(a,ft.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ti.classes.FormData,Blob:Ti.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};me.forEach(["delete","get","head","post","put","patch"],t=>{Yy.headers[t]={}});const ule=me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),cle=t=>{const e={};let r,n,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||e[r]&&ule[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},C3=Symbol("internals");function u0(t){return t&&String(t).trim().toLowerCase()}function Tx(t){return t===!1||t==null?t:me.isArray(t)?t.map(Tx):String(t)}function hle(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const fle=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function UT(t,e,r,n,i){if(me.isFunction(n))return n.call(this,e,r);if(i&&(e=r),!!me.isString(e)){if(me.isString(n))return e.indexOf(n)!==-1;if(me.isRegExp(n))return n.test(e)}}function dle(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function gle(t,e){const r=me.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(i,s,o){return this[n].call(this,e,i,s,o)},configurable:!0})})}let Ps=class{constructor(e){e&&this.set(e)}set(e,r,n){const i=this;function s(a,l,u){const c=u0(l);if(!c)throw new Error("header name must be a non-empty string");const h=me.findKey(i,c);(!h||i[h]===void 0||u===!0||u===void 0&&i[h]!==!1)&&(i[h||l]=Tx(a))}const o=(a,l)=>me.forEach(a,(u,c)=>s(u,c,l));if(me.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(me.isString(e)&&(e=e.trim())&&!fle(e))o(cle(e),r);else if(me.isObject(e)&&me.isIterable(e)){let a={},l,u;for(const c of e){if(!me.isArray(c))throw TypeError("Object iterator must return a key-value pair");a[u=c[0]]=(l=a[u])?me.isArray(l)?[...l,c[1]]:[l,c[1]]:c[1]}o(a,r)}else e!=null&&s(r,e,n);return this}get(e,r){if(e=u0(e),e){const n=me.findKey(this,e);if(n){const i=this[n];if(!r)return i;if(r===!0)return hle(i);if(me.isFunction(r))return r.call(this,i,n);if(me.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=u0(e),e){const n=me.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||UT(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let i=!1;function s(o){if(o=u0(o),o){const a=me.findKey(n,o);a&&(!r||UT(n,n[a],a,r))&&(delete n[a],i=!0)}}return me.isArray(e)?e.forEach(s):s(e),i}clear(e){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!e||UT(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const r=this,n={};return me.forEach(this,(i,s)=>{const o=me.findKey(n,s);if(o){r[o]=Tx(i),delete r[s];return}const a=e?dle(s):String(s).trim();a!==s&&delete r[s],r[a]=Tx(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return me.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=e&&me.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[C3]=this[C3]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=u0(o);n[a]||(gle(i,o),n[a]=!0)}return me.isArray(e)?e.forEach(s):s(e),this}};Ps.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);me.reduceDescriptors(Ps.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});me.freezeMethods(Ps);function zT(t,e){const r=this||Yy,n=e||r,i=Ps.from(n.headers);let s=n.data;return me.forEach(t,function(a){s=a.call(r,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function U7(t){return!!(t&&t.__CANCEL__)}function Op(t,e,r){ft.call(this,t??"canceled",ft.ERR_CANCELED,e,r),this.name="CanceledError"}me.inherits(Op,ft,{__CANCEL__:!0});function z7(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new ft("Request failed with status code "+r.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function mle(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function ple(t,e){t=t||10;const r=new Array(t),n=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=n[s];o||(o=u),r[i]=l,n[i]=u;let h=s,f=0;for(;h!==i;)f+=r[h++],h=h%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),u-o<e)return;const d=c&&u-c;return d?Math.round(f*1e3/d):void 0}}function vle(t,e){let r=0,n=1e3/e,i,s;const o=(u,c=Date.now())=>{r=c,i=null,s&&(clearTimeout(s),s=null),t(...u)};return[(...u)=>{const c=Date.now(),h=c-r;h>=n?o(u,c):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-h)))},()=>i&&o(i)]}const Bb=(t,e,r=3)=>{let n=0;const i=ple(50,250);return vle(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-n,u=i(l),c=o<=a;n=o;const h={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:u||void 0,estimated:u&&a&&c?(a-o)/u:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(h)},r)},S3=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},x3=t=>(...e)=>me.asap(()=>t(...e)),wle=Ti.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,Ti.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(Ti.origin),Ti.navigator&&/(msie|trident)/i.test(Ti.navigator.userAgent)):()=>!0,yle=Ti.hasStandardBrowserEnv?{write(t,e,r,n,i,s){const o=[t+"="+encodeURIComponent(e)];me.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),me.isString(n)&&o.push("path="+n),me.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Cle(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Sle(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function G7(t,e,r){let n=!Cle(e);return t&&(n||r==!1)?Sle(t,e):e}const b3=t=>t instanceof Ps?{...t}:t;function Sd(t,e){e=e||{};const r={};function n(u,c,h,f){return me.isPlainObject(u)&&me.isPlainObject(c)?me.merge.call({caseless:f},u,c):me.isPlainObject(c)?me.merge({},c):me.isArray(c)?c.slice():c}function i(u,c,h,f){if(me.isUndefined(c)){if(!me.isUndefined(u))return n(void 0,u,h,f)}else return n(u,c,h,f)}function s(u,c){if(!me.isUndefined(c))return n(void 0,c)}function o(u,c){if(me.isUndefined(c)){if(!me.isUndefined(u))return n(void 0,u)}else return n(void 0,c)}function a(u,c,h){if(h in e)return n(u,c);if(h in t)return n(void 0,u)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(u,c,h)=>i(b3(u),b3(c),h,!0)};return me.forEach(Object.keys({...t,...e}),function(c){const h=l[c]||i,f=h(t[c],e[c],c);me.isUndefined(f)&&h!==a||(r[c]=f)}),r}const Y7=t=>{const e=Sd({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:a}=e;e.headers=o=Ps.from(o),e.url=V7(G7(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(me.isFormData(r)){if(Ti.hasStandardBrowserEnv||Ti.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...c]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...c].join("; "))}}if(Ti.hasStandardBrowserEnv&&(n&&me.isFunction(n)&&(n=n(e)),n||n!==!1&&wle(e.url))){const u=i&&s&&yle.read(s);u&&o.set(i,u)}return e},xle=typeof XMLHttpRequest<"u",ble=xle&&function(t){return new Promise(function(r,n){const i=Y7(t);let s=i.data;const o=Ps.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:u}=i,c,h,f,d,g;function m(){d&&d(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(c),i.signal&&i.signal.removeEventListener("abort",c)}let p=new XMLHttpRequest;p.open(i.method.toUpperCase(),i.url,!0),p.timeout=i.timeout;function w(){if(!p)return;const y=Ps.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),T={data:!a||a==="text"||a==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:y,config:t,request:p};z7(function(x){r(x),m()},function(x){n(x),m()},T),p=null}"onloadend"in p?p.onloadend=w:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(w)},p.onabort=function(){p&&(n(new ft("Request aborted",ft.ECONNABORTED,t,p)),p=null)},p.onerror=function(){n(new ft("Network Error",ft.ERR_NETWORK,t,p)),p=null},p.ontimeout=function(){let b=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const T=i.transitional||W7;i.timeoutErrorMessage&&(b=i.timeoutErrorMessage),n(new ft(b,T.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,t,p)),p=null},s===void 0&&o.setContentType(null),"setRequestHeader"in p&&me.forEach(o.toJSON(),function(b,T){p.setRequestHeader(T,b)}),me.isUndefined(i.withCredentials)||(p.withCredentials=!!i.withCredentials),a&&a!=="json"&&(p.responseType=i.responseType),u&&([f,g]=Bb(u,!0),p.addEventListener("progress",f)),l&&p.upload&&([h,d]=Bb(l),p.upload.addEventListener("progress",h),p.upload.addEventListener("loadend",d)),(i.cancelToken||i.signal)&&(c=y=>{p&&(n(!y||y.type?new Op(null,t,p):y),p.abort(),p=null)},i.cancelToken&&i.cancelToken.subscribe(c),i.signal&&(i.signal.aborted?c():i.signal.addEventListener("abort",c)));const v=mle(i.url);if(v&&Ti.protocols.indexOf(v)===-1){n(new ft("Unsupported protocol "+v+":",ft.ERR_BAD_REQUEST,t));return}p.send(s||null)})},_le=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,a();const c=u instanceof Error?u:this.reason;n.abort(c instanceof ft?c:new Op(c instanceof Error?c.message:c))}};let o=e&&setTimeout(()=>{o=null,s(new ft(`timeout ${e} of ms exceeded`,ft.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),t=null)};t.forEach(u=>u.addEventListener("abort",s));const{signal:l}=n;return l.unsubscribe=()=>me.asap(a),l}},Ele=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,i;for(;n<r;)i=n+e,yield t.slice(n,i),n=i},Rle=async function*(t,e){for await(const r of Tle(t))yield*Ele(r,e)},Tle=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},_3=(t,e,r,n)=>{const i=Rle(t,e);let s=0,o,a=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:c}=await i.next();if(u){a(),l.close();return}let h=c.byteLength;if(r){let f=s+=h;r(f)}l.enqueue(new Uint8Array(c))}catch(u){throw a(u),u}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},$E=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",K7=$E&&typeof ReadableStream=="function",kle=$E&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),X7=(t,...e)=>{try{return!!t(...e)}catch{return!1}},Ple=K7&&X7(()=>{let t=!1;const e=new Request(Ti.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),E3=64*1024,DO=K7&&X7(()=>me.isReadableStream(new Response("").body)),Vb={stream:DO&&(t=>t.body)};$E&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Vb[e]&&(Vb[e]=me.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new ft(`Response type '${e}' is not supported`,ft.ERR_NOT_SUPPORT,n)})})})(new Response);const Ale=async t=>{if(t==null)return 0;if(me.isBlob(t))return t.size;if(me.isSpecCompliantForm(t))return(await new Request(Ti.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(me.isArrayBufferView(t)||me.isArrayBuffer(t))return t.byteLength;if(me.isURLSearchParams(t)&&(t=t+""),me.isString(t))return(await kle(t)).byteLength},Ile=async(t,e)=>{const r=me.toFiniteNumber(t.getContentLength());return r??Ale(e)},Ole=$E&&(async t=>{let{url:e,method:r,data:n,signal:i,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:u,headers:c,withCredentials:h="same-origin",fetchOptions:f}=Y7(t);u=u?(u+"").toLowerCase():"text";let d=_le([i,s&&s.toAbortSignal()],o),g;const m=d&&d.unsubscribe&&(()=>{d.unsubscribe()});let p;try{if(l&&Ple&&r!=="get"&&r!=="head"&&(p=await Ile(c,n))!==0){let T=new Request(e,{method:"POST",body:n,duplex:"half"}),E;if(me.isFormData(n)&&(E=T.headers.get("content-type"))&&c.setContentType(E),T.body){const[x,P]=S3(p,Bb(x3(l)));n=_3(T.body,E3,x,P)}}me.isString(h)||(h=h?"include":"omit");const w="credentials"in Request.prototype;g=new Request(e,{...f,signal:d,method:r.toUpperCase(),headers:c.normalize().toJSON(),body:n,duplex:"half",credentials:w?h:void 0});let v=await fetch(g,f);const y=DO&&(u==="stream"||u==="response");if(DO&&(a||y&&m)){const T={};["status","statusText","headers"].forEach(A=>{T[A]=v[A]});const E=me.toFiniteNumber(v.headers.get("content-length")),[x,P]=a&&S3(E,Bb(x3(a),!0))||[];v=new Response(_3(v.body,E3,x,()=>{P&&P(),m&&m()}),T)}u=u||"text";let b=await Vb[me.findKey(Vb,u)||"text"](v,t);return!y&&m&&m(),await new Promise((T,E)=>{z7(T,E,{data:b,headers:Ps.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:g})})}catch(w){throw m&&m(),w&&w.name==="TypeError"&&/Load failed|fetch/i.test(w.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,t,g),{cause:w.cause||w}):ft.from(w,w&&w.code,t,g)}}),FO={http:Yae,xhr:ble,fetch:Ole};me.forEach(FO,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const R3=t=>`- ${t}`,Mle=t=>me.isFunction(t)||t===null||t===!1,q7={getAdapter:t=>{t=me.isArray(t)?t:[t];const{length:e}=t;let r,n;const i={};for(let s=0;s<e;s++){r=t[s];let o;if(n=r,!Mle(r)&&(n=FO[(o=String(r)).toLowerCase()],n===void 0))throw new ft(`Unknown adapter '${o}'`);if(n)break;i[o||"#"+s]=n}if(!n){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(R3).join(`
`):" "+R3(s[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:FO};function GT(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Op(null,t)}function T3(t){return GT(t),t.headers=Ps.from(t.headers),t.data=zT.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),q7.getAdapter(t.adapter||Yy.adapter)(t).then(function(n){return GT(t),n.data=zT.call(t,t.transformResponse,n),n.headers=Ps.from(n.headers),n},function(n){return U7(n)||(GT(t),n&&n.response&&(n.response.data=zT.call(t,t.transformResponse,n.response),n.response.headers=Ps.from(n.response.headers))),Promise.reject(n)})}const J7="1.11.0",BE={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{BE[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const k3={};BE.transitional=function(e,r,n){function i(s,o){return"[Axios v"+J7+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,a)=>{if(e===!1)throw new ft(i(o," has been removed"+(r?" in "+r:"")),ft.ERR_DEPRECATED);return r&&!k3[o]&&(k3[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(s,o,a):!0}};BE.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Nle(t,e,r){if(typeof t!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const s=n[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new ft("option "+s+" must be "+l,ft.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ft("Unknown option "+s,ft.ERR_BAD_OPTION)}}const kx={assertOptions:Nle,validators:BE},Ya=kx.validators;let sd=class{constructor(e){this.defaults=e||{},this.interceptors={request:new y3,response:new y3}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Sd(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&kx.assertOptions(n,{silentJSONParsing:Ya.transitional(Ya.boolean),forcedJSONParsing:Ya.transitional(Ya.boolean),clarifyTimeoutError:Ya.transitional(Ya.boolean)},!1),i!=null&&(me.isFunction(i)?r.paramsSerializer={serialize:i}:kx.assertOptions(i,{encode:Ya.function,serialize:Ya.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),kx.assertOptions(r,{baseUrl:Ya.spelling("baseURL"),withXsrfToken:Ya.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&me.merge(s.common,s[r.method]);s&&me.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=Ps.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let c,h=0,f;if(!l){const g=[T3.bind(this),void 0];for(g.unshift(...a),g.push(...u),f=g.length,c=Promise.resolve(r);h<f;)c=c.then(g[h++],g[h++]);return c}f=a.length;let d=r;for(h=0;h<f;){const g=a[h++],m=a[h++];try{d=g(d)}catch(p){m.call(this,p);break}}try{c=T3.call(this,d)}catch(g){return Promise.reject(g)}for(h=0,f=u.length;h<f;)c=c.then(u[h++],u[h++]);return c}getUri(e){e=Sd(this.defaults,e);const r=G7(e.baseURL,e.url,e.allowAbsoluteUrls);return V7(r,e.params,e.paramsSerializer)}};me.forEach(["delete","get","head","options"],function(e){sd.prototype[e]=function(r,n){return this.request(Sd(n||{},{method:e,url:r,data:(n||{}).data}))}});me.forEach(["post","put","patch"],function(e){function r(n){return function(s,o,a){return this.request(Sd(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}sd.prototype[e]=r(),sd.prototype[e+"Form"]=r(!0)});let Dle=class Q7{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{n.subscribe(a),s=a}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},e(function(s,o,a){n.reason||(n.reason=new Op(s,o,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Q7(function(i){e=i}),cancel:e}}};function Fle(t){return function(r){return t.apply(null,r)}}function Hle(t){return me.isObject(t)&&t.isAxiosError===!0}const HO={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HO).forEach(([t,e])=>{HO[e]=t});function Z7(t){const e=new sd(t),r=P7(sd.prototype.request,e);return me.extend(r,sd.prototype,e,{allOwnKeys:!0}),me.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return Z7(Sd(t,i))},r}const Xr=Z7(Yy);Xr.Axios=sd;Xr.CanceledError=Op;Xr.CancelToken=Dle;Xr.isCancel=U7;Xr.VERSION=J7;Xr.toFormData=LE;Xr.AxiosError=ft;Xr.Cancel=Xr.CanceledError;Xr.all=function(e){return Promise.all(e)};Xr.spread=Fle;Xr.isAxiosError=Hle;Xr.mergeConfig=Sd;Xr.AxiosHeaders=Ps;Xr.formToJSON=t=>j7(me.isHTMLForm(t)?new FormData(t):t);Xr.getAdapter=q7.getAdapter;Xr.HttpStatusCode=HO;Xr.default=Xr;const{Axios:Ftt,AxiosError:Htt,CanceledError:Ltt,isCancel:$tt,CancelToken:Btt,VERSION:Vtt,all:Wtt,Cancel:jtt,isAxiosError:Utt,spread:ztt,toFormData:Gtt,AxiosHeaders:Ytt,HttpStatusCode:Ktt,formToJSON:Xtt,getAdapter:qtt,mergeConfig:Jtt}=Xr;TN("object/save",async(t,{rejectWithValue:e})=>{var r,n;try{return(await Xr.post("/objects",t)).data}catch(i){return e(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка при сохранении")}});TN("object/import",async(t,{rejectWithValue:e})=>{var r,n;try{return(await Xr.post("/objects/import",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(i){return e(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка при импорте данных")}});const YT=TN("object/submitForm",async(t,{rejectWithValue:e})=>{var r,n;try{return(await Xr.post("/objects",t)).data}catch(i){return e(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка при отправке формы")}}),Lle={showObjectForm:!1,isLoading:!1,error:null},e9=T7({name:"objectForm",initialState:Lle,reducers:{showCreateForm:t=>{t.showObjectForm=!0},hideCreateForm:t=>{t.showObjectForm=!1}},extraReducers:t=>{t.addCase(YT.pending,e=>{e.isLoading=!0,e.error=null}).addCase(YT.fulfilled,e=>{e.isLoading=!1,e.showObjectForm=!1}).addCase(YT.rejected,(e,r)=>{e.isLoading=!1,e.error=r.error.message||"Ошибка сохранения"})}}),{showCreateForm:$le,hideCreateForm:t9}=e9.actions,Ble=e9.reducer,Vle="_wrapper_12zcq_1",Wle="_header_12zcq_25",jle="_backButton_12zcq_37",Ule="_title_12zcq_61",zle="_form_12zcq_75",Gle="_inputs_12zcq_87",Yle="_subTitle_12zcq_143",Kle="_searchPanel_12zcq_157",Xle="_searchInput_12zcq_171",qle="_actions_12zcq_187",Jle="_importBtn_12zcq_197",Qle="_addRowBtn_12zcq_199",Zle="_tableWrapper_12zcq_243",eue="_table_12zcq_243",tue="_emptyTable_12zcq_309",rue="_footer_12zcq_323",nue="_saveBtn_12zcq_333",ti={wrapper:Vle,header:Wle,backButton:jle,title:Ule,form:zle,inputs:Gle,subTitle:Yle,searchPanel:Kle,searchInput:Xle,actions:qle,importBtn:Jle,addRowBtn:Qle,tableWrapper:Zle,table:eue,emptyTable:tue,footer:rue,saveBtn:nue},r9=({onSubmit:t})=>{const e=PN(),[r,n]=pe.useState([]),i=pe.useRef(null),s=pe.useRef(1),o=()=>s.current++,a=()=>{e(t9())},l=()=>{n(g=>[...g,{id:o(),name:"",type:"",profileDefined:"",scaleHorizontal:"",scaleVertical:""}])},u=(g,m,p)=>{n(w=>w.map(v=>v.id===g?{...v,[m]:p}:v))},c=g=>{n(m=>m.filter(p=>p.id!==g))},h=()=>{var g;(g=i.current)==null||g.click()},f=g=>{const m=g.split(/\r?\n/).map(E=>E.trim()).filter(Boolean);if(!m.length)return[];const p=m[0],w=p.includes(";")?";":p.includes("	")?"	":",",v=m.map(E=>E.split(w).map(x=>x.trim())),b=(E=>E.some(x=>/наимен|тип|профил|масшт|name|type|profile|scale/i.test(x)))(v[0])?1:0,T=E=>{let x=[...E];x.length>=6&&/^\d+$/.test(x[0])&&(x=x.slice(1));const[P="",A="",O="",Y="",L=""]=x;return{id:o(),name:P,type:A,profileDefined:O,scaleHorizontal:Y,scaleVertical:L}};return v.slice(b).map(T).filter(E=>Object.values(E).some(Boolean))},d=async g=>{var w,v;const m=(w=g.target.files)==null?void 0:w[0];if(i.current&&(i.current.value=""),!m)return;const p=(v=m.name.split(".").pop())==null?void 0:v.toLowerCase();try{if(p==="csv"||p==="txt"){const y=await m.text(),b=f(y);if(!b.length){Tt.info("Файл прочитан, но данных не найдено");return}n(T=>[...T,...b]),Tt.success(`Импортировано строк: ${b.length}`);return}if(p==="json"){const y=await m.text(),T=(JSON.parse(y)||[]).map(E=>({id:o(),name:E.name??"",type:E.type??"",profileDefined:E.profileDefined??"",scaleHorizontal:E.scaleHorizontal??"",scaleVertical:E.scaleVertical??""}));if(!T.length){Tt.info("JSON прочитан, но данных не найдено");return}n(E=>[...E,...T]),Tt.success(`Импортировано строк: ${T.length}`);return}if(p==="xlsx"||p==="xls")try{const y=await aae(()=>Promise.resolve().then(()=>ACe),void 0),b=await m.arrayBuffer(),T=y.read(b,{type:"array"}),E=T.Sheets[T.SheetNames[0]],x=y.utils.sheet_to_json(E,{header:1});if(!x||!x.length){Tt.info("Лист Excel пуст");return}const A=(Y=>Y.some(L=>typeof L=="string"&&/наимен|тип|профил|масшт|name|type|profile|scale/i.test(L)))(x[0])?1:0,O=x.slice(A).map(Y=>Array.isArray(Y)?Y:[]).map(Y=>{let L=[...Y];L.length>=6&&typeof L[0]=="number"&&(L=L.slice(1));const[ie="",ce="",he="",Ee="",Ce=""]=L;return{id:o(),name:String(ie??""),type:String(ce??""),profileDefined:String(he??""),scaleHorizontal:String(Ee??""),scaleVertical:String(Ce??"")}}).filter(Y=>Object.values(Y).some(Boolean));if(!O.length){Tt.info("Excel прочитан, но данных не найдено");return}n(Y=>[...Y,...O]),Tt.success(`Импортировано строк: ${O.length}`);return}catch{Tt.error("Для импорта .xlsx установите пакет: npm i xlsx @types/xlsx");return}Tt.error("Поддерживаются форматы: .csv, .json, .xlsx, .xls")}catch(y){console.error(y),Tt.error("Не удалось импортировать файл")}};return j.jsxs("div",{className:ti.wrapper,children:[j.jsxs("div",{className:ti.header,children:[j.jsx("button",{className:ti.backButton,onClick:a}),j.jsx("h1",{className:ti.title,children:"Создание объекта"})]}),j.jsxs("form",{className:ti.form,onSubmit:g=>{g.preventDefault();const m=new FormData(g.currentTarget),p={name:m.get("name")||"",code:m.get("code")||"",contractNumber:m.get("contractNumber")||void 0,contractDate:m.get("contractDate")||void 0,designation:m.get("designation")||void 0,customer:m.get("customer")||void 0,contractor:m.get("contractor")||void 0,tableRows:r};t(p)},children:[j.jsxs("div",{className:ti.inputs,children:[j.jsxs("label",{children:["Наименование объекта",j.jsx("input",{name:"name",placeholder:"Введите наименование",required:!0})]}),j.jsxs("label",{children:["Код объекта",j.jsx("input",{name:"code",placeholder:"Введите код",required:!0})]}),j.jsxs("label",{children:["Номер контракта",j.jsx("input",{name:"contractNumber",placeholder:"Введите номер"})]}),j.jsxs("label",{children:["Дата контракта",j.jsx("input",{name:"contractDate",type:"date"})]}),j.jsxs("label",{children:["Назначение",j.jsx("input",{name:"designation",placeholder:"Введите назначение"})]}),j.jsxs("label",{children:["Заказчик",j.jsx("input",{name:"customer",placeholder:"Введите заказчика"})]}),j.jsxs("label",{children:["Подрядчик",j.jsx("input",{name:"contractor",placeholder:"Введите подрядчика"})]})]}),j.jsx("h2",{className:ti.subTitle,children:"Перечень графических приложений"}),j.jsxs("div",{className:ti.searchPanel,children:[j.jsx("input",{type:"text",placeholder:"Поиск...",className:ti.searchInput}),j.jsxs("div",{className:ti.actions,children:[j.jsx("button",{type:"button",className:ti.importBtn,onClick:h,children:"Импорт"}),j.jsx("button",{type:"button",className:ti.addRowBtn,onClick:l,children:"+ Добавить строку"})]})]}),j.jsx("input",{ref:i,type:"file",accept:".csv,.json,.xlsx,.xls,.txt",style:{display:"none"},onChange:d}),j.jsx("div",{className:ti.tableWrapper,children:j.jsxs("table",{className:ti.table,children:[j.jsx("thead",{children:j.jsxs("tr",{children:[j.jsx("th",{children:"№"}),j.jsx("th",{children:"Наименование графического приложения"}),j.jsx("th",{children:"Тип объекта"}),j.jsx("th",{children:"Профиль определен"}),j.jsx("th",{children:"Масштаб (гор.)"}),j.jsx("th",{children:"Масштаб (верт.)"}),j.jsx("th",{})]})}),j.jsx("tbody",{children:r.length===0?j.jsx("tr",{children:j.jsx("td",{colSpan:7,className:ti.emptyTable,children:"Данных нет"})}):r.map((g,m)=>j.jsxs("tr",{children:[j.jsx("td",{children:m+1}),j.jsx("td",{children:j.jsx("input",{value:g.name,onChange:p=>u(g.id,"name",p.target.value)})}),j.jsx("td",{children:j.jsx("input",{value:g.type,onChange:p=>u(g.id,"type",p.target.value)})}),j.jsx("td",{children:j.jsx("input",{value:g.profileDefined,onChange:p=>u(g.id,"profileDefined",p.target.value)})}),j.jsx("td",{children:j.jsx("input",{value:g.scaleHorizontal,onChange:p=>u(g.id,"scaleHorizontal",p.target.value)})}),j.jsx("td",{children:j.jsx("input",{value:g.scaleVertical,onChange:p=>u(g.id,"scaleVertical",p.target.value)})}),j.jsx("td",{children:j.jsx("button",{type:"button",onClick:()=>c(g.id),children:"✕"})})]},g.id))})]})}),j.jsx("div",{className:ti.footer,children:j.jsx("button",{type:"submit",className:ti.saveBtn,children:"Сохранить"})})]})]})},iue="_content__header_1ss6r_77",sue="_content__title_1ss6r_91",oue="_content__createButton_1ss6r_101",aue="_content__createIcon_1ss6r_151",lue="_content__empty_1ss6r_167",uue="_content__emptyTitle_1ss6r_191",cue="_content__emptyText_1ss6r_201",Yh={content__header:iue,content__title:sue,content__createButton:oue,content__createIcon:aue,content__empty:lue,content__emptyTitle:uue,content__emptyText:cue},hue=()=>{const t=PN(),{showObjectForm:e}=iae(n=>n.objectForm),r=()=>{t($le())};return j.jsx(j.Fragment,{children:e?j.jsx(r9,{onSubmit:n=>{console.log("Форма отправлена:",n)}}):j.jsxs(j.Fragment,{children:[j.jsxs("div",{className:Yh.content__header,children:[j.jsx("h2",{className:Yh.content__title,children:"Объекты"}),j.jsxs("button",{className:Yh.content__createButton,onClick:r,children:[j.jsx("div",{className:Yh.content__createIcon}),j.jsx("span",{children:"Создать объект"})]})]}),j.jsxs("div",{className:Yh.content__empty,children:[j.jsx("p",{className:Yh.content__emptyTitle,children:"Пока пусто"}),j.jsx("p",{className:Yh.content__emptyText,children:"Ваши объекты будут здесь"})]})]})})};function fue(t,e){for(const r in t)e(t[r],r)}function Ea(t,e){t.forEach(e)}function _s(t,e,r){if(!t)throw Error(`${r?r+": ":""}${e}`)}function Rh({node:t=[],from:e,source:r,parent:n=e||r,to:i,target:s,child:o=i||s,scope:a={},meta:l={},family:u={type:"regular"},regional:c}={}){const h=sC(n),f=sC(u.links),d=sC(u.owners),g=[];Ea(t,p=>p&&xu(g,p));const m={id:Eue(),seq:g,next:sC(o),meta:l,scope:a,family:{triggers:h.length,type:u.type||"crosslink",links:f,owners:d}};return Ea(f,p=>xu(WE(p),m)),Ea(d,p=>xu(jE(p),m)),Ea(h,p=>xu(p.next,m)),m}function zw(t,e,r){let n,i=bu,s=null,o=Sr;if(t.target&&(e=t.params,r=t.defer,n=t.meta,i="page"in t?t.page:i,t.stack&&(s=t.stack),o=bm(t)||o,t=t.target),o&&Sr&&o!==Sr&&(Sr=null),Array.isArray(t))for(let g=0;g<t.length;g++)Kh("pure",i,so(t[g]),s,e[g],o,n);else Kh("pure",i,so(t),s,e,o,n);if(r&&!oC)return;const a={isRoot:oC,currentPage:bu,scope:Sr,isWatch:Ix,isPure:Ox};let l,u,c,h,f,d;oC=0;e:for(;h=Lue();){const{idx:g,stack:m,type:p}=h;c=m.node,bu=f=m.page,Sr=bm(m),f?d=f.reg:Sr&&(d=Sr.reg);const w=!!f,v=!!Sr,y={fail:0,scope:c.scope};l=u=0;for(let b=g;b<c.seq.length&&!l;b++){const T=c.seq[b];if(T.order){const{priority:E,barrierID:x}=T.order,P=x?f?`${f.fullID}_${x}`:x:0;if(b!==g||p!==E){x?qT.has(P)||(qT.add(P),$O(b,m,E,x)):$O(b,m,E,0);continue e}x&&qT.delete(P)}switch(T.type){case"mov":{const x=T.data;let P;switch(x.from){case"stack":P=Px(m);break;case"a":case"b":P=m[x.from];break;case"value":P=x.store;break;case"store":if(d&&!d[x.store.id])if(w){const A=c9(f,x.store.id);m.page=f=A,A?d=A.reg:v?(up(Sr,x.store,0,1,x.softRead),d=Sr.reg):d=void 0}else v&&up(Sr,x.store,0,1,x.softRead);P=u9(d&&d[x.store.id]||x.store)}switch(x.to){case"stack":m.value=P;break;case"a":case"b":m[x.to]=P;break;case"store":$ue(f,Sr,x.target,0).current=P}break}case"compute":const E=T.data;if(E.fn){Ix=c.meta.op==="watch",Ox=E.pure;const x=E.safe?(0,E.fn)(Px(m),y.scope,m):Vue(y,E.fn,m);E.filter?u=!x:m.value=x,Ix=a.isWatch,Ox=a.isPure}}l=y.fail||u}if(!l){const b=Px(m),T=bm(m);if(Ea(c.next,E=>{Kh("child",f,E,m,b,T)}),T){c.meta.needFxCounter&&Kh("child",f,T.fxCount,m,b,T),c.meta.storeChange&&Kh("child",f,T.storeChange,m,b,T),c.meta.warnSerialize&&Kh("child",f,T.warnSerializeNode,m,b,T);const E=T.additionalLinks[c.id];E&&Ea(E,x=>{Kh("child",f,x,m,b,T)})}}}oC=a.isRoot,bu=a.currentPage,Sr=bm(a)}function due(t,e){let r,n;const i=t;if(e){const s=yue(e);t.length===0?(r=s.path,n=s.fullName):(r=s.path.concat([t]),n=s.fullName.length===0?t:s.fullName+"/"+t)}else r=t.length===0?[]:[t],n=t;return{shortName:i,fullName:n,path:r}}function MN(t,e){if(!e||!e.name&&!e.named&&!e.loc)return t;let r=`[${t}]`;const n=e.named||e.name;n&&(r+=` unit '${n}'`);const i=e.loc;return!n&&i&&(r+=` (${i.file}:${i.line}:${i.column})`),r}function LO(t){const e=()=>t();return e.unsubscribe=()=>t(),e}function Wv(t,...e){}function Gu(t,e){const r=cp({or:e,and:typeof t=="string"?{name:t}:t}),n=MN("event",r),i=(a,...l)=>(_s(!Nu(i,"derived"),"call of derived event is not supported, use createEvent instead",n),_s(!Ox,"unit call from pure function is not supported, use operators like sample instead",n),bu?((u,c,h,f)=>{const d=bu;M3(null);const m=u.create(h,f);return M3(d),m})(i,s,a,l):i.create(a,l)),s=kue(),o=Object.assign(i,{graphite:Rh({meta:f9(r.actualOp||"event",i,r,LN()),regional:1}),create:a=>(zw({target:i,params:a,scope:Sr}),a),watch:a=>h9(i,a),map:a=>JT(i,Gw,a,[_m()]),filter:a=>JT(i,"filter",a.fn?a:a.fn,[_m(YE,1)]),filterMap:a=>JT(i,"filterMap",a,[_m(),Vm(l=>!jv(l),1)]),prepend(a){_s(i.targetable,".prepend of derived event is not supported, call source event instead",n);const l=Gu("* → "+i.shortName,{parent:Yw(i)});return Wv("eventPrepend",so(l)),HN(l,i,[_m()],"prepend",a),jue(i,l),l}});return r!=null&&r.domain&&r.domain.hooks.event(o),kl(o,"id",o.graphite.id),o9(o.graphite),o}function P3(t,e,r,n,i){return Iue(r,`${i} ${e}`,"first argument"),_s(Ra(n),"second argument should be a function",i),jb(!Nu(t,"derived"),`${e} in derived store`,`${e} in store created via createStore`,i),Ea(Array.isArray(r)?r:[r],s=>{t.off(s),d9(s,t,"on",Mue,n)}),t}function VE(t,e){const r=cp(e),n=Fue(t),i=MN("store",r),s=Gu({named:"updates",derived:1});Wv("storeBase",n);const o=n.id,a="skipVoid"in r,l=a&&!r.skipVoid;jb(!(a&&r.skipVoid),"{skipVoid: true}","updateFilter",i);const u={updates:s,defaultState:t,stateRef:n,getState(){let w,v=n;if(bu){let y=bu;for(;y&&!y.reg[o];)y=Yw(y);y&&(w=y)}return!w&&Sr&&(up(Sr,n,1),w=Sr),w&&(v=w.reg[o]),u9(v)},setState:w=>zw({target:u,params:w,defer:1,scope:Sr}),reset:(...w)=>(_s(u.targetable,".reset of derived store is not supported",i),Ea(w,v=>P3(u,".reset",v,()=>u.defaultState,i)),u),on:(w,v)=>(_s(u.targetable,".on of derived store is not supported",i),P3(u,".on",w,v,i)),off(w){const v=so(w).id,y=so(u).family.links.find(b=>b.meta.onTrigger===v);return y&&Ub(y),u},map(w,v){let y,b;Wd(w)&&(y=w,w=w.fn);const T=u.getState(),E=jv(T);(!E||E&&l)&&(b=w(T));const x=VE(b,{name:`${u.shortName} → *`,derived:1,...v,and:y}),P=d9(u,x,Gw,YE,w);return Hue(Wb(x),{type:Gw,fn:w,from:n}),Wb(x).noInit=1,Wv("storeMap",n,P),x},watch(w,v){if(jb(!v,"watch second argument","sample",i),!v||!UE(w)){const y=h9(u,w);return Wv("storeWatch",n,w)||w(u.getState()),y}return _s(Ra(v),"second argument should be a function",i),w.watch(y=>v(u.getState(),y))}},c=f9("store",u,r,LN()),h=u.defaultConfig.updateFilter;u.graphite=Rh({scope:{state:n,fn:h},node:[Vm((w,v,y)=>(y.scope&&!y.scope.reg[n.id]&&(y.b=1),w)),Due(n),Vm((w,v,{a:y,b})=>{const T=jv(w);return T&&!a&&bue(`${QT}`,u.graphite),(T&&l||!T)&&(w!==y||b)},1),h&&_m(Oue,1),KE({from:"stack",target:n})],child:s,meta:{...c,defaultState:t,stateRef:n},regional:1}),kl(u,"id",u.graphite.id),kl(u,"rootStateRefId",o);const f=Nu(u,"serialize"),d=Nu(u,"derived"),g=f==="ignore",m=Nu(u,"sid");m&&(kl(u,"storeChange",1),n.sid=m),m||g||d||kl(u,"warnSerialize",1);const p=jv(t);return _s(d||!p||p&&l,QT,i),d&&p&&!a&&console.error(`${i}: ${QT}`),a9(u,[s]),r!=null&&r.domain&&r.domain.hooks.store(u),d||(u.reinit=Gu({named:"reinit"}),u.reset(u.reinit)),n.meta=u.graphite.meta,o9(u.graphite),u}function gue(){const t={};return t.req=new Promise((e,r)=>{t.rs=e,t.rj=r}),t.req.catch(()=>{}),t}function n9(t,e={}){const r=cp(Ra(t)?{handler:t}:t,e),n=MN("effect",r),i=Gu(Ra(t)?{handler:t}:t,{...e,actualOp:"effect"});Uue(i,LN());const s=so(i);kl(s,"op",i.kind="effect"),i.use=g=>(_s(Ra(g),".use argument should be a function",n),h.scope.handler=g,i),i.use.getCurrent=()=>h.scope.handler;const o=i.finally=Gu({named:"finally",derived:1}),a=i.done=o.filterMap({named:"done",fn({status:g,params:m,result:p}){if(g==="done")return{params:m,result:p}}}),l=i.fail=o.filterMap({named:"fail",fn({status:g,params:m,error:p}){if(g==="fail")return{params:m,error:p}}}),u=i.doneData=a.map({named:"doneData",fn:({result:g})=>g}),c=i.failData=l.map({named:"failData",fn:({error:g})=>g}),h=Rh({scope:{handler:i.defaultConfig.handler||(()=>_s(0,`no handler used in ${i.compositeName.fullName}`))},node:[Vm((g,m,p)=>{let w=m.handler;const v=bm(p);if(v){const y=v.handlers.unitMap.get(i)||v.handlers.sidMap[i.sid];y&&(w=y)}return g.handler=w,g},0,1),Vm((g,m,p)=>{if(m.runnerFn&&!m.runnerFn(g,null,p))return;const{params:w,req:v,handler:y,args:b=[w]}=g,T=F3(w,v,1,o,p),E=F3(w,v,0,o,p),[x,P]=zue(y,E,b);x&&(Wd(P)&&Ra(P.then)?P.then(T,E):T(P))},0,1)],meta:{op:"fx",fx:"runner"},regional:1});s.scope.runner=h,xu(s.seq,Vm((g,{runner:m},p)=>{const w=Yw(p)?{params:g,req:{rs(v){},rj(v){}}}:g;return p.meta||(p.meta={fxID:Rue()}),zw({target:m,params:w,defer:1,scope:bm(p),meta:p.meta}),w.params})),i.create=g=>{const m=gue(),p={params:g,req:m};if(Sr&&!Ix){const w=Sr;m.req.finally(()=>{VO(w)}).catch(()=>{})}return zw({target:i,params:p,scope:Sr}),m.req};const f=i.inFlight=VE(0,{serialize:"ignore",named:(Nu(i,"name")||i.graphite.id)+".inFlight"}).on(i,g=>g+1).on(o,g=>g-1).map({fn:g=>g,named:"inFlight"});kl(o,"needFxCounter","dec"),kl(i,"needFxCounter",1);const d=i.pending=f.map({fn:g=>g>0,named:"pending"});return a9(i,[o,a,l,u,c,d,f]),r!=null&&r.domain&&r.domain.hooks.effect(i),i}function mue(t,{scope:e,safe:r}={}){_s(e||Sr||r,"scopeBind: scope not found");const n=e||Sr;return(...i)=>{function s(){VO(l)}let o,a=0;const l=Sr;VO(n);try{o=t(...i)}catch(u){o=u,a=1}if(s(),a)throw o;return o instanceof Promise&&o.then(s,s),o}}function pue({unit:t,fn:e,scope:r,batch:n}){const i=[Ax.run({fn:o=>e(o)})];i.unshift(Ax.compute({priority:"sampler",batch:1})),zE(t)&&i.unshift(Ax.mov({store:t.stateRef,to:"stack"}));const s=Array.isArray(t)?t:[t];if(r){const o=[],a=r.additionalLinks;return s.forEach(l=>{const u=a[l.graphite.id]||[];a[l.graphite.id]=u;const c=Rh({node:vue(i,l),meta:{watchOp:l.kind}});u.push(c),o.push(()=>{const h=u.indexOf(c);h!==-1&&u.splice(h,1),Ub(c)})}),LO(()=>{o.forEach(l=>l())})}{const o=Rh({node:i,parent:s,family:{owners:s}});return LO(()=>{Ub(o)})}}function vue(t,e){return zE(e)?[Ax.mov({store:e.stateRef,to:"stack"}),...t]:t}const wue=typeof Symbol<"u"&&Symbol.observable||"@@observable",Gw="map",so=t=>t.graphite||t,WE=t=>t.family.owners,jE=t=>t.family.links,Wb=t=>t.stateRef,Px=t=>t.value,Yw=t=>t.parent,bm=t=>t.scope,Nu=(t,e)=>so(t).meta[e],kl=(t,e,r)=>so(t).meta[e]=r,yue=t=>t.compositeName,UE=t=>(Ra(t)||Wd(t))&&"kind"in t,Ky=t=>e=>UE(e)&&e.kind===t,zE=Ky("store"),Cue=Ky("event"),A3=Ky("effect"),Sue=t=>UE(t)&&!!t.targetable,i9=Ky("domain"),xue=Ky("scope");var iC={__proto__:null,unit:UE,store:zE,event:Cue,effect:A3,targetable:Sue,domain:i9,scope:xue,attached:t=>A3(t)&&Nu(t,"attached")==1};const KT=(t,e)=>t.includes(e),XT=(t,e)=>{const r=t.indexOf(e);r!==-1&&t.splice(r,1)},xu=(t,e)=>t.push(e),jb=(t,e,r,n)=>!t&&console.error(`${n?n+": ":""}${e} is deprecated${r?`, use ${r} instead`:""}`),bue=(t,e)=>{const r=Nu(e,"unitTrace"),n=Nu(e,"config"),i=n!=null&&n.loc?` at ${n.loc.file}`:null,s=n==null?void 0:n.name;let o=t;s&&(o=`${s}: ${t}`),i&&(o=`${s}${i}: ${t}`);const a=Error(o);r&&(a.stack=r),r||s||i||console.log(`Add effector's Babel or SWC plugin to your config for more detailed debug information or "import "effector/enable_debug_traces" to your code entry module to see full stack traces`),console.error(a)},GE=()=>{let t=0;return()=>""+ ++t},_ue=GE(),s9=GE(),Eue=GE(),Rue=GE();let Tue=null;const o9=t=>{},kue=()=>Tue,Pue=t=>t,a9=(t,e)=>{const r=so(t);Ea(e,n=>{const i=so(n);r.family.type!=="domain"&&(i.family.type="crosslink"),xu(WE(i),r),xu(jE(r),i)})},sC=(t=[])=>(Array.isArray(t)?t:[t]).flat().map(so),Wd=t=>typeof t=="object"&&t!==null,Ra=t=>typeof t=="function",jv=t=>t===void 0,Aue=t=>_s(Wd(t)||Ra(t),"expect first argument be an object"),I3=(t,e,r,n)=>_s(!(!Wd(t)&&!Ra(t)||!("family"in t)&&!("graphite"in t)),`${e}: expect ${r} to be a unit (store, event or effect)${n}`),Iue=(t,e,r)=>{Array.isArray(t)?Ea(t,(n,i)=>I3(n,e,`${i} item of ${r}`,"")):I3(t,e,r," or array of units")},Oue=(t,{fn:e},{a:r})=>e(t,r),Mue=(t,{fn:e},{a:r})=>e(r,t),YE=(t,{fn:e})=>e(t),l9=(t,e,r,n)=>{const i={id:s9(),type:t,data:e};return r&&(i.order={priority:r},n&&(i.order.barrierID=++Nue)),i};let Nue=0;const KE=({from:t="store",store:e,target:r,to:n=r?"store":"stack",batch:i,priority:s})=>l9("mov",{from:t,store:e,to:n,target:r},s,i),Kw=({fn:t,batch:e,priority:r,safe:n=0,filter:i=0,pure:s=0})=>l9("compute",{fn:t,safe:n,filter:i,pure:s},r,e),NN=({fn:t})=>Kw({fn:t,priority:"effect"}),Vm=(t,e,r)=>Kw({fn:t,safe:1,filter:e,priority:r&&"effect"}),Due=(t,e,r)=>KE({store:t,to:"a",priority:r,batch:1}),_m=(t=YE,e)=>Kw({fn:t,pure:1,filter:e}),Ax={mov:KE,compute:Kw,filter:({fn:t,pure:e})=>Kw({fn:t,filter:1,pure:e}),run:NN},Fue=t=>({id:s9(),current:t,initial:t}),u9=({current:t})=>t,Hue=(t,e)=>{t.before||(t.before=[]),xu(t.before,e)};let Em=null;const DN=(t,e)=>{if(!t)return e;if(!e)return t;let r;return(t.v.type===e.v.type&&t.v.id>e.v.id||BO(t.v.type)>BO(e.v.type))&&(r=t,t=e,e=r),r=DN(t.r,e),t.r=t.l,t.l=r,t},FN=[];let O3=0;for(;O3<6;)xu(FN,{first:null,last:null,size:0}),O3+=1;const Lue=()=>{for(let t=0;t<6;t++){const e=FN[t];if(e.size>0){if(t===3||t===4){e.size-=1;const n=Em.v;return Em=DN(Em.l,Em.r),n}e.size===1&&(e.last=null);const r=e.first;return e.first=r.r,e.size-=1,r.v}}},Kh=(t,e,r,n,i,s,o)=>$O(0,{a:null,b:null,node:r,parent:n,value:i,page:e,scope:s,meta:o},t,0),$O=(t,e,r,n)=>{const i=BO(r),s=FN[i],o={v:{idx:t,stack:e,type:r,id:n},l:null,r:null};i===3||i===4?Em=DN(Em,o):(s.size===0?s.first=o:s.last.r=o,s.last=o),s.size+=1},BO=t=>{switch(t){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},qT=new Set;let Sr,oC=1,Ix=0,Ox=0,bu=null;const VO=t=>{Sr=t},M3=t=>{bu=t},c9=(t,e)=>{if(t){for(;t&&!t.reg[e];)t=t.parent;if(t)return t}return null},$ue=(t,e,r,n)=>{const i=c9(t,r.id);return i?i.reg[r.id]:e?(up(e,r,n),e.reg[r.id]):r},Bue=t=>t,up=(t,e,r,n,i)=>{const s=t.reg;if(s[e.id])return;const o=e.sid,a={id:e.id,current:e.initial,meta:e.meta};if(a.id in t.values.idMap)a.current=t.values.idMap[a.id];else if(o&&o in t.values.sidMap&&!(o in t.sidIdMap)){var l;const u=e==null||(l=e.meta)===null||l===void 0?void 0:l.serialize;a.current=(t.fromSerialize&&u!=="ignore"&&(u==null?void 0:u.read)||Bue)(t.values.sidMap[o])}else if(e.before&&!i){let u=0;const c=r||!e.noInit||n;Ea(e.before,h=>{switch(h.type){case"map":{const f=h.from;if((f||h.fn)&&(f&&up(t,f,r,n),c)){const d=f&&s[f.id].current;a.current=h.fn?h.fn(d):d}break}case"field":up(t,h.from,r,n),u||(u=1,a.current=Array.isArray(a.current)?[...a.current]:{...a.current}),c&&(a.current[h.field]=s[s[h.from.id].id].current)}})}o&&(t.sidIdMap[o]=e.id),s[e.id]=a},Vue=(t,e,r)=>{try{return e(Px(r),t.scope,r)}catch(n){console.error(n),t.fail=1,t.failReason=n}},cp=(t,e={})=>(Wd(t)&&(cp(t.or,e),fue(t,(r,n)=>{jv(r)||n==="or"||n==="and"||(e[n]=r)}),cp(t.and,e)),e),N3=(t,e)=>{XT(t.next,e),XT(WE(t),e),XT(jE(t),e)},D3=["on","reset","sample","split","merge","guard","forward"],Mx=(t,e,r,n,i)=>{let s;t.next.length=0,t.seq.length=0,t.scope=null;let o=jE(t);const{stateRef:a,defaultShape:l,isRegion:u,op:c}=t.meta;if(a&&(a.before=[],t.meta.stateRef=null),l)for(const f in l)l[f]=null;const h=u?t:n;if(o.length>0){const f=KT(D3,c),d=!u&&!i,g=d&&r&&!f;for(;s=o.pop();){const m=KT(s.next,t);N3(s,t),u&&Mx(s,0,0,t,1),m||(s.family.triggers-=1),(e||g||d&&s.family.type==="crosslink"&&!f||i&&KT(D3,s.meta.op)&&(m&&s.next.length===0||!m&&s.family.triggers<=0))&&Mx(s,e,r&&s.meta.op!=="on",h,i)}}for(o=WE(t);s=o.pop();)N3(s,t),r&&s.family.type==="crosslink"&&Mx(s,e,s.meta.op!=="on",h,i)},aC=t=>t.clear(),Ub=(t,{deep:e}={})=>{let r=0;if(t.ownerSet&&t.ownerSet.delete(t),i9(t)){r=1;const n=t.history;aC(n.events),aC(n.effects),aC(n.stores),aC(n.domains)}Mx(so(t),!!e,r,null,0)},Wue=t=>LO(()=>Ub(t)),HN=(t,e,r,n,i)=>Rh({node:r,parent:t,child:e,scope:{fn:i},meta:{op:n},family:{owners:[t,e],links:e},regional:1}),h9=(t,e)=>(_s(Ra(e),".watch argument should be a function"),Wue(Rh({scope:{fn:e},node:[NN({fn:YE})],parent:t,meta:{op:"watch"},family:{owners:t},regional:1}))),jue=(t,e,r="event")=>{Yw(t)&&Yw(t).hooks[r](e)},Uue=(t,e)=>kl(t,"unitTrace",e),LN=t=>"",f9=(t,e,r,n)=>{const i=cp(r),s=t==="domain",o=_ue(),{sid:a=null,named:l=null,domain:u=null,parent:c=u}=i,h=l||i.name||(s?"":o),f=due(h,c),d={op:e.kind=t,name:e.shortName=h,sid:e.sid=Pue(a),named:l,unitId:e.id=o,serialize:i.serialize,derived:i.derived,config:i,unitTrace:n};return e.targetable=!i.derived,e.parent=c,e.compositeName=f,e.defaultConfig=i,e.getType=()=>(jb(0,"getType","compositeName.fullName"),f.fullName),!s&&(e.subscribe=g=>(Aue(g),e.watch(Ra(g)?g:m=>g.next&&g.next(m))),e[wue]=()=>e),d},JT=(t,e,r,n)=>{let i;Wd(r)&&(i=r,r=r.fn);const s=Gu({name:`${t.shortName} → *`,derived:1,and:i});return HN(t,s,n,e,r),s},QT="undefined is used to skip updates. To allow undefined as a value provide explicit { skipVoid: false } option",d9=(t,e,r,n,i)=>{const s=Wb(e),o=KE({store:s,to:"a",priority:"read"});r===Gw&&(o.data.softRead=1);const a=[o,_m(n)];Wv("storeOnMap",s,a,zE(t)&&Wb(t));const l=HN(t,e,a,r,i);return r!==Gw&&kl(l,"onTrigger",so(t).id),l},zue=(t,e,r)=>{try{return[1,t(...r)]}catch(n){return e(n),[0,null]}},F3=(t,e,r,n,i)=>s=>{zw({target:[n,Gue],params:[r?{status:"done",params:t,result:s}:{status:"fail",params:t,error:s},{value:s,fn:r?e.rs:e.rj}],defer:1,page:i.page,scope:i.scope,meta:i.meta})},Gue=Rh({node:[NN({fn:({fn:t,value:e})=>t(e)})],meta:{op:"fx",fx:"sidechain"}});var g9={exports:{}},m9={},p9={exports:{}},v9={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hp=pe;function Yue(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Kue=typeof Object.is=="function"?Object.is:Yue,Xue=hp.useState,que=hp.useEffect,Jue=hp.useLayoutEffect,Que=hp.useDebugValue;function Zue(t,e){var r=e(),n=Xue({inst:{value:r,getSnapshot:e}}),i=n[0].inst,s=n[1];return Jue(function(){i.value=r,i.getSnapshot=e,ZT(i)&&s({inst:i})},[t,r,e]),que(function(){return ZT(i)&&s({inst:i}),t(function(){ZT(i)&&s({inst:i})})},[t]),Que(r),r}function ZT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Kue(t,r)}catch{return!0}}function ece(t,e){return e()}var tce=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ece:Zue;v9.useSyncExternalStore=hp.useSyncExternalStore!==void 0?hp.useSyncExternalStore:tce;p9.exports=v9;var w9=p9.exports;const rce=aE(w9);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XE=pe,nce=w9;function ice(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var sce=typeof Object.is=="function"?Object.is:ice,oce=nce.useSyncExternalStore,ace=XE.useRef,lce=XE.useEffect,uce=XE.useMemo,cce=XE.useDebugValue;m9.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=ace(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=uce(function(){function l(d){if(!u){if(u=!0,c=d,d=n(d),i!==void 0&&o.hasValue){var g=o.value;if(i(g,d))return h=g}return h=d}if(g=h,sce(c,d))return g;var m=n(d);return i!==void 0&&i(g,m)?(c=d,g):(c=d,h=m)}var u=!1,c,h,f=r===void 0?null:r;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,r,n,i]);var a=oce(t,s[0],s[1]);return lce(function(){o.hasValue=!0,o.value=a},[a]),cce(a),a};g9.exports=m9;var hce=g9.exports;const fce=aE(hce);function dce(t,e){const r=iC.unit(t);let n={};r?n={unit:t}:"@@unitShape"in t?typeof t["@@unitShape"]=="function"?n=t["@@unitShape"]():H3("expect @@unitShape to be a function"):n=t;const i=Array.isArray(n),s=Ge.useRef({stale:1,justSubscribed:0,scope:e}),[o,a,l,u,c]=Ge.useMemo(()=>{s.current.stale=1;const g=Array.isArray(n)?[]:{},m=[],p=[],w=[],v=[];for(const y in n){if(!{}.hasOwnProperty.call(n,y))continue;const b=n[y];iC.unit(b)||H3(`expect useUnit ${r?"argument":`value in key "${y}"`} to be a unit`),iC.event(b)||iC.effect(b)?(g[y]=e?mue(b,{scope:e}):b,w.push(y),v.push(b)):(g[y]=null,m.push(y),p.push(b))}return[g,m,p,w,v]},[s,e,...Object.keys(n),...Object.values(n)]),h=Ge.useRef({value:o,storeKeys:a,eventKeys:u,eventValues:c}),f=Ge.useCallback(g=>{const m=s.current;return m.justSubscribed=1,pue({unit:l,fn:()=>{m.stale||(m.stale=1,g())},scope:e,batch:1})},[l,e,h,s]),d=Ge.useCallback(()=>{const g=h.current,m=s.current;let p,w=0;const v=g.value,y=g.storeKeys,b=g.eventKeys,T=g.eventValues,E=e!==m.scope;if(m.stale||m.justSubscribed||E){w=!m.justSubscribed||E,p=i?[...o]:{...o},y.length===a.length&&b.length===u.length||(w=1);for(let x=0;x<a.length;x++){const P=pce(l[x],e),A=a[x];w||(w=y.includes(A)?v[A]!==P:1),p[A]=P}for(let x=0;x<u.length;x++){const P=c[x],A=u[x];w||(w=b.includes(A)?T[b.indexOf(A)]!==P:1)}}return w&&(g.value=p),g.storeKeys=a,g.eventKeys=u,g.eventValues=c,m.stale=0,m.justSubscribed=!w,m.scope=e,r?g.value.unit:g.value},[f,l,c,e,h,s]);return mce(f,d,d)}function gce(t){return Ge.useContext(y9)}function Sv(t,e){return dce(t,gce())}const H3=t=>{throw Error(t)};typeof window<"u"?Ge.useLayoutEffect:Ge.useEffect;const{useSyncExternalStore:mce}=rce,{useSyncExternalStoreWithSelector:Qtt}=fce,pce=(t,e)=>e?e.getState(t):t.getState(),y9=Ge.createContext(null),{Provider:Ztt}=y9,vce=Gu(),C9=Gu(),S9=Gu(),x9=n9(async t=>(await new Promise(e=>setTimeout(e,300)),{id:Date.now().toString(),...t})),b9=n9(async t=>(await new Promise(e=>setTimeout(e,300)),Array.isArray(t)?t.map((e,r)=>({id:e.id??(Date.now()+r).toString(),name:e.name??"",code:e.code??"",contractNumber:e.contractNumber,contractDate:e.contractDate,designation:e.designation,customer:e.customer,contractor:e.contractor})):[{id:"1",name:"Импорт 1",code:"IMP001"},{id:"2",name:"Импорт 2",code:"IMP002"}])),wce=VE([]).on(vce,(t,e)=>[...t,e]).on(C9,(t,e)=>t.filter(r=>r.id!==e)).on(b9.doneData,(t,e)=>[...t,...e]).on(x9.doneData,(t,e)=>[...t,e]),yce=VE(1).on(S9,(t,e)=>e),Cce=()=>{const[t,e]=Sv([wce,yce]),r=Sv(C9),n=Sv(S9),i=Sv(b9),s=5,o=Math.ceil(t.length/s),a=t.slice((e-1)*s,e*s),l=()=>{const u=[{id:String(Date.now()),name:"Объект А",code:"A-001"},{id:String(Date.now()+1),name:"Объект B",code:"B-002"},{id:String(Date.now()+2),name:"Объект C",code:"C-003"}];i(u)};return j.jsxs("div",{style:{padding:24},children:[j.jsx("h2",{children:"Список объектов"}),j.jsx("div",{style:{marginBottom:16},children:j.jsx("button",{onClick:l,children:"Импортировать данные"})}),a.length===0?j.jsx("p",{children:"Нет данных"}):j.jsxs("table",{border:1,cellPadding:8,style:{width:"100%",borderCollapse:"collapse"},children:[j.jsx("thead",{children:j.jsxs("tr",{children:[j.jsx("th",{children:"Наименование"}),j.jsx("th",{children:"Шифр"}),j.jsx("th",{children:"Действия"})]})}),j.jsx("tbody",{children:a.map(u=>j.jsxs("tr",{children:[j.jsx("td",{children:u.name}),j.jsx("td",{children:u.code}),j.jsx("td",{children:j.jsx("button",{onClick:()=>r(u.id),children:"Удалить"})})]},u.id))})]}),o>1&&j.jsx("div",{style:{marginTop:16},children:Array.from({length:o},(u,c)=>c+1).map(u=>j.jsx("button",{style:{marginRight:8,background:u===e?"#ccc":"white"},onClick:()=>n(u),children:u},u))})]})},Sce=()=>{const t=Sv(x9),e=PN(),r=i=>{t(i)},n=()=>{e(t9())};return j.jsxs("div",{style:{padding:24},children:[j.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[j.jsx("button",{onClick:n,style:{marginRight:8,background:"none",border:"none",cursor:"pointer",fontSize:18},children:"←"}),j.jsx("h2",{style:{margin:0},children:"Создание объекта"})]}),j.jsx(r9,{onSubmit:r}),j.jsx("div",{style:{marginTop:16},children:j.jsx("button",{type:"submit",form:"object-form",children:"Сохранить"})})]})},xce=()=>j.jsx("div",{children:"Аккаунт"}),bce=()=>j.jsx("div",{children:"Подписки"}),_ce=()=>j.jsx("div",{children:"Прзервативзователи"}),Ece=()=>j.jsx("div",{children:"Настройки"}),Rce="/my-profgeo-app/assets/hero-COwIpbDv.png",Tce=()=>j.jsx("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center"},children:j.jsx("img",{src:Rce,alt:"Добро пожаловать",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12,boxShadow:"0 4px 20px rgba(0,0,0,0.3)"}})}),kce=()=>{const[t,e]=pe.useState(""),[r,n]=pe.useState(""),i=Vy(l=>l.auth.isAuthenticated),s=By(),o=RE();pe.useEffect(()=>{i&&o("/lk",{replace:!0})},[i,o]);const a=l=>{l.preventDefault(),s(uoe({email:t,password:r}))};return j.jsxs("div",{style:{padding:40,maxWidth:360,margin:"0 auto"},children:[j.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"ВХОД"}),j.jsxs("form",{onSubmit:a,style:{display:"flex",flexDirection:"column",gap:12},children:[j.jsx("input",{type:"email",placeholder:"Введите e-mail",value:t,onChange:l=>e(l.target.value)}),j.jsx("input",{type:"password",placeholder:"Введите пароль",value:r,onChange:l=>n(l.target.value)}),j.jsx("button",{type:"submit",children:"Войти"})]}),j.jsxs("div",{style:{marginTop:12,textAlign:"center"},children:["Нет аккаунта? ",j.jsx(Hc,{to:"/register",children:"Зарегистрироваться"})]})]})},Pce=()=>j.jsx("div",{style:{padding:40,textAlign:"center"},children:j.jsx("h2",{children:"Регистрация будет реализована позже"})}),L3=({children:t})=>Vy(r=>r.auth.isAuthenticated)?t:j.jsx(pie,{to:"/login",replace:!0});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xw={};Xw.version="0.18.5";var to=1200,xd=1252,Ace=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$N={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},qE=function(t){Ace.indexOf(t)!=-1&&(xd=$N[0]=t)};function Ice(){qE(1252)}var $o=function(t){to=t,qE(t)};function JE(){$o(1200),Ice()}function zb(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Oce(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function _9(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Rm=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Oce(t.slice(2)):e==254&&r==255?_9(t.slice(2)):e==65279?t.slice(1):t},xv=function(e){return String.fromCharCode(e)},WO=function(e){return String.fromCharCode(e)},Ht;function Mce(t){Ht=t,$o=function(e){to=e,qE(e)},Rm=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?Ht.utils.decode(1200,zb(e.slice(2))):e},xv=function(r){return to===1200?String.fromCharCode(r):Ht.utils.decode(to,[r&255,r>>8])[0]},WO=function(r){return Ht.utils.decode(xd,[r])[0]},Z9()}var Jc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qw(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,i=t.charCodeAt(u++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),e+=Jc.charAt(s)+Jc.charAt(o)+Jc.charAt(a)+Jc.charAt(l);return e}function oo(t){var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=Jc.indexOf(t.charAt(u++)),o=Jc.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),a=Jc.indexOf(t.charAt(u++)),n=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(n)),l=Jc.indexOf(t.charAt(u++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),tc=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Th(t){return xt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function $3(t){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Xs=function(e){return xt?tc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Xy(t){if(typeof ArrayBuffer>"u")return Xs(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Hh(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Nce(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function BN(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return BN(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Jn=xt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:tc(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Dce(t){for(var e=[],r=0,n=t.length+250,i=Th(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Th(65535),n=65530)}return e.push(i.slice(0,r)),Jn(e)}var Ai=/\u0000/g,bv=/[\u0001-\u0006]/g;function Wm(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ta(t,e){var r=""+t;return r.length>=e?r:nn("0",e-r.length)+r}function VN(t,e){var r=""+t;return r.length>=e?r:nn(" ",e-r.length)+r}function Gb(t,e){var r=""+t;return r.length>=e?r:r+nn(" ",e-r.length)}function Fce(t,e){var r=""+Math.round(t);return r.length>=e?r:nn("0",e-r.length)+r}function Hce(t,e){var r=""+t;return r.length>=e?r:nn("0",e-r.length)+r}var B3=Math.pow(2,32);function ug(t,e){if(t>B3||t<-B3)return Fce(t,e);var r=Math.round(t);return Hce(r,e)}function Yb(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var V3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ek=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Lce(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},W3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$ce={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kb(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,o=1,a=0,l=1,u=0,c=0,h=Math.floor(i);u<e&&(h=Math.floor(i),a=h*o+s,c=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=u,u=c;if(c>e&&(u>e?(c=l,a=s):(c=u,a=o)),!r)return[0,n*a,c];var f=Math.floor(n*a/c);return[f,n*a-f*c,c]}function Qc(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,o=[],a={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=zce(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var E9=new Date(1899,11,31,0,0,0),Bce=E9.getTime(),Vce=new Date(1900,2,1,0,0,0);function R9(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Vce&&(r+=24*60*60*1e3),(r-(Bce+(t.getTimezoneOffset()-E9.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function WN(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wce(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jce(t){var e=t<0?12:11,r=WN(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Uce(t){var e=WN(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Jw(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=jce(t):e===10?r=t.toFixed(10).substr(0,12):r=Uce(t),WN(Wce(r.toUpperCase()))}function bd(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Jw(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ao(14,R9(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function zce(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Gce(t,e,r,n){var i="",s=0,o=0,a=r.y,l,u=0;switch(t){case 98:a=r.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return ek[r.m-1][1];case 5:return ek[r.m-1][0];default:return ek[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return V3[r.q][0];default:return V3[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ta(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=Ta(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=a,u=1;break}var c=u>0?Ta(l,u):"";return c}function Zc(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var T9=/%/g;function Yce(t,e,r){var n=e.replace(T9,""),i=e.length-n.length;return Du(t,n,r*Math.pow(10,2*i))+nn("%",i)}function Kce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Du(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function k9(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+k9(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var P9=/# (\?+)( ?)\/( ?)(\d+)/;function Xce(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?nn(" ",t[1].length+1+t[4].length):VN(o,t[1].length)+t[2]+"/"+t[3]+Ta(a,t[4].length))}function qce(t,e,r){return r+(e===0?"":""+e)+nn(" ",t[1].length+2+t[4].length)}var A9=/^#*0*\.([0#]+)/,I9=/\).*[0#]/,O9=/\(###\) ###\\?-####/;function Gi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function j3(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function U3(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Jce(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Qce(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Co(t,e,r){if(t.charCodeAt(0)===40&&!e.match(I9)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Co("n",n,r):"("+Co("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Kce(t,e,r);if(e.indexOf("%")!==-1)return Yce(t,e,r);if(e.indexOf("E")!==-1)return k9(e,r);if(e.charCodeAt(0)===36)return"$"+Co(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+ug(l,e.length);if(e.match(/^[#?]+$/))return i=ug(r,0),i==="0"&&(i=""),i.length>e.length?i:Gi(e.substr(0,e.length-i.length))+i;if(s=e.match(P9))return Xce(s,l,u);if(e.match(/^#+0+$/))return u+ug(l,e.length-e.indexOf("0"));if(s=e.match(A9))return i=j3(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Gi(s[1])).replace(/\.$/,"."+Gi(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+nn("0",Gi(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+j3(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Zc(ug(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Co(t,e,-r):Zc(""+(Math.floor(r)+Jce(r,s[1].length)))+"."+Ta(U3(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Co(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Wm(Co(t,e.replace(/[\\-]/g,""),r)),o=0,Wm(Wm(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(e.match(O9))return i=Co(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Kb(l,Math.pow(10,o)-1,!1),i=""+u,c=Du("n",s[1],a[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=Gb(a[2],o),c.length<s[4].length&&(c=Gi(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Kb(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?VN(a[1],o)+s[2]+"/"+s[3]+Gb(a[2],o):nn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=ug(r,0),e.length<=i.length?i:Gi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Gi(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=U3(r,s[1].length),r<0?"-"+Co(t,e,-r):Zc(Qce(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ta(0,3-g.length):"")+g})+"."+Ta(o,s[1].length);switch(e){case"###,##0.00":return Co(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Zc(ug(l,0));return d!=="0"?u+d:"";case"###,###.00":return Co(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Co(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Zce(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Du(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function ehe(t,e,r){var n=e.replace(T9,""),i=e.length-n.length;return Du(t,n,r*Math.pow(10,2*i))+nn("%",i)}function M9(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+M9(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(I9)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fl("n",n,r):"("+fl("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Zce(t,e,r);if(e.indexOf("%")!==-1)return ehe(t,e,r);if(e.indexOf("E")!==-1)return M9(e,r);if(e.charCodeAt(0)===36)return"$"+fl(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Ta(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Gi(e.substr(0,e.length-i.length))+i;if(s=e.match(P9))return qce(s,l,u);if(e.match(/^#+0+$/))return u+Ta(l,e.length-e.indexOf("0"));if(s=e.match(A9))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Gi(s[1])).replace(/\.$/,"."+Gi(s[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+nn("0",Gi(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Zc(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fl(t,e,-r):Zc(""+r)+"."+nn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return fl(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Wm(fl(t,e.replace(/[\\-]/g,""),r)),o=0,Wm(Wm(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(e.match(O9))return i=fl(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Kb(l,Math.pow(10,o)-1,!1),i=""+u,c=Du("n",s[1],a[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=Gb(a[2],o),c.length<s[4].length&&(c=Gi(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Kb(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?VN(a[1],o)+s[2]+"/"+s[3]+Gb(a[2],o):nn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Gi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Gi(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fl(t,e,-r):Zc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ta(0,3-g.length):"")+g})+"."+Ta(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=Zc(""+l);return d!=="0"?u+d:"";default:if(e.match(/\.[0#?]*$/))return fl(t,e.slice(0,e.lastIndexOf(".")),r)+Gi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Du(t,e,r){return(r|0)===r?fl(t,e,r):Co(t,e,r)}function the(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var N9=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jd(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Yb(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(N9))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function rhe(t,e,r,n){for(var i=[],s="",o=0,a="",l="t",u,c,h,f="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!Yb(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var d=t.charAt(++o),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=Qc(e,r,t.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=Qc(e,r),u==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=f),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"上":var m={t:a,v:a};if(u==null&&(u=Qc(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="上午/下午"?(u!=null&&(m.v=u.H>=12?"下午":"上午"),m.t="T",o+=5,f="h"):(m.t="t",++o),u==null&&m.t==="T")return"";i[i.length]=m,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(N9)){if(u==null&&(u=Qc(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",jd(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var p=0,w=0,v;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=f,l="h",p<1&&(p=1);break;case"s":(v=i[o].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[o].v.match(/[Hh]/)&&(p=1),p<2&&i[o].v.match(/[Mm]/)&&(p=2),p<3&&i[o].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",b;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Gce(i[o].t.charCodeAt(0),i[o].v,u,w),i[o].t="t";break;case"n":case"?":for(b=o+1;i[b]!=null&&((a=i[b].t)==="?"||a==="D"||(a===" "||a==="t")&&i[b+1]!=null&&(i[b+1].t==="?"||i[b+1].t==="t"&&i[b+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[b].v==="/"||i[b].v===" "&&i[b+1]!=null&&i[b+1].t=="?"));)i[o].v+=i[b].v,i[b]={v:"",t:";"},++b;y+=i[o].v,o=b-1;break;case"G":i[o].t="t",i[o].v=bd(e,r);break}var T="",E,x;if(y.length>0){y.charCodeAt(0)==40?(E=e<0&&y.charCodeAt(0)===45?-e:e,x=Du("n",y,E)):(E=e<0&&n>1?-e:e,x=Du("n",y,E),E<0&&i[0]&&i[0].t=="t"&&(x=x.substr(1),i[0].v="-"+i[0].v)),b=x.length-1;var P=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){P=o;break}var A=i.length;if(P===i.length&&x.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(b>=i[o].v.length-1?(b-=i[o].v.length,i[o].v=x.substr(b+1,i[o].v.length)):b<0?i[o].v="":(i[o].v=x.substr(0,b+1),b=-1),i[o].t="t",A=o);b>=0&&A<i.length&&(i[A].v=x.substr(0,b+1)+i[A].v)}else if(P!==i.length&&x.indexOf("E")===-1){for(b=x.indexOf(".")-1,o=P;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(c=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")-1:i[o].v.length-1,T=i[o].v.substr(c+1);c>=0;--c)b>=0&&(i[o].v.charAt(c)==="0"||i[o].v.charAt(c)==="#")&&(T=x.charAt(b--)+T);i[o].v=T,i[o].t="t",A=o}for(b>=0&&A<i.length&&(i[A].v=x.substr(0,b+1)+i[A].v),b=x.indexOf(".")+1,o=P;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==P)){for(c=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")+1:0,T=i[o].v.substr(0,c);c<i[o].v.length;++c)b<x.length&&(T+=x.charAt(b++));i[o].v=T,i[o].t="t",A=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(E=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Du(i[o].t,i[o].v,E),i[o].t="t");var O="";for(o=0;o!==i.length;++o)i[o]!=null&&(O+=i[o].v);return O}var z3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function G3(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function nhe(t,e){var r=the(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(z3),a=r[1].match(z3);return G3(e,o)?[n,r[0]]:G3(e,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function ao(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:rt)[t],n==null&&(n=r.table&&r.table[W3[t]]||rt[W3[t]]),n==null&&(n=$ce[t]||"General");break}if(Yb(n,0))return bd(e,r);e instanceof Date&&(e=R9(e,r.date1904));var i=nhe(n,e);if(Yb(i[1]))return bd(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return rhe(i[1],e,r,i[0])}function Ml(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(rt[r]==null){e<0&&(e=r);continue}if(rt[r]==t){e=r;break}}e<0&&(e=391)}return rt[e]=t,e}function qy(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ml(t[e],e)}function Mp(){rt=Lce()}var D9={format:ao,load:Ml,_table:rt,load_table:qy,parse_date_code:Qc,is_date:jd,get_table:function(){return D9._table=rt}},ihe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},F9=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function she(t){var e=typeof t=="number"?rt[t]:t;return e=e.replace(F9,"(\\d+)"),new RegExp("^"+e+"$")}function ohe(t,e,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(F9)||[]).forEach(function(h,f){var d=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?a=d:i=d;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:n==-1&&i==-1&&s==-1?c:u+"T"+c}var ahe=function(){var t={};t.version="1.2.0";function e(){for(var x=0,P=new Array(256),A=0;A!=256;++A)x=A,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,P[A]=x;return typeof Int32Array<"u"?new Int32Array(P):P}var r=e();function n(x){var P=0,A=0,O=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)Y[O]=x[O];for(O=0;O!=256;++O)for(A=x[O],P=256+O;P<4096;P+=256)A=Y[P]=A>>>8^x[A&255];var L=[];for(O=1;O!=16;++O)L[O-1]=typeof Int32Array<"u"?Y.subarray(O*256,O*256+256):Y.slice(O*256,O*256+256);return L}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],c=i[5],h=i[6],f=i[7],d=i[8],g=i[9],m=i[10],p=i[11],w=i[12],v=i[13],y=i[14];function b(x,P){for(var A=P^-1,O=0,Y=x.length;O<Y;)A=A>>>8^r[(A^x.charCodeAt(O++))&255];return~A}function T(x,P){for(var A=P^-1,O=x.length-15,Y=0;Y<O;)A=y[x[Y++]^A&255]^v[x[Y++]^A>>8&255]^w[x[Y++]^A>>16&255]^p[x[Y++]^A>>>24]^m[x[Y++]]^g[x[Y++]]^d[x[Y++]]^f[x[Y++]]^h[x[Y++]]^c[x[Y++]]^u[x[Y++]]^l[x[Y++]]^a[x[Y++]]^o[x[Y++]]^s[x[Y++]]^r[x[Y++]];for(O+=15;Y<O;)A=A>>>8^r[(A^x[Y++])&255];return~A}function E(x,P){for(var A=P^-1,O=0,Y=x.length,L=0,ie=0;O<Y;)L=x.charCodeAt(O++),L<128?A=A>>>8^r[(A^L)&255]:L<2048?(A=A>>>8^r[(A^(192|L>>6&31))&255],A=A>>>8^r[(A^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,ie=x.charCodeAt(O++)&1023,A=A>>>8^r[(A^(240|L>>8&7))&255],A=A>>>8^r[(A^(128|L>>2&63))&255],A=A>>>8^r[(A^(128|ie>>6&15|(L&3)<<4))&255],A=A>>>8^r[(A^(128|ie&63))&255]):(A=A>>>8^r[(A^(224|L>>12&15))&255],A=A>>>8^r[(A^(128|L>>6&63))&255],A=A>>>8^r[(A^(128|L&63))&255]);return~A}return t.table=r,t.bstr=b,t.buf=T,t.str=E,t}(),Xe=function(){var e={};e.version="1.2.1";function r(I,z){for(var F=I.split("/"),H=z.split("/"),G=0,K=0,ue=Math.min(F.length,H.length);G<ue;++G){if(K=F[G].length-H[G].length)return K;if(F[G]!=H[G])return F[G]<H[G]?-1:1}return F.length-H.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var z=I.lastIndexOf("/");return z===-1?I:I.slice(0,z+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var z=I.lastIndexOf("/");return z===-1?I:I.slice(z+1)}function s(I,z){typeof z=="string"&&(z=new Date(z));var F=z.getHours();F=F<<6|z.getMinutes(),F=F<<5|z.getSeconds()>>>1,I.write_shift(2,F);var H=z.getFullYear()-1980;H=H<<4|z.getMonth()+1,H=H<<5|z.getDate(),I.write_shift(2,H)}function o(I){var z=I.read_shift(2)&65535,F=I.read_shift(2)&65535,H=new Date,G=F&31;F>>>=5;var K=F&15;F>>>=4,H.setMilliseconds(0),H.setFullYear(F+1980),H.setMonth(K-1),H.setDate(G);var ue=z&31;z>>>=5;var we=z&63;return z>>>=6,H.setHours(z),H.setMinutes(we),H.setSeconds(ue<<1),H}function a(I){ai(I,0);for(var z={},F=0;I.l<=I.length-4;){var H=I.read_shift(2),G=I.read_shift(2),K=I.l+G,ue={};switch(H){case 21589:F=I.read_shift(1),F&1&&(ue.mtime=I.read_shift(4)),G>5&&(F&2&&(ue.atime=I.read_shift(4)),F&4&&(ue.ctime=I.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}I.l=K,z[H]=ue}return z}var l;function u(){return l||(l={})}function c(I,z){if(I[0]==80&&I[1]==75)return Ua(I,z);if((I[0]|32)==109&&(I[1]|32)==105)return Zp(I,z);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var F=3,H=512,G=0,K=0,ue=0,we=0,le=0,ne=[],N=I.slice(0,512);ai(N,0);var se=h(N);switch(F=se[0],F){case 3:H=512;break;case 4:H=4096;break;case 0:if(se[1]==0)return Ua(I,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}H!==512&&(N=I.slice(0,H),ai(N,28));var de=I.slice(0,H);f(N,F);var ke=N.read_shift(4,"i");if(F===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);N.l+=4,ue=N.read_shift(4,"i"),N.l+=4,N.chk("00100000","Mini Stream Cutoff Size: "),we=N.read_shift(4,"i"),G=N.read_shift(4,"i"),le=N.read_shift(4,"i"),K=N.read_shift(4,"i");for(var be=-1,Ae=0;Ae<109&&(be=N.read_shift(4,"i"),!(be<0));++Ae)ne[Ae]=be;var Ye=d(I,H);p(le,K,Ye,H,ne);var Bt=v(Ye,ue,ne,H);Bt[ue].name="!Directory",G>0&&we!==ie&&(Bt[we].name="!MiniFAT"),Bt[ne[0]].name="!FAT",Bt.fat_addrs=ne,Bt.ssz=H;var tr={},Sn=[],Jr=[],fc=[];y(ue,Bt,Ye,Sn,G,tr,Jr,we),g(Jr,fc,Sn),Sn.shift();var dc={FileIndex:Jr,FullPaths:fc};return z&&z.raw&&(dc.raw={header:de,sectors:Ye}),dc}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ce,"Header Signature: "),I.l+=16;var z=I.read_shift(2,"u");return[I.read_shift(2,"u"),z]}function f(I,z){var F=9;switch(I.l+=2,F=I.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function d(I,z){for(var F=Math.ceil(I.length/z)-1,H=[],G=1;G<F;++G)H[G-1]=I.slice(G*z,(G+1)*z);return H[F-1]=I.slice(F*z),H}function g(I,z,F){for(var H=0,G=0,K=0,ue=0,we=0,le=F.length,ne=[],N=[];H<le;++H)ne[H]=N[H]=H,z[H]=F[H];for(;we<N.length;++we)H=N[we],G=I[H].L,K=I[H].R,ue=I[H].C,ne[H]===H&&(G!==-1&&ne[G]!==G&&(ne[H]=ne[G]),K!==-1&&ne[K]!==K&&(ne[H]=ne[K])),ue!==-1&&(ne[ue]=H),G!==-1&&H!=ne[H]&&(ne[G]=ne[H],N.lastIndexOf(G)<we&&N.push(G)),K!==-1&&H!=ne[H]&&(ne[K]=ne[H],N.lastIndexOf(K)<we&&N.push(K));for(H=1;H<le;++H)ne[H]===H&&(K!==-1&&ne[K]!==K?ne[H]=ne[K]:G!==-1&&ne[G]!==G&&(ne[H]=ne[G]));for(H=1;H<le;++H)if(I[H].type!==0){if(we=H,we!=ne[we])do we=ne[we],z[H]=z[we]+"/"+z[H];while(we!==0&&ne[we]!==-1&&we!=ne[we]);ne[H]=-1}for(z[0]+="/",H=1;H<le;++H)I[H].type!==2&&(z[H]+="/")}function m(I,z,F){for(var H=I.start,G=I.size,K=[],ue=H;F&&G>0&&ue>=0;)K.push(z.slice(ue*L,ue*L+L)),G-=L,ue=Vf(F,ue*4);return K.length===0?ve(0):Jn(K).slice(0,I.size)}function p(I,z,F,H,G){var K=ie;if(I===ie){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ue=F[I],we=(H>>>2)-1;if(!ue)return;for(var le=0;le<we&&(K=Vf(ue,le*4))!==ie;++le)G.push(K);p(Vf(ue,H-4),z-1,F,H,G)}}function w(I,z,F,H,G){var K=[],ue=[];G||(G=[]);var we=H-1,le=0,ne=0;for(le=z;le>=0;){G[le]=!0,K[K.length]=le,ue.push(I[le]);var N=F[Math.floor(le*4/H)];if(ne=le*4&we,H<4+ne)throw new Error("FAT boundary crossed: "+le+" 4 "+H);if(!I[N])break;le=Vf(I[N],ne)}return{nodes:K,data:iB([ue])}}function v(I,z,F,H){var G=I.length,K=[],ue=[],we=[],le=[],ne=H-1,N=0,se=0,de=0,ke=0;for(N=0;N<G;++N)if(we=[],de=N+z,de>=G&&(de-=G),!ue[de]){le=[];var be=[];for(se=de;se>=0;){be[se]=!0,ue[se]=!0,we[we.length]=se,le.push(I[se]);var Ae=F[Math.floor(se*4/H)];if(ke=se*4&ne,H<4+ke)throw new Error("FAT boundary crossed: "+se+" 4 "+H);if(!I[Ae]||(se=Vf(I[Ae],ke),be[se]))break}K[de]={nodes:we,data:iB([le])}}return K}function y(I,z,F,H,G,K,ue,we){for(var le=0,ne=H.length?2:0,N=z[I].data,se=0,de=0,ke;se<N.length;se+=128){var be=N.slice(se,se+128);ai(be,64),de=be.read_shift(2),ke=tR(be,0,de-ne),H.push(ke);var Ae={name:ke,type:be.read_shift(1),color:be.read_shift(1),L:be.read_shift(4,"i"),R:be.read_shift(4,"i"),C:be.read_shift(4,"i"),clsid:be.read_shift(16),state:be.read_shift(4,"i"),start:0,size:0},Ye=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Ye!==0&&(Ae.ct=b(be,be.l-8));var Bt=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Bt!==0&&(Ae.mt=b(be,be.l-8)),Ae.start=be.read_shift(4,"i"),Ae.size=be.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=ie,Ae.name=""),Ae.type===5?(le=Ae.start,G>0&&le!==ie&&(z[le].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",z[Ae.start]===void 0&&(z[Ae.start]=w(F,Ae.start,z.fat_addrs,z.ssz)),z[Ae.start].name=Ae.name,Ae.content=z[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:le!==ie&&Ae.start!==ie&&z[le]&&(Ae.content=m(Ae,z[le].data,(z[we]||{}).data))),Ae.content&&ai(Ae.content,0),K[ke]=Ae,ue.push(Ae)}}function b(I,z){return new Date((Xn(I,z+4)/1e7*Math.pow(2,32)+Xn(I,z)/1e7-11644473600)*1e3)}function T(I,z){return u(),c(l.readFileSync(I),z)}function E(I,z){var F=z&&z.type;switch(F||xt&&Buffer.isBuffer(I)&&(F="buffer"),F||"base64"){case"file":return T(I,z);case"base64":return c(Xs(oo(I)),z);case"binary":return c(Xs(I),z)}return c(I,z)}function x(I,z){var F=z||{},H=F.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=H+"/",I.FileIndex[0]={name:H,type:5}),F.CLSID&&(I.FileIndex[0].clsid=F.CLSID),P(I)}function P(I){var z="Sh33tJ5";if(!Xe.find(I,"/"+z)){var F=ve(4);F[0]=55,F[1]=F[3]=50,F[2]=54,I.FileIndex.push({name:z,type:2,content:F,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+z),A(I)}}function A(I,z){x(I);for(var F=!1,H=!1,G=I.FullPaths.length-1;G>=0;--G){var K=I.FileIndex[G];switch(K.type){case 0:H?F=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(K.R*K.L*K.C)&&(F=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!z)){var ue=new Date(1987,1,19),we=0,le=Object.create?Object.create(null):{},ne=[];for(G=0;G<I.FullPaths.length;++G)le[I.FullPaths[G]]=!0,I.FileIndex[G].type!==0&&ne.push([I.FullPaths[G],I.FileIndex[G]]);for(G=0;G<ne.length;++G){var N=n(ne[G][0]);H=le[N],H||(ne.push([N,{name:i(N).replace("/",""),type:1,clsid:Ee,ct:ue,mt:ue,content:null}]),le[N]=!0)}for(ne.sort(function(ke,be){return r(ke[0],be[0])}),I.FullPaths=[],I.FileIndex=[],G=0;G<ne.length;++G)I.FullPaths[G]=ne[G][0],I.FileIndex[G]=ne[G][1];for(G=0;G<ne.length;++G){var se=I.FileIndex[G],de=I.FullPaths[G];if(se.name=i(de).replace("/",""),se.L=se.R=se.C=-(se.color=1),se.size=se.content?se.content.length:0,se.start=0,se.clsid=se.clsid||Ee,G===0)se.C=ne.length>1?1:-1,se.size=0,se.type=5;else if(de.slice(-1)=="/"){for(we=G+1;we<ne.length&&n(I.FullPaths[we])!=de;++we);for(se.C=we>=ne.length?-1:we,we=G+1;we<ne.length&&n(I.FullPaths[we])!=n(de);++we);se.R=we>=ne.length?-1:we,se.type=1}else n(I.FullPaths[G+1]||"")==n(de)&&(se.R=G+1),se.type=2}}}function O(I,z){var F=z||{};if(F.fileType=="mad")return D1(I,F);switch(A(I),F.fileType){case"zip":return zh(I,F)}var H=function(ke){for(var be=0,Ae=0,Ye=0;Ye<ke.FileIndex.length;++Ye){var Bt=ke.FileIndex[Ye];if(Bt.content){var tr=Bt.content.length;tr>0&&(tr<4096?be+=tr+63>>6:Ae+=tr+511>>9)}}for(var Sn=ke.FullPaths.length+3>>2,Jr=be+7>>3,fc=be+127>>7,dc=Jr+Ae+Sn+fc,Gh=dc+127>>7,uT=Gh<=109?0:Math.ceil((Gh-109)/127);dc+Gh+uT+127>>7>Gh;)uT=++Gh<=109?0:Math.ceil((Gh-109)/127);var Yl=[1,uT,Gh,fc,Sn,Ae,be,0];return ke.FileIndex[0].size=be<<6,Yl[7]=(ke.FileIndex[0].start=Yl[0]+Yl[1]+Yl[2]+Yl[3]+Yl[4]+Yl[5])+(Yl[6]+7>>3),Yl}(I),G=ve(H[7]<<9),K=0,ue=0;{for(K=0;K<8;++K)G.write_shift(1,he[K]);for(K=0;K<8;++K)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),K=0;K<3;++K)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,H[2]),G.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:ie),G.write_shift(4,H[3]),G.write_shift(-4,H[1]?H[0]-1:ie),G.write_shift(4,H[1]),K=0;K<109;++K)G.write_shift(-4,K<H[2]?H[1]+K:-1)}if(H[1])for(ue=0;ue<H[1];++ue){for(;K<236+ue*127;++K)G.write_shift(-4,K<H[2]?H[1]+K:-1);G.write_shift(-4,ue===H[1]-1?ie:ue+1)}var we=function(ke){for(ue+=ke;K<ue-1;++K)G.write_shift(-4,K+1);ke&&(++K,G.write_shift(-4,ie))};for(ue=K=0,ue+=H[1];K<ue;++K)G.write_shift(-4,Ce.DIFSECT);for(ue+=H[2];K<ue;++K)G.write_shift(-4,Ce.FATSECT);we(H[3]),we(H[4]);for(var le=0,ne=0,N=I.FileIndex[0];le<I.FileIndex.length;++le)N=I.FileIndex[le],N.content&&(ne=N.content.length,!(ne<4096)&&(N.start=ue,we(ne+511>>9)));for(we(H[6]+7>>3);G.l&511;)G.write_shift(-4,Ce.ENDOFCHAIN);for(ue=K=0,le=0;le<I.FileIndex.length;++le)N=I.FileIndex[le],N.content&&(ne=N.content.length,!(!ne||ne>=4096)&&(N.start=ue,we(ne+63>>6)));for(;G.l&511;)G.write_shift(-4,Ce.ENDOFCHAIN);for(K=0;K<H[4]<<2;++K){var se=I.FullPaths[K];if(!se||se.length===0){for(le=0;le<17;++le)G.write_shift(4,0);for(le=0;le<3;++le)G.write_shift(4,-1);for(le=0;le<12;++le)G.write_shift(4,0);continue}N=I.FileIndex[K],K===0&&(N.start=N.size?N.start-1:ie);var de=K===0&&F.root||N.name;if(ne=2*(de.length+1),G.write_shift(64,de,"utf16le"),G.write_shift(2,ne),G.write_shift(1,N.type),G.write_shift(1,N.color),G.write_shift(-4,N.L),G.write_shift(-4,N.R),G.write_shift(-4,N.C),N.clsid)G.write_shift(16,N.clsid,"hex");else for(le=0;le<4;++le)G.write_shift(4,0);G.write_shift(4,N.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,N.start),G.write_shift(4,N.size),G.write_shift(4,0)}for(K=1;K<I.FileIndex.length;++K)if(N=I.FileIndex[K],N.size>=4096)if(G.l=N.start+1<<9,xt&&Buffer.isBuffer(N.content))N.content.copy(G,G.l,0,N.size),G.l+=N.size+511&-512;else{for(le=0;le<N.size;++le)G.write_shift(1,N.content[le]);for(;le&511;++le)G.write_shift(1,0)}for(K=1;K<I.FileIndex.length;++K)if(N=I.FileIndex[K],N.size>0&&N.size<4096)if(xt&&Buffer.isBuffer(N.content))N.content.copy(G,G.l,0,N.size),G.l+=N.size+63&-64;else{for(le=0;le<N.size;++le)G.write_shift(1,N.content[le]);for(;le&63;++le)G.write_shift(1,0)}if(xt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function Y(I,z){var F=I.FullPaths.map(function(le){return le.toUpperCase()}),H=F.map(function(le){var ne=le.split("/");return ne[ne.length-(le.slice(-1)=="/"?2:1)]}),G=!1;z.charCodeAt(0)===47?(G=!0,z=F[0].slice(0,-1)+z):G=z.indexOf("/")!==-1;var K=z.toUpperCase(),ue=G===!0?F.indexOf(K):H.indexOf(K);if(ue!==-1)return I.FileIndex[ue];var we=!K.match(bv);for(K=K.replace(Ai,""),we&&(K=K.replace(bv,"!")),ue=0;ue<F.length;++ue)if((we?F[ue].replace(bv,"!"):F[ue]).replace(Ai,"")==K||(we?H[ue].replace(bv,"!"):H[ue]).replace(Ai,"")==K)return I.FileIndex[ue];return null}var L=64,ie=-2,ce="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(I,z,F){u();var H=O(I,F);l.writeFileSync(z,H)}function Q(I){for(var z=new Array(I.length),F=0;F<I.length;++F)z[F]=String.fromCharCode(I[F]);return z.join("")}function ye(I,z){var F=O(I,z);switch(z&&z.type||"buffer"){case"file":return u(),l.writeFileSync(z.filename,F),F;case"binary":return typeof F=="string"?F:Q(F);case"base64":return qw(typeof F=="string"?F:Q(F));case"buffer":if(xt)return Buffer.isBuffer(F)?F:tc(F);case"array":return typeof F=="string"?Xs(F):F}return F}var Re;function W(I){try{var z=I.InflateRaw,F=new z;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)Re=I;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function C(I,z){if(!Re)return Fi(I,z);var F=Re.InflateRaw,H=new F,G=H._processChunk(I.slice(I.l),H._finishFlushFlag);return I.l+=H.bytesRead,G}function S(I){return Re?Re.deflateRawSync(I):Qe(I)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function X(I){var z=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(z>>16|z>>8|z)&255}for(var ee=typeof Uint8Array<"u",k=ee?new Uint8Array(256):[],M=0;M<256;++M)k[M]=X(M);function R(I,z){var F=k[I&255];return z<=8?F>>>8-z:(F=F<<8|k[I>>8&255],z<=16?F>>>16-z:(F=F<<8|k[I>>16&255],F>>>24-z))}function V(I,z){var F=z&7,H=z>>>3;return(I[H]|(F<=6?0:I[H+1]<<8))>>>F&3}function q(I,z){var F=z&7,H=z>>>3;return(I[H]|(F<=5?0:I[H+1]<<8))>>>F&7}function J(I,z){var F=z&7,H=z>>>3;return(I[H]|(F<=4?0:I[H+1]<<8))>>>F&15}function re(I,z){var F=z&7,H=z>>>3;return(I[H]|(F<=3?0:I[H+1]<<8))>>>F&31}function B(I,z){var F=z&7,H=z>>>3;return(I[H]|(F<=1?0:I[H+1]<<8))>>>F&127}function te(I,z,F){var H=z&7,G=z>>>3,K=(1<<F)-1,ue=I[G]>>>H;return F<8-H||(ue|=I[G+1]<<8-H,F<16-H)||(ue|=I[G+2]<<16-H,F<24-H)||(ue|=I[G+3]<<24-H),ue&K}function oe(I,z,F){var H=z&7,G=z>>>3;return H<=5?I[G]|=(F&7)<<H:(I[G]|=F<<H&255,I[G+1]=(F&7)>>8-H),z+3}function ae(I,z,F){var H=z&7,G=z>>>3;return F=(F&1)<<H,I[G]|=F,z+1}function fe(I,z,F){var H=z&7,G=z>>>3;return F<<=H,I[G]|=F&255,F>>>=8,I[G+1]=F,z+8}function Me(I,z,F){var H=z&7,G=z>>>3;return F<<=H,I[G]|=F&255,F>>>=8,I[G+1]=F&255,I[G+2]=F>>>8,z+16}function Ne(I,z){var F=I.length,H=2*F>z?2*F:z+5,G=0;if(F>=z)return I;if(xt){var K=$3(H);if(I.copy)I.copy(K);else for(;G<I.length;++G)K[G]=I[G];return K}else if(ee){var ue=new Uint8Array(H);if(ue.set)ue.set(I);else for(;G<F;++G)ue[G]=I[G];return ue}return I.length=H,I}function ze(I){for(var z=new Array(I),F=0;F<I;++F)z[F]=0;return z}function st(I,z,F){var H=1,G=0,K=0,ue=0,we=0,le=I.length,ne=ee?new Uint16Array(32):ze(32);for(K=0;K<32;++K)ne[K]=0;for(K=le;K<F;++K)I[K]=0;le=I.length;var N=ee?new Uint16Array(le):ze(le);for(K=0;K<le;++K)ne[G=I[K]]++,H<G&&(H=G),N[K]=0;for(ne[0]=0,K=1;K<=H;++K)ne[K+16]=we=we+ne[K-1]<<1;for(K=0;K<le;++K)we=I[K],we!=0&&(N[K]=ne[we+16]++);var se=0;for(K=0;K<le;++K)if(se=I[K],se!=0)for(we=R(N[K],H)>>H-se,ue=(1<<H+4-se)-1;ue>=0;--ue)z[we|ue<<se]=se&15|K<<4;return H}var ot=ee?new Uint16Array(512):ze(512),tt=ee?new Uint16Array(32):ze(32);if(!ee){for(var We=0;We<512;++We)ot[We]=0;for(We=0;We<32;++We)tt[We]=0}(function(){for(var I=[],z=0;z<32;z++)I.push(5);st(I,tt,32);var F=[];for(z=0;z<=143;z++)F.push(8);for(;z<=255;z++)F.push(9);for(;z<=279;z++)F.push(7);for(;z<=287;z++)F.push(8);st(F,ot,288)})();var ht=function(){for(var z=ee?new Uint8Array(32768):[],F=0,H=0;F<U.length-1;++F)for(;H<U[F+1];++H)z[H]=F;for(;H<32768;++H)z[H]=29;var G=ee?new Uint8Array(259):[];for(F=0,H=0;F<D.length-1;++F)for(;H<D[F+1];++H)G[H]=F;function K(we,le){for(var ne=0;ne<we.length;){var N=Math.min(65535,we.length-ne),se=ne+N==we.length;for(le.write_shift(1,+se),le.write_shift(2,N),le.write_shift(2,~N&65535);N-- >0;)le[le.l++]=we[ne++]}return le.l}function ue(we,le){for(var ne=0,N=0,se=ee?new Uint16Array(32768):[];N<we.length;){var de=Math.min(65535,we.length-N);if(de<10){for(ne=oe(le,ne,+(N+de==we.length)),ne&7&&(ne+=8-(ne&7)),le.l=ne/8|0,le.write_shift(2,de),le.write_shift(2,~de&65535);de-- >0;)le[le.l++]=we[N++];ne=le.l*8;continue}ne=oe(le,ne,+(N+de==we.length)+2);for(var ke=0;de-- >0;){var be=we[N];ke=(ke<<5^be)&32767;var Ae=-1,Ye=0;if((Ae=se[ke])&&(Ae|=N&-32768,Ae>N&&(Ae-=32768),Ae<N))for(;we[Ae+Ye]==we[N+Ye]&&Ye<250;)++Ye;if(Ye>2){be=G[Ye],be<=22?ne=fe(le,ne,k[be+1]>>1)-1:(fe(le,ne,3),ne+=5,fe(le,ne,k[be-23]>>5),ne+=3);var Bt=be<8?0:be-4>>2;Bt>0&&(Me(le,ne,Ye-D[be]),ne+=Bt),be=z[N-Ae],ne=fe(le,ne,k[be]>>3),ne-=3;var tr=be<4?0:be-2>>1;tr>0&&(Me(le,ne,N-Ae-U[be]),ne+=tr);for(var Sn=0;Sn<Ye;++Sn)se[ke]=N&32767,ke=(ke<<5^we[N])&32767,++N;de-=Ye-1}else be<=143?be=be+48:ne=ae(le,ne,1),ne=fe(le,ne,k[be]),se[ke]=N&32767,++N}ne=fe(le,ne,0)-1}return le.l=(ne+7)/8|0,le.l}return function(le,ne){return le.length<8?K(le,ne):ue(le,ne)}}();function Qe(I){var z=ve(50+Math.floor(I.length*1.1)),F=ht(I,z);return z.slice(0,F)}var Xt=ee?new Uint16Array(32768):ze(32768),Or=ee?new Uint16Array(32768):ze(32768),St=ee?new Uint16Array(128):ze(128),$t=1,dr=1;function cr(I,z){var F=re(I,z)+257;z+=5;var H=re(I,z)+1;z+=5;var G=J(I,z)+4;z+=4;for(var K=0,ue=ee?new Uint8Array(19):ze(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ne=ee?new Uint8Array(8):ze(8),N=ee?new Uint8Array(8):ze(8),se=ue.length,de=0;de<G;++de)ue[_[de]]=K=q(I,z),le<K&&(le=K),ne[K]++,z+=3;var ke=0;for(ne[0]=0,de=1;de<=le;++de)N[de]=ke=ke+ne[de-1]<<1;for(de=0;de<se;++de)(ke=ue[de])!=0&&(we[de]=N[ke]++);var be=0;for(de=0;de<se;++de)if(be=ue[de],be!=0){ke=k[we[de]]>>8-be;for(var Ae=(1<<7-be)-1;Ae>=0;--Ae)St[ke|Ae<<be]=be&7|de<<3}var Ye=[];for(le=1;Ye.length<F+H;)switch(ke=St[B(I,z)],z+=ke&7,ke>>>=3){case 16:for(K=3+V(I,z),z+=2,ke=Ye[Ye.length-1];K-- >0;)Ye.push(ke);break;case 17:for(K=3+q(I,z),z+=3;K-- >0;)Ye.push(0);break;case 18:for(K=11+B(I,z),z+=7;K-- >0;)Ye.push(0);break;default:Ye.push(ke),le<ke&&(le=ke);break}var Bt=Ye.slice(0,F),tr=Ye.slice(F);for(de=F;de<286;++de)Bt[de]=0;for(de=H;de<30;++de)tr[de]=0;return $t=st(Bt,Xt,286),dr=st(tr,Or,30),z}function Mt(I,z){if(I[0]==3&&!(I[1]&3))return[Th(z),2];for(var F=0,H=0,G=$3(z||1<<18),K=0,ue=G.length>>>0,we=0,le=0;!(H&1);){if(H=q(I,F),F+=3,H>>>1)H>>1==1?(we=9,le=5):(F=cr(I,F),we=$t,le=dr);else{F&7&&(F+=8-(F&7));var ne=I[F>>>3]|I[(F>>>3)+1]<<8;if(F+=32,ne>0)for(!z&&ue<K+ne&&(G=Ne(G,K+ne),ue=G.length);ne-- >0;)G[K++]=I[F>>>3],F+=8;continue}for(;;){!z&&ue<K+32767&&(G=Ne(G,K+32767),ue=G.length);var N=te(I,F,we),se=H>>>1==1?ot[N]:Xt[N];if(F+=se&15,se>>>=4,!(se>>>8&255))G[K++]=se;else{if(se==256)break;se-=257;var de=se<8?0:se-4>>2;de>5&&(de=0);var ke=K+D[se];de>0&&(ke+=te(I,F,de),F+=de),N=te(I,F,le),se=H>>>1==1?tt[N]:Or[N],F+=se&15,se>>>=4;var be=se<4?0:se-2>>1,Ae=U[se];for(be>0&&(Ae+=te(I,F,be),F+=be),!z&&ue<ke&&(G=Ne(G,ke+100),ue=G.length);K<ke;)G[K]=G[K-Ae],++K}}}return z?[G,F+7>>>3]:[G.slice(0,K),F+7>>>3]}function Fi(I,z){var F=I.slice(I.l||0),H=Mt(F,z);return I.l+=H[1],H[0]}function Un(I,z){if(I)typeof console<"u"&&console.error(z);else throw new Error(z)}function Ua(I,z){var F=I;ai(F,0);var H=[],G=[],K={FileIndex:H,FullPaths:G};x(K,{root:z.root});for(var ue=F.length-4;(F[ue]!=80||F[ue+1]!=75||F[ue+2]!=5||F[ue+3]!=6)&&ue>=0;)--ue;F.l=ue+4,F.l+=4;var we=F.read_shift(2);F.l+=6;var le=F.read_shift(4);for(F.l=le,ue=0;ue<we;++ue){F.l+=20;var ne=F.read_shift(4),N=F.read_shift(4),se=F.read_shift(2),de=F.read_shift(2),ke=F.read_shift(2);F.l+=8;var be=F.read_shift(4),Ae=a(F.slice(F.l+se,F.l+se+de));F.l+=se+de+ke;var Ye=F.l;F.l=be+4,og(F,ne,N,K,Ae),F.l=Ye}return K}function og(I,z,F,H,G){I.l+=2;var K=I.read_shift(2),ue=I.read_shift(2),we=o(I);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var le=I.read_shift(4),ne=I.read_shift(4),N=I.read_shift(4),se=I.read_shift(2),de=I.read_shift(2),ke="",be=0;be<se;++be)ke+=String.fromCharCode(I[I.l++]);if(de){var Ae=a(I.slice(I.l,I.l+de));(Ae[21589]||{}).mt&&(we=Ae[21589].mt),((G||{})[21589]||{}).mt&&(we=G[21589].mt)}I.l+=de;var Ye=I.slice(I.l,I.l+ne);switch(ue){case 8:Ye=C(I,N);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Bt=!1;K&8&&(le=I.read_shift(4),le==134695760&&(le=I.read_shift(4),Bt=!0),ne=I.read_shift(4),N=I.read_shift(4)),ne!=z&&Un(Bt,"Bad compressed size: "+z+" != "+ne),N!=F&&Un(Bt,"Bad uncompressed size: "+F+" != "+N),e0(H,ke,Ye,{unsafe:!0,mt:we})}function zh(I,z){var F=z||{},H=[],G=[],K=ve(1),ue=F.compression?8:0,we=0,le=0,ne=0,N=0,se=0,de=I.FullPaths[0],ke=de,be=I.FileIndex[0],Ae=[],Ye=0;for(le=1;le<I.FullPaths.length;++le)if(ke=I.FullPaths[le].slice(de.length),be=I.FileIndex[le],!(!be.size||!be.content||ke=="Sh33tJ5")){var Bt=N,tr=ve(ke.length);for(ne=0;ne<ke.length;++ne)tr.write_shift(1,ke.charCodeAt(ne)&127);tr=tr.slice(0,tr.l),Ae[se]=ahe.buf(be.content,0);var Sn=be.content;ue==8&&(Sn=S(Sn)),K=ve(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,we),K.write_shift(2,ue),be.mt?s(K,be.mt):K.write_shift(4,0),K.write_shift(-4,Ae[se]),K.write_shift(4,Sn.length),K.write_shift(4,be.content.length),K.write_shift(2,tr.length),K.write_shift(2,0),N+=K.length,H.push(K),N+=tr.length,H.push(tr),N+=Sn.length,H.push(Sn),K=ve(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,we),K.write_shift(2,ue),K.write_shift(4,0),K.write_shift(-4,Ae[se]),K.write_shift(4,Sn.length),K.write_shift(4,be.content.length),K.write_shift(2,tr.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,Bt),Ye+=K.l,G.push(K),Ye+=tr.length,G.push(tr),++se}return K=ve(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,se),K.write_shift(2,se),K.write_shift(4,Ye),K.write_shift(4,N),K.write_shift(2,0),Jn([Jn(H),Jn(G),K])}var ag={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function aT(I,z){if(I.ctype)return I.ctype;var F=I.name||"",H=F.match(/\.([^\.]+)$/);return H&&ag[H[1]]||z&&(H=(F=z).match(/[\.\\]([^\.\\])+$/),H&&ag[H[1]])?ag[H[1]]:"application/octet-stream"}function Cn(I){for(var z=qw(I),F=[],H=0;H<z.length;H+=76)F.push(z.slice(H,H+76));return F.join(`\r
`)+`\r
`}function cc(I){var z=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var N=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(N.length==1?"0"+N:N)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],H=z.split(`\r
`),G=0;G<H.length;++G){var K=H[G];if(K.length==0){F.push("");continue}for(var ue=0;ue<K.length;){var we=76,le=K.slice(ue,ue+we);le.charAt(we-1)=="="?we--:le.charAt(we-2)=="="?we-=2:le.charAt(we-3)=="="&&(we-=3),le=K.slice(ue,ue+we),ue+=we,ue<K.length&&(le+="="),F.push(le)}}return F.join(`\r
`)}function lT(I){for(var z=[],F=0;F<I.length;++F){for(var H=I[F];F<=I.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+I[++F];z.push(H)}for(var G=0;G<z.length;++G)z[G]=z[G].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return Xs(z.join(`\r
`))}function N1(I,z,F){for(var H="",G="",K="",ue,we=0;we<10;++we){var le=z[we];if(!le||le.match(/^\s*$/))break;var ne=le.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":H=ne[2].trim();break;case"content-type":K=ne[2].trim();break;case"content-transfer-encoding":G=ne[2].trim();break}}switch(++we,G.toLowerCase()){case"base64":ue=Xs(oo(z.slice(we).join("")));break;case"quoted-printable":ue=lT(z.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var N=e0(I,H.slice(F.length),ue,{unsafe:!0});K&&(N.ctype=K)}function Zp(I,z){if(Q(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=z&&z.root||"",H=(xt&&Buffer.isBuffer(I)?I.toString("binary"):Q(I)).split(`\r
`),G=0,K="";for(G=0;G<H.length;++G)if(K=H[G],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),F||(F=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),K.slice(0,F.length)!=F););var ue=(H[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var we="--"+(ue[1]||""),le=[],ne=[],N={FileIndex:le,FullPaths:ne};x(N);var se,de=0;for(G=0;G<H.length;++G){var ke=H[G];ke!==we&&ke!==we+"--"||(de++&&N1(N,H.slice(se,G),F),se=G)}return N}function D1(I,z){var F=z||{},H=F.boundary||"SheetJS";H="------="+H;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],K=I.FullPaths[0],ue=K,we=I.FileIndex[0],le=1;le<I.FullPaths.length;++le)if(ue=I.FullPaths[le].slice(K.length),we=I.FileIndex[le],!(!we.size||!we.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var ne=we.content,N=xt&&Buffer.isBuffer(ne)?ne.toString("binary"):Q(ne),se=0,de=Math.min(1024,N.length),ke=0,be=0;be<=de;++be)(ke=N.charCodeAt(be))>=32&&ke<128&&++se;var Ae=se>=de*4/5;G.push(H),G.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+ue),G.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),G.push("Content-Type: "+aT(we,ue)),G.push(""),G.push(Ae?cc(N):Cn(N))}return G.push(H+`--\r
`),G.join(`\r
`)}function F1(I){var z={};return x(z,I),z}function e0(I,z,F,H){var G=H&&H.unsafe;G||x(I);var K=!G&&Xe.find(I,z);if(!K){var ue=I.FullPaths[0];z.slice(0,ue.length)==ue?ue=z:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+z).replace("//","/")),K={name:i(z),type:2},I.FileIndex.push(K),I.FullPaths.push(ue),G||Xe.utils.cfb_gc(I)}return K.content=F,K.size=F?F.length:0,H&&(H.CLSID&&(K.clsid=H.CLSID),H.mt&&(K.mt=H.mt),H.ct&&(K.ct=H.ct)),K}function ho(I,z){x(I);var F=Xe.find(I,z);if(F){for(var H=0;H<I.FileIndex.length;++H)if(I.FileIndex[H]==F)return I.FileIndex.splice(H,1),I.FullPaths.splice(H,1),!0}return!1}function hc(I,z,F){x(I);var H=Xe.find(I,z);if(H){for(var G=0;G<I.FileIndex.length;++G)if(I.FileIndex[G]==H)return I.FileIndex[G].name=i(F),I.FullPaths[G]=F,!0}return!1}function H1(I){A(I,!0)}return e.find=Y,e.read=E,e.parse=c,e.write=ye,e.writeFile=ge,e.utils={cfb_new:F1,cfb_add:e0,cfb_del:ho,cfb_mov:hc,cfb_gc:H1,ReadShift:Uv,CheckField:eG,prep_blob:ai,bconcat:Jn,use_zlib:W,_deflateRaw:Qe,_inflateRaw:Fi,consts:Ce},e}();let eh;function lhe(t){eh=t}function uhe(t){return typeof t=="string"?Xy(t):Array.isArray(t)?Nce(t):t}function Jy(t,e,r){if(typeof eh<"u"&&eh.writeFileSync)return r?eh.writeFileSync(t,e,r):eh.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Xy(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Pl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([uhe(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=Hh(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function che(t){if(typeof eh<"u")return eh.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ln(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Y3(t,e){for(var r=[],n=ln(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function QE(t){for(var e=[],r=ln(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function ZE(t){for(var e=[],r=ln(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function hhe(t){for(var e=[],r=ln(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Xb=new Date(1899,11,30,0,0,0);function jn(t,e){var r=t.getTime(),n=Xb.getTime()+(t.getTimezoneOffset()-Xb.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var H9=new Date,fhe=Xb.getTime()+(H9.getTimezoneOffset()-Xb.getTimezoneOffset())*6e4,K3=H9.getTimezoneOffset();function eR(t){var e=new Date;return e.setTime(t*24*60*60*1e3+fhe),e.getTimezoneOffset()!==K3&&e.setTime(e.getTime()+(e.getTimezoneOffset()-K3)*6e4),e}function dhe(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var X3=new Date("2017-02-19T19:06:09.000Z"),L9=isNaN(X3.getFullYear())?new Date("2/19/17"):X3,ghe=L9.getFullYear()==2017;function Pr(t,e){var r=new Date(t);if(ghe)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(L9.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function _d(t,e){if(xt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Pl(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Pl(_9(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Pl(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Pl(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function vr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vr(t[r]));return e}function nn(t,e){for(var r="";r.length<e;)r+=t;return r}function Ia(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var mhe=["january","february","march","april","may","june","july","august","september","october","november","december"];function fp(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&mhe.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var phe=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}}();function $9(t){return t?t.content&&t.type?_d(t.content,!0):t.data?Rm(t.data):t.asNodeBuffer&&xt?Rm(t.asNodeBuffer().toString("binary")):t.asBinary?Rm(t.asBinary()):t._data&&t._data.getContent?Rm(_d(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function B9(t){if(!t)return null;if(t.data)return zb(t.data);if(t.asNodeBuffer&&xt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?zb(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function vhe(t){return t&&t.name.slice(-4)===".bin"?B9(t):$9(t)}function _o(t,e){for(var r=t.FullPaths||ln(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function jN(t,e){var r=_o(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function En(t,e,r){if(!r)return vhe(jN(t,e));if(!e)return null;try{return En(t,e)}catch{return null}}function qs(t,e,r){if(!r)return $9(jN(t,e));if(!e)return null;try{return qs(t,e)}catch{return null}}function whe(t,e,r){return B9(jN(t,e))}function q3(t){for(var e=t.FullPaths||ln(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function gt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return xt?n=tc(r):n=Dce(r),Xe.utils.cfb_add(t,e,n)}Xe.utils.cfb_add(t,e,r)}else t.file(e,r)}function UN(){return Xe.utils.cfb_new()}function V9(t,e){switch(e.type){case"base64":return Xe.read(t,{type:"base64"});case"binary":return Xe.read(t,{type:"binary"});case"buffer":case"array":return Xe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function _v(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yhe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,J3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Che=/<[^>]*>/g,Di=pn.match(J3)?J3:Che,She=/<\w*:/,xhe=/<(\/?)\w+:/;function it(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(yhe),a=0,l="",u=0,c="",h="",f=1;if(o)for(u=0;u!=o.length;++u){for(h=o[u],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(c=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(f=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+f,h.length-f),a=0;a!=c.length&&c.charCodeAt(a)!==58;++a);if(a===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),n[c]=l,n[c.toLowerCase()]=l;else{var d=(a===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(a+1);if(n[d]&&c.slice(a-3,a)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function $l(t){return t.replace(xhe,"<$1")}var W9={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zN=QE(W9),jt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(a,l){return W9[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(e,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),GN=/[&<>'"]/g,bhe=/[\u0000-\u0008\u000b-\u001f]/g;function ar(t){var e=t+"";return e.replace(GN,function(r){return zN[r]}).replace(bhe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Q3(t){return ar(t).replace(/ /g,"_x0020_")}var j9=/[\u0000-\u001f]/g;function YN(t){var e=t+"";return e.replace(GN,function(r){return zN[r]}).replace(/\n/g,"<br/>").replace(j9,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function _he(t){var e=t+"";return e.replace(GN,function(r){return zN[r]}).replace(j9,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Z3=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Ehe(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Rr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function tk(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function eB(t){var e=Th(2*t.length),r,n,i=1,s=0,o=0,a;for(n=0;n<t.length;n+=i)i=1,(a=t.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(t.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function tB(t){return tc(t,"binary").toString("utf8")}var lC="foo bar bazâð£",hr=xt&&(tB(lC)==tk(lC)&&tB||eB(lC)==tk(lC)&&eB)||tk,Pl=xt?function(t){return tc(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Qw=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),U9=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Rhe=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),The=/<\/?(?:vt:)?variant>/g,khe=/<(?:vt:)([^>]*)>([\s\S]*)</;function rB(t,e){var r=it(t),n=t.match(Rhe(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(The,"").match(khe);o&&i.push({v:hr(o[2]),t:o[1]})}),i}var z9=/(^\s|\s$|\n)/;function li(t,e){return"<"+t+(e.match(z9)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Zw(t){return ln(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ie(t,e,r){return"<"+t+(r!=null?Zw(r):"")+(e!=null?(e.match(z9)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function jO(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Phe(t,e){switch(typeof t){case"string":var r=Ie("vt:lpwstr",ar(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ie((t|0)==t?"vt:i4":"vt:r8",ar(String(t)));case"boolean":return Ie("vt:bool",t?"true":"false")}if(t instanceof Date)return Ie("vt:filetime",jO(t));throw new Error("Unable to serialize "+t)}function KN(t){if(xt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return hr(Hh(BN(t)));throw new Error("Bad input format: expected Buffer or string")}var ey=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Bn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ud=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ks={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Ahe(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Ihe(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[r+a]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var nB=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},iB=xt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:tc(e)})):nB(t)}:nB,sB=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(_u(t,i)));return n.join("").replace(Ai,"")},tR=xt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ai,""):sB(t,e,r)}:sB,oB=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},G9=xt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):oB(t,e,r)}:oB,aB=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(em(t,i)));return n.join("")},Np=xt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):aB(e,r,n)}:aB,Y9=function(t,e){var r=Xn(t,e);return r>0?Np(t,e+4,e+4+r-1):""},XN=Y9,K9=function(t,e){var r=Xn(t,e);return r>0?Np(t,e+4,e+4+r-1):""},qN=K9,X9=function(t,e){var r=2*Xn(t,e);return r>0?Np(t,e+4,e+4+r-1):""},JN=X9,q9=function(e,r){var n=Xn(e,r);return n>0?tR(e,r+4,r+4+n):""},QN=q9,J9=function(t,e){var r=Xn(t,e);return r>0?Np(t,e+4,e+4+r):""},ZN=J9,Q9=function(t,e){return Ahe(t,e)},qb=Q9,eD=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};xt&&(XN=function(e,r){if(!Buffer.isBuffer(e))return Y9(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},qN=function(e,r){if(!Buffer.isBuffer(e))return K9(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},JN=function(e,r){if(!Buffer.isBuffer(e))return X9(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},QN=function(e,r){if(!Buffer.isBuffer(e))return q9(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},ZN=function(e,r){if(!Buffer.isBuffer(e))return J9(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},qb=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Q9(e,r)},eD=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function Z9(){tR=function(t,e,r){return Ht.utils.decode(1200,t.slice(e,r)).replace(Ai,"")},Np=function(t,e,r){return Ht.utils.decode(65001,t.slice(e,r))},XN=function(t,e){var r=Xn(t,e);return r>0?Ht.utils.decode(xd,t.slice(e+4,e+4+r-1)):""},qN=function(t,e){var r=Xn(t,e);return r>0?Ht.utils.decode(to,t.slice(e+4,e+4+r-1)):""},JN=function(t,e){var r=2*Xn(t,e);return r>0?Ht.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},QN=function(t,e){var r=Xn(t,e);return r>0?Ht.utils.decode(1200,t.slice(e+4,e+4+r)):""},ZN=function(t,e){var r=Xn(t,e);return r>0?Ht.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof Ht<"u"&&Z9();var em=function(t,e){return t[e]},_u=function(t,e){return t[e+1]*256+t[e]},Ohe=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Xn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Vf=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Mhe=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Uv(t,e){var r="",n,i,s=[],o,a,l,u;switch(e){case"dbcs":if(u=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(_u(this,u)),u+=2;t*=2;break;case"utf8":r=Np(this,this.l,this.l+t);break;case"utf16le":t*=2,r=tR(this,this.l,this.l+t);break;case"wstr":if(typeof Ht<"u")r=Ht.utils.decode(to,this.slice(this.l,this.l+2*t));else return Uv.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=XN(this,this.l),t=4+Xn(this,this.l);break;case"lpstr-cp":r=qN(this,this.l),t=4+Xn(this,this.l);break;case"lpwstr":r=JN(this,this.l),t=4+2*Xn(this,this.l);break;case"lpp4":t=4+Xn(this,this.l),r=QN(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Xn(this,this.l),r=ZN(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=em(this,this.l+t++))!==0;)s.push(xv(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=_u(this,this.l+t))!==0;)s.push(xv(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=em(this,u),this.l=u+1,a=Uv.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(xv(_u(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":if(typeof Ht<"u"){r=Ht.utils.decode(to,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=em(this,u),this.l=u+1,a=Uv.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(xv(em(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=em(this,this.l),this.l++,n;case 2:return n=(e==="i"?Ohe:_u)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Vf:Mhe)(this,this.l),this.l+=4,n):(i=Xn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=qb(this,this.l):i=qb([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=G9(this,this.l,t);break}}return this.l+=t,r}var Nhe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Dhe=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Fhe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Hhe(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)Fhe(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof Ht<"u"&&xd==874)for(i=0;i!=e.length;++i){var s=Ht.utils.encode(xd,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Nhe(this,e,this.l);break;case 8:if(n=8,r==="f"){Ihe(this,e,this.l);break}case 16:break;case-4:n=4,Dhe(this,e,this.l);break}return this.l+=n,this}function eG(t,e){var r=G9(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ai(t,e){t.l=e,t.read_shift=Uv,t.chk=eG,t.write_shift=Hhe}function Ni(t,e){t.l+=e}function ve(t){var e=Th(t);return ai(e,0),e}function rc(t,e,r){if(t){var n,i,s;ai(t,t.l||0);for(var o=t.length,a=0,l=0;t.l<o;){a=t.read_shift(1),a&128&&(a=(a&127)+((t.read_shift(1)&127)<<7));var u=oy[a]||oy[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var c=u.f&&u.f(t,s,r);if(t.l=l,e(c,u,a))return}}}function As(){var t=[],e=xt?256:2048,r=function(u){var c=ve(u);return ai(c,0),c},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},o=function(){return i(),Jn(t)},a=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function xe(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=oy[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&eD(r)&&t.push(r)}}function zv(t,e,r){var n=vr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function lB(t,e,r){var n=vr(t);return n.s=zv(n.s,e.s,r),n.e=zv(n.e,e.s,r),n}function Gv(t,e){if(t.cRel&&t.c<0)for(t=vr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=nt(t);return!t.cRel&&t.cRel!=null&&(r=Bhe(r)),!t.rRel&&t.rRel!=null&&(r=Lhe(r)),r}function rk(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+kr(t.s.c)+":"+(t.e.cRel?"":"$")+kr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+sn(t.s.r)+":"+(t.e.rRel?"":"$")+sn(t.e.r):Gv(t.s,e.biff)+":"+Gv(t.e,e.biff)}function tD(t){return parseInt($he(t),10)-1}function sn(t){return""+(t+1)}function Lhe(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $he(t){return t.replace(/\$(\d+)$/,"$1")}function rD(t){for(var e=Vhe(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function kr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Bhe(t){return t.replace(/^([A-Z])/,"$$$1")}function Vhe(t){return t.replace(/^\$([A-Z])/,"$1")}function Whe(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function nt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Zi(t){var e=t.indexOf(":");return e==-1?{s:zr(t),e:zr(t)}:{s:zr(t.slice(0,e)),e:zr(t.slice(e+1))}}function dt(t,e){return typeof e>"u"||typeof e=="number"?dt(t.s,t.e):(typeof t!="string"&&(t=nt(t)),typeof e!="string"&&(e=nt(e)),t==e?t:t+":"+e)}function It(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function uB(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ao(t.z,r?jn(e):e)}catch{}try{return t.w=ao((t.XF||{}).numFmtId||(r?14:0),r?jn(e):e)}catch{return""+e}}function Fl(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?nc[t.v]||t.v:e==null?uB(t,t.v):uB(t,e))}function Lh(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function tG(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=It(s["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),o==-1&&(u.e.r=o=c.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var d={v:e[h][f]},g=o+h,m=a+f;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))d=e[h][f];else if(Array.isArray(d.v)&&(d.f=e[h][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||rt[14],n.cellDates?(d.t="d",d.w=ao(d.z,jn(d.v))):(d.t="n",d.v=jn(d.v),d.w=ao(d.z,d.v))):d.t="s";if(i)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(d.z=s[g][m].z),s[g][m]=d;else{var p=nt({c:m,r:g});s[p]&&s[p].z&&(d.z=s[p].z),s[p]=d}}}return u.s.c<1e7&&(s["!ref"]=dt(u)),s}function Dp(t,e){return tG(null,t,e)}function jhe(t){return t.read_shift(4,"i")}function Oa(t,e){return e||(e=ve(4)),e.write_shift(4,t),e}function Ii(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Qn(t,e){var r=!1;return e==null&&(r=!0,e=ve(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Uhe(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function zhe(t,e){return e||(e=ve(4)),e.write_shift(2,0),e.write_shift(2,0),e}function nD(t,e){var r=t.l,n=t.read_shift(1),i=Ii(t),s=[],o={t:i,h:i};if(n&1){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(Uhe(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function Ghe(t,e){var r=!1;return e==null&&(r=!0,e=ve(15+4*t.t.length)),e.write_shift(1,0),Qn(t.t,e),r?e.slice(0,e.l):e}var Yhe=nD;function Khe(t,e){var r=!1;return e==null&&(r=!0,e=ve(23+4*t.t.length)),e.write_shift(1,1),Qn(t.t,e),e.write_shift(4,1),zhe({},e),r?e.slice(0,e.l):e}function Go(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function zd(t,e){return e==null&&(e=ve(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Gd(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Yd(t,e){return e==null&&(e=ve(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Xhe=Ii,rG=Qn;function iD(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Jb(t,e){var r=!1;return e==null&&(r=!0,e=ve(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qhe=Ii,UO=iD,sD=Jb;function oD(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?qb([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Vf(e,0)>>2;return r?i/100:i}function nG(t,e){e==null&&(e=ve(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function iG(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Jhe(t,e){return e||(e=ve(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Kd=iG,Fp=Jhe;function ki(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ed(t,e){return(e||ve(8)).write_shift(8,t,"f")}function Qhe(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=od[i];u&&(e.rgb=ry(u));break;case 2:e.rgb=ry([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Qb(t,e){if(e||(e=ve(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Zhe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function efe(t,e){e||(e=ve(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function sG(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function tfe(t){return sG(t,1)}function rfe(t){return sG(t,2)}var aD=2,vs=3,uC=11,cB=12,Zb=19,cC=64,nfe=65,ife=71,sfe=4108,ofe=4126,Yn=80,oG=81,afe=[Yn,oG],zO={1:{n:"CodePage",t:aD},2:{n:"Category",t:Yn},3:{n:"PresentationFormat",t:Yn},4:{n:"ByteCount",t:vs},5:{n:"LineCount",t:vs},6:{n:"ParagraphCount",t:vs},7:{n:"SlideCount",t:vs},8:{n:"NoteCount",t:vs},9:{n:"HiddenCount",t:vs},10:{n:"MultimediaClipCount",t:vs},11:{n:"ScaleCrop",t:uC},12:{n:"HeadingPairs",t:sfe},13:{n:"TitlesOfParts",t:ofe},14:{n:"Manager",t:Yn},15:{n:"Company",t:Yn},16:{n:"LinksUpToDate",t:uC},17:{n:"CharacterCount",t:vs},19:{n:"SharedDoc",t:uC},22:{n:"HyperlinksChanged",t:uC},23:{n:"AppVersion",t:vs,p:"version"},24:{n:"DigSig",t:nfe},26:{n:"ContentType",t:Yn},27:{n:"ContentStatus",t:Yn},28:{n:"Language",t:Yn},29:{n:"Version",t:Yn},255:{},2147483648:{n:"Locale",t:Zb},2147483651:{n:"Behavior",t:Zb},1919054434:{}},GO={1:{n:"CodePage",t:aD},2:{n:"Title",t:Yn},3:{n:"Subject",t:Yn},4:{n:"Author",t:Yn},5:{n:"Keywords",t:Yn},6:{n:"Comments",t:Yn},7:{n:"Template",t:Yn},8:{n:"LastAuthor",t:Yn},9:{n:"RevNumber",t:Yn},10:{n:"EditTime",t:cC},11:{n:"LastPrinted",t:cC},12:{n:"CreatedDate",t:cC},13:{n:"ModifiedDate",t:cC},14:{n:"PageCount",t:vs},15:{n:"WordCount",t:vs},16:{n:"CharCount",t:vs},17:{n:"Thumbnail",t:ife},18:{n:"Application",t:Yn},19:{n:"DocSecurity",t:vs},255:{},2147483648:{n:"Locale",t:Zb},2147483651:{n:"Behavior",t:Zb},1919054434:{}},hB={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lfe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ufe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var cfe=ufe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),od=vr(cfe),nc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},aG={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},YO={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function lD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function hfe(t){var e=lD();if(!t||!t.match)return e;var r={};if((t.match(Di)||[]).forEach(function(n){var i=it(n);switch(i[0].replace(She,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[YO[i.ContentType]]!==void 0&&e[YO[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Bn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function lG(t,e){var r=hhe(YO),n=[],i;n[n.length]=pn,n[n.length]=Ie("Types",null,{xmlns:Bn.CT,"xmlns:xsd":Bn.xsd,"xmlns:xsi":Bn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ie("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Ie("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:hC[l][e.bookType]||hC[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ie("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:hC[l][e.bookType]||hC[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Ie("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var _t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ty(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Yv(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Di)||[]).forEach(function(i){var s=it(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:_v(s.Target,e);r[a]=o,n[s.Id]=o}}),r["!id"]=n,r}function jm(t){var e=[pn,Ie("Relationships",null,{xmlns:Bn.RELS})];return ln(t["!id"]).forEach(function(r){e[e.length]=Ie("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function or(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[_t.HLINK,_t.XPATH,_t.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var ffe="application/vnd.oasis.opendocument.spreadsheet";function dfe(t,e){for(var r=KN(t),n,i;n=ey.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=it(n[0],!1),i.path=="/"&&i.type!==ffe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function gfe(t){var e=[pn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function fB(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function mfe(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function pfe(t){var e=[pn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(fB(t[r][0],t[r][1])),e.push(mfe("",t[r][0]));return e.push(fB("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function uG(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xw.version+"</meta:generator></office:meta></office:document-meta>"}var Vo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vfe=function(){for(var t=new Array(Vo.length),e=0;e<Vo.length;++e){var r=Vo[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function cG(t){var e={};t=hr(t);for(var r=0;r<Vo.length;++r){var n=Vo[r],i=t.match(vfe[r]);i!=null&&i.length>0&&(e[n[1]]=jt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Pr(e[n[1]]))}return e}function nk(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=ar(e),n[n.length]=r?Ie(t,e,r):li(t,e))}function hG(t,e){var r=e||{},n=[pn,Ie("cp:coreProperties",null,{"xmlns:cp":Bn.CORE_PROPS,"xmlns:dc":Bn.dc,"xmlns:dcterms":Bn.dcterms,"xmlns:dcmitype":Bn.dcmitype,"xmlns:xsi":Bn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&nk("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:jO(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&nk("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:jO(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Vo.length;++s){var o=Vo[s],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&nk(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ad=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],fG=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function dG(t,e,r,n){var i=[];if(typeof t=="string")i=rB(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(c){return{v:c}}));var o=typeof e=="string"?rB(e,n).map(function(c){return c.v}):e,a=0,l=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function wfe(t,e,r){var n={};return e||(e={}),t=hr(t),ad.forEach(function(i){var s=(t.match(Qw(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=jt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&dG(n.HeadingPairs,n.TitlesOfParts,e,r),e}function gG(t){var e=[],r=Ie;return t||(t={}),t.Application="SheetJS",e[e.length]=pn,e[e.length]=Ie("Properties",null,{xmlns:Bn.EXT_PROPS,"xmlns:vt":Bn.vt}),ad.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=ar(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+ar(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var yfe=/<[^>]+>[^<]*/g;function Cfe(t,e){var r={},n="",i=t.match(yfe);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=it(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),u=l[0].slice(4),c=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=jt(c);break;case"bool":r[n]=Rr(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(c,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(c);break;case"filetime":case"date":r[n]=Pr(c);break;case"cy":case"error":r[n]=jt(c);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,l)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function mG(t){var e=[pn,Ie("Properties",null,{xmlns:Bn.CUST_PROPS,"xmlns:vt":Bn.vt})];if(!t)return e.join("");var r=1;return ln(t).forEach(function(i){++r,e[e.length]=Ie("property",Phe(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ar(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var KO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ik;function Sfe(t,e,r){ik||(ik=QE(KO)),e=ik[e]||e,t[e]=r}function xfe(t,e){var r=[];return ln(KO).map(function(n){for(var i=0;i<Vo.length;++i)if(Vo[i][1]==n)return Vo[i];for(i=0;i<ad.length;++i)if(ad[i][1]==n)return ad[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(li(KO[n[1]]||n[1],i))}}),Ie("DocumentProperties",r.join(""),{xmlns:Ks.o})}function bfe(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&ln(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Vo.length;++o)if(s==Vo[o][1])return;for(o=0;o<ad.length;++o)if(s==ad[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(Ie(Q3(s),a,{"dt:dt":l}))}}),e&&ln(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Ie(Q3(s),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+Ks.o+'">'+i.join("")+"</"+n+">"}function uD(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function _fe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=ve(8);return o.write_shift(4,n),o.write_shift(4,i),o}function pG(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function vG(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function wG(t,e,r){return e===31?vG(t):pG(t,e,r)}function XO(t,e,r){return wG(t,e,r===!1?0:4)}function Efe(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return wG(t,e,0)}function Rfe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Ai,""),t.l-i&2&&(t.l+=2)}return r}function Tfe(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Ai,"");return r}function kfe(t){var e=t.l,r=e_(t,oG);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=e_(t,vs);return[r,n]}function Pfe(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(kfe(t));return r}function dB(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Ai,"").replace(bv,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function yG(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function Afe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function e_(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==cB&&n!==e&&afe.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===cB?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return pG(t,n,4).replace(Ai,"");case 31:return vG(t);case 64:return uD(t);case 65:return yG(t);case 71:return Afe(t);case 80:return XO(t,n,!s.raw).replace(Ai,"");case 81:return Efe(t,n).replace(Ai,"");case 4108:return Pfe(t);case 4126:case 4127:return n==4127?Rfe(t):Tfe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function gB(t,e){var r=ve(4),n=ve(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ve(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=_fe(e);break;case 31:case 80:for(n=ve(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Jn([r,n])}function mB(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0,a=0,l=-1,u={};for(o=0;o!=i;++o){var c=t.read_shift(4),h=t.read_shift(4);s[o]=[c,h+r]}s.sort(function(v,y){return v[1]-y[1]});var f={};for(o=0;o!=i;++o){if(t.l!==s[o][1]){var d=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,d=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],d=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],d=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(d=!1,t.l=s[o][1]),d)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var g=e[s[o][0]];if(f[g.n]=e_(t,g.t,{raw:!0}),g.p==="version"&&(f[g.n]=String(f[g.n]>>16)+"."+("0000"+String(f[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(f[g.n]){case 0:f[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:$o(a=f[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[g.n])}}else if(s[o][0]===1){if(a=f.CodePage=e_(t,aD),$o(a),l!==-1){var m=t.l;t.l=s[l][1],u=dB(t,a),t.l=m}}else if(s[o][0]===0){if(a===0){l=o,t.l=s[o+1][1];continue}u=dB(t,a)}else{var p=u[s[o][0]],w;switch(t[t.l]){case 65:t.l+=4,w=yG(t);break;case 30:t.l+=4,w=XO(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,w=XO(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,w=t.read_shift(4,"i");break;case 19:t.l+=4,w=t.read_shift(4);break;case 5:t.l+=4,w=t.read_shift(8,"f");break;case 11:t.l+=4,w=hn(t,4);break;case 64:t.l+=4,w=Pr(uD(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[p]=w}}return t.l=r+n,f}var CG=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ife(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function pB(t,e,r){var n=ve(8),i=[],s=[],o=8,a=0,l=ve(8),u=ve(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),o+=8+l.length,!e){u=ve(8),u.write_shift(4,0),i.unshift(u);var c=[ve(4)];for(c[0].write_shift(4,t.length),a=0;a<t.length;++a){var h=t[a][0];for(l=ve(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=Jn(c),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(CG.indexOf(t[a][0])>-1||fG.indexOf(t[a][0])>-1)&&t[a][1]!=null){var f=t[a][1],d=0;if(e){d=+e[t[a][0]];var g=r[d];if(g.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=gB(g.t,f)}else{var p=Ife(f);p==-1&&(p=31,f=String(f)),l=gB(p,f)}s.push(l),u=ve(8),u.write_shift(4,e?d:2+a),i.push(u),o+=8+l.length}var w=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,w),w+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),Jn([n].concat(i).concat(s))}function vB(t,e,r){var n=t.content;if(!n)return{};ai(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),c=n.read_shift(16);if(c!==Xe.utils.consts.HEADER_CLSID&&c!==r)throw new Error("Bad PropertySet CLSID "+c);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),i===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var h=mB(n,e),f={SystemIdentifier:u};for(var d in h)f[d]=h[d];if(f.FMTID=s,i===1)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=mB(n,null)}catch{}for(d in g)f[d]=g[d];return f.FMTID=[s,o],f}function wB(t,e,r,n,i,s){var o=ve(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Xe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=pB(t,r,n);if(a.push(l),i){var u=pB(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(u)}return Jn(a)}function mc(t,e){return t.read_shift(e),null}function Ofe(t,e){e||(e=ve(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function Mfe(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function hn(t,e){return t.read_shift(e)===1}function Yi(t,e){return e||(e=ve(2)),e.write_shift(2,+!!t),e}function Rn(t){return t.read_shift(2,"u")}function Ro(t,e){return e||(e=ve(2)),e.write_shift(2,t),e}function SG(t,e){return Mfe(t,e,Rn)}function Nfe(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function xG(t,e,r){return r||(r=ve(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Qy(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=to;if(r&&r.biff>=8&&(to=1200),!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return to=s,a}function Dfe(t){var e=to;to=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,s=n&8,o=1+(n&1),a=0,l,u={};s&&(a=t.read_shift(2)),i&&(l=t.read_shift(4));var c=o==2?"dbcs-cont":"sbcs-cont",h=r===0?"":t.read_shift(r,c);return s&&(t.l+=4*a),i&&(t.l+=l),u.t=h,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),to=e,u}function Ffe(t){var e=t.t||"",r=ve(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ve(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Jn(i)}function Rd(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Zy(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Rd(t,n,r)}function Xd(t,e,r){if(r.biff>5)return Zy(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function bG(t,e,r){return r||(r=ve(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Hfe(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Lfe(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Ai,"");return n&&(t.l+=24),i}function $fe(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Ai,"");return r+o}function Bfe(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Lfe(t);case"0303000000000000c000000000000046":return $fe(t);default:throw new Error("Unsupported Moniker "+r)}}function fC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Ai,""):"";return r}function yB(t,e){e||(e=ve(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Vfe(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,o,a,l,u="",c,h;i&16&&(s=fC(t,r-t.l)),i&128&&(o=fC(t,r-t.l)),(i&257)===257&&(a=fC(t,r-t.l)),(i&257)===1&&(l=Bfe(t,r-t.l)),i&8&&(u=fC(t,r-t.l)),i&32&&(c=t.read_shift(16)),i&64&&(h=uD(t)),t.l=r;var f=o||a||l||"";f&&u&&(f+="#"+u),f||(f="#"+u),i&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var d={Target:f};return c&&(d.guid=c),h&&(d.time=h),s&&(d.Tooltip=s),d}function Wfe(t){var e=ve(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),yB(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var a=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)e.write_shift(2,a.charCodeAt(r));e.write_shift(2,0),s&8&&yB(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function _G(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function EG(t,e){var r=_G(t);return r[3]=0,r}function Bl(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Td(t,e,r,n){return n||(n=ve(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function jfe(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Ufe(t,e,r){return e===0?"":Xd(t,e,r)}function zfe(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,s,o]}function RG(t){var e=t.read_shift(2),r=oD(t);return[e,r]}function Gfe(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Qy(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function rR(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function TG(t,e){return e||(e=ve(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function kG(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var Yfe=kG;function PG(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Kfe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Xfe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function gi(t){t.l+=2,t.l+=t.read_shift(2)}var qfe={0:gi,4:gi,5:gi,6:gi,7:Xfe,8:gi,9:gi,10:gi,11:gi,12:gi,13:Kfe,14:gi,15:gi,16:gi,17:gi,18:gi,19:gi,20:gi,21:PG};function Jfe(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(qfe[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function dC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function cD(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ve(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Qfe(t,e){return e===0||t.read_shift(2),1200}function Zfe(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Xd(t,0,r);return t.read_shift(e+n-t.l),i}function ede(t,e){var r=!e||e.biff==8,n=ve(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function tde(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function rde(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Qy(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function nde(t,e){var r=!e||e.biff>=8?2:1,n=ve(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function ide(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0;o!=i&&t.l<r;++o)s.push(Dfe(t));return s.Count=n,s.Unique=i,s}function sde(t,e){var r=ve(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=Ffe(t[i]);var s=Jn([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function ode(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function ade(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function lde(t){var e=jfe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function ude(t){return t.read_shift(2),t.read_shift(4)}function CB(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function cde(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:a,Selected:l,TabRatio:u}}function hde(){var t=ve(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function fde(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function dde(t){var e=ve(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function gde(){}function mde(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Qy(t,0,r),n}function pde(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ve(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function vde(t){var e=Bl(t);return e.isst=t.read_shift(4),e}function wde(t,e,r,n){var i=ve(10);return Td(t,e,n,i),i.write_shift(4,r),i}function yde(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Bl(t);r.biff==2&&t.l++;var s=Zy(t,n-t.l,r);return i.val=s,i}function Cde(t,e,r,n,i){var s=!i||i.biff==8,o=ve(8+ +s+(1+s)*r.length);return Td(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function Sde(t,e,r){var n=t.read_shift(2),i=Xd(t,0,r);return[n,i]}function xde(t,e,r,n){var i=r&&r.biff==5;n||(n=ve(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var bde=Xd;function SB(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),o=t.read_shift(i),a=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function _de(t,e){var r=e.biff==8||!e.biff?4:2,n=ve(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Ede(t){var e=t.read_shift(2),r=t.read_shift(2),n=RG(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function Rde(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(RG(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function Tde(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function kde(t,e,r,n){var i={},s=t.read_shift(4),o=t.read_shift(4),a=t.read_shift(4),l=t.read_shift(2);return i.patternType=lfe[a>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function Pde(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=kde(t,e,n.fStyle,r),n}function xB(t,e,r,n){var i=r&&r.biff==5;n||(n=ve(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Ade(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Ide(t){var e=ve(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function bB(t,e,r){var n=Bl(t);(r.biff==2||e==9)&&++t.l;var i=Nfe(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function Ode(t,e,r,n,i,s){var o=ve(8);return Td(t,e,n,o),xG(r,s,o),o}function Mde(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Bl(t),i=ki(t);return n.val=i,n}function Nde(t,e,r,n){var i=ve(14);return Td(t,e,n,i),Ed(r,i),i}var _B=Ufe;function Dde(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Rd(t,s),a=[];n>t.l;)a.push(Zy(t));return[s,i,o,a]}function EB(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Gfe(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var Fde=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function RB(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),a=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=Rd(t,o,r);i&32&&(u=Fde[u.charCodeAt(0)]);var c=n-t.l;r&&r.biff==2&&--c;var h=n==t.l||a===0||!(c>0)?[]:J0e(t,c,r,a);return{chKey:s,Name:u,itab:l,rgce:h}}function AG(t,e,r){if(r.biff<8)return Hde(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(zfe(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function Hde(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Qy(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Lde(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Rd(t,n,r),o=Rd(t,i,r);return[s,o]}function $de(t,e,r){var n=kG(t);t.l++;var i=t.read_shift(1);return e-=8,[Q0e(t,e,r),i,n]}function TB(t,e,r){var n=Yfe(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,X0e(t,e,r)]}function Bde(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Vde(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=Xd(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},a,o,s]}}function Wde(t,e,r){return Vde(t,e,r)}function jde(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(rR(t));return r}function Ude(t){var e=ve(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)TG(t[r],e);return e}function zde(t,e,r){if(r&&r.biff<8)return Yde(t,e,r);var n=PG(t),i=Jfe(t,e-22,n[1]);return{cmo:n,ft:i}}var Gde={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function Yde(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((Gde[n]||Ni)(t,e,r)),{cmo:[i,n,s],ft:o}}function Kde(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=Hfe(t,6,r);var a=t.read_shift(2);t.read_shift(2),Rn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var c=t[t.l],h=Rd(t,t.lens[u+1]-t.lens[u]-1);if(i+=h,i.length>=(c?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function Xde(t,e){var r=rR(t);t.l+=16;var n=Vfe(t,e-24);return[r,n]}function qde(t){var e=ve(24),r=zr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Jn([e,Wfe(t[1])])}function Jde(t,e){t.read_shift(2);var r=rR(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Ai,""),[r,n]}function Qde(t){var e=t[1].Tooltip,r=ve(10+2*(e.length+1));r.write_shift(2,2048);var n=zr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Zde(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=hB[r]||r,r=t.read_shift(2),e[1]=hB[r]||r,e}function ege(t){return t||(t=ve(4)),t.write_shift(2,1),t.write_shift(2,1),t}function tge(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(EG(t));return r}function rge(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(EG(t));return r}function nge(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function IG(t,e,r){if(!r.cellStyles)return Ni(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function ige(t,e){var r=ve(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function sge(t,e){var r={};return e<32||(t.l+=16,r.header=ki(t),r.footer=ki(t),t.l+=2),r}function oge(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function age(t){for(var e=ve(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var lge=Bl,uge=SG,cge=Zy;function hge(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function fge(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Bl(t);++t.l;var i=Xd(t,e-7,r);return n.t="str",n.val=i,n}function dge(t){var e=Bl(t);++t.l;var r=ki(t);return e.t="n",e.val=r,e}function gge(t,e,r){var n=ve(15);return n1(n,t,e),n.write_shift(8,r,"f"),n}function mge(t){var e=Bl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function pge(t,e,r){var n=ve(9);return n1(n,t,e),n.write_shift(2,r),n}function vge(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function wge(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function yge(t,e,r){var n=t.l+e,i=Bl(t),s=t.read_shift(2),o=Rd(t,s,r);return t.l=n,i.t="str",i.val=o,i}var Cge=[2,3,48,49,131,139,140,245],qO=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=QE({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var u=[],c=Th(1);switch(l.type){case"base64":c=Xs(oo(a));break;case"binary":c=Xs(a);break;case"buffer":case"array":c=a;break}ai(c,0);var h=c.read_shift(1),f=!!(h&136),d=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,p=521;h==2&&(m=c.read_shift(2)),c.l+=3,h!=2&&(m=c.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(p=c.read_shift(2));var w=c.read_shift(2),v=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(v=t[c[c.l]]),c.l+=1,c.l+=2),g&&(c.l+=36);for(var y=[],b={},T=Math.min(c.length,h==2?521:p-10-(d?264:0)),E=g?32:11;c.l<T&&c[c.l]!=13;)switch(b={},b.name=Ht.utils.decode(v,c.slice(c.l,c.l+E)).replace(/[\u0000\r\n].*$/g,""),c.l+=E,b.type=String.fromCharCode(c.read_shift(1)),h!=2&&!g&&(b.offset=c.read_shift(4)),b.len=c.read_shift(1),h==2&&(b.offset=c.read_shift(2)),b.dec=c.read_shift(1),b.name.length&&y.push(b),h!=2&&(c.l+=g?13:14),b.type){case"B":(!d||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(c[c.l]!==13&&(c.l=p-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=p;var x=0,P=0;for(u[0]=[],P=0;P!=y.length;++P)u[0][P]=y[P].name;for(;m-- >0;){if(c[c.l]===42){c.l+=w;continue}for(++c.l,u[++x]=[],P=0,P=0;P!=y.length;++P){var A=c.slice(c.l,c.l+y[P].len);c.l+=y[P].len,ai(A,0);var O=Ht.utils.decode(v,A);switch(y[P].type){case"C":O.trim().length&&(u[x][P]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[x][P]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[x][P]=O;break;case"F":u[x][P]=parseFloat(O.trim());break;case"+":case"I":u[x][P]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[x][P]=!0;break;case"N":case"F":u[x][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[x][P]="##MEMO##"+(g?parseInt(O.trim(),10):A.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[x][P]=+O||0);break;case"@":u[x][P]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[x][P]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[x][P]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[x][P]=-A.read_shift(-8,"f");break;case"B":if(d&&y[P].len==8){u[x][P]=A.read_shift(8,"f");break}case"G":case"P":A.l+=y[P].len;break;case"0":if(y[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[P].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=y,u}function n(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=Dp(r(a,u),u);return c["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,c}function i(a,l){try{return Lh(n(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&$o(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=As(),h=i_(a,{header:1,raw:!0,cellDates:!0}),f=h[0],d=h.slice(1),g=a["!cols"]||[],m=0,p=0,w=0,v=1;for(m=0;m<f.length;++m){if(((g[m]||{}).DBF||{}).name){f[m]=g[m].DBF.name,++w;continue}if(f[m]!=null){if(++w,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(p=0;p<1024;++p)if(f.indexOf(f[m]+"_"+p)==-1){f[m]+="_"+p;break}}}}var y=It(a["!ref"]),b=[],T=[],E=[];for(m=0;m<=y.e.c-y.s.c;++m){var x="",P="",A=0,O=[];for(p=0;p<d.length;++p)d[p][m]!=null&&O.push(d[p][m]);if(O.length==0||f[m]==null){b[m]="?";continue}for(p=0;p<O.length;++p){switch(typeof O[p]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=O[p]instanceof Date?"D":"C";break;default:P="C"}A=Math.max(A,String(O[p]).length),x=x&&x!=P?"C":P}A>250&&(A=250),P=((g[m]||{}).DBF||{}).type,P=="C"&&g[m].DBF.len>A&&(A=g[m].DBF.len),x=="B"&&P=="N"&&(x="N",E[m]=g[m].DBF.dec,A=g[m].DBF.len),T[m]=x=="C"||P=="N"?A:s[x]||0,v+=T[m],b[m]=x}var Y=c.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,d.length),Y.write_shift(2,296+32*w),Y.write_shift(2,v),m=0;m<4;++m)Y.write_shift(4,0);for(Y.write_shift(4,0|(+e[xd]||3)<<8),m=0,p=0;m<f.length;++m)if(f[m]!=null){var L=c.next(32),ie=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,ie,"sbcs"),L.write_shift(1,b[m]=="?"?"C":b[m],"sbcs"),L.write_shift(4,p),L.write_shift(1,T[m]||s[b[m]]||0),L.write_shift(1,E[m]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),p+=T[m]||s[b[m]]||0}var ce=c.next(264);for(ce.write_shift(4,13),m=0;m<65;++m)ce.write_shift(4,0);for(m=0;m<d.length;++m){var he=c.next(v);for(he.write_shift(1,0),p=0;p<f.length;++p)if(f[p]!=null)switch(b[p]){case"L":he.write_shift(1,d[m][p]==null?63:d[m][p]?84:70);break;case"B":he.write_shift(8,d[m][p]||0,"f");break;case"N":var Ee="0";for(typeof d[m][p]=="number"&&(Ee=d[m][p].toFixed(E[p]||0)),w=0;w<T[p]-Ee.length;++w)he.write_shift(1,32);he.write_shift(1,Ee,"sbcs");break;case"D":d[m][p]?(he.write_shift(4,("0000"+d[m][p].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(d[m][p].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+d[m][p].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(d[m][p]!=null?d[m][p]:"").slice(0,T[p]);for(he.write_shift(1,Ce,"sbcs"),w=0;w<T[p]-Ce.length;++w)he.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),OG=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ln(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,d){var g=t[d];return typeof g=="number"?WO(g):g},n=function(f,d,g){var m=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?f:WO(m)};t["|"]=254;function i(f,d){switch(d.type){case"base64":return s(oo(f),d);case"binary":return s(f,d);case"buffer":return s(xt&&Buffer.isBuffer(f)?f.toString("binary"):Hh(f),d);case"array":return s(_d(f),d)}throw new Error("Unrecognized type "+d.type)}function s(f,d){var g=f.split(/[\n\r]+/),m=-1,p=-1,w=0,v=0,y=[],b=[],T=null,E={},x=[],P=[],A=[],O=0,Y;for(+d.codepage>=0&&$o(+d.codepage);w!==g.length;++w){O=0;var L=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),ie=L.replace(/;;/g,"\0").split(";").map(function(_){return _.replace(/\u0000/g,";")}),ce=ie[0],he;if(L.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ie[1].charAt(0)=="P"&&b.push(L.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,Ce=!1,ge=!1,Q=!1,ye=-1,Re=-1;for(v=1;v<ie.length;++v)switch(ie[v].charAt(0)){case"A":break;case"X":p=parseInt(ie[v].slice(1))-1,Ce=!0;break;case"Y":for(m=parseInt(ie[v].slice(1))-1,Ce||(p=0),Y=y.length;Y<=m;++Y)y[Y]=[];break;case"K":he=ie[v].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(Ia(he))?isNaN(fp(he).getDate())||(he=Pr(he)):(he=Ia(he),T!==null&&jd(T)&&(he=eR(he))),typeof Ht<"u"&&typeof he=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(he=Ht.utils.decode(d.codepage,he)),Ee=!0;break;case"E":Q=!0;var W=Um(ie[v].slice(1),{r:m,c:p});y[m][p]=[y[m][p],W];break;case"S":ge=!0,y[m][p]=[y[m][p],"S5S"];break;case"G":break;case"R":ye=parseInt(ie[v].slice(1))-1;break;case"C":Re=parseInt(ie[v].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}if(Ee&&(y[m][p]&&y[m][p].length==2?y[m][p][0]=he:y[m][p]=he,T=null),ge){if(Q)throw new Error("SYLK shared formula cannot have own formula");var C=ye>-1&&y[ye][Re];if(!C||!C[1])throw new Error("SYLK shared formula cannot find base");y[m][p][1]=qG(C[1],{r:m-ye,c:p-Re})}break;case"F":var S=0;for(v=1;v<ie.length;++v)switch(ie[v].charAt(0)){case"X":p=parseInt(ie[v].slice(1))-1,++S;break;case"Y":for(m=parseInt(ie[v].slice(1))-1,Y=y.length;Y<=m;++Y)y[Y]=[];break;case"M":O=parseInt(ie[v].slice(1))/20;break;case"F":break;case"G":break;case"P":T=b[parseInt(ie[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=ie[v].slice(1).split(" "),Y=parseInt(A[0],10);Y<=parseInt(A[1],10);++Y)O=parseInt(A[2],10),P[Y-1]=O===0?{hidden:!0}:{wch:O},kh(P[Y-1]);break;case"C":p=parseInt(ie[v].slice(1))-1,P[p]||(P[p]={});break;case"R":m=parseInt(ie[v].slice(1))-1,x[m]||(x[m]={}),O>0?(x[m].hpt=O,x[m].hpx=gp(O)):O===0&&(x[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}S<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+L)}}return x.length>0&&(E["!rows"]=x),P.length>0&&(E["!cols"]=P),d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),[y,E]}function o(f,d){var g=i(f,d),m=g[0],p=g[1],w=Dp(m,d);return ln(p).forEach(function(v){w[v]=p[v]}),w}function a(f,d){return Lh(o(f,d),d)}function l(f,d,g,m){var p="C;Y"+(g+1)+";X"+(m+1)+";K";switch(f.t){case"n":p+=f.v||0,f.f&&!f.F&&(p+=";E"+pD(f.f,{r:g,c:m}));break;case"b":p+=f.v?"TRUE":"FALSE";break;case"e":p+=f.w||f.v;break;case"d":p+='"'+(f.w||f.v)+'"';break;case"s":p+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function u(f,d){d.forEach(function(g,m){var p="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=ny(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=iy(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&f.push(p)})}function c(f,d){d.forEach(function(g,m){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*sy(g.hpx)+";"),p.length>2&&f.push(p+"R"+(m+1))})}function h(f,d){var g=["ID;PWXL;N;E"],m=[],p=It(f["!ref"]),w,v=Array.isArray(f),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),f["!cols"]&&u(g,f["!cols"]),f["!rows"]&&c(g,f["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var b=p.s.r;b<=p.e.r;++b)for(var T=p.s.c;T<=p.e.c;++T){var E=nt({r:b,c:T});w=v?(f[b]||[])[T]:f[E],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,f,b,T))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),MG=function(){function t(s,o){switch(o.type){case"base64":return e(oo(s),o);case"binary":return e(s,o);case"buffer":return e(xt&&Buffer.isBuffer(s)?s.toString("binary"):Hh(s),o);case"array":return e(_d(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,u=-1,c=0,h=[];c!==a.length;++c){if(a[c].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var f=a[c].trim().split(","),d=f[0],g=f[1];++c;for(var m=a[c]||"";(m.match(/["]/g)||[]).length&1&&c<a.length-1;)m+=`
`+a[++c];switch(m=m.trim(),+d){case-1:if(m==="BOT"){h[++l]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][u]=!0:m==="FALSE"?h[l][u]=!1:isNaN(Ia(g))?isNaN(fp(g).getDate())?h[l][u]=g:h[l][u]=Pr(g):h[l][u]=Ia(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][u++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return Dp(t(s,o),o)}function n(s,o){return Lh(r(s,o),o)}var i=function(){var s=function(l,u,c,h,f){l.push(u),l.push(c+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},o=function(l,u,c,h){l.push(u+","+c),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],c=It(l["!ref"]),h,f=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,c.e.r-c.s.r+1,""),s(u,"TUPLES",0,c.e.c-c.s.c+1,""),s(u,"DATA",0,0,"");for(var d=c.s.r;d<=c.e.r;++d){o(u,-1,0,"BOT");for(var g=c.s.c;g<=c.e.c;++g){var m=nt({r:d,c:g});if(h=f?(l[d]||[])[g]:l[m],!h){o(u,1,0,"");continue}switch(h.t){case"n":var p=h.w;!p&&h.v!=null&&(p=h.v),p==null?h.f&&!h.F?o(u,1,0,"="+h.f):o(u,1,0,""):o(u,0,p,"V");break;case"b":o(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ao(h.z||rt[14],jn(Pr(h.v)))),o(u,0,h.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var w=`\r
`,v=u.join(w);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),NG=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var d=h.split(`
`),g=-1,m=-1,p=0,w=[];p!==d.length;++p){var v=d[p].trim().split(":");if(v[0]==="cell"){var y=zr(v[1]);if(w.length<=y.r)for(g=w.length;g<=y.r;++g)w[g]||(w[g]=[]);switch(g=y.r,m=y.c,v[2]){case"t":w[g][m]=t(v[3]);break;case"v":w[g][m]=+v[3];break;case"vtf":var b=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[g][m]=!!+v[4];break;default:w[g][m]=+v[4];break}v[2]=="vtf"&&(w[g][m]=[w[g][m],b])}}}return f&&f.sheetRows&&(w=w.slice(0,f.sheetRows)),w}function n(h,f){return Dp(r(h,f),f)}function i(h,f){return Lh(n(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],d=[],g,m="",p=Zi(h["!ref"]),w=Array.isArray(h),v=p.s.r;v<=p.e.r;++v)for(var y=p.s.c;y<=p.e.c;++y)if(m=nt({r:v,c:y}),g=w?(h[v]||[])[y]:h[m],!(!g||g.v==null||g.t==="z")){switch(d=["cell",m,"t"],g.t){case"s":case"str":d.push(e(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=e(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var b=jn(Pr(g.v));d[2]="vtc",d[3]="nd",d[4]=""+b,d[5]=g.w||ao(g.z||rt[14],b);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function c(h){return[s,o,a,o,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),dp=function(){function t(c,h,f,d,g){g.raw?h[f][d]=c:c===""||(c==="TRUE"?h[f][d]=!0:c==="FALSE"?h[f][d]=!1:isNaN(Ia(c))?isNaN(fp(c).getDate())?h[f][d]=c:h[f][d]=Pr(c):h[f][d]=Ia(c))}function e(c,h){var f=h||{},d=[];if(!c||c.length===0)return d;for(var g=c.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var p=10,w=0,v=0;v<=m;++v)w=g[v].indexOf(" "),w==-1?w=g[v].length:w++,p=Math.max(p,w);for(v=0;v<=m;++v){d[v]=[];var y=0;for(t(g[v].slice(0,p).trim(),d,v,y,f),y=1;y<=(g[v].length-p)/10+1;++y)t(g[v].slice(p+(y-1)*10,p+y*10).trim(),d,v,y,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(c){for(var h={},f=!1,d=0,g=0;d<c.length;++d)(g=c.charCodeAt(d))==34?f=!f:!f&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d]);if(!g.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d])}return g.sort(function(m,p){return m[0]-p[0]||n[m[1]]-n[p[1]]}),r[g.pop()[1]]||44}function s(c,h){var f=h||{},d="",g=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(d=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(d=c.charAt(4),c=c.slice(6)):d=i(c.slice(0,1024)):f&&f.FS?d=f.FS:d=i(c.slice(0,1024));var p=0,w=0,v=0,y=0,b=0,T=d.charCodeAt(0),E=!1,x=0,P=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var A=f.dateNF!=null?she(f.dateNF):null;function O(){var Y=c.slice(y,b),L={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),Y.length===0)L.t="z";else if(f.raw)L.t="s",L.v=Y;else if(Y.trim().length===0)L.t="s",L.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(L.t="s",L.v=Y.slice(2,-1).replace(/""/g,'"')):Dpe(Y)?(L.t="n",L.f=Y.slice(1)):(L.t="s",L.v=Y);else if(Y=="TRUE")L.t="b",L.v=!0;else if(Y=="FALSE")L.t="b",L.v=!1;else if(!isNaN(v=Ia(Y)))L.t="n",f.cellText!==!1&&(L.w=Y),L.v=v;else if(!isNaN(fp(Y).getDate())||A&&Y.match(A)){L.z=f.dateNF||rt[14];var ie=0;A&&Y.match(A)&&(Y=ohe(Y,f.dateNF,Y.match(A)||[]),ie=1),f.cellDates?(L.t="d",L.v=Pr(Y,ie)):(L.t="n",L.v=jn(Pr(Y,ie))),f.cellText!==!1&&(L.w=ao(L.z,L.v instanceof Date?jn(L.v):L.v)),f.cellNF||delete L.z}else L.t="s",L.v=Y;if(L.t=="z"||(f.dense?(g[p]||(g[p]=[]),g[p][w]=L):g[nt({c:w,r:p})]=L),y=b+1,P=c.charCodeAt(y),m.e.c<w&&(m.e.c=w),m.e.r<p&&(m.e.r=p),x==T)++w;else if(w=0,++p,f.sheetRows&&f.sheetRows<=p)return!0}e:for(;b<c.length;++b)switch(x=c.charCodeAt(b)){case 34:P===34&&(E=!E);break;case T:case 10:case 13:if(!E&&O())break e;break}return b-y>0&&O(),g["!ref"]=dt(m),g}function o(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,h):Dp(e(c,h),h)}function a(c,h){var f="",d=h.type=="string"?[0,0,0,0]:ED(c,h);switch(h.type){case"base64":f=oo(c);break;case"binary":f=c;break;case"buffer":h.codepage==65001?f=c.toString("utf8"):h.codepage&&typeof Ht<"u"?f=Ht.utils.decode(h.codepage,c):f=xt&&Buffer.isBuffer(c)?c.toString("binary"):Hh(c);break;case"array":f=_d(c);break;case"string":f=c;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=hr(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=hr(f):h.type=="binary"&&typeof Ht<"u"&&h.codepage&&(f=Ht.utils.decode(h.codepage,Ht.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?NG.to_sheet(h.type=="string"?f:hr(f),h):o(f,h)}function l(c,h){return Lh(a(c,h),h)}function u(c){for(var h=[],f=It(c["!ref"]),d,g=Array.isArray(c),m=f.s.r;m<=f.e.r;++m){for(var p=[],w=f.s.c;w<=f.e.c;++w){var v=nt({r:m,c:w});if(d=g?(c[m]||[])[w]:c[v],!d||d.v==null){p.push("          ");continue}for(var y=(d.w||(Fl(d),d.w)||"").slice(0,10);y.length<10;)y+=" ";p.push(y+(w===0?" ":""))}h.push(p.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}();function Sge(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=OG.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return dp.to_workbook(t,e)}}var ld=function(){function t(W,C,S){if(W){ai(W,W.l||0);for(var _=S.Enum||ye;W.l<W.length;){var D=W.read_shift(2),U=_[D]||_[65535],X=W.read_shift(2),ee=W.l+X,k=U.f&&U.f(W,X,S);if(W.l=ee,C(k,U,D))return}}}function e(W,C){switch(C.type){case"base64":return r(Xs(oo(W)),C);case"binary":return r(Xs(W),C);case"buffer":case"array":return r(W,C)}throw"Unsupported type "+C.type}function r(W,C){if(!W)return W;var S=C||{},_=S.dense?[]:{},D="Sheet1",U="",X=0,ee={},k=[],M=[],R={s:{r:0,c:0},e:{r:0,c:0}},V=S.sheetRows||0;if(W[2]==0&&(W[3]==8||W[3]==9)&&W.length>=16&&W[14]==5&&W[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(W[2]==2)S.Enum=ye,t(W,function(B,te,oe){switch(oe){case 0:S.vers=B,B>=4096&&(S.qpro=!0);break;case 6:R=B;break;case 204:B&&(U=B);break;case 222:U=B;break;case 15:case 51:S.qpro||(B[1].v=B[1].v.slice(1));case 13:case 14:case 16:oe==14&&(B[2]&112)==112&&(B[2]&15)>1&&(B[2]&15)<15&&(B[1].z=S.dateNF||rt[14],S.cellDates&&(B[1].t="d",B[1].v=eR(B[1].v))),S.qpro&&B[3]>X&&(_["!ref"]=dt(R),ee[D]=_,k.push(D),_=S.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},X=B[3],D=U||"Sheet"+(X+1),U="");var ae=S.dense?(_[B[0].r]||[])[B[0].c]:_[nt(B[0])];if(ae){ae.t=B[1].t,ae.v=B[1].v,B[1].z!=null&&(ae.z=B[1].z),B[1].f!=null&&(ae.f=B[1].f);break}S.dense?(_[B[0].r]||(_[B[0].r]=[]),_[B[0].r][B[0].c]=B[1]):_[nt(B[0])]=B[1];break}},S);else if(W[2]==26||W[2]==14)S.Enum=Re,W[2]==14&&(S.qpro=!0,W.l=0),t(W,function(B,te,oe){switch(oe){case 204:D=B;break;case 22:B[1].v=B[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(B[3]>X&&(_["!ref"]=dt(R),ee[D]=_,k.push(D),_=S.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},X=B[3],D="Sheet"+(X+1)),V>0&&B[0].r>=V)break;S.dense?(_[B[0].r]||(_[B[0].r]=[]),_[B[0].r][B[0].c]=B[1]):_[nt(B[0])]=B[1],R.e.c<B[0].c&&(R.e.c=B[0].c),R.e.r<B[0].r&&(R.e.r=B[0].r);break;case 27:B[14e3]&&(M[B[14e3][0]]=B[14e3][1]);break;case 1537:M[B[0]]=B[1],B[0]==X&&(D=B[1]);break}},S);else throw new Error("Unrecognized LOTUS BOF "+W[2]);if(_["!ref"]=dt(R),ee[U||D]=_,k.push(U||D),!M.length)return{SheetNames:k,Sheets:ee};for(var q={},J=[],re=0;re<M.length;++re)ee[k[re]]?(J.push(M[re]||k[re]),q[M[re]]=ee[M[re]]||ee[k[re]]):(J.push(M[re]),q[M[re]]={"!ref":"A1"});return{SheetNames:J,Sheets:q}}function n(W,C){var S=C||{};if(+S.codepage>=0&&$o(+S.codepage),S.type=="string")throw new Error("Cannot write WK1 to JS string");var _=As(),D=It(W["!ref"]),U=Array.isArray(W),X=[];Oe(_,0,s(1030)),Oe(_,6,l(D));for(var ee=Math.min(D.e.r,8191),k=D.s.r;k<=ee;++k)for(var M=sn(k),R=D.s.c;R<=D.e.c;++R){k===D.s.r&&(X[R]=kr(R));var V=X[R]+M,q=U?(W[k]||[])[R]:W[V];if(!(!q||q.t=="z"))if(q.t=="n")(q.v|0)==q.v&&q.v>=-32768&&q.v<=32767?Oe(_,13,d(k,R,q.v)):Oe(_,14,m(k,R,q.v));else{var J=Fl(q);Oe(_,15,h(k,R,J.slice(0,239)))}}return Oe(_,1),_.end()}function i(W,C){var S=C||{};if(+S.codepage>=0&&$o(+S.codepage),S.type=="string")throw new Error("Cannot write WK3 to JS string");var _=As();Oe(_,0,o(W));for(var D=0,U=0;D<W.SheetNames.length;++D)(W.Sheets[W.SheetNames[D]]||{})["!ref"]&&Oe(_,27,Q(W.SheetNames[D],U++));var X=0;for(D=0;D<W.SheetNames.length;++D){var ee=W.Sheets[W.SheetNames[D]];if(!(!ee||!ee["!ref"])){for(var k=It(ee["!ref"]),M=Array.isArray(ee),R=[],V=Math.min(k.e.r,8191),q=k.s.r;q<=V;++q)for(var J=sn(q),re=k.s.c;re<=k.e.c;++re){q===k.s.r&&(R[re]=kr(re));var B=R[re]+J,te=M?(ee[q]||[])[re]:ee[B];if(!(!te||te.t=="z"))if(te.t=="n")Oe(_,23,O(q,re,X,te.v));else{var oe=Fl(te);Oe(_,22,x(q,re,X,oe.slice(0,239)))}}++X}}return Oe(_,1),_.end()}function s(W){var C=ve(2);return C.write_shift(2,W),C}function o(W){var C=ve(26);C.write_shift(2,4096),C.write_shift(2,4),C.write_shift(4,0);for(var S=0,_=0,D=0,U=0;U<W.SheetNames.length;++U){var X=W.SheetNames[U],ee=W.Sheets[X];if(!(!ee||!ee["!ref"])){++D;var k=Zi(ee["!ref"]);S<k.e.r&&(S=k.e.r),_<k.e.c&&(_=k.e.c)}}return S>8191&&(S=8191),C.write_shift(2,S),C.write_shift(1,D),C.write_shift(1,_),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(1,1),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(4,0),C}function a(W,C,S){var _={s:{c:0,r:0},e:{c:0,r:0}};return C==8&&S.qpro?(_.s.c=W.read_shift(1),W.l++,_.s.r=W.read_shift(2),_.e.c=W.read_shift(1),W.l++,_.e.r=W.read_shift(2),_):(_.s.c=W.read_shift(2),_.s.r=W.read_shift(2),C==12&&S.qpro&&(W.l+=2),_.e.c=W.read_shift(2),_.e.r=W.read_shift(2),C==12&&S.qpro&&(W.l+=2),_.s.c==65535&&(_.s.c=_.e.c=_.s.r=_.e.r=0),_)}function l(W){var C=ve(8);return C.write_shift(2,W.s.c),C.write_shift(2,W.s.r),C.write_shift(2,W.e.c),C.write_shift(2,W.e.r),C}function u(W,C,S){var _=[{c:0,r:0},{t:"n",v:0},0,0];return S.qpro&&S.vers!=20768?(_[0].c=W.read_shift(1),_[3]=W.read_shift(1),_[0].r=W.read_shift(2),W.l+=2):(_[2]=W.read_shift(1),_[0].c=W.read_shift(2),_[0].r=W.read_shift(2)),_}function c(W,C,S){var _=W.l+C,D=u(W,C,S);if(D[1].t="s",S.vers==20768){W.l++;var U=W.read_shift(1);return D[1].v=W.read_shift(U,"utf8"),D}return S.qpro&&W.l++,D[1].v=W.read_shift(_-W.l,"cstr"),D}function h(W,C,S){var _=ve(7+S.length);_.write_shift(1,255),_.write_shift(2,C),_.write_shift(2,W),_.write_shift(1,39);for(var D=0;D<_.length;++D){var U=S.charCodeAt(D);_.write_shift(1,U>=128?95:U)}return _.write_shift(1,0),_}function f(W,C,S){var _=u(W,C,S);return _[1].v=W.read_shift(2,"i"),_}function d(W,C,S){var _=ve(7);return _.write_shift(1,255),_.write_shift(2,C),_.write_shift(2,W),_.write_shift(2,S,"i"),_}function g(W,C,S){var _=u(W,C,S);return _[1].v=W.read_shift(8,"f"),_}function m(W,C,S){var _=ve(13);return _.write_shift(1,255),_.write_shift(2,C),_.write_shift(2,W),_.write_shift(8,S,"f"),_}function p(W,C,S){var _=W.l+C,D=u(W,C,S);if(D[1].v=W.read_shift(8,"f"),S.qpro)W.l=_;else{var U=W.read_shift(2);b(W.slice(W.l,W.l+U),D),W.l+=U}return D}function w(W,C,S){var _=C&32768;return C&=-32769,C=(_?W:0)+(C>=8192?C-16384:C),(_?"":"$")+(S?kr(C):sn(C))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(W,C){ai(W,0);for(var S=[],_=0,D="",U="",X="",ee="";W.l<W.length;){var k=W[W.l++];switch(k){case 0:S.push(W.read_shift(8,"f"));break;case 1:U=w(C[0].c,W.read_shift(2),!0),D=w(C[0].r,W.read_shift(2),!1),S.push(U+D);break;case 2:{var M=w(C[0].c,W.read_shift(2),!0),R=w(C[0].r,W.read_shift(2),!1);U=w(C[0].c,W.read_shift(2),!0),D=w(C[0].r,W.read_shift(2),!1),S.push(M+R+":"+U+D)}break;case 3:if(W.l<W.length){console.error("WK1 premature formula end");return}break;case 4:S.push("("+S.pop()+")");break;case 5:S.push(W.read_shift(2));break;case 6:{for(var V="";k=W[W.l++];)V+=String.fromCharCode(k);S.push('"'+V.replace(/"/g,'""')+'"')}break;case 8:S.push("-"+S.pop());break;case 23:S.push("+"+S.pop());break;case 22:S.push("NOT("+S.pop()+")");break;case 20:case 21:ee=S.pop(),X=S.pop(),S.push(["AND","OR"][k-20]+"("+X+","+ee+")");break;default:if(k<32&&y[k])ee=S.pop(),X=S.pop(),S.push(X+y[k]+ee);else if(v[k]){if(_=v[k][1],_==69&&(_=W[W.l++]),_>S.length){console.error("WK1 bad formula parse 0x"+k.toString(16)+":|"+S.join("|")+"|");return}var q=S.slice(-_);S.length-=_,S.push(v[k][0]+"("+q.join(",")+")")}else return k<=7?console.error("WK1 invalid opcode "+k.toString(16)):k<=24?console.error("WK1 unsupported op "+k.toString(16)):k<=30?console.error("WK1 invalid opcode "+k.toString(16)):k<=115?console.error("WK1 unsupported function opcode "+k.toString(16)):console.error("WK1 unrecognized opcode "+k.toString(16))}}S.length==1?C[1].f=""+S[0]:console.error("WK1 bad formula parse |"+S.join("|")+"|")}function T(W){var C=[{c:0,r:0},{t:"n",v:0},0];return C[0].r=W.read_shift(2),C[3]=W[W.l++],C[0].c=W[W.l++],C}function E(W,C){var S=T(W);return S[1].t="s",S[1].v=W.read_shift(C-4,"cstr"),S}function x(W,C,S,_){var D=ve(6+_.length);D.write_shift(2,W),D.write_shift(1,S),D.write_shift(1,C),D.write_shift(1,39);for(var U=0;U<_.length;++U){var X=_.charCodeAt(U);D.write_shift(1,X>=128?95:X)}return D.write_shift(1,0),D}function P(W,C){var S=T(W);S[1].v=W.read_shift(2);var _=S[1].v>>1;if(S[1].v&1)switch(_&7){case 0:_=(_>>3)*5e3;break;case 1:_=(_>>3)*500;break;case 2:_=(_>>3)/20;break;case 3:_=(_>>3)/200;break;case 4:_=(_>>3)/2e3;break;case 5:_=(_>>3)/2e4;break;case 6:_=(_>>3)/16;break;case 7:_=(_>>3)/64;break}return S[1].v=_,S}function A(W,C){var S=T(W),_=W.read_shift(4),D=W.read_shift(4),U=W.read_shift(2);if(U==65535)return _===0&&D===3221225472?(S[1].t="e",S[1].v=15):_===0&&D===3489660928?(S[1].t="e",S[1].v=42):S[1].v=0,S;var X=U&32768;return U=(U&32767)-16446,S[1].v=(1-X*2)*(D*Math.pow(2,U+32)+_*Math.pow(2,U)),S}function O(W,C,S,_){var D=ve(14);if(D.write_shift(2,W),D.write_shift(1,S),D.write_shift(1,C),_==0)return D.write_shift(4,0),D.write_shift(4,0),D.write_shift(2,65535),D;var U=0,X=0,ee=0,k=0;return _<0&&(U=1,_=-_),X=Math.log2(_)|0,_/=Math.pow(2,X-31),k=_>>>0,k&2147483648||(_/=2,++X,k=_>>>0),_-=k,k|=2147483648,k>>>=0,_*=Math.pow(2,32),ee=_>>>0,D.write_shift(4,ee),D.write_shift(4,k),X+=16383+(U?32768:0),D.write_shift(2,X),D}function Y(W,C){var S=A(W);return W.l+=C-14,S}function L(W,C){var S=T(W),_=W.read_shift(4);return S[1].v=_>>6,S}function ie(W,C){var S=T(W),_=W.read_shift(8,"f");return S[1].v=_,S}function ce(W,C){var S=ie(W);return W.l+=C-10,S}function he(W,C){return W[W.l+C-1]==0?W.read_shift(C,"cstr"):""}function Ee(W,C){var S=W[W.l++];S>C-1&&(S=C-1);for(var _="";_.length<S;)_+=String.fromCharCode(W[W.l++]);return _}function Ce(W,C,S){if(!(!S.qpro||C<21)){var _=W.read_shift(1);W.l+=17,W.l+=1,W.l+=2;var D=W.read_shift(C-21,"cstr");return[_,D]}}function ge(W,C){for(var S={},_=W.l+C;W.l<_;){var D=W.read_shift(2);if(D==14e3){for(S[D]=[0,""],S[D][0]=W.read_shift(2);W[W.l];)S[D][1]+=String.fromCharCode(W[W.l]),W.l++;W.l++}}return S}function Q(W,C){var S=ve(5+W.length);S.write_shift(2,14e3),S.write_shift(2,C);for(var _=0;_<W.length;++_){var D=W.charCodeAt(_);S[S.l++]=D>127?95:D}return S[S.l++]=0,S}var ye={0:{n:"BOF",f:Rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},Re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:Y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:ie},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function xge(t){var e={},r=t.match(Di),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=it(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=$N[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var bge=function(){var t=Qw("t"),e=Qw("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var a={t:"s",v:jt(o[1])},l=s.match(e);return l&&(a.s=xge(l[1])),a}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(a){return a.v})}}(),_ge=function(){var e=/(\r\n|\n)/g;function r(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Ege=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Rge=/<(?:\w+:)?r>/,Tge=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hD(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(hr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=hr(t),r&&(n.h=YN(n.t))):t.match(Rge)&&(n.r=hr(t),n.t=jt(hr((t.replace(Tge,"").match(Ege)||[]).join("").replace(Di,""))),r&&(n.h=_ge(bge(n.r)))),n):{t:""}}var kge=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Pge=/<(?:\w+:)?(?:si|sstItem)>/g,Age=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ige(t,e){var r=[],n="";if(!t)return r;var i=t.match(kge);if(i){n=i[2].replace(Pge,"").split(Age);for(var s=0;s!=n.length;++s){var o=hD(n[s].trim(),e);o!=null&&(r[r.length]=o)}i=it(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var Oge=/^\s|\s$|[\t\n\r]/;function DG(t,e){if(!e.bookSST)return"";var r=[pn];r[r.length]=Ie("sst",null,{xmlns:Ud[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Oge)&&(s+=' xml:space="preserve"'),s+=">"+ar(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Mge(t){return[t.read_shift(4),t.read_shift(4)]}function Nge(t,e){var r=[],n=!1;return rc(t,function(s,o,a){switch(a){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function Dge(t,e){return e||(e=ve(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Fge=Ghe;function Hge(t){var e=As();xe(e,159,Dge(t));for(var r=0;r<t.length;++r)xe(e,19,Fge(t[r]));return xe(e,160),e.end()}function FG(t){if(typeof Ht<"u")return Ht.utils.encode(xd,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Fu(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Lge(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Fu(t,4),e.U=Fu(t,4),e.W=Fu(t,4),e}function $ge(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Bge(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push($ge(t));return e}function Vge(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Wge(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Fu(t,4),e.U=Fu(t,4),e.W=Fu(t,4),e}function jge(t){var e=Wge(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function HG(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function LG(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Uge(t){var e=Fu(t);switch(e.Minor){case 2:return[e.Minor,zge(t)];case 3:return[e.Minor,Gge()];case 4:return[e.Minor,Yge(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function zge(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=HG(t,r),i=LG(t,t.length-t.l);return{t:"Std",h:n,v:i}}function Gge(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Yge(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Di,function(s){var o=it(s);switch($l(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Kge(t,e){var r={},n=r.EncryptionVersionInfo=Fu(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=HG(t,i),e-=i,r.EncryptionVerifier=LG(t,e),r}function Xge(t){var e={},r=e.EncryptionVersionInfo=Fu(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function fD(t){var e=0,r,n=FG(t),i=n.length+1,s,o,a,l,u;for(r=Th(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=e&16384?1:0,l=e<<1&32767,u=a|l,e=u^o;return e^52811}var $G=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,a){return n(o^a)},s=function(o){for(var a=e[o.length-1],l=104,u=o.length-1;u>=0;--u)for(var c=o[u],h=0;h!=7;++h)c&64&&(a^=r[l]),c*=2,--l;return a};return function(o){for(var a=FG(o),l=s(a),u=a.length,c=Th(16),h=0;h!=16;++h)c[h]=0;var f,d,g;for((u&1)===1&&(f=l>>8,c[u]=i(t[0],f),--u,f=l&255,d=a[a.length-1],c[u]=i(d,f));u>0;)--u,f=l>>8,c[u]=i(a[u],f),--u,f=l&255,c[u]=i(a[u],f);for(u=15,g=15-a.length;g>0;)f=l>>8,c[u]=i(t[g],f),--u,--g,f=l&255,c[u]=i(a[u],f),--u,--g;return c}}(),qge=function(t,e,r,n,i){i||(i=e),n||(n=$G(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Jge=function(t){var e=0,r=$G(t);return function(n){var i=qge("",n,e,r);return e=i[1],i[0]}};function Qge(t,e,r,n){var i={key:Rn(t),verificationBytes:Rn(t)};return r.password&&(i.verifier=fD(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Jge(r.password)),i}function Zge(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Xge(t):n.Data=Kge(t,e),n}function eme(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Zge(t,e-2,n):Qge(t,r.biff>=8?e:e-2,r,n),n}var BG=function(){function t(i,s){switch(s.type){case"base64":return e(oo(i),s);case"binary":return e(i,s);case"buffer":return e(xt&&Buffer.isBuffer(i)?i.toString("binary"):Hh(i),s);case"array":return e(_d(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(a)&&(a[h]=[]);for(var f=/\\\w+\b/g,d=0,g,m=-1;g=f.exec(c);){switch(g[0]){case"\\cell":var p=c.slice(d,f.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++m,p.length){var w={v:p,t:"s"};Array.isArray(a)?a[h][m]=w:a[nt({r:h,c:m})]=w}break}d=f.lastIndex}m>u.e.c&&(u.e.c=m)}),a["!ref"]=dt(u),a}function r(i,s){return Lh(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=It(i["!ref"]),a,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var c=o.s.c;c<=o.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=o.s.c;c<=o.e.c;++c){var h=nt({r:u,c});a=l?(i[u]||[])[c]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(Fl(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function tme(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function ry(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function rme(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),o=i-s;if(o===0)return[0,0,e];var a=0,l=0,u=i+s;switch(l=o/(u>1?2-u:u),i){case e:a=((r-n)/o+6)%6;break;case r:a=(n-e)/o+2;break;case n:a=(e-r)/o+4;break}return[a/6,l,u/2]}function nme(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],a=6*e,l;if(r!==0)switch(a|0){case 0:case 6:l=i*a,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-a),o[0]+=l,o[1]+=i;break;case 2:l=i*(a-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-a),o[1]+=l,o[2]+=i;break;case 4:l=i*(a-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-a),o[2]+=l,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function t_(t,e){if(e===0)return t;var r=rme(tme(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),ry(nme(r))}var VG=6,ime=15,sme=1,Ei=VG;function ny(t){return Math.floor((t+Math.round(128/Ei)/256)*Ei)}function iy(t){return Math.floor((t-5)/Ei*100+.5)/100}function r_(t){return Math.round((t*Ei+5)/Ei*256)/256}function sk(t){return r_(iy(ny(t)))}function dD(t){var e=Math.abs(t-sk(t)),r=Ei;if(e>.005)for(Ei=sme;Ei<ime;++Ei)Math.abs(t-sk(t))<=e&&(e=Math.abs(t-sk(t)),r=Ei);Ei=r}function kh(t){t.width?(t.wpx=ny(t.width),t.wch=iy(t.wpx),t.MDW=Ei):t.wpx?(t.wch=iy(t.wpx),t.width=r_(t.wch),t.MDW=Ei):typeof t.wch=="number"&&(t.width=r_(t.wch),t.wpx=ny(t.width),t.MDW=Ei),t.customWidth&&delete t.customWidth}var ome=96,WG=ome;function sy(t){return t*96/WG}function gp(t){return t*WG/96}var ame={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lme(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Di)||[]).forEach(function(o){var a=it(o);switch($l(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=Rr(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=Rr(a.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function ume(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Di)||[]).forEach(function(o){var a=it(o);switch($l(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function cme(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Di)||[]).forEach(function(o){var a=it(o);switch($l(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=hr(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?Rr(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?Rr(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?Rr(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?Rr(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?Rr(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?Rr(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?Rr(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=$N[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=Rr(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=od[i.color.index];i.color.index==81&&(l=od[1]),l||(l=od[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=t_(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function hme(t,e,r){e.NumberFmt=[];for(var n=ln(rt),i=0;i<n.length;++i)e.NumberFmt[n[i]]=rt[n[i]];var s=t[0].match(Di);if(s)for(i=0;i<s.length;++i){var o=it(s[i]);switch($l(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=jt(hr(o.formatCode)),l=parseInt(o.numFmtId,10);if(e.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=a}Ml(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function fme(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ie("numFmt",null,{numFmtId:n,formatCode:ar(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ie("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var gC=["numFmtId","fillId","fontId","borderId","xfId"],mC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function dme(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Di)||[]).forEach(function(s){var o=it(s),a=0;switch($l(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<gC.length;++a)n[gC[a]]&&(n[gC[a]]=parseInt(n[gC[a]],10));for(a=0;a<mC.length;++a)n[mC[a]]&&(n[mC[a]]=Rr(n[mC[a]]));if(e.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[a]){n.numFmtId=a;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Rr(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function gme(t){var e=[];return e[e.length]=Ie("cellXfs",null),t.forEach(function(r){e[e.length]=Ie("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ie("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var mme=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,u){var c={};if(!a)return c;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=a.match(e))&&hme(h,c,u),(h=a.match(i))&&cme(h,c,l,u),(h=a.match(n))&&ume(h,c,l,u),(h=a.match(s))&&lme(h,c,l,u),(h=a.match(r))&&dme(h,c,u),c}}();function jG(t,e){var r=[pn,Ie("styleSheet",null,{xmlns:Ud[0],"xmlns:vt":Bn.vt})],n;return t.SSF&&(n=fme(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=gme(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function pme(t,e){var r=t.read_shift(2),n=Ii(t);return[r,n]}function vme(t,e,r){r||(r=ve(6+4*e.length)),r.write_shift(2,t),Qn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function wme(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Zhe(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var a=t.read_shift(1);a>0&&(n.family=a);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Qhe(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ii(t),n}function yme(t,e){e||(e=ve(25+4*32)),e.write_shift(2,t.sz*20),efe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Qb(t.color,e);var n=0;return n=2,e.write_shift(1,n),Qn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Cme=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ok,Sme=Ni;function kB(t,e){e||(e=ve(4*3+8*7+16*1)),ok||(ok=QE(Cme));var r=ok[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Qb({auto:1},e),Qb({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function xme(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function UG(t,e,r){r||(r=ve(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function c0(t,e){return e||(e=ve(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var bme=Ni;function _me(t,e){return e||(e=ve(51)),e.write_shift(1,0),c0(null,e),c0(null,e),c0(null,e),c0(null,e),c0(null,e),e.length>e.l?e.slice(0,e.l):e}function Eme(t,e){return e||(e=ve(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Jb(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Rme(t,e,r){var n=ve(2052);return n.write_shift(4,t),Jb(e,n),Jb(r,n),n.length>n.l?n.slice(0,n.l):n}function Tme(t,e,r){var n={};n.NumberFmt=[];for(var i in rt)n.NumberFmt[i]=rt[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return rc(t,function(l,u,c){switch(c){case 44:n.NumberFmt[l[0]]=l[1],Ml(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=t_(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(c),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(c);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function kme(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(xe(t,615,Oa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&xe(t,44,vme(i,e[i]))}),xe(t,616))}}function Pme(t){var e=1;xe(t,611,Oa(e)),xe(t,43,yme({sz:12,color:{theme:1},name:"Calibri",family:2})),xe(t,612)}function Ame(t){var e=2;xe(t,603,Oa(e)),xe(t,45,kB({patternType:"none"})),xe(t,45,kB({patternType:"gray125"})),xe(t,604)}function Ime(t){var e=1;xe(t,613,Oa(e)),xe(t,46,_me()),xe(t,614)}function Ome(t){var e=1;xe(t,626,Oa(e)),xe(t,47,UG({numFmtId:0},65535)),xe(t,627)}function Mme(t,e){xe(t,617,Oa(e.length)),e.forEach(function(r){xe(t,47,UG(r,0))}),xe(t,618)}function Nme(t){var e=1;xe(t,619,Oa(e)),xe(t,48,Eme({xfId:0,name:"Normal"})),xe(t,620)}function Dme(t){var e=0;xe(t,505,Oa(e)),xe(t,506)}function Fme(t){var e=0;xe(t,508,Rme(e,"TableStyleMedium9","PivotStyleMedium4")),xe(t,509)}function Hme(t,e){var r=As();return xe(r,278),kme(r,t.SSF),Pme(r),Ame(r),Ime(r),Ome(r),Mme(r,e.cellXfs),Nme(r),Dme(r),Fme(r),xe(r,279),r.end()}var Lme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $me(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Di)||[]).forEach(function(i){var s=it(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Lme.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Bme(){}function Vme(){}var Wme=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jme=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ume=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function zme(t,e,r){e.themeElements={};var n;[["clrScheme",Wme,$me],["fontScheme",jme,Bme],["fmtScheme",Ume,Vme]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var Gme=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function zG(t,e){(!t||t.length===0)&&(t=gD());var r,n={};if(!(r=t.match(Gme)))throw new Error("themeElements not found in theme");return zme(r[0],n,e),n.raw=t,n}function gD(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[pn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Yme(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=V9(s,{type:"array"})}catch{return}var a=qs(o,"theme/theme/theme1.xml",!0);if(a)return zG(a,r)}}function Kme(t){return t.read_shift(4)}function Xme(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=qme(t,4);break;case 2:e.xclrValue=_G(t);break;case 3:e.xclrValue=Kme(t);break;case 4:t.l+=4;break}return t.l+=8,e}function qme(t,e){return Ni(t,e)}function Jme(t,e){return Ni(t,e)}function Qme(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Xme(t);break;case 6:n[1]=Jme(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Zme(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(Qme(t,r-t.l));return{ixfe:n,ext:s}}function epe(t,e){e.forEach(function(r){switch(r[0]){}})}function tpe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ii(t)}}function rpe(t){var e=ve(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Qn(t.name,e),e.slice(0,e.l)}function npe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function ipe(t){var e=ve(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function spe(t,e){var r=ve(8+2*e.length);return r.write_shift(4,t),Qn(e,r),r.slice(0,r.l)}function ope(t){return t.l+=4,t.read_shift(4)!=0}function ape(t,e){var r=ve(8);return r.write_shift(4,t),r.write_shift(4,1),r}function lpe(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return rc(t,function(l,u,c){switch(c){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){a==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):a==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:s.push(c),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function upe(){var t=As();return xe(t,332),xe(t,334,Oa(1)),xe(t,335,rpe({name:"XLDAPR",version:12e4,flags:3496657072})),xe(t,336),xe(t,339,spe(1,"XLDAPR")),xe(t,52),xe(t,35,Oa(514)),xe(t,4096,Oa(0)),xe(t,4097,Ro(1)),xe(t,36),xe(t,53),xe(t,340),xe(t,337,ape(1)),xe(t,51,ipe([[1,0]])),xe(t,338),xe(t,333),t.end()}function cpe(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,o;return t.replace(Di,function(a){var l=it(a);switch($l(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),n}function GG(){var t=[pn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function hpe(t){var e=[];if(!t)return e;var r=1;return(t.match(Di)||[]).forEach(function(n){var i=it(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function fpe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=nt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function dpe(t,e,r){var n=[];return rc(t,function(s,o,a){switch(a){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function gpe(t,e,r,n){if(!t)return t;var i=n||{},s=!1;rc(t,function(a,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function mpe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Tm=1024;function YG(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ie("xml",null,{"xmlns:v":Ks.v,"xmlns:o":Ks.o,"xmlns:x":Ks.x,"xmlns:mv":Ks.mv}).replace(/\/>/,">"),Ie("o:shapelayout",Ie("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ie("v:shapetype",[Ie("v:stroke",null,{joinstyle:"miter"}),Ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Tm<t*1e3;)Tm+=1e3;return e.forEach(function(s){var o=zr(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?Ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ie("v:fill",l,a),c={on:"t",obscured:"t"};++Tm,i=i.concat(["<v:shape"+Zw({id:"_x0000_s"+Tm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ie("v:shadow",null,c),Ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",li("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),li("x:AutoFill","False"),li("x:Row",String(o.r)),li("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function PB(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(o){var a=zr(o.ref);if(i?(t[a.r]||(t[a.r]=[]),s=t[a.r][a.c]):s=t[o.ref],!s){s={t:"z"},i?t[a.r][a.c]=s:t[o.ref]=s;var l=It(t["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var u=dt(l);u!==t["!ref"]&&(t["!ref"]=u)}s.c||(s.c=[]);var c={a:o.author,t:o.t,r:o.r,T:r};o.h&&(c.h=o.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(c.a==n[h].id){c.a=n[h].name||c.a;break}}s.c.push(c)})}function ppe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=it(a[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},c=zr(l.ref);if(!(e.sheetRows&&e.sheetRows<=c.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&hD(h[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=f.h),n.push(u)}}}}),n}function KG(t){var e=[pn,Ie("comments",null,{xmlns:Ud[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=ar(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(ar(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(li("t",ar(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(li("t",ar(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function vpe(t,e){var r=[],n=!1,i={},s=0;return t.replace(Di,function(a,l){var u=it(a);switch($l(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+a.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return a}),r}function wpe(t,e,r){var n=[pn,Ie("ThreadedComments",null,{xmlns:Bn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ie("threadedComment",li("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function ype(t,e){var r=[],n=!1;return t.replace(Di,function(s){var o=it(s);switch($l(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function Cpe(t){var e=[pn,Ie("personList",null,{xmlns:Bn.TCMNT,"xmlns:x":Ud[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ie("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Spe(t){var e={};e.iauthor=t.read_shift(4);var r=Kd(t);return e.rfx=r.s,e.ref=nt(r.s),t.l+=16,e}function xpe(t,e){return e==null&&(e=ve(36)),e.write_shift(4,t[1].iauthor),Fp(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var bpe=Ii;function _pe(t){return Qn(t.slice(0,54))}function Epe(t,e){var r=[],n=[],i={},s=!1;return rc(t,function(a,l,u){switch(u){case 632:n.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function Rpe(t){var e=As(),r=[];return xe(e,628),xe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),xe(e,632,_pe(i.a)))})}),xe(e,631),xe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:zr(n[0]),e:zr(n[0])};xe(e,635,xpe([s,i])),i.t&&i.t.length>0&&xe(e,637,Khe(i)),xe(e,636),delete i.iauthor})}),xe(e,634),xe(e,629),e.end()}var Tpe="application/vnd.ms-office.vbaProject";function kpe(t){var e=Xe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Xe.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Xe.write(e)}function Ppe(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var XG=["xlsb","xlsm","xlam","biff8","xla"];function Ape(){return{"!type":"dialog"}}function Ipe(){return{"!type":"dialog"}}function Ope(){return{"!type":"macro"}}function Mpe(){return{"!type":"macro"}}var Um=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,c=o.length>0?parseInt(o,10)|0:0;return a?c+=e.c:--c,l?u+=e.r:--u,i+(a?"":"$")+kr(c)+(l?"":"$")+sn(u)}return function(i,s){return e=s,i.replace(t,r)}}(),mD=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,pD=function(){return function(e,r){return e.replace(mD,function(n,i,s,o,a,l){var u=rD(o)-(s?0:r.c),c=tD(l)-(a?0:r.r),h=c==0?"":a?c+1:"["+c+"]",f=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+f})}}();function qG(t,e){return t.replace(mD,function(r,n,i,s,o,a){return n+(i=="$"?i+s:kr(rD(s)+e.c))+(o=="$"?o+a:sn(tD(a)+e.r))})}function Npe(t,e,r){var n=Zi(e),i=n.s,s=zr(r),o={r:s.r-i.r,c:s.c-i.c};return qG(t,o)}function Dpe(t){return t.length!=1}function AB(t){return t.replace(/_xlfn\./g,"")}function xn(t){t.l+=1}function Ph(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function JG(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return QG(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),o=Ph(t),a=Ph(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function QG(t){var e=Ph(t),r=Ph(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Fpe(t,e,r){if(r.biff<8)return QG(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Ph(t),o=Ph(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function ZG(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Hpe(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Ph(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function Hpe(t){var e=Ph(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Lpe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $pe(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Bpe(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function Bpe(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function Vpe(t,e,r){var n=(t[t.l++]&96)>>5,i=JG(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Wpe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=JG(t,s,r);return[n,i,o]}function jpe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Upe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function zpe(t,e,r){var n=(t[t.l++]&96)>>5,i=Fpe(t,e-1,r);return[n,i]}function Gpe(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function IB(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function Ype(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Kpe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Xpe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function qpe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Jpe(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function eY(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Qpe(t){return t.read_shift(2),eY(t)}function Zpe(t){return t.read_shift(2),eY(t)}function e0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=ZG(t,0,r);return[n,i]}function t0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=$pe(t,0,r);return[n,i]}function r0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=ZG(t,0,r);return[n,i,s]}function n0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[ove[i],nY[i],n]}function i0e(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:s0e(t);return[i,(s[0]===0?nY:sve)[s[1]]]}function s0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function o0e(t,e,r){t.l+=r&&r.biff==2?3:4}function a0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function l0e(t){return t.l++,nc[t.read_shift(1)]}function u0e(t){return t.l++,t.read_shift(2)}function c0e(t){return t.l++,t.read_shift(1)!==0}function h0e(t){return t.l++,ki(t)}function f0e(t,e,r){return t.l++,Qy(t,e-1,r)}function d0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=nc[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=ki(t);break;case 2:r[1]=Xd(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function g0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Kd:rR)(t));return i}function m0e(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=d0e(t,r.biff);return o}function p0e(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function v0e(t,e,r){if(r.biff==5)return w0e(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function w0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function y0e(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function C0e(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function S0e(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function x0e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var b0e=Ni,_0e=Ni,E0e=Ni;function e1(t,e,r){return t.l+=2,[Lpe(t)]}function vD(t){return t.l+=6,[]}var R0e=e1,T0e=vD,k0e=vD,P0e=e1;function tY(t){return t.l+=2,[Rn(t),t.read_shift(2)&1]}var A0e=e1,I0e=tY,O0e=vD,M0e=e1,N0e=e1,D0e=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function F0e(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=D0e[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:s}}function H0e(t){return t.l+=2,[t.read_shift(4)]}function L0e(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function $0e(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function B0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function V0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function W0e(t){return t.l+=4,[0,0]}var OB={1:{n:"PtgExp",f:a0e},2:{n:"PtgTbl",f:E0e},3:{n:"PtgAdd",f:xn},4:{n:"PtgSub",f:xn},5:{n:"PtgMul",f:xn},6:{n:"PtgDiv",f:xn},7:{n:"PtgPower",f:xn},8:{n:"PtgConcat",f:xn},9:{n:"PtgLt",f:xn},10:{n:"PtgLe",f:xn},11:{n:"PtgEq",f:xn},12:{n:"PtgGe",f:xn},13:{n:"PtgGt",f:xn},14:{n:"PtgNe",f:xn},15:{n:"PtgIsect",f:xn},16:{n:"PtgUnion",f:xn},17:{n:"PtgRange",f:xn},18:{n:"PtgUplus",f:xn},19:{n:"PtgUminus",f:xn},20:{n:"PtgPercent",f:xn},21:{n:"PtgParen",f:xn},22:{n:"PtgMissArg",f:xn},23:{n:"PtgStr",f:f0e},26:{n:"PtgSheet",f:L0e},27:{n:"PtgEndSheet",f:$0e},28:{n:"PtgErr",f:l0e},29:{n:"PtgBool",f:c0e},30:{n:"PtgInt",f:u0e},31:{n:"PtgNum",f:h0e},32:{n:"PtgArray",f:Gpe},33:{n:"PtgFunc",f:n0e},34:{n:"PtgFuncVar",f:i0e},35:{n:"PtgName",f:p0e},36:{n:"PtgRef",f:e0e},37:{n:"PtgArea",f:Vpe},38:{n:"PtgMemArea",f:y0e},39:{n:"PtgMemErr",f:b0e},40:{n:"PtgMemNoMem",f:_0e},41:{n:"PtgMemFunc",f:C0e},42:{n:"PtgRefErr",f:S0e},43:{n:"PtgAreaErr",f:jpe},44:{n:"PtgRefN",f:t0e},45:{n:"PtgAreaN",f:zpe},46:{n:"PtgMemAreaN",f:B0e},47:{n:"PtgMemNoMemN",f:V0e},57:{n:"PtgNameX",f:v0e},58:{n:"PtgRef3d",f:r0e},59:{n:"PtgArea3d",f:Wpe},60:{n:"PtgRefErr3d",f:x0e},61:{n:"PtgAreaErr3d",f:Upe},255:{}},j0e={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},U0e={1:{n:"PtgElfLel",f:tY},2:{n:"PtgElfRw",f:M0e},3:{n:"PtgElfCol",f:R0e},6:{n:"PtgElfRwV",f:N0e},7:{n:"PtgElfColV",f:P0e},10:{n:"PtgElfRadical",f:A0e},11:{n:"PtgElfRadicalS",f:O0e},13:{n:"PtgElfColS",f:T0e},15:{n:"PtgElfColSV",f:k0e},16:{n:"PtgElfRadicalLel",f:I0e},25:{n:"PtgList",f:F0e},29:{n:"PtgSxName",f:H0e},255:{}},z0e={0:{n:"PtgAttrNoop",f:W0e},1:{n:"PtgAttrSemi",f:Jpe},2:{n:"PtgAttrIf",f:Xpe},4:{n:"PtgAttrChoose",f:Ype},8:{n:"PtgAttrGoto",f:Kpe},16:{n:"PtgAttrSum",f:o0e},32:{n:"PtgAttrBaxcel",f:IB},33:{n:"PtgAttrBaxcel",f:IB},64:{n:"PtgAttrSpace",f:Qpe},65:{n:"PtgAttrSpaceSemi",f:Zpe},128:{n:"PtgAttrIfError",f:qpe},255:{}};function t1(t,e,r,n){if(n.biff<8)return Ni(t,e);for(var i=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=m0e(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=g0e(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&s.push(Ni(t,e)),s}function r1(t,e,r){for(var n=t.l+e,i,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],i=OB[s]||OB[j0e[s]],(s===24||s===25)&&(i=(s===24?U0e:z0e)[t[t.l+1]]),!i||!i.f?Ni(t,e):o.push([i.n,i.f(t,e,r)]);return o}function G0e(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Y0e={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function K0e(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function rY(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function MB(t,e,r){var n=rY(t,e,r);return n=="#REF"?n:K0e(n,r)}function bi(t,e,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,u,c,h=0,f=0,d,g="";if(!t[0]||!t[0][0])return"";for(var m=-1,p="",w=0,v=t[0].length;w<v;++w){var y=t[0][w];switch(y[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),m>=0){switch(t[0][m][1][0]){case 0:p=nn(" ",t[0][m][1][1]);break;case 1:p=nn("\r",t[0][m][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}u=u+p,m=-1}a.push(u+Y0e[y[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=zv(y[1][1],o,i),a.push(Gv(c,s));break;case"PtgRefN":c=r?zv(y[1][1],r,i):y[1][1],a.push(Gv(c,s));break;case"PtgRef3d":h=y[1][1],c=zv(y[1][2],o,i),g=MB(n,h,i),a.push(g+"!"+Gv(c,s));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],T=y[1][1];b||(b=0),b&=127;var E=b==0?[]:a.slice(-b);a.length-=b,T==="User"&&(T=E.shift()),a.push(T+"("+E.join(",")+")");break;case"PtgBool":a.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(y[1]);break;case"PtgNum":a.push(String(y[1]));break;case"PtgStr":a.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(y[1]);break;case"PtgAreaN":d=lB(y[1][1],r?{s:r}:o,i),a.push(rk(d,i));break;case"PtgArea":d=lB(y[1][1],o,i),a.push(rk(d,i));break;case"PtgArea3d":h=y[1][1],d=y[1][2],g=MB(n,h,i),a.push(g+"!"+rk(d,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var x=(n.names||[])[f-1]||(n[0]||[])[f],P=x?x.Name:"SH33TJSNAME"+String(f);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),a.push(P);break;case"PtgNameX":var A=y[1][1];f=y[1][2];var O;if(i.biff<=5)A<0&&(A=-A),n[A]&&(O=n[A][f]);else{var Y="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][f]&&n[A][f].itab>0&&(Y=n.SheetNames[n[A][f].itab-1]+"!"):Y=n.SheetNames[f-1]+"!"),n[A]&&n[A][f])Y+=n[A][f].Name;else if(n[0]&&n[0][f])Y+=n[0][f].Name;else{var L=(rY(n,A,i)||"").split(";;");L[f-1]?Y=L[f-1]:Y+="SH33TJSERRX"}a.push(Y);break}O||(O={Name:"SH33TJSERRY"}),a.push(O.Name);break;case"PtgParen":var ie="(",ce=")";if(m>=0){switch(p="",t[0][m][1][0]){case 2:ie=nn(" ",t[0][m][1][1])+ie;break;case 3:ie=nn("\r",t[0][m][1][1])+ie;break;case 4:ce=nn(" ",t[0][m][1][1])+ce;break;case 5:ce=nn("\r",t[0][m][1][1])+ce;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}a.push(ie+a.pop()+ce);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":c={c:y[1][1],r:y[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[nt(c)]){var Ee=n.sharedf[nt(c)];a.push(bi(Ee,o,he,n,i))}else{var Ce=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){a.push(bi(u[1],o,he,n,i)),Ce=!0;break}Ce||a.push(y[1])}break;case"PtgArray":a.push("{"+G0e(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&ge.indexOf(t[0][w][0])==-1){y=t[0][m];var Q=!0;switch(y[1][0]){case 4:Q=!1;case 0:p=nn(" ",y[1][1]);break;case 5:Q=!1;case 1:p=nn("\r",y[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}a.push((Q?p:"")+a.pop()+(Q?"":p)),m=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function X0e(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],Ni(t,e-2)];var a=r1(t,o,r);return e!==o+i&&(s=t1(t,e-o-i,a,r)),t.l=n,[a,s]}function q0e(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],Ni(t,e-2)];var a=r1(t,o,r);return e!==o+i&&(s=t1(t,e-o-i,a,r)),t.l=n,[a,s]}function J0e(t,e,r,n){var i=t.l+e,s=r1(t,n,r),o;return i!==t.l&&(o=t1(t,i-t.l,s,r)),[s,o]}function Q0e(t,e,r){var n=t.l+e,i,s=t.read_shift(2),o=r1(t,s,r);return s==65535?[[],Ni(t,e-2)]:(e!==s+2&&(i=t1(t,n-s-2,o,r)),[o,i])}function Z0e(t){var e;if(_u(t,t.l+6)!==65535)return[ki(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function eve(t){if(t==null){var e=ve(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ed(t);return Ed(0)}function ak(t,e,r){var n=t.l+e,i=Bl(t);r.biff==2&&++t.l;var s=Z0e(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var a=q0e(t,n-t.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function tve(t,e,r,n,i){var s=Td(e,r,i),o=eve(t.v),a=ve(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var u=ve(t.bf.length),c=0;c<t.bf.length;++c)u[c]=t.bf[c];var h=Jn([s,o,a,u]);return h}function nR(t,e,r){var n=t.read_shift(4),i=r1(t,n,r),s=t.read_shift(4),o=s>0?t1(t,s,i,r):null;return[i,o]}var rve=nR,iR=nR,nve=nR,ive=nR,sve={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},nY={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ove={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function NB(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function ave(t){var e="of:="+t.replace(mD,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function lk(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function lve(t){return t.replace(/\./,"!")}var Kv={},zm={},Xv=typeof Map<"u";function wD(t,e,r){var n=0,i=t.length;if(r){if(Xv?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Xv?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Xv?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function sR(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ei=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=iy(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=r_(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function ud(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function $h(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ml(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function iY(t,e,r,n,i,s){try{n.cellNF&&(t.z=rt[e])}catch(a){if(n.WTF)throw a}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Pr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(rt[e]==null&&Ml(ihe[e]||"General",e),t.t==="e")t.w=t.w||nc[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Jw(t.v);else if(t.t==="d"){var o=jn(t.v);(o|0)===o?t.w=o.toString(10):t.w=Jw(o)}else{if(t.v===void 0)return"";t.w=bd(t.v,zm)}else t.t==="d"?t.w=ao(e,jn(t.v),zm):t.w=ao(e,t.v,zm)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=t_(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=t_(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}function uve(t,e,r){if(t&&t["!ref"]){var n=It(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function cve(t,e){var r=It(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=dt(r))}var hve=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fve=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dve=/<(?:\w:)?hyperlink [^>]*>/mg,gve=/"(\w*:\w*)"/,mve=/<(?:\w:)?col\b[^>]*[\/]?>/g,pve=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vve=/<(?:\w:)?pageMargins[^>]*\/>/g,sY=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wve=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yve=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Cve(t,e,r,n,i,s,o){if(!t)return t;n||(n={"!id":{}});var a=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",c="",h=t.match(fve);h?(u=t.slice(0,h.index),c=t.slice(h.index+h[0].length)):u=c=t;var f=u.match(sY);f?yD(f[0],a,i,r):(f=u.match(wve))&&xve(f[0],f[1]||"",a,i,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var g=u.slice(d,d+50).match(gve);g&&cve(a,g[1])}var m=u.match(yve);m&&m[1]&&Dve(m[1],i);var p=[];if(e.cellStyles){var w=u.match(mve);w&&Ave(p,w)}h&&Lve(h[1],a,e,l,s,o);var v=c.match(pve);v&&(a["!autofilter"]=Ove(v[0]));var y=[],b=c.match(hve);if(b)for(d=0;d!=b.length;++d)y[d]=It(b[d].slice(b[d].indexOf('"')+1));var T=c.match(dve);T&&Tve(a,T,n);var E=c.match(vve);if(E&&(a["!margins"]=kve(it(E[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=dt(l)),e.sheetRows>0&&a["!ref"]){var x=It(a["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),a["!fullref"]=a["!ref"],a["!ref"]=dt(x))}return p.length>0&&(a["!cols"]=p),y.length>0&&(a["!merges"]=y),a}function Sve(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+dt(t[r])+'"/>';return e+"</mergeCells>"}function yD(t,e,r,n){var i=it(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=jt(hr(i.codeName)))}function xve(t,e,r,n,i){yD(t.slice(0,t.indexOf(">")),r,n,i)}function bve(t,e,r,n,i){var s=!1,o={},a=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,o.codeName=Pl(ar(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),a=(a||"")+Ie("outlinePr",null,u)}!s&&!a||(i[i.length]=Ie("sheetPr",a,o))}var _ve=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Eve=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Rve(t){var e={sheet:1};return _ve.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Eve.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=fD(t.password).toString(16).toUpperCase()),Ie("sheetProtection",null,e)}function Tve(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=it(hr(e[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+jt(s.location))):(s.Target="#"+jt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=It(s.ref),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var c=nt({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=s):(t[c]||(t[c]={t:"z",v:void 0}),t[c].l=s)}}}function kve(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Pve(t){return ud(t),Ie("pageMargins",null,t)}function Ave(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=it(e[n],!0);i.hidden&&(i.hidden=Rr(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,dD(i.width)),kh(i);s<=o;)t[s++]=vr(i)}}function Ive(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ie("col",null,sR(i,n)));return r[r.length]="</cols>",r.join("")}function Ove(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Mve(t,e,r,n){var i=typeof t.ref=="string"?t.ref:dt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Zi(i);o.s.r==o.e.r&&(o.e.r=Zi(e["!ref"]).e.r,i=dt(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ie("autoFilter",null,{ref:i})}var Nve=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Dve(t,e){e.Views||(e.Views=[{}]),(t.match(Nve)||[]).forEach(function(r,n){var i=it(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Rr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function Fve(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ie("sheetViews",Ie("sheetView",null,i),{})}function Hve(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=nc[t.v];break;case"d":n&&n.cellDates?i=Pr(t.v,-1).toISOString():(t=vr(t),t.t="n",i=""+(t.v=jn(Pr(t.v)))),typeof t.z>"u"&&(t.z=rt[14]);break;default:i=t.v;break}var a=li("v",ar(i)),l={r:e},u=$h(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=li("v",""+wD(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var c=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=Ie("f",ar(t.f),c)+(t.v!=null?a:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Ie("c",a,l)}var Lve=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Qw("v"),o=Qw("f");return function(l,u,c,h,f,d){for(var g=0,m="",p=[],w=[],v=0,y=0,b=0,T="",E,x,P=0,A=0,O,Y,L=0,ie=0,ce=Array.isArray(d.CellXf),he,Ee=[],Ce=[],ge=Array.isArray(u),Q=[],ye={},Re=!1,W=!!c.sheetStubs,C=l.split(e),S=0,_=C.length;S!=_;++S){m=C[S].trim();var D=m.length;if(D!==0){var U=0;e:for(g=0;g<D;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(c&&c.cellStyles){if(x=it(m.slice(U,g),!0),P=x.r!=null?parseInt(x.r,10):P+1,A=-1,c.sheetRows&&c.sheetRows<P)continue;ye={},Re=!1,x.ht&&(Re=!0,ye.hpt=parseFloat(x.ht),ye.hpx=gp(ye.hpt)),x.hidden=="1"&&(Re=!0,ye.hidden=!0),x.outlineLevel!=null&&(Re=!0,ye.level=+x.outlineLevel),Re&&(Q[P-1]=ye)}break;case"<":U=g;break}if(U>=g)break;if(x=it(m.slice(U,g),!0),P=x.r!=null?parseInt(x.r,10):P+1,A=-1,!(c.sheetRows&&c.sheetRows<P)){h.s.r>P-1&&(h.s.r=P-1),h.e.r<P-1&&(h.e.r=P-1),c&&c.cellStyles&&(ye={},Re=!1,x.ht&&(Re=!0,ye.hpt=parseFloat(x.ht),ye.hpx=gp(ye.hpt)),x.hidden=="1"&&(Re=!0,ye.hidden=!0),x.outlineLevel!=null&&(Re=!0,ye.level=+x.outlineLevel),Re&&(Q[P-1]=ye)),p=m.slice(g).split(t);for(var X=0;X!=p.length&&p[X].trim().charAt(0)=="<";++X);for(p=p.slice(X),g=0;g!=p.length;++g)if(m=p[g].trim(),m.length!==0){if(w=m.match(r),v=g,y=0,b=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,w!=null&&w.length===2){for(v=0,T=w[1],y=0;y!=T.length&&!((b=T.charCodeAt(y)-64)<1||b>26);++y)v=26*v+b;--v,A=v}else++A;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,x=it(m.slice(0,y),!0),x.r||(x.r=nt({r:P-1,c:A})),T=m.slice(y),E={t:""},(w=T.match(s))!=null&&w[1]!==""&&(E.v=jt(w[1])),c.cellFormula){if((w=T.match(o))!=null&&w[1]!==""){if(E.f=jt(hr(w[1])).replace(/\r\n/g,`
`),c.xlfn||(E.f=AB(E.f)),w[0].indexOf('t="array"')>-1)E.F=(T.match(i)||[])[1],E.F.indexOf(":")>-1&&Ee.push([It(E.F),E.F]);else if(w[0].indexOf('t="shared"')>-1){Y=it(w[0]);var ee=jt(hr(w[1]));c.xlfn||(ee=AB(ee)),Ce[parseInt(Y.si,10)]=[Y,ee,x.r]}}else(w=T.match(/<f[^>]*\/>/))&&(Y=it(w[0]),Ce[Y.si]&&(E.f=Npe(Ce[Y.si][1],Ce[Y.si][2],x.r)));var k=zr(x.r);for(y=0;y<Ee.length;++y)k.r>=Ee[y][0].s.r&&k.r<=Ee[y][0].e.r&&k.c>=Ee[y][0].s.c&&k.c<=Ee[y][0].e.c&&(E.F=Ee[y][1])}if(x.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(W)E.t="z";else continue;else E.t=x.t||"n";switch(h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),E.t){case"n":if(E.v==""||E.v==null){if(!W)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!W)continue;E.t="z"}else O=Kv[parseInt(E.v,10)],E.v=O.t,E.r=O.r,c.cellHTML&&(E.h=O.h);break;case"str":E.t="s",E.v=E.v!=null?hr(E.v):"",c.cellHTML&&(E.h=YN(E.v));break;case"inlineStr":w=T.match(n),E.t="s",w!=null&&(O=hD(w[1]))?(E.v=O.t,c.cellHTML&&(E.h=O.h)):E.v="";break;case"b":E.v=Rr(E.v);break;case"d":c.cellDates?E.v=Pr(E.v,1):(E.v=jn(Pr(E.v,1)),E.t="n");break;case"e":(!c||c.cellText!==!1)&&(E.w=E.v),E.v=aG[E.v];break}if(L=ie=0,he=null,ce&&x.s!==void 0&&(he=d.CellXf[x.s],he!=null&&(he.numFmtId!=null&&(L=he.numFmtId),c.cellStyles&&he.fillId!=null&&(ie=he.fillId))),iY(E,L,ie,c,f,d),c.cellDates&&ce&&E.t=="n"&&jd(rt[L])&&(E.t="d",E.v=eR(E.v)),x.cm&&c.xlmeta){var M=(c.xlmeta.Cell||[])[+x.cm-1];M&&M.type=="XLDAPR"&&(E.D=!0)}if(ge){var R=zr(x.r);u[R.r]||(u[R.r]=[]),u[R.r][R.c]=E}else u[x.r]=E}}}}Q.length>0&&(u["!rows"]=Q)}}();function $ve(t,e,r,n){var i=[],s=[],o=It(t["!ref"]),a="",l,u="",c=[],h=0,f=0,d=t["!rows"],g=Array.isArray(t),m={r:u},p,w=-1;for(f=o.s.c;f<=o.e.c;++f)c[f]=kr(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],u=sn(h),f=o.s.c;f<=o.e.c;++f){l=c[f]+u;var v=g?(t[h]||[])[f]:t[l];v!==void 0&&(a=Hve(v,l,t,e))!=null&&s.push(a)}(s.length>0||d&&d[h])&&(m={r:u},d&&d[h]&&(p=d[h],p.hidden&&(m.hidden=1),w=-1,p.hpx?w=sy(p.hpx):p.hpt&&(w=p.hpt),w>-1&&(m.ht=w,m.customHeight=1),p.level&&(m.outlineLevel=p.level)),i[i.length]=Ie("row",s.join(""),m))}if(d)for(;h<d.length;++h)d&&d[h]&&(m={r:h+1},p=d[h],p.hidden&&(m.hidden=1),w=-1,p.hpx?w=sy(p.hpx):p.hpt&&(w=p.hpt),w>-1&&(m.ht=w,m.customHeight=1),p.level&&(m.outlineLevel=p.level),i[i.length]=Ie("row","",m));return i.join("")}function oY(t,e,r,n){var i=[pn,Ie("worksheet",null,{xmlns:Ud[0],"xmlns:r":Bn.r})],s=r.SheetNames[t],o=0,a="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",c=It(u);if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=dt(c)}n||(n={}),l["!comments"]=[];var h=[];bve(l,r,t,e,i),i[i.length]=Ie("dimension",null,{ref:u}),i[i.length]=Fve(l,e,t,r),e.sheetFormat&&(i[i.length]=Ie("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Ive(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=$ve(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=Rve(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Mve(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Sve(l["!merges"]));var f=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(d={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=or(n,-1,ar(m[1].Target).replace(/#.*$/,""),_t.HLINK),d["r:id"]="rId"+g),(f=m[1].Target.indexOf("#"))>-1&&(d.location=ar(m[1].Target.slice(f+1))),m[1].Tooltip&&(d.tooltip=ar(m[1].Tooltip)),i[i.length]=Ie("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Pve(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=li("ignoredErrors",Ie("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(g=or(n,-1,"../drawings/drawing"+(t+1)+".xml",_t.DRAW),i[i.length]=Ie("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=or(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",_t.VML),i[i.length]=Ie("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Bve(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Vve(t,e,r){var n=ve(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=sy(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var u={r:t,c:0},c=0;c<16;++c)if(!(e.s.c>c+1<<10||e.e.c<c<<10)){for(var h=-1,f=-1,d=c<<10;d<c+1<<10;++d){u.c=d;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[nt(u)];g&&(h<0&&(h=d),f=d)}h<0||(++a,n.write_shift(4,h),n.write_shift(4,f))}var m=n.l;return n.l=l,n.write_shift(4,a),n.l=m,n.length>n.l?n.slice(0,n.l):n}function Wve(t,e,r,n){var i=Vve(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&xe(t,0,i)}var jve=Kd,Uve=Fp;function zve(){}function Gve(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Xhe(t),r}function Yve(t,e,r){r==null&&(r=ve(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Qb({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),rG(t,r),r.slice(0,r.l)}function Kve(t){var e=Go(t);return[e]}function Xve(t,e,r){return r==null&&(r=ve(8)),zd(e,r)}function qve(t){var e=Gd(t);return[e]}function Jve(t,e,r){return r==null&&(r=ve(4)),Yd(e,r)}function Qve(t){var e=Go(t),r=t.read_shift(1);return[e,r,"b"]}function Zve(t,e,r){return r==null&&(r=ve(9)),zd(e,r),r.write_shift(1,t.v?1:0),r}function ewe(t){var e=Gd(t),r=t.read_shift(1);return[e,r,"b"]}function twe(t,e,r){return r==null&&(r=ve(5)),Yd(e,r),r.write_shift(1,t.v?1:0),r}function rwe(t){var e=Go(t),r=t.read_shift(1);return[e,r,"e"]}function nwe(t,e,r){return r==null&&(r=ve(9)),zd(e,r),r.write_shift(1,t.v),r}function iwe(t){var e=Gd(t),r=t.read_shift(1);return[e,r,"e"]}function swe(t,e,r){return r==null&&(r=ve(8)),Yd(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function owe(t){var e=Go(t),r=t.read_shift(4);return[e,r,"s"]}function awe(t,e,r){return r==null&&(r=ve(12)),zd(e,r),r.write_shift(4,e.v),r}function lwe(t){var e=Gd(t),r=t.read_shift(4);return[e,r,"s"]}function uwe(t,e,r){return r==null&&(r=ve(8)),Yd(e,r),r.write_shift(4,e.v),r}function cwe(t){var e=Go(t),r=ki(t);return[e,r,"n"]}function hwe(t,e,r){return r==null&&(r=ve(16)),zd(e,r),Ed(t.v,r),r}function aY(t){var e=Gd(t),r=ki(t);return[e,r,"n"]}function fwe(t,e,r){return r==null&&(r=ve(12)),Yd(e,r),Ed(t.v,r),r}function dwe(t){var e=Go(t),r=oD(t);return[e,r,"n"]}function gwe(t,e,r){return r==null&&(r=ve(12)),zd(e,r),nG(t.v,r),r}function mwe(t){var e=Gd(t),r=oD(t);return[e,r,"n"]}function pwe(t,e,r){return r==null&&(r=ve(8)),Yd(e,r),nG(t.v,r),r}function vwe(t){var e=Go(t),r=nD(t);return[e,r,"is"]}function wwe(t){var e=Go(t),r=Ii(t);return[e,r,"str"]}function ywe(t,e,r){return r==null&&(r=ve(12+4*t.v.length)),zd(e,r),Qn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Cwe(t){var e=Gd(t),r=Ii(t);return[e,r,"str"]}function Swe(t,e,r){return r==null&&(r=ve(8+4*t.v.length)),Yd(e,r),Qn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function xwe(t,e,r){var n=t.l+e,i=Go(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(r.cellFormula){t.l+=2;var a=iR(t,n-t.l,r);o[3]=bi(a,null,i,r.supbooks,r)}else t.l=n;return o}function bwe(t,e,r){var n=t.l+e,i=Go(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(r.cellFormula){t.l+=2;var a=iR(t,n-t.l,r);o[3]=bi(a,null,i,r.supbooks,r)}else t.l=n;return o}function _we(t,e,r){var n=t.l+e,i=Go(t);i.r=r["!row"];var s=ki(t),o=[i,s,"n"];if(r.cellFormula){t.l+=2;var a=iR(t,n-t.l,r);o[3]=bi(a,null,i,r.supbooks,r)}else t.l=n;return o}function Ewe(t,e,r){var n=t.l+e,i=Go(t);i.r=r["!row"];var s=Ii(t),o=[i,s,"str"];if(r.cellFormula){t.l+=2;var a=iR(t,n-t.l,r);o[3]=bi(a,null,i,r.supbooks,r)}else t.l=n;return o}var Rwe=Kd,Twe=Fp;function kwe(t,e){return e==null&&(e=ve(4)),e.write_shift(4,t),e}function Pwe(t,e){var r=t.l+e,n=Kd(t),i=iD(t),s=Ii(t),o=Ii(t),a=Ii(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function Awe(t,e){var r=ve(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Fp({s:zr(t[0]),e:zr(t[0])},r),sD("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Qn(i||"",r),Qn(t[1].Tooltip||"",r),Qn("",r),r.slice(0,r.l)}function Iwe(){}function Owe(t,e,r){var n=t.l+e,i=iG(t),s=t.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=rve(t,n-t.l,r);o[1]=a}else t.l=n;return o}function Mwe(t,e,r){var n=t.l+e,i=Kd(t),s=[i];if(r.cellFormula){var o=ive(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function Nwe(t,e,r){r==null&&(r=ve(18));var n=sR(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var lY=["left","right","top","bottom","header","footer"];function Dwe(t){var e={};return lY.forEach(function(r){e[r]=ki(t)}),e}function Fwe(t,e){return e==null&&(e=ve(6*8)),ud(t),lY.forEach(function(r){Ed(t[r],e)}),e}function Hwe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Lwe(t,e,r){r==null&&(r=ve(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $we(t){var e=ve(24);return e.write_shift(4,4),e.write_shift(4,1),Fp(t,e),e}function Bwe(t,e){return e==null&&(e=ve(16*4+2)),e.write_shift(2,t.password?fD(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Vwe(){}function Wwe(){}function jwe(t,e,r,n,i,s,o){if(!t)return t;var a=e||{};n||(n={"!id":{}});var l=a.dense?[]:{},u,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,d,g,m,p,w,v,y,b,T,E=[];a.biff=12,a["!row"]=0;var x=0,P=!1,A=[],O={},Y=a.supbooks||i.supbooks||[[]];if(Y.sharedf=O,Y.arrayf=A,Y.SheetNames=i.SheetNames||i.Sheets.map(function(ge){return ge.name}),!a.supbooks&&(a.supbooks=Y,i.Names))for(var L=0;L<i.Names.length;++L)Y[0][L+1]=i.Names[L];var ie=[],ce=[],he=!1;oy[16]={n:"BrtShortReal",f:aY};var Ee;if(rc(t,function(Q,ye,Re){if(!f)switch(Re){case 148:u=Q;break;case 0:d=Q,a.sheetRows&&a.sheetRows<=d.r&&(f=!0),b=sn(p=d.r),a["!row"]=d.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=gp(Q.hpt)),ce[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:Q[2]},Q[2]){case"n":g.v=Q[1];break;case"s":y=Kv[Q[1]],g.v=y.t,g.r=y.r;break;case"b":g.v=!!Q[1];break;case"e":g.v=Q[1],a.cellText!==!1&&(g.w=nc[g.v]);break;case"str":g.t="s",g.v=Q[1];break;case"is":g.t="s",g.v=Q[1].t;break}if((m=o.CellXf[Q[0].iStyleRef])&&iY(g,m.numFmtId,null,a,s,o),w=Q[0].c==-1?w+1:Q[0].c,a.dense?(l[p]||(l[p]=[]),l[p][w]=g):l[kr(w)+b]=g,a.cellFormula){for(P=!1,x=0;x<A.length;++x){var W=A[x];d.r>=W[0].s.r&&d.r<=W[0].e.r&&w>=W[0].s.c&&w<=W[0].e.c&&(g.F=dt(W[0]),P=!0)}!P&&Q.length>3&&(g.f=Q[3])}if(c.s.r>d.r&&(c.s.r=d.r),c.s.c>w&&(c.s.c=w),c.e.r<d.r&&(c.e.r=d.r),c.e.c<w&&(c.e.c=w),a.cellDates&&m&&g.t=="n"&&jd(rt[m.numFmtId])){var C=Qc(g.v);C&&(g.t="d",g.v=new Date(C.y,C.m-1,C.d,C.H,C.M,C.S,C.u))}Ee&&(Ee.type=="XLDAPR"&&(g.D=!0),Ee=void 0);break;case 1:case 12:if(!a.sheetStubs||h)break;g={t:"z",v:void 0},w=Q[0].c==-1?w+1:Q[0].c,a.dense?(l[p]||(l[p]=[]),l[p][w]=g):l[kr(w)+b]=g,c.s.r>d.r&&(c.s.r=d.r),c.s.c>w&&(c.s.c=w),c.e.r<d.r&&(c.e.r=d.r),c.e.c<w&&(c.e.c=w),Ee&&(Ee.type=="XLDAPR"&&(g.D=!0),Ee=void 0);break;case 176:E.push(Q);break;case 49:Ee=((a.xlmeta||{}).Cell||[])[Q-1];break;case 494:var S=n["!id"][Q.relId];for(S?(Q.Target=S.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=S):Q.relId==""&&(Q.Target="#"+Q.loc),p=Q.rfx.s.r;p<=Q.rfx.e.r;++p)for(w=Q.rfx.s.c;w<=Q.rfx.e.c;++w)a.dense?(l[p]||(l[p]=[]),l[p][w]||(l[p][w]={t:"z",v:void 0}),l[p][w].l=Q):(v=nt({c:w,r:p}),l[v]||(l[v]={t:"z",v:void 0}),l[v].l=Q);break;case 426:if(!a.cellFormula)break;A.push(Q),T=a.dense?l[p][w]:l[kr(w)+b],T.f=bi(Q[1],c,{r:d.r,c:w},Y,a),T.F=dt(Q[0]);break;case 427:if(!a.cellFormula)break;O[nt(Q[0].s)]=Q[1],T=a.dense?l[p][w]:l[kr(w)+b],T.f=bi(Q[1],c,{r:d.r,c:w},Y,a);break;case 60:if(!a.cellStyles)break;for(;Q.e>=Q.s;)ie[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},he||(he=!0,dD(Q.w/256)),kh(ie[Q.e+1]);break;case 161:l["!autofilter"]={ref:dt(Q)};break;case 476:l["!margins"]=Q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Q.name&&(i.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(l["!outline"]={above:Q.above,left:Q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ye.T){if(!h||a.WTF)throw new Error("Unexpected record 0x"+Re.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(c.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=dt(u||c)),a.sheetRows&&l["!ref"]){var Ce=It(l["!ref"]);a.sheetRows<=+Ce.e.r&&(Ce.e.r=a.sheetRows-1,Ce.e.r>c.e.r&&(Ce.e.r=c.e.r),Ce.e.r<Ce.s.r&&(Ce.s.r=Ce.e.r),Ce.e.c>c.e.c&&(Ce.e.c=c.e.c),Ce.e.c<Ce.s.c&&(Ce.s.c=Ce.e.c),l["!fullref"]=l["!ref"],l["!ref"]=dt(Ce))}return E.length>0&&(l["!merges"]=E),ie.length>0&&(l["!cols"]=ie),ce.length>0&&(l["!rows"]=ce),l}function Uwe(t,e,r,n,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=vr(e),e.z=e.z||rt[14],e.v=jn(Pr(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r,c:n};switch(l.s=$h(i.cellXfs,e,i),e.l&&s["!links"].push([nt(l),e.l]),e.c&&s["!comments"].push([nt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=wD(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?xe(t,18,uwe(e,l)):xe(t,7,awe(e,l))):(l.t="str",o?xe(t,17,Swe(e,l)):xe(t,6,ywe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?xe(t,13,pwe(e,l)):xe(t,2,gwe(e,l)):o?xe(t,16,fwe(e,l)):xe(t,5,hwe(e,l)),!0;case"b":return l.t="b",o?xe(t,15,twe(e,l)):xe(t,4,Zve(e,l)),!0;case"e":return l.t="e",o?xe(t,14,swe(e,l)):xe(t,3,nwe(e,l)),!0}return o?xe(t,12,Jve(e,l)):xe(t,1,Xve(e,l)),!0}function zwe(t,e,r,n){var i=It(e["!ref"]||"A1"),s,o="",a=[];xe(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var c=i.s.r;c<=u;++c){o=sn(c),Wve(t,e,i,c);var h=!1;if(c<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){c===i.s.r&&(a[f]=kr(f)),s=a[f]+o;var d=l?(e[c]||[])[f]:e[s];if(!d){h=!1;continue}h=Uwe(t,d,c,f,n,e,h)}}xe(t,146)}function Gwe(t,e){!e||!e["!merges"]||(xe(t,177,kwe(e["!merges"].length)),e["!merges"].forEach(function(r){xe(t,176,Twe(r))}),xe(t,178))}function Ywe(t,e){!e||!e["!cols"]||(xe(t,390),e["!cols"].forEach(function(r,n){r&&xe(t,60,Nwe(n,r))}),xe(t,391))}function Kwe(t,e){!e||!e["!ref"]||(xe(t,648),xe(t,649,$we(It(e["!ref"]))),xe(t,650))}function Xwe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=or(r,-1,n[1].Target.replace(/#.*$/,""),_t.HLINK);xe(t,494,Awe(n,i))}}),delete e["!links"]}function qwe(t,e,r,n){if(e["!comments"].length>0){var i=or(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",_t.VML);xe(t,551,sD("rId"+i)),e["!legacy"]=i}}function Jwe(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:dt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=Zi(s);a.s.r==a.e.r&&(a.e.r=Zi(e["!ref"]).e.r,s=dt(a));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),xe(t,161,Fp(It(s))),xe(t,162)}}function Qwe(t,e,r){xe(t,133),xe(t,137,Lwe(e,r)),xe(t,138),xe(t,134)}function Zwe(t,e){e["!protect"]&&xe(t,535,Bwe(e["!protect"]))}function eye(t,e,r,n){var i=As(),s=r.SheetNames[t],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[t].CodeName||a)}catch{}var l=It(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],xe(i,129),(r.vbaraw||o["!outline"])&&xe(i,147,Yve(a,o["!outline"])),xe(i,148,Uve(l)),Qwe(i,o,r.Workbook),Ywe(i,o),zwe(i,o,t,e),Zwe(i,o),Jwe(i,o,r,t),Gwe(i,o),Xwe(i,o,n),o["!margins"]&&xe(i,476,Fwe(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Kwe(i,o),qwe(i,o,t,n),xe(i,130),i.end()}function tye(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=jt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function rye(t,e,r,n,i,s){var o=s||{"!type":"chart"};if(!t)return s;var a=0,l=0,u="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=tye(h);c.s.r=c.s.c=0,c.e.c=a,u=kr(a),f[0].forEach(function(d,g){o[u+sn(g)]={t:"n",v:d,z:f[1]},l=g}),c.e.r<l&&(c.e.r=l),++a}),a>0&&(o["!ref"]=dt(c)),o}function nye(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=t.match(sY);return a&&yD(a[0],s,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function iye(t,e){t.l+=10;var r=Ii(t);return{name:r}}function sye(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return rc(t,function(l,u,c){switch(c){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var CD=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oye=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],aye=[],lye=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function DB(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Rr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function FB(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Rr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function uY(t){FB(t.WBProps,CD),FB(t.CalcPr,lye),DB(t.WBView,oye),DB(t.Sheets,aye),zm.date1904=Rr(t.WBProps.date1904)}function uye(t){return!t.Workbook||!t.Workbook.WBProps?"false":Rr(t.Workbook.WBProps.date1904)?"true":"false"}var cye="][*?/\\".split("");function cY(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return cye.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function hye(t,e,r){t.forEach(function(n,i){cY(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function hY(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];hye(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)uve(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var fye=/<\w+:workbook/;function dye(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(t.replace(Di,function(l,u){var c=it(l);switch($l(c[0])){case"<?xml":break;case"<workbook":l.match(fye)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=c[i];break;case"</workbook>":break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":CD.forEach(function(h){if(c[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Rr(c[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(c[h[0]],10);break;default:r.WBProps[h[0]]=c[h[0]]}}),c.codeName&&(r.WBProps.CodeName=hr(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=jt(hr(c.name)),delete c[0],r.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=hr(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),Rr(c.hidden||"0")&&(s.Hidden=!0),o=u+l.length;break;case"</definedName>":s.Ref=jt(hr(t.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete c[0],r.CalcPr=c;break;case"<calcPr/>":delete c[0],r.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),Ud.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return uY(r),r}function fY(t){var e=[pn];e[e.length]=Ie("workbook",null,{xmlns:Ud[0],"xmlns:r":Bn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(CD.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ie("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:ar(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ie("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=Ie("definedName",ar(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function gye(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=UO(t),r.name=Ii(t),r}function mye(t,e){return e||(e=ve(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),sD(t.strRelID,e),Qn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function pye(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Ii(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vye(t,e){e||(e=ve(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),rG(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function wye(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function yye(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=qhe(t),o=nve(t,0,r),a=iD(t);t.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function Cye(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],oy[16]={n:"BrtFRTArchID$",f:wye},rc(t,function(l,u,c){switch(c){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=bi(l.Ptg,null,null,o,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([c,l]):o[0]=[c,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(c),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(c),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},e),uY(r),r.Names=s,r.supbooks=o,r}function Sye(t,e){xe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};xe(t,156,mye(i))}xe(t,144)}function xye(t,e){e||(e=ve(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Qn("SheetJS",e),Qn(Xw.version,e),Qn(Xw.version,e),Qn("7262",e),e.length>e.l?e.slice(0,e.l):e}function bye(t,e){e||(e=ve(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function _ye(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(xe(t,135),xe(t,158,bye(i)),xe(t,136))}}function Eye(t,e){var r=As();return xe(r,131),xe(r,128,xye()),xe(r,153,vye(t.Workbook&&t.Workbook.WBProps||null)),_ye(r,t),Sye(r,t),xe(r,132),r.end()}function Rye(t,e,r){return e.slice(-4)===".bin"?Cye(t,r):dye(t,r)}function Tye(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?jwe(t,n,r,i,s,o,a):Cve(t,n,r,i,s,o,a)}function kye(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?sye(t,n,r,i,s):nye(t,n,r,i,s)}function Pye(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?Ope():Mpe()}function Aye(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?Ape():Ipe()}function Iye(t,e,r,n){return e.slice(-4)===".bin"?Tme(t,r,n):mme(t,r,n)}function Oye(t,e,r){return zG(t,r)}function Mye(t,e,r){return e.slice(-4)===".bin"?Nge(t,r):Ige(t,r)}function Nye(t,e,r){return e.slice(-4)===".bin"?Epe(t,r):ppe(t,r)}function Dye(t,e,r){return e.slice(-4)===".bin"?dpe(t):hpe(t)}function Fye(t,e,r,n){return r.slice(-4)===".bin"?gpe(t,e,r,n):void 0}function Hye(t,e,r){return e.slice(-4)===".bin"?lpe(t,e,r):cpe(t,e,r)}function Lye(t,e,r){return(e.slice(-4)===".bin"?Eye:fY)(t)}function $ye(t,e,r,n,i){return(e.slice(-4)===".bin"?eye:oY)(t,r,n,i)}function Bye(t,e,r){return(e.slice(-4)===".bin"?Hme:jG)(t,r)}function Vye(t,e,r){return(e.slice(-4)===".bin"?Hge:DG)(t,r)}function Wye(t,e,r){return(e.slice(-4)===".bin"?Rpe:KG)(t)}function jye(t){return(t.slice(-4)===".bin"?upe:GG)()}var dY=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gY=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ra(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(dY),s,o,a,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(gY),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),n[a]=s[2].slice(1,s[2].length-1));return n}function Uye(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(dY),i,s,o,a;if(n)for(a=0;a!=n.length;++a)i=n[a].match(gY),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var qv;function zye(t,e){var r=qv[t]||jt(t);return r==="General"?bd(e):ao(r,e)}function Gye(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Rr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Pr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[jt(e)]=i}function Yye(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||nc[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Jw(t.v):t.w=bd(t.v):t.w=zye(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=qv[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&jd(n)){var i=Qc(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Kye(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=ame[n.Pattern]||n.Pattern)}t[e.ID]=e}function Xye(t,e,r,n,i,s,o,a,l,u){var c="General",h=n.StyleID,f={};u=u||{};var d=[],g=0;for(h===void 0&&a&&(h=a.StyleID),h===void 0&&o&&(h=o.StyleID);s[h]!==void 0&&(s[h].nf&&(c=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Rr(t);break;case"String":n.t="s",n.r=Z3(jt(t)),n.v=t.indexOf("<")>-1?jt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Pr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=jt(t):n.v<60&&(n.v=n.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=aG[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Z3(e||t));break}if(Yye(n,c,u),u.cellFormula!==!1)if(n.Formula){var m=jt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Um(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Um("RC:RC",i):n.ArrayRange&&(n.F=Um(n.ArrayRange,i),l.push([It(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);u.cellStyles&&(d.forEach(function(p){!f.patternType&&p.patternType&&(f.patternType=p.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function qye(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function uk(t,e){var r=e||{};Mp();var n=Rm(KN(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Ht<"u"?n=Ht.utils.decode(65001,zb(n)):n=hr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=vr(r);return o.type="string",dp.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(te){i.indexOf("<"+te)>=0&&(s=!0)}),s)return O1e(n,r);qv={"General Number":"General","General Date":rt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":rt[15],"Short Date":rt[14],"Long Time":rt[19],"Medium Time":rt[18],"Short Time":rt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:rt[2],Standard:rt[4],Percent:rt[10],Scientific:rt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],u,c={},h=[],f=r.dense?[]:{},d="",g={},m={},p=ra('<Data ss:Type="String">'),w=0,v=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},E={},x="",P=0,A=[],O={},Y={},L=0,ie=[],ce=[],he={},Ee=[],Ce,ge=!1,Q=[],ye=[],Re={},W=0,C=0,S={Sheets:[],WBProps:{date1904:!1}},_={};ey.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var D="";a=ey.exec(n);)switch(a[3]=(D=a[3]).toLowerCase()){case"data":if(D=="data"){if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?Xye(n.slice(w,a.index),x,p,l[l.length-1][0]=="comment"?he:g,{c:v,r:y},T,Ee[v],m,Q,r):(x="",p=ra(a[0]),w=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(ce.length>0&&(g.c=ce),(!r.sheetRows||r.sheetRows>y)&&g.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][v]=g):f[kr(v)+sn(y)]=g),g.HRef&&(g.l={Target:jt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(W=v+(parseInt(g.MergeAcross,10)|0),C=y+(parseInt(g.MergeDown,10)|0),A.push({s:{c:v,r:y},e:{c:W,r:C}})),!r.sheetStubs)g.MergeAcross?v=W+1:++v;else if(g.MergeAcross||g.MergeDown){for(var U=v;U<=W;++U)for(var X=y;X<=C;++X)(U>v||X>y)&&(r.dense?(f[X]||(f[X]=[]),f[X][U]={t:"z"}):f[kr(U)+sn(X)]={t:"z"});v=W+1}else++v;else g=Uye(a[0]),g.Index&&(v=+g.Index-1),v<b.s.c&&(b.s.c=v),v>b.e.c&&(b.e.c=v),a[0].slice(-2)==="/>"&&++v,ce=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),a[0].slice(-2)==="/>"&&(m=ra(a[0]),m.Index&&(y=+m.Index-1)),v=0,++y):(m=ra(a[0]),m.Index&&(y=+m.Index-1),Re={},(m.AutoFitHeight=="0"||m.Height)&&(Re.hpx=parseInt(m.Height,10),Re.hpt=sy(Re.hpx),ye[y]=Re),m.Hidden=="1"&&(Re.hidden=!0,ye[y]=Re));break;case"worksheet":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"));h.push(d),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(f["!ref"]=dt(b),r.sheetRows&&r.sheetRows<=b.e.r&&(f["!fullref"]=f["!ref"],b.e.r=r.sheetRows-1,f["!ref"]=dt(b))),A.length&&(f["!merges"]=A),Ee.length>0&&(f["!cols"]=Ee),ye.length>0&&(f["!rows"]=ye),c[d]=f}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,l.push([a[3],!1]),u=ra(a[0]),d=jt(u.Name),f=r.dense?[]:{},A=[],Q=[],ye=[],_={name:d,Hidden:0},S.Sheets.push(_);break;case"table":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),Ee=[],ge=!1}break;case"style":a[1]==="/"?Kye(T,E,r):E=ra(a[0]);break;case"numberformat":E.nf=jt(ra(a[0]).Format||"General"),qv[E.nf]&&(E.nf=qv[E.nf]);for(var ee=0;ee!=392&&rt[ee]!=E.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(rt[ee]==null){Ml(E.nf,ee);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Ce=ra(a[0]),Ce.Hidden&&(Ce.hidden=!0,delete Ce.Hidden),Ce.Width&&(Ce.wpx=parseInt(Ce.Width,10)),!ge&&Ce.wpx>10){ge=!0,Ei=VG;for(var k=0;k<Ee.length;++k)Ee[k]&&kh(Ee[k])}ge&&kh(Ce),Ee[Ce.Index-1||Ee.length]=Ce;for(var M=0;M<+Ce.Span;++M)Ee[Ee.length]=vr(Ce);break;case"namedrange":if(a[1]==="/")break;S.Names||(S.Names=[]);var R=it(a[0]),V={Name:R.Name,Ref:Um(R.RefersTo.slice(1),{r:0,c:0})};S.Sheets.length>0&&(V.Sheet=S.Sheets.length-1),S.Names.push(V);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?x+=n.slice(P,a.index):P=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=ra(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?Sfe(O,D,n.slice(L,a.index)):L=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"));qye(he),ce.push(he)}else l.push([a[3],!1]),u=ra(a[0]),he={a:u.Author};break;case"autofilter":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var q=ra(a[0]);f["!autofilter"]={ref:Um(q.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((u=l.pop())[0]!==a[3])throw new Error("Bad state: "+u.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return VB(n,r);var J=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(a[3]){case"date1904":S.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(L,a.index)){case"SheetHidden":_.Hidden=1;break;case"SheetVeryHidden":_.Hidden=2;break}else L=a.index+a[0].length;break;case"header":f["!margins"]||ud(f["!margins"]={},"xlml"),isNaN(+it(a[0]).Margin)||(f["!margins"].header=+it(a[0]).Margin);break;case"footer":f["!margins"]||ud(f["!margins"]={},"xlml"),isNaN(+it(a[0]).Margin)||(f["!margins"].footer=+it(a[0]).Margin);break;case"pagemargins":var re=it(a[0]);f["!margins"]||ud(f["!margins"]={},"xlml"),isNaN(+re.Top)||(f["!margins"].top=+re.Top),isNaN(+re.Left)||(f["!margins"].left=+re.Left),isNaN(+re.Right)||(f["!margins"].right=+re.Right),isNaN(+re.Bottom)||(f["!margins"].bottom=+re.Bottom);break;case"displayrighttoleft":S.Views||(S.Views=[]),S.Views[0]||(S.Views[0]={}),S.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?Gye(Y,D,ie,n.slice(L,a.index)):(ie=a,L=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var B={};return!r.bookSheets&&!r.bookProps&&(B.Sheets=c),B.SheetNames=h,B.Workbook=S,B.SSF=vr(rt),B.Props=O,B.Custprops=Y,B}function JO(t,e){switch(bD(e=e||{}),e.type||"base64"){case"base64":return uk(oo(t),e);case"binary":case"buffer":case"file":return uk(t,e);case"array":return uk(Hh(t),e)}}function Jye(t,e){var r=[];return t.Props&&r.push(xfe(t.Props,e)),t.Custprops&&r.push(bfe(t.Props,t.Custprops)),r.join("")}function Qye(){return""}function Zye(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ie("NumberFormat",null,{"ss:Format":ar(rt[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Ie("Style",s.join(""),o))}),Ie("Styles",r.join(""))}function mY(t){return Ie("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+pD(t.Ref,{r:0,c:0})})}function e1e(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(mY(i)))}return Ie("Names",r.join(""))}function t1e(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(mY(a)))}return s.join("")}function r1e(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ie("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ie("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ie("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ie("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(li("ProtectContents","True")),t["!protect"].objects&&i.push(li("ProtectObjects","True")),t["!protect"].scenarios&&i.push(li("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(li("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(li("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Ie("WorksheetOptions",i.join(""),{xmlns:Ks.x})}function n1e(t){return t.map(function(e){var r=Ehe(e.t||""),n=Ie("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ie("Comment",n,{"ss:Author":e.a})}).join("")}function i1e(t,e,r,n,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+ar(pD(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=zr(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=ar(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=ar(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],c=0;c!=u.length;++c)u[c].s.c!=o.c||u[c].s.r!=o.r||(u[c].e.c>u[c].s.c&&(a["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(a["ss:MergeDown"]=u[c].e.r-u[c].s.r));var h="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=nc[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||rt[14]);break;case"s":h="String",f=_he(t.v||"");break}var d=$h(n.cellXfs,t,n);a["ss:StyleID"]="s"+(21+d),a["ss:Index"]=o.c+1;var g=t.v!=null?f:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(m+=n1e(t.c)),Ie("Cell",m,a)}function s1e(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=gp(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function o1e(t,e,r,n){if(!t["!ref"])return"";var i=It(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(p,w){kh(p);var v=!!p.width,y=sR(w,p),b={"ss:Index":w+1};v&&(b["ss:Width"]=ny(y.width)),p.hidden&&(b["ss:Hidden"]="1"),a.push(Ie("Column",null,b))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var c=[s1e(u,(t["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>u)&&!(s[o].e.c<h)&&!(s[o].e.r<u)){(s[o].s.c!=h||s[o].s.r!=u)&&(f=!0);break}if(!f){var d={r:u,c:h},g=nt(d),m=l?(t[u]||[])[h]:t[g];c.push(i1e(m,g,t,e,r,n,d))}}c.push("</Row>"),c.length>2&&a.push(c.join(""))}return a.join("")}function a1e(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],o=s?t1e(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?o1e(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(r1e(s,e,t,r)),n.join("")}function l1e(t,e){e||(e={}),t.SSF||(t.SSF=vr(rt)),t.SSF&&(Mp(),qy(t.SSF),e.revssf=ZE(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],$h(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Jye(t,e)),r.push(Qye()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ie("Worksheet",a1e(n,e,t),{"ss:Name":ar(t.SheetNames[n])}));return r[2]=Zye(t,e),r[3]=e1e(t),pn+Ie("Workbook",r.join(""),{xmlns:Ks.ss,"xmlns:o":Ks.o,"xmlns:x":Ks.x,"xmlns:ss":Ks.ss,"xmlns:dt":Ks.dt,"xmlns:html":Ks.html})}function u1e(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=tfe(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=rfe(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var c1e=[60,1084,2066,2165,2175];function h1e(t,e,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var l=_u(r,r.l),u=QO[l],c=0;u!=null&&c1e.indexOf(l)>-1;)s=_u(r,r.l+2),c=r.l+4,l==2066?c+=4:(l==2165||l==2175)&&(c+=12),a=r.slice(c,r.l+4+s),o.push(a),r.l+=4+s,u=QO[l=_u(r,r.l)];var h=Jn(o);ai(h,0);var f=0;h.lens=[];for(var d=0;d<o.length;++d)h.lens.push(f),f+=o[d].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Ka(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=rt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||nc[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Jw(t.v):t.w=bd(t.v):t.w=ao(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&jd(rt[n]||String(n))){var i=Qc(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function pC(t,e,r){return{v:t,ixfe:e,t:r}}function f1e(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},o={},a=null,l=[],u="",c={},h,f="",d,g,m,p,w={},v=[],y,b,T=[],E=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},A=function(Qe){return Qe<8?od[Qe]:Qe<64&&E[Qe-8]||od[Qe]},O=function(Qe,Xt,Or){var St=Xt.XF.data;if(!(!St||!St.patternType||!Or||!Or.cellStyles)){Xt.s={},Xt.s.patternType=St.patternType;var $t;($t=ry(A(St.icvFore)))&&(Xt.s.fgColor={rgb:$t}),($t=ry(A(St.icvBack)))&&(Xt.s.bgColor={rgb:$t})}},Y=function(Qe,Xt,Or){if(!(Re>1)&&!(Or.sheetRows&&Qe.r>=Or.sheetRows)){if(Or.cellStyles&&Xt.XF&&Xt.XF.data&&O(Qe,Xt,Or),delete Xt.ixfe,delete Xt.XF,h=Qe,f=nt(Qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<o.s.r&&(o.s.r=Qe.r),Qe.c<o.s.c&&(o.s.c=Qe.c),Qe.r+1>o.e.r&&(o.e.r=Qe.r+1),Qe.c+1>o.e.c&&(o.e.c=Qe.c+1),Or.cellFormula&&Xt.f){for(var St=0;St<v.length;++St)if(!(v[St][0].s.c>Qe.c||v[St][0].s.r>Qe.r)&&!(v[St][0].e.c<Qe.c||v[St][0].e.r<Qe.r)){Xt.F=dt(v[St][0]),(v[St][0].s.c!=Qe.c||v[St][0].s.r!=Qe.r)&&delete Xt.f,Xt.f&&(Xt.f=""+bi(v[St][1],o,Qe,Q,L));break}}Or.dense?(i[Qe.r]||(i[Qe.r]=[]),i[Qe.r][Qe.c]=Xt):i[f]=Xt}},L={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(L.password=e.password);var ie,ce=[],he=[],Ee=[],Ce=[],ge=!1,Q=[];Q.SheetNames=L.snames,Q.sharedf=L.sharedf,Q.arrayf=L.arrayf,Q.names=[],Q.XTI=[];var ye=0,Re=0,W=0,C=[],S=[],_;L.codepage=1200,$o(1200);for(var D=!1;t.l<t.length-1;){var U=t.l,X=t.read_shift(2);if(X===0&&ye===10)break;var ee=t.l===t.length?0:t.read_shift(2),k=QO[X];if(k&&k.f){if(e.bookSheets&&ye===133&&X!==133)break;if(ye=X,k.r===2||k.r==12){var M=t.read_shift(2);if(ee-=2,!L.enc&&M!==X&&((M&255)<<8|M>>8)!==X)throw new Error("rt mismatch: "+M+"!="+X);k.r==12&&(t.l+=10,ee-=10)}var R={};if(X===10?R=k.f(t,ee,L):R=h1e(X,k,t,ee,L),Re==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(X){case 34:r.opts.Date1904=x.WBProps.date1904=R;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(t.l=0),L.enc=R,!e.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=R;break;case 66:var V=Number(R);switch(V){case 21010:V=1200;break;case 32768:V=1e4;break;case 32769:V=1252;break}$o(L.codepage=V),D=!0;break;case 317:L.rrtabid=R;break;case 25:L.winlocked=R;break;case 439:r.opts.RefreshAll=R;break;case 12:r.opts.CalcCount=R;break;case 16:r.opts.CalcDelta=R;break;case 17:r.opts.CalcIter=R;break;case 13:r.opts.CalcMode=R;break;case 14:r.opts.CalcPrecision=R;break;case 95:r.opts.CalcSaveRecalc=R;break;case 15:L.CalcRefMode=R;break;case 2211:r.opts.FullCalc=R;break;case 129:R.fDialog&&(i["!type"]="dialog"),R.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),R.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(R);break;case 430:Q.push([R]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(R);break;case 24:case 536:_={Name:R.Name,Ref:bi(R.rgce,o,null,Q,L)},R.itab>0&&(_.Sheet=R.itab-1),Q.names.push(_),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(S[R.itab-1]={ref:dt(R.rgce[0][0][1][2])});break;case 22:L.ExternCount=R;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(R),Q.XTI=Q.XTI.concat(R);break;case 2196:if(L.biff<8)break;_!=null&&(_.Comment=R[1]);break;case 18:i["!protect"]=R;break;case 19:R!==0&&L.WTF&&console.error("Password verifier: "+R);break;case 133:s[R.pos]=R,L.snames.push(R.name);break;case 10:{if(--Re)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=dt(o),e.sheetRows&&e.sheetRows<=o.e.r){var q=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=dt(o),o.e.r=q}o.e.r++,o.e.c++}ce.length>0&&(i["!merges"]=ce),he.length>0&&(i["!objects"]=he),Ee.length>0&&(i["!cols"]=Ee),Ce.length>0&&(i["!rows"]=Ce),x.Sheets.push(P)}u===""?c=i:n[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),L.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(L.biff=5,D=!0,$o(L.codepage=28591)),L.biff==8&&R.BIFFVer==0&&R.dt==16&&(L.biff=2),Re++)break;if(i=e.dense?[]:{},L.biff<8&&!D&&(D=!0,$o(L.codepage=e.codepage||1252)),L.biff<5||R.BIFFVer==0&&R.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:t.l-ee,name:u};s[J.pos]=J,L.snames.push(u)}else u=(s[U]||{name:""}).name;R.dt==32&&(i["!type"]="chart"),R.dt==64&&(i["!type"]="macro"),ce=[],he=[],L.arrayf=v=[],Ee=[],Ce=[],ge=!1,P={Hidden:(s[U]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[R.r]||[])[R.c]:i[nt({c:R.c,r:R.r})])&&++R.c,y={ixfe:R.ixfe,XF:T[R.ixfe]||{},v:R.val,t:"n"},W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 5:case 517:y={ixfe:R.ixfe,XF:T[R.ixfe],v:R.val,t:R.t},W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 638:y={ixfe:R.ixfe,XF:T[R.ixfe],v:R.rknum,t:"n"},W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 189:for(var re=R.c;re<=R.C;++re){var B=R.rkrec[re-R.c][0];y={ixfe:B,XF:T[B],v:R.rkrec[re-R.c][1],t:"n"},W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:re,r:R.r},y,e)}break;case 6:case 518:case 1030:{if(R.val=="String"){a=R;break}if(y=pC(R.val,R.cell.ixfe,R.tt),y.XF=T[y.ixfe],e.cellFormula){var te=R.formula;if(te&&te[0]&&te[0][0]&&te[0][0][0]=="PtgExp"){var oe=te[0][0][1][0],ae=te[0][0][1][1],fe=nt({r:oe,c:ae});w[fe]?y.f=""+bi(R.formula,o,R.cell,Q,L):y.F=((e.dense?(i[oe]||[])[ae]:i[fe])||{}).F}else y.f=""+bi(R.formula,o,R.cell,Q,L)}W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y(R.cell,y,e),a=R}break;case 7:case 519:if(a)a.val=R,y=pC(R,a.cell.ixfe,"s"),y.XF=T[y.ixfe],e.cellFormula&&(y.f=""+bi(a.formula,o,a.cell,Q,L)),W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y(a.cell,y,e),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(R);var Me=nt(R[0].s);if(d=e.dense?(i[R[0].s.r]||[])[R[0].s.c]:i[Me],e.cellFormula&&d){if(!a||!Me||!d)break;d.f=""+bi(R[1],o,R[0],Q,L),d.F=dt(R[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!a)break;w[nt(a.cell)]=R[0],d=e.dense?(i[a.cell.r]||[])[a.cell.c]:i[nt(a.cell)],(d||{}).f=""+bi(R[0],o,h,Q,L)}}break;case 253:y=pC(l[R.isst].t,R.ixfe,"s"),l[R.isst].h&&(y.h=l[R.isst].h),y.XF=T[y.ixfe],W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:R.ixfe,XF:T[R.ixfe],t:"z"},W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e));break;case 190:if(e.sheetStubs)for(var Ne=R.c;Ne<=R.C;++Ne){var ze=R.ixfe[Ne-R.c];y={ixfe:ze,XF:T[ze],t:"z"},W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:Ne,r:R.r},y,e)}break;case 214:case 516:case 4:y=pC(R.val,R.ixfe,"s"),y.XF=T[y.ixfe],W>0&&(y.z=C[y.ixfe>>8&63]),Ka(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 0:case 512:Re===1&&(o=R);break;case 252:l=R;break;case 1054:if(L.biff==4){C[W++]=R[1];for(var st=0;st<W+163&&rt[st]!=R[1];++st);st>=163&&Ml(R[1],W+163)}else Ml(R[1],R[0]);break;case 30:{C[W++]=R;for(var ot=0;ot<W+163&&rt[ot]!=R;++ot);ot>=163&&Ml(R,W+163)}break;case 229:ce=ce.concat(R);break;case 93:he[R.cmo[0]]=L.lastobj=R;break;case 438:L.lastobj.TxO=R;break;case 127:L.lastobj.ImData=R;break;case 440:for(p=R[0].s.r;p<=R[0].e.r;++p)for(m=R[0].s.c;m<=R[0].e.c;++m)d=e.dense?(i[p]||[])[m]:i[nt({c:m,r:p})],d&&(d.l=R[1]);break;case 2048:for(p=R[0].s.r;p<=R[0].e.r;++p)for(m=R[0].s.c;m<=R[0].e.c;++m)d=e.dense?(i[p]||[])[m]:i[nt({c:m,r:p})],d&&d.l&&(d.l.Tooltip=R[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;d=e.dense?(i[R[0].r]||[])[R[0].c]:i[nt(R[0])];var tt=he[R[2]];d||(e.dense?(i[R[0].r]||(i[R[0].r]=[]),d=i[R[0].r][R[0].c]={t:"z"}):d=i[nt(R[0])]={t:"z"},o.e.r=Math.max(o.e.r,R[0].r),o.s.r=Math.min(o.s.r,R[0].r),o.e.c=Math.max(o.e.c,R[0].c),o.s.c=Math.min(o.s.c,R[0].c)),d.c||(d.c=[]),g={a:R[1],t:tt.TxO.t},d.c.push(g)}break;case 2173:epe(T[R.ixfe],R.ext);break;case 125:{if(!L.cellStyles)break;for(;R.e>=R.s;)Ee[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},ge||(ge=!0,dD(R.w/256)),kh(Ee[R.e+1])}break;case 520:{var We={};R.level!=null&&(Ce[R.r]=We,We.level=R.level),R.hidden&&(Ce[R.r]=We,We.hidden=!0),R.hpt&&(Ce[R.r]=We,We.hpt=R.hpt,We.hpx=gp(R.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||ud(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=R;break;case 161:i["!margins"]||ud(i["!margins"]={}),i["!margins"].header=R.header,i["!margins"].footer=R.footer;break;case 574:R.RTL&&(x.Views[0].RTL=!0);break;case 146:E=R;break;case 2198:ie=R;break;case 140:b=R;break;case 442:u?P.CodeName=R||P.name:x.WBProps.CodeName=R||"ThisWorkbook";break}}else k||console.error("Missing Info for XLS Record 0x"+X.toString(16)),t.l+=ee}return r.SheetNames=ln(s).sort(function(ht,Qe){return Number(ht)-Number(Qe)}).map(function(ht){return s[ht].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&c["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=c)):r.Preamble=c,r.Sheets&&S.forEach(function(ht,Qe){r.Sheets[r.SheetNames[Qe]]["!autofilter"]=ht}),r.Strings=l,r.SSF=vr(rt),L.enc&&(r.Encryption=L.enc),ie&&(r.Themes=ie),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),Q.names.length>0&&(x.Names=Q.names),r.Workbook=x,r}var Jv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function d1e(t,e,r){var n=Xe.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=vB(n,zO,Jv.DSI);for(var s in i)e[s]=i[s]}catch(u){if(r.WTF)throw u}var o=Xe.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var a=vB(o,GO,Jv.SI);for(var l in a)e[l]==null&&(e[l]=a[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(dG(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function g1e(t,e){var r=[],n=[],i=[],s=0,o,a=Y3(zO,"n"),l=Y3(GO,"n");if(t.Props)for(o=ln(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=ln(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)CG.indexOf(i[s][0])>-1||fG.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Xe.utils.cfb_add(e,"/SummaryInformation",wB(n,Jv.SI,l,GO)),(r.length||u.length)&&Xe.utils.cfb_add(e,"/DocumentSummaryInformation",wB(r,Jv.DSI,a,zO,u.length?u:null,Jv.UDI))}function SD(t,e){e||(e={}),bD(e),JE(),e.codepage&&qE(e.codepage);var r,n;if(t.FullPaths){if(Xe.find(t,"/encryption"))throw new Error("File is password-protected");r=Xe.find(t,"!CompObj"),n=Xe.find(t,"/Workbook")||Xe.find(t,"/Book")}else{switch(e.type){case"base64":t=Xs(oo(t));break;case"binary":t=Xs(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ai(t,0),n={content:t}}var i,s;if(r&&u1e(r),e.bookProps&&!e.bookSheets)i={};else{var o=xt?"buffer":"array";if(n&&n.content)i=f1e(n.content,e);else if((s=Xe.find(t,"PerfectOffice_MAIN"))&&s.content)i=ld.to_workbook(s.content,(e.type=o,e));else if((s=Xe.find(t,"NativeContent_MAIN"))&&s.content)i=ld.to_workbook(s.content,(e.type=o,e));else throw(s=Xe.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Xe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=kpe(t))}var a={};return t.FullPaths&&d1e(t,a,e),i.Props=i.Custprops=a,e.bookFiles&&(i.cfb=t),i}function m1e(t,e){var r=e||{},n=Xe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Xe.utils.cfb_add(n,i,pY(t,r)),r.biff==8&&(t.Props||t.Custprops)&&g1e(t,n),r.biff==8&&t.vbaraw&&Ppe(n,Xe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var oy={0:{f:Bve},1:{f:Kve},2:{f:dwe},3:{f:rwe},4:{f:Qve},5:{f:cwe},6:{f:wwe},7:{f:owe},8:{f:Ewe},9:{f:_we},10:{f:xwe},11:{f:bwe},12:{f:qve},13:{f:mwe},14:{f:iwe},15:{f:ewe},16:{f:aY},17:{f:Cwe},18:{f:lwe},19:{f:nD},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yye},40:{},42:{},43:{f:wme},44:{f:pme},45:{f:Sme},46:{f:bme},47:{f:xme},48:{},49:{f:jhe},50:{},51:{f:npe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:IG},62:{f:vwe},63:{f:fpe},64:{f:Vwe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ni,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Hwe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Gve},148:{f:jve,p:16},151:{f:Iwe},152:{},153:{f:pye},154:{},155:{},156:{f:gye},157:{},158:{},159:{T:1,f:Mge},160:{T:-1},161:{T:1,f:Kd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Rwe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:tpe},336:{T:-1},337:{f:ope,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:UO},357:{},358:{},359:{},360:{T:1},361:{},362:{f:AG},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Owe},427:{f:Mwe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Dwe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zve},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Pwe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:UO},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:bpe},633:{T:1},634:{T:-1},635:{T:1,f:Spe},636:{T:-1},637:{f:Yhe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iye},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Wwe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},QO={6:{f:ak},10:{f:mc},12:{f:Rn},13:{f:Rn},14:{f:hn},15:{f:hn},16:{f:ki},17:{f:hn},18:{f:hn},19:{f:Rn},20:{f:_B},21:{f:_B},23:{f:AG},24:{f:RB},25:{f:hn},26:{},27:{},28:{f:Wde},29:{},34:{f:hn},35:{f:EB},38:{f:ki},39:{f:ki},40:{f:ki},41:{f:ki},42:{f:hn},43:{f:hn},47:{f:eme},49:{f:mde},51:{f:Rn},60:{},61:{f:cde},64:{f:hn},65:{f:gde},66:{f:Rn},77:{},80:{},81:{},82:{},85:{f:Rn},89:{},90:{},91:{},92:{f:Zfe},93:{f:zde},94:{},95:{f:hn},96:{},97:{},99:{f:hn},125:{f:IG},128:{f:Ade},129:{f:tde},130:{f:Rn},131:{f:hn},132:{f:hn},133:{f:rde},134:{},140:{f:Zde},141:{f:Rn},144:{},146:{f:rge},151:{},152:{},153:{},154:{},155:{},156:{f:Rn},157:{},158:{},160:{f:uge},161:{f:sge},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Rde},190:{f:Tde},193:{f:mc},197:{},198:{},199:{},200:{},201:{},202:{f:hn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rn},220:{},221:{f:hn},222:{},224:{f:Pde},225:{f:Qfe},226:{f:mc},227:{},229:{f:jde},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ide},253:{f:vde},255:{f:ode},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:SG},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hn},353:{f:mc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Dde},431:{f:hn},432:{},433:{},434:{},437:{},438:{f:Kde},439:{f:hn},440:{f:Xde},441:{},442:{f:Zy},443:{},444:{f:Rn},445:{},446:{},448:{f:mc},449:{f:ude,r:2},450:{f:mc},512:{f:SB},513:{f:lge},515:{f:Mde},516:{f:yde},517:{f:bB},519:{f:cge},520:{f:ade},523:{},545:{f:TB},549:{f:CB},566:{},574:{f:fde},638:{f:Ede},659:{},1048:{},1054:{f:Sde},1084:{},1212:{f:$de},2048:{f:Jde},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:dC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:mc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nge,r:12},2173:{f:Zme,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Lde,r:12},2197:{},2198:{f:Yme,r:12},2199:{},2200:{},2201:{},2202:{f:Bde,r:12},2203:{f:mc},2204:{},2205:{},2206:{},2207:{},2211:{f:lde},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:oge},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:tge},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:SB},1:{},2:{f:mge},3:{f:dge},4:{f:fge},5:{f:bB},7:{f:vge},8:{},9:{f:dC},11:{},22:{f:Rn},30:{f:bde},31:{},32:{},33:{f:TB},36:{},37:{f:CB},50:{f:wge},62:{},52:{},67:{},68:{f:Rn},69:{},86:{},126:{},127:{f:hge},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yge},223:{},234:{},354:{},421:{},518:{f:ak},521:{f:dC},536:{f:RB},547:{f:EB},561:{},579:{},1030:{f:ak},1033:{f:dC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Oe(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&eD(r)&&t.push(r)}}function p1e(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Oe(t,e,r,i);var s=e;if(!isNaN(s)){for(var o=r.parts||[],a=0,l=0,u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;var c=t.next(4);for(c.write_shift(2,s),c.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(c=t.next(4),c.write_shift(2,60),u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;c.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function n1(t,e,r){return t||(t=ve(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function v1e(t,e,r,n){var i=ve(9);return n1(i,t,e),xG(r,n||"b",i),i}function w1e(t,e,r){var n=ve(8+2*r.length);return n1(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function y1e(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?jn(Pr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Oe(t,2,pge(r,n,i)):Oe(t,3,gge(r,n,i));return;case"b":case"e":Oe(t,5,v1e(r,n,e.v,e.t));return;case"s":case"str":Oe(t,4,w1e(r,n,(e.v||"").slice(0,255)));return}Oe(t,1,n1(null,r,n))}function C1e(t,e,r,n){var i=Array.isArray(e),s=It(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=dt(s)}for(var u=s.s.r;u<=s.e.r;++u){a=sn(u);for(var c=s.s.c;c<=s.e.c;++c){u===s.s.r&&(l[c]=kr(c)),o=l[c]+a;var h=i?(e[u]||[])[c]:e[o];h&&y1e(t,h,u,c)}}}function S1e(t,e){for(var r=e||{},n=As(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Oe(n,r.biff==4?1033:r.biff==3?521:9,cD(t,16,r)),C1e(n,t.Sheets[t.SheetNames[i]],i,r),Oe(n,10),n.end()}function x1e(t,e,r){Oe(t,49,pde({sz:12,name:"Arial"},r))}function b1e(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Oe(t,1054,xde(i,e[i],r))})}function _1e(t,e){var r=ve(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Oe(t,2151,r),r=ve(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),TG(It(e["!ref"]||"A1"),r),r.write_shift(4,4),Oe(t,2152,r)}function E1e(t,e){for(var r=0;r<16;++r)Oe(t,224,xB({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Oe(t,224,xB(n,0,e))})}function R1e(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Oe(t,440,qde(n)),n[1].Tooltip&&Oe(t,2048,Qde(n))}delete e["!links"]}function T1e(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Oe(t,125,ige(sR(i,n),i))})}}function k1e(t,e,r,n,i){var s=16+$h(i.cellXfs,e,i);if(e.v==null&&!e.bf){Oe(t,513,Td(r,n,s));return}if(e.bf)Oe(t,6,tve(e,r,n,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?jn(Pr(e.v)):e.v;Oe(t,515,Nde(r,n,o,s));break;case"b":case"e":Oe(t,517,Ode(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=wD(i.Strings,e.v,i.revStrings);Oe(t,253,wde(r,n,a,s))}else Oe(t,516,Cde(r,n,(e.v||"").slice(0,255),s,i));break;default:Oe(t,513,Td(r,n,s))}}function P1e(t,e,r){var n=As(),i=r.SheetNames[t],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,c,h="",f=[],d=It(s["!ref"]||"A1"),g=u?65536:16384;if(d.e.c>255||d.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}Oe(n,2057,cD(r,16,e)),Oe(n,13,Ro(1)),Oe(n,12,Ro(100)),Oe(n,15,Yi(!0)),Oe(n,17,Yi(!1)),Oe(n,16,Ed(.001)),Oe(n,95,Yi(!0)),Oe(n,42,Yi(!1)),Oe(n,43,Yi(!1)),Oe(n,130,Ro(1)),Oe(n,128,Ide()),Oe(n,131,Yi(!1)),Oe(n,132,Yi(!1)),u&&T1e(n,s["!cols"]),Oe(n,512,_de(d,e)),u&&(s["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=sn(m);for(var p=d.s.c;p<=d.e.c;++p){m===d.s.r&&(f[p]=kr(p)),c=f[p]+h;var w=l?(s[m]||[])[p]:s[c];w&&(k1e(n,w,m,p,e),u&&w.l&&s["!links"].push([c,w.l]))}}var v=a.CodeName||a.name||i;return u&&Oe(n,574,dde((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Oe(n,229,Ude(s["!merges"])),u&&R1e(n,s),Oe(n,442,bG(v)),u&&_1e(n,s),Oe(n,10),n.end()}function A1e(t,e,r){var n=As(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,l=r.biff==5;if(Oe(n,2057,cD(t,5,r)),r.bookType=="xla"&&Oe(n,135),Oe(n,225,a?Ro(1200):null),Oe(n,193,Ofe(2)),l&&Oe(n,191),l&&Oe(n,192),Oe(n,226),Oe(n,92,ede("SheetJS",r)),Oe(n,66,Ro(a?1200:1252)),a&&Oe(n,353,Ro(0)),a&&Oe(n,448),Oe(n,317,age(t.SheetNames.length)),a&&t.vbaraw&&Oe(n,211),a&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";Oe(n,442,bG(u))}Oe(n,156,Ro(17)),Oe(n,25,Yi(!1)),Oe(n,18,Yi(!1)),Oe(n,19,Ro(0)),a&&Oe(n,431,Yi(!1)),a&&Oe(n,444,Ro(0)),Oe(n,61,hde()),Oe(n,64,Yi(!1)),Oe(n,141,Ro(0)),Oe(n,34,Yi(uye(t)=="true")),Oe(n,14,Yi(!0)),a&&Oe(n,439,Yi(!1)),Oe(n,218,Ro(0)),x1e(n,t,r),b1e(n,t.SSF,r),E1e(n,r),a&&Oe(n,352,Yi(!1));var c=n.end(),h=As();a&&Oe(h,140,ege()),a&&r.Strings&&p1e(h,252,sde(r.Strings)),Oe(h,10);var f=h.end(),d=As(),g=0,m=0;for(m=0;m<t.SheetNames.length;++m)g+=(a?12:11)+(a?2:1)*t.SheetNames[m].length;var p=c.length+g+f.length;for(m=0;m<t.SheetNames.length;++m){var w=s[m]||{};Oe(d,133,nde({pos:p,hs:w.Hidden||0,dt:0,name:t.SheetNames[m]},r)),p+=e[m].length}var v=d.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var y=[];return c.length&&y.push(c),v.length&&y.push(v),f.length&&y.push(f),Jn(y)}function I1e(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vr(rt)),t&&t.SSF&&(Mp(),qy(t.SSF),r.revssf=ZE(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,_D(r),r.cellXfs=[],$h(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=P1e(i,r,t);return n.unshift(A1e(t,n,r)),Jn(n)}function pY(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Zi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return I1e(t,e);case 4:case 3:case 2:return S1e(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function HB(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=i.index,a=s&&s.index||t.length,l=phe(t.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,c=0,h=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var m=l[o].trim(),p=m.slice(0,3).toLowerCase();if(p=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}c=0;continue}if(!(p!="<td"&&p!="<th")){var w=m.split(/<\/t[dh]>/i);for(a=0;a<w.length;++a){var v=w[a].trim();if(v.match(/<t[dh]/i)){for(var y=v,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var T=0;T<g.length;++T){var E=g[T];E.s.c==c&&E.s.r<u&&u<=E.e.r&&(c=E.e.c+1,T=-1)}var x=it(v.slice(0,v.indexOf(">")));f=x.colspan?+x.colspan:1,((h=+x.rowspan)>1||f>1)&&g.push({s:{r:u,c},e:{r:u+(h||1)-1,c:c+f-1}});var P=x.t||x["data-t"]||"";if(!y.length){c+=f;continue}if(y=U9(y),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>c&&(d.s.c=c),d.e.c<c&&(d.e.c=c),!y.length){c+=f;continue}var A={t:"s",v:y};r.raw||!y.trim().length||P=="s"||(y==="TRUE"?A={t:"b",v:!0}:y==="FALSE"?A={t:"b",v:!1}:isNaN(Ia(y))?isNaN(fp(y).getDate())||(A={t:"d",v:Pr(y)},r.cellDates||(A={t:"n",v:jn(A.v)}),A.z=r.dateNF||rt[14]):A={t:"n",v:Ia(y)}),r.dense?(n[u]||(n[u]=[]),n[u][c]=A):n[nt({r:u,c})]=A,c+=f}}}}return n["!ref"]=dt(d),g.length&&(n["!merges"]=g),n}function vY(t,e,r,n){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){a=-1;break}a=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(a<0)){var c=nt({r,c:o}),h=n.dense?(t[r]||[])[o]:t[c],f=h&&h.v!=null&&(h.h||YN(h.w||(Fl(h),h.w)||""))||"",d={};a>1&&(d.rowspan=a),l>1&&(d.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(n.id||"sjs")+"-"+c,s.push(Ie("td",f,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var wY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',yY="</body></html>";function O1e(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Lh(HB(r[0],e),e);var n=PD();return r.forEach(function(i,s){AD(n,HB(i,e),"Sheet"+(s+1))}),n}function CY(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function SY(t,e){var r=e||{},n=r.header!=null?r.header:wY,i=r.footer!=null?r.footer:yY,s=[n],o=Zi(t["!ref"]);r.dense=Array.isArray(t),s.push(CY(t,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(vY(t,o,a,r));return s.push("</table>"+i),s.join("")}function xY(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?zr(n.origin):n.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var c=Zi(t["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),i==-1&&(u.e.r=i=c.e.r+1)}var h=[],f=0,d=t["!rows"]||(t["!rows"]=[]),g=0,m=0,p=0,w=0,v=0,y=0;for(t["!cols"]||(t["!cols"]=[]);g<a.length&&m<l;++g){var b=a[g];if(LB(b)){if(n.display)continue;d[m]={hidden:!0}}var T=b.children;for(p=w=0;p<T.length;++p){var E=T[p];if(!(n.display&&LB(E))){var x=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):U9(E.innerHTML),P=E.getAttribute("data-z")||E.getAttribute("z");for(f=0;f<h.length;++f){var A=h[f];A.s.c==w+s&&A.s.r<m+i&&m+i<=A.e.r&&(w=A.e.c+1-s,f=-1)}y=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:m+i,c:w+s},e:{r:m+i+(v||1)-1,c:w+s+(y||1)-1}});var O={t:"s",v:x},Y=E.getAttribute("data-t")||E.getAttribute("t")||"";x!=null&&(x.length==0?O.t=Y||"z":n.raw||x.trim().length==0||Y=="s"||(x==="TRUE"?O={t:"b",v:!0}:x==="FALSE"?O={t:"b",v:!1}:isNaN(Ia(x))?isNaN(fp(x).getDate())||(O={t:"d",v:Pr(x)},n.cellDates||(O={t:"n",v:jn(O.v)}),O.z=n.dateNF||rt[14]):O={t:"n",v:Ia(x)})),O.z===void 0&&P!=null&&(O.z=P);var L="",ie=E.getElementsByTagName("A");if(ie&&ie.length)for(var ce=0;ce<ie.length&&!(ie[ce].hasAttribute("href")&&(L=ie[ce].getAttribute("href"),L.charAt(0)!="#"));++ce);L&&L.charAt(0)!="#"&&(O.l={Target:L}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][w+s]=O):t[nt({c:w+s,r:m+i})]=O,u.e.c<w+s&&(u.e.c=w+s),w+=y}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,m-1+i),t["!ref"]=dt(u),m>=l&&(t["!fullref"]=dt((u.e.r=a.length-g+m-1+i,u))),t}function bY(t,e){var r=e||{},n=r.dense?[]:{};return xY(n,t,e)}function M1e(t,e){return Lh(bY(t,e),e)}function LB(t){var e="",r=N1e(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function N1e(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function D1e(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(e.replace(/<[^>]*>/g,""));return[r]}var $B={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _Y(t,e){var r=e||{},n=KN(t),i=[],s,o,a={name:""},l="",u=0,c,h,f={},d=[],g=r.dense?[]:{},m,p,w={value:""},v="",y=0,b=[],T=-1,E=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,A={},O=[],Y={},L=0,ie=0,ce=[],he=1,Ee=1,Ce=[],ge={Names:[]},Q={},ye=["",""],Re=[],W={},C="",S=0,_=!1,D=!1,U=0;for(ey.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=ey.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(x.e.c>=x.s.c&&x.e.r>=x.s.r?g["!ref"]=dt(x):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=x.e.r&&(g["!fullref"]=g["!ref"],x.e.r=r.sheetRows-1,g["!ref"]=dt(x)),O.length&&(g["!merges"]=O),ce.length&&(g["!rows"]=ce),c.name=c.名称||c.name,typeof JSON<"u"&&JSON.stringify(c),d.push(c.name),f[c.name]=g,D=!1):m[0].charAt(m[0].length-2)!=="/"&&(c=it(m[0],!1),T=E=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,g=r.dense?[]:{},O=[],ce=[],D=!0);break;case"table-row-group":m[1]==="/"?--P:++P;break;case"table-row":case"行":if(m[1]==="/"){T+=he,he=1;break}if(h=it(m[0],!1),h.行号?T=h.行号-1:T==-1&&(T=0),he=+h["number-rows-repeated"]||1,he<10)for(U=0;U<he;++U)P>0&&(ce[T+U]={level:P});E=-1;break;case"covered-table-cell":m[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(g[T]||(g[T]=[]),g[T][E]={t:"z"}):g[nt({r:T,c:E})]={t:"z"}),v="",b=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++E,w=it(m[0],!1),Ee=parseInt(w["number-columns-repeated"]||"1",10),p={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(p.f=NB(jt(w.formula))),(w.数据类型||w["value-type"])=="string"&&(p.t="s",p.v=jt(w["string-value"]||""),r.dense?(g[T]||(g[T]=[]),g[T][E]=p):g[nt({r:T,c:E})]=p),E+=Ee-1;else if(m[1]!=="/"){++E,v="",y=0,b=[],Ee=1;var X=he?T+he-1:T;if(E>x.e.c&&(x.e.c=E),E<x.s.c&&(x.s.c=E),T<x.s.r&&(x.s.r=T),X>x.e.r&&(x.e.r=X),w=it(m[0],!1),Re=[],W={},p={t:w.数据类型||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=jt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(L=parseInt(w["number-matrix-rows-spanned"],10)||0,ie=parseInt(w["number-matrix-columns-spanned"],10)||0,Y={s:{r:T,c:E},e:{r:T+L-1,c:E+ie-1}},p.F=dt(Y),Ce.push([Y,p.F])),w.formula)p.f=NB(w.formula);else for(U=0;U<Ce.length;++U)T>=Ce[U][0].s.r&&T<=Ce[U][0].e.r&&E>=Ce[U][0].s.c&&E<=Ce[U][0].e.c&&(p.F=Ce[U][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(L=parseInt(w["number-rows-spanned"],10)||0,ie=parseInt(w["number-columns-spanned"],10)||0,Y={s:{r:T,c:E},e:{r:T+L-1,c:E+ie-1}},O.push(Y)),w["number-columns-repeated"]&&(Ee=parseInt(w["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=Rr(w["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(w.value);break;case"percentage":p.t="n",p.v=parseFloat(w.value);break;case"currency":p.t="n",p.v=parseFloat(w.value);break;case"date":p.t="d",p.v=Pr(w["date-value"]),r.cellDates||(p.t="n",p.v=jn(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=dhe(w["time-value"])/86400,r.cellDates&&(p.t="d",p.v=eR(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(w.数据数值);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",w["string-value"]!=null&&(v=jt(w["string-value"]),b=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(_=!1,p.t==="s"&&(p.v=v||"",b.length&&(p.R=b),_=y==0),Q.Target&&(p.l=Q),Re.length>0&&(p.c=Re,Re=[]),v&&r.cellText!==!1&&(p.w=v),_&&(p.t="z",delete p.v),(!_||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var ee=0;ee<he;++ee){if(Ee=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(g[T+ee]||(g[T+ee]=[]),g[T+ee][E]=ee==0?p:vr(p);--Ee>0;)g[T+ee][E+Ee]=vr(p);else for(g[nt({r:T+ee,c:E})]=p;--Ee>0;)g[nt({r:T+ee,c:E+Ee})]=vr(p);x.e.c<=E&&(x.e.c=E)}Ee=parseInt(w["number-columns-repeated"]||"1",10),E+=Ee-1,Ee=0,p={},v="",b=[]}Q={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;W.t=v,b.length&&(W.R=b),W.a=C,Re.push(W)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);C="",S=0,v="",y=0,b=[];break;case"creator":m[1]==="/"?C=n.slice(S,m.index):S=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);v="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(A[a.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",a=it(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=it(m[0],!1),l+=$B[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=it(m[0],!1),l+=$B[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":o=it(m[0],!1),ye=lk(o["cell-range-address"]);var k={Name:o.name,Ref:ye[0]+"!"+ye[1]};D&&(k.Sheet=d.length),ge.Names.push(k);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!w||!w["string-value"])){var M=D1e(n.slice(y,m.index));v=(v.length>0?v+`
`:"")+M[0]}else it(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ye=lk(it(m[0])["target-range-address"]),f[ye[0]]["!autofilter"]={ref:ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(Q=it(m[0],!1),!Q.href)break;Q.Target=jt(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(ye=lk(Q.Target.slice(1)),Q.Target="#"+ye[0]+"!"+ye[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var R={Sheets:f,SheetNames:d,Workbook:ge};return r.bookSheets&&delete R.Sheets,R}function BB(t,e){e=e||{},_o(t,"META-INF/manifest.xml")&&dfe(En(t,"META-INF/manifest.xml"),e);var r=qs(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=_Y(hr(r),e);return _o(t,"meta.xml")&&(n.Props=cG(En(t,"meta.xml"))),n}function VB(t,e){return _Y(t,e)}var F1e=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Zw({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return pn+e}}(),WB=function(){var t=function(s){return ar(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,a){var l=[];l.push('      <table:table table:name="'+ar(o.SheetNames[a])+`" table:style-name="ta1">
`);var u=0,c=0,h=Zi(s["!ref"]||"A1"),f=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var m="",p=s["!rows"]||[];for(u=0;u<h.s.r;++u)m=p[u]?' table:style-name="ro'+p[u].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=h.e.r;++u){for(m=p[u]?' table:style-name="ro'+p[u].ods+'"':"",l.push("        <table:table-row"+m+`>
`),c=0;c<h.s.c;++c)l.push(e);for(;c<=h.e.c;++c){var w=!1,v={},y="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>c)&&!(f[d].s.r>u)&&!(f[d].e.c<c)&&!(f[d].e.r<u)){(f[d].s.c!=c||f[d].s.r!=u)&&(w=!0),v["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,v["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(w){l.push(r);continue}var b=nt({r:u,c}),T=g?(s[u]||[])[c]:s[b];if(T&&T.f&&(v["table:formula"]=ar(ave(T.f)),T.F&&T.F.slice(0,b.length)==b)){var E=Zi(T.F);v["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,v["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!T){l.push(e);continue}switch(T.t){case"b":y=T.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=T.v?"true":"false";break;case"n":y=T.w||String(T.v||0),v["office:value-type"]="float",v["office:value"]=T.v||0;break;case"s":case"str":y=T.v==null?"":T.v,v["office:value-type"]="string";break;case"d":y=T.w||Pr(T.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Pr(T.v).toISOString(),v["table:style-name"]="ce1";break;default:l.push(e);continue}var x=t(y);if(T.l&&T.l.Target){var P=T.l.Target;P=P.charAt(0)=="#"?"#"+lve(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),x=Ie("text:a",x,{"xlink:href":P.replace(/&/g,"&amp;")})}l.push("          "+Ie("table:table-cell",Ie("text:p",x,{}),v)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var h=u["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;kh(h),h.ods=a;var f=u["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var h=u["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[pn],u=Zw({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=Zw({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(uG().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(n(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function EY(t,e){if(e.bookType=="fods")return WB(t,e);var r=UN(),n="",i=[],s=[];return n="mimetype",gt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",gt(r,n,WB(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",gt(r,n,F1e(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",gt(r,n,pn+uG()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",gt(r,n,pfe(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",gt(r,n,gfe(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function kd(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ZO(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):hr(Hh(t))}function H1e(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Xs(Pl(t))}function L1e(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Ah(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function jB(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function $1e(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function B1e(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function ay(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function sr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function on(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Gt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=ay(t,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);a=t.slice(l,r[0])}break;case 5:o=4,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ay(t,r),a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:a,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function ni(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(sr(n*8+i.type)),i.type==2&&e.push(sr(i.data.length)),e.push(i.data))})}),Ah(e)}function xD(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function So(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=ay(t,n),s=Gt(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:on(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Gt(a.data),u=on(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=on(s[3][0].data)>>>0>0),r.push(o)}return r}function cg(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:sr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:sr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:sr(o.data.length)}],n[2].push({data:ni(o.meta),type:2})});var s=ni(n);e.push(sr(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),Ah(e)}function V1e(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ay(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[r[0]],a>1&&(o|=e[r[0]+1]<<8),a>2&&(o|=e[r[0]+2]<<16),a>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ah(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var c=Ah(i);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function xo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(V1e(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Ah(e)}function hg(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=sr(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Ah(e)}function W1e(t,e,r,n){var i=kd(t),s=i.getUint32(4,!0),o=(n>1?12:8)+jB(s&(n>1?3470:398))*4,a=-1,l=-1,u=NaN,c=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=jB(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(c.setTime(c.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function j1e(t,e,r){var n=kd(t),i=n.getUint32(8,!0),s=12,o=-1,a=-1,l=NaN,u=NaN,c=new Date(2001,0,1);i&1&&(l=$1e(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(c.setTime(c.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[a]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function ck(t,e){var r=new Uint8Array(32),n=kd(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,B1e(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function hk(t,e){var r=new Uint8Array(32),n=kd(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function U1e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return W1e(t,e,r,t[0]);case 5:return j1e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function xi(t){var e=Gt(t);return ay(e[1][0].data)}function UB(t,e){var r=Gt(e.data),n=on(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var a=Gt(o.data),l=on(a[1][0].data)>>>0;switch(n){case 1:s[l]=ZO(a[3][0].data);break;case 8:{var u=t[xi(a[9][0].data)][0],c=Gt(u.data),h=t[xi(c[1][0].data)][0],f=on(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var d=Gt(h.data);s[l]=d[3].map(function(g){return ZO(g.data)}).join("")}break}}),s}function z1e(t,e){var r,n,i,s,o,a,l,u,c,h,f,d,g,m,p=Gt(t),w=on(p[1][0].data)>>>0,v=on(p[2][0].data)>>>0,y=((n=(r=p[8])==null?void 0:r[0])==null?void 0:n.data)&&on(p[8][0].data)>0||!1,b,T;if((s=(i=p[7])==null?void 0:i[0])!=null&&s.data&&e!=0)b=(a=(o=p[7])==null?void 0:o[0])==null?void 0:a.data,T=(u=(l=p[6])==null?void 0:l[0])==null?void 0:u.data;else if((h=(c=p[4])==null?void 0:c[0])!=null&&h.data&&e!=1)b=(d=(f=p[4])==null?void 0:f[0])==null?void 0:d.data,T=(m=(g=p[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var E=y?4:1,x=kd(b),P=[],A=0;A<b.length/2;++A){var O=x.getUint16(A*2,!0);O<65535&&P.push([A,O])}if(P.length!=v)throw"Expected ".concat(v," cells, found ").concat(P.length);var Y=[];for(A=0;A<P.length-1;++A)Y[P[A][0]]=T.subarray(P[A][1]*E,P[A+1][1]*E);return P.length>=1&&(Y[P[P.length-1][0]]=T.subarray(P[P.length-1][1]*E)),{R:w,cells:Y}}function G1e(t,e){var r,n=Gt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?on(n[7][0].data)>>>0>0?1:0:-1,s=xD(n[5],function(o){return z1e(o,i)});return{nrows:on(n[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,u){if(o[a.R][u])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(u));o[a.R][u]=l}),o},[])}}function Y1e(t,e,r){var n,i=Gt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(on(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(on(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=dt(s);var o=Gt(i[4][0].data),a=UB(t,t[xi(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?UB(t,t[xi(o[17][0].data)][0]):[],u=Gt(o[3][0].data),c=0;u[1].forEach(function(h){var f=Gt(h.data),d=t[xi(f[2][0].data)][0],g=on(d.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=G1e(t,d);m.data.forEach(function(p,w){p.forEach(function(v,y){var b=nt({r:c+w,c:y}),T=U1e(v,a,l);T&&(r[b]=T)})}),c+=m.nrows})}function K1e(t,e){var r=Gt(e.data),n={"!ref":"A1"},i=t[xi(r[2][0].data)],s=on(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Y1e(t,i[0],n),n}function X1e(t,e){var r,n=Gt(e.data),i={name:(r=n[1])!=null&&r[0]?ZO(n[1][0].data):"",sheets:[]},s=xD(n[2],xi);return s.forEach(function(o){t[o].forEach(function(a){var l=on(a.meta[1][0].data);l==6e3&&i.sheets.push(K1e(t,a))})}),i}function q1e(t,e){var r=PD(),n=Gt(e.data),i=xD(n[1],xi);if(i.forEach(function(s){t[s].forEach(function(o){var a=on(o.meta[1][0].data);if(a==2){var l=X1e(t,o);l.sheets.forEach(function(u,c){AD(r,u,c==0?l.name:l.name+"_"+c,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function fk(t){var e,r,n,i,s={},o=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=xo(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var c;try{c=So(u)}catch(h){return console.log("## "+(h.message||h))}c.forEach(function(h){s[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&on(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(l){s[l].forEach(function(u){var c=on(u.meta[1][0].data)>>>0;if(c==1)if(!a)a=u;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return q1e(s,a)}function J1e(t,e,r){var n,i,s,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&on(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,u=kd(t[7][0].data),c=0,h=[],f=kd(t[4][0].data),d=0,g=[],m=0;m<e.length;++m){if(e[m]==null){u.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}u.setUint16(m*2,c,!0),f.setUint16(m*2,d,!0);var p,w;switch(typeof e[m]){case"string":p=ck({t:"s",v:e[m]},r),w=hk({t:"s",v:e[m]},r);break;case"number":p=ck({t:"n",v:e[m]},r),w=hk({t:"n",v:e[m]},r);break;case"boolean":p=ck({t:"b",v:e[m]},r),w=hk({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(p),c+=p.length,g.push(w),d+=w.length,++l}for(t[2][0].data=sr(l);m<t[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return t[6][0].data=Ah(h),t[3][0].data=Ah(g),l}function Q1e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Zi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(dt(n)));var s=i_(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(C){return C.forEach(function(S){typeof S=="string"&&o.push(S)})});var a={},l=[],u=Xe.read(e.numbers,{type:"base64"});u.FileIndex.map(function(C,S){return[C,u.FullPaths[S]]}).forEach(function(C){var S=C[0],_=C[1];if(S.type==2&&S.name.match(/\.iwa/)){var D=S.content,U=xo(D),X=So(U);X.forEach(function(ee){l.push(ee.id),a[ee.id]={deps:[],location:_,type:on(ee.messages[0].meta[1][0].data)}})}}),l.sort(function(C,S){return C-S});var c=l.filter(function(C){return C>1}).map(function(C){return[C,sr(C)]});u.FileIndex.map(function(C,S){return[C,u.FullPaths[S]]}).forEach(function(C){var S=C[0];if(C[1],!!S.name.match(/\.iwa/)){var _=So(xo(S.content));_.forEach(function(D){D.messages.forEach(function(U){c.forEach(function(X){D.messages.some(function(ee){return on(ee.meta[1][0].data)!=11006&&L1e(ee.data,X[1])})&&a[X[0]].deps.push(D.id)})})})}});for(var h=Xe.find(u,a[1].location),f=So(xo(h.content)),d,g=0;g<f.length;++g){var m=f[g];m.id==1&&(d=m)}var p=xi(Gt(d.messages[0].data)[1][0].data);for(h=Xe.find(u,a[p].location),f=So(xo(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);for(p=xi(Gt(d.messages[0].data)[2][0].data),h=Xe.find(u,a[p].location),f=So(xo(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);for(p=xi(Gt(d.messages[0].data)[2][0].data),h=Xe.find(u,a[p].location),f=So(xo(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);var w=Gt(d.messages[0].data);{w[6][0].data=sr(n.e.r+1),w[7][0].data=sr(n.e.c+1);var v=xi(w[46][0].data),y=Xe.find(u,a[v].location),b=So(xo(y.content));{for(var T=0;T<b.length&&b[T].id!=v;++T);if(b[T].id!=v)throw"Bad ColumnRowUIDMapArchive";var E=Gt(b[T].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var x=0;x<=n.e.c;++x){var P=[];P[1]=P[2]=[{type:0,data:sr(x+420690)}],E[1].push({type:2,data:ni(P)}),E[2].push({type:0,data:sr(x)}),E[3].push({type:0,data:sr(x)})}E[4]=[],E[5]=[],E[6]=[];for(var A=0;A<=n.e.r;++A)P=[],P[1]=P[2]=[{type:0,data:sr(A+726270)}],E[4].push({type:2,data:ni(P)}),E[5].push({type:0,data:sr(A)}),E[6].push({type:0,data:sr(A)});b[T].messages[0].data=ni(E)}y.content=hg(cg(b)),y.size=y.content.length,delete w[46];var O=Gt(w[4][0].data);{O[7][0].data=sr(n.e.r+1);var Y=Gt(O[1][0].data),L=xi(Y[2][0].data);y=Xe.find(u,a[L].location),b=So(xo(y.content));{if(b[0].id!=L)throw"Bad HeaderStorageBucket";var ie=Gt(b[0].messages[0].data);for(A=0;A<s.length;++A){var ce=Gt(ie[2][0].data);ce[1][0].data=sr(A),ce[4][0].data=sr(s[A].length),ie[2][A]={type:ie[2][0].type,data:ni(ce)}}b[0].messages[0].data=ni(ie)}y.content=hg(cg(b)),y.size=y.content.length;var he=xi(O[2][0].data);y=Xe.find(u,a[he].location),b=So(xo(y.content));{if(b[0].id!=he)throw"Bad HeaderStorageBucket";for(ie=Gt(b[0].messages[0].data),x=0;x<=n.e.c;++x)ce=Gt(ie[2][0].data),ce[1][0].data=sr(x),ce[4][0].data=sr(n.e.r+1),ie[2][x]={type:ie[2][0].type,data:ni(ce)};b[0].messages[0].data=ni(ie)}y.content=hg(cg(b)),y.size=y.content.length;var Ee=xi(O[4][0].data);(function(){for(var C=Xe.find(u,a[Ee].location),S=So(xo(C.content)),_,D=0;D<S.length;++D){var U=S[D];U.id==Ee&&(_=U)}var X=Gt(_.messages[0].data);{X[3]=[];var ee=[];o.forEach(function(R,V){ee[1]=[{type:0,data:sr(V)}],ee[2]=[{type:0,data:sr(1)}],ee[3]=[{type:2,data:H1e(R)}],X[3].push({type:2,data:ni(ee)})})}_.messages[0].data=ni(X);var k=cg(S),M=hg(k);C.content=M,C.size=C.content.length})();var Ce=Gt(O[3][0].data);{var ge=Ce[1][0];delete Ce[2];var Q=Gt(ge.data);{var ye=xi(Q[2][0].data);(function(){for(var C=Xe.find(u,a[ye].location),S=So(xo(C.content)),_,D=0;D<S.length;++D){var U=S[D];U.id==ye&&(_=U)}var X=Gt(_.messages[0].data);{delete X[6],delete Ce[7];var ee=new Uint8Array(X[5][0].data);X[5]=[];for(var k=0,M=0;M<=n.e.r;++M){var R=Gt(ee);k+=J1e(R,s[M],o),R[1][0].data=sr(M),X[5].push({data:ni(R),type:2})}X[1]=[{type:0,data:sr(n.e.c+1)}],X[2]=[{type:0,data:sr(n.e.r+1)}],X[3]=[{type:0,data:sr(k)}],X[4]=[{type:0,data:sr(n.e.r+1)}]}_.messages[0].data=ni(X);var V=cg(S),q=hg(V);C.content=q,C.size=C.content.length})()}ge.data=ni(Q)}O[3][0].data=ni(Ce)}w[4][0].data=ni(O)}d.messages[0].data=ni(w);var Re=cg(f),W=hg(Re);return h.content=W,h.size=h.content.length,u}function RY(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function bD(t){RY([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function _D(t){RY([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Z1e(t){return _t.WS.indexOf(t)>-1?"sheet":t==_t.CS?"chart":t==_t.DS?"dialog":t==_t.MS?"macro":t&&t.length?t:"sheet"}function eCe(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Z1e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function tCe(t,e,r,n,i,s,o,a,l,u,c,h){try{s[n]=Yv(qs(t,r,!0),e);var f=En(t,e),d;switch(a){case"sheet":d=Tye(f,e,i,l,s[n],u,c,h);break;case"chart":if(d=kye(f,e,i,l,s[n],u,c,h),!d||!d["!drawel"])break;var g=_v(d["!drawel"].Target,e),m=ty(g),p=mpe(qs(t,g,!0),Yv(qs(t,m,!0),g)),w=_v(p,g),v=ty(w);d=rye(qs(t,w,!0),w,l,Yv(qs(t,v,!0),w),u,d);break;case"macro":d=Pye(f,e,i,l,s[n],u,c,h);break;case"dialog":d=Aye(f,e,i,l,s[n],u,c,h);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=d;var y=[];s&&s[n]&&ln(s[n]).forEach(function(b){var T="";if(s[n][b].Type==_t.CMNT){T=_v(s[n][b].Target,e);var E=Nye(En(t,T,!0),T,l);if(!E||!E.length)return;PB(d,E,!1)}s[n][b].Type==_t.TCMNT&&(T=_v(s[n][b].Target,e),y=y.concat(vpe(En(t,T,!0),l)))}),y&&y.length&&PB(d,y,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function fo(t){return t.charAt(0)=="/"?t.slice(1):t}function TY(t,e){if(Mp(),e=e||{},bD(e),_o(t,"META-INF/manifest.xml")||_o(t,"objectdata.xml"))return BB(t,e);if(_o(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fk<"u"){if(t.FileIndex)return fk(t);var r=Xe.utils.cfb_new();return q3(t).forEach(function(ce){gt(r,ce,whe(t,ce))}),fk(r)}throw new Error("Unsupported NUMBERS file")}if(!_o(t,"[Content_Types].xml"))throw _o(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_o(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=q3(t),i=hfe(qs(t,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",En(t,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!En(t,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Kv=[],i.sst)try{Kv=Mye(En(t,fo(i.sst)),i.sst,e)}catch(ce){if(e.WTF)throw ce}e.cellStyles&&i.themes.length&&(l=Oye(qs(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=Iye(En(t,fo(i.style)),i.style,l,e))}i.links.map(function(ce){try{var he=Yv(qs(t,ty(fo(ce))),ce);return Fye(En(t,fo(ce)),he,ce,e)}catch{}});var c=Rye(En(t,fo(i.workbooks[0])),i.workbooks[0],e),h={},f="";i.coreprops.length&&(f=En(t,fo(i.coreprops[0]),!0),f&&(h=cG(f)),i.extprops.length!==0&&(f=En(t,fo(i.extprops[0]),!0),f&&wfe(f,h,e)));var d={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(f=qs(t,fo(i.custprops[0]),!0),f&&(d=Cfe(f,e)));var g={};if((e.bookSheets||e.bookProps)&&(c.Sheets?o=c.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=d),e.bookSheets&&typeof o<"u"&&(g.SheetNames=o),e.bookSheets?g.SheetNames:e.bookProps))return g;o={};var m={};e.bookDeps&&i.calcchain&&(m=Dye(En(t,fo(i.calcchain)),i.calcchain));var p=0,w={},v,y;{var b=c.Sheets;h.Worksheets=b.length,h.SheetNames=[];for(var T=0;T!=b.length;++T)h.SheetNames[T]=b[T].name}var E=s?"bin":"xml",x=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,x+1)+"_rels/"+i.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");_o(t,P)||(P="xl/_rels/workbook."+E+".rels");var A=Yv(qs(t,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=Hye(En(t,fo(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=ype(En(t,fo(i.people[0])),e)),A&&(A=eCe(A,c.Sheets));var O=En(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=h.Worksheets;++p){var Y="sheet";if(A&&A[p]?(v="xl/"+A[p][1].replace(/[\/]?xl\//,""),_o(t,v)||(v=A[p][1]),_o(t,v)||(v=P.replace(/_rels\/.*$/,"")+A[p][1]),Y=A[p][2]):(v="xl/worksheets/sheet"+(p+1-O)+"."+E,v=v.replace(/sheet0\./,"sheet.")),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(p!=e.sheets)continue e;break;case"string":if(h.SheetNames[p].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var L=!1,ie=0;ie!=e.sheets.length;++ie)typeof e.sheets[ie]=="number"&&e.sheets[ie]==p&&(L=1),typeof e.sheets[ie]=="string"&&e.sheets[ie].toLowerCase()==h.SheetNames[p].toLowerCase()&&(L=1);if(!L)continue e}}tCe(t,v,y,h.SheetNames[p],p,w,o,Y,e,c,l,u)}return g={Directory:i,Workbook:c,Props:h,Custprops:d,Deps:m,Sheets:o,SheetNames:h.SheetNames,Strings:Kv,Styles:u,Themes:l,SSF:vr(rt)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(ce,he){ce=ce.replace(/^Root Entry[\/]/,""),g.keys.push(ce),g.files[ce]=t.FileIndex[he]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=En(t,fo(i.vba[0]),!0):i.defaults&&i.defaults.bin===Tpe&&(g.vbaraw=En(t,"xl/vbaProject.bin",!0))),g}function rCe(t,e){var r=e||{},n="Workbook",i=Xe.find(t,n);try{if(n="/!DataSpaces/Version",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Lge(i.content),n="/!DataSpaces/DataSpaceMap",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Bge(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Vge(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);jge(i.content)}catch{}if(n="/EncryptionInfo",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Uge(i.content);if(n="/EncryptedPackage",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function nCe(t,e){return e.bookType=="ods"?EY(t,e):e.bookType=="numbers"?Q1e(t,e):e.bookType=="xlsb"?iCe(t,e):kY(t,e)}function iCe(t,e){Tm=1024,t&&!t.SSF&&(t.SSF=vr(rt)),t&&t.SSF&&(Mp(),qy(t.SSF),e.revssf=ZE(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Xv?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=XG.indexOf(e.bookType)>-1,i=lD();_D(e=e||{});var s=UN(),o="",a=0;if(e.cellXfs=[],$h(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",gt(s,o,hG(t.Props,e)),i.coreprops.push(o),or(e.rels,2,o,_t.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,gt(s,o,gG(t.Props)),i.extprops.push(o),or(e.rels,3,o,_t.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(o="docProps/custom.xml",gt(s,o,mG(t.Custprops)),i.custprops.push(o),or(e.rels,4,o,_t.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var c={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,gt(s,o,$ye(a-1,o,e,t,c)),i.sheets.push(o),or(e.wbrels,-1,"worksheets/sheet"+a+"."+r,_t.WS[0])}if(h){var d=h["!comments"],g=!1,m="";d&&d.length>0&&(m="xl/comments"+a+"."+r,gt(s,m,Wye(d,m)),i.comments.push(m),or(c,-1,"../comments"+a+"."+r,_t.CMNT),g=!0),h["!legacy"]&&g&&gt(s,"xl/drawings/vmlDrawing"+a+".vml",YG(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&gt(s,ty(o),jm(c))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,gt(s,o,Vye(e.Strings,o,e)),i.strs.push(o),or(e.wbrels,-1,"sharedStrings."+r,_t.SST)),o="xl/workbook."+r,gt(s,o,Lye(t,o)),i.workbooks.push(o),or(e.rels,1,o,_t.WB),o="xl/theme/theme1.xml",gt(s,o,gD(t.Themes,e)),i.themes.push(o),or(e.wbrels,-1,"theme/theme1.xml",_t.THEME),o="xl/styles."+r,gt(s,o,Bye(t,o,e)),i.styles.push(o),or(e.wbrels,-1,"styles."+r,_t.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",gt(s,o,t.vbaraw),i.vba.push(o),or(e.wbrels,-1,"vbaProject.bin",_t.VBA)),o="xl/metadata."+r,gt(s,o,jye(o)),i.metadata.push(o),or(e.wbrels,-1,"metadata."+r,_t.XLMETA),gt(s,"[Content_Types].xml",lG(i,e)),gt(s,"_rels/.rels",jm(e.rels)),gt(s,"xl/_rels/workbook."+r+".rels",jm(e.wbrels)),delete e.revssf,delete e.ssf,s}function kY(t,e){Tm=1024,t&&!t.SSF&&(t.SSF=vr(rt)),t&&t.SSF&&(Mp(),qy(t.SSF),e.revssf=ZE(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Xv?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=XG.indexOf(e.bookType)>-1,i=lD();_D(e=e||{});var s=UN(),o="",a=0;if(e.cellXfs=[],$h(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",gt(s,o,hG(t.Props,e)),i.coreprops.push(o),or(e.rels,2,o,_t.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,gt(s,o,gG(t.Props)),i.extprops.push(o),or(e.rels,3,o,_t.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(o="docProps/custom.xml",gt(s,o,mG(t.Custprops)),i.custprops.push(o),or(e.rels,4,o,_t.CUST_PROPS));var c=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var h={"!id":{}},f=t.Sheets[t.SheetNames[a-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,gt(s,o,oY(a-1,e,t,h)),i.sheets.push(o),or(e.wbrels,-1,"worksheets/sheet"+a+"."+r,_t.WS[0])}if(f){var g=f["!comments"],m=!1,p="";if(g&&g.length>0){var w=!1;g.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(w=!0)})}),w&&(p="xl/threadedComments/threadedComment"+a+"."+r,gt(s,p,wpe(g,c,e)),i.threadedcomments.push(p),or(h,-1,"../threadedComments/threadedComment"+a+"."+r,_t.TCMNT)),p="xl/comments"+a+"."+r,gt(s,p,KG(g)),i.comments.push(p),or(h,-1,"../comments"+a+"."+r,_t.CMNT),m=!0}f["!legacy"]&&m&&gt(s,"xl/drawings/vmlDrawing"+a+".vml",YG(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&gt(s,ty(o),jm(h))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,gt(s,o,DG(e.Strings,e)),i.strs.push(o),or(e.wbrels,-1,"sharedStrings."+r,_t.SST)),o="xl/workbook."+r,gt(s,o,fY(t)),i.workbooks.push(o),or(e.rels,1,o,_t.WB),o="xl/theme/theme1.xml",gt(s,o,gD(t.Themes,e)),i.themes.push(o),or(e.wbrels,-1,"theme/theme1.xml",_t.THEME),o="xl/styles."+r,gt(s,o,jG(t,e)),i.styles.push(o),or(e.wbrels,-1,"styles."+r,_t.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",gt(s,o,t.vbaraw),i.vba.push(o),or(e.wbrels,-1,"vbaProject.bin",_t.VBA)),o="xl/metadata."+r,gt(s,o,GG()),i.metadata.push(o),or(e.wbrels,-1,"metadata."+r,_t.XLMETA),c.length>1&&(o="xl/persons/person.xml",gt(s,o,Cpe(c)),i.people.push(o),or(e.wbrels,-1,"persons/person.xml",_t.PEOPLE)),gt(s,"[Content_Types].xml",lG(i,e)),gt(s,"_rels/.rels",jm(e.rels)),gt(s,"xl/_rels/workbook."+r+".rels",jm(e.wbrels)),delete e.revssf,delete e.ssf,s}function ED(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=oo(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sCe(t,e){return Xe.find(t,"EncryptedPackage")?rCe(t,e):SD(t,e)}function oCe(t,e){var r,n=t,i=e||{};return i.type||(i.type=xt&&Buffer.isBuffer(t)?"buffer":"base64"),r=V9(n,i),TY(r,i)}function PY(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return JO(t.slice(r),e);default:break e}return dp.to_workbook(t,e)}function aCe(t,e){var r="",n=ED(t,e);switch(e.type){case"base64":r=oo(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=_d(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=hr(r)),e.type="binary",PY(r,e)}function lCe(t,e){var r=t;return e.type=="base64"&&(r=oo(r)),r=Ht.utils.decode(1200,r.slice(2),"str"),e.type="binary",PY(r,e)}function uCe(t){return t.match(/[^\x00-\x7F]/)?Pl(t):t}function dk(t,e,r,n){return n?(r.type="string",dp.to_workbook(t,r)):dp.to_workbook(e,r)}function ly(t,e){JE();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return ly(new Uint8Array(t),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),zm={},r.dateNF&&(zm.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",n=che(t),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=uCe(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=vr(r),r.type="array",ly(BN(n),r)}switch((i=ED(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return sCe(Xe.read(n,r),r);break;case 9:if(i[1]<=8)return SD(n,r);break;case 60:return JO(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Sge(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return MG.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?oCe(n,r):dk(t,n,r,s);case 239:return i[3]===60?JO(n,r):dk(t,n,r,s);case 255:if(i[1]===254)return lCe(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return ld.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return ld.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return qO.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return BG.to_workbook(n,r);break;case 10:case 13:case 32:return aCe(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Cge.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?qO.to_workbook(n,r):dk(t,n,r,s)}function zB(t,e){var r=e||{};return r.type="file",ly(t,r)}function AY(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Jy(e.file,Xe.write(t,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Xe.write(t,e)}function cCe(t,e){var r=vr(e||{}),n=nCe(t,r);return IY(n,r)}function hCe(t,e){var r=vr(e||{}),n=kY(t,r);return IY(n,r)}function IY(t,e){var r={},n=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Xe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Xy(i))}return e.password&&typeof encrypt_agile<"u"?AY(encrypt_agile(i,e.password),e):e.type==="file"?Jy(e.file,i):e.type=="string"?hr(i):i}function fCe(t,e){var r=e||{},n=m1e(t,r);return AY(n,r)}function dl(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return qw(Pl(n));case"binary":return Pl(n);case"string":return t;case"file":return Jy(e.file,n,"utf8");case"buffer":return xt?tc(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):dl(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function dCe(t,e){switch(e.type){case"base64":return qw(t);case"binary":return t;case"string":return t;case"file":return Jy(e.file,t,"binary");case"buffer":return xt?tc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function vC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?qw(r):e.type=="string"?hr(r):r;case"file":return Jy(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function RD(t,e){JE(),hY(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=RD(t,r);return r.type="array",Xy(n)}return hCe(t,r)}function oR(t,e){JE(),hY(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=oR(t,r);return r.type="array",Xy(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return dl(l1e(t,r),r);case"slk":case"sylk":return dl(OG.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return dl(SY(t.Sheets[t.SheetNames[i]],r),r);case"txt":return dCe(NY(t.Sheets[t.SheetNames[i]],r),r);case"csv":return dl(kD(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return dl(MG.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return vC(qO.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return dl(dp.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return dl(BG.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return dl(NG.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return dl(EY(t,r),r);case"wk1":return vC(ld.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return vC(ld.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),vC(pY(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fCe(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cCe(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function TD(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function n_(t,e,r){var n=r||{};return n.type="file",n.file=e,TD(n),oR(t,n)}function gCe(t,e,r){var n=r||{};return n.type="file",n.file=e,TD(n),RD(t,n)}function mCe(t,e,r,n){var i=r||{};i.type="file",i.file=t,TD(i),i.type="buffer";var s=n;return s instanceof Function||(s=r),eh.writeFile(t,oR(e,i),s)}function OY(t,e,r,n,i,s,o,a){var l=sn(r),u=a.defval,c=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||t[r])for(var d=e.s.c;d<=e.e.c;++d){var g=o?t[r][d]:t[n[d]+l];if(g===void 0||g.t===void 0){if(u===void 0)continue;s[d]!=null&&(f[s[d]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(m==null)if(g.t=="e"&&m===null)f[s[d]]=null;else if(u!==void 0)f[s[d]]=u;else if(c&&m===null)f[s[d]]=null;else continue;else f[s[d]]=c&&(g.t!=="n"||g.t==="n"&&a.rawNumbers!==!1)?m:Fl(g,m,a);m!=null&&(h=!1)}}return{row:f,isempty:h}}function i_(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},c=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":l=It(c);break;case"number":l=It(t["!ref"]),l.s.r=c;break;default:l=c}n>0&&(i=0);var h=sn(l.s.r),f=[],d=[],g=0,m=0,p=Array.isArray(t),w=l.s.r,v=0,y={};p&&!t[w]&&(t[w]=[]);var b=u.skipHidden&&t["!cols"]||[],T=u.skipHidden&&t["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(b[v]||{}).hidden)switch(f[v]=kr(v),r=p?t[w][v]:t[f[v]+h],n){case 1:s[v]=v-l.s.c;break;case 2:s[v]=f[v];break;case 3:s[v]=u.header[v-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=Fl(r,null,u),m=y[o]||0,!m)y[o]=1;else{do a=o+"_"+m++;while(y[a]);y[o]=m,y[a]=1}s[v]=a}for(w=l.s.r+i;w<=l.e.r;++w)if(!(T[w]||{}).hidden){var E=OY(t,l,w,f,n,s,p,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[g++]=E.row)}return d.length=g,d}var GB=/"/g;function MY(t,e,r,n,i,s,o,a){for(var l=!0,u=[],c="",h=sn(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var d=a.dense?(t[r]||[])[f]:t[n[f]+h];if(d==null)c="";else if(d.v!=null){l=!1,c=""+(a.rawNumbers&&d.t=="n"?d.v:Fl(d,null,a));for(var g=0,m=0;g!==c.length;++g)if((m=c.charCodeAt(g))===i||m===s||m===34||a.forceQuotes){c='"'+c.replace(GB,'""')+'"';break}c=="ID"&&(c='"ID"')}else d.f!=null&&!d.F?(l=!1,c="="+d.f,c.indexOf(",")>=0&&(c='"'+c.replace(GB,'""')+'"')):c="";u.push(c)}return a.blankrows===!1&&l?null:u.join(o)}function kD(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=It(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],d=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(f[g]||{}).hidden||(h[g]=kr(g));for(var m=0,p=i.s.r;p<=i.e.r;++p)(d[p]||{}).hidden||(c=MY(t,i,p,h,o,l,s,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((m++?a:"")+c)));return delete n.dense,r.join("")}function NY(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=kD(t,e);if(typeof Ht>"u"||e.type=="string")return r;var n=Ht.utils.encode(1200,r,"str");return"ÿþ"+n}function pCe(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=It(t["!ref"]),s="",o=[],a,l=[],u=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=kr(a);for(var c=i.s.r;c<=i.e.r;++c)for(s=sn(c),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,r=u?(t[c]||[])[a]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function DY(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;o=l.r,a=l.c}var u,c={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=It(s["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),o==-1&&(o=h.e.r+1,c.e.r=o+e.length-1+i)}else o==-1&&(o=0,c.e.r=e.length-1+i);var f=n.header||[],d=0;e.forEach(function(m,p){ln(m).forEach(function(w){(d=f.indexOf(w))==-1&&(f[d=f.length]=w);var v=m[w],y="z",b="",T=nt({c:a+d,r:o+p+i});u=uy(s,T),v&&typeof v=="object"&&!(v instanceof Date)?s[T]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",n.cellDates||(y="n",v=jn(v)),b=n.dateNF||rt[14]):v===null&&n.nullError&&(y="e",v=0),u?(u.t=y,u.v=v,delete u.w,delete u.R,b&&(u.z=b)):s[T]=u={t:y,v},b&&(u.z=b))})}),c.e.c=Math.max(c.e.c,a+f.length-1);var g=sn(o);if(i)for(d=0;d<f.length;++d)s[kr(d+a)+g]={t:"s",v:f[d]};return s["!ref"]=dt(c),s}function vCe(t,e){return DY(null,t,e)}function uy(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=zr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?uy(t,nt(e)):uy(t,nt({r:e,c:r||0}))}function wCe(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function PD(){return{SheetNames:[],Sheets:{}}}function AD(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(cY(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function yCe(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=wCe(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function CCe(t,e){return t.z=e,t}function FY(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function SCe(t,e,r){return FY(t,"#"+e,r)}function xCe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function bCe(t,e,r,n){for(var i=typeof e!="string"?e:It(e),s=typeof e=="string"?e:dt(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=uy(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var th={encode_col:kr,encode_row:sn,encode_cell:nt,encode_range:dt,decode_col:rD,decode_row:tD,split_cell:Whe,decode_cell:zr,decode_range:Zi,format_cell:Fl,sheet_add_aoa:tG,sheet_add_json:DY,sheet_add_dom:xY,aoa_to_sheet:Dp,json_to_sheet:vCe,table_to_sheet:bY,table_to_book:M1e,sheet_to_csv:kD,sheet_to_txt:NY,sheet_to_json:i_,sheet_to_html:SY,sheet_to_formulae:pCe,sheet_to_row_object_array:i_,sheet_get_cell:uy,book_new:PD,book_append_sheet:AD,book_set_sheet_visibility:yCe,cell_set_number_format:CCe,cell_set_hyperlink:FY,cell_set_internal_link:SCe,cell_add_comment:xCe,sheet_set_array_formula:bCe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},aR;function _Ce(t){aR=t}function ECe(t,e){var r=aR(),n=e??{};if(t==null||t["!ref"]==null)return r.push(null),r;var i=It(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],d=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(f[g]||{}).hidden||(h[g]=kr(g));var m=i.s.r,p=!1,w=0;return r._read=function(){if(!p)return p=!0,r.push("\uFEFF");for(;m<=i.e.r;)if(++m,!(d[m-1]||{}).hidden&&(c=MY(t,i,m-1,h,o,l,s,n),c!=null&&(n.strip&&(c=c.replace(u,"")),c||n.blankrows!==!1)))return r.push((w++?a:"")+c);return r.push(null)},r}function RCe(t,e){var r=aR(),n=e||{},i=n.header!=null?n.header:wY,s=n.footer!=null?n.footer:yY;r.push(i);var o=Zi(t["!ref"]);n.dense=Array.isArray(t),r.push(CY(t,o,n));var a=o.s.r,l=!1;return r._read=function(){if(a>o.e.r)return l||(l=!0,r.push("</table>"+s)),r.push(null);for(;a<=o.e.r;){r.push(vY(t,o,a,n)),++a;break}},r}function TCe(t,e){var r=aR({objectMode:!0});if(t==null||t["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},i=0,s=1,o=[],a=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},h=c.range!=null?c.range:t["!ref"];switch(c.header===1?i=1:c.header==="A"?i=2:Array.isArray(c.header)&&(i=3),typeof h){case"string":u=It(h);break;case"number":u=It(t["!ref"]),u.s.r=h;break;default:u=h}i>0&&(s=0);var f=sn(u.s.r),d=[],g=0,m=Array.isArray(t),p=u.s.r,w=0,v={};m&&!t[p]&&(t[p]=[]);var y=c.skipHidden&&t["!cols"]||[],b=c.skipHidden&&t["!rows"]||[];for(w=u.s.c;w<=u.e.c;++w)if(!(y[w]||{}).hidden)switch(d[w]=kr(w),n=m?t[p][w]:t[d[w]+f],i){case 1:o[w]=w-u.s.c;break;case 2:o[w]=d[w];break;case 3:o[w]=c.header[w-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=a=Fl(n,null,c),g=v[a]||0,!g)v[a]=1;else{do l=a+"_"+g++;while(v[l]);v[a]=g,v[l]=1}o[w]=l}return p=u.s.r+s,r._read=function(){for(;p<=u.e.r;)if(!(b[p-1]||{}).hidden){var T=OY(t,u,p,d,i,o,m,c);if(++p,T.isempty===!1||(i===1?c.blankrows!==!1:c.blankrows)){r.push(T.row);return}}return r.push(null)},r}var kCe={to_json:TCe,to_html:RCe,to_csv:ECe,set_readable:_Ce};const PCe=Xw.version,ACe=Object.freeze(Object.defineProperty({__proto__:null,CFB:Xe,SSF:D9,parse_xlscfb:SD,parse_zip:TY,read:ly,readFile:zB,readFileSync:zB,set_cptable:Mce,set_fs:lhe,stream:kCe,utils:th,version:PCe,write:oR,writeFile:n_,writeFileAsync:mCe,writeFileSync:n_,writeFileXLSX:gCe,writeXLSX:RD},Symbol.toStringTag,{value:"Module"}));var h0=function(t){return t&&t.Math===Math&&t},vn=h0(typeof globalThis=="object"&&globalThis)||h0(typeof window=="object"&&window)||h0(typeof self=="object"&&self)||h0(typeof L1=="object"&&L1)||h0(typeof L1=="object"&&L1)||function(){return this}()||Function("return this")(),ID={},On=function(t){try{return!!t()}catch{return!0}},ICe=On,Yo=!ICe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),OCe=On,lR=!OCe(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),MCe=lR,wC=Function.prototype.call,Mn=MCe?wC.bind(wC):function(){return wC.apply(wC,arguments)},HY={},LY={}.propertyIsEnumerable,$Y=Object.getOwnPropertyDescriptor,NCe=$Y&&!LY.call({1:2},1);HY.f=NCe?function(e){var r=$Y(this,e);return!!r&&r.enumerable}:LY;var uR=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},BY=lR,VY=Function.prototype,eM=VY.call,DCe=BY&&VY.bind.bind(eM,eM),wn=BY?DCe:function(t){return function(){return eM.apply(t,arguments)}},WY=wn,FCe=WY({}.toString),HCe=WY("".slice),qd=function(t){return HCe(FCe(t),8,-1)},LCe=wn,$Ce=On,BCe=qd,gk=Object,VCe=LCe("".split),WCe=$Ce(function(){return!gk("z").propertyIsEnumerable(0)})?function(t){return BCe(t)==="String"?VCe(t,""):gk(t)}:gk,OD=function(t){return t==null},jCe=OD,UCe=TypeError,i1=function(t){if(jCe(t))throw new UCe("Can't call method on "+t);return t},zCe=WCe,GCe=i1,s1=function(t){return zCe(GCe(t))},mk=typeof document=="object"&&document.all,Nn=typeof mk>"u"&&mk!==void 0?function(t){return typeof t=="function"||t===mk}:function(t){return typeof t=="function"},YCe=Nn,Ko=function(t){return typeof t=="object"?t!==null:YCe(t)},pk=vn,KCe=Nn,XCe=function(t){return KCe(t)?t:void 0},Hp=function(t,e){return arguments.length<2?XCe(pk[t]):pk[t]&&pk[t][e]},qCe=wn,o1=qCe({}.isPrototypeOf),JCe=vn,YB=JCe.navigator,KB=YB&&YB.userAgent,cR=KB?String(KB):"",jY=vn,vk=cR,XB=jY.process,qB=jY.Deno,JB=XB&&XB.versions||qB&&qB.version,QB=JB&&JB.v8,ba,s_;QB&&(ba=QB.split("."),s_=ba[0]>0&&ba[0]<4?1:+(ba[0]+ba[1]));!s_&&vk&&(ba=vk.match(/Edge\/(\d+)/),(!ba||ba[1]>=74)&&(ba=vk.match(/Chrome\/(\d+)/),ba&&(s_=+ba[1])));var QCe=s_,ZB=QCe,ZCe=On,eSe=vn,tSe=eSe.String,MD=!!Object.getOwnPropertySymbols&&!ZCe(function(){var t=Symbol("symbol detection");return!tSe(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ZB&&ZB<41}),rSe=MD,UY=rSe&&!Symbol.sham&&typeof Symbol.iterator=="symbol",nSe=Hp,iSe=Nn,sSe=o1,oSe=UY,aSe=Object,ND=oSe?function(t){return typeof t=="symbol"}:function(t){var e=nSe("Symbol");return iSe(e)&&sSe(e.prototype,aSe(t))},lSe=String,hR=function(t){try{return lSe(t)}catch{return"Object"}},uSe=Nn,cSe=hR,hSe=TypeError,Is=function(t){if(uSe(t))return t;throw new hSe(cSe(t)+" is not a function")},fSe=Is,dSe=OD,a1=function(t,e){var r=t[e];return dSe(r)?void 0:fSe(r)},wk=Mn,yk=Nn,Ck=Ko,gSe=TypeError,mSe=function(t,e){var r,n;if(e==="string"&&yk(r=t.toString)&&!Ck(n=wk(r,t))||yk(r=t.valueOf)&&!Ck(n=wk(r,t))||e!=="string"&&yk(r=t.toString)&&!Ck(n=wk(r,t)))return n;throw new gSe("Can't convert object to primitive value")},zY={exports:{}},eV=vn,pSe=Object.defineProperty,DD=function(t,e){try{pSe(eV,t,{value:e,configurable:!0,writable:!0})}catch{eV[t]=e}return e},vSe=vn,wSe=DD,tV="__core-js_shared__",rV=zY.exports=vSe[tV]||wSe(tV,{});(rV.versions||(rV.versions=[])).push({version:"3.45.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"});var FD=zY.exports,nV=FD,GY=function(t,e){return nV[t]||(nV[t]=e||{})},ySe=i1,CSe=Object,Lp=function(t){return CSe(ySe(t))},SSe=wn,xSe=Lp,bSe=SSe({}.hasOwnProperty),Xo=Object.hasOwn||function(e,r){return bSe(xSe(e),r)},_Se=wn,ESe=0,RSe=Math.random(),TSe=_Se(1.1.toString),YY=function(t){return"Symbol("+(t===void 0?"":t)+")_"+TSe(++ESe+RSe,36)},kSe=vn,PSe=GY,iV=Xo,ASe=YY,ISe=MD,OSe=UY,km=kSe.Symbol,Sk=PSe("wks"),MSe=OSe?km.for||km:km&&km.withoutSetter||ASe,Va=function(t){return iV(Sk,t)||(Sk[t]=ISe&&iV(km,t)?km[t]:MSe("Symbol."+t)),Sk[t]},NSe=Mn,sV=Ko,oV=ND,DSe=a1,FSe=mSe,HSe=Va,LSe=TypeError,$Se=HSe("toPrimitive"),BSe=function(t,e){if(!sV(t)||oV(t))return t;var r=DSe(t,$Se),n;if(r){if(e===void 0&&(e="default"),n=NSe(r,t,e),!sV(n)||oV(n))return n;throw new LSe("Can't convert object to primitive value")}return e===void 0&&(e="number"),FSe(t,e)},VSe=BSe,WSe=ND,KY=function(t){var e=VSe(t,"string");return WSe(e)?e:e+""},jSe=vn,aV=Ko,tM=jSe.document,USe=aV(tM)&&aV(tM.createElement),HD=function(t){return USe?tM.createElement(t):{}},zSe=Yo,GSe=On,YSe=HD,XY=!zSe&&!GSe(function(){return Object.defineProperty(YSe("div"),"a",{get:function(){return 7}}).a!==7}),KSe=Yo,XSe=Mn,qSe=HY,JSe=uR,QSe=s1,ZSe=KY,exe=Xo,txe=XY,lV=Object.getOwnPropertyDescriptor;ID.f=KSe?lV:function(e,r){if(e=QSe(e),r=ZSe(r),txe)try{return lV(e,r)}catch{}if(exe(e,r))return JSe(!XSe(qSe.f,e,r),e[r])};var ic={},rxe=Yo,nxe=On,qY=rxe&&nxe(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),ixe=Ko,sxe=String,oxe=TypeError,Dn=function(t){if(ixe(t))return t;throw new oxe(sxe(t)+" is not an object")},axe=Yo,lxe=XY,uxe=qY,yC=Dn,uV=KY,cxe=TypeError,xk=Object.defineProperty,hxe=Object.getOwnPropertyDescriptor,bk="enumerable",_k="configurable",Ek="writable";ic.f=axe?uxe?function(e,r,n){if(yC(e),r=uV(r),yC(n),typeof e=="function"&&r==="prototype"&&"value"in n&&Ek in n&&!n[Ek]){var i=hxe(e,r);i&&i[Ek]&&(e[r]=n.value,n={configurable:_k in n?n[_k]:i[_k],enumerable:bk in n?n[bk]:i[bk],writable:!1})}return xk(e,r,n)}:xk:function(e,r,n){if(yC(e),r=uV(r),yC(n),lxe)try{return xk(e,r,n)}catch{}if("get"in n||"set"in n)throw new cxe("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var fxe=Yo,dxe=ic,gxe=uR,$p=fxe?function(t,e,r){return dxe.f(t,e,gxe(1,r))}:function(t,e,r){return t[e]=r,t},JY={exports:{}},rM=Yo,mxe=Xo,QY=Function.prototype,pxe=rM&&Object.getOwnPropertyDescriptor,vxe=mxe(QY,"name"),wxe=vxe&&(!rM||rM&&pxe(QY,"name").configurable),yxe={CONFIGURABLE:wxe},Cxe=wn,Sxe=Nn,nM=FD,xxe=Cxe(Function.toString);Sxe(nM.inspectSource)||(nM.inspectSource=function(t){return xxe(t)});var bxe=nM.inspectSource,_xe=vn,Exe=Nn,cV=_xe.WeakMap,Rxe=Exe(cV)&&/native code/.test(String(cV)),Txe=GY,kxe=YY,hV=Txe("keys"),LD=function(t){return hV[t]||(hV[t]=kxe(t))},$D={},Pxe=Rxe,ZY=vn,Axe=Ko,Ixe=$p,Rk=Xo,Tk=FD,Oxe=LD,Mxe=$D,fV="Object already initialized",iM=ZY.TypeError,Nxe=ZY.WeakMap,o_,cy,a_,Dxe=function(t){return a_(t)?cy(t):o_(t,{})},Fxe=function(t){return function(e){var r;if(!Axe(e)||(r=cy(e)).type!==t)throw new iM("Incompatible receiver, "+t+" required");return r}};if(Pxe||Tk.state){var Xa=Tk.state||(Tk.state=new Nxe);Xa.get=Xa.get,Xa.has=Xa.has,Xa.set=Xa.set,o_=function(t,e){if(Xa.has(t))throw new iM(fV);return e.facade=t,Xa.set(t,e),e},cy=function(t){return Xa.get(t)||{}},a_=function(t){return Xa.has(t)}}else{var fg=Oxe("state");Mxe[fg]=!0,o_=function(t,e){if(Rk(t,fg))throw new iM(fV);return e.facade=t,Ixe(t,fg,e),e},cy=function(t){return Rk(t,fg)?t[fg]:{}},a_=function(t){return Rk(t,fg)}}var eK={set:o_,get:cy,has:a_,enforce:Dxe,getterFor:Fxe},BD=wn,Hxe=On,Lxe=Nn,CC=Xo,sM=Yo,$xe=yxe.CONFIGURABLE,Bxe=bxe,tK=eK,Vxe=tK.enforce,Wxe=tK.get,dV=String,Nx=Object.defineProperty,jxe=BD("".slice),Uxe=BD("".replace),zxe=BD([].join),Gxe=sM&&!Hxe(function(){return Nx(function(){},"length",{value:8}).length!==8}),Yxe=String(String).split("String"),Kxe=JY.exports=function(t,e,r){jxe(dV(e),0,7)==="Symbol("&&(e="["+Uxe(dV(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!CC(t,"name")||$xe&&t.name!==e)&&(sM?Nx(t,"name",{value:e,configurable:!0}):t.name=e),Gxe&&r&&CC(r,"arity")&&t.length!==r.arity&&Nx(t,"length",{value:r.arity});try{r&&CC(r,"constructor")&&r.constructor?sM&&Nx(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=Vxe(t);return CC(n,"source")||(n.source=zxe(Yxe,typeof e=="string"?e:"")),t};Function.prototype.toString=Kxe(function(){return Lxe(this)&&Wxe(this).source||Bxe(this)},"toString");var rK=JY.exports,Xxe=Nn,qxe=ic,Jxe=rK,Qxe=DD,VD=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(Xxe(r)&&Jxe(r,s,n),n.global)i?t[e]=r:Qxe(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:qxe.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},nK={},Zxe=Math.ceil,ebe=Math.floor,tbe=Math.trunc||function(e){var r=+e;return(r>0?ebe:Zxe)(r)},rbe=tbe,l1=function(t){var e=+t;return e!==e||e===0?0:rbe(e)},nbe=l1,ibe=Math.max,sbe=Math.min,obe=function(t,e){var r=nbe(t);return r<0?ibe(r+e,0):sbe(r,e)},abe=l1,lbe=Math.min,ube=function(t){var e=abe(t);return e>0?lbe(e,9007199254740991):0},cbe=ube,Bp=function(t){return cbe(t.length)},hbe=s1,fbe=obe,dbe=Bp,gbe=function(t){return function(e,r,n){var i=hbe(e),s=dbe(i);if(s===0)return!t&&-1;var o=fbe(n,s),a;if(t&&r!==r){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}},mbe={indexOf:gbe(!1)},pbe=wn,kk=Xo,vbe=s1,wbe=mbe.indexOf,ybe=$D,gV=pbe([].push),iK=function(t,e){var r=vbe(t),n=0,i=[],s;for(s in r)!kk(ybe,s)&&kk(r,s)&&gV(i,s);for(;e.length>n;)kk(r,s=e[n++])&&(~wbe(i,s)||gV(i,s));return i},WD=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Cbe=iK,Sbe=WD,xbe=Sbe.concat("length","prototype");nK.f=Object.getOwnPropertyNames||function(e){return Cbe(e,xbe)};var sK={};sK.f=Object.getOwnPropertySymbols;var bbe=Hp,_be=wn,Ebe=nK,Rbe=sK,Tbe=Dn,kbe=_be([].concat),Pbe=bbe("Reflect","ownKeys")||function(e){var r=Ebe.f(Tbe(e)),n=Rbe.f;return n?kbe(r,n(e)):r},mV=Xo,Abe=Pbe,Ibe=ID,Obe=ic,oK=function(t,e,r){for(var n=Abe(e),i=Obe.f,s=Ibe.f,o=0;o<n.length;o++){var a=n[o];!mV(t,a)&&!(r&&mV(r,a))&&i(t,a,s(e,a))}},Mbe=On,Nbe=Nn,Dbe=/#|\.prototype\./,u1=function(t,e){var r=Hbe[Fbe(t)];return r===$be?!0:r===Lbe?!1:Nbe(e)?Mbe(e):!!e},Fbe=u1.normalize=function(t){return String(t).replace(Dbe,".").toLowerCase()},Hbe=u1.data={},Lbe=u1.NATIVE="N",$be=u1.POLYFILL="P",Bbe=u1,SC=vn,Vbe=ID.f,Wbe=$p,jbe=VD,Ube=DD,zbe=oK,Gbe=Bbe,wr=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,a,l,u,c;if(n?o=SC:i?o=SC[r]||Ube(r,{}):o=SC[r]&&SC[r].prototype,o)for(a in e){if(u=e[a],t.dontCallGetSet?(c=Vbe(o,a),l=c&&c.value):l=o[a],s=Gbe(n?a:r+(i?".":"#")+a,t.forced),!s&&l!==void 0){if(typeof u==typeof l)continue;zbe(u,l)}(t.sham||l&&l.sham)&&Wbe(u,"sham",!0),jbe(o,a,u,t)}},Ybe=lR,aK=Function.prototype,pV=aK.apply,vV=aK.call,c1=typeof Reflect=="object"&&Reflect.apply||(Ybe?vV.bind(pV):function(){return vV.apply(pV,arguments)}),Kbe=wn,Xbe=Is,lK=function(t,e,r){try{return Kbe(Xbe(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},qbe=Ko,Jbe=function(t){return qbe(t)||t===null},Qbe=Jbe,Zbe=String,e_e=TypeError,t_e=function(t){if(Qbe(t))return t;throw new e_e("Can't set "+Zbe(t)+" as a prototype")},r_e=lK,n_e=Ko,i_e=i1,s_e=t_e,uK=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=r_e(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return i_e(i),s_e(s),n_e(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0),o_e=ic.f,a_e=function(t,e,r){r in t||o_e(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},l_e=Nn,u_e=Ko,wV=uK,c_e=function(t,e,r){var n,i;return wV&&l_e(n=e.constructor)&&n!==r&&u_e(i=n.prototype)&&i!==r.prototype&&wV(t,i),t},h_e=Va,f_e=h_e("toStringTag"),cK={};cK[f_e]="z";var d_e=String(cK)==="[object z]",g_e=d_e,m_e=Nn,Dx=qd,p_e=Va,v_e=p_e("toStringTag"),w_e=Object,y_e=Dx(function(){return arguments}())==="Arguments",C_e=function(t,e){try{return t[e]}catch{}},hK=g_e?Dx:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=C_e(e=w_e(t),v_e))=="string"?r:y_e?Dx(e):(n=Dx(e))==="Object"&&m_e(e.callee)?"Arguments":n},S_e=hK,x_e=String,fR=function(t){if(S_e(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return x_e(t)},b_e=fR,__e=function(t,e){return t===void 0?arguments.length<2?"":e:b_e(t)},E_e=Ko,R_e=$p,T_e=function(t,e){E_e(e)&&"cause"in e&&R_e(t,"cause",e.cause)},k_e=wn,fK=Error,P_e=k_e("".replace),A_e=function(t){return String(new fK(t).stack)}("zxcasd"),dK=/\n\s*at [^:]*:[^\n]*/,I_e=dK.test(A_e),O_e=function(t,e){if(I_e&&typeof t=="string"&&!fK.prepareStackTrace)for(;e--;)t=P_e(t,dK,"");return t},M_e=On,N_e=uR,D_e=!M_e(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",N_e(1,7)),t.stack!==7):!0}),F_e=$p,H_e=O_e,L_e=D_e,yV=Error.captureStackTrace,$_e=function(t,e,r,n){L_e&&(yV?yV(t,e):F_e(t,"stack",H_e(r,n)))},CV=Hp,B_e=Xo,SV=$p,V_e=o1,xV=uK,bV=oK,_V=a_e,W_e=c_e,j_e=__e,U_e=T_e,z_e=$_e,G_e=Yo,Y_e=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),a=o[o.length-1],l=CV.apply(null,o);if(l){var u=l.prototype;if(B_e(u,"cause")&&delete u.cause,!r)return l;var c=CV("Error"),h=e(function(f,d){var g=j_e(n?d:f,void 0),m=n?new l(f):new l;return g!==void 0&&SV(m,"message",g),z_e(m,h,m.stack,2),this&&V_e(u,this)&&W_e(m,this,h),arguments.length>s&&U_e(m,arguments[s]),m});h.prototype=u,a!=="Error"?xV?xV(h,c):bV(h,c,{name:!0}):G_e&&i in l&&(_V(h,l,i),_V(h,l,"prepareStackTrace")),bV(h,l);try{u.name!==a&&SV(u,"name",a),u.constructor=h}catch{}return h}},gK=wr,K_e=vn,Vl=c1,mK=Y_e,oM="WebAssembly",EV=K_e[oM],l_=new Error("e",{cause:7}).cause!==7,Jd=function(t,e){var r={};r[t]=mK(t,e,l_),gK({global:!0,constructor:!0,arity:1,forced:l_},r)},jD=function(t,e){if(EV&&EV[t]){var r={};r[t]=mK(oM+"."+t,e,l_),gK({target:oM,stat:!0,constructor:!0,arity:1,forced:l_},r)}};Jd("Error",function(t){return function(r){return Vl(t,this,arguments)}});Jd("EvalError",function(t){return function(r){return Vl(t,this,arguments)}});Jd("RangeError",function(t){return function(r){return Vl(t,this,arguments)}});Jd("ReferenceError",function(t){return function(r){return Vl(t,this,arguments)}});Jd("SyntaxError",function(t){return function(r){return Vl(t,this,arguments)}});Jd("TypeError",function(t){return function(r){return Vl(t,this,arguments)}});Jd("URIError",function(t){return function(r){return Vl(t,this,arguments)}});jD("CompileError",function(t){return function(r){return Vl(t,this,arguments)}});jD("LinkError",function(t){return function(r){return Vl(t,this,arguments)}});jD("RuntimeError",function(t){return function(r){return Vl(t,this,arguments)}});var X_e=qd,pK=Array.isArray||function(e){return X_e(e)==="Array"},q_e=Yo,J_e=pK,Q_e=TypeError,Z_e=Object.getOwnPropertyDescriptor,eEe=q_e&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),vK=eEe?function(t,e){if(J_e(t)&&!Z_e(t,"length").writable)throw new Q_e("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},tEe=TypeError,rEe=9007199254740991,wK=function(t){if(t>rEe)throw tEe("Maximum allowed index exceeded");return t},nEe=wr,iEe=Lp,sEe=Bp,oEe=vK,aEe=wK,lEe=On,uEe=lEe(function(){return[].push.call({length:4294967296},1)!==4294967297}),cEe=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},hEe=uEe||!cEe();nEe({target:"Array",proto:!0,arity:1,forced:hEe},{push:function(e){var r=iEe(this),n=sEe(r),i=arguments.length;aEe(n+i);for(var s=0;s<i;s++)r[n]=arguments[s],n++;return oEe(r,n),n}});var fEe=qd,dEe=wn,gEe=function(t){if(fEe(t)==="Function")return dEe(t)},RV=gEe,mEe=Is,pEe=lR,vEe=RV(RV.bind),yK=function(t,e){return mEe(t),e===void 0?t:pEe?vEe(t,e):function(){return t.apply(e,arguments)}},CK={},wEe=Va,yEe=CK,CEe=wEe("iterator"),SEe=Array.prototype,xEe=function(t){return t!==void 0&&(yEe.Array===t||SEe[CEe]===t)},bEe=hK,TV=a1,_Ee=OD,EEe=CK,REe=Va,TEe=REe("iterator"),UD=function(t){if(!_Ee(t))return TV(t,TEe)||TV(t,"@@iterator")||EEe[bEe(t)]},kEe=Mn,PEe=Is,AEe=Dn,IEe=hR,OEe=UD,MEe=TypeError,NEe=function(t,e){var r=arguments.length<2?OEe(t):e;if(PEe(r))return AEe(kEe(r,t));throw new MEe(IEe(t)+" is not iterable")},DEe=Mn,kV=Dn,FEe=a1,Os=function(t,e,r){var n,i;kV(t);try{if(n=FEe(t,"return"),!n){if(e==="throw")throw r;return r}n=DEe(n,t)}catch(s){i=!0,n=s}if(e==="throw")throw r;if(i)throw n;return kV(n),r},HEe=yK,LEe=Mn,$Ee=Dn,BEe=hR,VEe=xEe,WEe=Bp,PV=o1,jEe=NEe,UEe=UD,AV=Os,zEe=TypeError,Fx=function(t,e){this.stopped=t,this.result=e},IV=Fx.prototype,Vp=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),l=HEe(e,n),u,c,h,f,d,g,m,p=function(v){return u&&AV(u,"normal"),new Fx(!0,v)},w=function(v){return i?($Ee(v),a?l(v[0],v[1],p):l(v[0],v[1])):a?l(v,p):l(v)};if(s)u=t.iterator;else if(o)u=t;else{if(c=UEe(t),!c)throw new zEe(BEe(t)+" is not iterable");if(VEe(c)){for(h=0,f=WEe(t);f>h;h++)if(d=w(t[h]),d&&PV(IV,d))return d;return new Fx(!1)}u=jEe(t,c)}for(g=s?t.next:u.next;!(m=LEe(g,u)).done;){try{d=w(m.value)}catch(v){AV(u,"throw",v)}if(typeof d=="object"&&d&&PV(IV,d))return d}return new Fx(!1)},GEe=Yo,YEe=ic,KEe=uR,SK=function(t,e,r){GEe?YEe.f(t,e,KEe(0,r)):t[e]=r},XEe=wr,qEe=Vp,JEe=SK;XEe({target:"Object",stat:!0},{fromEntries:function(e){var r={};return qEe(e,function(n,i){JEe(r,n,i)},{AS_ENTRIES:!0}),r}});var Pk=wn,xC=Set.prototype,Wl={Set,add:Pk(xC.add),has:Pk(xC.has),remove:Pk(xC.delete),proto:xC},QEe=Wl.has,Qd=function(t){return QEe(t),t},ZEe=Mn,Zd=function(t,e,r){for(var n=r?t:t.iterator,i=t.next,s,o;!(s=ZEe(i,n)).done;)if(o=e(s.value),o!==void 0)return o},xK=wn,eRe=Zd,bK=Wl,tRe=bK.Set,_K=bK.proto,rRe=xK(_K.forEach),EK=xK(_K.keys),nRe=EK(new tRe).next,h1=function(t,e,r){return r?eRe({iterator:EK(t),next:nRe},e):rRe(t,e)},RK=Wl,iRe=h1,sRe=RK.Set,oRe=RK.add,zD=function(t){var e=new sRe;return iRe(t,function(r){oRe(e,r)}),e},aRe=lK,lRe=Wl,f1=aRe(lRe.proto,"size","get")||function(t){return t.size},jl=function(t){return{iterator:t,next:t.next,done:!1}},OV=Is,TK=Dn,MV=Mn,uRe=l1,cRe=jl,NV="Invalid size",hRe=RangeError,fRe=TypeError,dRe=Math.max,kK=function(t,e){this.set=t,this.size=dRe(e,0),this.has=OV(t.has),this.keys=OV(t.keys)};kK.prototype={getIterator:function(){return cRe(TK(MV(this.keys,this.set)))},includes:function(t){return MV(this.has,this.set,t)}};var eg=function(t){TK(t);var e=+t.size;if(e!==e)throw new fRe(NV);var r=uRe(e);if(r<0)throw new hRe(NV);return new kK(t,r)},gRe=Qd,PK=Wl,mRe=zD,pRe=f1,vRe=eg,wRe=h1,yRe=Zd,CRe=PK.has,DV=PK.remove,SRe=function(e){var r=gRe(this),n=vRe(e),i=mRe(r);return pRe(r)<=n.size?wRe(r,function(s){n.includes(s)&&DV(i,s)}):yRe(n.getIterator(),function(s){CRe(i,s)&&DV(i,s)}),i},xRe=Hp,FV=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},HV=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},tg=function(t,e){var r=xRe("Set");try{new r()[t](FV(0));try{return new r()[t](FV(-1)),!1}catch{if(!e)return!0;try{return new r()[t](HV(-1/0)),!1}catch{var n=new r;return n.add(1),n.add(2),e(n[t](HV(1/0)))}}}catch{return!1}},bRe=wr,_Re=SRe,ERe=On,RRe=tg,TRe=!RRe("difference",function(t){return t.size===0}),kRe=TRe||ERe(function(){var t={size:1,has:function(){return!0},keys:function(){var r=0;return{next:function(){var n=r++>1;return e.has(1)&&e.clear(),{done:n,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(t).size!==3});bRe({target:"Set",proto:!0,real:!0,forced:kRe},{difference:_Re});var PRe=Qd,GD=Wl,ARe=f1,IRe=eg,ORe=h1,MRe=Zd,NRe=GD.Set,LV=GD.add,DRe=GD.has,FRe=function(e){var r=PRe(this),n=IRe(e),i=new NRe;return ARe(r)>n.size?MRe(n.getIterator(),function(s){DRe(r,s)&&LV(i,s)}):ORe(r,function(s){n.includes(s)&&LV(i,s)}),i},HRe=wr,LRe=On,$Re=FRe,BRe=tg,VRe=!BRe("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||LRe(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});HRe({target:"Set",proto:!0,real:!0,forced:VRe},{intersection:$Re});var WRe=Qd,jRe=Wl.has,URe=f1,zRe=eg,GRe=h1,YRe=Zd,KRe=Os,XRe=function(e){var r=WRe(this),n=zRe(e);if(URe(r)<=n.size)return GRe(r,function(s){if(n.includes(s))return!1},!0)!==!1;var i=n.getIterator();return YRe(i,function(s){if(jRe(r,s))return KRe(i,"normal",!1)})!==!1},qRe=wr,JRe=XRe,QRe=tg,ZRe=!QRe("isDisjointFrom",function(t){return!t});qRe({target:"Set",proto:!0,real:!0,forced:ZRe},{isDisjointFrom:JRe});var eTe=Qd,tTe=f1,rTe=h1,nTe=eg,iTe=function(e){var r=eTe(this),n=nTe(e);return tTe(r)>n.size?!1:rTe(r,function(i){if(!n.includes(i))return!1},!0)!==!1},sTe=wr,oTe=iTe,aTe=tg,lTe=!aTe("isSubsetOf",function(t){return t});sTe({target:"Set",proto:!0,real:!0,forced:lTe},{isSubsetOf:oTe});var uTe=Qd,cTe=Wl.has,hTe=f1,fTe=eg,dTe=Zd,gTe=Os,mTe=function(e){var r=uTe(this),n=fTe(e);if(hTe(r)<n.size)return!1;var i=n.getIterator();return dTe(i,function(s){if(!cTe(r,s))return gTe(i,"normal",!1)})!==!1},pTe=wr,vTe=mTe,wTe=tg,yTe=!wTe("isSupersetOf",function(t){return!t});pTe({target:"Set",proto:!0,real:!0,forced:yTe},{isSupersetOf:vTe});var CTe=Qd,YD=Wl,STe=zD,xTe=eg,bTe=Zd,_Te=YD.add,ETe=YD.has,RTe=YD.remove,TTe=function(e){var r=CTe(this),n=xTe(e).getIterator(),i=STe(r);return bTe(n,function(s){ETe(r,s)?RTe(i,s):_Te(i,s)}),i},AK=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size===1&&n.values().next().value===4}catch{return!1}},kTe=wr,PTe=TTe,ATe=AK,ITe=tg,OTe=!ITe("symmetricDifference")||!ATe("symmetricDifference");kTe({target:"Set",proto:!0,real:!0,forced:OTe},{symmetricDifference:PTe});var MTe=Qd,NTe=Wl.add,DTe=zD,FTe=eg,HTe=Zd,LTe=function(e){var r=MTe(this),n=FTe(e).getIterator(),i=DTe(r);return HTe(n,function(s){NTe(i,s)}),i},$Te=wr,BTe=LTe,VTe=AK,WTe=tg,jTe=!WTe("union")||!VTe("union");$Te({target:"Set",proto:!0,real:!0,forced:jTe},{union:BTe});var UTe=o1,zTe=TypeError,GTe=function(t,e){if(UTe(e,t))return t;throw new zTe("Incorrect invocation")},YTe=On,KTe=!YTe(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),XTe=Xo,qTe=Nn,JTe=Lp,QTe=LD,ZTe=KTe,$V=QTe("IE_PROTO"),aM=Object,eke=aM.prototype,IK=ZTe?aM.getPrototypeOf:function(t){var e=JTe(t);if(XTe(e,$V))return e[$V];var r=e.constructor;return qTe(r)&&e instanceof r?r.prototype:e instanceof aM?eke:null},BV=rK,tke=ic,rke=function(t,e,r){return r.get&&BV(r.get,e,{getter:!0}),r.set&&BV(r.set,e,{setter:!0}),tke.f(t,e,r)},OK={},nke=iK,ike=WD,ske=Object.keys||function(e){return nke(e,ike)},oke=Yo,ake=qY,lke=ic,uke=Dn,cke=s1,hke=ske;OK.f=oke&&!ake?Object.defineProperties:function(e,r){uke(e);for(var n=cke(r),i=hke(r),s=i.length,o=0,a;s>o;)lke.f(e,a=i[o++],n[a]);return e};var fke=Hp,MK=fke("document","documentElement"),dke=Dn,gke=OK,VV=WD,mke=$D,pke=MK,vke=HD,wke=LD,WV=">",jV="<",lM="prototype",uM="script",NK=wke("IE_PROTO"),Ak=function(){},DK=function(t){return jV+uM+WV+t+jV+"/"+uM+WV},UV=function(t){t.write(DK("")),t.close();var e=t.parentWindow.Object;return t=null,e},yke=function(){var t=vke("iframe"),e="java"+uM+":",r;return t.style.display="none",pke.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(DK("document.F=Object")),r.close(),r.F},bC,Hx=function(){try{bC=new ActiveXObject("htmlfile")}catch{}Hx=typeof document<"u"?document.domain&&bC?UV(bC):yke():UV(bC);for(var t=VV.length;t--;)delete Hx[lM][VV[t]];return Hx()};mke[NK]=!0;var FK=Object.create||function(e,r){var n;return e!==null?(Ak[lM]=dke(e),n=new Ak,Ak[lM]=null,n[NK]=e):n=Hx(),r===void 0?n:gke.f(n,r)},Cke=On,Ske=Nn,xke=Ko,zV=IK,bke=VD,_ke=Va,cM=_ke("iterator"),Pd,Ik,Ok;[].keys&&(Ok=[].keys(),"next"in Ok&&(Ik=zV(zV(Ok)),Ik!==Object.prototype&&(Pd=Ik)));var Eke=!xke(Pd)||Cke(function(){var t={};return Pd[cM].call(t)!==t});Eke&&(Pd={});Ske(Pd[cM])||bke(Pd,cM,function(){return this});var HK={IteratorPrototype:Pd},Rke=wr,Tke=vn,kke=GTe,Pke=Dn,Ake=Nn,Ike=IK,Oke=rke,Mke=SK,Nke=On,KD=Xo,Dke=Va,Nl=HK.IteratorPrototype,Fke=Yo,Mk="constructor",LK="Iterator",GV=Dke("toStringTag"),$K=TypeError,Nk=Tke[LK],BK=!Ake(Nk)||Nk.prototype!==Nl||!Nke(function(){Nk({})}),XD=function(){if(kke(this,Nl),Ike(this)===Nl)throw new $K("Abstract class Iterator not directly constructable")},VK=function(t,e){Fke?Oke(Nl,t,{configurable:!0,get:function(){return e},set:function(r){if(Pke(this),this===Nl)throw new $K("You can't redefine this property");KD(this,t)?this[t]=r:Mke(this,t,r)}}):Nl[t]=e};KD(Nl,GV)||VK(GV,LK);(BK||!KD(Nl,Mk)||Nl[Mk]===Object)&&VK(Mk,XD);XD.prototype=Nl;Rke({global:!0,constructor:!0,forced:BK},{Iterator:XD});var Hke=VD,Lke=function(t,e,r){for(var n in e)Hke(t,n,e[n],r);return t},$ke=function(t,e){return{value:t,done:e}},Bke=Os,Vke=function(t,e,r){for(var n=t.length-1;n>=0;n--)if(t[n]!==void 0)try{r=Bke(t[n].iterator,e,r)}catch(i){e="throw",r=i}if(e==="throw")throw r;return r},Wke=Mn,jke=FK,Uke=$p,zke=Lke,Gke=Va,WK=eK,Yke=a1,Kke=HK.IteratorPrototype,_C=$ke,EC=Os,Xke=Vke,qke=Gke("toStringTag"),jK="IteratorHelper",UK="WrapForValidIterator",Dk="normal",YV="throw",Jke=WK.set,zK=function(t){var e=WK.getterFor(t?UK:jK);return zke(jke(Kke),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return _C(void 0,!0);try{var i=n.nextHandler();return n.returnHandlerResult?i:_C(i,n.done)}catch(s){throw n.done=!0,s}},return:function(){var r=e(this),n=r.iterator;if(r.done=!0,t){var i=Yke(n,"return");return i?Wke(i,n):_C(void 0,!0)}if(r.inner)try{EC(r.inner.iterator,Dk)}catch(s){return EC(n,YV,s)}if(r.openIters)try{Xke(r.openIters,Dk)}catch(s){return EC(n,YV,s)}return n&&EC(n,Dk),_C(void 0,!0)}})},Qke=zK(!0),GK=zK(!1);Uke(GK,qke,"Iterator Helper");var qD=function(t,e,r){var n=function(s,o){o?(o.iterator=s.iterator,o.next=s.next):o=s,o.type=e?UK:jK,o.returnHandlerResult=!!r,o.nextHandler=t,o.counter=0,o.done=!1,Jke(this,o)};return n.prototype=e?Qke:GK,n},Zke=Dn,ePe=Os,YK=function(t,e,r,n){try{return n?e(Zke(r)[0],r[1]):e(r)}catch(i){ePe(t,"throw",i)}},JD=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}},tPe=vn,Bh=function(t,e){var r=tPe.Iterator,n=r&&r.prototype,i=n&&n[t],s=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(o){o instanceof e||(s=!1)}if(!s)return i},rPe=wr,KK=Mn,nPe=Is,XK=Dn,iPe=jl,sPe=qD,oPe=YK,aPe=Os,lPe=JD,uPe=Bh,qK=!lPe("filter",function(){}),hM=!qK&&uPe("filter",TypeError),cPe=qK||hM,hPe=sPe(function(){for(var t=this.iterator,e=this.predicate,r=this.next,n,i,s;;){if(n=XK(KK(r,t)),i=this.done=!!n.done,i)return;if(s=n.value,oPe(t,e,[s,this.counter++],!0))return s}});rPe({target:"Iterator",proto:!0,real:!0,forced:cPe},{filter:function(e){XK(this);try{nPe(e)}catch(r){aPe(this,"throw",r)}return hM?KK(hM,this,e):new hPe(iPe(this),{predicate:e})}});var fPe=wr,dPe=Mn,gPe=Vp,mPe=Is,pPe=Dn,vPe=jl,wPe=Os,yPe=Bh,Fk=yPe("forEach",TypeError);fPe({target:"Iterator",proto:!0,real:!0,forced:Fk},{forEach:function(e){pPe(this);try{mPe(e)}catch(i){wPe(this,"throw",i)}if(Fk)return dPe(Fk,this,e);var r=vPe(this),n=0;gPe(r,function(i){e(i,n++)},{IS_RECORD:!0})}});var CPe=wr,JK=Mn,SPe=Is,QK=Dn,xPe=jl,bPe=qD,_Pe=YK,EPe=Os,RPe=JD,TPe=Bh,ZK=!RPe("map",function(){}),fM=!ZK&&TPe("map",TypeError),kPe=ZK||fM,PPe=bPe(function(){var t=this.iterator,e=QK(JK(this.next,t)),r=this.done=!!e.done;if(!r)return _Pe(t,this.mapper,[e.value,this.counter++],!0)});CPe({target:"Iterator",proto:!0,real:!0,forced:kPe},{map:function(e){QK(this);try{SPe(e)}catch(r){EPe(this,"throw",r)}return fM?JK(fM,this,e):new PPe(xPe(this),{mapper:e})}});var APe=wn,QD=APe([].slice),IPe=TypeError,eX=function(t,e){if(t<e)throw new IPe("Not enough arguments");return t},OPe=cR,MPe=/(?:ipad|iphone|ipod).*applewebkit/i.test(OPe),f0=vn,NPe=cR,DPe=qd,RC=function(t){return NPe.slice(0,t.length)===t},tX=function(){return RC("Bun/")?"BUN":RC("Cloudflare-Workers")?"CLOUDFLARE":RC("Deno/")?"DENO":RC("Node.js/")?"NODE":f0.Bun&&typeof Bun.version=="string"?"BUN":f0.Deno&&typeof Deno.version=="object"?"DENO":DPe(f0.process)==="process"?"NODE":f0.window&&f0.document?"BROWSER":"REST"}(),FPe=tX,HPe=FPe==="NODE",Qs=vn,LPe=c1,$Pe=yK,KV=Nn,BPe=Xo,rX=On,XV=MK,VPe=QD,qV=HD,WPe=eX,jPe=MPe,UPe=HPe,dM=Qs.setImmediate,gM=Qs.clearImmediate,zPe=Qs.process,Hk=Qs.Dispatch,GPe=Qs.Function,JV=Qs.MessageChannel,YPe=Qs.String,Lk=0,Qv={},QV="onreadystatechange",hy,Xh,$k,Bk;rX(function(){hy=Qs.location});var ZD=function(t){if(BPe(Qv,t)){var e=Qv[t];delete Qv[t],e()}},Vk=function(t){return function(){ZD(t)}},ZV=function(t){ZD(t.data)},eW=function(t){Qs.postMessage(YPe(t),hy.protocol+"//"+hy.host)};(!dM||!gM)&&(dM=function(e){WPe(arguments.length,1);var r=KV(e)?e:GPe(e),n=VPe(arguments,1);return Qv[++Lk]=function(){LPe(r,void 0,n)},Xh(Lk),Lk},gM=function(e){delete Qv[e]},UPe?Xh=function(t){zPe.nextTick(Vk(t))}:Hk&&Hk.now?Xh=function(t){Hk.now(Vk(t))}:JV&&!jPe?($k=new JV,Bk=$k.port2,$k.port1.onmessage=ZV,Xh=$Pe(Bk.postMessage,Bk)):Qs.addEventListener&&KV(Qs.postMessage)&&!Qs.importScripts&&hy&&hy.protocol!=="file:"&&!rX(eW)?(Xh=eW,Qs.addEventListener("message",ZV,!1)):QV in qV("script")?Xh=function(t){XV.appendChild(qV("script"))[QV]=function(){XV.removeChild(this),ZD(t)}}:Xh=function(t){setTimeout(Vk(t),0)});var nX={set:dM,clear:gM},KPe=wr,XPe=vn,tW=nX.clear;KPe({global:!0,bind:!0,enumerable:!0,forced:XPe.clearImmediate!==tW},{clearImmediate:tW});var iX=vn,qPe=c1,JPe=Nn,QPe=tX,ZPe=cR,eAe=QD,tAe=eX,rAe=iX.Function,nAe=/MSIE .\./.test(ZPe)||QPe==="BUN"&&function(){var t=iX.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),iAe=function(t,e){var r=e?2:1;return nAe?function(n,i){var s=tAe(arguments.length,1)>r,o=JPe(n)?n:rAe(n),a=s?eAe(arguments,r):[],l=s?function(){qPe(o,this,a)}:o;return e?t(l,i):t(l)}:t},sAe=wr,sX=vn,rW=nX.set,oAe=iAe,nW=sX.setImmediate?oAe(rW,!1):rW;sAe({global:!0,bind:!0,enumerable:!0,forced:sX.setImmediate!==nW},{setImmediate:nW});/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:oX,setPrototypeOf:iW,isFrozen:aAe,getPrototypeOf:lAe,getOwnPropertyDescriptor:uAe}=Object;let{freeze:es,seal:zo,create:aX}=Object,{apply:mM,construct:pM}=typeof Reflect<"u"&&Reflect;es||(es=function(e){return e});zo||(zo=function(e){return e});mM||(mM=function(e,r,n){return e.apply(r,n)});pM||(pM=function(e,r){return new e(...r)});const TC=ts(Array.prototype.forEach),cAe=ts(Array.prototype.lastIndexOf),sW=ts(Array.prototype.pop),d0=ts(Array.prototype.push),hAe=ts(Array.prototype.splice),Lx=ts(String.prototype.toLowerCase),Wk=ts(String.prototype.toString),oW=ts(String.prototype.match),g0=ts(String.prototype.replace),fAe=ts(String.prototype.indexOf),dAe=ts(String.prototype.trim),da=ts(Object.prototype.hasOwnProperty),Hi=ts(RegExp.prototype.test),m0=gAe(TypeError);function ts(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return mM(t,e,n)}}function gAe(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return pM(t,r)}}function Et(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Lx;iW&&iW(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=r(i);s!==i&&(aAe(e)||(e[n]=s),i=s)}t[i]=!0}return t}function mAe(t){for(let e=0;e<t.length;e++)da(t,e)||(t[e]=null);return t}function lu(t){const e=aX(null);for(const[r,n]of oX(t))da(t,r)&&(Array.isArray(n)?e[r]=mAe(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=lu(n):e[r]=n);return e}function p0(t,e){for(;t!==null;){const n=uAe(t,e);if(n){if(n.get)return ts(n.get);if(typeof n.value=="function")return ts(n.value)}t=lAe(t)}function r(){return null}return r}const aW=es(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),jk=es(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Uk=es(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pAe=es(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),zk=es(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),vAe=es(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),lW=es(["#text"]),uW=es(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Gk=es(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),cW=es(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),kC=es(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),wAe=zo(/\{\{[\w\W]*|[\w\W]*\}\}/gm),yAe=zo(/<%[\w\W]*|[\w\W]*%>/gm),CAe=zo(/\$\{[\w\W]*/gm),SAe=zo(/^data-[\-\w.\u00B7-\uFFFF]+$/),xAe=zo(/^aria-[\-\w]+$/),lX=zo(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bAe=zo(/^(?:\w+script|data):/i),_Ae=zo(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),uX=zo(/^html$/i),EAe=zo(/^[a-z][.\w]*(-[.\w]+)+$/i);var hW=Object.freeze({__proto__:null,ARIA_ATTR:xAe,ATTR_WHITESPACE:_Ae,CUSTOM_ELEMENT:EAe,DATA_ATTR:SAe,DOCTYPE_NAME:uX,ERB_EXPR:yAe,IS_ALLOWED_URI:lX,IS_SCRIPT_OR_DATA:bAe,MUSTACHE_EXPR:wAe,TMPLIT_EXPR:CAe});const v0={element:1,text:3,progressingInstruction:7,comment:8,document:9},RAe=function(){return typeof window>"u"?null:window},TAe=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},fW=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function cX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:RAe();const e=ne=>cX(ne);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==v0.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:d}=t,g=l.prototype,m=p0(g,"cloneNode"),p=p0(g,"remove"),w=p0(g,"nextSibling"),v=p0(g,"childNodes"),y=p0(g,"parentNode");if(typeof o=="function"){const ne=r.createElement("template");ne.content&&ne.content.ownerDocument&&(r=ne.content.ownerDocument)}let b,T="";const{implementation:E,createNodeIterator:x,createDocumentFragment:P,getElementsByTagName:A}=r,{importNode:O}=n;let Y=fW();e.isSupported=typeof oX=="function"&&typeof y=="function"&&E&&E.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:ie,TMPLIT_EXPR:ce,DATA_ATTR:he,ARIA_ATTR:Ee,IS_SCRIPT_OR_DATA:Ce,ATTR_WHITESPACE:ge,CUSTOM_ELEMENT:Q}=hW;let{IS_ALLOWED_URI:ye}=hW,Re=null;const W=Et({},[...aW,...jk,...Uk,...zk,...lW]);let C=null;const S=Et({},[...uW,...Gk,...cW,...kC]);let _=Object.seal(aX(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),D=null,U=null,X=!0,ee=!0,k=!1,M=!0,R=!1,V=!0,q=!1,J=!1,re=!1,B=!1,te=!1,oe=!1,ae=!0,fe=!1;const Me="user-content-";let Ne=!0,ze=!1,st={},ot=null;const tt=Et({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let We=null;const ht=Et({},["audio","video","img","source","image","track"]);let Qe=null;const Xt=Et({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Or="http://www.w3.org/1998/Math/MathML",St="http://www.w3.org/2000/svg",$t="http://www.w3.org/1999/xhtml";let dr=$t,cr=!1,Mt=null;const Fi=Et({},[Or,St,$t],Wk);let Un=Et({},["mi","mo","mn","ms","mtext"]),Ua=Et({},["annotation-xml"]);const og=Et({},["title","style","font","a","script"]);let zh=null;const ag=["application/xhtml+xml","text/html"],aT="text/html";let Cn=null,cc=null;const lT=r.createElement("form"),N1=function(N){return N instanceof RegExp||N instanceof Function},Zp=function(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(cc&&cc===N)){if((!N||typeof N!="object")&&(N={}),N=lu(N),zh=ag.indexOf(N.PARSER_MEDIA_TYPE)===-1?aT:N.PARSER_MEDIA_TYPE,Cn=zh==="application/xhtml+xml"?Wk:Lx,Re=da(N,"ALLOWED_TAGS")?Et({},N.ALLOWED_TAGS,Cn):W,C=da(N,"ALLOWED_ATTR")?Et({},N.ALLOWED_ATTR,Cn):S,Mt=da(N,"ALLOWED_NAMESPACES")?Et({},N.ALLOWED_NAMESPACES,Wk):Fi,Qe=da(N,"ADD_URI_SAFE_ATTR")?Et(lu(Xt),N.ADD_URI_SAFE_ATTR,Cn):Xt,We=da(N,"ADD_DATA_URI_TAGS")?Et(lu(ht),N.ADD_DATA_URI_TAGS,Cn):ht,ot=da(N,"FORBID_CONTENTS")?Et({},N.FORBID_CONTENTS,Cn):tt,D=da(N,"FORBID_TAGS")?Et({},N.FORBID_TAGS,Cn):lu({}),U=da(N,"FORBID_ATTR")?Et({},N.FORBID_ATTR,Cn):lu({}),st=da(N,"USE_PROFILES")?N.USE_PROFILES:!1,X=N.ALLOW_ARIA_ATTR!==!1,ee=N.ALLOW_DATA_ATTR!==!1,k=N.ALLOW_UNKNOWN_PROTOCOLS||!1,M=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,R=N.SAFE_FOR_TEMPLATES||!1,V=N.SAFE_FOR_XML!==!1,q=N.WHOLE_DOCUMENT||!1,B=N.RETURN_DOM||!1,te=N.RETURN_DOM_FRAGMENT||!1,oe=N.RETURN_TRUSTED_TYPE||!1,re=N.FORCE_BODY||!1,ae=N.SANITIZE_DOM!==!1,fe=N.SANITIZE_NAMED_PROPS||!1,Ne=N.KEEP_CONTENT!==!1,ze=N.IN_PLACE||!1,ye=N.ALLOWED_URI_REGEXP||lX,dr=N.NAMESPACE||$t,Un=N.MATHML_TEXT_INTEGRATION_POINTS||Un,Ua=N.HTML_INTEGRATION_POINTS||Ua,_=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&N1(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&N1(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(_.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),R&&(ee=!1),te&&(B=!0),st&&(Re=Et({},lW),C=[],st.html===!0&&(Et(Re,aW),Et(C,uW)),st.svg===!0&&(Et(Re,jk),Et(C,Gk),Et(C,kC)),st.svgFilters===!0&&(Et(Re,Uk),Et(C,Gk),Et(C,kC)),st.mathMl===!0&&(Et(Re,zk),Et(C,cW),Et(C,kC))),N.ADD_TAGS&&(Re===W&&(Re=lu(Re)),Et(Re,N.ADD_TAGS,Cn)),N.ADD_ATTR&&(C===S&&(C=lu(C)),Et(C,N.ADD_ATTR,Cn)),N.ADD_URI_SAFE_ATTR&&Et(Qe,N.ADD_URI_SAFE_ATTR,Cn),N.FORBID_CONTENTS&&(ot===tt&&(ot=lu(ot)),Et(ot,N.FORBID_CONTENTS,Cn)),Ne&&(Re["#text"]=!0),q&&Et(Re,["html","head","body"]),Re.table&&(Et(Re,["tbody"]),delete D.tbody),N.TRUSTED_TYPES_POLICY){if(typeof N.TRUSTED_TYPES_POLICY.createHTML!="function")throw m0('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof N.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw m0('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=N.TRUSTED_TYPES_POLICY,T=b.createHTML("")}else b===void 0&&(b=TAe(d,i)),b!==null&&typeof T=="string"&&(T=b.createHTML(""));es&&es(N),cc=N}},D1=Et({},[...jk,...Uk,...pAe]),F1=Et({},[...zk,...vAe]),e0=function(N){let se=y(N);(!se||!se.tagName)&&(se={namespaceURI:dr,tagName:"template"});const de=Lx(N.tagName),ke=Lx(se.tagName);return Mt[N.namespaceURI]?N.namespaceURI===St?se.namespaceURI===$t?de==="svg":se.namespaceURI===Or?de==="svg"&&(ke==="annotation-xml"||Un[ke]):!!D1[de]:N.namespaceURI===Or?se.namespaceURI===$t?de==="math":se.namespaceURI===St?de==="math"&&Ua[ke]:!!F1[de]:N.namespaceURI===$t?se.namespaceURI===St&&!Ua[ke]||se.namespaceURI===Or&&!Un[ke]?!1:!F1[de]&&(og[de]||!D1[de]):!!(zh==="application/xhtml+xml"&&Mt[N.namespaceURI]):!1},ho=function(N){d0(e.removed,{element:N});try{y(N).removeChild(N)}catch{p(N)}},hc=function(N,se){try{d0(e.removed,{attribute:se.getAttributeNode(N),from:se})}catch{d0(e.removed,{attribute:null,from:se})}if(se.removeAttribute(N),N==="is")if(B||te)try{ho(se)}catch{}else try{se.setAttribute(N,"")}catch{}},H1=function(N){let se=null,de=null;if(re)N="<remove></remove>"+N;else{const Ae=oW(N,/^[\r\n\t ]+/);de=Ae&&Ae[0]}zh==="application/xhtml+xml"&&dr===$t&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");const ke=b?b.createHTML(N):N;if(dr===$t)try{se=new f().parseFromString(ke,zh)}catch{}if(!se||!se.documentElement){se=E.createDocument(dr,"template",null);try{se.documentElement.innerHTML=cr?T:ke}catch{}}const be=se.body||se.documentElement;return N&&de&&be.insertBefore(r.createTextNode(de),be.childNodes[0]||null),dr===$t?A.call(se,q?"html":"body")[0]:q?se.documentElement:be},I=function(N){return x.call(N.ownerDocument||N,N,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},z=function(N){return N instanceof h&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},F=function(N){return typeof a=="function"&&N instanceof a};function H(ne,N,se){TC(ne,de=>{de.call(e,N,se,cc)})}const G=function(N){let se=null;if(H(Y.beforeSanitizeElements,N,null),z(N))return ho(N),!0;const de=Cn(N.nodeName);if(H(Y.uponSanitizeElement,N,{tagName:de,allowedTags:Re}),V&&N.hasChildNodes()&&!F(N.firstElementChild)&&Hi(/<[/\w!]/g,N.innerHTML)&&Hi(/<[/\w!]/g,N.textContent)||N.nodeType===v0.progressingInstruction||V&&N.nodeType===v0.comment&&Hi(/<[/\w]/g,N.data))return ho(N),!0;if(!Re[de]||D[de]){if(!D[de]&&ue(de)&&(_.tagNameCheck instanceof RegExp&&Hi(_.tagNameCheck,de)||_.tagNameCheck instanceof Function&&_.tagNameCheck(de)))return!1;if(Ne&&!ot[de]){const ke=y(N)||N.parentNode,be=v(N)||N.childNodes;if(be&&ke){const Ae=be.length;for(let Ye=Ae-1;Ye>=0;--Ye){const Bt=m(be[Ye],!0);Bt.__removalCount=(N.__removalCount||0)+1,ke.insertBefore(Bt,w(N))}}}return ho(N),!0}return N instanceof l&&!e0(N)||(de==="noscript"||de==="noembed"||de==="noframes")&&Hi(/<\/no(script|embed|frames)/i,N.innerHTML)?(ho(N),!0):(R&&N.nodeType===v0.text&&(se=N.textContent,TC([L,ie,ce],ke=>{se=g0(se,ke," ")}),N.textContent!==se&&(d0(e.removed,{element:N.cloneNode()}),N.textContent=se)),H(Y.afterSanitizeElements,N,null),!1)},K=function(N,se,de){if(ae&&(se==="id"||se==="name")&&(de in r||de in lT))return!1;if(!(ee&&!U[se]&&Hi(he,se))){if(!(X&&Hi(Ee,se))){if(!C[se]||U[se]){if(!(ue(N)&&(_.tagNameCheck instanceof RegExp&&Hi(_.tagNameCheck,N)||_.tagNameCheck instanceof Function&&_.tagNameCheck(N))&&(_.attributeNameCheck instanceof RegExp&&Hi(_.attributeNameCheck,se)||_.attributeNameCheck instanceof Function&&_.attributeNameCheck(se))||se==="is"&&_.allowCustomizedBuiltInElements&&(_.tagNameCheck instanceof RegExp&&Hi(_.tagNameCheck,de)||_.tagNameCheck instanceof Function&&_.tagNameCheck(de))))return!1}else if(!Qe[se]){if(!Hi(ye,g0(de,ge,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&N!=="script"&&fAe(de,"data:")===0&&We[N])){if(!(k&&!Hi(Ce,g0(de,ge,"")))){if(de)return!1}}}}}}return!0},ue=function(N){return N!=="annotation-xml"&&oW(N,Q)},we=function(N){H(Y.beforeSanitizeAttributes,N,null);const{attributes:se}=N;if(!se||z(N))return;const de={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:C,forceKeepAttr:void 0};let ke=se.length;for(;ke--;){const be=se[ke],{name:Ae,namespaceURI:Ye,value:Bt}=be,tr=Cn(Ae),Sn=Bt;let Jr=Ae==="value"?Sn:dAe(Sn);if(de.attrName=tr,de.attrValue=Jr,de.keepAttr=!0,de.forceKeepAttr=void 0,H(Y.uponSanitizeAttribute,N,de),Jr=de.attrValue,fe&&(tr==="id"||tr==="name")&&(hc(Ae,N),Jr=Me+Jr),V&&Hi(/((--!?|])>)|<\/(style|title)/i,Jr)){hc(Ae,N);continue}if(de.forceKeepAttr)continue;if(!de.keepAttr){hc(Ae,N);continue}if(!M&&Hi(/\/>/i,Jr)){hc(Ae,N);continue}R&&TC([L,ie,ce],dc=>{Jr=g0(Jr,dc," ")});const fc=Cn(N.nodeName);if(!K(fc,tr,Jr)){hc(Ae,N);continue}if(b&&typeof d=="object"&&typeof d.getAttributeType=="function"&&!Ye)switch(d.getAttributeType(fc,tr)){case"TrustedHTML":{Jr=b.createHTML(Jr);break}case"TrustedScriptURL":{Jr=b.createScriptURL(Jr);break}}if(Jr!==Sn)try{Ye?N.setAttributeNS(Ye,Ae,Jr):N.setAttribute(Ae,Jr),z(N)?ho(N):sW(e.removed)}catch{hc(Ae,N)}}H(Y.afterSanitizeAttributes,N,null)},le=function ne(N){let se=null;const de=I(N);for(H(Y.beforeSanitizeShadowDOM,N,null);se=de.nextNode();)H(Y.uponSanitizeShadowNode,se,null),G(se),we(se),se.content instanceof s&&ne(se.content);H(Y.afterSanitizeShadowDOM,N,null)};return e.sanitize=function(ne){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se=null,de=null,ke=null,be=null;if(cr=!ne,cr&&(ne="<!-->"),typeof ne!="string"&&!F(ne))if(typeof ne.toString=="function"){if(ne=ne.toString(),typeof ne!="string")throw m0("dirty is not a string, aborting")}else throw m0("toString is not a function");if(!e.isSupported)return ne;if(J||Zp(N),e.removed=[],typeof ne=="string"&&(ze=!1),ze){if(ne.nodeName){const Bt=Cn(ne.nodeName);if(!Re[Bt]||D[Bt])throw m0("root node is forbidden and cannot be sanitized in-place")}}else if(ne instanceof a)se=H1("<!---->"),de=se.ownerDocument.importNode(ne,!0),de.nodeType===v0.element&&de.nodeName==="BODY"||de.nodeName==="HTML"?se=de:se.appendChild(de);else{if(!B&&!R&&!q&&ne.indexOf("<")===-1)return b&&oe?b.createHTML(ne):ne;if(se=H1(ne),!se)return B?null:oe?T:""}se&&re&&ho(se.firstChild);const Ae=I(ze?ne:se);for(;ke=Ae.nextNode();)G(ke),we(ke),ke.content instanceof s&&le(ke.content);if(ze)return ne;if(B){if(te)for(be=P.call(se.ownerDocument);se.firstChild;)be.appendChild(se.firstChild);else be=se;return(C.shadowroot||C.shadowrootmode)&&(be=O.call(n,be,!0)),be}let Ye=q?se.outerHTML:se.innerHTML;return q&&Re["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&Hi(uX,se.ownerDocument.doctype.name)&&(Ye="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+Ye),R&&TC([L,ie,ce],Bt=>{Ye=g0(Ye,Bt," ")}),b&&oe?b.createHTML(Ye):Ye},e.setConfig=function(){let ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zp(ne),J=!0},e.clearConfig=function(){cc=null,J=!1},e.isValidAttribute=function(ne,N,se){cc||Zp({});const de=Cn(ne),ke=Cn(N);return K(de,ke,se)},e.addHook=function(ne,N){typeof N=="function"&&d0(Y[ne],N)},e.removeHook=function(ne,N){if(N!==void 0){const se=cAe(Y[ne],N);return se===-1?void 0:hAe(Y[ne],se,1)[0]}return sW(Y[ne])},e.removeHooks=function(ne){Y[ne]=[]},e.removeAllHooks=function(){Y=fW()},e}var kAe=cX();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var hX;function _e(){return hX.apply(null,arguments)}function PAe(t){hX=t}function Fa(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function cd(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Yt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function eF(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Yt(t,e))return!1;return!0}function gs(t){return t===void 0}function Yu(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function d1(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function fX(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function rh(t,e){for(var r in e)Yt(e,r)&&(t[r]=e[r]);return Yt(e,"toString")&&(t.toString=e.toString),Yt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ul(t,e,r,n){return DX(t,e,r,n,!0).utc()}function AAe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function mt(t){return t._pf==null&&(t._pf=AAe()),t._pf}var vM;Array.prototype.some?vM=Array.prototype.some:vM=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function tF(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=mt(t),r=vM.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function dR(t){var e=Ul(NaN);return t!=null?rh(mt(e),t):mt(e).userInvalidated=!0,e}var dW=_e.momentProperties=[],Yk=!1;function rF(t,e){var r,n,i,s=dW.length;if(gs(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),gs(e._i)||(t._i=e._i),gs(e._f)||(t._f=e._f),gs(e._l)||(t._l=e._l),gs(e._strict)||(t._strict=e._strict),gs(e._tzm)||(t._tzm=e._tzm),gs(e._isUTC)||(t._isUTC=e._isUTC),gs(e._offset)||(t._offset=e._offset),gs(e._pf)||(t._pf=mt(e)),gs(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=dW[r],i=e[n],gs(i)||(t[n]=i);return t}function g1(t){rF(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Yk===!1&&(Yk=!0,_e.updateOffset(this),Yk=!1)}function Ha(t){return t instanceof g1||t!=null&&t._isAMomentObject!=null}function dX(t){_e.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function qo(t,e){var r=!0;return rh(function(){if(_e.deprecationHandler!=null&&_e.deprecationHandler(null,t),r){var n=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Yt(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}dX(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var gW={};function gX(t,e){_e.deprecationHandler!=null&&_e.deprecationHandler(t,e),gW[t]||(dX(e),gW[t]=!0)}_e.suppressDeprecationWarnings=!1;_e.deprecationHandler=null;function zl(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function IAe(t){var e,r;for(r in t)Yt(t,r)&&(e=t[r],zl(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function wM(t,e){var r=rh({},t),n;for(n in e)Yt(e,n)&&(cd(t[n])&&cd(e[n])?(r[n]={},rh(r[n],t[n]),rh(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Yt(t,n)&&!Yt(e,n)&&cd(t[n])&&(r[n]=rh({},r[n]));return r}function nF(t){t!=null&&this.set(t)}var yM;Object.keys?yM=Object.keys:yM=function(t){var e,r=[];for(e in t)Yt(t,e)&&r.push(e);return r};var OAe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function MAe(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return zl(n)?n.call(e,r):n}function Hl(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var iF=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,PC=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Kk={},Gm={};function Je(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Gm[t]=i),e&&(Gm[e[0]]=function(){return Hl(i.apply(this,arguments),e[1],e[2])}),r&&(Gm[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function NAe(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function DAe(t){var e=t.match(iF),r,n;for(r=0,n=e.length;r<n;r++)Gm[e[r]]?e[r]=Gm[e[r]]:e[r]=NAe(e[r]);return function(i){var s="",o;for(o=0;o<n;o++)s+=zl(e[o])?e[o].call(i,t):e[o];return s}}function $x(t,e){return t.isValid()?(e=mX(e,t.localeData()),Kk[e]=Kk[e]||DAe(e),Kk[e](t)):t.localeData().invalidDate()}function mX(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(PC.lastIndex=0;r>=0&&PC.test(t);)t=t.replace(PC,n),PC.lastIndex=0,r-=1;return t}var FAe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function HAe(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(iF).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var LAe="Invalid date";function $Ae(){return this._invalidDate}var BAe="%d",VAe=/\d{1,2}/;function WAe(t){return this._ordinal.replace("%d",t)}var jAe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function UAe(t,e,r,n){var i=this._relativeTime[r];return zl(i)?i(t,e,r,n):i.replace(/%d/i,t)}function zAe(t,e){var r=this._relativeTime[t>0?"future":"past"];return zl(r)?r(e):r.replace(/%s/i,e)}var mW={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Jo(t){return typeof t=="string"?mW[t]||mW[t.toLowerCase()]:void 0}function sF(t){var e={},r,n;for(n in t)Yt(t,n)&&(r=Jo(n),r&&(e[r]=t[n]));return e}var GAe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function YAe(t){var e=[],r;for(r in t)Yt(t,r)&&e.push({unit:r,priority:GAe[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var pX=/\d/,co=/\d\d/,vX=/\d{3}/,oF=/\d{4}/,gR=/[+-]?\d{6}/,Ir=/\d\d?/,wX=/\d\d\d\d?/,yX=/\d\d\d\d\d\d?/,mR=/\d{1,3}/,aF=/\d{1,4}/,pR=/[+-]?\d{1,6}/,Wp=/\d+/,vR=/[+-]?\d+/,KAe=/Z|[+-]\d\d:?\d\d/gi,wR=/Z|[+-]\d\d(?::?\d\d)?/gi,XAe=/[+-]?\d+(\.\d{1,3})?/,m1=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,jp=/^[1-9]\d?/,lF=/^([1-9]\d|\d)/,u_;u_={};function $e(t,e,r){u_[t]=zl(e)?e:function(n,i){return n&&r?r:e}}function qAe(t,e){return Yt(u_,t)?u_[t](e._strict,e._locale):new RegExp(JAe(t))}function JAe(t){return Hu(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function Hu(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Do(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function At(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Do(e)),r}var CM={};function fr(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Yu(e)&&(n=function(s,o){o[e]=At(s)}),i=t.length,r=0;r<i;r++)CM[t[r]]=n}function p1(t,e){fr(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function QAe(t,e,r){e!=null&&Yt(CM,t)&&CM[t](e,r._a,r,t)}function yR(t){return t%4===0&&t%100!==0||t%400===0}var Oi=0,Eu=1,_l=2,Wn=3,ka=4,Ru=5,Xf=6,ZAe=7,eIe=8;Je("Y",0,0,function(){var t=this.year();return t<=9999?Hl(t,4):"+"+t});Je(0,["YY",2],0,function(){return this.year()%100});Je(0,["YYYY",4],0,"year");Je(0,["YYYYY",5],0,"year");Je(0,["YYYYYY",6,!0],0,"year");$e("Y",vR);$e("YY",Ir,co);$e("YYYY",aF,oF);$e("YYYYY",pR,gR);$e("YYYYYY",pR,gR);fr(["YYYYY","YYYYYY"],Oi);fr("YYYY",function(t,e){e[Oi]=t.length===2?_e.parseTwoDigitYear(t):At(t)});fr("YY",function(t,e){e[Oi]=_e.parseTwoDigitYear(t)});fr("Y",function(t,e){e[Oi]=parseInt(t,10)});function Zv(t){return yR(t)?366:365}_e.parseTwoDigitYear=function(t){return At(t)+(At(t)>68?1900:2e3)};var CX=Up("FullYear",!0);function tIe(){return yR(this.year())}function Up(t,e){return function(r){return r!=null?(SX(this,t,r),_e.updateOffset(this,e),this):fy(this,t)}}function fy(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function SX(t,e,r){var n,i,s,o,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,o=t.month(),a=t.date(),a=a===29&&o===1&&!yR(s)?28:a,i?n.setUTCFullYear(s,o,a):n.setFullYear(s,o,a)}}function rIe(t){return t=Jo(t),zl(this[t])?this[t]():this}function nIe(t,e){if(typeof t=="object"){t=sF(t);var r=YAe(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Jo(t),zl(this[t]))return this[t](e);return this}function iIe(t,e){return(t%e+e)%e}var dn;Array.prototype.indexOf?dn=Array.prototype.indexOf:dn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function uF(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=iIe(e,12);return t+=(e-r)/12,r===1?yR(t)?29:28:31-r%7%2}Je("M",["MM",2],"Mo",function(){return this.month()+1});Je("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Je("MMMM",0,0,function(t){return this.localeData().months(this,t)});$e("M",Ir,jp);$e("MM",Ir,co);$e("MMM",function(t,e){return e.monthsShortRegex(t)});$e("MMMM",function(t,e){return e.monthsRegex(t)});fr(["M","MM"],function(t,e){e[Eu]=At(t)-1});fr(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Eu]=i:mt(r).invalidMonth=t});var sIe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),xX="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),bX=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,oIe=m1,aIe=m1;function lIe(t,e){return t?Fa(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||bX).test(e)?"format":"standalone"][t.month()]:Fa(this._months)?this._months:this._months.standalone}function uIe(t,e){return t?Fa(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[bX.test(e)?"format":"standalone"][t.month()]:Fa(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function cIe(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Ul([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=dn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=dn.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=dn.call(this._shortMonthsParse,o),i!==-1?i:(i=dn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=dn.call(this._longMonthsParse,o),i!==-1?i:(i=dn.call(this._shortMonthsParse,o),i!==-1?i:null))}function hIe(t,e,r){var n,i,s;if(this._monthsParseExact)return cIe.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Ul([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function _X(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=At(e);else if(e=t.localeData().monthsParse(e),!Yu(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,uF(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function EX(t){return t!=null?(_X(this,t),_e.updateOffset(this,!0),this):fy(this,"Month")}function fIe(){return uF(this.year(),this.month())}function dIe(t){return this._monthsParseExact?(Yt(this,"_monthsRegex")||RX.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Yt(this,"_monthsShortRegex")||(this._monthsShortRegex=oIe),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function gIe(t){return this._monthsParseExact?(Yt(this,"_monthsRegex")||RX.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Yt(this,"_monthsRegex")||(this._monthsRegex=aIe),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function RX(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,s,o,a;for(i=0;i<12;i++)s=Ul([2e3,i]),o=Hu(this.monthsShort(s,"")),a=Hu(this.months(s,"")),e.push(o),r.push(a),n.push(a),n.push(o);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function mIe(t,e,r,n,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,s,o),a}function dy(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function c_(t,e,r){var n=7+e-r,i=(7+dy(t,0,n).getUTCDay()-e)%7;return-i+n-1}function TX(t,e,r,n,i){var s=(7+r-n)%7,o=c_(t,n,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=t-1,u=Zv(l)+a):a>Zv(t)?(l=t+1,u=a-Zv(t)):(l=t,u=a),{year:l,dayOfYear:u}}function gy(t,e,r){var n=c_(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+Lu(o,e,r)):i>Lu(t.year(),e,r)?(s=i-Lu(t.year(),e,r),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function Lu(t,e,r){var n=c_(t,e,r),i=c_(t+1,e,r);return(Zv(t)-n+i)/7}Je("w",["ww",2],"wo","week");Je("W",["WW",2],"Wo","isoWeek");$e("w",Ir,jp);$e("ww",Ir,co);$e("W",Ir,jp);$e("WW",Ir,co);p1(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=At(t)});function pIe(t){return gy(t,this._week.dow,this._week.doy).week}var vIe={dow:0,doy:6};function wIe(){return this._week.dow}function yIe(){return this._week.doy}function CIe(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function SIe(t){var e=gy(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Je("d",0,"do","day");Je("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Je("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Je("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Je("e",0,0,"weekday");Je("E",0,0,"isoWeekday");$e("d",Ir);$e("e",Ir);$e("E",Ir);$e("dd",function(t,e){return e.weekdaysMinRegex(t)});$e("ddd",function(t,e){return e.weekdaysShortRegex(t)});$e("dddd",function(t,e){return e.weekdaysRegex(t)});p1(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:mt(r).invalidWeekday=t});p1(["d","e","E"],function(t,e,r,n){e[n]=At(t)});function xIe(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function bIe(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function cF(t,e){return t.slice(e,7).concat(t.slice(0,e))}var _Ie="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),kX="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),EIe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),RIe=m1,TIe=m1,kIe=m1;function PIe(t,e){var r=Fa(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?cF(r,this._week.dow):t?r[t.day()]:r}function AIe(t){return t===!0?cF(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function IIe(t){return t===!0?cF(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function OIe(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Ul([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=dn.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=dn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=dn.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=dn.call(this._weekdaysParse,o),i!==-1||(i=dn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=dn.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=dn.call(this._shortWeekdaysParse,o),i!==-1||(i=dn.call(this._weekdaysParse,o),i!==-1)?i:(i=dn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=dn.call(this._minWeekdaysParse,o),i!==-1||(i=dn.call(this._weekdaysParse,o),i!==-1)?i:(i=dn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function MIe(t,e,r){var n,i,s;if(this._weekdaysParseExact)return OIe.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Ul([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function NIe(t){if(!this.isValid())return t!=null?this:NaN;var e=fy(this,"Day");return t!=null?(t=xIe(t,this.localeData()),this.add(t-e,"d")):e}function DIe(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function FIe(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=bIe(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function HIe(t){return this._weekdaysParseExact?(Yt(this,"_weekdaysRegex")||hF.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Yt(this,"_weekdaysRegex")||(this._weekdaysRegex=RIe),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function LIe(t){return this._weekdaysParseExact?(Yt(this,"_weekdaysRegex")||hF.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Yt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=TIe),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function $Ie(t){return this._weekdaysParseExact?(Yt(this,"_weekdaysRegex")||hF.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Yt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=kIe),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function hF(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=Ul([2e3,1]).day(s),a=Hu(this.weekdaysMin(o,"")),l=Hu(this.weekdaysShort(o,"")),u=Hu(this.weekdays(o,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function fF(){return this.hours()%12||12}function BIe(){return this.hours()||24}Je("H",["HH",2],0,"hour");Je("h",["hh",2],0,fF);Je("k",["kk",2],0,BIe);Je("hmm",0,0,function(){return""+fF.apply(this)+Hl(this.minutes(),2)});Je("hmmss",0,0,function(){return""+fF.apply(this)+Hl(this.minutes(),2)+Hl(this.seconds(),2)});Je("Hmm",0,0,function(){return""+this.hours()+Hl(this.minutes(),2)});Je("Hmmss",0,0,function(){return""+this.hours()+Hl(this.minutes(),2)+Hl(this.seconds(),2)});function PX(t,e){Je(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}PX("a",!0);PX("A",!1);function AX(t,e){return e._meridiemParse}$e("a",AX);$e("A",AX);$e("H",Ir,lF);$e("h",Ir,jp);$e("k",Ir,jp);$e("HH",Ir,co);$e("hh",Ir,co);$e("kk",Ir,co);$e("hmm",wX);$e("hmmss",yX);$e("Hmm",wX);$e("Hmmss",yX);fr(["H","HH"],Wn);fr(["k","kk"],function(t,e,r){var n=At(t);e[Wn]=n===24?0:n});fr(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});fr(["h","hh"],function(t,e,r){e[Wn]=At(t),mt(r).bigHour=!0});fr("hmm",function(t,e,r){var n=t.length-2;e[Wn]=At(t.substr(0,n)),e[ka]=At(t.substr(n)),mt(r).bigHour=!0});fr("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Wn]=At(t.substr(0,n)),e[ka]=At(t.substr(n,2)),e[Ru]=At(t.substr(i)),mt(r).bigHour=!0});fr("Hmm",function(t,e,r){var n=t.length-2;e[Wn]=At(t.substr(0,n)),e[ka]=At(t.substr(n))});fr("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Wn]=At(t.substr(0,n)),e[ka]=At(t.substr(n,2)),e[Ru]=At(t.substr(i))});function VIe(t){return(t+"").toLowerCase().charAt(0)==="p"}var WIe=/[ap]\.?m?\.?/i,jIe=Up("Hours",!0);function UIe(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var IX={calendar:OAe,longDateFormat:FAe,invalidDate:LAe,ordinal:BAe,dayOfMonthOrdinalParse:VAe,relativeTime:jAe,months:sIe,monthsShort:xX,week:vIe,weekdays:_Ie,weekdaysMin:EIe,weekdaysShort:kX,meridiemParse:WIe},Mr={},w0={},my;function zIe(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function pW(t){return t&&t.toLowerCase().replace("_","-")}function GIe(t){for(var e=0,r,n,i,s;e<t.length;){for(s=pW(t[e]).split("-"),r=s.length,n=pW(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=CR(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&zIe(s,n)>=r-1)break;r--}e++}return my}function YIe(t){return!!(t&&t.match("^[^/\\\\]*$"))}function CR(t){var e=null,r;if(Mr[t]===void 0&&typeof lb<"u"&&lb&&lb.exports&&YIe(t))try{e=my._abbr,r=require,r("./locale/"+t),wh(e)}catch{Mr[t]=null}return Mr[t]}function wh(t,e){var r;return t&&(gs(e)?r=sc(t):r=dF(t,e),r?my=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),my._abbr}function dF(t,e){if(e!==null){var r,n=IX;if(e.abbr=t,Mr[t]!=null)gX("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Mr[t]._config;else if(e.parentLocale!=null)if(Mr[e.parentLocale]!=null)n=Mr[e.parentLocale]._config;else if(r=CR(e.parentLocale),r!=null)n=r._config;else return w0[e.parentLocale]||(w0[e.parentLocale]=[]),w0[e.parentLocale].push({name:t,config:e}),null;return Mr[t]=new nF(wM(n,e)),w0[t]&&w0[t].forEach(function(i){dF(i.name,i.config)}),wh(t),Mr[t]}else return delete Mr[t],null}function KIe(t,e){if(e!=null){var r,n,i=IX;Mr[t]!=null&&Mr[t].parentLocale!=null?Mr[t].set(wM(Mr[t]._config,e)):(n=CR(t),n!=null&&(i=n._config),e=wM(i,e),n==null&&(e.abbr=t),r=new nF(e),r.parentLocale=Mr[t],Mr[t]=r),wh(t)}else Mr[t]!=null&&(Mr[t].parentLocale!=null?(Mr[t]=Mr[t].parentLocale,t===wh()&&wh(t)):Mr[t]!=null&&delete Mr[t]);return Mr[t]}function sc(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return my;if(!Fa(t)){if(e=CR(t),e)return e;t=[t]}return GIe(t)}function XIe(){return yM(Mr)}function gF(t){var e,r=t._a;return r&&mt(t).overflow===-2&&(e=r[Eu]<0||r[Eu]>11?Eu:r[_l]<1||r[_l]>uF(r[Oi],r[Eu])?_l:r[Wn]<0||r[Wn]>24||r[Wn]===24&&(r[ka]!==0||r[Ru]!==0||r[Xf]!==0)?Wn:r[ka]<0||r[ka]>59?ka:r[Ru]<0||r[Ru]>59?Ru:r[Xf]<0||r[Xf]>999?Xf:-1,mt(t)._overflowDayOfYear&&(e<Oi||e>_l)&&(e=_l),mt(t)._overflowWeeks&&e===-1&&(e=ZAe),mt(t)._overflowWeekday&&e===-1&&(e=eIe),mt(t).overflow=e),t}var qIe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,JIe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,QIe=/Z|[+-]\d\d(?::?\d\d)?/,AC=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Xk=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ZIe=/^\/?Date\((-?\d+)/i,eOe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,tOe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function OX(t){var e,r,n=t._i,i=qIe.exec(n)||JIe.exec(n),s,o,a,l,u=AC.length,c=Xk.length;if(i){for(mt(t).iso=!0,e=0,r=u;e<r;e++)if(AC[e][1].exec(i[1])){o=AC[e][0],s=AC[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(Xk[e][1].exec(i[3])){a=(i[2]||" ")+Xk[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(QIe.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),pF(t)}else t._isValid=!1}function rOe(t,e,r,n,i,s){var o=[nOe(t),xX.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function nOe(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function iOe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function sOe(t,e,r){if(t){var n=kX.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return mt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function oOe(t,e,r){if(t)return tOe[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function MX(t){var e=eOe.exec(iOe(t._i)),r;if(e){if(r=rOe(e[4],e[3],e[2],e[5],e[6],e[7]),!sOe(e[1],r,t))return;t._a=r,t._tzm=oOe(e[8],e[9],e[10]),t._d=dy.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),mt(t).rfc2822=!0}else t._isValid=!1}function aOe(t){var e=ZIe.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(OX(t),t._isValid===!1)delete t._isValid;else return;if(MX(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:_e.createFromInputFallback(t)}_e.createFromInputFallback=qo("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function tm(t,e,r){return t??e??r}function lOe(t){var e=new Date(_e.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function mF(t){var e,r,n=[],i,s,o;if(!t._d){for(i=lOe(t),t._w&&t._a[_l]==null&&t._a[Eu]==null&&uOe(t),t._dayOfYear!=null&&(o=tm(t._a[Oi],i[Oi]),(t._dayOfYear>Zv(o)||t._dayOfYear===0)&&(mt(t)._overflowDayOfYear=!0),r=dy(o,0,t._dayOfYear),t._a[Eu]=r.getUTCMonth(),t._a[_l]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Wn]===24&&t._a[ka]===0&&t._a[Ru]===0&&t._a[Xf]===0&&(t._nextDay=!0,t._a[Wn]=0),t._d=(t._useUTC?dy:mIe).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Wn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(mt(t).weekdayMismatch=!0)}}function uOe(t){var e,r,n,i,s,o,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,r=tm(e.GG,t._a[Oi],gy(Ar(),1,4).year),n=tm(e.W,1),i=tm(e.E,1),(i<1||i>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=gy(Ar(),s,o),r=tm(e.gg,t._a[Oi],u.year),n=tm(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),n<1||n>Lu(r,s,o)?mt(t)._overflowWeeks=!0:l!=null?mt(t)._overflowWeekday=!0:(a=TX(r,n,i,s,o),t._a[Oi]=a.year,t._dayOfYear=a.dayOfYear)}_e.ISO_8601=function(){};_e.RFC_2822=function(){};function pF(t){if(t._f===_e.ISO_8601){OX(t);return}if(t._f===_e.RFC_2822){MX(t);return}t._a=[],mt(t).empty=!0;var e=""+t._i,r,n,i,s,o,a=e.length,l=0,u,c;for(i=mX(t._f,t._locale).match(iF)||[],c=i.length,r=0;r<c;r++)s=i[r],n=(e.match(qAe(s,t))||[])[0],n&&(o=e.substr(0,e.indexOf(n)),o.length>0&&mt(t).unusedInput.push(o),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Gm[s]?(n?mt(t).empty=!1:mt(t).unusedTokens.push(s),QAe(s,n,t)):t._strict&&!n&&mt(t).unusedTokens.push(s);mt(t).charsLeftOver=a-l,e.length>0&&mt(t).unusedInput.push(e),t._a[Wn]<=12&&mt(t).bigHour===!0&&t._a[Wn]>0&&(mt(t).bigHour=void 0),mt(t).parsedDateParts=t._a.slice(0),mt(t).meridiem=t._meridiem,t._a[Wn]=cOe(t._locale,t._a[Wn],t._meridiem),u=mt(t).era,u!==null&&(t._a[Oi]=t._locale.erasConvertYear(u,t._a[Oi])),mF(t),gF(t)}function cOe(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function hOe(t){var e,r,n,i,s,o,a=!1,l=t._f.length;if(l===0){mt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=rF({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],pF(e),tF(e)&&(o=!0),s+=mt(e).charsLeftOver,s+=mt(e).unusedTokens.length*10,mt(e).score=s,a?s<n&&(n=s,r=e):(n==null||s<n||o)&&(n=s,r=e,o&&(a=!0));rh(t,r||e)}function fOe(t){if(!t._d){var e=sF(t._i),r=e.day===void 0?e.date:e.day;t._a=fX([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),mF(t)}}function dOe(t){var e=new g1(gF(NX(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function NX(t){var e=t._i,r=t._f;return t._locale=t._locale||sc(t._l),e===null||r===void 0&&e===""?dR({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Ha(e)?new g1(gF(e)):(d1(e)?t._d=e:Fa(r)?hOe(t):r?pF(t):gOe(t),tF(t)||(t._d=null),t))}function gOe(t){var e=t._i;gs(e)?t._d=new Date(_e.now()):d1(e)?t._d=new Date(e.valueOf()):typeof e=="string"?aOe(t):Fa(e)?(t._a=fX(e.slice(0),function(r){return parseInt(r,10)}),mF(t)):cd(e)?fOe(t):Yu(e)?t._d=new Date(e):_e.createFromInputFallback(t)}function DX(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(cd(t)&&eF(t)||Fa(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,dOe(s)}function Ar(t,e,r,n){return DX(t,e,r,n,!1)}var mOe=qo("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ar.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:dR()}),pOe=qo("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ar.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:dR()});function FX(t,e){var r,n;if(e.length===1&&Fa(e[0])&&(e=e[0]),!e.length)return Ar();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function vOe(){var t=[].slice.call(arguments,0);return FX("isBefore",t)}function wOe(){var t=[].slice.call(arguments,0);return FX("isAfter",t)}var yOe=function(){return Date.now?Date.now():+new Date},y0=["year","quarter","month","week","day","hour","minute","second","millisecond"];function COe(t){var e,r=!1,n,i=y0.length;for(e in t)if(Yt(t,e)&&!(dn.call(y0,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[y0[n]]){if(r)return!1;parseFloat(t[y0[n]])!==At(t[y0[n]])&&(r=!0)}return!0}function SOe(){return this._isValid}function xOe(){return Wa(NaN)}function SR(t){var e=sF(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=COe(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=sc(),this._bubble()}function Bx(t){return t instanceof SR}function SM(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function bOe(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<n;o++)At(t[o])!==At(e[o])&&s++;return s+i}function HX(t,e){Je(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Hl(~~(r/60),2)+e+Hl(~~r%60,2)})}HX("Z",":");HX("ZZ","");$e("Z",wR);$e("ZZ",wR);fr(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=vF(wR,t)});var _Oe=/([\+\-]|\d\d)/gi;function vF(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(_Oe)||["-",0,0],s=+(i[1]*60)+At(i[2]),s===0?0:i[0]==="+"?s:-s)}function wF(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(Ha(t)||d1(t)?t.valueOf():Ar(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),_e.updateOffset(r,!1),r):Ar(t).local()}function xM(t){return-Math.round(t._d.getTimezoneOffset())}_e.updateOffset=function(){};function EOe(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=vF(wR,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=xM(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?BX(this,Wa(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,_e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:xM(this)}function ROe(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function TOe(t){return this.utcOffset(0,t)}function kOe(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(xM(this),"m")),this}function POe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=vF(KAe,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function AOe(t){return this.isValid()?(t=t?Ar(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function IOe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function OOe(){if(!gs(this._isDSTShifted))return this._isDSTShifted;var t={},e;return rF(t,this),t=NX(t),t._a?(e=t._isUTC?Ul(t._a):Ar(t._a),this._isDSTShifted=this.isValid()&&bOe(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function MOe(){return this.isValid()?!this._isUTC:!1}function NOe(){return this.isValid()?this._isUTC:!1}function LX(){return this.isValid()?this._isUTC&&this._offset===0:!1}var DOe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,FOe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Wa(t,e){var r=t,n=null,i,s,o;return Bx(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Yu(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=DOe.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:At(n[_l])*i,h:At(n[Wn])*i,m:At(n[ka])*i,s:At(n[Ru])*i,ms:At(SM(n[Xf]*1e3))*i}):(n=FOe.exec(t))?(i=n[1]==="-"?-1:1,r={y:qh(n[2],i),M:qh(n[3],i),w:qh(n[4],i),d:qh(n[5],i),h:qh(n[6],i),m:qh(n[7],i),s:qh(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=HOe(Ar(r.from),Ar(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new SR(r),Bx(t)&&Yt(t,"_locale")&&(s._locale=t._locale),Bx(t)&&Yt(t,"_isValid")&&(s._isValid=t._isValid),s}Wa.fn=SR.prototype;Wa.invalid=xOe;function qh(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function vW(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function HOe(t,e){var r;return t.isValid()&&e.isValid()?(e=wF(e,t),t.isBefore(e)?r=vW(t,e):(r=vW(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function $X(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(gX(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=Wa(r,n),BX(this,i,t),this}}function BX(t,e,r,n){var i=e._milliseconds,s=SM(e._days),o=SM(e._months);t.isValid()&&(n=n??!0,o&&_X(t,fy(t,"Month")+o*r),s&&SX(t,"Date",fy(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&_e.updateOffset(t,s||o))}var LOe=$X(1,"add"),$Oe=$X(-1,"subtract");function VX(t){return typeof t=="string"||t instanceof String}function BOe(t){return Ha(t)||d1(t)||VX(t)||Yu(t)||WOe(t)||VOe(t)||t===null||t===void 0}function VOe(t){var e=cd(t)&&!eF(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=n.length;for(i=0;i<o;i+=1)s=n[i],r=r||Yt(t,s);return e&&r}function WOe(t){var e=Fa(t),r=!1;return e&&(r=t.filter(function(n){return!Yu(n)&&VX(t)}).length===0),e&&r}function jOe(t){var e=cd(t)&&!eF(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||Yt(t,s);return e&&r}function UOe(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function zOe(t,e){arguments.length===1&&(arguments[0]?BOe(arguments[0])?(t=arguments[0],e=void 0):jOe(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ar(),n=wF(r,this).startOf("day"),i=_e.calendarFormat(this,n)||"sameElse",s=e&&(zl(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,Ar(r)))}function GOe(){return new g1(this)}function YOe(t,e){var r=Ha(t)?t:Ar(t);return this.isValid()&&r.isValid()?(e=Jo(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function KOe(t,e){var r=Ha(t)?t:Ar(t);return this.isValid()&&r.isValid()?(e=Jo(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function XOe(t,e,r,n){var i=Ha(t)?t:Ar(t),s=Ha(e)?e:Ar(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function qOe(t,e){var r=Ha(t)?t:Ar(t),n;return this.isValid()&&r.isValid()?(e=Jo(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function JOe(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function QOe(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function ZOe(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=wF(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Jo(e),e){case"year":s=Vx(this,n)/12;break;case"month":s=Vx(this,n);break;case"quarter":s=Vx(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:Do(s)}function Vx(t,e){if(t.date()<e.date())return-Vx(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}_e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";_e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function eMe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function tMe(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?$x(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):zl(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",$x(r,"Z")):$x(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function rMe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function nMe(t){t||(t=this.isUtc()?_e.defaultFormatUtc:_e.defaultFormat);var e=$x(this,t);return this.localeData().postformat(e)}function iMe(t,e){return this.isValid()&&(Ha(t)&&t.isValid()||Ar(t).isValid())?Wa({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function sMe(t){return this.from(Ar(),t)}function oMe(t,e){return this.isValid()&&(Ha(t)&&t.isValid()||Ar(t).isValid())?Wa({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function aMe(t){return this.to(Ar(),t)}function WX(t){var e;return t===void 0?this._locale._abbr:(e=sc(t),e!=null&&(this._locale=e),this)}var jX=qo("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function UX(){return this._locale}var h_=1e3,Ym=60*h_,f_=60*Ym,zX=(365*400+97)*24*f_;function Km(t,e){return(t%e+e)%e}function GX(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-zX:new Date(t,e,r).valueOf()}function YX(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-zX:Date.UTC(t,e,r)}function lMe(t){var e,r;if(t=Jo(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?YX:GX,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Km(e+(this._isUTC?0:this.utcOffset()*Ym),f_);break;case"minute":e=this._d.valueOf(),e-=Km(e,Ym);break;case"second":e=this._d.valueOf(),e-=Km(e,h_);break}return this._d.setTime(e),_e.updateOffset(this,!0),this}function uMe(t){var e,r;if(t=Jo(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?YX:GX,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=f_-Km(e+(this._isUTC?0:this.utcOffset()*Ym),f_)-1;break;case"minute":e=this._d.valueOf(),e+=Ym-Km(e,Ym)-1;break;case"second":e=this._d.valueOf(),e+=h_-Km(e,h_)-1;break}return this._d.setTime(e),_e.updateOffset(this,!0),this}function cMe(){return this._d.valueOf()-(this._offset||0)*6e4}function hMe(){return Math.floor(this.valueOf()/1e3)}function fMe(){return new Date(this.valueOf())}function dMe(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function gMe(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function mMe(){return this.isValid()?this.toISOString():null}function pMe(){return tF(this)}function vMe(){return rh({},mt(this))}function wMe(){return mt(this).overflow}function yMe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Je("N",0,0,"eraAbbr");Je("NN",0,0,"eraAbbr");Je("NNN",0,0,"eraAbbr");Je("NNNN",0,0,"eraName");Je("NNNNN",0,0,"eraNarrow");Je("y",["y",1],"yo","eraYear");Je("y",["yy",2],0,"eraYear");Je("y",["yyy",3],0,"eraYear");Je("y",["yyyy",4],0,"eraYear");$e("N",yF);$e("NN",yF);$e("NNN",yF);$e("NNNN",AMe);$e("NNNNN",IMe);fr(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?mt(r).era=i:mt(r).invalidEra=t});$e("y",Wp);$e("yy",Wp);$e("yyy",Wp);$e("yyyy",Wp);$e("yo",OMe);fr(["y","yy","yyy","yyyy"],Oi);fr(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Oi]=r._locale.eraYearOrdinalParse(t,i):e[Oi]=parseInt(t,10)});function CMe(t,e){var r,n,i,s=this._eras||sc("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=_e(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=_e(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function SMe(t,e,r){var n,i,s=this.eras(),o,a,l;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(o=s[n].name.toUpperCase(),a=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[n];break;case"NNNN":if(o===t)return s[n];break;case"NNNNN":if(l===t)return s[n];break}else if([o,a,l].indexOf(t)>=0)return s[n]}function xMe(t,e){var r=t.since<=t.until?1:-1;return e===void 0?_e(t.since).year():_e(t.since).year()+(e-t.offset)*r}function bMe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function _Me(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function EMe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function RMe(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-_e(i[t].since).year())*r+i[t].offset;return this.year()}function TMe(t){return Yt(this,"_erasNameRegex")||CF.call(this),t?this._erasNameRegex:this._erasRegex}function kMe(t){return Yt(this,"_erasAbbrRegex")||CF.call(this),t?this._erasAbbrRegex:this._erasRegex}function PMe(t){return Yt(this,"_erasNarrowRegex")||CF.call(this),t?this._erasNarrowRegex:this._erasRegex}function yF(t,e){return e.erasAbbrRegex(t)}function AMe(t,e){return e.erasNameRegex(t)}function IMe(t,e){return e.erasNarrowRegex(t)}function OMe(t,e){return e._eraYearOrdinalRegex||Wp}function CF(){var t=[],e=[],r=[],n=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=Hu(u[i].name),a=Hu(u[i].abbr),l=Hu(u[i].narrow),e.push(o),t.push(a),r.push(l),n.push(o),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Je(0,["gg",2],0,function(){return this.weekYear()%100});Je(0,["GG",2],0,function(){return this.isoWeekYear()%100});function xR(t,e){Je(0,[t,t.length],0,e)}xR("gggg","weekYear");xR("ggggg","weekYear");xR("GGGG","isoWeekYear");xR("GGGGG","isoWeekYear");$e("G",vR);$e("g",vR);$e("GG",Ir,co);$e("gg",Ir,co);$e("GGGG",aF,oF);$e("gggg",aF,oF);$e("GGGGG",pR,gR);$e("ggggg",pR,gR);p1(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=At(t)});p1(["gg","GG"],function(t,e,r,n){e[n]=_e.parseTwoDigitYear(t)});function MMe(t){return KX.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function NMe(t){return KX.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function DMe(){return Lu(this.year(),1,4)}function FMe(){return Lu(this.isoWeekYear(),1,4)}function HMe(){var t=this.localeData()._week;return Lu(this.year(),t.dow,t.doy)}function LMe(){var t=this.localeData()._week;return Lu(this.weekYear(),t.dow,t.doy)}function KX(t,e,r,n,i){var s;return t==null?gy(this,n,i).year:(s=Lu(t,n,i),e>s&&(e=s),$Me.call(this,t,e,r,n,i))}function $Me(t,e,r,n,i){var s=TX(t,e,r,n,i),o=dy(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Je("Q",0,"Qo","quarter");$e("Q",pX);fr("Q",function(t,e){e[Eu]=(At(t)-1)*3});function BMe(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Je("D",["DD",2],"Do","date");$e("D",Ir,jp);$e("DD",Ir,co);$e("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});fr(["D","DD"],_l);fr("Do",function(t,e){e[_l]=At(t.match(Ir)[0])});var XX=Up("Date",!0);Je("DDD",["DDDD",3],"DDDo","dayOfYear");$e("DDD",mR);$e("DDDD",vX);fr(["DDD","DDDD"],function(t,e,r){r._dayOfYear=At(t)});function VMe(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Je("m",["mm",2],0,"minute");$e("m",Ir,lF);$e("mm",Ir,co);fr(["m","mm"],ka);var WMe=Up("Minutes",!1);Je("s",["ss",2],0,"second");$e("s",Ir,lF);$e("ss",Ir,co);fr(["s","ss"],Ru);var jMe=Up("Seconds",!1);Je("S",0,0,function(){return~~(this.millisecond()/100)});Je(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Je(0,["SSS",3],0,"millisecond");Je(0,["SSSS",4],0,function(){return this.millisecond()*10});Je(0,["SSSSS",5],0,function(){return this.millisecond()*100});Je(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Je(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Je(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Je(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});$e("S",mR,pX);$e("SS",mR,co);$e("SSS",mR,vX);var nh,qX;for(nh="SSSS";nh.length<=9;nh+="S")$e(nh,Wp);function UMe(t,e){e[Xf]=At(("0."+t)*1e3)}for(nh="S";nh.length<=9;nh+="S")fr(nh,UMe);qX=Up("Milliseconds",!1);Je("z",0,0,"zoneAbbr");Je("zz",0,0,"zoneName");function zMe(){return this._isUTC?"UTC":""}function GMe(){return this._isUTC?"Coordinated Universal Time":""}var Pe=g1.prototype;Pe.add=LOe;Pe.calendar=zOe;Pe.clone=GOe;Pe.diff=ZOe;Pe.endOf=uMe;Pe.format=nMe;Pe.from=iMe;Pe.fromNow=sMe;Pe.to=oMe;Pe.toNow=aMe;Pe.get=rIe;Pe.invalidAt=wMe;Pe.isAfter=YOe;Pe.isBefore=KOe;Pe.isBetween=XOe;Pe.isSame=qOe;Pe.isSameOrAfter=JOe;Pe.isSameOrBefore=QOe;Pe.isValid=pMe;Pe.lang=jX;Pe.locale=WX;Pe.localeData=UX;Pe.max=pOe;Pe.min=mOe;Pe.parsingFlags=vMe;Pe.set=nIe;Pe.startOf=lMe;Pe.subtract=$Oe;Pe.toArray=dMe;Pe.toObject=gMe;Pe.toDate=fMe;Pe.toISOString=tMe;Pe.inspect=rMe;typeof Symbol<"u"&&Symbol.for!=null&&(Pe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Pe.toJSON=mMe;Pe.toString=eMe;Pe.unix=hMe;Pe.valueOf=cMe;Pe.creationData=yMe;Pe.eraName=bMe;Pe.eraNarrow=_Me;Pe.eraAbbr=EMe;Pe.eraYear=RMe;Pe.year=CX;Pe.isLeapYear=tIe;Pe.weekYear=MMe;Pe.isoWeekYear=NMe;Pe.quarter=Pe.quarters=BMe;Pe.month=EX;Pe.daysInMonth=fIe;Pe.week=Pe.weeks=CIe;Pe.isoWeek=Pe.isoWeeks=SIe;Pe.weeksInYear=HMe;Pe.weeksInWeekYear=LMe;Pe.isoWeeksInYear=DMe;Pe.isoWeeksInISOWeekYear=FMe;Pe.date=XX;Pe.day=Pe.days=NIe;Pe.weekday=DIe;Pe.isoWeekday=FIe;Pe.dayOfYear=VMe;Pe.hour=Pe.hours=jIe;Pe.minute=Pe.minutes=WMe;Pe.second=Pe.seconds=jMe;Pe.millisecond=Pe.milliseconds=qX;Pe.utcOffset=EOe;Pe.utc=TOe;Pe.local=kOe;Pe.parseZone=POe;Pe.hasAlignedHourOffset=AOe;Pe.isDST=IOe;Pe.isLocal=MOe;Pe.isUtcOffset=NOe;Pe.isUtc=LX;Pe.isUTC=LX;Pe.zoneAbbr=zMe;Pe.zoneName=GMe;Pe.dates=qo("dates accessor is deprecated. Use date instead.",XX);Pe.months=qo("months accessor is deprecated. Use month instead",EX);Pe.years=qo("years accessor is deprecated. Use year instead",CX);Pe.zone=qo("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ROe);Pe.isDSTShifted=qo("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",OOe);function YMe(t){return Ar(t*1e3)}function KMe(){return Ar.apply(null,arguments).parseZone()}function JX(t){return t}var Kt=nF.prototype;Kt.calendar=MAe;Kt.longDateFormat=HAe;Kt.invalidDate=$Ae;Kt.ordinal=WAe;Kt.preparse=JX;Kt.postformat=JX;Kt.relativeTime=UAe;Kt.pastFuture=zAe;Kt.set=IAe;Kt.eras=CMe;Kt.erasParse=SMe;Kt.erasConvertYear=xMe;Kt.erasAbbrRegex=kMe;Kt.erasNameRegex=TMe;Kt.erasNarrowRegex=PMe;Kt.months=lIe;Kt.monthsShort=uIe;Kt.monthsParse=hIe;Kt.monthsRegex=gIe;Kt.monthsShortRegex=dIe;Kt.week=pIe;Kt.firstDayOfYear=yIe;Kt.firstDayOfWeek=wIe;Kt.weekdays=PIe;Kt.weekdaysMin=IIe;Kt.weekdaysShort=AIe;Kt.weekdaysParse=MIe;Kt.weekdaysRegex=HIe;Kt.weekdaysShortRegex=LIe;Kt.weekdaysMinRegex=$Ie;Kt.isPM=VIe;Kt.meridiem=UIe;function d_(t,e,r,n){var i=sc(),s=Ul().set(n,e);return i[r](s,t)}function QX(t,e,r){if(Yu(t)&&(e=t,t=void 0),t=t||"",e!=null)return d_(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=d_(t,n,r,"month");return i}function SF(t,e,r,n){typeof t=="boolean"?(Yu(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Yu(e)&&(r=e,e=void 0),e=e||"");var i=sc(),s=t?i._week.dow:0,o,a=[];if(r!=null)return d_(e,(r+s)%7,n,"day");for(o=0;o<7;o++)a[o]=d_(e,(o+s)%7,n,"day");return a}function XMe(t,e){return QX(t,e,"months")}function qMe(t,e){return QX(t,e,"monthsShort")}function JMe(t,e,r){return SF(t,e,r,"weekdays")}function QMe(t,e,r){return SF(t,e,r,"weekdaysShort")}function ZMe(t,e,r){return SF(t,e,r,"weekdaysMin")}wh("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=At(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});_e.lang=qo("moment.lang is deprecated. Use moment.locale instead.",wh);_e.langData=qo("moment.langData is deprecated. Use moment.localeData instead.",sc);var Kl=Math.abs;function e2e(){var t=this._data;return this._milliseconds=Kl(this._milliseconds),this._days=Kl(this._days),this._months=Kl(this._months),t.milliseconds=Kl(t.milliseconds),t.seconds=Kl(t.seconds),t.minutes=Kl(t.minutes),t.hours=Kl(t.hours),t.months=Kl(t.months),t.years=Kl(t.years),this}function ZX(t,e,r,n){var i=Wa(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function t2e(t,e){return ZX(this,t,e,1)}function r2e(t,e){return ZX(this,t,e,-1)}function wW(t){return t<0?Math.floor(t):Math.ceil(t)}function n2e(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,o,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=wW(bM(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Do(t/1e3),n.seconds=i%60,s=Do(i/60),n.minutes=s%60,o=Do(s/60),n.hours=o%24,e+=Do(o/24),l=Do(eq(e)),r+=l,e-=wW(bM(l)),a=Do(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function eq(t){return t*4800/146097}function bM(t){return t*146097/4800}function i2e(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Jo(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+eq(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(bM(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function oc(t){return function(){return this.as(t)}}var tq=oc("ms"),s2e=oc("s"),o2e=oc("m"),a2e=oc("h"),l2e=oc("d"),u2e=oc("w"),c2e=oc("M"),h2e=oc("Q"),f2e=oc("y"),d2e=tq;function g2e(){return Wa(this)}function m2e(t){return t=Jo(t),this.isValid()?this[t+"s"]():NaN}function rg(t){return function(){return this.isValid()?this._data[t]:NaN}}var p2e=rg("milliseconds"),v2e=rg("seconds"),w2e=rg("minutes"),y2e=rg("hours"),C2e=rg("days"),S2e=rg("months"),x2e=rg("years");function b2e(){return Do(this.days()/7)}var gu=Math.round,Pm={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function _2e(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function E2e(t,e,r,n){var i=Wa(t).abs(),s=gu(i.as("s")),o=gu(i.as("m")),a=gu(i.as("h")),l=gu(i.as("d")),u=gu(i.as("M")),c=gu(i.as("w")),h=gu(i.as("y")),f=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(f=f||c<=1&&["w"]||c<r.w&&["ww",c]),f=f||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=n,_2e.apply(null,f)}function R2e(t){return t===void 0?gu:typeof t=="function"?(gu=t,!0):!1}function T2e(t,e){return Pm[t]===void 0?!1:e===void 0?Pm[t]:(Pm[t]=e,t==="s"&&(Pm.ss=e-1),!0)}function k2e(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Pm,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Pm,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=E2e(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var qk=Math.abs;function dg(t){return(t>0)-(t<0)||+t}function bR(){if(!this.isValid())return this.localeData().invalidDate();var t=qk(this._milliseconds)/1e3,e=qk(this._days),r=qk(this._months),n,i,s,o,a=this.asSeconds(),l,u,c,h;return a?(n=Do(t/60),i=Do(n/60),t%=60,n%=60,s=Do(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=dg(this._months)!==dg(a)?"-":"",c=dg(this._days)!==dg(a)?"-":"",h=dg(this._milliseconds)!==dg(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+o+"S":"")):"P0D"}var Lt=SR.prototype;Lt.isValid=SOe;Lt.abs=e2e;Lt.add=t2e;Lt.subtract=r2e;Lt.as=i2e;Lt.asMilliseconds=tq;Lt.asSeconds=s2e;Lt.asMinutes=o2e;Lt.asHours=a2e;Lt.asDays=l2e;Lt.asWeeks=u2e;Lt.asMonths=c2e;Lt.asQuarters=h2e;Lt.asYears=f2e;Lt.valueOf=d2e;Lt._bubble=n2e;Lt.clone=g2e;Lt.get=m2e;Lt.milliseconds=p2e;Lt.seconds=v2e;Lt.minutes=w2e;Lt.hours=y2e;Lt.days=C2e;Lt.weeks=b2e;Lt.months=S2e;Lt.years=x2e;Lt.humanize=k2e;Lt.toISOString=bR;Lt.toString=bR;Lt.toJSON=bR;Lt.locale=WX;Lt.localeData=UX;Lt.toIsoString=qo("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",bR);Lt.lang=jX;Je("X",0,0,"unix");Je("x",0,0,"valueOf");$e("x",vR);$e("X",XAe);fr("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});fr("x",function(t,e,r){r._d=new Date(At(t))});//! moment.js
_e.version="2.30.1";PAe(Ar);_e.fn=Pe;_e.min=vOe;_e.max=wOe;_e.now=yOe;_e.utc=Ul;_e.unix=YMe;_e.months=XMe;_e.isDate=d1;_e.locale=wh;_e.invalid=dR;_e.duration=Wa;_e.isMoment=Ha;_e.weekdays=JMe;_e.parseZone=KMe;_e.localeData=sc;_e.isDuration=Bx;_e.monthsShort=qMe;_e.weekdaysMin=ZMe;_e.defineLocale=dF;_e.updateLocale=KIe;_e.locales=XIe;_e.weekdaysShort=QMe;_e.normalizeUnits=Jo;_e.relativeTimeRounding=R2e;_e.relativeTimeThreshold=T2e;_e.calendarFormat=UOe;_e.prototype=Pe;_e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function P2e(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function yW(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Wx(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function Ms(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Ad(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function Pt(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function Z(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function A2e(t){const e=[];return Z(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function CW(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return Z(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function SW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Jt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Ms(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return s+l+u},"").trim()}function Fr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Le(t){return typeof t<"u"}function Dr(t){return typeof t>"u"}function an(t){return t===null||t===""||Dr(t)}function I2e(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ev="length",ew=t=>parseInt(t,16),xW=t=>parseInt(t,10),g_=(t,e,r)=>t.substr(e,r),tw=t=>t.codePointAt(0)-65,_M=t=>`${t}`.replace(/\-/g,""),O2e=t=>ew(g_(_M(t),ew("12"),tw("F")))/(ew(g_(_M(t),tw("B"),~~![][Ev]))||9),M2e=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let bW=!1;const _W={invalid:()=>Jt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Jt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Jt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},EW={invalid:()=>Jt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Jt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Jt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function N2e(t,e){const r=!an(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let s,o="invalid",a="invalid";t=_M(t||"");const l=D2e(t);if(r||n||l)if(l){const u=_e("10/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=O2e(t);s=_e((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(M2e()&&(o="valid",a="valid"),!bW&&o!=="valid"&&(_W[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](_W[o]({keyValidityDate:s,hotVersion:i})),bW=!0),a!=="valid"&&e&&EW[a]({keyValidityDate:s,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=EW[a]({keyValidityDate:s,hotVersion:i}),e.appendChild(c)}}function D2e(t){let e=[][Ev],r=e;if(t[Ev]!==tw("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=tw(i.shift());s;s=tw(i.shift()||"A"))--s<""[Ev]?r=r|(xW(`${xW(ew(n)+(ew(g_(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=g_(t,s,s?i[Ev]===1?9:8:6);return r===e}function La(t){return t[0].toUpperCase()+t.substr(1)}function rq(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function nq(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function iq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function RW(t){return xF(`${t}`,{ALLOWED_TAGS:[]})}function xF(t,e){return kAe.sanitize(t,e)}const Vh=t=>["tabindex",t],F2e=()=>["role","treegrid"],Tu=()=>["role","presentation"],H2e=()=>["role","gridcell"],L2e=()=>["role","gridcell button"],$2e=()=>["role","rowheader"],sq=()=>["role","rowgroup"],B2e=()=>["role","columnheader"],oq=()=>["role","row"],V2e=()=>["role","menu"],W2e=()=>["role","menuitem"],j2e=()=>["role","menuitemcheckbox"],U2e=()=>["role","combobox"],aq=()=>["role","listbox"],z2e=()=>["role","option"],G2e=()=>["role","checkbox"],Y2e=()=>["scope","col"],K2e=()=>["scope","row"],X2e=()=>["type","text"],mp=t=>["aria-label",t],ng=()=>["aria-hidden","true"],q2e=()=>["aria-disabled","true"],J2e=()=>["aria-multiselectable","true"],lq=t=>["aria-haspopup",t],uq=t=>["aria-rowcount",t],_R=t=>["aria-colcount",t],cq=t=>["aria-rowindex",t],bF=t=>["aria-colindex",t],Wo=t=>["aria-expanded",t],Q2e=t=>["aria-sort",t],TW=()=>["aria-readonly","true"],kW=()=>["aria-invalid","true"],hq=t=>["aria-checked",t],_F=()=>["aria-selected","true"],Z2e=()=>["aria-autocomplete","list"],eNe=t=>["aria-controls",t],tNe=t=>["aria-activedescendant",t],rNe=t=>["aria-live",t],nNe=t=>["aria-relevant",t],iNe=t=>["aria-setsize",t],sNe=t=>["aria-posinset",t];var oNe=wn,PW=pK,aNe=Nn,AW=qd,lNe=fR,IW=oNe([].push),uNe=function(t){if(aNe(t))return t;if(PW(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?IW(r,i):(typeof i=="number"||AW(i)==="Number"||AW(i)==="String")&&IW(r,lNe(i))}var s=r.length,o=!0;return function(a,l){if(o)return o=!1,l;if(PW(this))return l;for(var u=0;u<s;u++)if(r[u]===a)return l}}},cNe=wr,fq=Hp,dq=c1,hNe=Mn,v1=wn,gq=On,OW=Nn,MW=ND,mq=QD,fNe=uNe,dNe=MD,gNe=String,yh=fq("JSON","stringify"),IC=v1(/./.exec),NW=v1("".charAt),mNe=v1("".charCodeAt),pNe=v1("".replace),vNe=v1(1.1.toString),wNe=/[\uD800-\uDFFF]/g,DW=/^[\uD800-\uDBFF]$/,FW=/^[\uDC00-\uDFFF]$/,HW=!dNe||gq(function(){var t=fq("Symbol")("stringify detection");return yh([t])!=="[null]"||yh({a:t})!=="{}"||yh(Object(t))!=="{}"}),LW=gq(function(){return yh("\uDF06\uD834")!=='"\\udf06\\ud834"'||yh("\uDEAD")!=='"\\udead"'}),yNe=function(t,e){var r=mq(arguments),n=fNe(e);if(!(!OW(n)&&(t===void 0||MW(t))))return r[1]=function(i,s){if(OW(n)&&(s=hNe(n,this,gNe(i),s)),!MW(s))return s},dq(yh,null,r)},CNe=function(t,e,r){var n=NW(r,e-1),i=NW(r,e+1);return IC(DW,t)&&!IC(FW,i)||IC(FW,t)&&!IC(DW,n)?"\\u"+vNe(mNe(t,0),16):t};yh&&cNe({target:"JSON",stat:!0,arity:3,forced:HW||LW},{stringify:function(e,r,n){var i=mq(arguments),s=dq(HW?yNe:yh,null,i);return LW&&typeof s=="string"?pNe(s,wNe,CNe):s}});function py(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ct(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=py(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[py(r[0])]:e[n]=[]:e[n]=null)})),e}function SNe(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function In(t,e,r){const n=Array.isArray(r);return Ct(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function ER(t,e){Ct(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),ER(t[n],e[n])):t[n]=e[n]})}function rs(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ll(t){const e={};return Ct(t,(r,n)=>{e[n]=r}),e}function ur(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Z(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Ct(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(c,h){const f=`_${c}`,d=g=>{let m=g;return(Array.isArray(m)||yt(m))&&(m=rs(m)),m};return function(){return this[f]===void 0&&(this[f]=d(h)),this[f]}},l=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function EF(t,e){return JSON.stringify(t)===JSON.stringify(e)}function yt(t){return Object.prototype.toString.call(t)==="[object Object]"}function ac(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Ct(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function xNe(t,e){const r=e.split(".");let n=t;return Ct(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Jk(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==n.length-1?(Pn(i,s)||(i[s]={}),i=i[s]):i[s]=r)})}function RF(t){if(!yt(t))return 0;const e=function(r){let n=0;return yt(r)?Ct(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function Zs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function m_(t){return window.requestAnimationFrame(t)}function p_(t){window.cancelAnimationFrame(t)}function pq(){return"ontouchstart"in window}function bNe(){return typeof window<"u"}let gg;function _Ne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return gg||(typeof Intl=="object"?gg=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?gg=(r,n)=>`${r}`.localeCompare(n):gg=(r,n)=>r===n?0:r>n?-1:1,gg)}const To=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Wh={chrome:To((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:To(t=>/CriOS/.test(t)),edge:To(t=>/Edge/.test(t)),edgeWebKit:To(t=>/EdgiOS/.test(t)),firefox:To(t=>/Firefox/.test(t)),firefoxWebKit:To(t=>/FxiOS/.test(t)),mobile:To(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:To((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},w1={mac:To(t=>/^Mac/.test(t)),win:To(t=>/^Win/.test(t)),linux:To(t=>/^Linux/.test(t)),ios:To(t=>/iPhone|iPad|iPod/i.test(t))};function ENe(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ct(Wh,r=>{let{test:n}=r;return void n(t,e)})}function RNe(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ct(w1,e=>{let{test:r}=e;return void r(t)})}bNe()&&(ENe(),RNe());function vq(){return Wh.chrome.value}function TNe(){return Wh.chromeWebKit.value}function Qk(){return Wh.firefox.value}function kNe(){return Wh.firefoxWebKit.value}function vy(){return Wh.safari.value}function PNe(){return Wh.edge.value}function Al(){return Wh.mobile.value}function wq(){return w1.ios.value}function yq(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&w1.mac.value}function EM(){return w1.win.value}function $W(){return w1.mac.value}function ANe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function jx(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function INe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function pp(t){return INe(t)&&t.parent}function Id(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function OC(t,e,r){const n=[];let i=t;for(;i&&(i=Id(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function ONe(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(s=>e.test(s));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function hd(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function MNe(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Jh(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function Cq(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Sq(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function et(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Se(t,e){typeof e=="string"&&(e=e.split(" ")),e=Cq(e),e.length>0&&t.classList.add(...e)}function qe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=Sq(e,!0);r=Cq(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function Ze(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function zp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=Sq(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function xq(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)xq(e[r])}}function Ku(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const NNe=/(<(.*)>|&(.*);)/;function Gp(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;NNe.test(e)?t.innerHTML=r?xF(e):e:Od(t,e)}function Od(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Ku(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function vp(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return vp(n.host.impl);if(n.host)return vp(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function DNe(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Pi(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function bq(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function TF(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function kF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?bq(e):t.scrollTop}function _q(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?TF(e):t.scrollLeft}function v_(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function FNe(t){return t.scrollHeight-t.clientHeight}function HNe(t){return t.scrollWidth-t.clientWidth}function wy(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return n;n=n.parentNode}return r}function w_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function mn(t){return t.offsetWidth}function An(t){return t.offsetHeight}function rw(t){return t.clientHeight||t.innerHeight}function Eq(t){return t.clientWidth||t.innerWidth}function Rq(t){return t.selectionStart?t.selectionStart:0}function LNe(t){return t.selectionEnd?t.selectionEnd:0}function BW(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function RR(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let Zk;function Tq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return EM()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function $Ne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");vy()&&!Al()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i+Tq(t)}function ei(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Zk===void 0&&(Zk=$Ne(t)),Zk}function kq(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function Pq(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function PF(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function TR(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Ux(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Aq(t){return Ux(t)&&t.hasAttribute("data-hot-input")===!1}function Iq(t){return!t.parentNode}function BNe(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Oq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();Ze(t,"contenteditable",!0),r&&Ze(t,...ng()),e&&Se(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function Mq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&qe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function VNe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Oq(t,r),e(),Mq(t,r)}function $u(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Zt(t){return typeof t=="function"}function kR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function Nq(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function WNe(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=n.concat(o);let u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function RM(t,e,r,n,i,s,o,a){return Le(a)?t.call(e,r,n,i,s,o,a):Le(o)?t.call(e,r,n,i,s,o):Le(s)?t.call(e,r,n,i,s):Le(i)?t.call(e,r,n,i):Le(n)?t.call(e,r,n):Le(r)?t.call(e,r):t.call(e)}const Ke={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Qk()?182:174,AUDIO_MUTE:Qk()?181:173,AUDIO_UP:Qk()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},jNe=[Ke.ALT,Ke.ARROW_DOWN,Ke.ARROW_LEFT,Ke.ARROW_RIGHT,Ke.ARROW_UP,Ke.AUDIO_DOWN,Ke.AUDIO_MUTE,Ke.AUDIO_UP,Ke.BACKSPACE,Ke.CAPS_LOCK,Ke.DELETE,Ke.END,Ke.ENTER,Ke.ESCAPE,Ke.F1,Ke.F2,Ke.F3,Ke.F4,Ke.F5,Ke.F6,Ke.F7,Ke.F8,Ke.F9,Ke.F10,Ke.F11,Ke.F12,Ke.F13,Ke.F14,Ke.F15,Ke.F16,Ke.F17,Ke.F18,Ke.F19,Ke.HOME,Ke.INSERT,Ke.MEDIA_NEXT,Ke.MEDIA_PLAY_PAUSE,Ke.MEDIA_PREV,Ke.MEDIA_STOP,Ke.NULL,Ke.NUM_LOCK,Ke.PAGE_DOWN,Ke.PAGE_UP,Ke.PAUSE,Ke.SCROLL_LOCK,Ke.SHIFT,Ke.TAB];function UNe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Dq(t){return jNe.includes(t)}function zNe(t){return[Ke.CONTROL,Ke.COMMAND_LEFT,Ke.COMMAND_RIGHT,Ke.COMMAND_FIREFOX].includes(t)}function y1(t,e){const r=e.split("|");let n=!1;return Z(r,i=>{if(t===Ke[i])return n=!0,!1}),n}function ja(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Wf(t){return t.isImmediatePropagationEnabled===!1}function Md(t){return t.button===2}function AF(t){return t.button===0}function GNe(t){return t instanceof TouchEvent}function YNe(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!$u(e)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}function Ut(){Le(console)&&console.warn(...arguments)}function IF(){Le(console)&&console.error(...arguments)}const jf=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],eP=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),tP=new Map([[]]);var KNe=Bp,XNe=function(t,e,r){for(var n=0,i=arguments.length>2?r:KNe(e),s=new t(i);i>n;)s[n]=e[n++];return s},qNe=vn,JNe=function(t,e){var r=qNe[t],n=r&&r.prototype;return n&&n[e]},QNe=Va,ZNe=FK,eDe=ic.f,TM=QNe("unscopables"),kM=Array.prototype;kM[TM]===void 0&&eDe(kM,TM,{configurable:!0,value:ZNe(null)});var PR=function(t){kM[TM][t]=!0},tDe=wr,rDe=wn,nDe=Is,iDe=s1,sDe=XNe,oDe=JNe,aDe=PR,lDe=Array,uDe=rDe(oDe("Array","sort"));tDe({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&nDe(e);var r=iDe(this),n=sDe(lDe,r);return uDe(n,e)}});aDe("toSorted");var cDe=wr,hDe=Mn,fDe=Vp,dDe=Is,gDe=Dn,mDe=jl,pDe=Os,vDe=Bh,rP=vDe("find",TypeError);cDe({target:"Iterator",proto:!0,real:!0,forced:rP},{find:function(e){gDe(this);try{dDe(e)}catch(i){pDe(this,"throw",i)}if(rP)return hDe(rP,this,e);var r=mDe(this),n=0;return fDe(r,function(i,s){if(e(i,n++))return s(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function wDe(t,e){Fq(t,e),e.add(t)}function nP(t,e,r){Fq(t,e),e.set(t,r)}function Fq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VW(t,e,r){return t.set(y_(t,e),r),r}function ii(t,e){return t.get(y_(t,e))}function y_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const yDe=100;var Hs=new WeakMap,rm=new WeakMap,iP=new WeakMap,sP=new WeakSet;class WW{constructor(){wDe(this,sP),nP(this,Hs,new Map),nP(this,rm,new Map),nP(this,iP,new Set),jf.forEach(e=>y_(sP,this,jW).call(this,e))}getHooks(e){var r;return(r=ii(Hs,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ii(Hs,this).has(e)||(y_(sP,this,jW).call(this,e),jf.push(e));const i=ii(Hs,this).get(e);if(i.find(u=>u.callback===r))return;const s=Number.isInteger(n.orderIndex)?n.orderIndex:0,o=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let u=ii(iP,this).has(e);!u&&s!==0&&(u=!0,ii(iP,this).add(e)),u&&i.length>1&&ii(Hs,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return ii(Hs,this).has(e)&&ii(Hs,this).get(e).length>0}remove(e,r){if(!ii(Hs,this).has(e))return!1;const n=ii(Hs,this).get(e),i=n.find(s=>s.callback===r);if(i){let s=ii(rm,this).get(e);return i.skip=!0,s+=1,s>yDe&&(ii(Hs,this).set(e,n.filter(o=>!o.skip)),s=0),ii(rm,this).set(e,s),!0}return!1}destroy(){ii(Hs,this).clear(),ii(rm,this).clear(),VW(Hs,this,null),VW(rm,this,null)}}function jW(t){ii(Hs,this).set(t,[]),ii(rm,this).set(t,0)}function CDe(t,e,r){return(e=SDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SDe(t){var e=xDe(t,"string");return typeof e=="symbol"?e:e+""}function xDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bDe=Jt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Fe{constructor(){CDe(this,"globalBucket",new WW)}static getSingleton(){return EDe()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new WW),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Z(r,s=>this.add(e,s,n)):(eP.has(e)&&Ut(iq(bDe,{hookName:e,removedInVersion:eP.get(e)})),tP.has(e)&&Ut(tP.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Z(r,s=>this.once(e,s,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?Z(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,s,o,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=RM(u[h].callback,e,n,i,s,o,a,l);f!==void 0&&(n=f),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=RM(u[h].callback,e,n,i,s,o,a,l);f!==void 0&&(n=f),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||jf.push(e)}deregister(e){this.isRegistered(e)&&jf.splice(jf.indexOf(e),1)}isDeprecated(e){return tP.has(e)||eP.has(e)}isRegistered(e){return jf.indexOf(e)>=0}getRegistered(){return jf}}const _De=new Fe;function EDe(){return _De}const qf=new Map;function Qo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";qf.has(t)||qf.set(t,new Map);const e=qf.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){qf.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o,clear:a}}function RDe(t,e){var r;return qf==null||(r=qf.get(t.guid))===null||r===void 0?void 0:r.get(e)}const PM=new WeakMap,{register:TDe,getItem:Hq,hasItem:Lq,getNames:ert,getValues:trt}=Qo("editors");function kDe(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},Fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function $q(t,e){let r;if(typeof t=="function")PM.get(t)||$s(null,t),r=PM.get(t);else if(typeof t=="string")r=Hq(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function AM(t){if(typeof t=="function")return t;if(!Lq(t))throw Error(`No registered editor found under "${t}" name`);return Hq(t).getConstructor()}function $s(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new kDe(e);typeof t=="string"&&TDe(t,r),PM.set(e,r)}function PDe(t,e,r){return(e=ADe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ADe(t){var e=IDe(t,"string");return typeof e=="symbol"?e:e+""}function IDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $a{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;PDe(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,ODe(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function ODe(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ja(this)},t}function MDe(t,e){NDe(t,e),e.add(t)}function NDe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qh(t,e,r){return(e=DDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DDe(t){var e=FDe(t,"string");return typeof e=="symbol"?e:e+""}function FDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var MC=new WeakSet;class IM{constructor(e,r,n){MDe(this,MC),Qh(this,"hot",void 0),Qh(this,"tableMeta",void 0),Qh(this,"selection",void 0),Qh(this,"eventManager",void 0),Qh(this,"destroyed",!1),Qh(this,"activeEditor",void 0),Qh(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new $a(e),this.hot.addHook("afterDocumentKeyDown",i=>oP(MC,this,UW).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>oP(MC,this,UW).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>oP(MC,this,HDe).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let o=n,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=$q(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function UW(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Wf(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Dq(r)&&!zNe(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function HDe(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const zW=new WeakMap;IM.getInstance=function(t,e,r){let n=zW.get(t);return n||(n=new IM(t,e,r),zW.set(t,n)),n};function LDe(t,e){Bq(t,e),e.add(t)}function C0(t,e,r){Bq(t,e),e.set(t,r)}function Bq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yr(t,e){return t.get(yu(t,e))}function S0(t,e,r){return t.set(yu(t,e),r),r}function yu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Xm=Object.freeze({CELL:"cell",MIXED:"mixed"});var Tn=new WeakMap,NC=new WeakMap,DC=new WeakMap,FC=new WeakMap,HC=new WeakMap,Lc=new WeakSet;class $De{constructor(e){var r=this;LDe(this,Lc),C0(this,Tn,void 0),C0(this,NC,void 0),C0(this,DC,1),C0(this,FC,null),C0(this,HC,new Map);const n=e.getSettings();S0(Tn,this,e),S0(NC,this,n.imeFastEdit?Xm.MIXED:Xm.CELL),yr(Tn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return yu(Lc,r,VDe).call(r,...s)}),yr(Tn,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return yu(Lc,r,GW).call(r,...s)}),yr(Tn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return yu(Lc,r,GW).call(r,...s)}),yr(Tn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return yu(Lc,r,BDe).call(r,...s)})}getFocusMode(){return yr(NC,this)}setFocusMode(e){Object.values(Xm).includes(e)?S0(NC,this,e):Ut(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return yr(DC,this)}setRefocusDelay(e){S0(DC,this,e)}setRefocusElementGetter(e){S0(FC,this,e)}getRefocusElement(){var e;return typeof yr(FC,this)=="function"?yr(FC,this).call(this):(e=yr(Tn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const o=(i=yr(Tn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=yr(Tn,this).runHooks("modifyFocusedElement",o.row,o.col,n);$u(a)||(a=n),a&&!((s=yr(Tn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):yu(Lc,this,OF).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yr(DC,this);if(yr(Tn,this).getSettings().imeFastEdit&&!((e=yr(Tn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=yr(Tn,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),yr(HC,this).has(r)||yr(HC,this).set(r,kR(()=>{if(!yr(Tn,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},r)),yr(HC,this).get(r)()}}}function OF(t){var e;const r=(e=yr(Tn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!yr(Tn,this).selection.isCellVisible(r)){t(null);return}const n=yr(Tn,this).getCell(r.row,r.col,!0);n===null?yr(Tn,this).addHookOnce("afterScroll",()=>{t(yr(Tn,this).getCell(r.row,r.col,!0))}):t(n)}function GW(){yu(Lc,this,OF).call(this,t=>{const{activeElement:e}=yr(Tn,this).rootDocument;e&&Aq(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function BDe(){yu(Lc,this,OF).call(this,t=>{this.getFocusMode()===Xm.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function VDe(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Xm.MIXED:Xm.CELL)}var WDe=Ko,jDe=qd,UDe=Va,zDe=UDe("match"),GDe=function(t){var e;return WDe(t)&&((e=t[zDe])!==void 0?!!e:jDe(t)==="RegExp")},YDe=vn,KDe=On,YW=YDe.RegExp,XDe=!KDe(function(){var t=!0;try{YW(".","d")}catch{t=!1}var e={},r="",n=t?"dgimsy":"gimsy",i=function(l,u){Object.defineProperty(e,l,{get:function(){return r+=u,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};t&&(s.hasIndices="d");for(var o in s)i(o,s[o]);var a=Object.getOwnPropertyDescriptor(YW.prototype,"flags").get.call(e);return a!==n||r!==n}),qDe={correct:XDe},JDe=Dn,QDe=function(){var t=JDe(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},ZDe=Mn,eFe=Xo,tFe=o1,KW=qDe,rFe=QDe,nFe=RegExp.prototype,iFe=KW.correct?function(t){return t.flags}:function(t){return!KW.correct&&tFe(nFe,t)&&!eFe(t,"flags")?ZDe(rFe,t):t.flags},MF=wn,sFe=Lp,oFe=Math.floor,aP=MF("".charAt),aFe=MF("".replace),lP=MF("".slice),lFe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,uFe=/\$([$&'`]|\d{1,2})/g,cFe=function(t,e,r,n,i,s){var o=r+t.length,a=n.length,l=uFe;return i!==void 0&&(i=sFe(i),l=lFe),aFe(s,l,function(u,c){var h;switch(aP(c,0)){case"$":return"$";case"&":return t;case"`":return lP(e,0,r);case"'":return lP(e,o);case"<":h=i[lP(c,1,-1)];break;default:var f=+c;if(f===0)return u;if(f>a){var d=oFe(f/10);return d===0?u:d<=a?n[d-1]===void 0?aP(c,1):n[d-1]+aP(c,1):u}h=n[f-1]}return h===void 0?"":h})},hFe=wr,fFe=Mn,NF=wn,XW=i1,dFe=Nn,gFe=Ko,mFe=GDe,x0=fR,pFe=a1,vFe=iFe,wFe=cFe,yFe=Va,CFe=yFe("replace"),SFe=TypeError,uP=NF("".indexOf);NF("".replace);var qW=NF("".slice),xFe=Math.max;hFe({target:"String",proto:!0},{replaceAll:function(e,r){var n=XW(this),i,s,o,a,l,u,c,h,f,d,g=0,m="";if(gFe(e)){if(i=mFe(e),i&&(s=x0(XW(vFe(e))),!~uP(s,"g")))throw new SFe("`.replaceAll` does not allow non-global regexes");if(o=pFe(e,CFe),o)return fFe(o,e,n,r)}for(a=x0(n),l=x0(e),u=dFe(r),u||(r=x0(r)),c=l.length,h=xFe(1,c),f=uP(a,l);f!==-1;)d=u?x0(r(l,f,a)):wFe(l,a,f,[],void 0,r),m+=qW(a,g,f)+d,g=f+c,f=f+h>a.length?-1:uP(a,l,f+h);return g<a.length&&(m+=qW(a,g)),m}});var bFe=wr,_Fe=Vp,EFe=Is,RFe=Dn,TFe=jl,kFe=Os,PFe=Bh,AFe=c1,IFe=On,Vq=TypeError,Wq=IFe(function(){[].keys().reduce(function(){},void 0)}),cP=!Wq&&PFe("reduce",Vq);bFe({target:"Iterator",proto:!0,real:!0,forced:Wq||cP},{reduce:function(e){RFe(this);try{EFe(e)}catch(o){kFe(this,"throw",o)}var r=arguments.length<2,n=r?void 0:arguments[1];if(cP)return AFe(cP,this,r?[e]:[e,n]);var i=TFe(this),s=0;if(_Fe(i,function(o){r?(r=!1,n=o):n=e(n,o,s),s++},{IS_RECORD:!0}),r)throw new Vq("Reduce of empty iterator with no initial value");return n}});const jq={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},OFe=new RegExp(Object.keys(jq).map(t=>`(${t})`).join("|"),"gi");function MFe(t){return(t&&t.nodeName||"")==="TABLE"}function JW(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let f=0;f<s;f+=1){const d=e&&f===0,g=[];for(let p=0;p<o;p+=1){const w=!d&&r&&p===0;let v="";if(d)v=`<th>${t.getColHeader(p-c)}</th>`;else if(w)v=`<th>${t.getRowHeader(f-h)}</th>`;else{const y=i[f][p],{hidden:b,rowspan:T,colspan:E}=t.getCellMeta(f-h,p-c);if(!b){const x=[];if(T&&x.push(`rowspan="${T}"`),E&&x.push(`colspan="${E}"`),an(y))v=`<td ${x.join(" ")}></td>`;else{const P=y.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${x.join(" ")}>${P}</td>`}}}g.push(v)}const m=["<tr>",...g,"</tr>"].join("");d?l.splice(1,0,m):u.splice(-1,0,m)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function QW(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,o=[];n===0&&r.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=an(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}r.push("<tr>",...o,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function NFe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const y=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,b=>{const T=b.match(/<td\b[^>]*?>/g)[0],E=/<p.*?>/g,x=b.substring(T.length,b.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(E,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${T}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${y}`),s=i.querySelector("table")}if(!s||!MFe(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((y,b)=>y+b.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let f=!1,d=0,g=0;if(s.tHead){const y=Array.from(s.tHead.rows).filter(b=>{const T=b.querySelector("td")!==null;return T&&h.push(b),!T});d=y.length,f=d>0,d>1?r.nestedHeaders=Array.from(y).reduce((b,T)=>{const E=Array.from(T.cells).reduce((x,P,A)=>{if(a&&A===0)return x;const{colSpan:O,innerHTML:Y}=P,L=O>1?{label:Y,colspan:O}:Y;return x.push(L),x},[]);return b.push(E),b},[]):f&&(r.colHeaders=Array.from(y[0].children).reduce((b,T,E)=>(a&&E===0||b.push(T.innerHTML),b),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const m=[...h,...Array.from(s.tBodies).reduce((y,b)=>(y.push(...Array.from(b.rows)),y),[]),...c];g=m.length;const p=new Array(g);for(let y=0;y<g;y++)p[y]=new Array(u);const w=[],v=[];for(let y=0;y<g;y++){const b=m[y],T=Array.from(b.cells),E=T.length;for(let x=0;x<E;x++){const P=T[x],{nodeName:A,innerHTML:O,rowSpan:Y,colSpan:L}=P,ie=p[y].findIndex(ce=>ce===void 0);if(A==="TD"){if(Y>1||L>1){for(let Ce=y;Ce<y+Y;Ce++)if(Ce<g)for(let ge=ie;ge<ie+L;ge++)p[Ce][ge]=null;const he=P.getAttribute("style");he&&he.includes("mso-ignore:colspan")||w.push({col:ie,row:y,rowspan:Y,colspan:L})}let ce="";o&&/excel/gi.test(o.content)?ce=O.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ce=O.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),p[y][ie]=ce.replace(OFe,he=>jq[he])}else v.push(O)}}return w.length&&(r.mergeCells=w),v.length&&(r.rowHeaders=v),p.length&&(r.data=p),r}function qi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function DFe(t){return qi(t,[","])}function je(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function ZW(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function Uq(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ot(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const OM="asc",FFe="desc",e8=new Map([[OM,[-1,1]],[FFe,[1,-1]]]),HFe=t=>`The priority '${t}' is already declared in a map.`,LFe=t=>`The priority '${t}' is not a number.`;function $Fe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Zt(t)?t:HFe,e=Zt(e)?e:LFe;function n(s,o){if(!qi(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OM;const[o,a]=e8.get(s)||e8.get(OM);return[...r].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:i}}const BFe=t=>`The id '${t}' is already declared in a map.`;function AR(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Zt(t)?t:BFe;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function s(u){const[c]=a().find(h=>{let[f,d]=h;return u===d?f:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:n}}const VFe=t=>`'${t}' value is already declared in a unique set.`;function WFe(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Zt(t)?t:VFe;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const DF=t=>`There is already registered "${t}" plugin.`,jFe=t=>`There is already registered plugin on priority "${t}".`,UFe=t=>`The priority "${t}" is not a number.`,zq=$Fe({errorPriorityExists:jFe,errorPriorityNaN:UFe}),Gq=WFe({errorItemExists:DF}),MM=AR({errorIdExists:DF});function Yq(){return[...zq.getItems(),...Gq.getItems()]}function FF(t){const e=La(t);return MM.getItem(e)}function zFe(t){return!!FF(t)}function Nt(t,e,r){[t,e,r]=YFe(t,e,r),FF(t)===void 0&&GFe(t,e,r)}function GFe(t,e,r){const n=La(t);if(MM.hasItem(n))throw new Error(DF(n));r===void 0?Gq.addItem(n):zq.addItem(r,n),MM.addItem(n,e)}function YFe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:KFe,getItem:XFe,hasItem:Kq,getNames:rrt,getValues:nrt}=Qo("renderers");function NM(t){if(typeof t=="function")return t;if(!Kq(t))throw Error(`No registered renderer found under "${t}" name`);return XFe(t)}function bo(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),KFe(t,e)}const{register:qFe,getItem:JFe,hasItem:Xq,getNames:irt,getValues:srt}=Qo("validators");function QFe(t){if(typeof t=="function")return t;if(!Xq(t))throw Error(`No registered validator found under "${t}" name`);return JFe(t)}function nm(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),qFe(t,e)}var ZFe=wr,eHe=Lp,tHe=Bp,rHe=l1,nHe=PR;ZFe({target:"Array",proto:!0},{at:function(e){var r=eHe(this),n=tHe(r),i=rHe(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:r[s]}});nHe("at");var iHe=wr,sHe=wn,oHe=i1,aHe=l1,lHe=fR,uHe=On,cHe=sHe("".charAt),hHe=uHe(function(){return"𠮷".at(-2)!=="\uD842"});iHe({target:"String",proto:!0,forced:hHe},{at:function(e){var r=lHe(oHe(this)),n=r.length,i=aHe(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:cHe(r,s)}});function b0(t,e,r){return(e=fHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fHe(t){var e=dHe(t,"string");return typeof e=="symbol"?e:e+""}function dHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gHe{constructor(){b0(this,"count",0),b0(this,"startColumn",null),b0(this,"endColumn",null),b0(this,"startPosition",null),b0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=r,a=i>0?s+1:s;n>=i&&n+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i,f=n+i-h,d=this.startColumn===null?0:e.getColumnWidth(this.startColumn);f<-1*s||n>u.at(-1)||-1*n-i>-1*d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _0(t,e,r){return(e=mHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mHe(t){var e=pHe(t,"string");return typeof e=="symbol"?e:e+""}function pHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vHe{constructor(){_0(this,"count",0),_0(this,"startRow",null),_0(this,"endRow",null),_0(this,"startPosition",null),_0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=r;n>=i&&n+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const f=l[this.endRow]+u-l[this.startRow-1];if(f<=i-s&&(this.startRow-=1),f>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function E0(t,e,r){return(e=wHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wHe(t){var e=yHe(t,"string");return typeof e=="symbol"?e:e+""}function yHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qq{constructor(){E0(this,"count",0),E0(this,"startColumn",null),E0(this,"endColumn",null),E0(this,"startPosition",null),E0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const o=i>0?s+1:s;n>=i&&n<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const d=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,d>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i;n+i-h<-1*s||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function R0(t,e,r){return(e=CHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CHe(t){var e=SHe(t,"string");return typeof e=="symbol"?e:e+""}function SHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jq{constructor(){R0(this,"count",0),R0(this,"startRow",null),R0(this,"endRow",null),R0(this,"startPosition",null),R0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function T0(t,e,r){return(e=xHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xHe(t){var e=bHe(t,"string");return typeof e=="symbol"?e:e+""}function bHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _He{constructor(){T0(this,"count",0),T0(this,"startColumn",0),T0(this,"endColumn",0),T0(this,"startPosition",0),T0(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function k0(t,e,r){return(e=EHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EHe(t){var e=RHe(t,"string");return typeof e=="symbol"?e:e+""}function RHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class THe{constructor(){k0(this,"count",0),k0(this,"startRow",0),k0(this,"endRow",0),k0(this,"startPosition",0),k0(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function t8(t,e,r){return(e=kHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kHe(t){var e=PHe(t,"string");return typeof e=="symbol"?e:e+""}function PHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AHe extends qq{constructor(){super(...arguments),t8(this,"columnStartOffset",0),t8(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof n=="function"){const o=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function r8(t,e,r){return(e=IHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IHe(t){var e=OHe(t,"string");return typeof e=="symbol"?e:e+""}function OHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MHe extends Jq{constructor(){super(...arguments),r8(this,"rowStartOffset",0),r8(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof n=="function"){const o=this.startRow,a=this.endRow;n(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function n8(t,e,r){return(e=NHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NHe(t){var e=DHe(t,"string");return typeof e=="symbol"?e:e+""}function DHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qq{constructor(e){n8(this,"calculationTypes",[]),n8(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function na(t,e,r){return(e=FHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FHe(t){var e=HHe(t,"string");return typeof e=="symbol"?e:e+""}function HHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wp=50;class LHe extends Qq{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(r),na(this,"viewportWidth",0),na(this,"scrollOffset",0),na(this,"zeroBasedScrollOffset",0),na(this,"totalColumns",0),na(this,"columnWidthFn",null),na(this,"columnWidth",0),na(this,"overrideFn",null),na(this,"inlineStartOffset",0),na(this,"totalCalculatedWidth",0),na(this,"startPositions",[]),na(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?wp:r}}function go(t,e,r){return(e=$He(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $He(t){var e=BHe(t,"string");return typeof e=="symbol"?e:e+""}function BHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VHe extends Qq{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),go(this,"viewportHeight",0),go(this,"scrollOffset",0),go(this,"zeroBasedScrollOffset",0),go(this,"totalRows",0),go(this,"rowHeightFn",null),go(this,"rowHeight",0),go(this,"overrideFn",null),go(this,"horizontalScrollbarHeight",0),go(this,"innerViewportHeight",0),go(this,"totalCalculatedHeight",0),go(this,"startPositions",[]),go(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function WHe(t,e,r){jHe(t,e),e.set(t,r)}function jHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i8(t,e,r){return(e=UHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UHe(t){var e=zHe(t,"string");return typeof e=="symbol"?e:e+""}function zHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mg(t,e){return t.get(Zq(t,e))}function s8(t,e,r){return t.set(Zq(t,e),r),r}function Zq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xl=new WeakMap;class Nd{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;i8(this,"row",null),i8(this,"col",null),WHe(this,Xl,!1),s8(Xl,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return mg(Xl,this)}isSouthEastOf(e){return this.row>=e.row&&(mg(Xl,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(mg(Xl,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(mg(Xl,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(mg(Xl,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Nd&&s8(Xl,this,e.isRtl()),this}clone(){return new Nd(this.row,this.col,mg(Xl,this))}toObject(){return{row:this.row,col:this.col}}}function GHe(t,e,r){YHe(t,e),e.set(t,r)}function YHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hP(t,e,r){return(e=KHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KHe(t){var e=XHe(t,"string");return typeof e=="symbol"?e:e+""}function XHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mo(t,e){return t.get(eJ(t,e))}function qHe(t,e,r){return t.set(eJ(t,e),r),r}function eJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var os=new WeakMap;class C1{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;hP(this,"highlight",null),hP(this,"from",null),hP(this,"to",null),GHe(this,os,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),qHe(os,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),f=this._createCellCoords(l,u),d=this._createCellCoords(c,h);return this.from=f,this.to=d,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return mo(os,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return mo(os,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return mo(os,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return mo(os,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return mo(os,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return mo(os,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return mo(os,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return mo(os,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Nd))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(mo(os,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(mo(os,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new C1(this.highlight,this.from,this.to,mo(os,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Nd(e,r,mo(os,this))}}function qa(t,e,r){JHe(t,e),e.set(t,r)}function JHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(t,e){return t.get(tJ(t,e))}function pc(t,e,r){return t.set(tJ(t,e),r),r}function tJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var po=new WeakMap,fP=new WeakMap,zn=new WeakMap,pg=new WeakMap,LC=new WeakMap,ia=new WeakMap,dP=new WeakMap,P0=new WeakMap,Zh=new WeakMap,Ja=new WeakMap;let rJ=class{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;qa(this,po,void 0),qa(this,fP,void 0),qa(this,zn,void 0),qa(this,pg,void 0),qa(this,LC,void 0),qa(this,ia,void 0),qa(this,dP,void 0),qa(this,P0,void 0),qa(this,Zh,[null,null]),qa(this,Ja,[null,null]),pc(po,this,n),pc(fP,this,r),pc(zn,this,s),pc(pg,this,o),pc(LC,this,a),pc(ia,this,i),pc(dP,this,e),this.registerEvents()}registerEvents(){Ue(ia,this).addEventListener(Ue(zn,this).holder,"contextmenu",n=>this.onContextMenu(n)),Ue(ia,this).addEventListener(Ue(zn,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Ue(ia,this).addEventListener(Ue(zn,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Ue(ia,this).addEventListener(Ue(zn,this).holder,"touchstart",n=>this.onTouchStart(n)),Ue(ia,this).addEventListener(Ue(zn,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Ue(ia,this).addEventListener(Ue(zn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ue(po,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ue(po,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Ue(ia,this).addEventListener(Ue(zn,this).holder,"mouseup",n=>this.onMouseUp(n)),Ue(ia,this).addEventListener(Ue(zn,this).holder,"mousedown",n=>this.onMouseDown(n))};Al()?e():(pq()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Ue(P0,this)&&n){const[i,s]=[n.row,Ue(P0,this).from.row],[o,a]=[n.col,Ue(P0,this).from.col];return i===s&&o===a}return!1}parentCell(e){const r={},n=Ue(zn,this).TABLE,i=OC(e,["TD","TH"],n);return i?(r.coords=Ue(zn,this).getCoords(i),r.TD=i):et(e,"wtBorder")&&et(e,"current")?(r.coords=Ue(pg,this).getFocusSelection().cellRange.highlight,r.TD=Ue(zn,this).getCell(r.coords)):et(e,"wtBorder")&&et(e,"area")&&Ue(pg,this).getAreaSelection().cellRange&&(r.coords=Ue(pg,this).getAreaSelection().cellRange.to,r.TD=Ue(zn,this).getCell(r.coords)),r}onMouseDown(e){const r=Ue(fP,this).rootDocument.activeElement,n=Nq(ANe,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);et(i,"corner")?Ue(po,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Ue(po,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Ue(Ja,this)[0]=s.TD,clearTimeout(Ue(Zh,this)[0]),Ue(Zh,this)[0]=setTimeout(()=>{Ue(Ja,this)[0]=null},1e3))}onContextMenu(e){if(Ue(po,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Ue(po,this).has("onCellMouseOver"))return;const r=Ue(zn,this).TABLE,n=OC(e.target,["TD","TH"],r),i=Ue(LC,this)||this;n&&n!==i.lastMouseOver&&hd(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Ue(zn,this).getCoords(n),n))}onMouseOut(e){if(!Ue(po,this).has("onCellMouseOut"))return;const r=Ue(zn,this).TABLE,n=OC(e.target,["TD","TH"],r),i=OC(e.relatedTarget,["TD","TH"],r),s=Ue(LC,this)||this;n&&n!==i&&hd(n,r)&&(this.callListener("onCellMouseOut",e,Ue(zn,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&Ue(po,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Ue(Ja,this)[0]&&r.TD===Ue(Ja,this)[1]?(et(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Ue(Ja,this)[0]=null,Ue(Ja,this)[1]=null):r.TD===Ue(Ja,this)[0]&&(Ue(Ja,this)[1]=r.TD,clearTimeout(Ue(Zh,this)[1]),Ue(Zh,this)[1]=setTimeout(()=>{Ue(Ja,this)[1]=null},500)))}onTouchStart(e){pc(P0,this,Ue(pg,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=Le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Ue(po,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];wq()&&(TNe()||kNe())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=Ue(po,this).getSettingPure(e);s&&s(r,n,i,Ue(dP,this).call(this))}destroy(){clearTimeout(Ue(Zh,this)[0]),clearTimeout(Ue(Zh,this)[1]),Ue(ia,this).destroy()}};function gP(t,e,r){return(e=QHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QHe(t){var e=ZHe(t,"string");return typeof e=="symbol"?e:e+""}function ZHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eLe{constructor(e,r,n){gP(this,"offset",void 0),gP(this,"total",void 0),gP(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function mP(t,e,r){return(e=tLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tLe(t){var e=rLe(t,"string");return typeof e=="symbol"?e:e+""}function rLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nLe{constructor(e,r,n){mP(this,"offset",void 0),mP(this,"total",void 0),mP(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function $C(t,e,r){return(e=iLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iLe(t){var e=sLe(t,"string");return typeof e=="symbol"?e:e+""}function sLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oLe{constructor(){$C(this,"currentSize",0),$C(this,"nextSize",0),$C(this,"currentOffset",0),$C(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const aLe=0,o8=1,DM=2;function pP(t,e,r){return(e=lLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lLe(t){var e=uLe(t,"string");return typeof e=="symbol"?e:e+""}function uLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cLe{constructor(){pP(this,"size",new oLe),pP(this,"workingSpace",aLe),pP(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=o8,e.workingSpace=DM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=DM,e.workingSpace=o8,this.sharedSize=e.getViewSize()}}var a8=hR,hLe=TypeError,fLe=function(t,e){if(!delete t[e])throw new hLe("Cannot delete property "+a8(e)+" of "+a8(t))},dLe=wr,gLe=Lp,mLe=Bp,pLe=vK,vLe=fLe,wLe=wK,yLe=[].unshift(0)!==1,CLe=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},SLe=yLe||!CLe();dLe({target:"Array",proto:!0,arity:1,forced:SLe},{unshift:function(e){var r=gLe(this),n=mLe(r),i=arguments.length;if(i){wLe(n+i);for(var s=n;s--;){var o=s+i;s in r?r[o]=r[s]:vLe(r,o)}for(var a=0;a<i;a++)r[a]=arguments[a]}return pLe(r,n+i)}});function xLe(t,e,r){return(e=bLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bLe(t){var e=_Le(t,"string");return typeof e=="symbol"?e:e+""}function _Le(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l8{constructor(e,r){xLe(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function ELe(t,e,r){return(e=RLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RLe(t){var e=TLe(t,"string");return typeof e=="symbol"?e:e+""}function TLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kLe{constructor(e){ELe(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new l8(s,r),l=new l8(o,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),f=l.get(c);if(f===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(DM)?u.push(["append",f]):u.push(["prepend",f]);else if(f>h)a.has(f)&&(a.remove(f),n<=a.length&&(i-=1)),u.push(["replace",f,h]);else if(f<h){const d=a.prepend(f);u.push(["insert_before",f,h,d])}else u.push(["none",f])}return u}}function vg(t,e,r){return(e=PLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PLe(t){var e=ALe(t,"string");return typeof e=="symbol"?e:e+""}function ALe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nJ{constructor(e,r){vg(this,"rootNode",void 0),vg(this,"nodesPool",void 0),vg(this,"sizeSet",new cLe),vg(this,"collectedNodes",[]),vg(this,"viewDiffer",new kLe(this.sizeSet)),vg(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,s,o]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(s)),r.removeChild(this.nodesPool(o));break;case"replace":r.replaceChild(a,this.nodesPool(s));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class iJ extends nJ{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function u8(t,e,r){return(e=ILe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ILe(t){var e=OLe(t,"string");return typeof e=="symbol"?e:e+""}function OLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MLe{constructor(e){u8(this,"nodeType",void 0),u8(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,s),s}}function A0(t,e,r){return(e=NLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NLe(t){var e=DLe(t,"string");return typeof e=="symbol"?e:e+""}function DLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S1{constructor(e,r){A0(this,"nodesPool",null),A0(this,"nodeType",void 0),A0(this,"rootNode",void 0),A0(this,"table",null),A0(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new MLe(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function c8(t,e,r){return(e=FLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FLe(t){var e=HLe(t,"string");return typeof e=="symbol"?e:e+""}function HLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LLe extends S1{constructor(){super("TH"),c8(this,"orderViews",new WeakMap),c8(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new iJ(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),zp(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ze(f,[$2e(),K2e(),bF(h+1),Vh(-1)]),r[h](a,f,h)}u.end()}}}class $Le extends S1{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ku(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ze(this.rootNode,[sq()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Ze(o,[oq(),cq(r+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),zp(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ze(u,[bF(a+1+this.table.rowHeadersCount),Vh(-1),B2e(),...a>=0?[Y2e()]:[L2e(),mp("Select whole grid")]]),n[r](l,u,r)}}}}let h8=!1;class BLe extends S1{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!h8&&e>1e3&&(h8=!0,Ut(Jt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&Se(n,"rowHeader")}}function VLe(t,e,r){return(e=WLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WLe(t){var e=jLe(t,"string");return typeof e=="symbol"?e:e+""}function jLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wg={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let f8=!1;class ULe extends S1{constructor(e){super("TR",e),VLe(this,"orderView",void 0),this.orderView=new nJ(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!f8&&e>1e3&&(f8=!0,Ut(Jt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ze(this.rootNode,[sq()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Ze(s,[oq(),cq(o+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(o+1)%2===0?et(s,wg.rowEven)||(qe(s,wg.rowOdd),Se(s,wg.rowEven)):et(s,wg.rowOdd)||(qe(s,wg.rowEven),Se(s,wg.rowOdd))}this.orderView.end()}}function d8(t,e,r){return(e=zLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zLe(t){var e=GLe(t,"string");return typeof e=="symbol"?e:e+""}function GLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YLe extends S1{constructor(){super("TD"),d8(this,"orderViews",new WeakMap),d8(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new iJ(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let f=0;f<r;f++){c.render();const d=this.table.renderedColumnToSource(f),g=c.getCurrentNode();if(et(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),zp(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,d,g),this.table.isAriaEnabled()){var s,o;Ze(g,[...g.hasAttribute("role")?[]:[H2e()],Vh(-1),bF(d+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}c.end()}}}function bn(t,e,r){return(e=KLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KLe(t){var e=XLe(t,"string");return typeof e=="symbol"?e:e+""}function XLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qLe{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};bn(this,"rootNode",void 0),bn(this,"rootDocument",void 0),bn(this,"rowHeaders",null),bn(this,"columnHeaders",null),bn(this,"colGroup",null),bn(this,"rows",null),bn(this,"cells",null),bn(this,"rowFilter",null),bn(this,"columnFilter",null),bn(this,"rowUtils",null),bn(this,"columnUtils",null),bn(this,"rowsToRender",0),bn(this,"columnsToRender",0),bn(this,"rowHeaderFunctions",[]),bn(this,"rowHeadersCount",0),bn(this,"columnHeaderFunctions",[]),bn(this,"columnHeadersCount",0),bn(this,"cellRenderer",void 0),bn(this,"activeOverlayName",void 0),bn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),s=this.rowUtils;if(i.firstChild){const o=this.renderedRowToSource(n),a=s.getHeightByOverlayName(o,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class JLe{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new qLe(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new LLe,columnHeaders:new $Le(r),colGroup:new BLe(n),rows:new ULe(i),cells:new YLe}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function vP(t,e,r){return(e=QLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QLe(t){var e=ZLe(t,"string");return typeof e=="symbol"?e:e+""}function ZLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e$e{constructor(e,r){vP(this,"dataAccessObject",void 0),vP(this,"wtSettings",void 0),vP(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let o=Array.isArray(r)?r[s]:r;o=o??i,this.headerWidths.set(s,o)}}}}function g8(t,e,r){return(e=t$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t$e(t){var e=r$e(t,"string");return typeof e=="symbol"?e:e+""}function r$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n$e{constructor(e,r){g8(this,"dataAccessObject",void 0),g8(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Qa(t,e,r){return(e=i$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i$e(t){var e=s$e(t,"string");return typeof e=="symbol"?e:e+""}function s$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yp{constructor(e,r,n,i,s){Qa(this,"wtSettings",null),Qa(this,"domBindings",void 0),Qa(this,"TBODY",null),Qa(this,"THEAD",null),Qa(this,"COLGROUP",null),Qa(this,"hasTableHeight",!0),Qa(this,"hasTableWidth",!0),Qa(this,"isTableVisible",!1),Qa(this,"tableOffset",0),Qa(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,xq(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new n$e(this.dataAccessObject,this.wtSettings),this.columnUtils=new e$e(this.dataAccessObject,this.wtSettings),this.tableRenderer=new JLe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!et(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ze(n,[Tu()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!et(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ze(n,[Tu()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!et(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Ze(n,[Vh(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ze(n.parentNode,[Tu()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ze(n,[Tu()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Pi(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const d=n.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=d!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Pi(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const d=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new nLe(d,s,c),this.columnFilter=new eLe(g,o,l);let m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const p={};this.wtSettings.getSetting("beforeDraw",!0,p),m=p.skipRender!==!0}m&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(El)||this.is(Ch))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(El))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(El)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let f=!1;return this.isMaster&&(f=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(f=n.bottomOverlay.resetFixedPosition()||f),f=n.inlineStartOverlay.resetFixedPosition()||f,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=rw(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(El))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=Id(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let s=MNe(n),o=r.cellIndex;Jh(Hd,r,this.wtRootElement)||Jh(Dd,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Jh(Ch,r,this.wtRootElement)||Jh(El,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),Jh(Hd,r,this.wtRootElement)||Jh(Fd,r,this.wtRootElement)||Jh(Ch,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=rw(this.TBODY)-1,s=r.areCellsBorderBox(),o=s?An:rw,a=s?0:1,l=s?1:0;let u,c,h,f,d;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),f=this.getTrForRow(h),d=f.querySelector("th");const g=h===0?l:0;d?c=o(d):c=o(f)-a,(!u&&r.getDefaultRowHeight()<c-g||u<c)&&(s||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return mn(this.TABLE)}getHeight(){return An(this.TABLE)}getTotalWidth(){const e=mn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=An(this.hider);return e!==0?e:this.getHeight()}isVisible(){return vp(this.TABLE)}_modifyRowHeaderWidth(e){let r=Zt(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const o$e="stickyRowsBottom",HF={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ac(HF,"MIXIN_NAME",o$e,{writable:!1,enumerable:!1});const a$e="stickyColumnsStart",IR={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ac(IR,"MIXIN_NAME",a$e,{writable:!1,enumerable:!1});class LF extends Yp{constructor(e,r,n,i){super(e,r,n,i,Ch)}}ur(LF,HF);ur(LF,IR);const Dd="top",El="bottom",Fd="inline_start",Hd="top_inline_start_corner",Ch="bottom_inline_start_corner",sJ=[Dd,El,Fd,Hd,Ch],l$e=new Map([[Dd,`ht_clone_${Dd}`],[El,`ht_clone_${El}`],[Fd,`ht_clone_${Fd} ht_clone_left`],[Hd,`ht_clone_${Hd} ht_clone_top_left_corner`],[Ch,`ht_clone_${Ch} ht_clone_bottom_left_corner`]]);function u$e(t,e){c$e(t,e),e.add(t)}function c$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h$e(t,e,r){return(e=f$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f$e(t){var e=d$e(t,"string");return typeof e=="symbol"?e:e+""}function d$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BC(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var I0=new WeakSet;class g$e{constructor(e){u$e(this,I0),h$e(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,n);return i||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const s=Zs(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<o)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const s=Zs(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-o-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let f=!1;return(u&&(e<c||e>h)||!u)&&(f=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),f}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return BC(I0,this,p8).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return BC(I0,this,p8).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return BC(I0,this,m8).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return BC(I0,this,m8).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function m8(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-f)}else l=Pi(n.wtRootElement).left;const u=Math.abs(_q(o,o));if(l>u){const c=Eq(o);let h=i.getRowHeaderWidth();for(let f=1;f<=s;f++)if(h+=r.sumCellSizes(f-1,f),l+h-u>=c){t=f-2;break}}}return t}function p8(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=Pi(r.wtRootElement),a=kF(s,s);if(o.top>a){const l=rw(s);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){t=c-2;break}}}return t}function vo(t,e,r){return(e=m$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m$e(t){var e=p$e(t,"string");return typeof e=="symbol"?e:e+""}function p$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $F{get eventManager(){return new $a(this)}constructor(e,r){vo(this,"wtTable",void 0),vo(this,"wtScroll",void 0),vo(this,"wtViewport",void 0),vo(this,"wtOverlays",void 0),vo(this,"selectionManager",void 0),vo(this,"wtEvent",void 0),vo(this,"guid",`wt_${rq()}`),vo(this,"drawInterrupted",!1),vo(this,"drawn",!1),vo(this,"activeOverlayName","master"),vo(this,"domBindings",void 0),vo(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new g$e(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Od(n,e[r])}])}}createCellCoords(e,r){return new Nd(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new C1(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||DNe(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function v8(t,e,r){return(e=v$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v$e(t){var e=w$e(t,"string");return typeof e=="symbol"?e:e+""}function w$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y$e extends $F{constructor(e,r,n){super(e,r),v8(this,"cloneSource",void 0),v8(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new rJ(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function C$e(t,e,r){return(e=S$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S$e(t){var e=x$e(t,"string");return typeof e=="symbol"?e:e+""}function x$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x1{constructor(e,r,n,i,s){C$e(this,"wtSettings",null),ac(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=wy(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=wy(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=v_(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Ut(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+ei())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=o.horizontal-s.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(sJ.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${l$e.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&Ze(s,[Tu()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Dd||u==="vertical"&&this.type===Fd?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=v_(e.TABLE),new y$e(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class b$e extends x1{constructor(e,r,n,i,s,o){super(e,r,Ch,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new LF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else TR(r),this.repositionOverlay();let n=An(this.clone.wtTable.TABLE);const i=mn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=ei(n)),i.style.bottom=`${s}px`}}const _$e="calculatedColumns",OR={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ac(OR,"MIXIN_NAME",_$e,{writable:!1,enumerable:!1});class BF extends Yp{constructor(e,r,n,i){super(e,r,n,i,El)}}ur(BF,HF);ur(BF,OR);function E$e(t,e,r){return(e=R$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R$e(t){var e=T$e(t,"string");return typeof e=="symbol"?e:e+""}function T$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k$e extends x1{constructor(e,r,n,i){super(e,r,El,n,i),E$e(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new BF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=ei(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(TF(r),top),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<r;){const l=n.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=ei(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=An(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=ei(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return kF(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=et(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Se(o,"innerBorderBottom"),s=!a):(qe(o,"innerBorderBottom"),s=a)}return s}}const P$e="calculatedRows",VF={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ac(VF,"MIXIN_NAME",P$e,{writable:!1,enumerable:!1});class WF extends Yp{constructor(e,r,n,i){super(e,r,n,i,Fd)}}ur(WF,VF);ur(WF,IR);const A$e="localHooks",hi={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)RM(this._localHooks[t][l],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};ac(hi,"MIXIN_NAME",A$e,{writable:!1,enumerable:!1});let oJ=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};ur(oJ,hi);const aJ="active-header",jF="header",UF="area",C_="focus",I$e="fill",O$e="row",M$e="column",N$e="custom-selection",zF=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var D$e=PR;D$e("flat");function F$e(t,e){lJ(t,e),e.add(t)}function w8(t,e,r){lJ(t,e),e.set(t,r)}function lJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(t,e){return t.get(nw(t,e))}function y8(t,e,r){return t.set(nw(t,e),r),r}function nw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ca=new WeakMap,wi=new WeakMap,VC=new WeakSet;class H$e{constructor(){F$e(this,VC),w8(this,ca,void 0),w8(this,wi,void 0)}setActiveOverlay(e){return y8(wi,this,e),this}setActiveSelection(e){return y8(ca,this,e),this}scan(){const e=Br(ca,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=Br(ca,this).getCorners(),{wtTable:o}=Br(wi,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<n||h>s)){for(let f=-l;f<0;f++){if(f<r||f>i)continue;const d=f+l;let g=o.getColumnHeader(h,d);const m=Br(wi,this).getSetting("onBeforeHighlightingColumnHeader",h,d,{selectionType:Br(ca,this).settings.selectionType,columnCursor:u,selectionWidth:s-n+1});m!==null&&(m!==h&&(g=o.getColumnHeader(m,d)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=Br(ca,this).getCorners(),{wtTable:o}=Br(wi,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let f=-l;f<0;f++){if(f<n||f>s)continue;const d=f+l;let g=o.getRowHeader(h,d);const m=Br(wi,this).getSetting("onBeforeHighlightingRowHeader",h,d,{selectionType:Br(ca,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});m!==null&&(m!==h&&(g=o.getRowHeader(m,d)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Br(wi,this);nw(VC,this,L$e).call(this,(n,i)=>{const s=r.getCell(Br(wi,this).createCellCoords(n,i)),o=Br(wi,this).getSetting("onAfterDrawSelection",n,i,Br(ca,this).settings.layerLevel);typeof o=="string"&&Se(s,o),e(s)})}scanRowsInCellsRange(e){const[r,,n]=Br(ca,this).getCorners(),{wtTable:i}=Br(wi,this);nw(VC,this,C8).call(this,(s,o)=>{if(s>=r&&s<=n){const a=i.getCell(Br(wi,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Br(ca,this).getCorners(),{wtTable:i}=Br(wi,this);nw(VC,this,C8).call(this,(s,o)=>{if(o>=r&&o<=n){const a=i.getCell(Br(wi,this).createCellCoords(s,o));e(a)}})}}function L$e(t){let[e,r,n,i]=Br(ca,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:s}=Br(wi,this),o=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),o){if(r=Math.max(r,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),i<r||n<e)return}else{const a=s.getCell(Br(wi,this).createCellCoords(e,r));if(!$u(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function C8(t){const{wtTable:e}=Br(wi,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<n;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class S8{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=zF(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ja(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Al()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),s=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Ct(h,(d,g)=>{this.selectionHandles.styles.bottomHitArea[g]=d,this.selectionHandles.styles.topHitArea[g]=d});const f=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${l}`};Ct(f,(d,g)=>{this.selectionHandles.styles.bottom[g]=d,this.selectionHandles.styles.top[g]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,d=parseInt(u.borderWidth,10),g=parseInt(u.width,10),m=parseInt(c.width,10),p=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();u.top=`${parseInt(n-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(n-m/4*3,10)}px`,c[l]=`${parseInt(i-m/4*3,10)}px`;const v=Math.min(parseInt(i+s,10),p-g-d*2),y=Math.min(parseInt(i+s-m/4,10),p-m-d*2);h[l]=`${v}px`,f[l]=`${y}px`;const b=Math.min(parseInt(n+o,10),w-g-d*2),T=Math.min(parseInt(n+o-m/4,10),w-m-d*2);h.top=`${b}px`,f.top=`${T}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,s]=e;if(r<0&&i<0||n<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==s,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=o.getFirstRenderedRow(),f=o.getLastRenderedRow(),d=o.getFirstRenderedColumn(),g=o.getLastRenderedColumn();if(d<0&&g<0||h<0&&f<0){this.disappear();return}let m;if(u){if(n=Math.max(n,d),s=Math.min(s,g),r=Math.max(r,h),i=Math.min(i,f),s<n||i<r){this.disappear();return}m=o.getCell(this.wot.createCellCoords(r,n))}else if(m=o.getCell(this.wot.createCellCoords(r,n)),!$u(m)){this.disappear();return}const p=u?o.getCell(this.wot.createCellCoords(i,s)):m,w=Pi(m),v=u?Pi(p):w,y=Pi(o.TABLE),b=w.top,T=w.left,E=this.wot.wtSettings.getSetting("rtlMode");let x=0,P=0;if(E){const ge=mn(o.TABLE),Q=mn(m),ye=l.innerWidth-y.left-ge;P=T+Q-v.left,x=l.innerWidth-T-Q-ye-1}else P=v.left+mn(p)-T,x=T-y.left-1;if(this.isEntireColumnSelected(r,i)){const ge=r,Q=this.getDimensionsFromHeader("columns",n,s,ge,y);let ye=null;Q&&([ye,x,P]=Q),ye&&(m=ye)}let A=b-y.top-1,O=v.top+An(p)-b;if(this.isEntireRowSelected(n,s)){const ge=n,Q=this.getDimensionsFromHeader("rows",r,i,ge,y);let ye=null;Q&&([ye,A,O]=Q),ye&&(m=ye)}const Y=l.getComputedStyle(m);parseInt(Y.borderTopWidth,10)>0&&(A+=1,O=O>0?O-1:0),parseInt(Y[E?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,P=P>0?P-1:0);const L=E?"right":"left",ie=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${A}px`,this.topStyle[L]=`${x}px`,this.topStyle.width=`${P+ie}px`,this.topStyle.display="block",this.startStyle.top=`${A}px`,this.startStyle[L]=`${x}px`,this.startStyle.height=`${O+ie}px`,this.startStyle.display="block",this.bottomStyle.top=`${A+O-parseInt(this.bottomStyle.height,10)+ie}px`,this.bottomStyle[L]=`${x}px`,this.bottomStyle.width=`${P+ie}px`,this.bottomStyle.display="block",this.endStyle.top=`${A}px`,this.endStyle[L]=`${x+P-parseInt(this.endStyle.width,10)+ie}px`,this.endStyle.height=`${O+ie}px`,this.endStyle.display="block";let ce=this.settings.border.cornerVisible;ce=typeof ce=="function"?ce(this.settings.layerLevel):ce;const he=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[Ee,Ce]=[i,s];if(he&&Array.isArray(he)&&([,,Ee,Ce]=he),Al()||!ce||this.isPartRange(Ee,Ce))this.cornerStyle.display="none";else{this.cornerStyle.top=`${A+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[L]=`${x+P+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ge=wy(o.TABLE);const Q=ge===l;Q&&(ge=a.documentElement);const ye=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Re=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),W=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const C=Q?p.getBoundingClientRect().left:p.offsetLeft;let S=!1,_=0;if(E?(_=C-parseInt(this.cornerDefaultStyle.width,10)/2,S=_<0):(_=C+mn(p)+parseInt(this.cornerDefaultStyle.width,10)/2,S=_>=Eq(ge)),S){const D=Math.floor(x+P+this.cornerCenterPointOffset-Re-ye);c?(this.cornerStyle[L]=`${D}px`,this.cornerStyle[E?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[L]=`${D-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Q?p.getBoundingClientRect().top:p.offsetTop)+An(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=rw(ge)){const D=Math.floor(A+O+this.cornerCenterPointOffset-W-ye);c?(this.cornerStyle.top=`${D}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${D-1}px`}this.cornerStyle.display="block"}Al()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,A,x,P,O)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,f=null,d=null,g=null,m=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return An(...arguments)},c="ht__selection--rows",d="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return mn(...arguments)},c="ht__selection--columns",d="left";break}if(a.classList.contains(c)){const p=this.wot.getSetting("columnHeaders").length;if(g=l(r,p-i),m=l(n,p-i),!g||!m)return!1;const w=Pi(g),v=Pi(m);return g&&m&&(h=w[d]-s[d]-1,f=v[d]+u(m)-w[d]),[g,h,f]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?Se(this[e],"hidden"):(et(this[e],"hidden")&&qe(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Se(this[e],"hidden"):qe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Al()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function $$e(t,e){uJ(t,e),e.add(t)}function yg(t,e,r){uJ(t,e),e.set(t,r)}function uJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(GF(t,e))}function x8(t,e,r){return t.set(GF(t,e),r),r}function GF(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var yi=new WeakMap,ms=new WeakMap,wP=new WeakMap,Rv=new WeakMap,yP=new WeakMap,ef=new WeakMap,b8=new WeakSet;class B$e{constructor(e){$$e(this,b8),yg(this,yi,void 0),yg(this,ms,void 0),yg(this,wP,new H$e),yg(this,Rv,new WeakMap),yg(this,yP,new WeakSet),yg(this,ef,new Map),x8(ms,this,e)}setActiveOverlay(e){return x8(yi,this,e),pt(wP,this).setActiveOverlay(pt(yi,this)),pt(Rv,this).has(pt(yi,this))||pt(Rv,this).set(pt(yi,this),new Set),this}getFocusSelection(){return pt(ms,this)!==null?pt(ms,this).getFocus():null}getAreaSelection(){return pt(ms,this)!==null?pt(ms,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(pt(ef,this).has(e)){const n=pt(ef,this).get(e);if(n.has(pt(yi,this)))return n.get(pt(yi,this));const i=new S8(pt(yi,this),e.settings);return n.set(pt(yi,this),i),i}const r=new S8(pt(yi,this),e.settings);return pt(ef,this).set(e,new Map([[pt(yi,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=pt(ef,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){pt(ef,this).get(e).forEach(r=>r.destroy()),pt(ef,this).delete(e)}render(e){if(pt(ms,this)===null)return;e&&GF(b8,this,V$e).call(this);const r=Array.from(pt(ms,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const o=r[s],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;pt(yP,this).has(o)||(pt(yP,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&pt(wP,this).setActiveSelection(o).scan().forEach(g=>{if(n.has(g)){const m=n.get(g);m.has(a)&&u===!0?m.set(a,m.get(a)+1):m.set(a,1)}else n.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const f=o.getCorners();pt(yi,this).getSetting("onBeforeDrawBorders",f,c),h==null||h.appear(f)}n.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,d)=>`${c}-${d+1}`)]}).flat();l.forEach(u=>pt(Rv,this).get(pt(yi,this)).add(u)),Se(o,l),o.nodeName==="TD"&&Array.isArray((a=pt(ms,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ze(o,pt(ms,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{Ze(s,[...i.get(s)])})}}function V$e(){const t=pt(Rv,this).get(pt(yi,this)),e=pt(yi,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=pt(yi,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((n=pt(ms,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=pt(ms,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=pt(ms,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...pt(ms,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)qe(s[a],r),zp(s[a],o)}),t.clear()}class W$e extends x1{constructor(e,r,n,i){super(e,r,Fd,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new WF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),PF(n,`${s}px`,"0px")):(s=this.getScrollPosition(),TR(n));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const s=r.scrollX;r.scrollTo(e,bq(r)),n=s!==r.scrollX}else if(e!==i.scrollLeft){const s=i.scrollLeft;i.scrollLeft=e,n=s!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=ei(n)),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=mn(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=zF(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!et(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),f=this.wot.wtViewport.getViewportWidth();h>f&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=ei(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,HNe(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(_q(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?qe(n,"emptyRows"):Se(n,"emptyRows");let l=!1;if(!a){if(s&&!i.length)Se(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=et(n,"innerBorderInlineStart");e?(Se(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(qe(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const j$e="stickyRowsTop",YF={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ac(YF,"MIXIN_NAME",j$e,{writable:!1,enumerable:!1});class KF extends Yp{constructor(e,r,n,i){super(e,r,n,i,Hd)}}ur(KF,YF);ur(KF,IR);function _8(t,e,r){return(e=U$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U$e(t){var e=z$e(t,"string");return typeof e=="symbol"?e:e+""}function z$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G$e extends x1{constructor(e,r,n,i,s,o){super(e,r,Hd,n,i),_8(this,"topOverlay",void 0),_8(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new KF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();PF(e,`${i}px`,`${s}px`)}else TR(e);let r=An(this.clone.wtTable.TABLE);const n=mn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class XF extends Yp{constructor(e,r,n,i){super(e,r,n,i,Dd)}}ur(XF,YF);ur(XF,OR);function Y$e(t,e,r){return(e=K$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K$e(t){var e=X$e(t,"string");return typeof e=="symbol"?e:e+""}function X$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q$e extends x1{constructor(e,r,n,i){super(e,r,Dd,n,i),Y$e(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new XF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,i=this.getOverlayOffset(),PF(e,"0px",`${i}px`)}else i=this.getScrollPosition(),TR(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(TF(r),e),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,s=0;for(;i<r;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=ei(n)),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=An(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=zF(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!et(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const f=this.wot.wtTable.getRowHeight(e),d=this.wot.wtViewport.getViewportHeight();f>d&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(h=ei(this.domBindings.rootDocument)),r){const f=i.getSetting("fixedRowsBottom"),d=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(d-f,d),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,FNe(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return kF(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";s?qe(i,"emptyColumns"):Se(i,"emptyColumns");let a=!1;if(!r&&!o){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=et(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(Se(i,"innerBorderTop"),a=!h):(qe(i,"innerBorderTop"),a=h)}}return a}}function WC(t,e,r){J$e(t,e),e.set(t,r)}function J$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ql(t,e,r){return(e=Q$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q$e(t){var e=Z$e(t,"string");return typeof e=="symbol"?e:e+""}function Z$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tf(t,e,r){return t.set(cJ(t,e),r),r}function Jl(t,e){return t.get(cJ(t,e))}function cJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cg=new WeakMap,jC=new WeakMap,Sg=new WeakMap,UC=new WeakMap;class e4e{constructor(e,r,n,i,s,o){ql(this,"wot",null),WC(this,Cg,[]),ql(this,"topOverlay",null),ql(this,"bottomOverlay",null),ql(this,"inlineStartOverlay",null),ql(this,"topInlineStartCornerOverlay",null),ql(this,"bottomInlineStartCornerOverlay",null),ql(this,"browserLineHeight",void 0),ql(this,"wtSettings",null),WC(this,jC,!1),WC(this,Sg,0),WC(this,UC,null),ql(this,"resizeObserver",new ResizeObserver(c=>{m_(()=>{!Array.isArray(c)||!c.length||(tf(Sg,this,Jl(Sg,this)+1),Jl(Sg,this)===100&&(Ut("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Jl(UC,this)!==null&&clearTimeout(Jl(UC,this)),tf(UC,this,setTimeout(()=>{tf(Sg,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=ei(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:v_(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Jl(Cg,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new q$e(...e),this.bottomOverlay=new k$e(...e),this.inlineStartOverlay=new W$e(...e),this.topInlineStartCornerOverlay=new G$e(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new b$e(...e,this.bottomOverlay,this.inlineStartOverlay),tf(Cg,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){tf(jC,this,Jl(Cg,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Jl(Cg,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Jl(Cg,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!vq())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",f=>this.onCloneWheel(f,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{m_(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{tf(Sg,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=y1(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Jl(jC,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),tf(jC,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=v_(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,s),f=r.hider.style,d=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-r.holder.clientWidth),m=d()?1:0,p=g()?1:0;f.width=`${c+p}px`,f.height=`${u+m}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Z(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Z(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function E8(t,e,r){return(e=t4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t4e(t){var e=r4e(t,"string");return typeof e=="symbol"?e:e+""}function r4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n4e{constructor(e){E8(this,"settings",{}),E8(this,"defaults",Object.freeze(this.getDefaults())),Ct(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Od(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?Ct(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class qF extends Yp{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=wy(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=w_(e,"height",r),s=w_(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?n.insertBefore(f,e.nextElementSibling):n.appendChild(f);const d=parseInt(r.getComputedStyle(f).height,10);n.removeChild(f),d===0&&(c=0)}c=Math.min(c,l),o.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=vp(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}ur(qF,VF);ur(qF,OR);class i4e{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new THe:new MHe],["fullyVisible",()=>new vHe],["partiallyVisible",()=>new Jq]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new _He:new AHe],["fullyVisible",()=>new gHe],["partiallyVisible",()=>new qq]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=An(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollWidth>s.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Pi(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=An(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=mn(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=ei(this.domBindings.rootDocument),new VHe({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=ei(this.domBindings.rootDocument)),new LHe({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s,rowStartOffset:o,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(o,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s,columnStartOffset:o,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(o,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<l)}resetHasOversizedColumnHeadersMarked(){Ct(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class s4e extends $F{constructor(e,r){super(e,new n4e(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new qF(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new i4e(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new B$e(this.wtSettings.getSetting("selections")),this.wtEvent=new rJ(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new e4e(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Ct(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),qe(this.wtTable.wtRootElement.parentNode,r),Se(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!sJ.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class JF{constructor(e){e instanceof $F?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new JF(r);return()=>n},this._wot=new s4e(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function R8(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),f=r||n&&h;i.row<0&&i.col>=0&&!o.column?f&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?f&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?f&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function o4e(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(s(u-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function T8(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),s=i.clone().map(a=>n.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!r.isMultiple(o)){const a=s.findAll(o);a.length===s.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const a4e=new Map([["touchstart",R8],["touchend",T8],["mousedown",R8],["mouseover",o4e],["mouseup",T8]]);function CP(t,e){a4e.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:AF(t)||t.type==="touchstart",isRightClick:Md(t),...e})}const hJ=new WeakMap,QF=Symbol("rootInstance");function l4e(t){hJ.set(t,!0)}function u4e(t){return t===QF}function im(t){return hJ.has(t)}function c4e(t,e){fJ(t,e),e.add(t)}function vc(t,e,r){fJ(t,e),e.set(t,r)}function fJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wc(t,e,r){return(e=h4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h4e(t){var e=f4e(t,"string");return typeof e=="symbol"?e:e+""}function f4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cn(t,e){return t.get(qm(t,e))}function as(t,e,r){return t.set(qm(t,e),r),r}function qm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var SP=new WeakMap,zC=new WeakMap,GC=new WeakMap,Ql=new WeakMap,sa=new WeakMap,xP=new WeakMap,bP=new WeakMap,xg=new WeakMap,Tv=new WeakSet;class d4e{constructor(e){c4e(this,Tv),wc(this,"hot",void 0),wc(this,"eventManager",void 0),wc(this,"settings",void 0),wc(this,"THEAD",void 0),wc(this,"TBODY",void 0),wc(this,"_wt",void 0),wc(this,"activeWt",void 0),vc(this,SP,0),vc(this,zC,0),wc(this,"postponedAdjustElementsSize",!1),vc(this,GC,!1),vc(this,Ql,void 0),vc(this,sa,void 0),vc(this,xP,0),vc(this,bP,0),vc(this,xg,null),this.hot=e,this.eventManager=new $a(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),qm(Tv,this,m4e).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Se(e,"handsontable"),as(sa,this,r.createElement("TABLE")),Se(cn(sa,this),"htCore"),this.hot.getSettings().tableClassName&&Se(cn(sa,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ze(cn(sa,this),[Tu()]),Ze(e,[F2e(),uq(-1),_R(this.hot.countCols()),J2e()])),this.THEAD=r.createElement("THEAD"),cn(sa,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),cn(sa,this).appendChild(this.TBODY),this.hot.table=cn(sa,this),this.hot.container.insertBefore(cn(sa,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{as(GC,this,!0),this.isTextSelectionAllowed(a.target)||(BW(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{as(GC,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{cn(GC,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&BW(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{n.isInProgress()&&AF(a)&&n.finish(),as(Ql,this,!1);const l=Aq(r.activeElement);Ux(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Md(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{n.isInProgress()&&Md(a)&&(n.finish(),as(Ql,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{n.isInProgress()&&n.finish(),as(Ql,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(cn(Ql,this)||!e||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(h===f){const g=ei(r);if(r.elementFromPoint(u+g,c)!==f||r.elementFromPoint(u,c+g)!==f)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=pp(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=pp(o);this.eventManager.addEventListener(cn(sa,this),"selectstart",a=>{this.settings.fragmentSelection||Ux(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Se(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&qe(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:cn(sa,this),isDataViewInstance:()=>im(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),as(zC,this,s.length),this.hot.getSettings().ariaTags&&qm(Tv,this,dJ).call(this)===this.hot.countCols()&&qm(Tv,this,g4e).call(this,cn(zC,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),as(SP,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,f=u;Array.isArray(c)&&([h,f]=c);const d=this.hot.getCellMeta(h,f),g=this.hot.colToProp(f);let m=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(m=this.hot.runHooks("beforeValueRender",m,d)),this.hot.runHooks("beforeRenderer",a,l,u,g,m,d),this.hot.getCellRenderer(d)(this.hot,a,l,u,g,m,d),this.hot.runHooks("afterRenderer",a,l,u,g,m,d)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&vp(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,as(Ql,this,!0),as(xg,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,c),!Wf(s)&&(CP(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,as(Ql,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!Wf(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!Wf(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,c),!Wf(s)&&(cn(Ql,this)&&(!cn(xg,this)||cn(xg,this).x!==s.clientX||cn(xg,this).y!==s.clientY)&&CP(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt,as(xg,this,null))},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(Wf(s)||this.hot.isDestroyed)&&(CP(s,{coords:u,selection:this.hot.selection,cellRangeMapper:RDe(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollVertically",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let u=s;return!l&&(u=a.getVisualFromRenderableIndex(s),u===null)?s:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,o),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const d=h.peekByIndex(a??0);l=[d.from.row,d.from.col,d.to.row,d.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,c]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=o>=0?c.getVisualFromRenderableIndex(o):o,f=s>=0?u.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",f,h,a,l);if(Array.isArray(d)){const[g,m,p,w]=d;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,m>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,1)):m,p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,-1)):p,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,-1)):w]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=o>=0?l.getVisualFromRenderableIndex(o):o,c=s>=0?a.getVisualFromRenderableIndex(s):s,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[f,d]=h;return[f>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,1)):f,d>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1)):d]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.max(1,Math.ceil(u/a*12));s.startRow=Math.max(l-c,0),s.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.max(1,Math.ceil(u/a*6));s.startColumn=Math.max(l-c,0),s.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new JF(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Ux(e))return!0;const r=hd(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return cn(Ql,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!et(n,"relative")){Ku(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;et(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,i),o.className="",Se(o,["relative",...s()])):(Ku(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ze(a,...Tu()),Ze(l,...Tu())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(et(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):et(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?Gp(e,n(r,i)):(Od(e," "),Se(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){as(xP,this,e),as(bP,this,r)}getLastSize(){return{width:cn(xP,this),height:cn(bP,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return cn(SP,this)}getRowHeadersCount(){return cn(zC,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function dJ(){return parseInt(this.hot.rootElement.getAttribute(_R()[0]),10)}function g4e(t){const e=qm(Tv,this,dJ).call(this)+t;Ze(this.hot.rootElement,..._R(e))}function m4e(){const t=this.hot.rootElement;this.hasVerticalScroll()?Se(t,"htHasScrollY"):qe(t,"htHasScrollY"),this.hasHorizontalScroll()?Se(t,"htHasScrollX"):qe(t,"htHasScrollX")}var p4e=wr,v4e=Mn,w4e=Vp,y4e=Is,C4e=Dn,S4e=jl,x4e=Os,b4e=Bh,_P=b4e("every",TypeError);p4e({target:"Iterator",proto:!0,real:!0,forced:_P},{every:function(e){C4e(this);try{y4e(e)}catch(i){x4e(this,"throw",i)}if(_P)return v4e(_P,this,e);var r=S4e(this),n=0;return!w4e(r,function(i,s){if(!e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const _4e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",k8=_4e.length;function E4e(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%k8,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/k8,10);return r}function gJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{n.push([s+e,a,o])}):Object.keys(i).forEach(o=>{n.push([s+e,o,i[o]])})}),n}function mJ(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&yt(t[0])&&(e=RF(t[0]))),e}function R4e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function T4e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function O0(t,e,r){return(e=k4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k4e(t){var e=P4e(t,"string");return typeof e=="symbol"?e:e+""}function P4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A4e{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];O0(this,"hot",void 0),O0(this,"data",void 0),O0(this,"dataType","array"),O0(this,"colToProp",()=>{}),O0(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return Z(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):je(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(yt(a)||Zt(a))if(i?l=[]:l={},!s||i){const c=this.countFirstRowKeys()-1;je(0,c,h=>{const f=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(f)){const d=this.getAtPhysicalCell(e,f,a);i?l.push(d):o?Jk(l,f,d):l[f]=d}})}else Ct(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?Jk(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Zs(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Jk(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?xNe(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=Zs(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return je(s,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,o,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return mJ(this.data)}destroy(){this.data=null,this.hot=null}}var I4e=wr,O4e=Mn,M4e=Vp,N4e=Is,D4e=Dn,F4e=jl,H4e=Os,L4e=Bh,EP=L4e("some",TypeError);I4e({target:"Iterator",proto:!0,real:!0,forced:EP},{some:function(e){D4e(this);try{N4e(e)}catch(i){H4e(this,"throw",i)}if(EP)return O4e(EP,this,e);var r=F4e(this),n=0;return M4e(r,function(i,s){if(e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function P8(t,e,r){return(e=$4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $4e(t){var e=B4e(t,"string");return typeof e=="symbol"?e:e+""}function B4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ig{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;P8(this,"indexedValues",[]),P8(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Zt(this.initValueOrFn)?je(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):je(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ur(ig,hi);function ZF(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>Zt(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function eH(t,e){return Ad(t,(r,n)=>e.includes(n)===!1)}class jh extends ig{insert(e,r){this.indexedValues=ZF(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=eH(this.indexedValues,e),super.remove(e)}}class MR extends jh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Ms(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function tH(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function yy(t,e){return Ad(t,r=>e.includes(r)===!1)}function rH(t,e){return Pt(t,r=>r-e.filter(n=>n<r).length)}function nH(t,e){const r=e[0],n=e.length;return Pt(t,i=>i>=r?i+n:i)}function V4e(t,e,r){return(e=W4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W4e(t){var e=j4e(t,"string");return typeof e=="symbol"?e:e+""}function j4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NR extends ig{constructor(){super(...arguments),V4e(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=yy(this.orderOfIndexes,[e]),Zt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=ZF(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=nH(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=eH(this.indexedValues,e),this.orderOfIndexes=yy(this.orderOfIndexes,e),this.orderOfIndexes=rH(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class b1 extends jh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Ms(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const A8=new Map([["indexesSequence",{getListWithInsertedItems:tH,getListWithRemovedItems:yy}],["physicallyIndexed",{getListWithInsertedItems:ZF,getListWithRemovedItems:eH}]]),pJ=t=>{if(A8.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return A8.get(t)};class vJ extends ig{constructor(){super(e=>e)}insert(e,r){const n=nH(this.indexedValues,r);this.indexedValues=tH(n,e,r),super.insert(e,r)}remove(e){const r=yy(this.indexedValues,e);this.indexedValues=rH(r,e),super.remove(e)}}const I8=new Map([["hiding",MR],["index",ig],["linkedPhysicalIndexToValue",NR],["physicalIndexToValue",jh],["trimming",b1]]);function U4e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!I8.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(I8.get(t))(e)}function z4e(t,e,r){return(e=G4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G4e(t){var e=Y4e(t,"string");return typeof e=="symbol"?e:e+""}function Y4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iH{constructor(){z4e(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);Le(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Dr(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}ur(iH,hi);function RP(t,e,r){return(e=K4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K4e(t){var e=X4e(t,"string");return typeof e=="symbol"?e:e+""}function X4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O8 extends iH{constructor(e,r){super(),RP(this,"mergedValuesCache",[]),RP(this,"aggregationFunction",void 0),RP(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=Pt(this.get(),s=>s.getValues()),n=[],i=Le(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return Pt(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return Le(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function q4e(t,e,r){J4e(t,e),e.set(t,r)}function J4e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q4e(t,e,r){return t.set(wJ(t,e),r),r}function Z4e(t,e){return t.get(wJ(t,e))}function wJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var TP=new WeakMap;class yJ{constructor(){q4e(this,TP,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Z4e(TP,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Q4e(TP,this,e)}}ur(yJ,hi);function M8(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function M0(t,e,r){e3e(t,e),e.set(t,r)}function e3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wo(t,e){return t.get(CJ(t,e))}function YC(t,e,r){return t.set(CJ(t,e),r),r}function CJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var KC=new WeakMap,N0=new WeakMap,XC=new WeakMap,qC=new WeakMap,JC=new WeakMap;class t3e{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M0(this,KC,new Set),M0(this,N0,[]),M0(this,XC,[]),M0(this,qC,!1),M0(this,JC,!1),YC(JC,this,e??!1)}createObserver(){const e=new yJ;return wo(KC,this).add(e),e.addLocalHook("unsubscribe",()=>{wo(KC,this).delete(e)}),e._writeInitialChanges(M8(wo(N0,this),wo(XC,this))),e}emit(e){let r=wo(XC,this);(!wo(qC,this)||wo(N0,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(wo(JC,this)):YC(N0,this,new Array(e.length).fill(wo(JC,this))),wo(qC,this)||(YC(qC,this,!0),r=wo(N0,this)));const n=M8(r,e);wo(KC,this).forEach(i=>i._write(n)),YC(XC,this,e)}}function Li(t,e,r){return(e=r3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r3e(t){var e=n3e(t,"string");return typeof e=="symbol"?e:e+""}function n3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FM{constructor(){Li(this,"indexesSequence",new vJ),Li(this,"trimmingMapsCollection",new O8(e=>e.some(r=>r===!0),!1)),Li(this,"hidingMapsCollection",new O8(e=>e.some(r=>r===!0),!1)),Li(this,"variousMapsCollection",new iH),Li(this,"hidingChangesObservable",new t3e({initialIndexValue:!1})),Li(this,"notTrimmedIndexesCache",[]),Li(this,"notHiddenIndexesCache",[]),Li(this,"isBatched",!1),Li(this,"indexesSequenceChanged",!1),Li(this,"indexesChangeSource",void 0),Li(this,"trimmedIndexesChanged",!1),Li(this,"hiddenIndexesChanged",!1),Li(this,"renderablePhysicalIndexesCache",[]),Li(this,"fromPhysicalToVisualIndexesCache",new Map),Li(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,U4e(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof b1?this.trimmingMapsCollection.register(e,r):r instanceof MR?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return Le(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return Le(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return Le(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return Le(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=Pt(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=yy(this.getIndexesSequence(),n),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(r+s<i){const u=a[r];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(tH(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],s=Le(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Pt(new Array(r).fill(s),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}ur(FM,hi);function i3e(t,e){return Ct(e,(r,n)=>{Dr(t[n])&&(t[n]=r)}),t}function SJ(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function xJ(t){Le(t)&&IF(Jt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function s3e(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:o3e,getValues:a3e}=Qo("phraseFormatters");function l3e(t,e){o3e(t,e)}function u3e(){return a3e()}l3e("pluralize",s3e);const bJ="ContextMenu:items",lt=bJ,sH=`${lt}.noItems`,oH=`${lt}.insertRowAbove`,aH=`${lt}.insertRowBelow`,lH=`${lt}.insertColumnOnTheLeft`,uH=`${lt}.insertColumnOnTheRight`,cH=`${lt}.removeRow`,hH=`${lt}.removeColumn`,fH=`${lt}.undo`,dH=`${lt}.redo`,S_=`${lt}.readOnly`,gH=`${lt}.clearColumn`,mH=`${lt}.copy`,pH=`${lt}.copyWithHeaders`,vH=`${lt}.copyWithGroupHeaders`,wH=`${lt}.copyHeadersOnly`,yH=`${lt}.cut`,CH=`${lt}.freezeColumn`,SH=`${lt}.unfreezeColumn`,xH=`${lt}.mergeCells`,bH=`${lt}.unmergeCells`,_H=`${lt}.addComment`,EH=`${lt}.editComment`,RH=`${lt}.removeComment`,TH=`${lt}.readOnlyComment`,kH=`${lt}.align`,PH=`${lt}.align.left`,AH=`${lt}.align.center`,IH=`${lt}.align.right`,OH=`${lt}.align.justify`,MH=`${lt}.align.top`,NH=`${lt}.align.middle`,DH=`${lt}.align.bottom`,FH=`${lt}.borders`,HH=`${lt}.borders.top`,LH=`${lt}.borders.right`,$H=`${lt}.borders.bottom`,BH=`${lt}.borders.left`,VH=`${lt}.borders.remove`,WH=`${lt}.nestedHeaders.insertChildRow`,jH=`${lt}.nestedHeaders.detachFromParent`,UH=`${lt}.hideColumn`,zH=`${lt}.showColumn`,GH=`${lt}.hideRow`,YH=`${lt}.showRow`,ss="Filters:",qr=`${ss}conditions`,DR=`${qr}.none`,KH=`${qr}.isEmpty`,XH=`${qr}.isNotEmpty`,qH=`${qr}.isEqualTo`,JH=`${qr}.isNotEqualTo`,QH=`${qr}.beginsWith`,ZH=`${qr}.endsWith`,eL=`${qr}.contains`,tL=`${qr}.doesNotContain`,c3e=`${qr}.byValue`,rL=`${qr}.greaterThan`,nL=`${qr}.greaterThanOrEqualTo`,iL=`${qr}.lessThan`,sL=`${qr}.lessThanOrEqualTo`,oL=`${qr}.isBetween`,aL=`${qr}.isNotBetween`,lL=`${qr}.after`,uL=`${qr}.before`,cL=`${qr}.today`,hL=`${qr}.tomorrow`,fL=`${qr}.yesterday`,dL=`${ss}labels.filterByCondition`,gL=`${ss}labels.filterByValue`,mL=`${ss}labels.conjunction`,FR=`${ss}labels.disjunction`,x_=`${ss}values.blankCells`,pL=`${ss}buttons.selectAll`,vL=`${ss}buttons.clear`,wL=`${ss}buttons.ok`,yL=`${ss}buttons.cancel`,CL=`${ss}buttons.placeholder.search`,SL=`${ss}buttons.placeholder.value`,xL=`${ss}buttons.placeholder.secondValue`,bL="CheckboxRenderer:",_L=`${bL}checked`,EL=`${bL}unchecked`,h3e=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:_L,CHECKBOX_RENDERER_NAMESPACE:bL,CHECKBOX_UNCHECKED:EL,CONTEXTMENU_ITEMS_ADD_COMMENT:_H,CONTEXTMENU_ITEMS_ALIGNMENT:kH,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:DH,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:AH,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:OH,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:PH,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:NH,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:IH,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:MH,CONTEXTMENU_ITEMS_BORDERS:FH,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:$H,CONTEXTMENU_ITEMS_BORDERS_LEFT:BH,CONTEXTMENU_ITEMS_BORDERS_RIGHT:LH,CONTEXTMENU_ITEMS_BORDERS_TOP:HH,CONTEXTMENU_ITEMS_CLEAR_COLUMN:gH,CONTEXTMENU_ITEMS_COPY:mH,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:wH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:vH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:pH,CONTEXTMENU_ITEMS_CUT:yH,CONTEXTMENU_ITEMS_EDIT_COMMENT:EH,CONTEXTMENU_ITEMS_FREEZE_COLUMN:CH,CONTEXTMENU_ITEMS_HIDE_COLUMN:UH,CONTEXTMENU_ITEMS_HIDE_ROW:GH,CONTEXTMENU_ITEMS_INSERT_LEFT:lH,CONTEXTMENU_ITEMS_INSERT_RIGHT:uH,CONTEXTMENU_ITEMS_MERGE_CELLS:xH,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:jH,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:WH,CONTEXTMENU_ITEMS_NO_ITEMS:sH,CONTEXTMENU_ITEMS_READ_ONLY:S_,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:TH,CONTEXTMENU_ITEMS_REDO:dH,CONTEXTMENU_ITEMS_REMOVE_BORDERS:VH,CONTEXTMENU_ITEMS_REMOVE_COLUMN:hH,CONTEXTMENU_ITEMS_REMOVE_COMMENT:RH,CONTEXTMENU_ITEMS_REMOVE_ROW:cH,CONTEXTMENU_ITEMS_ROW_ABOVE:oH,CONTEXTMENU_ITEMS_ROW_BELOW:aH,CONTEXTMENU_ITEMS_SHOW_COLUMN:zH,CONTEXTMENU_ITEMS_SHOW_ROW:YH,CONTEXTMENU_ITEMS_UNDO:fH,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:SH,CONTEXTMENU_ITEMS_UNMERGE_CELLS:bH,CONTEXT_MENU_ITEMS_NAMESPACE:bJ,FILTERS_BUTTONS_CANCEL:yL,FILTERS_BUTTONS_CLEAR:vL,FILTERS_BUTTONS_OK:wL,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:CL,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:xL,FILTERS_BUTTONS_PLACEHOLDER_VALUE:SL,FILTERS_BUTTONS_SELECT_ALL:pL,FILTERS_CONDITIONS_AFTER:lL,FILTERS_CONDITIONS_BEFORE:uL,FILTERS_CONDITIONS_BEGINS_WITH:QH,FILTERS_CONDITIONS_BETWEEN:oL,FILTERS_CONDITIONS_BY_VALUE:c3e,FILTERS_CONDITIONS_CONTAINS:eL,FILTERS_CONDITIONS_EMPTY:KH,FILTERS_CONDITIONS_ENDS_WITH:ZH,FILTERS_CONDITIONS_EQUAL:qH,FILTERS_CONDITIONS_GREATER_THAN:rL,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:nL,FILTERS_CONDITIONS_LESS_THAN:iL,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:sL,FILTERS_CONDITIONS_NAMESPACE:qr,FILTERS_CONDITIONS_NONE:DR,FILTERS_CONDITIONS_NOT_BETWEEN:aL,FILTERS_CONDITIONS_NOT_CONTAIN:tL,FILTERS_CONDITIONS_NOT_EMPTY:XH,FILTERS_CONDITIONS_NOT_EQUAL:JH,FILTERS_CONDITIONS_TODAY:cL,FILTERS_CONDITIONS_TOMORROW:hL,FILTERS_CONDITIONS_YESTERDAY:fL,FILTERS_DIVS_FILTER_BY_CONDITION:dL,FILTERS_DIVS_FILTER_BY_VALUE:gL,FILTERS_LABELS_CONJUNCTION:mL,FILTERS_LABELS_DISJUNCTION:FR,FILTERS_NAMESPACE:ss,FILTERS_VALUES_BLANK_CELLS:x_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const _J={languageCode:"en-US",[sH]:"No available options",[oH]:"Insert row above",[aH]:"Insert row below",[lH]:"Insert column left",[uH]:"Insert column right",[cH]:["Remove row","Remove rows"],[hH]:["Remove column","Remove columns"],[fH]:"Undo",[dH]:"Redo",[S_]:"Read only",[gH]:"Clear column",[kH]:"Alignment",[PH]:"Left",[AH]:"Center",[IH]:"Right",[OH]:"Justify",[MH]:"Top",[NH]:"Middle",[DH]:"Bottom",[CH]:"Freeze column",[SH]:"Unfreeze column",[FH]:"Borders",[HH]:"Top",[LH]:"Right",[$H]:"Bottom",[BH]:"Left",[VH]:"Remove border(s)",[_H]:"Add comment",[EH]:"Edit comment",[RH]:"Delete comment",[TH]:"Read-only comment",[xH]:"Merge cells",[bH]:"Unmerge cells",[mH]:"Copy",[pH]:["Copy with header","Copy with headers"],[vH]:["Copy with group header","Copy with group headers"],[wH]:["Copy header only","Copy headers only"],[yH]:"Cut",[WH]:"Insert child row",[jH]:"Detach from parent",[UH]:["Hide column","Hide columns"],[zH]:["Show column","Show columns"],[GH]:["Hide row","Hide rows"],[YH]:["Show row","Show rows"],[DR]:"None",[KH]:"Is empty",[XH]:"Is not empty",[qH]:"Is equal to",[JH]:"Is not equal to",[QH]:"Begins with",[ZH]:"Ends with",[eL]:"Contains",[tL]:"Does not contain",[rL]:"Greater than",[nL]:"Greater than or equal to",[iL]:"Less than",[sL]:"Less than or equal to",[oL]:"Is between",[aL]:"Is not between",[lL]:"After",[uL]:"Before",[cL]:"Today",[hL]:"Tomorrow",[fL]:"Yesterday",[x_]:"Blank cells",[dL]:"Filter by condition",[gL]:"Filter by value",[mL]:"And",[FR]:"Or",[pL]:"Select all",[vL]:"Clear",[wL]:"OK",[yL]:"Cancel",[CL]:"Search",[SL]:"Value",[xL]:"Second value",[_L]:"Checked",[EL]:"Unchecked"},f3e=h3e,HM=_J.languageCode,{register:d3e,getItem:EJ,hasItem:g3e,getValues:m3e}=Qo("languagesDictionaries");RJ(_J);function RJ(t,e){let r=t,n=e;return yt(t)&&(n=t,r=n.languageCode),p3e(r,n),d3e(r,rs(n)),rs(n)}function p3e(t,e){t!==HM&&i3e(e,EJ(HM))}function TJ(t){return RL(t)?rs(EJ(t)):null}function RL(t){return g3e(t)}function v3e(){return m3e()}function kJ(t,e,r){const n=TJ(t);if(n===null)return null;const i=n[e];if(Dr(i))return null;const s=w3e(i,r);return Array.isArray(s)?s[0]:s}function w3e(t,e){let r=t;return Z(u3e(),n=>{r=n(t,e)}),r}function y3e(t){let e=SJ(t);return RL(e)||(e=HM,xJ(t)),e}function C3e(t,e,r){return(e=S3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S3e(t){var e=x3e(t,"string");return typeof e=="symbol"?e:e+""}function x3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lc extends oJ{constructor(e,r){super(e,null),C3e(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,n,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function kP(t){let{activeHeaderClassName:e,...r}=t;return new lc({className:e,...r,selectionType:aJ})}function b3e(t){let{areaCornerVisible:e,...r}=t;return new lc({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:UF})}function _3e(t){let{...e}=t;return new lc({className:"highlight",...e,selectionType:UF})}function E3e(t){let{columnClassName:e,...r}=t;return new lc({className:e,...r,selectionType:M$e})}function R3e(t){let{cellCornerVisible:e,...r}=t;return new lc({className:"current",headerAttributes:[_F()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:C_})}function T3e(t){let{border:e,visualCellRange:r,...n}=t;return new lc({...e,...n,selectionType:N$e},r)}function k3e(t){let{...e}=t;return new lc({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:I$e})}function N8(t){let{headerClassName:e,...r}=t;return new lc({className:e,...r,selectionType:jF})}function P3e(t){let{rowClassName:e,...r}=t;return new lc({className:e,...r,selectionType:O$e})}function A3e(t,e){I3e(t,e),e.add(t)}function I3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ls(t,e,r){return(e=O3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O3e(t){var e=M3e(t,"string");return typeof e=="symbol"?e:e+""}function M3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Za=new WeakSet;class N3e{constructor(e){A3e(this,Za),ls(this,"options",void 0),ls(this,"layerLevel",0),ls(this,"focus",void 0),ls(this,"fill",void 0),ls(this,"layeredAreas",new Map),ls(this,"areas",new Map),ls(this,"rowHeaders",new Map),ls(this,"columnHeaders",new Map),ls(this,"activeRowHeaders",new Map),ls(this,"activeColumnHeaders",new Map),ls(this,"activeCornerHeaders",new Map),ls(this,"rowHighlights",new Map),ls(this,"columnHighlights",new Map),ls(this,"customSelections",[]),this.options=e,this.focus=R3e(e),this.fill=k3e(e)}isEnabledFor(e,r){let n=e;e===C_&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Zl(Za,this,eu).call(this,this.layeredAreas,b3e)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Zl(Za,this,eu).call(this,this.areas,_3e)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Zl(Za,this,eu).call(this,this.rowHeaders,N8)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Zl(Za,this,eu).call(this,this.columnHeaders,N8)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Zl(Za,this,eu).call(this,this.activeRowHeaders,kP)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Zl(Za,this,eu).call(this,this.activeColumnHeaders,kP)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Zl(Za,this,eu).call(this,this.activeCornerHeaders,kP)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Zl(Za,this,eu).call(this,this.rowHighlights,P3e)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Zl(Za,this,eu).call(this,this.columnHighlights,E3e)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(T3e({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Z(this.areas.values(),e=>void e.clear()),Z(this.layeredAreas.values(),e=>void e.clear()),Z(this.rowHeaders.values(),e=>void e.clear()),Z(this.columnHeaders.values(),e=>void e.clear()),Z(this.activeRowHeaders.values(),e=>void e.clear()),Z(this.activeColumnHeaders.values(),e=>void e.clear()),Z(this.activeCornerHeaders.values(),e=>void e.clear()),Z(this.rowHighlights.values(),e=>void e.clear()),Z(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function eu(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function D8(t,e,r){return(e=D3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D3e(t){var e=F3e(t,"string");return typeof e=="symbol"?e:e+""}function F3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TL{constructor(e){D8(this,"ranges",[]),D8(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new TL(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function H3e(t,e){PJ(t,e),e.add(t)}function PP(t,e,r){PJ(t,e),e.set(t,r)}function PJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(_n(t,e))}function QC(t,e,r){return t.set(_n(t,e),r),r}function _n(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ZC=new WeakMap,Cr=new WeakMap,Ma=new WeakMap,Hn=new WeakSet;class LM{constructor(e,r){H3e(this,Hn),PP(this,ZC,void 0),PP(this,Cr,void 0),PP(this,Ma,{x:0,y:0}),QC(ZC,this,e),QC(Cr,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ft(Cr,this).createCellCoords(e,r);let s=Ft(ZC,this).current().highlight;const o=Ft(Cr,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:c}=_n(Hn,this,AJ).call(this),{row:h,col:f}=_n(Hn,this,H8).call(this,s),d=Ft(Cr,this).fixedRowsBottom(),g=Ft(Cr,this).minSpareRows(),m=Ft(Cr,this).minSpareCols(),p=Ft(Cr,this).autoWrapRow(),w=Ft(Cr,this).autoWrapCol(),v=Ft(Cr,this).createCellCoords(h+i.row,f+i.col);if(v.row>=c){const T=Zs(n&&g>0&&d===0),E=v.col+1,x=Ft(Cr,this).createCellCoords(v.row-c,E>=u?E-u:E);this.runLocalHooks("beforeColumnWrap",T,_n(Hn,this,bg).call(this,x),E>=u),T.value?this.runLocalHooks("insertRowRequire",Ft(Cr,this).countRenderableRows()):w&&v.assign(x)}else if(v.row<0){const T=Zs(w),E=v.col-1,x=Ft(Cr,this).createCellCoords(c+v.row,E<0?u+E:E);this.runLocalHooks("beforeColumnWrap",T,_n(Hn,this,bg).call(this,x),E<0),w&&v.assign(x)}if(v.col>=u){const T=Zs(n&&m>0),E=v.row+1,x=Ft(Cr,this).createCellCoords(E>=c?E-c:E,v.col-u);this.runLocalHooks("beforeRowWrap",T,_n(Hn,this,bg).call(this,x),E>=c),T.value?this.runLocalHooks("insertColRequire",Ft(Cr,this).countRenderableColumns()):p&&v.assign(x)}else if(v.col<0){const T=Zs(p),E=v.row-1,x=Ft(Cr,this).createCellCoords(E<0?c+E:E,u+v.col);this.runLocalHooks("beforeRowWrap",T,_n(Hn,this,bg).call(this,x),E<0),p&&v.assign(x)}const{rowDir:y,colDir:b}=_n(Hn,this,F8).call(this,v);a=y,l=b,s=_n(Hn,this,bg).call(this,v)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,r){const n=Ft(Cr,this).createCellCoords(e,r),i=Ft(ZC,this).current(),s=Ft(Cr,this).visualToRenderableCoords(i.highlight),o=_n(Hn,this,AP).call(this,i.to.row,i.from.row),a=_n(Hn,this,IP).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:f}=_n(Hn,this,H8).call(this,i.highlight),d=Ft(Cr,this).createCellCoords(o+n.row,a+n.col),g=i.getTopStartCorner(),m=i.getTopEndCorner(),p=i.getBottomEndCorner();if(n.col<0&&a>=f&&d.col<f){const b=d.col-f;d.col=_n(Hn,this,IP).call(this,g.col,m.col)+b}else if(n.col>0&&a<=f&&d.col>f){const b=_n(Hn,this,IP).call(this,m.col,g.col),T=Math.max(d.col-b,1);d.col=b+T}if(n.row<0&&o>=h&&d.row<h){const b=d.row-h;d.row=_n(Hn,this,AP).call(this,g.row,p.row)+b}else if(n.row>0&&o<=h&&d.row>h){const b=_n(Hn,this,AP).call(this,p.row,g.row),T=Math.max(d.row-b,1);d.row=b+T}const{rowDir:w,colDir:v}=_n(Hn,this,F8).call(this,d);u=w,c=v;const y=_n(Hn,this,bg).call(this,d);n.row===0&&n.col!==0?l.col=y.col:n.row!==0&&n.col===0?l.row=y.row:(l.row=y.row,l.col=y.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:r,y:n}=e;QC(Ma,this,{x:r,y:n})}resetOffsetSize(){QC(Ma,this,{x:0,y:0})}}function F8(t){const{width:e,height:r}=_n(Hn,this,AJ).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function AJ(){return{width:Ft(Ma,this).x+Ft(Cr,this).countRenderableColumns(),height:Ft(Ma,this).y+Ft(Cr,this).countRenderableRows()}}function AP(t,e){const r=Ft(Cr,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:Ft(Ma,this).y+r}function IP(t,e){const r=Ft(Cr,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:Ft(Ma,this).x+r}function H8(t){const{row:e,col:r}=Ft(Cr,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return Ft(Cr,this).createCellCoords(Ft(Ma,this).y+e,Ft(Ma,this).x+r)}function bg(t){const e=t.clone();return e.col=t.col-Ft(Ma,this).x,e.row=t.row-Ft(Ma,this).y,Ft(Cr,this).renderableToVisualCoords(e)}ur(LM,hi);const HR=0,LR=1,IJ=2,kL=3,L3e=[kL,IJ],$3e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],OP=Symbol("root"),L8=Symbol("child");function yp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:OP;if(e!==OP&&e!==L8)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===OP;let i=HR;if(r){const s=t[0];t.length===0?i=LR:n&&s instanceof C1?i=kL:n&&Array.isArray(s)?i=yp(s,L8):t.length>=2&&t.length<=4&&!t.some((a,l)=>!$3e[l].includes(typeof a))&&(i=IJ)}return i}function Cy(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!L3e.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===kL;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Dr(u)&&(u=a),Dr(c)&&(c=l),!n){const d=a,g=l,m=u,p=c;a=Math.min(d,m),l=Math.min(g,p),u=Math.max(d,m),c=Math.max(g,p)}const h=e(a,l),f=e(u,c);return r(h,h,f)}}function B3e(t){const e=yp(t.getSelected());if(e===HR||e===LR)return[];const r=Cy(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;Z(t.getSelected(),o=>{const{from:a,to:l}=r(o),u=Math.max(a.col,0),c=l.col-u+1;Z(Array.from(new Array(c),(h,f)=>u+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Ms(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function V3e(t){const e=yp(t.getSelected());if(e===HR||e===LR)return[];const r=Cy(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;Z(t.getSelected(),o=>{const{from:a,to:l}=r(o),u=Math.max(a.row,0),c=l.row-u+1;Z(Array.from(new Array(c),(h,f)=>u+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Ms(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function _g(t,e,r){W3e(t,e),e.set(t,r)}function W3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rf(t,e,r){return(e=j3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j3e(t){var e=U3e(t,"string");return typeof e=="symbol"?e:e+""}function U3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function br(t,e){return t.get(OJ(t,e))}function el(t,e,r){return t.set(OJ(t,e),r),r}function OJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mi=new WeakMap,nf=new WeakMap,eS=new WeakMap,D0=new WeakMap,tS=new WeakMap,F0=new WeakMap;class MJ{constructor(e,r){var n=this;rf(this,"settings",void 0),rf(this,"tableProps",void 0),rf(this,"inProgress",!1),rf(this,"selectedRange",new TL((i,s,o)=>this.tableProps.createCellRange(i,s,o))),rf(this,"highlight",void 0),_g(this,mi,void 0),_g(this,nf,void 0),rf(this,"selectedByRowHeader",new Set),rf(this,"selectedByColumnHeader",new Set),_g(this,eS,!1),_g(this,D0,!1),_g(this,tS,"unknown"),_g(this,F0,-1),this.settings=e,this.tableProps=r,this.highlight=new N3e({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[_F()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),el(mi,this,new LM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),el(nf,this,new LM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),br(mi,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),br(mi,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),br(mi,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),br(mi,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),br(mi,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),br(mi,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)}),br(mi,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...s)}),br(mi,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...s)}),br(nf,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),br(nf,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){el(tS,this,e)}markEndSource(){el(tS,this,"unknown")}getSelectionSource(){return br(tS,this)}setExpectedLayers(e){el(F0,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,el(F0,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=Dr(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();el(eS,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!s||s&&!o&&Dr(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!s||i===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),c=this.isMultiple();o.setTo(r),c&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),c&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=br(F0,this)===-1||this.selectedRange.size()===br(F0,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(Z(this.highlight.getAreas(),g=>void g.clear()),Z(this.highlight.getLayeredAreas(),g=>void g.clear()),Z(this.highlight.getRowHeaders(),g=>void g.clear()),Z(this.highlight.getColumnHeaders(),g=>void g.clear()),Z(this.highlight.getActiveRowHeaders(),g=>void g.clear()),Z(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),Z(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),Z(this.highlight.getRowHighlights(),g=>void g.clear()),Z(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),f.clear(),d.clear(),this.highlight.isEnabledFor(UF,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(jF,e.highlight)){if(!e.isSingleHeader()){const p=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),w=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),y=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(p).commit(),l.add(v).commit(),f.add(p).commit(),d.add(v).commit()):(a.add(p).add(w).commit(),l.add(v).add(y).commit(),f.add(p).add(w).commit(),d.add(v).add(y).commit())}const g=!br(D0,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),m=!br(D0,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),m&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&m&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(C_,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(el(eS,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?br(mi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):br(mi,this).resetOffsetSize(),this.setRangeStart(br(mi,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?br(mi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):br(mi,this).resetOffsetSize(),this.setRangeEnd(br(mi,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:s}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?br(nf,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):br(nf,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=br(nf,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(Ot(i.row+h,c,a-1),i.col),d=this.tableProps.createCellCoords(Ot(s.row+r,c,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(Ot(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(i.row,Ot(i.col+h,c,a-1)),d=this.tableProps.createCellCoords(s.row,Ot(s.col+r,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(o.row,Ot(o.col+r,0,a-1))):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const r=Zs(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&br(eS,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:d}=i;el(D0,this,d),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords(Ot(f.row,u,s-1),Ot(f.col,c,o-1)));const g=this.tableProps.createCellCoords(u,c),m=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.finish(),el(D0,this,!1)}selectCells(e){var r=this;const n=yp(e);if(n===LR)return!1;if(n===HR)throw new Error(Jt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Cy(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),Z(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(o-1,s),f=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){let d=0,g=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(d=Ot(n.row,u,o-1),g=Ot(n.col,Math.min(i,s),Math.max(i,s))):(d=Ot(n,u,o-1),g=i);const m=this.tableProps.createCellCoords(d,g),p=l===0?0:Ot(m.row,u,-1),w=o-1,v=this.tableProps.createCellCoords(p,i),y=this.tableProps.createCellCoords(w,s);this.runLocalHooks("beforeSelectColumns",v,y,m),v.row=p,y.row=w,this.setRangeStartOnly(v,void 0,m),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectColumns",v,y,m),this.finish()}return f}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,s-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(c){let h=0,f=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=Ot(n.row,Math.min(e,r),Math.max(e,r)),f=Ot(n.col,a,s-1)):(h=e,f=Ot(n,a,s-1));const d=this.tableProps.createCellCoords(h,f),g=o===0?0:Ot(d.col,a,-1),m=s-1,p=this.tableProps.createCellCoords(e,g),w=this.tableProps.createCellCoords(r,m);this.runLocalHooks("beforeSelectRows",p,w,d),p.col=g,w.col=m,this.setRangeStartOnly(p,void 0,d),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",p,w,d),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(o=>{const{from:a,to:l,highlight:u}=o,c=e-1,h=r-1;u.assign({row:Ot(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Ot(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Ot(a.row,-1/0,c),col:Ot(a.col,-1/0,h)}),l.assign({row:Ot(l.row,-1/0,c),col:Ot(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(C_,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),f.commit(),d.commit()}this.highlight.useLayerLevel(r)}}ur(MJ,hi);const $8=/^(\r\n|\n\r|\r|\n)/,z3e=/^[^\t\r\n]+/,B8=/^\t/;function G3e(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(B8))t=t.replace(B8,""),r+=1,e[n][r]="";else if(t.match($8))t=t.replace($8,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(z3e);s=o?o[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function iw(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function sf(t,e,r){return(e=Y3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y3e(t){var e=K3e(t,"string");return typeof e=="symbol"?e:e+""}function K3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Am{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){sf(this,"hot",void 0),sf(this,"metaManager",void 0),sf(this,"tableMeta",void 0),sf(this,"dataSource",void 0),sf(this,"duckSchema",void 0),sf(this,"colToPropCache",void 0),sf(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){const a=RF(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=o?r(n):r[n];if(yt(a)){if(typeof a.data<"u"){const l=o?s:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return mJ(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&Ct(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&Le(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(Le(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?py(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<r&&s+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=rs(this.getSchema()):(g=[],je(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},ER(g,this.getSchema())),f.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,f);const d=this.hot.toVisualRow(o);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",d,a,n),{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,f=i==="end"?Math.min(h+1,a):h;let d=0;for(let g=f;d<r&&l+d<o;g++){if(typeof c!="number"||c>=l+d)if(u>0)for(let m=0;m<u;m+=1)typeof s[m]>"u"&&(s[m]=[]),s[m].push(null);else s.push([null]);else for(let m=0;m<u;m++)s[m].splice(g,0,null);d+=1}return d>0&&(e==null?this.metaManager.createColumn(null,d):n!=="auto"&&this.metaManager.createColumn(f,r)),this.hot.columnIndexMapper.insertIndexes(c,d,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(f),d,n),this.refreshDuckSchema(),{delta:d,startPhysicalIndex:f}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const c=Le(this.tableMeta.columns)||Le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)c[h].splice(s[0],r),h===0&&this.metaManager.removeColumn(s[0],r);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let d=0;d<u;d++)c[h].splice(o[d],1),h===0&&this.metaManager.removeColumn(o[d],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];yW(l,o);let c=0;for(;c<n;)l.push(null),c+=1;return P2e(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];yW(l,o);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Pn(i,r))a=i[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=Zs(a);this.hot.runHooks("modifyData",e,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=Zs(s);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Pn(o,r))o[r]=s;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=o,c=0,h;const f=r.split(".");for(c=0,h=f.length-1;c<h;c++){if(f[c]==="__proto__"||f[c]==="constructor"||f[c]==="prototype")return;typeof u[f[c]]>"u"&&(u[f[c]]={}),u=u[f[c]]}u[f[c]]=s}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],s);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;o[r]=s}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,o=r;for(;s<n&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Am.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Am.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=h;s++){a=[];const d=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=f&&d!==null;o++)a.push(c.call(this,s,this.colToProp(o)));d!==null&&i.push(a)}return i}getText(e,r){return iw(this.getRange(e,r,Am.DESTINATION_RENDERER))}getCopyableText(e,r){return iw(this.getRange(e,r,Am.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:X3e,getItem:q3e,hasItem:NJ,getNames:lrt,getValues:urt}=Qo("cellTypes");function J3e(t){if(!NJ(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return q3e(t)}function ha(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&$s(t,r),n&&bo(t,n),i&&nm(t,i),X3e(t,e)}function Q3e(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Pn(e,t)}function $R(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?J3e(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ct(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!yt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ct(n,(s,o)=>{if(Q3e(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),In(t,i)}function Z3e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}SNe(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function zx(t){return Number.isInteger(t)&&t>=0}function Gx(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function rS(t){return t==null}const DJ=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),an(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),an(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),EF(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function V8(t,e,r){return(e=eBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eBe(t){var e=tBe(t,"string");return typeof e=="symbol"?e:e+""}function tBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rBe(){return class{}}class nBe{constructor(e){V8(this,"metaCtor",rBe()),V8(this,"meta",void 0),this.meta=this.metaCtor.prototype,In(this.meta,DJ()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;In(this.meta,e),$R(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function iBe(t,e,r){return(e=sBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sBe(t){var e=oBe(t,"string");return typeof e=="symbol"?e:e+""}function oBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aBe{constructor(e){iBe(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){In(this.meta,e),$R(this.meta,e,e)}}function nS(t,e,r){return(e=lBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lBe(t){var e=uBe(t,"string");return typeof e=="symbol"?e:e+""}function uBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b_{constructor(e){nS(this,"valueFactory",void 0),nS(this,"data",[]),nS(this,"index",[]),nS(this,"holes",new Set),this.valueFactory=e}obtain(e){Gx(()=>zx(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gx(()=>zx(e)||rS(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);const s=rS(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Gx(()=>zx(e)||rS(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(rS(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function W8(t,e,r){return(e=cBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cBe(t){var e=hBe(t,"string");return typeof e=="symbol"?e:e+""}function hBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fBe=["data","width"];class dBe{constructor(e){W8(this,"globalMeta",void 0),W8(this,"metas",new b_(()=>this._createMeta())),this.globalMeta=e,this.metas=new b_(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);In(n,r),$R(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Z3e(this.globalMeta.getMetaConstructor(),fBe).prototype}}function j8(t,e,r){return(e=gBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gBe(t){var e=mBe(t,"string");return typeof e=="symbol"?e:e+""}function mBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pBe{constructor(e){j8(this,"columnMeta",void 0),j8(this,"metas",new b_(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);In(i,n),$R(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)Le(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Gx(()=>zx(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new b_(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class FJ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new nBe(e),this.tableMeta=new aBe(this.globalMeta),this.columnMeta=new dBe(this.globalMeta),this.cellMeta=new pBe(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ur(FJ,hi);function U8(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=La(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":Zt(f.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${h}`,t,c,l);const d=new Am(i,t,u);if(e(d),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=d.getSchema();t=[];let m,p=0,w=0;for(p=0,w=f.startRows;p<w;p++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)m=rs(g),t.push(m);else if(i.dataType==="array")m=rs(g[0]),t.push(m);else{m=[];for(let v=0,y=f.startCols;v<y;v++)m.push(null);t.push(m)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,d.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=d.colToProp.bind(d),o.propToCol=d.propToCol.bind(d),o.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ze(i.rootElement,[uq(-1),_R(i.countCols()+(i.view?i.countRowHeaders():0))])}function z8(t,e,r){return(e=vBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vBe(t){var e=wBe(t,"string");return typeof e=="symbol"?e:e+""}function wBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yBe{constructor(e){var r=this;z8(this,"metaManager",void 0),z8(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),Fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=Pn(e,"type")?e.type:null;let c=Zt(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function CBe(t,e,r){SBe(t,e),e.set(t,r)}function SBe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MP(t,e,r){return(e=xBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xBe(t){var e=bBe(t,"string");return typeof e=="symbol"?e:e+""}function bBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _Be(t,e){return t.get(EBe(t,e))}function EBe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var G8=new WeakMap;class RBe{constructor(e){MP(this,"metaManager",void 0),MP(this,"usageTracker",new Set),MP(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),CBe(this,G8,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,l,s),o&&this.installPropWatcher(i,l,s)):n&&(this.installPropWatcher(r,l,_Be(G8,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}const HJ="gridDefault",Uh="editorManager.handlingEditor",TBe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},kBe="hooksRefRegisterer",LJ={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Z(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ct(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ac(LJ,"MIXIN_NAME",kBe,{writable:!1,enumerable:!1});function oa(t,e,r){return(e=PBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PBe(t){var e=ABe(t,"string");return typeof e=="symbol"?e:e+""}function ABe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const IBe="base",en=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Kp{static get EDITOR_TYPE(){return IBe}constructor(e){oa(this,"hot",void 0),oa(this,"state",en.VIRGIN),oa(this,"_opened",!1),oa(this,"_fullEditMode",!1),oa(this,"_closeCallback",null),oa(this,"TD",null),oa(this,"row",null),oa(this,"col",null),oa(this,"prop",null),oa(this,"originalValue",null),oa(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:en.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[n,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==en.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=en.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Fr(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),n.view.scrollViewport(n._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===en.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===en.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=en.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=en.FINISHED,this.discardEditor(o)}):(this.state=en.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=en.FINISHED,this.discardEditor()}discardEditor(e){this.state===en.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=en.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=en.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===en.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=Pi(r),a=mn(r),l=Pi(this.hot.rootElement),u=mn(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,f=c!==s?c.scrollTop:0,d=h!==s?h.scrollLeft:0,g=s.innerWidth-l.left-u,{wtTable:m}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,p=m.name,w=["master","inline_start"].includes(p)?f:0,v=["master","top","bottom"].includes(p)?d:0,y=o.top===l.top?0:1;let b=o.top-l.top-y-w,T=0;this.hot.isRtl()?T=s.innerWidth-o.left-a-g-1+v:T=o.left-l.left-1-v,["top","top_inline_start_corner"].includes(p)&&(b+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(T+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const E=this.hot.hasColHeaders(),x=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),P=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),O=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&x<=0||x===O)&&(b+=1),P<=0&&(T+=1);const Y=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,ie=Math.abs(n.inlineStartOverlay.getScrollPosition()),ce=n.topOverlay.getScrollPosition(),he=ei(this.hot.rootDocument);let Ee=r.offsetTop;if(["inline_start","master"].includes(p)&&(Ee+=Y-ce),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:X,wtTable:ee}=n.bottomOverlay.clone;Ee+=X.getWorkspaceHeight()-ee.getHeight()-he}let Ce=r.offsetLeft;this.hot.isRtl()?(Ce>=0?Ce=m.getWidth()-r.offsetLeft:Ce=Math.abs(Ce),Ce+=L-ie-a):["top","master","bottom"].includes(p)&&(Ce+=L-ie);const ge=s.getComputedStyle(this.TD),Q=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ye=parseInt(ge[Q],10)>0?0:1,Re=parseInt(ge.borderTopWidth,10)>0?0:1,W=mn(r)+ye,C=An(r)+Re,S=kq(c)?he:0,_=Pq(h)?he:0,D=this.hot.view.maximumVisibleElementWidth(Ce)-S+ye,U=Math.max(this.hot.view.maximumVisibleElementHeight(Ee)-_+Re,this.hot.stylesHandler.getDefaultRowHeight());return{top:b,start:T,height:C,maxHeight:U,width:W,maxWidth:D}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}ur(Kp,LJ);const OBe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===en.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},MBe={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},NBe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},DBe={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},FBe={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),ja(e))}};function HBe(){return[TBe,OBe,MBe,NBe,DBe,FBe]}const LBe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},$Be={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),s=r.getNearestNotHiddenIndex(i,-1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},BBe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},VBe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},WBe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},jBe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},UBe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},zBe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},GBe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},YBe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},KBe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},XBe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},qBe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},JBe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),s=r.getNearestNotHiddenIndex(i,1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function QBe(){return[LBe,$Be,BBe,VBe,WBe,jBe,UBe,zBe,GBe,YBe,KBe,XBe,qBe,JBe]}const ZBe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},eVe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?1:s,i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},tVe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},rVe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},nVe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},iVe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},sVe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},oVe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}},aVe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},lVe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,s)),e.markEndSource()}},uVe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},cVe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},hVe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},fVe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},dVe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},gVe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?-1:-s,i===-n?s=-1:i+s<n&&(s=-(i+n)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function mVe(){return[ZBe,eVe,tVe,rVe,nVe,iVe,sVe,oVe,aVe,lVe,uVe,cVe,hVe,fVe,dVe,gVe]}const pVe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},vVe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,n),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},wVe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},yVe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},CVe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}},SVe=[...HBe(),...QBe(),...mVe(),pVe,vVe,wVe,yVe,CVe];function $J(t){const e={};return SVe.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function xVe(t){const e=t.getShortcutManager().addContext("editor"),r=$J(t),n={group:Uh};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function bVe(t){const e=t.getShortcutManager().addContext("grid"),r=$J(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:HJ};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:Uh,runOnlyIf:()=>Le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function _Ve(t){[bVe,xVe].forEach(e=>e(t))}function EVe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=Y8(t),i=Y8(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.before(n),r.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function Y8(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ze(r,[mp("Focus catcher")]),r}function RVe(t){const e=TVe(t);let r;const{activate:n,deactivate:i}=EVe(t,{onFocusFromTop(){var h;const f=(h=e(r))!==null&&h!==void 0?h:$M(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_above",f),t.selectCell(f.row,f.col)),t.listen()},onFocusFromBottom(){var h;const f=(h=e(r))!==null&&h!==void 0?h:BM(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_below",f),t.selectCell(f.row,f.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,f,d,g,m)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,m.value=!0),o){var p;r=(p=t.getSelectedRangeLast())===null||p===void 0?void 0:p.highlight}}),t.addHook("beforeRowWrap",(h,f,d)=>{s.wrapped=!0,s.flipped=d});function u(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:HJ,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:f,autoWrapRow:d}=t.getSettings();if(a=!1,o=!0,!f||!t.selection.isSelected()||d&&s.wrapped&&s.flipped||!d&&s.wrapped)return d&&s.wrapped&&s.flipped&&(r=h.shiftKey?$M(t):BM(t)),u(),!1;h.preventDefault()},position:"after"}])}function $M(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function BM(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function TVe(t){return e=>{if(!e)return null;const r=$M(t),n=BM(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function Xp(t){$u(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function BR(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),s=r.getFirstFullyVisibleColumn(),o=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=s,c=l>=o,h=r.getFirstFullyVisibleRow(),f=r.getLastFullyVisibleRow(),d=n.getTopStartCorner().row,g=n.getBottomEndCorner().row,m=d<=h,p=g>=f;return{getComputedColumnTarget(w){return i==="mouse"||i==="keyboard"?w.col:u&&c?n.highlight.col:u?a:c?l:w.col},getComputedRowTarget(w){return i==="mouse"||i==="keyboard"?w.row:m&&p?n.highlight.row:m?d:p?g:w.row}}}function kVe(t){return e=>{const r=BR(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;Xp(t.getCell(n?-1:0,r,!0))})}}function PVe(){return()=>{}}function AVe(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;Xp(t.getCell(r,n,!0))})}}function IVe(t){return e=>{const r=BR(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;Xp(t.getCell(i,s,!0))})}}function OVe(t){return e=>{const r=BR(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;Xp(t.getCell(i,s,!0))})}}function MVe(t){return e=>{const r=BR(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;Xp(t.getCell(r,n?-1:0,!0))})}}function NVe(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,s=()=>{Xp(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},s);else if(i<0&&n>=0)t.scrollViewportTo({row:n},s);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},s)}}}function DVe(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let o;e.isFocusSelectionChanged()?o=AVe(t):e.isSelectedByCorner()?o=PVe():e.isSelectedByRowHeader()?o=MVe(t):e.isSelectedByColumnHeader()?o=kVe(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=IVe(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=NVe(t):e.getSelectedRange().size()>1&&(o=OVe(t)),(s=o)===null||s===void 0||s(i)}}}const K8=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),iS=t=>t.map(e=>{const r=e.toLowerCase();return K8.has(r)?K8.get(r):r}).sort().join("+"),FVe=t=>t.split("+"),X8=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),NP=t=>{let{which:e,key:r}=t;if(X8.has(e))return X8.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},BJ=Symbol("shortcut-context");function VJ(t){return yt(t)&&t.__kindOf===BJ}const HVe=t=>{const e=AR({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:d=!0,stopPropagation:g=!1,relativeToGroup:m,position:p,forwardToContext:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Dr(c))throw new Error("You need to define the shortcut's group.");if(Zt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Jt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:f,preventDefault:d,stopPropagation:g};Le(m)&&(v.relativeToGroup=m,v.position=p),VJ(w)&&(v.forwardToContext=w),l.forEach(y=>{const b=iS(y);if(e.hasItem(b)){const E=e.getItem(b);let x=E.findIndex(P=>P.group===m);x!==-1?p==="before"?x-=1:x+=1:x=E.length,E.splice(x,0,v)}else e.addItem(b,[v])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ct(u,(h,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),r(c)})},i=l=>{const u=iS(l);e.removeItem(u)};return{__kindOf:BJ,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=iS(l),c=e.getItem(u);return Le(c)?c.slice():[]},hasShortcut:l=>{const u=iS(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,f]=c;const d=f.filter(g=>g.group!==l);d.length===0?i(FVe(h)):(f.length=0,f.push(...d))})}}};function LVe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const $Ve=["meta","alt","shift","control"],H0=LVe(),L0=[];let sS=0;function BVe(t,e,r,n,i){const s=d=>$Ve.includes(d),o=function(d){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return d.altKey&&m.push("alt"),g&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},a=d=>{if(e(d)===!1||r(d)===!1||d.keyCode===229||typeof d.key!="string"||Wf(d))return;const m=NP(d);let p=[];s(m)||(p=o(d));const w=[m].concat(p);!i(d,w)&&($W()&&p.includes("meta")||!$W()&&p.includes("control"))&&i(d,[m].concat(o(d,!0))),n(d)},l=d=>{if(typeof d.key=="string"){const g=NP(d);s(g)&&H0.press(g)}},u=d=>{if(typeof d.key=="string"){const g=NP(d);s(g)&&H0.release(g)}},c=()=>{H0.releaseAll()};return{mount:()=>{let d=t;for(sS+=1;d;)sS===1&&(d.document.documentElement.addEventListener("keydown",l),L0.push({event:"keydown",listener:l}),d.document.documentElement.addEventListener("keyup",u),L0.push({event:"keyup",listener:u})),d.document.documentElement.addEventListener("keydown",a),d.document.documentElement.addEventListener("blur",c),d=pp(d)},unmount:()=>{let d=t;for(sS-=1;d;){if(sS===0){for(let g=0;g<L0.length;g++){const{event:m,listener:p}=L0[g];d.document.documentElement.removeEventListener(m,p)}L0.length=0}d.document.documentElement.removeEventListener("keydown",a),d.document.documentElement.removeEventListener("blur",c),d=pp(d)}},isPressed:d=>H0.isPressed(d),releasePressedKeys:()=>H0.releaseAll()}}const VVe=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=AR({errorIdExists:g=>`The "${g}" context name is already registered.`});let o="grid";const a=g=>{const m=HVe(g);return s.addItem(g,m),m},l=()=>o,u=g=>s.getItem(g),c=g=>{if(!s.hasItem(g))throw new Error(Jt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=g};let h=!1;const f=function(g,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const w=VJ(p)?p:u(p);let v=!1;if(!w.hasShortcut(m))return v;const y=w.getShortcuts(m);for(let b=0;b<y.length;b++){const{callback:T,runOnlyIf:E,preventDefault:x,stopPropagation:P,captureCtrl:A,forwardToContext:O}=y[b];if(E(g)===!0){if(h=A,v=T(g,m)===!1,h=!1,x&&g.preventDefault(),P&&(ja(g),g.stopPropagation()),v)break;O&&f(g,m,O)}}return v},d=BVe(e,r,n,i,f);return d.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(d.isPressed("control")||d.isPressed("meta")),releasePressedKeys:()=>d.releasePressedKeys(),destroy:()=>d.unmount()}};function q8(t){const{classNames:e}=ONe(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function WVe(t,e){WJ(t,e),e.add(t)}function of(t,e,r){WJ(t,e),e.set(t,r)}function WJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e){return t.get(Ca(t,e))}function ko(t,e,r){return t.set(Ca(t,e),r),r}function Ca(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const J8=23;var af=new WeakMap,__=new WeakMap,PL=new WeakMap,VM=new WeakMap,Mc=new WeakMap,kv=new WeakMap,Sy=new WeakMap,vl=new WeakSet;class jVe{constructor(e,r){WVe(this,vl),of(this,af,void 0),of(this,__,void 0),of(this,PL,void 0),of(this,VM,void 0),of(this,Mc,!0),of(this,kv,{}),of(this,Sy,{}),ko(__,this,e),ko(VM,this,r)}isClassicTheme(){return Si(Mc,this)}getCSSVariableValue(e){var r;if(Si(Mc,this))return null;if(Si(kv,this)[`--ht-${e}`])return Si(kv,this)[`--ht-${e}`];const n=(r=Ca(vl,this,GVe).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Ca(vl,this,jJ).call(this,`--ht-${e}`);if(n!==null)return Si(kv,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Si(Sy,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Si(Mc,this))return J8;const e=Ca(vl,this,UVe).call(this);return e||J8}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){ko(af,this,void 0),ko(Mc,this,!0),Ca(vl,this,DP).call(this);return}if(e&&e!==Si(af,this)){if(!/ht-theme-.*/.test(e)){Ut(`Invalid theme name: ${e}. Please provide a valid theme name.`),ko(af,this,void 0),ko(Mc,this,!1),Ca(vl,this,DP).call(this);return}Si(af,this)&&Ca(vl,this,YVe).call(this),ko(af,this,e),ko(Mc,this,!1),Ca(vl,this,DP).call(this)}}getThemeName(){return Si(af,this)}}function UVe(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function DP(){this.isClassicTheme()||ko(PL,this,getComputedStyle(Si(__,this)));const t=Ca(vl,this,zVe).call(this,["box-sizing","border-bottom-width"]);Si(Sy,this).td={...Si(Sy,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function zVe(t){const e=Si(VM,this),r=Si(__,this),n=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function GVe(t){const e=Math.ceil(parseFloat(Ca(vl,this,jJ).call(this,t)));return Number.isNaN(e)?null:e}function jJ(t){const e=Si(PL,this).getPropertyValue(t);return e===""?null:e}function YVe(){ko(Sy,this,{}),ko(kv,this,{}),ko(Mc,this,!0)}function KVe(t,e){UJ(t,e),e.add(t)}function Q8(t,e,r){UJ(t,e),e.set(t,r)}function UJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z8(t,e){return t.get(Cp(t,e))}function e6(t,e,r){return t.set(Cp(t,e),r),r}function Cp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var WM=new WeakMap,jM=new WeakMap,sw=new WeakSet;class XVe{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;KVe(this,sw),Q8(this,WM,void 0),Q8(this,jM,void 0),e6(WM,this,r),e6(jM,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Cp(sw,this,t6).call(this,e.from,r,n);if(i===null)return null;const s=Cp(sw,this,t6).call(this,e.to,-r,-n);if(s===null)return null;const o=e.clone();return o.from=i,o.to=s,o.includes(e.highlight)||(o.highlight=i),o}}function t6(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=Cp(sw,this,r6).call(this,Z8(WM,this),t.row,e);if(n===null)return null;const i=Cp(sw,this,r6).call(this,Z8(jM,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function r6(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let FP=null;const HP=new Map;function zJ(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new $a(s);let a,l,u,c,h,f,d=!0;u4e(i)&&l4e(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=im(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,im(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Se(this.rootElement,"ht-wrapper"),Se(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),Se(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",m=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new jVe(s.rootElement,s.rootDocument),e.language=y3e(e.language);const p=Object.fromEntries(Object.entries(e).filter(C=>{let[S]=C;return!(Fe.getSingleton().isRegistered(S)||Fe.getSingleton().isDeprecated(S))})),w=new FJ(s,p,[yBe,RBe]),v=w.getTableMeta(),y=w.getGlobalMeta(),b=AR();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),im(this)&&N2e(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${rq()}`,HP.set(this.guid,this),this.columnIndexMapper=new FM,this.rowIndexMapper=new FM,this.columnIndexMapper.addLocalHook("indexesSequenceChange",C=>{s.runHooks("afterColumnSequenceChange",C)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",C=>{s.runHooks("afterRowSequenceChange",C)}),o.addEventListener(this.rootDocument.documentElement,"compositionstart",C=>{s.runHooks("beforeCompositionStart",C)}),l=new A4e(s);const T=Qo(this.guid);T.register("cellRangeMapper",new XVe({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const E=C=>{const{row:S,col:_}=C;return s._createCellCoords(S>=0?s.rowIndexMapper.getRenderableFromVisualIndex(S):S,_>=0?s.columnIndexMapper.getRenderableFromVisualIndex(_):_)},x=C=>{const{row:S,col:_}=C;return s._createCellCoords(S>=0?s.rowIndexMapper.getVisualFromRenderableIndex(S):S,_>=0?s.columnIndexMapper.getVisualFromRenderableIndex(_):_)},P=(C,S)=>{const _=S>C?1:-1,D=Math.min(C,S),U=Math.max(C,S),X=s.rowIndexMapper.getNearestNotHiddenIndex(C,_);return X===null||_===1&&X>U||_===-1&&X<D?null:X>=0?s.rowIndexMapper.getRenderableFromVisualIndex(X):X},A=(C,S)=>{const _=S>C?1:-1,D=Math.min(C,S),U=Math.max(C,S),X=s.columnIndexMapper.getNearestNotHiddenIndex(C,_);return X===null||_===1&&X>U||_===-1&&X<D?null:X>=0?s.columnIndexMapper.getRenderableFromVisualIndex(X):X};let O=new MJ(v,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:C=>a.propToCol(C),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(C,S)=>s._createCellCoords(C,S),createCellRange:(C,S,_)=>s._createCellRange(C,S,_),visualToRenderableCoords:E,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:P,findFirstNonHiddenRenderableColumn:A,isDisabledCellSelection:(C,S)=>C<0||S<0?s.getSettings().disableVisualSelection:s.getCellMeta(C,S).disableVisualSelection});this.selection=O;const Y=C=>{let{hiddenIndexesChanged:S}=C;this.forceFullRender=!0,S&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Y),this.rowIndexMapper.addLocalHook("cacheUpdated",Y),this.selection.addLocalHook("afterSetRangeEnd",(C,S)=>{const _=Zs(!1),D=this.selection.getSelectedRange(),{from:U,to:X}=D.current(),ee=D.size()-1;this.runHooks("afterSelection",U.row,U.col,X.row,X.col,_,ee),this.runHooks("afterSelectionByProp",U.row,s.colToProp(U.col),X.row,s.colToProp(X.col),_,ee),S&&(!_.isTouched()||_.isTouched()&&!_.value)&&f.scrollTo(C);const k=O.isSelectedByRowHeader(),M=O.isSelectedByColumnHeader();k&&M?Se(this.rootElement,["ht__selection--rows","ht__selection--columns"]):k?(qe(this.rootElement,"ht__selection--columns"),Se(this.rootElement,"ht__selection--rows")):M?(qe(this.rootElement,"ht__selection--rows"),Se(this.rootElement,"ht__selection--columns")):qe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(O.getSelectionSource())||c.closeEditor(null),O.getSelectionSource()!=="refresh"&&(s.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",C=>{this.runHooks("beforeSelectionFocusSet",C.row,C.col)}),this.selection.addLocalHook("afterSetFocus",C=>{const S=Zs(!1);this.runHooks("afterSelectionFocusSet",C.row,C.col,S),(!S.isTouched()||S.isTouched()&&!S.value)&&f.scrollTo(C),c.closeEditor(),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",C=>{const S=C.length-1,{from:_,to:D}=C[S];this.runHooks("afterSelectionEnd",_.row,_.col,D.row,D.col,S),this.runHooks("afterSelectionEndByProp",_.row,s.colToProp(_.col),D.row,s.colToProp(D.col),S),O.getSelectionSource()==="refresh"&&(s.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",C=>{const S=this.runHooks("afterIsMultipleSelection",C.value);C.value&&(C.value=S)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),s.view.render(),qe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSetRangeStart",...S)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSetRangeStartOnly",...S)}).addLocalHook("beforeSetRangeEnd",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSetRangeEnd",...S)}).addLocalHook("beforeSelectColumns",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSelectColumns",...S)}).addLocalHook("afterSelectColumns",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterSelectColumns",...S)}).addLocalHook("beforeSelectRows",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSelectRows",...S)}).addLocalHook("afterSelectRows",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterSelectRows",...S)}).addLocalHook("beforeModifyTransformStart",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("modifyTransformStart",...S)}).addLocalHook("afterModifyTransformStart",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterModifyTransformStart",...S)}).addLocalHook("beforeModifyTransformFocus",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("modifyTransformFocus",...S)}).addLocalHook("afterModifyTransformFocus",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterModifyTransformFocus",...S)}).addLocalHook("beforeModifyTransformEnd",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("modifyTransformEnd",...S)}).addLocalHook("afterModifyTransformEnd",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterModifyTransformEnd",...S)}).addLocalHook("beforeRowWrap",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeRowWrap",...S)}).addLocalHook("beforeColumnWrap",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeColumnWrap",...S)}).addLocalHook("insertRowRequire",C=>this.alter("insert_row_above",C,1,"auto")).addLocalHook("insertColRequire",C=>this.alter("insert_col_start",C,1,"auto")),u={alter(C,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;const X=ee=>{if(ee.length===0)return[];const k=[...ee];return k.sort((R,V)=>{let[q]=R,[J]=V;return q===J?0:q>J?1:-1}),Ms(k,(R,V)=>{let[q,J]=V;const re=R[R.length-1],[B,te]=re,oe=B+te;if(q<=oe){const ae=Math.max(J-(oe-q),0);re[1]+=ae}else R.push([q,J]);return R},[k[0]])};switch(C){case"insert_row_below":case"insert_row_above":const ee=s.countSourceRows();if(v.maxRows===ee)return;const k=C==="insert_row_below"?"below":"above";S=S??(k==="below"?ee:0);const{delta:M,startPhysicalIndex:R}=a.createRow(S,_,{source:D,mode:k});O.shiftRows(s.toVisualRow(R),M);break;case"insert_col_start":case"insert_col_end":const V=C==="insert_col_end"?"end":"start";S=S??(V==="end"?s.countSourceCols():0);const{delta:q,startPhysicalIndex:J}=a.createCol(S,_,{source:D,mode:V});if(q){if(Array.isArray(v.colHeaders)){const te=[s.toVisualColumn(J),0];te.length+=q,Array.prototype.splice.apply(v.colHeaders,te)}O.shiftColumns(s.toVisualColumn(J),q)}break;case"remove_row":const re=te=>{let oe=0;Z(te,ae=>{let[fe,Me]=ae;const Ne=an(fe)?s.countRows()-1:Math.max(fe-oe,0);if(Number.isInteger(fe)&&(fe=Math.max(fe-oe,0)),!a.removeRow(fe,Me,D))return;if(O.isSelected()){const{row:We}=s.getSelectedRangeLast().highlight;We>=fe&&We<=fe+Me-1&&c.closeEditor(!0)}const st=s.countRows(),ot=v.fixedRowsTop;ot>=Ne+1&&(v.fixedRowsTop-=Math.min(Me,ot-Ne));const tt=v.fixedRowsBottom;if(tt&&Ne>=st-tt&&(v.fixedRowsBottom-=Math.min(Me,tt)),st===0)O.deselect();else if(D==="ContextMenu.removeRow"){const We=O.getSelectedRange(),ht=We.pop();We.clear().set(ht.from).current().setTo(ht.to),O.refresh()}else O.shiftRows(fe,-Me);oe+=Me})};Array.isArray(S)?re(X(S)):re([[S,_]]);break;case"remove_col":const B=te=>{let oe=0;Z(te,ae=>{let[fe,Me]=ae;const Ne=an(fe)?s.countCols()-1:Math.max(fe-oe,0);let ze=s.toPhysicalColumn(Ne);if(Number.isInteger(fe)&&(fe=Math.max(fe-oe,0)),!a.removeCol(fe,Me,D))return;if(O.isSelected()){const{col:We}=s.getSelectedRangeLast().highlight;We>=fe&&We<=fe+Me-1&&c.closeEditor(!0)}if(s.countCols()===0)O.deselect();else if(D==="ContextMenu.removeColumn"){const We=O.getSelectedRange(),ht=We.pop();We.clear().set(ht.from).current().setTo(ht.to),O.refresh()}else O.shiftColumns(fe,-Me);const tt=v.fixedColumnsStart;tt>=Ne+1&&(v.fixedColumnsStart-=Math.min(Me,tt-Ne)),Array.isArray(v.colHeaders)&&(typeof ze>"u"&&(ze=-1),v.colHeaders.splice(ze,Me)),oe+=Me})};Array.isArray(S)?B(X(S)):B([[S,_]]);break;default:throw new Error(`There is no such action "${C}"`)}U||u.adjustRowsAndCols(),s.view.render(),s.view.adjustElementsSize()},adjustRowsAndCols(){const C=v.minRows,S=v.minSpareRows,_=v.minCols,D=v.minSpareCols;if(C){const U=s.countRows();U<C&&a.createRow(U,C-U,{source:"auto"})}if(S){const U=s.countEmptyRows(!0);if(U<S){const X=S-U,ee=Math.min(X,v.maxRows-s.countSourceRows());a.createRow(s.countRows(),ee,{source:"auto"})}}{let U;(_||D)&&(U=s.countEmptyCols(!0));let X=s.countCols();if(_&&!v.columns&&X<_){const ee=_-X;U+=ee,a.createCol(X,ee,{source:"auto"})}if(D&&!v.columns&&s.dataType==="array"&&U<D){X=s.countCols();const ee=D-U,k=Math.min(ee,v.maxCols-X);a.createCol(X,k,{source:"auto"})}}},populateFromArray(C,S,_,D,U){let X,ee,k,M;const R=[],V={},q=[],J=C.row,re=C.col;if(ee=S.length,ee===0)return!1;let B=0,te=0;switch(yt(_)&&(B=_.col-re+1,te=_.row-J+1),U){case"shift_down":const oe=Wx(S),ae=oe.length,fe=Math.max(ae,B),Me=s.getData().slice(J),Ne=Wx(Me).slice(re,re+fe);for(k=0;k<fe;k+=1)if(k<ae){for(X=0,ee=oe[k].length;X<te-ee;X+=1)oe[k].push(oe[k][X%ee]);k<Ne.length?q.push(oe[k].concat(Ne[k])):q.push(oe[k].concat(new Array(Me.length).fill(null)))}else q.push(oe[k%ae].concat(Ne[k]));s.populateFromArray(J,re,Wx(q));break;case"shift_right":const ze=S.length,st=Math.max(ze,te),ot=s.getData().slice(J).map($t=>$t.slice(re));for(X=0;X<st;X+=1)if(X<ze){for(k=0,M=S[X].length;k<B-M;k+=1)S[X].push(S[X][k%M]);if(X<ot.length)for(let $t=0;$t<ot[X].length;$t+=1)S[X].push(ot[X][$t]);else S[X].push(...new Array(ot[0].length).fill(null))}else S.push(S[X%ee].slice(0,st).concat(ot[X]));s.populateFromArray(J,re,S);break;case"overwrite":default:V.row=C.row,V.col=C.col;let tt=0,We=0,ht=!0,Qe;const Xt=function(dr){let cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Mt=S[dr%S.length];return cr!==null?Mt[cr%Mt.length]:Mt},Or=S.length,St=_?_.row-C.row+1:0;for(_?ee=St:ee=Math.max(Or,St),X=0;X<ee&&!(_&&V.row>_.row&&St>Or||!v.allowInsertRow&&V.row>s.countRows()-1||V.row>=v.maxRows);X++){const $t=X-tt,dr=Xt($t).length,cr=_?_.col-C.col+1:0;if(_?M=cr:M=Math.max(dr,cr),V.col=C.col,Qe=s.getCellMeta(V.row,V.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Qe.skipRowOnPaste){tt+=1,V.row+=1,ee+=1;continue}for(We=0,k=0;k<M&&!(_&&V.col>_.col&&cr>dr||!v.allowInsertColumn&&V.col>s.countCols()-1||V.col>=v.maxCols);k++){if(Qe=s.getCellMeta(V.row,V.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Qe.skipColumnOnPaste){We+=1,V.col+=1,M+=1;continue}if(Qe.readOnly&&D!=="UndoRedo.undo"){V.col+=1;continue}const Mt=k-We;let Fi=Xt($t,Mt),Un=s.getDataAtCell(V.row,V.col);if(Fi!==null&&typeof Fi=="object")if(Array.isArray(Fi)&&Un===null&&(Un=[]),Un===null||typeof Un!="object")ht=!1;else{const Ua=py(Array.isArray(Un)?Un:Un[0]||Un),og=py(Array.isArray(Fi)?Fi:Fi[0]||Fi);EF(Ua,og)||Array.isArray(Ua)&&Array.isArray(og)?Fi=rs(Fi):ht=!1}else Un!==null&&typeof Un=="object"&&(ht=!1);ht&&R.push([V.row,V.col,Fi]),ht=!0,V.col+=1}V.row+=1}s.setDataAtCell(R,null,null,D||"populateFromArray");break}}};function L(C){const S=SJ(C);RL(S)?(s.runHooks("beforeLanguageChange",S),y.language=S,s.runHooks("afterLanguageChange",S)):xJ(C)}function ie(C,S){const _=C==="className"?s.rootElement:s.table;if(d)Se(_,S);else{let D=[],U=[];y[C]&&(D=Array.isArray(y[C])?y[C]:SW(y[C])),S&&(U=Array.isArray(S)?S:SW(S));const X=CW(D,U),ee=CW(U,D);X.length&&qe(_,X),ee.length&&Se(_,ee)}y[C]=S}this.init=function(){l.setData(v.data),s.runHooks("beforeInit"),(Al()||yq())&&Se(s.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new d4e(this);const C=v.themeName||q8(s.rootContainer);s.useTheme(C),c=IM.getInstance(s,v,O),f=DVe(s),h=new $De(s),im(this)&&RVe(s),s.runHooks("init"),this.render(),d&&s.rootElement.offsetParent===null&&BNe(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof d=="object"&&(s.runHooks("afterChange",d[0],d[1]),d=!1),s.runHooks("afterInit")};function ce(){let C=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,C=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&C===!1&&(C=!0,this.onQueueEmpty(this.valid))}}}function he(C){const S=C.replace(",",".");return isNaN(parseFloat(S))===!1?parseFloat(S):C}function Ee(C,S,_){if(!C.length){_();return}const D=s.getActiveEditor(),U=new ce;let X=!0;U.onQueueEmpty=()=>{D&&X&&D.cancelChanges(),_()};for(let ee=C.length-1;ee>=0;ee--){const[k,M]=C[ee],R=a.propToCol(M);let V;Number.isInteger(R)?V=s.getCellMeta(k,R):V={...Object.getPrototypeOf(v),...v},s.getCellValidator(V)&&(U.addValidatorToQueue(),s.validateCell(C[ee][3],V,function(q,J){return function(re){if(typeof re!="boolean")throw new Error("Validation error: result is not boolean");re===!1&&J.allowInvalid===!1&&(X=!1,C.splice(q,1),J.valid=!0),U.removeValidatorFormQueue()}}(ee,V),S))}U.checkIfQueueIsEmpty()}function Ce(C,S){for(let D=C.length-1;D>=0;D--){let U=!1;if(C[D]===null){C.splice(D,1);continue}if(!((C[D][2]===null||C[D][2]===void 0)&&(C[D][3]===null||C[D][3]===void 0))){if(v.allowInsertRow)for(;C[D][0]>s.countRows()-1;){const{delta:X}=a.createRow(void 0,void 0,{source:"auto"});if(X===0){U=!0;break}}if(s.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(C[D][1])>s.countCols()-1;){const{delta:X}=a.createCol(void 0,void 0,{source:"auto"});if(X===0){U=!0;break}}U||a.set(C[D][0],C[D][1],C[D][3])}}if(C.length>0){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",C,S),c.closeEditor(),s.render(),c.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",C,S||"edit");const D=s.getActiveEditor();D&&Le(D.refreshValue)&&D.refreshValue()}else s.render()}this._createCellCoords=function(C,S){return s.view._wt.createCellCoords(C,S)},this._createCellRange=function(C,S,_){return s.view._wt.createCellRange(C,S,_)},this.validateCell=function(C,S,_,D){let U=s.getCellValidator(S);function X(ee){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||S.hidden===!0){_(ee);return}const M=S.visualCol,R=S.visualRow,V=s.getCell(R,M,!0);if(V&&V.nodeName!=="TH"){const q=s.rowIndexMapper.getRenderableFromVisualIndex(R),J=s.columnIndexMapper.getRenderableFromVisualIndex(M);s.view._wt.getSetting("cellRenderer",q,J,V)}_(ee)}I2e(U)&&(U=function(ee){return function(k,M){M(ee.test(k))}}(U)),Zt(U)?(C=s.runHooks("beforeValidate",C,S.visualRow,S.prop,D),s._registerImmediate(()=>{U.call(S,C,ee=>{s&&(ee=s.runHooks("afterValidate",ee,C,S.visualRow,S.prop,D),S.valid=ee,X(ee),s.runHooks("postAfterValidate",ee,C,S.visualRow,S.prop,D))})})):s._registerImmediate(()=>{S.valid=!0,X(S.valid,!1)})};function ge(C,S,_){return Array.isArray(C)?C:[[C,S,_]]}function Q(C,S){const _=s.runHooks("beforeChange",C,S||"edit"),D=C.filter(X=>X!==null);if(_===!1||D.length===0){var U;return(U=s.getActiveEditor())===null||U===void 0||U.cancelChanges(),[]}for(let X=D.length-1;X>=0;X--){const[ee,k,,M]=D[X],R=a.propToCol(k);let V;Number.isInteger(R)?V=s.getCellMeta(ee,R):V={...Object.getPrototypeOf(v),...v};const{type:q,checkedTemplate:J,uncheckedTemplate:re}=V;if(q==="numeric"&&typeof M=="string"&&DFe(M)&&(D[X][3]=he(M)),q==="checkbox"){const B=Fr(M),te=B===Fr(J),oe=B===Fr(re);(te||oe)&&(D[X][3]=te?J:re)}}return D}this.setDataAtCell=function(C,S,_,D){const U=ge(C,S,_),X=[];let ee=D,k,M,R;for(k=0,M=U.length;k<M;k++){if(typeof U[k]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof U[k][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");U[k][1]>=this.countCols()?R=U[k][1]:R=a.colToProp(U[k][1]),X.push([U[k][0],R,l.getAtCell(this.toPhysicalRow(U[k][0]),U[k][1]),U[k][2]])}!ee&&typeof C=="object"&&(ee=S);const V=Q(X,ee);s.runHooks("afterSetDataAtCell",V,ee),Ee(V,ee,()=>{Ce(V,ee)})},this.setDataAtRowProp=function(C,S,_,D){const U=ge(C,S,_),X=[];let ee=D,k,M;for(k=0,M=U.length;k<M;k++)X.push([U[k][0],U[k][1],l.getAtCell(this.toPhysicalRow(U[k][0]),U[k][1]),U[k][2]]);!ee&&typeof C=="object"&&(ee=S);const R=Q(X,D);s.runHooks("afterSetDataAtRowProp",R,ee),Ee(R,ee,()=>{Ce(R,ee)})},this.listen=function(){s&&!s.isListening()&&(HP.forEach(C=>{s!==C&&C.unlisten()}),FP=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(FP=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return FP===s.guid},this.destroyEditor=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(C),s.view.render(),S&&O.isSelected()&&c.prepareEditor()},this.populateFromArray=function(C,S,_,D,U,X,ee){if(!(typeof _=="object"&&typeof _[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const k=typeof D=="number"?s._createCellCoords(D,U):null;return u.populateFromArray(s._createCellCoords(C,S),_,k,X,ee)},this.spliceCol=function(C,S,_){for(var D=arguments.length,U=new Array(D>3?D-3:0),X=3;X<D;X++)U[X-3]=arguments[X];return a.spliceCol(C,S,_,...U)},this.spliceRow=function(C,S,_){for(var D=arguments.length,U=new Array(D>3?D-3:0),X=3;X<D;X++)U[X-3]=arguments[X];return a.spliceRow(C,S,_,...U)},this.getSelected=function(){if(O.isSelected())return Pt(O.getSelectedRange(),C=>{let{from:S,to:_}=C;return[S.row,S.col,_.row,_.col]})},this.getSelectedLast=function(){const C=this.getSelected();let S;return C&&C.length>0&&(S=C[C.length-1]),S},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){const C=this.getSelectedRange();let S;return C&&C.length>0&&(S=C[C.length-1]),S},this.emptySelectedCells=function(C){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;const S=[];Z(O.getSelectedRange(),_=>{if(_.isSingleHeader())return;const D=_.getTopStartCorner(),U=_.getBottomEndCorner();je(D.row,U.row,X=>{je(D.col,U.col,ee=>{this.getCellMeta(X,ee).readOnly||S.push([X,ee,null])})})}),S.length>0&&this.setDataAtCell(S,C)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const C=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(C,0),!this.isRenderSuspended()&&C===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(C){this.suspendRender();const S=C();return this.resumeRender(),S},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(S,0),(!this.isExecutionSuspended()&&S===this.executionSuspendedCounter||C)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const _=C();return this.resumeExecution(S),_},this.batch=function(C){this.suspendRender(),this.suspendExecution();const S=C();return this.resumeExecution(),this.resumeRender(),S},this.refreshDimensions=function(){if(!s.view)return;const C=s.view,{width:S,height:_}=C.getLastSize(),{width:D,height:U}=s.rootElement.getBoundingClientRect(),X=D!==S||U!==_;s.runHooks("beforeRefreshDimensions",{width:S,height:_},{width:D,height:U},X)!==!1&&((X||C._wt.wtOverlays.scrollableElement===s.rootWindow)&&(C.setLastSize(D,U),s.render(),C.adjustElementsSize()),s.runHooks("afterRefreshDimensions",{width:S,height:_},{width:D,height:U},X))},this.updateData=function(C,S){U8(C,_=>{a=_},_=>{a=_,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),O.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:S,metaManager:w,firstRun:d})},this.loadData=function(C,S){U8(C,_=>{a=_},()=>{w.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),O.refresh(),d&&(d=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:S,metaManager:w,firstRun:d})},this.getInitialColumnCount=function(){const C=v.columns;let S=0;if(Array.isArray(C))S=C.length;else if(Zt(C))if(s.dataType==="array"){const _=this.countSourceCols();for(let D=0;D<_;D+=1)C(D)&&(S+=1)}else(s.dataType==="object"||s.dataType==="function")&&(S=a.colToPropCache.length);else if(Le(v.dataSchema)){const _=a.getSchema();S=Array.isArray(_)?_.length:RF(_)}else S=this.countSourceCols();return S},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(C,S,_,D){return Dr(C)?a.getAll():a.getRange(s._createCellCoords(C,S),s._createCellCoords(_,D),a.DESTINATION_RENDERER)},this.getCopyableText=function(C,S,_,D){return a.getCopyableText(s._createCellCoords(C,S),s._createCellCoords(_,D))},this.getCopyableData=function(C,S){return a.getCopyable(C,a.colToProp(S))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const _=(d?s.loadData:s.updateData).bind(this);let D=!1,U,X;if(Le(C.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Le(C.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Le(C.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');C.language&&L(C.language);for(U in C)if(!(U==="data"||U==="language"))if(U==="className")ie("className",C.className);else if(U==="tableClassName"&&s.table)ie("tableClassName",C.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(Fe.getSingleton().isRegistered(U)||Fe.getSingleton().isDeprecated(U)){const V=C[U];Zt(V)?(Fe.getSingleton().addAsFixed(U,V,s),v[U]=V):Array.isArray(V)&&(Fe.getSingleton().add(U,V,s),v[U]=V)}else!S&&Pn(C,U)&&(y[U]=C[U]);C.data===void 0&&v.data===void 0?_(null,"updateSettings"):C.data!==void 0?_(C.data,"updateSettings"):C.columns!==void 0&&(a.createMap(),s.initIndexMappers());const ee=s.countCols(),k=v.columns;if(k&&Zt(k)&&(D=!0),(C.cell!==void 0||C.cells!==void 0||C.columns!==void 0)&&w.clearCache(),ee>0)for(U=0,X=0;U<ee;U++){if(k){const V=D?k(U):k[X];V&&w.updateColumnMeta(X,V)}X+=1}Le(C.cell)&&Ct(C.cell,V=>{s.setCellMetaObject(V.row,V.col,V)}),s.runHooks("afterCellMetaReset");let M=s.rootElement.style.height;M!==""&&(M=parseInt(s.rootElement.style.height,10));let R=C.height;if(Zt(R)&&(R=R()),S&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),R===null){const V=s.rootElement.getAttribute("data-initialstyle");V&&(V.indexOf("height")>-1||V.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",V):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else R!==void 0&&(s.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,s.rootElement.style.overflow="hidden");if(typeof C.width<"u"){let V=C.width;Zt(V)&&(V=V()),s.rootElement.style.width=isNaN(V)?`${V}`:`${V}px`}if(!S){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const V=s.getCurrentThemeName();Pn(C,"themeName")&&V!==C.themeName&&s.useTheme(C.themeName)}s.runHooks("afterUpdateSettings",C)}u.adjustRowsAndCols(),s.view&&!d&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!S&&s.view&&(M===""||R===""||R===void 0)&&M!==R&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const C=s.getSelectedLast();if(v.getValue){if(Zt(v.getValue))return v.getValue.call(s);if(C)return s.getData()[C[0][0]][v.getValue]}else if(C)return s.getDataAtCell(C[0],C[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(C,S,_,D,U){u.alter(C,S,_,D,U)},this.getCell=function(C,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=S,U=C;if(S>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(S)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(S)}if(C>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(C)))return null;U=this.rowIndexMapper.getRenderableFromVisualIndex(C)}return U===null||D===null||U===void 0||D===void 0?null:s.view.getCellAtCoords(s._createCellCoords(U,D),_)},this.getCoords=function(C){const S=this.view._wt.wtTable.getCoords(C);if(S===null)return null;const{row:_,col:D}=S;let U=_,X=D;return _>=0&&(U=this.rowIndexMapper.getVisualFromRenderableIndex(_)),D>=0&&(X=this.columnIndexMapper.getVisualFromRenderableIndex(D)),s._createCellCoords(U,X)},this.colToProp=function(C){return a.colToProp(C)},this.propToCol=function(C){return a.propToCol(C)},this.toVisualRow=C=>this.rowIndexMapper.getVisualFromPhysicalIndex(C),this.toVisualColumn=C=>this.columnIndexMapper.getVisualFromPhysicalIndex(C),this.toPhysicalRow=C=>this.rowIndexMapper.getPhysicalFromVisualIndex(C),this.toPhysicalColumn=C=>this.columnIndexMapper.getPhysicalFromVisualIndex(C),this.getDataAtCell=function(C,S){return a.get(C,a.colToProp(S))},this.getDataAtRowProp=function(C,S){return a.get(C,S)},this.getDataAtCol=function(C){const S=[],_=a.getRange(s._createCellCoords(0,C),s._createCellCoords(v.data.length-1,C),a.DESTINATION_RENDERER);for(let D=0;D<_.length;D+=1)for(let U=0;U<_[D].length;U+=1)S.push(_[D][U]);return S},this.getDataAtProp=function(C){const S=[],_=a.getRange(s._createCellCoords(0,a.propToCol(C)),s._createCellCoords(v.data.length-1,a.propToCol(C)),a.DESTINATION_RENDERER);for(let D=0;D<_.length;D+=1)for(let U=0;U<_[D].length;U+=1)S.push(_[D][U]);return S},this.getSourceData=function(C,S,_,D){let U;return C===void 0?U=l.getData():U=l.getByRange(s._createCellCoords(C,S),s._createCellCoords(_,D)),U},this.getSourceDataArray=function(C,S,_,D){let U;return C===void 0?U=l.getData(!0):U=l.getByRange(s._createCellCoords(C,S),s._createCellCoords(_,D),!0),U},this.getSourceDataAtCol=function(C){return l.getAtColumn(C)},this.setSourceDataAtCell=function(C,S,_,D){const U=ge(C,S,_),X=this.hasHook("afterSetSourceDataAtCell"),ee=[];X&&Z(U,M=>{let[R,V,q]=M;ee.push([R,V,l.getAtCell(R,V),q])}),Z(U,M=>{let[R,V,q]=M;l.setAtCell(R,V,q)}),X&&this.runHooks("afterSetSourceDataAtCell",ee,D),this.render();const k=s.getActiveEditor();k&&Le(k.refreshValue)&&k.refreshValue()},this.getSourceDataAtRow=function(C){return l.getAtRow(C)},this.getSourceDataAtCell=function(C,S){return l.getAtCell(C,S)},this.getDataAtRow=function(C){return a.getRange(s._createCellCoords(C,0),s._createCellCoords(C,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(C,S,_,D){const U=C===void 0?[0,0,this.countRows(),this.countCols()]:[C,S,_,D],[X,ee]=U;let[,,k,M]=U,R=null,V=null;k===void 0&&(k=X),M===void 0&&(M=ee);let q="mixed";return je(Math.max(Math.min(X,k),0),Math.max(X,k),J=>{let re=!0;return je(Math.max(Math.min(ee,M),0),Math.max(ee,M),B=>(V=this.getCellMeta(J,B).type,R?re=R===V:R=V,re)),q=re?V:"mixed",re}),q},this.removeCellMeta=function(C,S,_){const[D,U]=[this.toPhysicalRow(C),this.toPhysicalColumn(S)];let X=w.getCellMetaKeyValue(D,U,_);s.runHooks("beforeRemoveCellMeta",C,S,_,X)!==!1&&(w.removeCellMeta(D,U,_),s.runHooks("afterRemoveCellMeta",C,S,_,X)),X=null},this.spliceCellsMeta=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var _=arguments.length,D=new Array(_>2?_-2:0),U=2;U<_;U++)D[U-2]=arguments[U];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");S>0&&w.removeRow(this.toPhysicalRow(C),S),D.length>0&&Z(D.reverse(),X=>{w.createRow(this.toPhysicalRow(C)),Z(X,(ee,k)=>this.setCellMetaObject(C,k,ee))}),s.render()},this.setCellMetaObject=function(C,S,_){typeof _=="object"&&Ct(_,(D,U)=>{this.setCellMeta(C,S,U,D)})},this.setCellMeta=function(C,S,_,D){if(s.runHooks("beforeSetCellMeta",C,S,_,D)===!1)return;let X=C,ee=S;C<this.countRows()&&(X=this.toPhysicalRow(C)),S<this.countCols()&&(ee=this.toPhysicalColumn(S)),w.setCellMeta(X,ee,_,D),s.runHooks("afterSetCellMeta",C,S,_,D)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(C,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},D=this.toPhysicalRow(C),U=this.toPhysicalColumn(S);return D===null&&(D=C),U===null&&(U=S),w.getCellMeta(D,U,{visualRow:C,visualColumn:S,..._})},this.getColumnMeta=function(C){return w.getColumnMeta(this.toPhysicalColumn(C))},this.getCellMetaAtRow=function(C){return w.getCellsMetaAtRow(C)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||v.columns)},this.getCellRenderer=function(C,S){const _=typeof C=="number"?s.getCellMeta(C,S).renderer:C.renderer;return typeof _=="string"?NM(_):Dr(_)?NM("text"):_},this.getCellEditor=function(C,S){const _=typeof C=="number"?s.getCellMeta(C,S).editor:C.editor;return typeof _=="string"?AM(_):Dr(_)?AM("text"):_},this.getCellValidator=function(C,S){const _=typeof C=="number"?s.getCellMeta(C,S).validator:C.validator;return typeof _=="string"?QFe(_):_},this.validateCells=function(C){this._validateCells(C)},this.validateRows=function(C,S){if(!Array.isArray(C))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(S,C)},this.validateColumns=function(C,S){if(!Array.isArray(C))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(S,void 0,C)},this._validateCells=function(C,S,_){const D=new ce;C&&(D.onQueueEmpty=C);let U=s.countRows()-1;for(;U>=0;){if(S!==void 0&&S.indexOf(U)===-1){U-=1;continue}let X=s.countCols()-1;for(;X>=0;){if(_!==void 0&&_.indexOf(X)===-1){X-=1;continue}D.addValidatorToQueue(),s.validateCell(s.getDataAtCell(U,X),s.getCellMeta(U,X),ee=>{if(typeof ee!="boolean")throw new Error("Validation error: result is not boolean");ee===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),X-=1}U-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(C){let S=v.rowHeaders,_=C;return _!==void 0&&(_=s.runHooks("modifyRowHeader",_)),_===void 0?(S=[],je(s.countRows()-1,D=>{S.push(s.getRowHeader(D))})):Array.isArray(S)&&S[_]!==void 0?S=S[_]:Zt(S)?S=S(_):S&&typeof S!="string"&&typeof S!="number"&&(S=_+1),S},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let C=0,S=s.countCols();C<S;C++)if(s.getColHeader(C))return!0;return!1},this.getColHeader=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const _=s.runHooks("modifyColHeader",C);if(_===void 0){const k=[],M=s.countCols();for(let R=0;R<M;R++)k.push(s.getColHeader(R));return k}let D=v.colHeaders;const U=function(k){const M=[],R=s.countCols();let V=0;for(;V<R;V++)Zt(v.columns)&&v.columns(V)&&M.push(V);return M[k]},X=s.toPhysicalColumn(_),ee=U(X);return v.colHeaders===!1?D=null:v.columns&&Zt(v.columns)&&v.columns(ee)&&v.columns(ee).title?D=v.columns(ee).title:v.columns&&v.columns[X]&&v.columns[X].title?D=v.columns[X].title:Array.isArray(v.colHeaders)&&v.colHeaders[X]!==void 0?D=v.colHeaders[X]:Zt(v.colHeaders)?D=v.colHeaders(X):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(D=E4e(_)),D=s.runHooks("modifyColumnHeaderValue",D,C,S),D},this._getColWidthFromSettings=function(C){let S;if(C>=0&&(S=s.getCellMeta(0,C).width),(S===void 0||S===v.width)&&(S=v.colWidths),S!=null){switch(typeof S){case"object":S=S[C];break;case"function":S=S(C);break}typeof S=="string"&&(S=parseInt(S,10))}return S},this.getColWidth=function(C,S){let _=s._getColWidthFromSettings(C);return _=s.runHooks("modifyColWidth",_,C,S),_===void 0&&(_=wp),_},this._getRowHeightFromSettings=function(C){const S=s.stylesHandler.getDefaultRowHeight();let _=v.rowHeights;if(_!=null){switch(typeof _){case"object":_=_[C];break;case"function":_=_(C);break}typeof _=="string"&&(_=parseInt(_,10))}return _!=null&&_<S?S:_},this.getRowHeight=function(C,S){let _=s._getRowHeightFromSettings(C);return _=s.runHooks("modifyRowHeight",_,C,S),_},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const C=v.maxCols,S=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(C,S)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return ZW(s.countRows()-1,_=>{if(s.isEmptyRow(_))S+=1;else if(C===!0)return!1}),S},this.countEmptyCols=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return ZW(s.countCols()-1,_=>{if(s.isEmptyCol(_))S+=1;else if(C===!0)return!1}),S},this.isEmptyRow=function(C){return v.isEmptyRow.call(s,C)},this.isEmptyCol=function(C){return v.isEmptyCol.call(s,C)},this.selectCell=function(C,S,_,D){let U=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,X=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Dr(C)||Dr(S)?!1:this.selectCells([[C,S,_,D]],U,X)},this.selectCells=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;S===!1&&f.suspend();const D=O.selectCells(C);return D&&_&&s.listen(),f.resume(),D},this.selectColumns=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,_=arguments.length>2?arguments[2]:void 0;return O.selectColumns(C,S,_)},this.selectRows=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,_=arguments.length>2?arguments[2]:void 0;return O.selectRows(C,S,_)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,_=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),O.selectAll(C,S,_)};const ye=(C,S)=>C.getNearestNotHiddenIndex(S,1,!0);this.scrollViewportTo=function(C,S){if(typeof C=="number"){var _;C={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(_=arguments[4])!==null&&_!==void 0?_:!0}}const{row:D,col:U,considerHiddenIndexes:X}=C??{};let ee=D,k=U;if(Zt(S)&&this.addHookOnce("afterScroll",S),X===void 0||X){const q=Number.isInteger(D)&&D>=0,J=Number.isInteger(U)&&U>=0,re=q?ye(this.rowIndexMapper,D):void 0,B=J?ye(this.columnIndexMapper,U):void 0;if(re===null||B===null)return!1;ee=q?s.rowIndexMapper.getRenderableFromVisualIndex(re):D,k=J?s.columnIndexMapper.getRenderableFromVisualIndex(B):U}const M=Number.isInteger(ee),R=Number.isInteger(k);let V=!1;return M&&ee>=0&&R&&k>=0?V=s.view.scrollViewport(s._createCellCoords(ee,k),C.horizontalSnap,C.verticalSnap):M&&ee>=0&&(R&&k<0||!R)?V=s.view.scrollViewportVertically(ee,C.verticalSnap):R&&k>=0&&(M&&ee<0||!M)&&(V=s.view.scrollViewportHorizontally(k,C.horizontalSnap)),Zt(S)&&(V?this.view.render():(this.removeHook("afterScroll",S),this._registerMicrotask(()=>S()))),V},this.scrollToFocusedCell=function(C){if(!this.selection.isSelected())return!1;Zt(C)&&this.addHookOnce("afterScroll",C);const{highlight:S}=this.getSelectedRangeLast(),_=this.scrollViewportTo(S.toObject());return _?this.view.render():Zt(C)&&(this.removeHook("afterScroll",C),this._registerMicrotask(()=>C())),_},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),T.clear(),w.clearCache(),HP.delete(this.guid),o.destroy(),c&&c.destroy(),s.rootContainer&&Ku(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),b.getItems().forEach(C=>{let[,S]=C;S.destroy()}),b.clear(),s.runHooks("afterDestroy")},!0),Fe.getSingleton().destroy(s),Ct(s,(C,S,_)=>{Zt(C)?_[S]=Re(S):S!=="guid"&&(_[S]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,O=null,c=null,s=null};function Re(C){return()=>{throw new Error(`The "${C}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(C){return b.getItem(La(C))},this.getPluginName=function(C){return C===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:b.getId(C)},this.getInstance=function(){return s},this.addHook=function(C,S,_){Fe.getSingleton().add(C,S,s,_)},this.hasHook=function(C){return Fe.getSingleton().has(C,s)||Fe.getSingleton().has(C)},this.addHookOnce=function(C,S,_){Fe.getSingleton().once(C,S,s,_)},this.removeHook=function(C,S){Fe.getSingleton().remove(C,S,s)},this.runHooks=function(C,S,_,D,U,X,ee){return Fe.getSingleton().run(s,C,S,_,D,U,X,ee)},this.getTranslatedPhrase=function(C,S){return kJ(v.language,C,S)},this.toHTML=()=>JW(this),this.toTableElement=()=>{const C=this.rootDocument.createElement("div");return C.insertAdjacentHTML("afterbegin",JW(this)),C.firstElementChild},this.timeouts=[],this.useTheme=C=>{const S=!!d;this.stylesHandler.useTheme(C);const _=this.stylesHandler.getThemeName();im(this)&&(qe(this.rootWrapperElement,/ht-theme-.*/g),qe(this.rootPortalElement,/ht-theme-.*/g),_&&(Se(this.rootWrapperElement,_),Se(this.rootPortalElement,_),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Ut(`The "${_}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),S||(s.render(),s.scrollViewportTo(0,0),q8(this.rootContainer)&&(qe(this.rootContainer,/ht-theme-.*/g),_&&Se(this.rootContainer,_))),this.runHooks("afterSetTheme",_,S)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=C;typeof _=="function"&&(_=setTimeout(_,S)),this.timeouts.push(_)},this._clearTimeouts=function(){Z(this.timeouts,C=>{clearTimeout(C)})},this.immediates=[],this._registerImmediate=function(C){this.immediates.push(setImmediate(C))},this._clearImmediates=function(){Z(this.immediates,C=>{clearImmediate(C)})},this._registerMicrotask=function(C){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||C()})},this._getEditorManager=function(){return c};const W=VVe({handleEvent(){return s.isListening()},beforeKeyDown:C=>this.runHooks("beforeKeyDown",C),afterKeyDown:C=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",C)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",C=>{C.ctrlKey===!1&&C.metaKey===!1&&W.releasePressedKeys()}),this.getShortcutManager=function(){return W},this.getFocusManager=function(){return h},Yq().forEach(C=>{const S=FF(C);b.addItem(C,new S(this))}),_Ve(s),W.setActiveContextName("grid"),Fe.getSingleton().run(s,"construct")}function n6(t,e,r){t.addEventListener(e,r,!1)}function i6(t,e,r){t.removeEventListener(e,r,!1)}function oS(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function GJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),s=t.createElement("span");let o;function a(){var h,f;i.textContent=r.textContent(o),s.style.position="absolute",s.style.fontSize=oS(o).fontSize,s.style.fontFamily=oS(o).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);const d=parseInt(((h=oS(o))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((f=oS(o))===null||f===void 0?void 0:f.paddingInlineEnd)||0,10),m=s.clientWidth+d+g+1;n.removeChild(s);const p=o.style;p.height=`${r.minHeight}px`,r.minWidth>m?p.width=`${r.minWidth}px`:m>r.maxWidth?p.width=`${r.maxWidth}px`:p.width=`${m}px`;const w=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>w?p.height=`${r.minHeight}px`:r.maxHeight<w?(p.height=`${r.maxHeight}px`,p.overflowY="visible"):p.height=`${w}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=o.clientHeight;else{const f=parseInt(h.minHeight,10);isNaN(f)||(r.minHeight=f)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{const f=parseInt(h.maxHeight,10);isNaN(f)||(r.maxHeight=f)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=o.clientWidth;else{const f=parseInt(h.minWidth,10);isNaN(f)||(r.minWidth=f)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{const f=parseInt(h.maxWidth,10);isNaN(f)||(r.maxWidth=f)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function c(h,f){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=h,u(f),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),d&&(n6(o,"input",a),n6(o,"keydown",l)),a()}return{init:c,resize:a,unObserve(){i6(o,"input",a),i6(o,"keydown",l)}}}function s6(t,e){const r=Rq(e),n=e.value.split(`
`);let i=r,s=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(s+=n[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),r<=l)break}RR(e,i)}function lf(t,e,r){return(e=qVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qVe(t){var e=JVe(t,"string");return typeof e=="symbol"?e:e+""}function JVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const QVe="ht_editor_visible",aS="ht_editor_hidden",o6="textEditor",ZVe="text";class sg extends Kp{static get EDITOR_TYPE(){return ZVe}constructor(e){super(e),lf(this,"eventManager",new $a(this)),lf(this,"autoResize",GJ(this.hot.rootDocument)),lf(this,"TEXTAREA",void 0),lf(this,"textareaStyle",void 0),lf(this,"TEXTAREA_PARENT",void 0),lf(this,"textareaParentStyle",void 0),lf(this,"layerClass",void 0),this.eventManager=new $a(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),jx(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,o){const a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==en.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===en.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),RR(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ze(this.TEXTAREA,[["data-hot-input",""],Vh(-1)]),Se(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Se(this.TEXTAREA_PARENT,"handsontableInputHolder"),et(this.TEXTAREA_PARENT,this.layerClass)&&qe(this.TEXTAREA_PARENT,this.layerClass),Se(this.TEXTAREA_PARENT,aS),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){PNe()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",qe(this.TEXTAREA_PARENT,this.layerClass),Se(this.TEXTAREA_PARENT,aS)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;je(e.length-1,n=>{const i=e[n];if(et(i,"handsontableEditor"))return r=!0,!1}),et(this.TEXTAREA_PARENT,aS)&&qe(this.TEXTAREA_PARENT,aS),r?(this.layerClass=QVe,Se(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Se(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==en.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){wq()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Le(this.hot.getSelected()),group:o6},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;s6(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;s6(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(o6)}}const eWe="base",tWe="htTextEllipsis";function _1(t,e,r,n,i,s,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&Se(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(TW())):a&&c.push(TW()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(kW())):(u.push(o.invalidCellClassName),a&&c.push(kW()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),o.textEllipsis&&l.push(tWe),qe(e,u),Se(e,l),zp(e,c),Ze(e,h)}_1.RENDERER_TYPE=eWe;const rWe="text";function uc(t,e,r,n,i,s,o){_1.apply(this,[t,e,r,n,i,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=Fr(a),o.trimWhitespace&&(a=a.trim()),Od(e,a)}uc.RENDERER_TYPE=rWe;const nWe="text",YJ={CELL_TYPE:nWe,editor:sg,renderer:uc};ha(YJ);bt.editors={BaseEditor:Kp};function bt(t,e){const r=new zJ(t,e||{},QF);return r.init(),r}bt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new zJ(t,e,QF)};bt.DefaultSettings=DJ();bt.hooks=Fe.getSingleton();bt.CellCoords=Nd;bt.CellRange=C1;bt.packageName="handsontable";bt.buildDate="10/07/2025 10:59:01";bt.version="16.0.1";bt.languages={dictionaryKeys:f3e,getLanguageDictionary:TJ,getLanguagesDictionaries:v3e,registerLanguageDictionary:RJ,getTranslatedPhrase:kJ};function UM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function iWe(t){if(Array.isArray(t))return UM(t)}function sWe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xy(t,e,r){return e=E_(e),fWe(t,KJ()?Reflect.construct(e,r||[],E_(t).constructor):e.apply(t,r))}function Sp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a6(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XJ(n.key),n)}}function xp(t,e,r){return e&&a6(t.prototype,e),r&&a6(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oWe(t,e,r){return(e=XJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E_(t){return E_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E_(t)}function by(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zM(t,e)}function KJ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KJ=function(){return!!t})()}function aWe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l6(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uWe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?l6(Object(r),!0).forEach(function(n){oWe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l6(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cWe(t,e){if(t==null)return{};var r,n,i=hWe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function hWe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function fWe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sWe(t)}function zM(t,e){return zM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},zM(t,e)}function dWe(t){return iWe(t)||aWe(t)||mWe(t)||lWe()}function gWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function XJ(t){var e=gWe(t,"string");return typeof e=="symbol"?e:e+""}function mWe(t,e){if(t){if(typeof t=="string")return UM(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?UM(t,e):void 0}}var LP=null,pWe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",vWe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",R_="global",wWe="hot-wrapper-editor-container";function yWe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function GM(t,e){var r=Ge.Children.toArray(t),n=Ge.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(s){return s.props[e]!==void 0})),i||null}function qJ(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function JJ(t,e){if(typeof t>"u"||e===null)return null;var r=ZJ(e.props,!1);return r.className="".concat(wWe," ").concat(r.className),zz.createPortal(Ge.createElement("div",Object.assign({},r),e),t.body)}function QJ(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:R_,n=GM(t,"hot-editor"),i=qJ(n);return n?Ge.cloneElement(n,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??R_,o)},editorColumnScope:r,isEditor:!0}):null}function CWe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;r||(r=document),LP||(LP=r.createDocumentFragment());var s=i??r.createElement("DIV");LP.appendChild(s);var o=Ge.cloneElement(t,uWe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:zz.createPortal(o,s,n),portalContainer:s}}function ZJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function SWe(){return typeof window<"u"}var eQ=function(){function t(){Sp(this,t)}return xp(t,null,[{key:"getSettings",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.prevProps,s=i===void 0?{}:i,o=n.isInit,a=o===void 0?!1:o,l=n.initOnlySettingKeys,u=l===void 0?[]:l,c=function(p){return!a&&u.includes(p)?s[p]===r[p]:!1},h={};if(r.settings){var f=r.settings;for(var d in f)f.hasOwnProperty(d)&&!c(d)&&(h[d]=f[d])}for(var g in r)g!=="settings"&&g!=="children"&&!c(g)&&r.hasOwnProperty(g)&&(h[g]=r[g]);return h}}])}(),xWe=function(t){function e(){return Sp(this,e),xy(this,e,arguments)}return by(e,t),xp(e,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!n.internalProps.includes(i)}).reduce(function(i,s){return i[s]=n.props[s],i},{})}},{key:"getLocalEditorElement",value:function(){return QJ(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=eQ.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),i=JJ(n,this.getLocalEditorElement());return Ge.createElement(Ge.Fragment,null,i)}}])}(Ge.Component),bWe=function(t){function e(){var r;return Sp(this,e),r=xy(this,e,arguments),r.state={portals:[]},r}return by(e,t),xp(e,[{key:"render",value:function(){return Ge.createElement(Ge.Fragment,null,this.state.portals)}}])}(Ge.Component),_We="16.0.1";function EWe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tQ={exports:{}},$P,u6;function RWe(){if(u6)return $P;u6=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return $P=t,$P}var BP,c6;function TWe(){if(c6)return BP;c6=1;var t=RWe();function e(){}function r(){}return r.resetWarningCache=e,BP=function(){function i(a,l,u,c,h,f){if(f!==t){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}i.isRequired=i;function s(){return i}var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},BP}tQ.exports=TWe()();var kWe=tQ.exports,VP=EWe(kWe),AL=function(t){function e(){var r;return Sp(this,e),r=xy(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return by(e,t),xp(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(vWe),null)},set:function(n){this.__hotInstance=n}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return SWe()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var i=this;return function(o,a,l,u,c,h,f){var d=i.getRenderedCellCache(),g=i.getPortalContainerCache(),m="".concat(l,"-").concat(u),p=o.guid,w="".concat(p,"-").concat(m),v="".concat(m,"-").concat(p);if(d.has(m)&&(a.innerHTML=d.get(m).innerHTML),a&&!a.getAttribute("ghost-table")){for(var y=i.portalCache.get(v),b=g.get(w);a.firstChild;)a.removeChild(a.firstChild);if(y&&b)a.appendChild(b);else{var T=CWe(n,{TD:a,row:l,col:u,prop:c,value:h,cellProperties:f,isRenderer:!0},a.ownerDocument,v,b),E=T.portal,x=T.portalContainer;g.set(w,x),a.appendChild(x),i.portalCache.set(v,E)}}return d.set(m,a),a}}},{key:"getEditorClass",value:function(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R_,o=qJ(n),a=(i=this.getEditorCache().get(o))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(n){var i=function(s){function o(a){var l;return Sp(this,o),l=xy(this,o,[a]),n.hotCustomEditorInstance=l,l.editorComponent=n,l}return by(o,s),xp(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(bt.editors.BaseEditor);return Object.getOwnPropertyNames(bt.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var o,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(o=n[s]).call.apply(o,[n].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return GM(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return QJ(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((n=this.hotInstance)===null||n===void 0||(n=n.getSettings())===null||n===void 0?void 0:n._initOnlySettings)||[],a=eQ.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:o}),l=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,u)a.editor=this.getEditorClass(u,R_);else{var c;this.props.editor||(c=this.props.settings)!==null&&c!==void 0&&c.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=AM("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var h;this.props.renderer||(h=this.props.settings)!==null&&h!==void 0&&h.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=NM("text")}return a}},{key:"displayAutoSizeWarning",value:function(n){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&yWe(pWe)}},{key:"setHotColumnSettings",value:function(n,i){this.columnSettings[i]=n}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:dWe(this.portalCache.values())})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new bt.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(n){this.clearCache();var i=this.createNewGlobalSettings(!1,n);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,i=function(c){return c.type===xWe},s=Ge.Children.toArray(this.props.children),o=s.filter(function(u){return i(u)}).map(function(u,c){return Ge.cloneElement(u,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:c,_getChildElementByType:GM.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:u.props.children})}),a=ZJ(this.props),l=JJ(this.getOwnerDocument(),this.getGlobalEditorElement());return Ge.createElement(Ge.Fragment,null,Ge.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),o),Ge.createElement(bWe,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return _We}}])}(Ge.Component);AL.propTypes={style:VP.object,id:VP.string,className:VP.string};var PWe=["children"],rQ=Ge.forwardRef(function(t,e){var r,n=t.children,i=cWe(t,PWe),s=typeof Ge.useId=="function"?Ge.useId():void 0,o=(r=i.id)!==null&&r!==void 0?r:s;return Ge.createElement(AL,Object.assign({id:o},i,{ref:e}),n)});rQ.version=AL.version;Ge.Component;function h6(t,e,r){return(e=AWe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AWe(t){var e=IWe(t,"string");return typeof e=="symbol"?e:e+""}function IWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const f6="handsontableEditor",OWe="handsontable";class IL extends sg{constructor(){super(...arguments),h6(this,"isFlippedVertically",!1),h6(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return OWe}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),RR(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&In(l,o.handsontable),this.htOptions=l}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+a,0)}const i=this.getDropdownHeight(),s=e.getWorkspaceHeight()-n-r.height,o=i>s&&n>s+r.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:n,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.start+r.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;n=Math.max(n+a,0)}const i=this.getDropdownWidth(),s=e.getWorkspaceWidth()-n+r.width,o=i>s&&n>s;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:n,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:r}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-r)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:f6,relativeToGroup:Uh,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),ja(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&this.isFlippedVertically?a=o.countRows()-1:o.getSelectedLast()&&(this.isFlippedVertically?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(o.getSelectedLast()){if(this.isFlippedVertically)a=o.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(f6)}}function MWe(t,e){nQ(t,e),e.add(t)}function d6(t,e,r){nQ(t,e),e.set(t,r)}function nQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lS(t,e,r){return(e=NWe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NWe(t){var e=DWe(t,"string");return typeof e=="symbol"?e:e+""}function DWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WP(t,e){return t.get(YM(t,e))}function YM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const FWe="autocomplete";var jP=new WeakMap,g6=new WeakMap,UP=new WeakSet;class OL extends IL{constructor(){super(...arguments),MWe(this,UP),lS(this,"query",null),lS(this,"strippedChoices",[]),lS(this,"rawChoices",[]),d6(this,jP,this.hot.guid.slice(0,9)),d6(this,g6,kR(()=>{this.focus()},100)),lS(this,"sortByRelevance",function(e,r,n){const i=[],s=[],o=e.length;let a=r.length,l,u,c,h;if(o===0){for(c=0;c<a;c++)s.push(c);return s}for(c=0;c<a;c++){if(u=RW(Fr(r[c])),n)h=u.indexOf(e);else{const f=this.cellProperties.locale;h=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=u.length-h-o,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((f,d)=>{if(d.index===-1)return-1;if(f.index===-1)return 1;if(f.index<d.index)return-1;if(d.index<f.index)return 1;if(f.index===d.index){if(f.charsLeft<d.charsLeft)return-1;if(f.charsLeft>d.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)s.push(i[c].baseIndex);return s})}static get EDITOR_TYPE(){return FWe}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return Le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Se(this.htContainer,"autocompleteEditor"),Se(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ze(this.TEXTAREA,[X2e(),U2e(),lq("listbox"),Z2e()])}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.hot.getSettings().ariaTags&&Ze(this.TEXTAREA,[Wo("false"),eNe(`${WP(jP,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=n==null?void 0:n.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",WP(g6,this)),this.htEditor.updateSettings({colWidths:e?[mn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,f,d)=>{uc(a,l,u,c,h,f,d);const{filteringCaseSensitive:g,allowHtml:m,locale:p}=this.cellProperties,w=this.query;let v=Fr(f),y,b;v&&!m&&(y=g===!0?v.indexOf(w):v.toLocaleLowerCase(p).indexOf(w.toLocaleLowerCase(p)),y!==-1&&(b=v.substr(y,w.length),v=v.replace(b,`<strong>${b}</strong>`))),r&&Ze(l,[z2e(),...n?[iNe(i)]:[],...n?[sNe(n.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=v},afterSelectionEnd:(a,l)=>{if(r){const u=h=>{Ze(h,[_F()]),Ze(this.TEXTAREA,...tNe(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),r&&(Ze(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Tu()),Ze(this.htEditor.rootElement,[aq(),rNe("polite"),nNe("text"),["id",`${WP(jP,this)}-listbox-${s}-${o}`]]),Ze(this.TEXTAREA,...Wo("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ze(this.TEXTAREA,[Wo("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=Rq(this.TEXTAREA),n=LNe(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const c=[];for(let h=0,f=l.length;h<f&&!(i&&u<=h);h++)u?c.push(l[o[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Wx([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),RR(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:r,spaceAbove:n,spaceBelow:i}=e;return this.limitDropdownIfNeeded(r?n:i),e}limitDropdownIfNeeded(e){const r=this.getDropdownHeight();if(r>e){let n=0,i=0,s=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),n+=i;while(n<e);s=n-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-s}px`),this.setDropdownHeight(n-i)}}updateDropdownDimensions(){const e=Tq(),r=this.getTargetEditorWidth()+e,n=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:r,height:n}),YM(UP,this,m6).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),YM(UP,this,m6).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(i,s)=>s).reduce((i,s)=>{const o=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return i+o},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderInlineStartWidth,10)+parseInt(r.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=Pt(e,s=>Fr(s));return Pt(n,s=>r?s:RW(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),n={row:r?r.from.row:-1};let i=!1;return e===Ke.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(i=!0),e===Ke.ARROW_UP&&n.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(UNe(e.keyCode)||e.keyCode===Ke.BACKSPACE||e.keyCode===Ke.DELETE||e.keyCode===Ke.INSERT){let r=10;if(e.keyCode===Ke.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}function m6(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+ei(this.hot.rootDocument)})}const HWe="checkbox";class iQ extends Kp{static get EDITOR_TYPE(){return HWe}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');et(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ih=()=>window,Oo=()=>window.document,KM=(t,e)=>window.setTimeout(t,e),gl=function(t,e,r,n){t.addEventListener(e,r,!!n)},tu=function(t,e,r,n){t.removeEventListener(e,r,!!n)},LWe=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ls=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},zP=function(t,e){Ls(t,e)||(t.className=t.className===""?e:t.className+" "+e)},GP=function(t,e){t.className=LWe((" "+t.className+" ").replace(" "+e+" "," "))},ML=function(t){return/Array/.test(Object.prototype.toString.call(t))},js=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},$We=function(t){let e=t.getDay();return e===0||e===6},BWe=function(t){return t%4===0&&t%100!==0||t%400===0},p6=function(t,e){return[31,BWe(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},uS=function(t){js(t)&&t.setHours(0,0,0,0)},cS=function(t,e){return t.getTime()===e.getTime()},T_=function(t,e,r){let n,i;for(n in e)i=t[n]!==void 0,i&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?js(e[n])?r&&(t[n]=new Date(e[n].getTime())):ML(e[n])?r&&(t[n]=e[n].slice(0)):t[n]=T_({},e[n],r):(r||!i)&&(t[n]=e[n]);return t},v6=function(t,e,r){let n=Oo().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=T_(n,r),t.dispatchEvent(n)},w6=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},tl={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},y6=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},VWe=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},WWe=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),n=t.getDay(),i=e,s=i-1,o=7,a=function(f){return(f+o-1)%o};t.setDate(r+s-a(n));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-s+a(l.getDay()))/o)},jWe=function(t,e,r,n,i){let s=new Date(n,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():WWe(s,i))+"</td>"},UWe=function(t,e,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},zWe=function(t){return"<tbody>"+t.join("")+"</tbody>"},GWe=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+y6(t,e)+'">'+y6(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},YWe=function(t,e,r,n,i,s){let o,a,l,u=t._o,c=r===u.minYear,h=r===u.maxYear,f='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',d,g,m=!0,p=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(r===i?o-e:12+o-e)+'"'+(o===n?' selected="selected"':"")+(c&&o<u.minMonth||h&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(d='<div class="pika-label">'+u.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",ML(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=r-u.yearRange,a=1+r+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+r+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?f+=g+d:f+=d+g,c&&(n===0||u.minMonth>=n)&&(m=!1),h&&(n===11||u.maxMonth<=n)&&(p=!1),e===0&&(f+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(f+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),f+="</div>"},KWe=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+GWe(t)+zWe(e)+"</table>"};function XM(t){let e=this,r=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||ih().event;let s=i.target||i.srcElement;if(s)if(Ls(s,"is-disabled")||(Ls(s,"pika-button")&&!Ls(s,"is-empty")&&!Ls(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&KM(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):Ls(s,"pika-prev")?e.prevMonth():Ls(s,"pika-next")&&e.nextMonth()),Ls(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||ih().event;let s=i.target||i.srcElement;s&&(Ls(s,"pika-select-month")?e.gotoMonth(s.value):Ls(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||ih().event,e.isVisible())switch(i.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let i=this.moment(r.field.value,r.format,r.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),js(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Oo().activeElement;do if(Ls(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=KM(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||ih().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&Ls(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),gl(s,"change",e._onChange)));do if(Ls(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&s!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=Oo().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),gl(e.el,"mousedown",e._onMouseDown,!0),gl(e.el,"touchend",e._onMouseDown,!0),gl(e.el,"change",e._onChange),r.keyboardInput&&gl(Oo(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Oo().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),gl(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;js(n)?r.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",gl(r.trigger,"click",e._onInputClick),gl(r.trigger,"focus",e._onInputFocus),gl(r.trigger,"blur",e._onInputBlur)):this.show()}XM.prototype={config:function(t){this._o||(this._o=T_({},tl,!0));let e=T_(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,js(e.minDate)||(e.minDate=!1),js(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),ML(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||tl.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,js(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return js(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",v6(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!js(t))return;let r=this._o.minDate,n=this._o.maxDate;js(r)&&t<r?t=r:js(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),uS(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),v6(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(js(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<r.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(r.valueOf()+n):t==="subtract"&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=w6(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=w6({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(uS(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=tl.minDate,this._o.minYear=tl.minYear,this._o.minMonth=tl.minMonth,this._o.startRange=tl.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(uS(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=tl.maxDate,this._o.maxYear=tl.maxYear,this._o.maxMonth=tl.maxMonth,this._o.endRange=tl.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,n=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=r&&(this._y=r,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+YWe(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&KM(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,n,i,s,o,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,n=ih().innerWidth||Oo().documentElement.clientWidth,i=ih().innerHeight||Oo().documentElement.clientHeight,s=Oo().body.scrollTop||Oo().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),o=l.left+ih().pageXOffset,a=l.bottom+ih().pageYOffset,(this._o.reposition&&o+e>n||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,u=!1),(this._o.reposition&&a+r>i+s||this._o.position.indexOf("top")>-1&&a-r-t.offsetHeight>0)&&(a=a-r-t.offsetHeight,c=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",zP(this.el,u?"left-aligned":"right-aligned"),zP(this.el,c?"bottom-aligned":"top-aligned"),GP(this.el,u?"right-aligned":"left-aligned"),GP(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let n=this._o,i=new Date,s=p6(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];uS(i),n.firstDay>0&&(o-=n.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,f=e===11?t+1:t,d=p6(h,u),g=s+o,m=g;for(;m>7;)m-=7;g+=7-m;let p=!1;for(let w=0,v=0;w<g;w++){let y=new Date(t,e,1+(w-o)),b=js(this._d)?cS(y,this._d):!1,T=cS(y,i),E=n.events.indexOf(y.toDateString())!==-1,x=w<o||w>=s+o,P=1+(w-o),A=e,O=t,Y=n.startRange&&cS(n.startRange,y),L=n.endRange&&cS(n.endRange,y),ie=n.startRange&&n.endRange&&n.startRange<y&&y<n.endRange,ce=n.minDate&&y<n.minDate||n.maxDate&&y>n.maxDate||n.disableWeekends&&$We(y)||n.disableDayFn&&n.disableDayFn(y);x&&(w<o?(P=d+P,A=u,O=h):(P=P-s,A=c,O=f));let he={day:P,month:A,year:O,hasEvent:E,isSelected:b,isToday:T,isDisabled:ce,isEmpty:x,isStartRange:Y,isEndRange:L,isInRange:ie,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&b&&(p=!0),l.push(VWe(he)),++v===7&&(n.showWeekNumber&&l.unshift(jWe(this,w-o,e,t,n.firstWeekOfYearMinDays)),a.push(UWe(l,n.isRTL,n.pickWholeWeek,p)),l=[],v=0,p=!1)}return KWe(n,a,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),GP(this.el,"is-hidden"),this._o.bound&&(gl(Oo(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&tu(Oo(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),zP(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),tu(this.el,"mousedown",this._onMouseDown,!0),tu(this.el,"touchend",this._onMouseDown,!0),tu(this.el,"change",this._onChange),t.keyboardInput&&tu(Oo(),"keydown",this._onKeyChange),t.field&&(tu(t.field,"change",this._onInputChange),t.bound&&(tu(t.trigger,"click",this._onInputClick),tu(t.trigger,"focus",this._onInputFocus),tu(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function XWe(t,e){qWe(t,e),e.add(t)}function qWe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C6(t,e,r){return(e=JWe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JWe(t){var e=QWe(t,"string");return typeof e=="symbol"?e:e+""}function QWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const sQ="date",S6="dateEditor",ZWe="DD/MM/YYYY";var hS=new WeakSet;class oQ extends sg{constructor(){super(...arguments),XWe(this,hS),C6(this,"parentDestroyed",!1),C6(this,"$datePicker",null)}static get EDITOR_TYPE(){return sQ}init(){if(typeof _e!="function")throw new Error("You need to include moment.js to your project.");if(typeof XM!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Se(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{et(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:S6})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(S6),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=YP(hS,this,KP).call(this),n=this.hot.view.isMouseDown(),i=e?Dq(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new XM(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(_e),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,_e(s,r,!0).isValid()&&this.$datePicker.setMoment(_e(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!n&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,_e(s,r,!0).isValid()&&this.$datePicker.setMoment(_e(s,r),!0),!i&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const r=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&ER(n,this.cellProperties.datePickerConfig);const i=n.onSelect,s=n.onClose;return n.field=r,n.trigger=r,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=(e=n.format)!==null&&e!==void 0?e:YP(hS,this,KP).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=_e(a).format(YP(hS,this,KP).call(this))),this.setValue(a),i&&i(),Al()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},n}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==en.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,a=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+An(this.TD)}px`;let f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f+=h.right-mn(this.datePicker):f+=h.left,this.datePickerStyle.left=`${f}px`}else this.hideDatepicker()}}function KP(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:ZWe}const e8e="dropdown";class aQ extends OL{static get EDITOR_TYPE(){return e8e}prepare(e,r,n,i,s,o){o.filter=!1,o.strict=!0,super.prepare(e,r,n,i,s,o)}}const t8e="numeric";class lQ extends sg{static get EDITOR_TYPE(){return t8e}}function r8e(t,e,r){return(e=n8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n8e(t){var e=i8e(t,"string");return typeof e=="symbol"?e:e+""}function i8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const s8e="password";class uQ extends sg{constructor(){super(...arguments),r8e(this,"autoResize",GJ(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return s8e}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ku(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Vh(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const XP="ht_editor_visible",x6="selectEditor",o8e="select";class cQ extends Kp{static get EDITOR_TYPE(){return o8e}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...ng()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),Se(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",et(this.selectWrapper,XP)&&qe(this.selectWrapper,XP),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Ku(this.select),Ct(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Gp(h,u),this.select.appendChild(h)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==en.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",Se(this.selectWrapper,XP)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:x6};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(x6)}}const a8e="time";class hQ extends sg{static get EDITOR_TYPE(){return a8e}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.TEXTAREA.dir="ltr"}}function l8e(){$s(Kp),$s(OL),$s(iQ),$s(oQ),$s(aQ),$s(IL),$s(lQ),$s(uQ),$s(cQ),$s(sg),$s(hQ)}const u8e="html";function NL(t,e,r,n,i,s,o){_1.apply(this,[t,e,r,n,i,s,o]),Gp(e,s??"",!1)}NL.RENDERER_TYPE=u8e;const c8e="autocomplete";function qp(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=o.allowHtml?NL:uc,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...ng()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,r,n,i,s,o]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),Se(e,"htAutocomplete"),!t.acArrowListener){const h=new $a(t);t.acArrowListener=function(f){et(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}qp.RENDERER_TYPE=c8e;const h8e="dropdown";function DL(t,e,r,n,i,s,o){qp.apply(this,[t,e,r,n,i,s,o])}DL.RENDERER_TYPE=h8e;const b6=new WeakMap,_6=new WeakMap,f8e="htBadValue",bp="data-row",_p="data-col",d8e="checkboxRenderer",fQ="checkbox";Fe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:o,prop:a}=e;if(i===fQ){if(n){const{value:l,property:u}=n;let c=r;if(l)c=typeof l=="function"?l(s,o,a,r):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:r}t=c}return t}});function FL(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;_1.apply(this,[t,e,r,n,i,s,o]),g8e(t);let u=m8e(a);const c=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Ku(e),s===o.checkedTemplate||Fr(s).toLocaleLowerCase(o.locale)===Fr(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||Fr(s).toLocaleLowerCase(o.locale)===Fr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:an(s)?Se(u,"noValue"):(u.style.display="none",Se(u,f8e),h=!0),Ze(u,[[bp,r],[_p,n]]),l&&Ze(u,[mp(u.checked?t.getTranslatedPhrase(_L):t.getTranslatedPhrase(EL)),hq(u.checked),G2e()]),!h&&c){let m="";if(c.value)m=typeof c.value=="function"?c.value.call(this,r,n,i,s):c.value;else if(c.property){const w=t.getDataAtRowProp(r,c.property);m=w!==null?w:""}const p=p8e(a,m,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(p),e.appendChild(u)):(p.appendChild(u),u=p):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(p)):(p.insertBefore(u,p.firstChild),u=p))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),b6.has(t)||(b6.set(t,!0),f());function f(){const p=t.getShortcutManager().getContext("grid"),w={group:d8e,relativeToGroup:Uh,position:"before"};p.addShortcuts([{keys:[["space"]],callback:()=>(d(),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!g()),runOnlyIf:()=>{const v=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(v==null?void 0:v.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}}],w)}function d(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=t.getSelectedRange(),w=[],v=new Map;let y=[],b=0;if(p){for(let T=0;T<p.length;T++){const{row:E,col:x}=p[T].getTopStartCorner(),{row:P,col:A}=p[T].getBottomEndCorner();for(let O=E;O<=P;O+=1)for(let Y=x;Y<=A;Y+=1){const L=t.getCellMeta(O,Y);if(L.hidden)continue;const ie={checkedTemplate:L.checkedTemplate,uncheckedTemplate:L.uncheckedTemplate};if(L.type!=="checkbox"){m===!0&&!L.readOnly&&(v.has(w.length)?v.set(w.length,[...v.get(w.length),[O,Y,null]]):v.set(w.length,[[O,Y,null]]));continue}if(L.readOnly===!0)continue;typeof L.checkedTemplate>"u"&&(L.checkedTemplate=!0),typeof L.uncheckedTemplate>"u"&&(L.uncheckedTemplate=!1);const ce=t.getDataAtCell(O,Y);m===!1?[L.checkedTemplate,L.checkedTemplate.toString()].includes(ce)?y.push([O,Y,L.uncheckedTemplate,ie]):[L.uncheckedTemplate,L.uncheckedTemplate.toString(),null,void 0].includes(ce)&&y.push([O,Y,L.checkedTemplate,ie]):y.push([O,Y,L.uncheckedTemplate,ie]),b+=1}w.push(b),b=0}y.every(T=>{let[,,E]=T;return E===y[0][2]})?y=y.map(T=>{let[E,x,P]=T;return[E,x,P]}):y=y.map(T=>{let[E,x,,P]=T;return[E,x,P.checkedTemplate]}),y.length>0&&w.forEach((T,E)=>{let x=y.splice(0,T);v.size&&v.has(E)&&(x=[...x,...v.get(E)]),t.setDataAtCell(x)})}}function g(){const m=t.getSelectedRange();if(m){for(let p=0;p<m.length;p++){const w=m[p].getTopStartCorner(),v=m[p].getBottomEndCorner();for(let y=w.row;y<=v.row;y++)for(let b=w.col;b<=v.col;b++){if(t.getCellMeta(y,b).readOnly)continue;const E=t.getCell(y,b);if($u(E)&&E.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}FL.RENDERER_TYPE=fQ;function g8e(t){let e=_6.get(t);if(!e){const{rootElement:r}=t;e=new $a(t),e.addEventListener(r,"click",n=>w8e(n,t)),e.addEventListener(r,"mouseup",n=>v8e(n,t)),e.addEventListener(r,"change",n=>y8e(n,t)),_6.set(t,e)}return e}function m8e(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function p8e(t,e,r){const n=t.createElement("label");n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`;const i=t.createTextNode(e);if(r){const s=t.createElement("span");s.appendChild(i),n.appendChild(s)}else n.appendChild(i);return n.cloneNode(!0)}function v8e(t,e){const{target:r}=t;HL(r)&&(!r.hasAttribute(bp)||!r.hasAttribute(_p)||setTimeout(e.listen,10))}function w8e(t,e){const{target:r}=t;if(!HL(r)||!r.hasAttribute(bp)||!r.hasAttribute(_p))return;const n=parseInt(r.getAttribute(bp),10),i=parseInt(r.getAttribute(_p),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function y8e(t,e){const{target:r}=t;if(!HL(r)||!r.hasAttribute(bp)||!r.hasAttribute(_p))return;const n=parseInt(r.getAttribute(bp),10),i=parseInt(r.getAttribute(_p),10),s=e.getCellMeta(n,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function HL(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const C8e="handsontable";function LL(t,e,r,n,i,s,o){qp.apply(this,[t,e,r,n,i,s,o])}LL.RENDERER_TYPE=C8e;var S8e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x8e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var qP,E6;function b8e(){return E6||(E6=1,qP={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),qP}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var JP,R6;function dQ(){if(R6)return JP;R6=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(l,u,c,h,f,d,g){if(!isNaN(+l))return+l;let m="",p=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(p!==l)return-1*r(p,u,c,h,f,d);for(let E=0;E<t.length;E++){let x=t[E];if(m=l.replace(RegExp(`([0-9 ])(${x.key})$`),"$1"),m!==l)return r(m,u,c,h,f,d)*x.factor}if(m=l.replace("%",""),m!==l)return r(m,u,c,h,f,d)/100;let w=parseFloat(l);if(isNaN(w))return;let v=h(w);if(v&&v!=="."&&(m=l.replace(new RegExp(`${e(v)}$`),""),m!==l))return r(m,u,c,h,f,d);let y={};Object.keys(d).forEach(E=>{y[d[E]]=E});let b=Object.keys(y).sort().reverse(),T=b.length;for(let E=0;E<T;E++){let x=b[E],P=y[x];if(m=l.replace(x,""),m!==l){let A;switch(P){case"thousand":A=Math.pow(10,3);break;case"million":A=Math.pow(10,6);break;case"billion":A=Math.pow(10,9);break;case"trillion":A=Math.pow(10,12);break}return r(m,u,c,h,f,d)*A}}}function n(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,f,d,g){if(l==="")return;if(l===f)return 0;let m=n(l,u,c);return r(m,u,c,h,f,d)}function s(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let f=+h[0],d=+h[1],g=+h[2];return!isNaN(f)&&!isNaN(d)&&!isNaN(g)}function o(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=VL();let h=c.currentDelimiters(),f=c.currentCurrency().symbol,d=c.currentOrdinal(),g=c.getZeroFormat(),m=c.currentAbbreviations(),p;if(typeof l=="string")s(l,h)?p=o(l):p=i(l,h,f,d,g,m);else if(typeof l=="number")p=l;else return;if(p!==void 0)return p}return JP={unformat:a},JP}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var QP,T6;function $L(){if(T6)return QP;T6=1;let t=dQ();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],n=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(p,w)=>w.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:p=>p.output==="byte"},characteristic:{type:"number",restriction:p=>p>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:n},average:"boolean",lowPrecision:{type:"boolean",restriction:(p,w)=>w.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:p=>p>=0,message:"value must be positive"},{restriction:(p,w)=>!w.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:p=>p>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(p,w)=>w.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:p=>p.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p,w){let v=f(p),y=g(w);return v&&y}function f(p){return t.unformat(p)!==void 0}function d(p,w,v,y=!1){let b=Object.keys(p).map(T=>{if(!w[T])return console.error(`${v} Invalid key: ${T}`),!1;let E=p[T],x=w[T];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!d(E,u,`[Validate ${T}]`,!0))return!1}else if(typeof E!==x.type)return console.error(`${v} ${T} type mismatched: "${x.type}" expected, "${typeof E}" provided`),!1;if(x.restrictions&&x.restrictions.length){let P=x.restrictions.length;for(let A=0;A<P;A++){let{restriction:O,message:Y}=x.restrictions[A];if(!O(E,p))return console.error(`${v} ${T} invalid value: ${Y}`),!1}}return x.restriction&&!x.restriction(E,p)?(console.error(`${v} ${T} invalid value: ${x.message}`),!1):x.validValues&&x.validValues.indexOf(E)===-1?(console.error(`${v} ${T} invalid value: must be among ${JSON.stringify(x.validValues)}, "${E}" provided`),!1):!(x.children&&!d(E,x.children,`[Validate ${T}]`))});return y||b.push(...Object.keys(w).map(T=>{let E=w[T];if(typeof E=="string"&&(E={type:E}),E.mandatory){let x=E.mandatory;if(typeof x=="function"&&(x=x(p)),x&&p[T]===void 0)return console.error(`${v} Missing mandatory key "${T}"`),!1}return!0})),b.reduce((T,E)=>T&&E,!0)}function g(p){return d(p,u,"[Validate format]")}function m(p){return d(p,c,"[Validate language]")}return QP={validate:h,validateFormat:g,validateInput:f,validateLanguage:m},QP}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function _8e(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function E8e(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function R8e(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function T8e(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function k8e(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function P8e(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function A8e(t,e){let n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}function I8e(t,e){let r=t.split(".")[1];if(r){let n=r.match(/0+/);n&&(e.mantissa=n[0].length)}}function O8e(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function M8e(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function N8e(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function D8e(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function F8e(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function H8e(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function L8e(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function $8e(t,e={}){return typeof t!="string"?t:(t=_8e(t,e),t=E8e(t,e),R8e(t,e),P8e(t,e),A8e(t,e),F8e(t,e),M8e(t,e),N8e(t,e),I8e(t,e),D8e(t,e),O8e(t,e),T8e(t,e),k8e(t,e),H8e(t,e),L8e(t,e),e)}var BL={parseFormat:$8e};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ZP,k6;function VL(){if(k6)return ZP;k6=1;const t=b8e(),e=$L(),r=BL;let n={},i,s={},o=null,a={};function l(c){i=c}function u(){return s[i]}return n.languages=()=>Object.assign({},s),n.currentLanguage=()=>i,n.currentBytes=()=>u().bytes||{},n.currentCurrency=()=>u().currency,n.currentAbbreviations=()=>u().abbreviations,n.currentDelimiters=()=>u().delimiters,n.currentOrdinal=()=>u().ordinal,n.currentDefaults=()=>Object.assign({},u().defaults,a),n.currentOrdinalDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().ordinalFormat),n.currentByteDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().byteFormat),n.currentPercentageDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().percentageFormat),n.currentCurrencyDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().currencyFormat),n.currentTimeDefaultFormat=()=>Object.assign({},n.currentDefaults(),u().timeFormat),n.setDefaults=c=>{c=r.parseFormat(c),e.validateFormat(c)&&(a=c)},n.getZeroFormat=()=>o,n.setZeroFormat=c=>o=typeof c=="string"?c:null,n.hasZeroFormat=()=>o!==null,n.languageData=c=>{if(c){if(s[c])return s[c];throw new Error(`Unknown tag "${c}"`)}return u()},n.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");s[c.languageTag]=c,h&&l(c.languageTag)},n.setLanguage=(c,h=t.languageTag)=>{if(!s[c]){let f=c.split("-")[0],d=Object.keys(s).find(g=>g.split("-")[0]===f);if(!s[d]){l(h);return}l(d);return}l(c)},n.registerLanguage(t),i=t.languageTag,ZP=n,ZP}function B8e(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function V8e(t,e){t.forEach(r=>{let n;try{n=B8e(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}n&&e.registerLanguage(n)})}var W8e=t=>({loadLanguagesInNode:e=>V8e(e,t)}),gQ={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,d=1e9;function g(E){var x,P,A,O=S.prototype={constructor:S,toString:null,valueOf:null},Y=new S(1),L=20,ie=4,ce=-7,he=21,Ee=-1e7,Ce=1e7,ge=!1,Q=1,ye=0,Re={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz",C=!0;function S(k,M){var R,V,q,J,re,B,te,oe,ae=this;if(!(ae instanceof S))return new S(k,M);if(M==null){if(k&&k._isBigNumber===!0){ae.s=k.s,!k.c||k.e>Ce?ae.c=ae.e=null:k.e<Ee?ae.c=[ae.e=0]:(ae.e=k.e,ae.c=k.c.slice());return}if((B=typeof k=="number")&&k*0==0){if(ae.s=1/k<0?(k=-k,-1):1,k===~~k){for(J=0,re=k;re>=10;re/=10,J++);J>Ce?ae.c=ae.e=null:(ae.e=J,ae.c=[k]);return}oe=String(k)}else{if(!n.test(oe=String(k)))return A(ae,oe,B);ae.s=oe.charCodeAt(0)==45?(oe=oe.slice(1),-1):1}(J=oe.indexOf("."))>-1&&(oe=oe.replace(".","")),(re=oe.search(/e/i))>0?(J<0&&(J=re),J+=+oe.slice(re+1),oe=oe.substring(0,re)):J<0&&(J=oe.length)}else{if(v(M,2,W.length,"Base"),M==10&&C)return ae=new S(k),X(ae,L+ae.e+1,ie);if(oe=String(k),B=typeof k=="number"){if(k*0!=0)return A(ae,oe,B,M);if(ae.s=1/k<0?(oe=oe.slice(1),-1):1,S.DEBUG&&oe.replace(/^0\.0*|\./,"").length>15)throw Error(a+k)}else ae.s=oe.charCodeAt(0)===45?(oe=oe.slice(1),-1):1;for(R=W.slice(0,M),J=re=0,te=oe.length;re<te;re++)if(R.indexOf(V=oe.charAt(re))<0){if(V=="."){if(re>J){J=te;continue}}else if(!q&&(oe==oe.toUpperCase()&&(oe=oe.toLowerCase())||oe==oe.toLowerCase()&&(oe=oe.toUpperCase()))){q=!0,re=-1,J=0;continue}return A(ae,String(k),B,M)}B=!1,oe=P(oe,M,10,ae.s),(J=oe.indexOf("."))>-1?oe=oe.replace(".",""):J=oe.length}for(re=0;oe.charCodeAt(re)===48;re++);for(te=oe.length;oe.charCodeAt(--te)===48;);if(oe=oe.slice(re,++te)){if(te-=re,B&&S.DEBUG&&te>15&&(k>c||k!==s(k)))throw Error(a+ae.s*k);if((J=J-re-1)>Ce)ae.c=ae.e=null;else if(J<Ee)ae.c=[ae.e=0];else{if(ae.e=J,ae.c=[],re=(J+1)%u,J<0&&(re+=u),re<te){for(re&&ae.c.push(+oe.slice(0,re)),te-=u;re<te;)ae.c.push(+oe.slice(re,re+=u));re=u-(oe=oe.slice(re)).length}else re-=te;for(;re--;oe+="0");ae.c.push(+oe)}}else ae.c=[ae.e=0]}S.clone=g,S.ROUND_UP=0,S.ROUND_DOWN=1,S.ROUND_CEIL=2,S.ROUND_FLOOR=3,S.ROUND_HALF_UP=4,S.ROUND_HALF_DOWN=5,S.ROUND_HALF_EVEN=6,S.ROUND_HALF_CEIL=7,S.ROUND_HALF_FLOOR=8,S.EUCLID=9,S.config=S.set=function(k){var M,R;if(k!=null)if(typeof k=="object"){if(k.hasOwnProperty(M="DECIMAL_PLACES")&&(R=k[M],v(R,0,d,M),L=R),k.hasOwnProperty(M="ROUNDING_MODE")&&(R=k[M],v(R,0,8,M),ie=R),k.hasOwnProperty(M="EXPONENTIAL_AT")&&(R=k[M],R&&R.pop?(v(R[0],-d,0,M),v(R[1],0,d,M),ce=R[0],he=R[1]):(v(R,-d,d,M),ce=-(he=R<0?-R:R))),k.hasOwnProperty(M="RANGE"))if(R=k[M],R&&R.pop)v(R[0],-d,-1,M),v(R[1],1,d,M),Ee=R[0],Ce=R[1];else if(v(R,-d,d,M),R)Ee=-(Ce=R<0?-R:R);else throw Error(o+M+" cannot be zero: "+R);if(k.hasOwnProperty(M="CRYPTO"))if(R=k[M],R===!!R)if(R)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ge=R;else throw ge=!R,Error(o+"crypto unavailable");else ge=R;else throw Error(o+M+" not true or false: "+R);if(k.hasOwnProperty(M="MODULO_MODE")&&(R=k[M],v(R,0,9,M),Q=R),k.hasOwnProperty(M="POW_PRECISION")&&(R=k[M],v(R,0,d,M),ye=R),k.hasOwnProperty(M="FORMAT"))if(R=k[M],typeof R=="object")Re=R;else throw Error(o+M+" not an object: "+R);if(k.hasOwnProperty(M="ALPHABET"))if(R=k[M],typeof R=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(R))C=R.slice(0,10)=="0123456789",W=R;else throw Error(o+M+" invalid: "+R)}else throw Error(o+"Object expected: "+k);return{DECIMAL_PLACES:L,ROUNDING_MODE:ie,EXPONENTIAL_AT:[ce,he],RANGE:[Ee,Ce],CRYPTO:ge,MODULO_MODE:Q,POW_PRECISION:ye,FORMAT:Re,ALPHABET:W}},S.isBigNumber=function(k){if(!k||k._isBigNumber!==!0)return!1;if(!S.DEBUG)return!0;var M,R,V=k.c,q=k.e,J=k.s;e:if({}.toString.call(V)=="[object Array]"){if((J===1||J===-1)&&q>=-d&&q<=d&&q===s(q)){if(V[0]===0){if(q===0&&V.length===1)return!0;break e}if(M=(q+1)%u,M<1&&(M+=u),String(V[0]).length==M){for(M=0;M<V.length;M++)if(R=V[M],R<0||R>=l||R!==s(R))break e;if(R!==0)return!0}}}else if(V===null&&q===null&&(J===null||J===1||J===-1))return!0;throw Error(o+"Invalid BigNumber: "+k)},S.maximum=S.max=function(){return D(arguments,-1)},S.minimum=S.min=function(){return D(arguments,1)},S.random=function(){var k=9007199254740992,M=Math.random()*k&2097151?function(){return s(Math.random()*k)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(R){var V,q,J,re,B,te=0,oe=[],ae=new S(Y);if(R==null?R=L:v(R,0,d),re=i(R/u),ge)if(crypto.getRandomValues){for(V=crypto.getRandomValues(new Uint32Array(re*=2));te<re;)B=V[te]*131072+(V[te+1]>>>11),B>=9e15?(q=crypto.getRandomValues(new Uint32Array(2)),V[te]=q[0],V[te+1]=q[1]):(oe.push(B%1e14),te+=2);te=re/2}else if(crypto.randomBytes){for(V=crypto.randomBytes(re*=7);te<re;)B=(V[te]&31)*281474976710656+V[te+1]*1099511627776+V[te+2]*4294967296+V[te+3]*16777216+(V[te+4]<<16)+(V[te+5]<<8)+V[te+6],B>=9e15?crypto.randomBytes(7).copy(V,te):(oe.push(B%1e14),te+=7);te=re/7}else throw ge=!1,Error(o+"crypto unavailable");if(!ge)for(;te<re;)B=M(),B<9e15&&(oe[te++]=B%1e14);for(re=oe[--te],R%=u,re&&R&&(B=h[u-R],oe[te]=s(re/B)*B);oe[te]===0;oe.pop(),te--);if(te<0)oe=[J=0];else{for(J=-1;oe[0]===0;oe.splice(0,1),J-=u);for(te=1,B=oe[0];B>=10;B/=10,te++);te<u&&(J-=u-te)}return ae.e=J,ae.c=oe,ae}}(),S.sum=function(){for(var k=1,M=arguments,R=new S(M[0]);k<M.length;)R=R.plus(M[k++]);return R},P=function(){var k="0123456789";function M(R,V,q,J){for(var re,B=[0],te,oe=0,ae=R.length;oe<ae;){for(te=B.length;te--;B[te]*=V);for(B[0]+=J.indexOf(R.charAt(oe++)),re=0;re<B.length;re++)B[re]>q-1&&(B[re+1]==null&&(B[re+1]=0),B[re+1]+=B[re]/q|0,B[re]%=q)}return B.reverse()}return function(R,V,q,J,re){var B,te,oe,ae,fe,Me,Ne,ze,st=R.indexOf("."),ot=L,tt=ie;for(st>=0&&(ae=ye,ye=0,R=R.replace(".",""),ze=new S(V),Me=ze.pow(R.length-st),ye=ae,ze.c=M(T(p(Me.c),Me.e,"0"),10,q,k),ze.e=ze.c.length),Ne=M(R,V,q,re?(B=W,k):(B=k,W)),oe=ae=Ne.length;Ne[--ae]==0;Ne.pop());if(!Ne[0])return B.charAt(0);if(st<0?--oe:(Me.c=Ne,Me.e=oe,Me.s=J,Me=x(Me,ze,ot,tt,q),Ne=Me.c,fe=Me.r,oe=Me.e),te=oe+ot+1,st=Ne[te],ae=q/2,fe=fe||te<0||Ne[te+1]!=null,fe=tt<4?(st!=null||fe)&&(tt==0||tt==(Me.s<0?3:2)):st>ae||st==ae&&(tt==4||fe||tt==6&&Ne[te-1]&1||tt==(Me.s<0?8:7)),te<1||!Ne[0])R=fe?T(B.charAt(1),-ot,B.charAt(0)):B.charAt(0);else{if(Ne.length=te,fe)for(--q;++Ne[--te]>q;)Ne[te]=0,te||(++oe,Ne=[1].concat(Ne));for(ae=Ne.length;!Ne[--ae];);for(st=0,R="";st<=ae;R+=B.charAt(Ne[st++]));R=T(R,oe,B.charAt(0))}return R}}(),x=function(){function k(V,q,J){var re,B,te,oe,ae=0,fe=V.length,Me=q%f,Ne=q/f|0;for(V=V.slice();fe--;)te=V[fe]%f,oe=V[fe]/f|0,re=Ne*te+oe*Me,B=Me*te+re%f*f+ae,ae=(B/J|0)+(re/f|0)+Ne*oe,V[fe]=B%J;return ae&&(V=[ae].concat(V)),V}function M(V,q,J,re){var B,te;if(J!=re)te=J>re?1:-1;else for(B=te=0;B<J;B++)if(V[B]!=q[B]){te=V[B]>q[B]?1:-1;break}return te}function R(V,q,J,re){for(var B=0;J--;)V[J]-=B,B=V[J]<q[J]?1:0,V[J]=B*re+V[J]-q[J];for(;!V[0]&&V.length>1;V.splice(0,1));}return function(V,q,J,re,B){var te,oe,ae,fe,Me,Ne,ze,st,ot,tt,We,ht,Qe,Xt,Or,St,$t,dr=V.s==q.s?1:-1,cr=V.c,Mt=q.c;if(!cr||!cr[0]||!Mt||!Mt[0])return new S(!V.s||!q.s||(cr?Mt&&cr[0]==Mt[0]:!Mt)?NaN:cr&&cr[0]==0||!Mt?dr*0:dr/0);for(st=new S(dr),ot=st.c=[],oe=V.e-q.e,dr=J+oe+1,B||(B=l,oe=m(V.e/u)-m(q.e/u),dr=dr/u|0),ae=0;Mt[ae]==(cr[ae]||0);ae++);if(Mt[ae]>(cr[ae]||0)&&oe--,dr<0)ot.push(1),fe=!0;else{for(Xt=cr.length,St=Mt.length,ae=0,dr+=2,Me=s(B/(Mt[0]+1)),Me>1&&(Mt=k(Mt,Me,B),cr=k(cr,Me,B),St=Mt.length,Xt=cr.length),Qe=St,tt=cr.slice(0,St),We=tt.length;We<St;tt[We++]=0);$t=Mt.slice(),$t=[0].concat($t),Or=Mt[0],Mt[1]>=B/2&&Or++;do{if(Me=0,te=M(Mt,tt,St,We),te<0){if(ht=tt[0],St!=We&&(ht=ht*B+(tt[1]||0)),Me=s(ht/Or),Me>1)for(Me>=B&&(Me=B-1),Ne=k(Mt,Me,B),ze=Ne.length,We=tt.length;M(Ne,tt,ze,We)==1;)Me--,R(Ne,St<ze?$t:Mt,ze,B),ze=Ne.length,te=1;else Me==0&&(te=Me=1),Ne=Mt.slice(),ze=Ne.length;if(ze<We&&(Ne=[0].concat(Ne)),R(tt,Ne,We,B),We=tt.length,te==-1)for(;M(Mt,tt,St,We)<1;)Me++,R(tt,St<We?$t:Mt,We,B),We=tt.length}else te===0&&(Me++,tt=[0]);ot[ae++]=Me,tt[0]?tt[We++]=cr[Qe]||0:(tt=[cr[Qe]],We=1)}while((Qe++<Xt||tt[0]!=null)&&dr--);fe=tt[0]!=null,ot[0]||ot.splice(0,1)}if(B==l){for(ae=1,dr=ot[0];dr>=10;dr/=10,ae++);X(st,J+(st.e=ae+oe*u-1)+1,re,fe)}else st.e=oe,st.r=+fe;return st}}();function _(k,M,R,V){var q,J,re,B,te;if(R==null?R=ie:v(R,0,8),!k.c)return k.toString();if(q=k.c[0],re=k.e,M==null)te=p(k.c),te=V==1||V==2&&(re<=ce||re>=he)?b(te,re):T(te,re,"0");else if(k=X(new S(k),M,R),J=k.e,te=p(k.c),B=te.length,V==1||V==2&&(M<=J||J<=ce)){for(;B<M;te+="0",B++);te=b(te,J)}else if(M-=re,te=T(te,J,"0"),J+1>B){if(--M>0)for(te+=".";M--;te+="0");}else if(M+=J-B,M>0)for(J+1==B&&(te+=".");M--;te+="0");return k.s<0&&q?"-"+te:te}function D(k,M){for(var R,V,q=1,J=new S(k[0]);q<k.length;q++)V=new S(k[q]),(!V.s||(R=w(J,V))===M||R===0&&J.s===M)&&(J=V);return J}function U(k,M,R){for(var V=1,q=M.length;!M[--q];M.pop());for(q=M[0];q>=10;q/=10,V++);return(R=V+R*u-1)>Ce?k.c=k.e=null:R<Ee?k.c=[k.e=0]:(k.e=R,k.c=M),k}A=function(){var k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,M=/^([^.]+)\.$/,R=/^\.([^.]+)$/,V=/^-?(Infinity|NaN)$/,q=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(J,re,B,te){var oe,ae=B?re:re.replace(q,"");if(V.test(ae))J.s=isNaN(ae)?null:ae<0?-1:1;else{if(!B&&(ae=ae.replace(k,function(fe,Me,Ne){return oe=(Ne=Ne.toLowerCase())=="x"?16:Ne=="b"?2:8,!te||te==oe?Me:fe}),te&&(oe=te,ae=ae.replace(M,"$1").replace(R,"0.$1")),re!=ae))return new S(ae,oe);if(S.DEBUG)throw Error(o+"Not a"+(te?" base "+te:"")+" number: "+re);J.s=null}J.c=J.e=null}}();function X(k,M,R,V){var q,J,re,B,te,oe,ae,fe=k.c,Me=h;if(fe){e:{for(q=1,B=fe[0];B>=10;B/=10,q++);if(J=M-q,J<0)J+=u,re=M,te=fe[oe=0],ae=s(te/Me[q-re-1]%10);else if(oe=i((J+1)/u),oe>=fe.length)if(V){for(;fe.length<=oe;fe.push(0));te=ae=0,q=1,J%=u,re=J-u+1}else break e;else{for(te=B=fe[oe],q=1;B>=10;B/=10,q++);J%=u,re=J-u+q,ae=re<0?0:s(te/Me[q-re-1]%10)}if(V=V||M<0||fe[oe+1]!=null||(re<0?te:te%Me[q-re-1]),V=R<4?(ae||V)&&(R==0||R==(k.s<0?3:2)):ae>5||ae==5&&(R==4||V||R==6&&(J>0?re>0?te/Me[q-re]:0:fe[oe-1])%10&1||R==(k.s<0?8:7)),M<1||!fe[0])return fe.length=0,V?(M-=k.e+1,fe[0]=Me[(u-M%u)%u],k.e=-M||0):fe[0]=k.e=0,k;if(J==0?(fe.length=oe,B=1,oe--):(fe.length=oe+1,B=Me[u-J],fe[oe]=re>0?s(te/Me[q-re]%Me[re])*B:0),V)for(;;)if(oe==0){for(J=1,re=fe[0];re>=10;re/=10,J++);for(re=fe[0]+=B,B=1;re>=10;re/=10,B++);J!=B&&(k.e++,fe[0]==l&&(fe[0]=1));break}else{if(fe[oe]+=B,fe[oe]!=l)break;fe[oe--]=0,B=1}for(J=fe.length;fe[--J]===0;fe.pop());}k.e>Ce?k.c=k.e=null:k.e<Ee&&(k.c=[k.e=0])}return k}function ee(k){var M,R=k.e;return R===null?k.toString():(M=p(k.c),M=R<=ce||R>=he?b(M,R):T(M,R,"0"),k.s<0?"-"+M:M)}return O.absoluteValue=O.abs=function(){var k=new S(this);return k.s<0&&(k.s=1),k},O.comparedTo=function(k,M){return w(this,new S(k,M))},O.decimalPlaces=O.dp=function(k,M){var R,V,q,J=this;if(k!=null)return v(k,0,d),M==null?M=ie:v(M,0,8),X(new S(J),k+J.e+1,M);if(!(R=J.c))return null;if(V=((q=R.length-1)-m(this.e/u))*u,q=R[q])for(;q%10==0;q/=10,V--);return V<0&&(V=0),V},O.dividedBy=O.div=function(k,M){return x(this,new S(k,M),L,ie)},O.dividedToIntegerBy=O.idiv=function(k,M){return x(this,new S(k,M),0,1)},O.exponentiatedBy=O.pow=function(k,M){var R,V,q,J,re,B,te,oe,ae,fe=this;if(k=new S(k),k.c&&!k.isInteger())throw Error(o+"Exponent not an integer: "+ee(k));if(M!=null&&(M=new S(M)),B=k.e>14,!fe.c||!fe.c[0]||fe.c[0]==1&&!fe.e&&fe.c.length==1||!k.c||!k.c[0])return ae=new S(Math.pow(+ee(fe),B?k.s*(2-y(k)):+ee(k))),M?ae.mod(M):ae;if(te=k.s<0,M){if(M.c?!M.c[0]:!M.s)return new S(NaN);V=!te&&fe.isInteger()&&M.isInteger(),V&&(fe=fe.mod(M))}else{if(k.e>9&&(fe.e>0||fe.e<-1||(fe.e==0?fe.c[0]>1||B&&fe.c[1]>=24e7:fe.c[0]<8e13||B&&fe.c[0]<=9999975e7)))return J=fe.s<0&&y(k)?-0:0,fe.e>-1&&(J=1/J),new S(te?1/J:J);ye&&(J=i(ye/u+2))}for(B?(R=new S(.5),te&&(k.s=1),oe=y(k)):(q=Math.abs(+ee(k)),oe=q%2),ae=new S(Y);;){if(oe){if(ae=ae.times(fe),!ae.c)break;J?ae.c.length>J&&(ae.c.length=J):V&&(ae=ae.mod(M))}if(q){if(q=s(q/2),q===0)break;oe=q%2}else if(k=k.times(R),X(k,k.e+1,1),k.e>14)oe=y(k);else{if(q=+ee(k),q===0)break;oe=q%2}fe=fe.times(fe),J?fe.c&&fe.c.length>J&&(fe.c.length=J):V&&(fe=fe.mod(M))}return V?ae:(te&&(ae=Y.div(ae)),M?ae.mod(M):J?X(ae,ye,ie,re):ae)},O.integerValue=function(k){var M=new S(this);return k==null?k=ie:v(k,0,8),X(M,M.e+1,k)},O.isEqualTo=O.eq=function(k,M){return w(this,new S(k,M))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(k,M){return w(this,new S(k,M))>0},O.isGreaterThanOrEqualTo=O.gte=function(k,M){return(M=w(this,new S(k,M)))===1||M===0},O.isInteger=function(){return!!this.c&&m(this.e/u)>this.c.length-2},O.isLessThan=O.lt=function(k,M){return w(this,new S(k,M))<0},O.isLessThanOrEqualTo=O.lte=function(k,M){return(M=w(this,new S(k,M)))===-1||M===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(k,M){var R,V,q,J,re=this,B=re.s;if(k=new S(k,M),M=k.s,!B||!M)return new S(NaN);if(B!=M)return k.s=-M,re.plus(k);var te=re.e/u,oe=k.e/u,ae=re.c,fe=k.c;if(!te||!oe){if(!ae||!fe)return ae?(k.s=-M,k):new S(fe?re:NaN);if(!ae[0]||!fe[0])return fe[0]?(k.s=-M,k):new S(ae[0]?re:ie==3?-0:0)}if(te=m(te),oe=m(oe),ae=ae.slice(),B=te-oe){for((J=B<0)?(B=-B,q=ae):(oe=te,q=fe),q.reverse(),M=B;M--;q.push(0));q.reverse()}else for(V=(J=(B=ae.length)<(M=fe.length))?B:M,B=M=0;M<V;M++)if(ae[M]!=fe[M]){J=ae[M]<fe[M];break}if(J&&(q=ae,ae=fe,fe=q,k.s=-k.s),M=(V=fe.length)-(R=ae.length),M>0)for(;M--;ae[R++]=0);for(M=l-1;V>B;){if(ae[--V]<fe[V]){for(R=V;R&&!ae[--R];ae[R]=M);--ae[R],ae[V]+=l}ae[V]-=fe[V]}for(;ae[0]==0;ae.splice(0,1),--oe);return ae[0]?U(k,ae,oe):(k.s=ie==3?-1:1,k.c=[k.e=0],k)},O.modulo=O.mod=function(k,M){var R,V,q=this;return k=new S(k,M),!q.c||!k.s||k.c&&!k.c[0]?new S(NaN):!k.c||q.c&&!q.c[0]?new S(q):(Q==9?(V=k.s,k.s=1,R=x(q,k,0,3),k.s=V,R.s*=V):R=x(q,k,0,Q),k=q.minus(R.times(k)),!k.c[0]&&Q==1&&(k.s=q.s),k)},O.multipliedBy=O.times=function(k,M){var R,V,q,J,re,B,te,oe,ae,fe,Me,Ne,ze,st,ot,tt=this,We=tt.c,ht=(k=new S(k,M)).c;if(!We||!ht||!We[0]||!ht[0])return!tt.s||!k.s||We&&!We[0]&&!ht||ht&&!ht[0]&&!We?k.c=k.e=k.s=null:(k.s*=tt.s,!We||!ht?k.c=k.e=null:(k.c=[0],k.e=0)),k;for(V=m(tt.e/u)+m(k.e/u),k.s*=tt.s,te=We.length,fe=ht.length,te<fe&&(ze=We,We=ht,ht=ze,q=te,te=fe,fe=q),q=te+fe,ze=[];q--;ze.push(0));for(st=l,ot=f,q=fe;--q>=0;){for(R=0,Me=ht[q]%ot,Ne=ht[q]/ot|0,re=te,J=q+re;J>q;)oe=We[--re]%ot,ae=We[re]/ot|0,B=Ne*oe+ae*Me,oe=Me*oe+B%ot*ot+ze[J]+R,R=(oe/st|0)+(B/ot|0)+Ne*ae,ze[J--]=oe%st;ze[J]=R}return R?++V:ze.splice(0,1),U(k,ze,V)},O.negated=function(){var k=new S(this);return k.s=-k.s||null,k},O.plus=function(k,M){var R,V=this,q=V.s;if(k=new S(k,M),M=k.s,!q||!M)return new S(NaN);if(q!=M)return k.s=-M,V.minus(k);var J=V.e/u,re=k.e/u,B=V.c,te=k.c;if(!J||!re){if(!B||!te)return new S(q/0);if(!B[0]||!te[0])return te[0]?k:new S(B[0]?V:q*0)}if(J=m(J),re=m(re),B=B.slice(),q=J-re){for(q>0?(re=J,R=te):(q=-q,R=B),R.reverse();q--;R.push(0));R.reverse()}for(q=B.length,M=te.length,q-M<0&&(R=te,te=B,B=R,M=q),q=0;M;)q=(B[--M]=B[M]+te[M]+q)/l|0,B[M]=l===B[M]?0:B[M]%l;return q&&(B=[q].concat(B),++re),U(k,B,re)},O.precision=O.sd=function(k,M){var R,V,q,J=this;if(k!=null&&k!==!!k)return v(k,1,d),M==null?M=ie:v(M,0,8),X(new S(J),k,M);if(!(R=J.c))return null;if(q=R.length-1,V=q*u+1,q=R[q]){for(;q%10==0;q/=10,V--);for(q=R[0];q>=10;q/=10,V++);}return k&&J.e+1>V&&(V=J.e+1),V},O.shiftedBy=function(k){return v(k,-c,c),this.times("1e"+k)},O.squareRoot=O.sqrt=function(){var k,M,R,V,q,J=this,re=J.c,B=J.s,te=J.e,oe=L+4,ae=new S("0.5");if(B!==1||!re||!re[0])return new S(!B||B<0&&(!re||re[0])?NaN:re?J:1/0);if(B=Math.sqrt(+ee(J)),B==0||B==1/0?(M=p(re),(M.length+te)%2==0&&(M+="0"),B=Math.sqrt(+M),te=m((te+1)/2)-(te<0||te%2),B==1/0?M="5e"+te:(M=B.toExponential(),M=M.slice(0,M.indexOf("e")+1)+te),R=new S(M)):R=new S(B+""),R.c[0]){for(te=R.e,B=te+oe,B<3&&(B=0);;)if(q=R,R=ae.times(q.plus(x(J,q,oe,1))),p(q.c).slice(0,B)===(M=p(R.c)).slice(0,B))if(R.e<te&&--B,M=M.slice(B-3,B+1),M=="9999"||!V&&M=="4999"){if(!V&&(X(q,q.e+L+2,0),q.times(q).eq(J))){R=q;break}oe+=4,B+=4,V=1}else{(!+M||!+M.slice(1)&&M.charAt(0)=="5")&&(X(R,R.e+L+2,1),k=!R.times(R).eq(J));break}}return X(R,R.e+L+1,ie,k)},O.toExponential=function(k,M){return k!=null&&(v(k,0,d),k++),_(this,k,M,1)},O.toFixed=function(k,M){return k!=null&&(v(k,0,d),k=k+this.e+1),_(this,k,M)},O.toFormat=function(k,M,R){var V,q=this;if(R==null)k!=null&&M&&typeof M=="object"?(R=M,M=null):k&&typeof k=="object"?(R=k,k=M=null):R=Re;else if(typeof R!="object")throw Error(o+"Argument not an object: "+R);if(V=q.toFixed(k,M),q.c){var J,re=V.split("."),B=+R.groupSize,te=+R.secondaryGroupSize,oe=R.groupSeparator||"",ae=re[0],fe=re[1],Me=q.s<0,Ne=Me?ae.slice(1):ae,ze=Ne.length;if(te&&(J=B,B=te,te=J,ze-=J),B>0&&ze>0){for(J=ze%B||B,ae=Ne.substr(0,J);J<ze;J+=B)ae+=oe+Ne.substr(J,B);te>0&&(ae+=oe+Ne.slice(J)),Me&&(ae="-"+ae)}V=fe?ae+(R.decimalSeparator||"")+((te=+R.fractionGroupSize)?fe.replace(new RegExp("\\d{"+te+"}\\B","g"),"$&"+(R.fractionGroupSeparator||"")):fe):ae}return(R.prefix||"")+V+(R.suffix||"")},O.toFraction=function(k){var M,R,V,q,J,re,B,te,oe,ae,fe,Me,Ne=this,ze=Ne.c;if(k!=null&&(B=new S(k),!B.isInteger()&&(B.c||B.s!==1)||B.lt(Y)))throw Error(o+"Argument "+(B.isInteger()?"out of range: ":"not an integer: ")+ee(B));if(!ze)return new S(Ne);for(M=new S(Y),oe=R=new S(Y),V=te=new S(Y),Me=p(ze),J=M.e=Me.length-Ne.e-1,M.c[0]=h[(re=J%u)<0?u+re:re],k=!k||B.comparedTo(M)>0?J>0?M:oe:B,re=Ce,Ce=1/0,B=new S(Me),te.c[0]=0;ae=x(B,M,0,1),q=R.plus(ae.times(V)),q.comparedTo(k)!=1;)R=V,V=q,oe=te.plus(ae.times(q=oe)),te=q,M=B.minus(ae.times(q=M)),B=q;return q=x(k.minus(R),V,0,1),te=te.plus(q.times(oe)),R=R.plus(q.times(V)),te.s=oe.s=Ne.s,J=J*2,fe=x(oe,V,J,ie).minus(Ne).abs().comparedTo(x(te,R,J,ie).minus(Ne).abs())<1?[oe,V]:[te,R],Ce=re,fe},O.toNumber=function(){return+ee(this)},O.toPrecision=function(k,M){return k!=null&&v(k,1,d),_(this,k,M,2)},O.toString=function(k){var M,R=this,V=R.s,q=R.e;return q===null?V?(M="Infinity",V<0&&(M="-"+M)):M="NaN":(k==null?M=q<=ce||q>=he?b(p(R.c),q):T(p(R.c),q,"0"):k===10&&C?(R=X(new S(R),L+q+1,ie),M=T(p(R.c),R.e,"0")):(v(k,2,W.length,"Base"),M=P(T(p(R.c),q,"0"),10,k,V,!0)),V<0&&R.c[0]&&(M="-"+M)),M},O.valueOf=O.toJSON=function(){return ee(this)},O._isBigNumber=!0,E!=null&&S.set(E),S}function m(E){var x=E|0;return E>0||E===x?x:x-1}function p(E){for(var x,P,A=1,O=E.length,Y=E[0]+"";A<O;){for(x=E[A++]+"",P=u-x.length;P--;x="0"+x);Y+=x}for(O=Y.length;Y.charCodeAt(--O)===48;);return Y.slice(0,O+1||1)}function w(E,x){var P,A,O=E.c,Y=x.c,L=E.s,ie=x.s,ce=E.e,he=x.e;if(!L||!ie)return null;if(P=O&&!O[0],A=Y&&!Y[0],P||A)return P?A?0:-ie:L;if(L!=ie)return L;if(P=L<0,A=ce==he,!O||!Y)return A?0:!O^P?1:-1;if(!A)return ce>he^P?1:-1;for(ie=(ce=O.length)<(he=Y.length)?ce:he,L=0;L<ie;L++)if(O[L]!=Y[L])return O[L]>Y[L]^P?1:-1;return ce==he?0:ce>he^P?1:-1}function v(E,x,P,A){if(E<x||E>P||E!==s(E))throw Error(o+(A||"Argument")+(typeof E=="number"?E<x||E>P?" out of range: ":" not an integer: ":" not a primitive number: ")+String(E))}function y(E){var x=E.c.length-1;return m(E.e/u)==x&&E.c[x]%2!=0}function b(E,x){return(E.length>1?E.charAt(0)+"."+E.slice(1):E)+(x<0?"e":"e+")+x}function T(E,x,P){var A,O;if(x<0){for(O=P+".";++x;O+=P);E=O+E}else if(A=E.length,++x>A){for(O=P,x-=A;--x;O+=P);E+=O}else x<A&&(E=E.slice(0,x)+"."+E.slice(x));return E}r=g(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(S8e)})(gQ);var mQ=gQ.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ga=VL(),j8e=$L(),U8e=BL,z8e=mQ,ri={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},E1={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:pQ,decimalSuffixes:k_}=ga.currentBytes(),WL={general:{scale:1024,suffixes:k_},binary:{scale:1024,suffixes:pQ},decimal:{scale:1e3,suffixes:k_}};function G8e(t,e={},r){if(typeof e=="string"&&(e=U8e.parseFormat(e)),!j8e.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",o=Y8e(t,e,r);return o=f6e(o,i),o=d6e(o,s),o}function Y8e(t,e,r){switch(e.output){case"currency":return e=sm(e,ga.currentCurrencyDefaultFormat()),t6e(t,e,ga);case"percent":return e=sm(e,ga.currentPercentageDefaultFormat()),e6e(t,e,ga,r);case"byte":return e=sm(e,ga.currentByteDefaultFormat()),J8e(t,e,ga,r);case"time":return e=sm(e,ga.currentTimeDefaultFormat()),Z8e(t);case"ordinal":return e=sm(e,ga.currentOrdinalDefaultFormat()),Q8e(t,e,ga);case"number":default:return R1({instance:t,providedFormat:e})}}function K8e(t){let e=WL.decimal;return VR(t._value,e.suffixes,e.scale).suffix}function X8e(t){let e=WL.binary;return VR(t._value,e.suffixes,e.scale).suffix}function q8e(t){let e=WL.general;return VR(t._value,e.suffixes,e.scale).suffix}function VR(t,e,r){let n=e[0],i=Math.abs(t);if(i>=r){for(let s=1;s<e.length;++s){let o=Math.pow(r,s),a=Math.pow(r,s+1);if(i>=o&&i<a){n=e[s],t=t/o;break}}n===e[0]&&(t=t/Math.pow(r,e.length-1),n=e[e.length-1])}return{value:t,suffix:n}}function J8e(t,e,r,n){let i=e.base||"binary",s=Object.assign({},E1,e);const{binarySuffixes:o,decimalSuffixes:a}=r.currentBytes();let u={general:{scale:1024,suffixes:a||k_,marker:"bd"},binary:{scale:1024,suffixes:o||pQ,marker:"b"},decimal:{scale:1e3,suffixes:a||k_,marker:"d"}}[i],{value:c,suffix:h}=VR(t._value,u.suffixes,u.scale);return`${R1({instance:n(c),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${h}`}function Q8e(t,e,r){let n=r.currentOrdinal(),i=Object.assign({},E1,e),s=R1({instance:t,providedFormat:e,state:r}),o=n(t._value);return`${s}${i.spaceSeparated?" ":""}${o}`}function Z8e(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),n=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${n<10?"0":""}${n}`}function e6e(t,e,r,n){let i=e.prefixSymbol,s=R1({instance:n(t._value*100),providedFormat:e,state:r}),o=Object.assign({},E1,e);return i?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function t6e(t,e,r){const n=r.currentCurrency();let i=Object.assign({},e),s=Object.assign({},E1,i),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,u=i.currencyPosition||n.position,c=i.currencySymbol||n.symbol;const h=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(o=a+c+a);let f=R1({instance:t,providedFormat:i,state:r,decimalSeparator:o});return u==="prefix"&&(t._value<0&&s.negative==="sign"?f=`-${a}${c}${f.slice(1)}`:t._value>0&&s.forceSign?f=`+${a}${c}${f.slice(1)}`:f=c+a+f),(!u||u==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,f=f+a+c),f}function r6e({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:n,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&n[e]&&ri[e]?(a=n[e],t=t/ri[e]):l>=ri.trillion||r&&o(l/ri.trillion)===1?(a=n.trillion,t=t/ri.trillion):l<ri.trillion&&l>=ri.billion||r&&o(l/ri.billion)===1?(a=n.billion,t=t/ri.billion):l<ri.billion&&l>=ri.million||r&&o(l/ri.million)===1?(a=n.million,t=t/ri.million):(l<ri.million&&l>=ri.thousand||r&&o(l/ri.thousand)===1)&&(a=n.thousand,t=t/ri.thousand),a&&(a=(i?" ":"")+a),s){let h=t<0,f=t.toString().split(".")[0],d=h?f.length-1:f.length;u=Math.max(s-d,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function n6e({value:t,characteristicPrecision:e}){let[r,n]=t.toExponential().split("e"),i=+r;if(!e)return{value:i,abbreviation:`e${n}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),n=+n-(e-s),n=n>=0?`+${n}`:n),{value:i,abbreviation:`e${n}`}}function fS(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function i6e(t,e){let r=t.toString(),[n,i]=r.split("e"),[s,o=""]=n.split(".");if(+i>0)r=s+o+fS(i-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=(fS(-i-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=fS(e-l.length)),r=a+l}return+i>0&&e>0&&(r+=`.${fS(e)}`),r}function s6e(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?i6e(t,e):new z8e(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function o6e(t,e,r,n,i,s){if(n===-1)return t;let o=s6e(e,n,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(r||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:o.toString()}function a6e(t,e,r,n){let i=t,[s,o]=i.toString().split(".");if(s.match(/^-?0$/)&&r)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),i=i.slice(1)),s.length<n){let l=n-s.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function l6e(t,e){let r=[],n=0;for(let i=t;i>0;i--)n===e&&(r.unshift(i),n=0),n++;return r}function u6e(t,e,r,n,i){let s=n.currentDelimiters(),o=s.thousands;i=i||s.decimal;let a=s.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return r&&(h&&(u=u.slice(1)),l6e(u.length,a).forEach((d,g)=>{u=u.slice(0,d+g)+o+u.slice(d+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function c6e(t,e){return t+e}function h6e(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function f6e(t,e){return e+t}function d6e(t,e){return t+e}function R1({instance:t,providedFormat:e,state:r=ga,decimalSeparator:n,defaults:i=r.currentDefaults()}){let s=t._value;if(s===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},E1,i,e),a=o.totalLength,l=a?0:o.characteristic,u=o.optionalCharacteristic,c=o.forceAverage,h=o.lowPrecision,f=!!a||!!c||o.average,d=a?-1:f&&e.mantissa===void 0?0:o.mantissa,g=a?!1:e.optionalMantissa===void 0?d===-1:o.optionalMantissa,m=o.trimMantissa,p=o.thousandSeparated,w=o.spaceSeparated,v=o.negative,y=o.forceSign,b=o.exponential,T=o.roundingFunction,E="";if(f){let P=r6e({value:s,forceAverage:c,lowPrecision:h,abbreviations:r.currentAbbreviations(),spaceSeparated:w,roundingFunction:T,totalLength:a});s=P.value,E+=P.abbreviation,a&&(d=P.mantissaPrecision)}if(b){let P=n6e({value:s,characteristicPrecision:l});s=P.value,E=P.abbreviation+E}let x=o6e(s.toString(),s,g,d,m,T);return x=a6e(x,s,u,l),x=u6e(x,s,p,r,n),(f||b)&&(x=c6e(x,E)),(y||s<0)&&(x=h6e(x,s,v)),x}function sm(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var g6e=t=>({format:(...e)=>G8e(...e,t),getByteUnit:(...e)=>q8e(...e,t),getBinaryByteUnit:(...e)=>X8e(...e,t),getDecimalByteUnit:(...e)=>K8e(...e,t),formatOrDefault:sm});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Xu=mQ;function m6e(t,e,r){let n=new Xu(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Xu(i),t._value=n.plus(i).toNumber(),t}function vQ(t,e,r){let n=new Xu(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Xu(i),t._value=n.minus(i).toNumber(),t}function p6e(t,e,r){let n=new Xu(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Xu(i),t._value=n.times(i).toNumber(),t}function v6e(t,e,r){let n=new Xu(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new Xu(i),t._value=n.dividedBy(i).toNumber(),t}function w6e(t,e,r){let n=e;return r.isNumbro(e)&&(n=e._value),t._value=n,t}function y6e(t,e,r){let n=r(t._value);return vQ(n,e,r),Math.abs(n._value)}var C6e=t=>({add:(e,r)=>m6e(e,r,t),subtract:(e,r)=>vQ(e,r,t),multiply:(e,r)=>p6e(e,r,t),divide:(e,r)=>v6e(e,r,t),set:(e,r)=>w6e(e,r,t),difference:(e,r)=>y6e(e,r,t),BigNumber:Xu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const S6e="2.5.0",Gl=VL(),x6e=$L(),b6e=W8e(un),_6e=dQ();let uf=g6e(un),Lf=C6e(un);const E6e=BL;class wQ{constructor(e){this._value=e}clone(){return un(this._value)}format(e={}){return uf.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=E6e.parseFormat(e)),e=uf.formatOrDefault(e,Gl.currentCurrencyDefaultFormat()),e.output="currency",uf.format(this,e)}formatTime(e={}){return e.output="time",uf.format(this,e)}binaryByteUnits(){return uf.getBinaryByteUnit(this)}decimalByteUnits(){return uf.getDecimalByteUnit(this)}byteUnits(){return uf.getByteUnit(this)}difference(e){return Lf.difference(this,e)}add(e){return Lf.add(this,e)}subtract(e){return Lf.subtract(this,e)}multiply(e){return Lf.multiply(this,e)}divide(e){return Lf.divide(this,e)}set(e){return Lf.set(this,yQ(e))}value(){return this._value}valueOf(){return this._value}}function yQ(t){let e=t;return un.isNumbro(t)?e=t._value:typeof t=="string"?e=un.unformat(t):isNaN(t)&&(e=NaN),e}function un(t){return new wQ(yQ(t))}un.version=S6e;un.isNumbro=function(t){return t instanceof wQ};un.language=Gl.currentLanguage;un.registerLanguage=Gl.registerLanguage;un.setLanguage=Gl.setLanguage;un.languages=Gl.languages;un.languageData=Gl.languageData;un.zeroFormat=Gl.setZeroFormat;un.defaultFormat=Gl.currentDefaults;un.setDefaults=Gl.setDefaults;un.defaultCurrencyFormat=Gl.currentCurrencyDefaultFormat;un.validate=x6e.validate;un.loadLanguagesInNode=b6e.loadLanguagesInNode;un.unformat=_6e.unformat;un.BigNumber=Lf.BigNumber;var R6e=un,cf=x8e(R6e);const T6e="numeric";function CQ(t,e){if(qi(t)){const r=e.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if(typeof n<"u"&&!cf.languages()[n]){const s=n.replace("-",""),o=cf.allLanguages?cf.allLanguages[n]:cf[s];o&&cf.registerLanguage(o)}cf.setLanguage(n),t=cf(t).format(i||"0")}return t}function jL(t,e,r,n,i,s,o){let a=s;if(qi(a)){let u=[];if(Array.isArray(o.className))u=o.className;else{var l;const c=(l=o.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=CQ(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}uc(t,e,r,n,i,a,o)}jL.RENDERER_TYPE=T6e;const k6e="password";function UL(t,e,r,n,i,s,o){uc.apply(this,[t,e,r,n,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";je(a-1,()=>{u+=l}),Gp(e,u)}UL.RENDERER_TYPE=k6e;const P6e="select";function zL(t,e,r,n,i,s,o){uc.apply(this,[t,e,r,n,i,s,o])}zL.RENDERER_TYPE=P6e;const A6e="time";function GL(t,e,r,n,i,s,o){uc.apply(this,[t,e,r,n,i,s,o]),e.dir="ltr"}GL.RENDERER_TYPE=A6e;function I6e(){bo(qp),bo(_1),bo(FL),bo(DL),bo(LL),bo(NL),bo(jL),bo(UL),bo(zL),bo(uc),bo(GL)}const O6e="autocomplete";function WR(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,P6(r,e)):P6(r,e)(this.source):e(!0)}WR.VALIDATOR_TYPE=O6e;function P6(t,e){const r=t;return function(n){let i=!1;for(let s=0,o=n.length;s<o;s++)if(r===n[s]){i=!0;break}e(i)}}function M6e(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const N6e="date";function YL(t,e){const r=$q(sQ,this.instance);let n=t,i=!0;n==null&&(n="");let s=_e(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=_e(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=D6e(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}YL.VALIDATOR_TYPE=N6e;function D6e(t,e){const r=_e(M6e(t)),n=_e(t,e),i=t.search(/[A-Za-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const F6e="dropdown";function KL(t,e){WR.apply(this,[t,e])}KL.VALIDATOR_TYPE=F6e;const H6e="numeric";function XL(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:qi(t))}XL.VALIDATOR_TYPE=H6e;const L6e=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],$6e="time";function qL(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=_e(i,L6e,!0).isValid()?_e(i):_e(i,r);let a=o.isValid(),l=_e(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(n=!1),!a&&l&&(n=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),n=!0}else n=!1;e(n)}qL.VALIDATOR_TYPE=$6e;function B6e(){nm(WR),nm(KL),nm(YL),nm(XL),nm(qL)}const V6e="autocomplete",W6e={CELL_TYPE:V6e,editor:OL,renderer:qp,validator:WR},j6e="checkbox",U6e={CELL_TYPE:j6e,editor:iQ,renderer:FL},z6e="date";function SQ(t,e,r,n,i,s,o){qp.apply(this,[t,e,r,n,i,s,o])}SQ.RENDERER_TYPE=z6e;const G6e="date",Y6e={CELL_TYPE:G6e,editor:oQ,renderer:SQ,validator:YL},K6e="dropdown",X6e={CELL_TYPE:K6e,editor:aQ,renderer:DL,validator:KL,filter:!1,strict:!0},q6e="handsontable",J6e={CELL_TYPE:q6e,editor:IL,renderer:LL},Q6e="numeric",Z6e={CELL_TYPE:Q6e,editor:lQ,renderer:jL,validator:XL,dataType:"number"},eje="password",tje={CELL_TYPE:eje,editor:uQ,renderer:UL,copyable:!1},rje="select",nje={CELL_TYPE:rje,editor:cQ,renderer:zL},ije="time",sje={CELL_TYPE:ije,editor:hQ,renderer:GL,validator:qL};function oje(){ha(W6e),ha(U6e),ha(Y6e),ha(X6e),ha(J6e),ha(Z6e),ha(tje),ha(nje),ha(YJ),ha(sje)}function aje(t,e){xQ(t,e),e.add(t)}function lje(t,e,r){xQ(t,e),e.set(t,r)}function xQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eg(t,e,r){return(e=uje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uje(t){var e=cje(t,"string");return typeof e=="symbol"?e:e+""}function cje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rg(t,e){return t.get(bQ(t,e))}function bQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const A6=new Map([["plugin",zFe],["cell-type",NJ],["editor",Lq],["renderer",Kq],["validator",Xq]]),_Q=Symbol("mainSetting"),hje="base",dS=[];let hf=null;var ff=new WeakMap,I6=new WeakSet;class zt{static get PLUGIN_KEY(){return hje}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){aje(this,I6),Eg(this,"eventManager",new $a(this)),Eg(this,"pluginName",null),Eg(this,"pluginsInitializedCallbacks",[]),Eg(this,"isPluginsReady",!1),Eg(this,"enabled",!1),Eg(this,"initialized",!1),lje(this,ff,{}),ac(this,"hot",e,{writable:!1}),hf=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[o,a]=s.split(":");if(!A6.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);A6.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");dS.push(s)}}if(hf||(hf=Yq()),hf.indexOf(this.pluginName)>=0&&hf.splice(hf.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),hf.length===0){if(dS.length>0){const i=[`${dS.join(`
`)}
`,"You have to import and register them manually."].join("");throw dS.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||yt(r))&&n[_Q]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(yt(r)){var s;return(s=r[e])!==null&&s!==void 0?s:n[e]}return n[e]}addHook(e,r,n){Rg(ff,this)[e]=Rg(ff,this)[e]||[];const i=Rg(ff,this)[e];this.hot.addHook(e,r,n),i.push(r),Rg(ff,this)[e]=i}removeHooks(e){Z(Rg(ff,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Rg(ff,this);Ct(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Z(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=bQ(I6,this,fje).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ct(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function fje(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function df(t,e,r){return(e=dje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dje(t){var e=gje(t,"string");return typeof e=="symbol"?e:e+""}function gje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let EQ=class{constructor(e){df(this,"hot",null),df(this,"container",null),df(this,"injected",!1),df(this,"rows",[]),df(this,"columns",[]),df(this,"samples",null),df(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Se(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Z(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),Z(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{Z(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{Z(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{Z(i.strings,s=>{const o=s.col,a=e.createElement("th");n.push([o,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),Z(n,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{Z(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return n.style.width=`${s}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),o=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),Se(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return Se(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function gS(t,e,r){return(e=mje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mje(t){var e=pje(t,"string");return typeof e=="symbol"?e:e+""}function pje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jR{static get SAMPLE_COUNT(){return 3}constructor(e){gS(this,"samples",null),gS(this,"dataFactory",null),gS(this,"customSampleCount",null),gS(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:jR.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:o}=typeof n=="number"?{from:n,to:n}:n;return je(s,o,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return je(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let f;h?f=c:yt(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Fr(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const d=i.get(f);d.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||h)&&(d.strings.push({value:u,[s]:a}),o.push(u),d.needed-=1)}),i}}function vje(t,e){RQ(t,e),e.add(t)}function eA(t,e,r){RQ(t,e),e.set(t,r)}function RQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $0(t,e,r){return(e=wje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wje(t){var e=yje(t,"string");return typeof e=="symbol"?e:e+""}function yje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sh(t,e){return t.get(ws(t,e))}function P_(t,e,r){return t.set(ws(t,e),r),r}function ws(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("modifyAutoColumnSizeSeed");const tA="autoColumnSize",Cje=10,Sje="autoColumnSize";var JL=new WeakMap,om=new WeakMap,Ep=new WeakMap,Vs=new WeakSet;class ow extends zt{static get PLUGIN_KEY(){return tA}static get PLUGIN_PRIORITY(){return Cje}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),vje(this,Vs),$0(this,"ghostTable",new EQ(this.hot)),$0(this,"samplesGenerator",new jR((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(r,n);let a="";o.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),$0(this,"inProgress",!1),$0(this,"measuredColumns",0),$0(this,"columnWidthsMap",new jh),eA(this,JL,!1),eA(this,om,[]),eA(this,Ep,[]),this.hot.columnIndexMapper.registerMap(Sje,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>ws(Vs,this,O6).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[tA]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ws(Vs,e,_je).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ws(Vs,e,Eje).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ws(Vs,e,Tje).call(e,...i)}),this.addHook("beforeRender",()=>ws(Vs,this,bje).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>ws(Vs,this,Rje).call(this)),super.enablePlugin()}updatePlugin(){P_(Ep,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>ws(Vs,this,O6).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;je(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&ws(Vs,this,TQ).call(this,o,s)}),this.ghostTable.columns.length&&(ws(Vs,this,kQ).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){p_(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+ow.CALCULATION_STEP,i)},e,r),n=n+ow.CALCULATION_STEP+1,n<i?s=m_(o):(p_(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[tA];let r=ow.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return yt(e)&&(r=e.syncLimit,nq(r)?r=Uq(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,wp))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,s)=>{const o=sh(om,this).length;return(o-1<s||sh(om,this)[s]!==i)&&n.push(this.hot.toVisualColumn(s)),o-1<s?sh(om,this).push(i):sh(om,this)[s]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function xje(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||ws(Vs,this,TQ).call(this,r,e))}),this.ghostTable.columns.length&&(ws(Vs,this,kQ).call(this),this.ghostTable.clean())}function TQ(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function kQ(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function bje(){this.calculateVisibleColumnsWidth(),this.inProgress||(ws(Vs,this,xje).call(this,sh(Ep,this)),P_(Ep,this,[]))}function _je(t,e){e||this.recalculateAllColumnsWidth()}function Eje(t){const e=t.reduce((r,n)=>{let[,i]=n;const s=this.hot.propToCol(i);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);sh(Ep,this).push(...e)}function O6(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function Rje(){P_(om,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),P_(JL,this,!0)}function Tje(t){if(!sh(JL,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);sh(Ep,this).push(...e)}const Jf={horizontal:"horizontal",vertical:"vertical"};function kje(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function Pje(t){const e={};return t===!0?(e.directions=Object.keys(Jf),e.autoInsertRow=!0):yt(t)?(Le(t.autoInsertRow)?t.direction===Jf.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Jf)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Aje(t,e){Ije(t,e),e.add(t)}function Ije(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tg(t,e,r){return(e=Oje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oje(t){var e=Mje(t,"string");return typeof e=="symbol"?e:e+""}function Mje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("modifyAutofillRange");Fe.getSingleton().register("beforeAutofill");Fe.getSingleton().register("afterAutofill");const M6="autofill",Nje=20,Dje=["fillHandle"],Fje="insert_row_below",Hje=200;var kg=new WeakSet;class Lje extends zt{constructor(){super(...arguments),Aje(this,kg),Tg(this,"addingStarted",!1),Tg(this,"mouseDownOnCellCorner",!1),Tg(this,"mouseDragOutside",!1),Tg(this,"handleDraggedCells",0),Tg(this,"directions",[]),Tg(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return M6}static get PLUGIN_PRIORITY(){return Nje}static get SETTING_KEYS(){return[M6,...Dje]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>B0(kg,this,Bje).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>B0(kg,this,$je).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>B0(kg,this,Vje).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:n,endRow:i,endCol:s}]),a=[],l=[],u=[];return Z(o,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),Z(a,c=>{const h=[];Z(l,f=>{h.push(this.hot.getCopyableData(c,f))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(a.row,n),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:f}=kje(l,u,(d,g)=>this.hot._createCellCoords(d,g));if(h&&h.row>-1&&h.col>-1){const d=this.getSelectionData(),g=s.clone(),m=this.hot._createCellRange(h,h,f),p=this.hot.runHooks("beforeAutofill",d,g,m,c);if(p===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let w=p;const v=p;if(["up","left"].indexOf(c)>-1&&!(v.length===1&&v[0].length===0))if(w=[],c==="up"){const y=f.row-h.row+1,b=y%v.length;for(let T=0;T<y;T++)w.push(v[(T+(v.length-b))%v.length])}else{const y=f.col-h.col+1,b=y%v[0].length;for(let T=0;T<v.length;T++){w.push([]);for(let E=0;E<y;E++)w[T].push(v[T][(E+(v[T].length-b))%v[T].length])}}this.hot.populateFromArray(h.row,h.col,w,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",w,g,m,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(Jf.vertical)&&this.directions.includes(Jf.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(Jf.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(Jf.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Fje,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Hje)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let l=e[1];l<=e[3];l++){const u=r[s][l];if(!an(u))return-1}const o=r[s][e[1]-1],a=r[s][e[3]+1];(!an(o)||!an(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...Pt(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=Pi(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+An(this.hot.table),i=Pi(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+mn(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>B0(kg,this,Wje).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>B0(kg,this,jje).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Pje(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function $je(){this.selectAdjacent()&&this.fillIn()}function Bje(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Vje(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Wje(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function jje(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Uje(t,e){PQ(t,e),e.add(t)}function N6(t,e,r){PQ(t,e),e.set(t,r)}function PQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pg(t,e,r){return(e=zje(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zje(t){var e=Gje(t,"string");return typeof e=="symbol"?e:e+""}function Gje(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AQ(t,e,r){return t.set(Sl(t,e),r),r}function A_(t,e){return t.get(Sl(t,e))}function Sl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const rA="autoRowSize",Yje=40,Kje="autoRowSize";var _y=new WeakMap,QL=new WeakMap,uu=new WeakSet;class aw extends zt{static get PLUGIN_KEY(){return rA}static get PLUGIN_PRIORITY(){return Yje}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Uje(this,uu),Pg(this,"headerHeight",null),Pg(this,"ghostTable",new EQ(this.hot)),Pg(this,"samplesGenerator",new jR((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||r>=0&&n>=0&&this.hot.getCellMeta(r,n).hidden)return!1;let o;return r>=0?o=this.hot.getDataAtCell(r,n):r===-1&&(o=this.hot.getColHeader(n)),{value:o}})),Pg(this,"inProgress",!1),Pg(this,"measuredRows",0),Pg(this,"rowHeightsMap",new jh),N6(this,_y,[]),N6(this,QL,!1),this.hot.rowIndexMapper.registerMap(Kje,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>Sl(uu,this,D6).call(this,r,n,i))}isEnabled(){const e=this.hot.getSettings()[rA];return e===!0||yt(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sl(uu,e,Jje).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sl(uu,e,Qje).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Sl(uu,e,eUe).call(e,...i)}),this.addHook("beforeRender",()=>Sl(uu,this,qje).call(this)),this.addHook("modifyRowHeight",(n,i)=>this.getRowHeight(i,n)),this.addHook("init",()=>Sl(uu,this,Zje).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,n)=>Sl(uu,this,D6).call(this,e,r,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:r},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}je(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(n||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){p_(s),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+aw.CALCULATION_STEP,i)},e,r),n=n+aw.CALCULATION_STEP+1,n<i?s=m_(o):(p_(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,r),n=a+1),n<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[rA];let r=aw.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return yt(e)&&(r=e.syncLimit,nq(r)?r=Uq(n,r):r>>=0),Math.min(r,n)}getRowHeight(e,r){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=r;return n!==null&&n>(r||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{je(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Xje(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{const i=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function qje(){this.calculateVisibleRowsHeight(),this.inProgress||(Sl(uu,this,Xje).call(this,A_(_y,this)),AQ(_y,this,[]))}function D6(t,e,r){let n=t;return r&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function Jje(t,e){e||this.recalculateAllRowsHeight()}function Qje(t){const e=t.reduce((r,n)=>{let[i]=n;return r.indexOf(i)===-1&&r.push(i),r},[]);A_(_y,this).push(...e)}function Zje(){this.recalculateAllRowsHeight(),AQ(QL,this,!0)}function eUe(t){if(!A_(QL,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);A_(_y,this).push(...e)}const{getListWithInsertedItems:tUe,getListWithRemovedItems:rUe}=pJ("physicallyIndexed");class nUe extends ig{constructor(){super(e=>e)}insert(e,r){const n=nH(this.indexedValues,r);this.indexedValues=tUe(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=rUe(this.indexedValues,e);this.indexedValues=rH(r,e),super.remove(e)}}const{getListWithInsertedItems:iUe,getListWithRemovedItems:sUe}=pJ("physicallyIndexed");class oUe extends ig{constructor(){super(e=>e)}insert(e,r){this.indexedValues=iUe(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=sUe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function aUe(t,e){lUe(t,e),e.add(t)}function lUe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uUe(t,e,r){return(e=cUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cUe(t){var e=hUe(t,"string");return typeof e=="symbol"?e:e+""}function hUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fUe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const F6="bindRowsWithHeaders",dUe=210,gUe="loose",H6=new Map([["loose",nUe],["strict",oUe]]);var L6=new WeakSet;class mUe extends zt{constructor(){super(...arguments),aUe(this,L6),uUe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return F6}static get PLUGIN_PRIORITY(){return dUe}isEnabled(){return!!this.hot.getSettings()[F6]}enablePlugin(){var e;if(this.enabled)return;const r=(e=H6.get(this.getSetting()))!==null&&e!==void 0?e:H6.get(gUe);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>fUe(L6,this,pUe).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function pUe(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function vUe(t,e){IQ(t,e),e.add(t)}function wUe(t,e,r){IQ(t,e),e.set(t,r)}function IQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $6(t,e,r){return(e=yUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yUe(t){var e=CUe(t,"string");return typeof e=="symbol"?e:e+""}function CUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B6(t,e){return t.get(Im(t,e))}function nA(t,e,r){return t.set(Im(t,e),r),r}function Im(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Yx="collapsibleColumns",SUe=290,xUe=["nestedHeaders"],Jm="collapsibleIndicator",V6=Yx,W6=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Ag=new WeakMap,V0=new WeakSet;class bUe extends zt{constructor(){super(...arguments),vUe(this,V0),$6(this,"nestedHeadersPlugin",null),$6(this,"headerStateManager",null),wUe(this,Ag,null)}static get PLUGIN_KEY(){return Yx}static get PLUGIN_PRIORITY(){return SUe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Yx,...xUe]}isEnabled(){return!!this.hot.getSettings()[Yx]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||Ut("You need to configure the Nested Headers plugin in order to use collapsible headers."),nA(Ag,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Im(V0,this,RUe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Im(V0,e,TUe).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Im(V0,e,_Ue).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>Im(V0,this,EUe).call(this,n,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),nA(Ag,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,n))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:V6,relativeToGroup:Uh,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(V6)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};je(0,e-1,o=>{const a=r.childNodes[o],l=n.childNodes[o],u=i?i.childNodes[o]:null;je(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Jm}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Jm}`),s(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Jm}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=n;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!W6.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=Ad(e,d=>{let{row:g}=d;return g<0});let i=n.length>0;Z(n,d=>{var g;let{row:m,col:p}=d;const{collapsible:w,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(m,p))!==null&&g!==void 0?g:{};if(!w||v&&r==="collapse"||!v&&r==="expand")return i=!1,!1});const s=[],o=[];i&&Z(n,d=>{let{row:g,col:m}=d;const{colspanCompensation:p,affectedColumns:w,rollbackModification:v}=this.headerStateManager.triggerNodeModification(r,g,m);p>0&&(o.push(...w),s.push(v))});const a=this.getCollapsedColumns();let l=[];r==="collapse"?l=A2e([...a,...o]):r==="expand"&&(l=Ad(a,d=>!o.includes(d)));const u=W6.get(r);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){Z(s,d=>{d()});return}this.hot.batchExecution(()=>{Z(o,d=>{B6(Ag,this).setValueAtIndex(this.hot.toPhysicalColumn(d),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,f=this.hot.getSelectedRangeLast();if(r==="collapse"&&h&&f){const{row:d,col:g}=f.highlight;if((this.hot.rowIndexMapper.isHidden(d)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const p=d>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(d,1,!0):d,w=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;p!==null&&w!==null&&this.hot.selectCell(p,w)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return B6(Ag,this).getHiddenIndexes()}destroy(){nA(Ag,this,null),super.destroy()}}function _Ue(t,e,r){var n;const{collapsible:i,origColspan:s,isCollapsed:o}=(n=this.headerStateManager.getHeaderSettings(r,t))!==null&&n!==void 0?n:{},a=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Jm}`);if(zp(e,[Wo("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),Se(u,Jm),e.querySelector("div:first-child").appendChild(u)),qe(u,["collapsed","expanded"]),o?(Se(u,"collapsed"),Od(u,"+"),l&&Ze(e,...Wo(!1))):(Se(u,"expanded"),Od(u,"-"),l&&Ze(e,...Wo(!0))),l&&Ze(u,...ng());else{var c;(c=u)===null||c===void 0||c.remove()}}function EUe(t,e){et(t.target,Jm)&&(et(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):et(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ja(t))}function RUe(){this.updatePlugin()}function TUe(t,e){e||this.updatePlugin()}function gf(t,e,r){return(e=kUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kUe(t){var e=PUe(t,"string");return typeof e=="symbol"?e:e+""}function PUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const AUe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],IUe=!1,OUe=!0,MUe=!0;class NUe{constructor(e,r){gf(this,"hot",void 0),gf(this,"sortingStates",new NR),gf(this,"sortEmptyCells",IUe),gf(this,"indicator",OUe),gf(this,"headerAction",MUe),gf(this,"compareFunctionFactory",void 0),gf(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){yt(e)&&Ct(e,(r,n)=>{AUe.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return yt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(Le(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function OQ(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:o}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?Dl:an(i)?an(s)?Dl:o&&t==="asc"?jr:Ur:an(s)?o&&t==="asc"?Ur:jr:isNaN(i)&&!isNaN(s)?t==="asc"?Ur:jr:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?jr:Ur:i>s?t==="asc"?Ur:jr:Dl}}const MQ="default";function DUe(t,e,r){return function(n,i){const s=parseFloat(n),o=parseFloat(i),{sortEmptyCells:a}=r;if(s===o||isNaN(s)&&isNaN(o))return Dl;if(a){if(an(n))return t==="asc"?jr:Ur;if(an(i))return t==="asc"?Ur:jr}return isNaN(s)?Ur:isNaN(o)?jr:s<o?t==="asc"?jr:Ur:s>o?t==="asc"?Ur:jr:Dl}}const FUe="numeric";function HUe(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(o,a){const l=an(o),u=an(a),c=l?i:o,h=u?i:a,f=c===i||c===n,d=h===i||h===n;if(s===!1){if(l&&u===!1)return Ur;if(l===!1&&u)return jr}return f===!1&&d?t==="asc"?jr:Ur:f&&d===!1?t==="asc"?Ur:jr:f===!1&&d===!1?OQ(t,e,r)(o,a):c===i&&h===n?t==="asc"?jr:Ur:c===n&&h===i?t==="asc"?Ur:jr:Dl}}const LUe="checkbox";function $Ue(t,e,r){return $Q(t,e.dateFormat,r)}const BUe="date";function VUe(t,e,r){return $Q(t,e.timeFormat,r)}const WUe="time",{register:T1,getItem:j6,hasItem:jUe}=Qo("sorting.compareFunctionFactory"),{register:NQ,getItem:UUe}=Qo("sorting.mainSortComparator");function DQ(t){return jUe(t)?j6(t):j6(MQ)}T1(LUe,HUe);T1(BUe,$Ue);T1(MQ,OQ);T1(FUe,DUe);T1(WUe,VUe);const Dl=0,jr=-1,Ur=1;function zUe(t,e){const r=UUe(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}const I_="asc",O_="desc",FQ="colHeader";function GUe(t){if(yt(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[I_,O_].includes(r)}function YUe(t){if(t.some(r=>GUe(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function U6(t){if(t!==O_)return t===I_?O_:I_}function HQ(t){return t.querySelector(`.${FQ}`)}function LQ(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function ZL(t,e,r){return t===-1&&e>=0&&Md(r)===!1}function $Q(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return Dl;if(an(n))return an(i)?Dl:s&&t==="asc"?jr:Ur;if(an(i))return s&&t==="asc"?Ur:jr;const o=_e(n,e),a=_e(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?jr:Ur:a.isBefore(o)?t==="asc"?Ur:jr:Dl:jr:Ur}}function KUe(t,e){Ut(Jt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const XUe="ascending",qUe="descending",BQ="indicatorDisabled",VQ="columnSorting",WQ="sortAction",jQ=new Map([[I_,XUe],[O_,qUe]]);function JUe(t,e,r,n){const i=[VQ];if(n&&i.push(WQ),r===!1)return i.push(BQ),i;const s=t.getSortOrderOfColumn(e);return Le(s)&&i.push(jQ.get(s)),i}function QUe(){return Array.from(jQ.values()).concat(WQ,BQ,VQ)}function ZUe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(a){const l=t[a],u=e[a],c=i[a],h=s[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:DQ(u.type))(l,u,f)(c,h)}(0)}}function e5e(t,e){t5e(t,e),e.add(t)}function t5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mS(t,e,r){return(e=r5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r5e(t){var e=n5e(t,"string");return typeof e=="symbol"?e:e+""}function n5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function am(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const M_="columnSorting",i5e=50,N_="append",s5e="replace",z6=M_;NQ(M_,ZUe);Fe.getSingleton().register("beforeColumnSort");Fe.getSingleton().register("afterColumnSort");const W0=new WeakMap;var $f=new WeakSet;class UQ extends zt{constructor(){super(...arguments),e5e(this,$f),mS(this,"columnStatesManager",null),mS(this,"columnMetaCache",null),mS(this,"pluginKey",M_),mS(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return M_}static get PLUGIN_PRIORITY(){return i5e}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(W0.has(this.hot)&&W0.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),KUe(W0.get(this.hot),this.pluginKey);return}this.enabled||(W0.set(this.hot,this.pluginKey),this.columnStatesManager=new NUe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new jh(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>am($f,this,o5e).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return am($f,e,l5e).call(e,...n)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>am($f,this,qM).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return am($f,e,a5e).call(e,...n)}),this.hot.view&&am($f,this,qM).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=HQ(n);LQ(r,n)===!1||i===null||this.updateHeaderClasses(i)};W0.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:Uh,position:"before",group:z6})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(z6)}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new vJ),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return YUe(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};r.initialConfig=Pt(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return Le(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=Pt(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(Le(r)){const i=U6(r);return Le(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:U6()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:N_;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(Dr(o))return[...s.slice(0,n),...s.slice(n+1)];if(r===N_)return[...s.slice(0,n),...s.slice(n+1),o];if(r===s5e)return[...s.slice(0,n),o,...s.slice(n+1)]}return Le(o)?s.concat(o):s}getPluginColumnConfig(e){if(yt(e)){const r=e[this.pluginKey];if(yt(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):Zt(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],n=this.hot.countRows(),i=u=>Pt(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(n);u+=1)r.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=Pt(r,u=>u[0]);zUe(r,this.pluginKey,Pt(e,u=>u.sortOrder),Pt(e,u=>this.getFirstCellSettings(u.column)));for(let u=r.length;u<n;u+=1)r.push([u].concat(i(u)));const o=Pt(r,u=>u[0]),a=new Map(Pt(s,(u,c)=>[u,o[c]])),l=Pt(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(yt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||yt(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(qe(e,QUe()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];Se(e,JUe(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&et(e.target,FQ)}onAfterOnCellMouseDown(e,r){if(ZL(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const n=this.hot.getActiveEditor(),i=this.getColumnNextConfig(r.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function qM(){const t=this.getAllSavedSortSettings();if(yt(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function o5e(t,e){const r=HQ(e);if(LQ(t,e)===!1||r===null)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);Ze(e,...Q2e(o?`${o}ending`:"none"))}}function a5e(t){t===!0&&this.hot.view&&am($f,this,qM).call(this)}function l5e(t,e,r,n){ZL(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function mf(t,e,r){return(e=u5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u5e(t){var e=c5e(t,"string");return typeof e=="symbol"?e:e+""}function c5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h5e{constructor(e,r){mf(this,"plugin",void 0),mf(this,"hot",void 0),mf(this,"endpoints",[]),mf(this,"settings",void 0),mf(this,"settingsType","array"),mf(this,"currentEndpoint",null),mf(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),Z(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();Z(s,o=>{i==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=n:e==="remove_row"&&(o.alterRowOffset=-1*n)),i==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=n:e==="remove_col"&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=r;Z(u,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*n),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*n)}),this.resetAllEndpoints(u,!c),c?Z(u,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):Z(u,f=>{this.shiftEndpointCoordinates(f,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){Z(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];Z(r,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),Z(i,s=>{let o=[];Z(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),n.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),n.push(o))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,Z(e.ranges,n=>{Z(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],Z(e,i=>{this.resetEndpointValue(i,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Z(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],Z(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&Z(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&r.indexOf(a)===-1&&r.push(a)})}),Z(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const n=this.hot.getCellMeta(r,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ut("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function iA(t){return t==null||isNaN(t)}function f5e(t,e){d5e(t,e),e.add(t)}function d5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g5e(t,e,r){return(e=m5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m5e(t){var e=p5e(t,"string");return typeof e=="symbol"?e:e+""}function p5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const sA="columnSummary",v5e=220;var j0=new WeakSet;class w5e extends zt{constructor(){super(...arguments),f5e(this,j0),g5e(this,"endpoints",null)}static get PLUGIN_KEY(){return sA}static get PLUGIN_PRIORITY(){return v5e}isEnabled(){return!!this.hot.getSettings()[sA]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[sA],this.endpoints=new h5e(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return pS(j0,e,y5e).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return pS(j0,e,S5e).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return pS(j0,e,C5e).call(e,...n)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return pS(j0,e,x5e).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return Ct(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,r),s=iA(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,r){let n=null;return Ct(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,r),o=iA(o)?null:o,i===null)i=o;else if(o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=iA(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return Ct(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);r+=s,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),o="";if(n!==null&&i!==null&&(o=this.hot.getCellMeta(n,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Jt`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function y5e(){this.endpoints.initEndpoints()}function C5e(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function S5e(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function x5e(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function b5e(t,e){zQ(t,e),e.add(t)}function oA(t,e,r){zQ(t,e),e.set(t,r)}function zQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lm(t,e){return t.get(e$(t,e))}function JM(t,e,r){return t.set(e$(t,e),r),r}function e$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var D_=new WeakMap,vS=new WeakMap,wS=new WeakMap,G6=new WeakSet;class GQ{constructor(){b5e(this,G6),oA(this,D_,!0),oA(this,vS,null),oA(this,wS,new ResizeObserver(e=>e$(G6,this,_5e).call(this,e)))}setObservedElement(e){JM(vS,this,e)}unobserve(){lm(wS,this).unobserve(lm(vS,this))}observe(){JM(D_,this,!0),lm(wS,this).observe(lm(vS,this))}destroy(){lm(wS,this).disconnect()}}function _5e(t){if(lm(D_,this)||!Array.isArray(t)||!t.length){JM(D_,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:n,blockSize:i}=r[0];this.runLocalHooks("resize",n,i)})}ur(GQ,hi);function yc(t,e,r){E5e(t,e),e.set(t,r)}function E5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(t,e){return t.get(YQ(t,e))}function rl(t,e,r){return t.set(YQ(t,e),r),r}function YQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ig=new WeakMap,aA=new WeakMap,lA=new WeakMap,ru=new WeakMap,Cc=new WeakMap,Sc=new WeakMap,yS=new WeakMap,Og=new WeakMap;class Qf{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r,n){var i=this;yc(this,Ig,void 0),yc(this,aA,void 0),yc(this,lA,!1),yc(this,ru,null),yc(this,Cc,void 0),yc(this,Sc,void 0),yc(this,yS,!0),yc(this,Og,new GQ),rl(Ig,this,e),rl(aA,this,n),rl(lA,this,r),rl(Cc,this,this.createEditor()),rl(Sc,this,rr(Cc,this).style),rr(Og,this).setObservedElement(this.getInputElement()),rr(Og,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,r){rr(Sc,this).left=`${e}px`,rr(Sc,this).top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:mn(this.getInputElement()),height:An(this.getInputElement())}}observeSize(){rr(Og,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){rr(Sc,this).display="block",rl(yS,this,!1)}hide(){rr(Og,this).unobserve(),rr(yS,this)||(rr(Sc,this).display="none"),rl(yS,this,!0)}isVisible(){return rr(Sc,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return rr(Ig,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=rr(Ig,this).createElement("div"),r=rr(Ig,this).createElement("textarea");return e.style.display="none",rl(ru,this,rr(Ig,this).createElement("div")),rr(ru,this).setAttribute("dir",rr(lA,this)?"rtl":"ltr"),Se(rr(ru,this),Qf.CLASS_EDITOR_CONTAINER),rr(aA,this).appendChild(rr(ru,this)),Se(e,Qf.CLASS_EDITOR),Se(r,Qf.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),rr(ru,this).appendChild(e),e}getInputElement(){return rr(Cc,this).querySelector(`.${Qf.CLASS_INPUT}`)}getEditorElement(){return rr(Cc,this)}destroy(){const e=rr(ru,this)?rr(ru,this).parentNode:null;rr(Cc,this).parentNode.removeChild(rr(Cc,this)),rl(Cc,this,null),rl(Sc,this,null),rr(Og,this).destroy(),e&&e.removeChild(rr(ru,this))}}ur(Qf,hi);function uA(t,e,r){return(e=R5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R5e(t){var e=T5e(t,"string");return typeof e=="symbol"?e:e+""}function T5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const k5e=250,P5e=250;class KQ{constructor(e){uA(this,"wasLastActionShow",!0),uA(this,"showDebounced",null),uA(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},P5e)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:k5e;this.showDebounced=kR(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}ur(KQ,hi);function A5e(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function I5e(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function pf(t,e){const r={};return Z(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function Nc(t,e,r,n,i){Z(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&O5e(o,a,e,r,n,i)})})}function O5e(t,e,r,n,i,s){const o=i(t,e);let a=n;o.className&&(r==="vertical"?a=A5e(o.className,n):a=I5e(o.className,n)),s(t,e,"className",a)}function XQ(t){return`<span class="selected">✓</span>${t}`}function Kx(t,e){let r=!1;return Array.isArray(t)&&Z(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function UR(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:s}=n.getBoundingClientRect();r.top=i,r.left=s}return r}const wt="---------";function M5e(){return{name:wt}}const Po="alignment";function N5e(){return{key:Po,name(){return this.getTranslatedPhrase(kH)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Po}:left`,name(){return this.getTranslatedPhrase(PH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Nc(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Po}:center`,name(){return this.getTranslatedPhrase(AH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Nc(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Po}:right`,name(){return this.getTranslatedPhrase(IH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Nc(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Po}:justify`,name(){return this.getTranslatedPhrase(OH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Nc(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:wt},{key:`${Po}:top`,name(){return this.getTranslatedPhrase(MH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Nc(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Po}:middle`,name(){return this.getTranslatedPhrase(NH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Nc(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Po}:bottom`,name(){return this.getTranslatedPhrase(DH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Nc(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const zR="clear_column";function D5e(){return{key:zR,name(){return this.getTranslatedPhrase(gH)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const k1="col_left";function F5e(){return{key:k1,name(){return this.getTranslatedPhrase(lH)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const P1="col_right";function H5e(){return{key:P1,name(){return this.getTranslatedPhrase(uH)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const A1="make_read_only";function L5e(){return{key:A1,checkable:!0,ariaChecked(){return Kx(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(S_)},name(){let t=this.getTranslatedPhrase(S_);return Kx(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=XQ(t)),t},callback(){const t=this.getSelectedRange(),e=Kx(t,(r,n)=>this.getCellMeta(r,n).readOnly);Z(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const GR="redo";function $5e(){return{key:GR,name(){return this.getTranslatedPhrase(dH)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const I1="remove_col";function B5e(){return{key:I1,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(hH,e)},callback(){this.alter("remove_col",B3e(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const YR="remove_row";function V5e(){return{key:YR,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(cH,e)},callback(){this.alter("remove_row",V3e(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const KR="row_above";function W5e(){return{key:KR,name(){return this.getTranslatedPhrase(oH)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const XR="row_below";function j5e(){return{key:XR,name(){return this.getTranslatedPhrase(aH)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ey="no_items";function U5e(){return{key:Ey,name(){return this.getTranslatedPhrase(sH)},disabled:!0,isCommand:!1}}const qR="undo";function z5e(){return{key:qR,name(){return this.getTranslatedPhrase(fH)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const G5e=[KR,XR,k1,P1,zR,YR,I1,qR,GR,A1,Po,wt,Ey],Y5e={[wt]:M5e,[Ey]:U5e,[KR]:W5e,[XR]:j5e,[k1]:F5e,[P1]:H5e,[zR]:D5e,[YR]:V5e,[I1]:B5e,[qR]:z5e,[GR]:$5e,[A1]:L5e,[Po]:N5e};function qQ(){const t={};return Ct(Y5e,(e,r)=>{t[r]=e()}),t}function K5e(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(EH):this.getTranslatedPhrase(_H)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function X5e(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(RH)},callback(){this.getSelectedRangeLast().forAll((r,n)=>{r>=0&&n>=0&&t.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function q5e(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(TH);return Kx(this.getSelectedRange(),(n,i)=>t.getCommentMeta(n,i,Xx))?XQ(e):e},callback(){this.getSelectedRangeLast().forAll((r,n)=>{if(r>=0&&n>=0){const i=!!t.getCommentMeta(r,n,Xx);t.updateCommentMeta(r,n,{[Xx]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function J5e(t,e){JQ(t,e),e.add(t)}function Mg(t,e,r){JQ(t,e),e.set(t,r)}function JQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q5e(t,e,r){return(e=Z5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z5e(t){var e=eze(t,"string");return typeof e=="symbol"?e:e+""}function eze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oh(t,e,r){return t.set(Bs(t,e),r),r}function vt(t,e){return t.get(Bs(t,e))}function Bs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const F_="comments",tze=60,mu="comment",Pv="value",QQ="style",Xx="readOnly",U0=F_,QM=`plugin:${F_}`;var ir=new WeakMap,wl=new WeakMap,JR=new WeakMap,qx=new WeakMap,ZM=new WeakMap,H_=new WeakMap,yo=new WeakSet;class rze extends zt{constructor(){super(...arguments),J5e(this,yo),Q5e(this,"range",{}),Mg(this,ir,null),Mg(this,wl,null),Mg(this,JR,!1),Mg(this,qx,!1),Mg(this,ZM,null),Mg(this,H_,"")}static get PLUGIN_KEY(){return F_}static get PLUGIN_PRIORITY(){return tze}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[F_]}enablePlugin(){var e=this;this.enabled||(vt(ir,this)||(oh(ir,this,new Qf(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),vt(ir,this).addLocalHook("resize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bs(yo,e,cze).call(e,...n)}),this.hot.addHook("afterSetTheme",(r,n)=>{n||this.hide()})),vt(wl,this)||oh(wl,this,new KQ(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,i,s,o,a)=>Bs(yo,this,aze).call(this,r,a)),this.addHook("afterScroll",()=>Bs(yo,this,hze).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>Bs(yo,this,Y6).call(this,r)),this.addHook("beforeCompositionStart",r=>Bs(yo,this,Y6).call(this,r)),vt(wl,this).addLocalHook("hide",()=>this.hide()),vt(wl,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){vt(wl,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),n=e.addContext(QM);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();oh(qx,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(QM),this.hot._registerTimeout(()=>{oh(qx,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:U0}),n.addShortcut({keys:[["Escape"]],callback:()=>{vt(ir,this).setValue(vt(H_,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>vt(ir,this).isVisible()&&vt(ir,this).isFocused(),group:U0}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>vt(ir,this).isVisible()&&vt(ir,this).isFocused(),group:U0}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{vt(ir,this).setValue(vt(ir,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:U0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(U0)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>Bs(yo,this,sze).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>Bs(yo,this,nze).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Bs(yo,this,oze).call(this)),this.eventManager.addEventListener(r,"focus",()=>Bs(yo,this,uze).call(this)),this.eventManager.addEventListener(r,"blur",()=>Bs(yo,this,lze).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",n=>Bs(yo,this,ize).call(this,n))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=Id(e.target,"TD","TBODY");return!!(r&&et(r,"htCommentCell")&&Id(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=vt(ir,this).getValue();let n="";e!=null?n=e:r!=null&&(n=r);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[Pv]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,mu),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,Pv)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,Pv)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:n}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return vt(wl,this).cancelHiding(),vt(ir,this).setValue((e=i[mu]?i[mu][Pv]:null)!==null&&e!==void 0?e:""),vt(ir,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){vt(ir,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!vt(ir,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:n}=this.hot,{row:i,col:s}=this.range.from;let o=r.getRenderableFromVisualIndex(i),a=n.getRenderableFromVisualIndex(s);const l=o===null;vt(ir,this).setPosition(0,0),o===null&&(o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1))),a===null&&(a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,-1)));const u=o===null,c=a===null;o=o??0,a=a??0;const{rootWindow:h,view:{_wt:f}}=this.hot,{wtTable:d}=f,g=f.getCell({row:o,col:a},!0),m=this.getCommentMeta(i,s,QQ);m?vt(ir,this).setSize(m.width,m.height):vt(ir,this).resetSize();const p=c?0:d.getColumnWidth(a),w=l&&!u?An(g):0,{left:v,top:y,width:b,height:T}=g.getBoundingClientRect(),{width:E,height:x}=vt(ir,this).getSize(),{innerWidth:P,innerHeight:A}=this.hot.rootWindow,O=this.hot.rootDocument.documentElement,Y=ei(this.hot.rootDocument),L=kq(this.hot.rootWindow)?Y:0,ie=Pq(this.hot.rootWindow)?Y:0;let ce=v+h.scrollX+p,he=y+h.scrollY+w;this.hot.isRtl()&&(ce-=E+p),this.hot.isLtr()&&v+b+E>P-L?ce=v+h.scrollX-E-1:this.hot.isRtl()&&ce<-(O.scrollWidth-O.clientWidth)&&(ce=v+h.scrollX+p+1),y+x>A-ie&&(he-=x-T+1),vt(ir,this).setPosition(ce,he),vt(ir,this).setReadOnlyState(this.getCommentMeta(i,s,Xx)),vt(ir,this).observeSize()}focusEditor(){vt(ir,this).focus()}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[mu];let s;i?(s=rs(i),ER(s,n)):s=n,this.hot.setCellMeta(e,r,mu,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[mu])return i[mu][n]}addToContextMenu(e){e.items.push({name:wt},K5e(this),X5e(this),q5e(this))}getEditorInputElement(){return vt(ir,this).getInputElement()}destroy(){var e,r;(e=vt(ir,this))===null||e===void 0||e.destroy(),(r=vt(wl,this))===null||r===void 0||r.destroy(),super.destroy()}}function nze(t){if(!(!this.hot.view||!this.hot.view._wt)&&!vt(JR,this)&&!this.targetIsCommentTextArea(t)){const e=Id(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function ize(t){t.stopPropagation()}function sze(t){const{rootDocument:e}=this.hot;if(!(vt(JR,this)||vt(ir,this).isFocused()||et(t.target,"wtBorder")||vt(ZM,this)===t.target||!vt(ir,this)))if(oh(ZM,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));vt(wl,this).show(r)}else hd(t.target,e)&&!this.targetIsCommentTextArea(t)&&vt(wl,this).hide()}function oze(){oh(JR,this,!1)}function aze(t,e){e[mu]&&e[mu][Pv]&&Se(t,e.commentedCellClassName)}function lze(){oh(H_,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function uze(){oh(H_,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(QM)}function cze(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[QQ]:{width:t,height:e}})}function Y6(t){vt(ir,this).isFocused()&&ja(t)}function hze(){vt(qx,this)||this.hide()}function cA(t,e,r){return(e=fze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fze(t){var e=dze(t,"string");return typeof e=="symbol"?e:e+""}function dze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZQ{constructor(e){cA(this,"hot",void 0),cA(this,"commands",{}),cA(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=gze(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Pn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(s.join(":")),Z(u,c=>c.apply(this.hot,n))}}function gze(t,e){let r;return Z(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function hA(t,e,r){return(e=mze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mze(t){var e=pze(t,"string");return typeof e=="symbol"?e:e+""}function pze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eZ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;hA(this,"hot",void 0),hA(this,"predefinedItems",qQ()),hA(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Ct(e,(n,i)=>{let s="";n.name===wt?(r[wt]=n,s=wt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return vze(e,this.defaultOrderPattern,this.predefinedItems)}}function vze(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),yt(i)?Ct(i,(s,o)=>{let a=r[typeof s=="string"?s:o];a||(a=s),yt(s)?In(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),n.push(a)}):Z(i,(s,o)=>{let a=r[s];!a&&G5e.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),yt(s)&&In(a,s),a.key===void 0&&(a.key=o),n.push(a))}),n}function xc(t,e,r){return(e=wze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wze(t){var e=yze(t,"string");return typeof e=="symbol"?e:e+""}function yze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cze{constructor(e,r){xc(this,"top",void 0),xc(this,"topRelative",void 0),xc(this,"left",void 0),xc(this,"leftRelative",void 0),xc(this,"scrollTop",void 0),xc(this,"scrollLeft",void 0),xc(this,"cellHeight",void 0),xc(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let s,o,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=n,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-n,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function z0(t,e,r){Sze(t,e),e.set(t,r)}function Sze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(t,e){return t.get(tZ(t,e))}function CS(t,e,r){return t.set(tZ(t,e),r),r}function tZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $i=new WeakMap,us=new WeakMap,cs=new WeakMap,fA=new WeakMap,Ng=new WeakMap;class xze{constructor(e){z0(this,$i,void 0),z0(this,us,void 0),z0(this,cs,void 0),z0(this,fA,!1),z0(this,Ng,{above:0,below:0,left:0,right:0}),CS(fA,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ut(Ng,this)[e]=r,this}setElement(e){return CS($i,this,e),this}setParentElement(e){return CS(us,this,e),this}updatePosition(e){CS(cs,this,new Cze(e,ut($i,this).ownerDocument.defaultView)),ut(fA,this)?(ut(cs,this).fitsBelow(ut($i,this))?this.setPositionBelowCursor():ut(cs,this).fitsAbove(ut($i,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ut($i,this).dir==="rtl"?ut(cs,this).fitsOnLeft(ut($i,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ut(cs,this).fitsOnRight(ut($i,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ut(Ng,this).above+ut(cs,this).top-ut($i,this).offsetHeight;if(ut(us,this)){const n=ut(us,this).ownerDocument.defaultView.getComputedStyle(ut(us,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=ut(cs,this).top+ut(cs,this).cellHeight-ut($i,this).scrollHeight+i+s}ut($i,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ut(Ng,this).below+ut(cs,this).top+1;if(ut(us,this)){const n=ut(us,this).ownerDocument.defaultView.getComputedStyle(ut(us,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=ut(cs,this).top-i-s-1}ut($i,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ut(cs,this).left;if(ut(us,this)){const r=ut(us,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ut(us,this).querySelector(".htCore")).borderRightWidth,10);e+=ut(cs,this).cellWidth+n}else e+=ut(Ng,this).right;ut($i,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ut(Ng,this).left+ut(cs,this).left-ut($i,this).offsetWidth;if(ut(us,this)){const r=ut(us,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ut(us,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ut($i,this).style.left=`${e}px`}}function rZ(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const s=new Set;let o=Ot(e,-1,m()-1);function a(w,v){const y=m()-1;return w<0&&(w=y),w>y&&(w=0),s.has(w)?-1:(s.add(w),n(w,!1)===!1&&(w=a(v===1?++w:--w,v)),w)}function l(w){w>-1&&w<m()&&n(w,!0)!==!1&&(o=w)}function u(w){w>-1&&w<m()&&(o=w)}function c(){return o}function h(){m()>0&&(s.clear(),o=a(0,1))}function f(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function g(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(r(),0)}function p(){s.clear(),o=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:f,toNextItem:d,toPreviousItem:g,getSize:m,clear:p}}function bze(t){return Pt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function e2(t){return Pn(t,"submenu")}function t2(t){return new RegExp(wt,"i").test(t.name)}function Jx(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function K6(t){return Pn(t,"disableSelection")}function _ze(t){return et(t,"htSeparator")}function Eze(t){return et(t,"htSubmenu")}function Rze(t){return et(t,"htDisabled")}function Tze(t){return et(t,"htSelectionDisabled")}function kze(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function nZ(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function Pze(t,e){let r=t.slice(0);return r.reverse(),r=nZ(r,e),r.reverse(),r}function Aze(t){const e=[];return Z(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function Ize(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wt,r=t.slice(0);return r=nZ(r,e),r=Pze(r,e),r=Aze(r),r}function Oze(t){return t.checkable===!0}function Mze(t){return rZ({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||_ze(n)||Rze(n)||Tze(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Nze(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(n):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const iZ="menu",X6=iZ;function Dze(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Nze(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:iZ})}function i(u,c){const h=a(c);u.forEach(f=>{let{keys:d}=f;d.forEach(g=>h.removeShortcutsByKeys(g))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function s(){return[...r]}function o(u){return u?`${X6}:${u}`:X6}function a(u){var c;const h=t.hotMenu.getShortcutManager(),f=o(u);return(c=h.getContext(f))!==null&&c!==void 0?c:h.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function Fze(t){return(e,r,n,i,s,o)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof o=="function"?o.call(t):o,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Ku(r),Se(l,"htItemWrapper"),t.getSettings().ariaTags){const f=!Jx(a,t)&&!K6(a)&&!t2(a);Ze(r,[...Oze(a)?[j2e(),mp(c),hq(h)]:[W2e(),mp(u)],...f?[Vh(-1)]:[],...Jx(a,t)?[q2e()]:[],...e2(a)?[Wo(!1)]:[]])}r.className="",r.appendChild(l),t2(a)?Se(r,"htSeparator"):typeof a.renderer=="function"?(Se(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,s,u))):Gp(l,u),Jx(a,t)?Se(r,"htDisabled"):K6(a)?Se(r,"htSelectionDisabled"):e2(a)&&Se(r,"htSubmenu")}}function dA(t,e,r){Hze(t,e),e.set(t,r)}function Hze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,r){return(e=Lze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lze(t){var e=$ze(t,"string");return typeof e=="symbol"?e:e+""}function $ze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gA(t,e,r){return t.set(sZ(t,e),r),r}function bc(t,e){return t.get(sZ(t,e))}function sZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const q6=215;var Dg=new WeakMap,SS=new WeakMap,xS=new WeakMap;class Jp{get tableBorderWidth(){return bc(xS,this)===void 0&&this.hotMenu&&gA(xS,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),bc(xS,this)}constructor(e,r){var n=this;nl(this,"hot",void 0),nl(this,"options",void 0),nl(this,"eventManager",new $a(this)),nl(this,"container",void 0),nl(this,"positioner",void 0),nl(this,"hotMenu",null),nl(this,"hotSubMenus",{}),nl(this,"parentMenu",void 0),nl(this,"menuItems",null),nl(this,"origOutsideClickDeselects",null),dA(this,Dg,void 0),dA(this,SS,void 0),dA(this,xS,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:q6,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new xze(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{this.options.container!==this.hot.rootPortalElement&&(qe(this.options.container,/ht-theme-.*/g),Se(this.options.container,i)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=pp(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return bc(Dg,this)}getKeyboardShortcutsCtrl(){return bc(SS,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=kR(a=>this.openSubMenu(a),300),r=this.options.minWidth||q6;let n=!1,i=Ad(this.menuItems,a=>(a.key===Ey&&(n=!0),kze(a,this.hot)));if(i.length<1&&!n)i.push(qQ()[Ey]);else if(i.length===0)return;i=Ize(i,wt);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Le(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Fze(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?bc(Dg,this).setCurrentPage(l.row):bc(Dg,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),EM()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!EM()||!Md(a))&&s&&this.hasSelectedItem()&&(Al()||yq()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),gA(Dg,this,Mze(this.hotMenu)),gA(SS,this,Dze(this)),bc(SS,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(bc(Dg,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Ze(n,[Wo(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!Eze(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Jp(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Ze(r,[Wo(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ze(i,[Wo(!1)])}}closeAllSubMenus(){Z(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?bze(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||t2(e)||Jx(e,this.hot)||e2(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),o=Ms(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?An(this.hotMenu.getCell(u,0)):0;return a+(l.name===wt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${s+3}px`,i.height=`${o+3}px`):(i.width=`${s}px`,i.height=`${o}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Zt(n)&&(n=n.call(this.hot),n===null||Dr(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),Se(i,`htMenu handsontable ${this.options.className}`),n&&Se(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ze(this.hotMenu.rootElement,[V2e(),Vh(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!hd(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!hd(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&et(e.target,"htCore")&&hd(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ur(Jp,hi);function Bze(t,e){Vze(t,e),e.add(t)}function Vze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mA(t,e,r){return(e=Wze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wze(t){var e=jze(t,"string");return typeof e=="symbol"?e:e+""}function jze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Av="contextMenu",Uze=70,J6=Av;Fe.getSingleton().register("afterContextMenuDefaultOptions");Fe.getSingleton().register("beforeContextMenuShow");Fe.getSingleton().register("afterContextMenuShow");Fe.getSingleton().register("afterContextMenuHide");Fe.getSingleton().register("afterContextMenuExecute");var G0=new WeakSet;class QR extends zt{constructor(){super(...arguments),Bze(this,G0),mA(this,"commandExecutor",new ZQ(this.hot)),mA(this,"itemsFactory",null),mA(this,"menu",null)}static get PLUGIN_KEY(){return Av}static get PLUGIN_PRIORITY(){return Uze}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KR,XR,wt,k1,P1,wt,YR,I1,wt,qR,GR,wt,A1,wt,Po]}isEnabled(){return!!this.hot.getSettings()[Av]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Av];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Jp(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>bS(G0,this,Gze).call(this)),this.menu.addLocalHook("afterOpen",()=>bS(G0,this,Yze).call(this)),this.menu.addLocalHook("afterClose",()=>bS(G0,this,Kze).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>bS(G0,this,zze).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=UR(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:J6})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(J6)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Ct(n,(s,o)=>{const a=["below","right"].includes(o)?s+1:s-1;this.menu.setOffset(o,i?s:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new eZ(this.hot,QR.DEFAULT_ITEMS);const e=this.hot.getSettings()[Av],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Z(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function zze(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),et(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(s)&&!(et(s,"current")&&et(s,"wtBorder"))))return;const o=UR(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function Gze(){this.hot.runHooks("beforeContextMenuShow",this)}function Yze(){this.hot.runHooks("afterContextMenuShow",this)}function Kze(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}QR.SEPARATOR={name:wt};function Xze(t){return{key:"copy",name(){return this.getTranslatedPhrase(mH)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function qze(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?Ot(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(wH,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Jze(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?Ot(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(vH,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Qze(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?Ot(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(pH,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Zze(t){return{key:"cut",name(){return this.getTranslatedPhrase(yH)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class e7e{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class t7e{constructor(){this.clipboardData=new e7e}preventDefault(){}composedPath(){return[]}}function r7e(t,e){oZ(t,e),e.add(t)}function Fg(t,e,r){oZ(t,e),e.set(t,r)}function oZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ji(t,e){return t.get(Om(t,e))}function Hg(t,e,r){return t.set(Om(t,e),r),r}function Om(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _c=new WeakMap,pA=new WeakMap,Y0=new WeakMap,r2=new WeakMap,n2=new WeakMap,K0=new WeakMap,X0=new WeakSet;class n7e{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;r7e(this,X0),Fg(this,_c,void 0),Fg(this,pA,void 0),Fg(this,Y0,void 0),Fg(this,r2,void 0),Fg(this,n2,void 0),Fg(this,K0,void 0),Hg(pA,this,r),Hg(Y0,this,n),Hg(r2,this,i),Hg(n2,this,s),Hg(K0,this,o)}setSelectedRange(e){Hg(_c,this,e)}getCellsRange(){if(ji(pA,this).call(this)===0||ji(Y0,this).call(this)===0)return null;const{row:e,col:r}=ji(_c,this).getTopStartCorner(),{row:n,col:i}=ji(_c,this).getBottomEndCorner(),s=Om(X0,this,i7e).call(this,e,n),o=Om(X0,this,vA).call(this,r,i);return{isRangeTrimmed:n!==s||i!==o,startRow:e,startCol:r,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(ji(Y0,this).call(this)===0||ji(K0,this).call(this)===0)return null;const{col:e}=ji(_c,this).getTopStartCorner(),{col:r}=ji(_c,this).getBottomEndCorner(),n=Om(X0,this,vA).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(ji(Y0,this).call(this)===0||ji(K0,this).call(this)===0)return null;const{col:e}=ji(_c,this).getTopStartCorner(),{col:r}=ji(_c,this).getBottomEndCorner(),n=Om(X0,this,vA).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-ji(K0,this).call(this),startCol:e,endRow:-1,endCol:n}}}function vA(t,e){return Math.min(e,Math.max(t+ji(n2,this).call(this)-1,t))}function i7e(t,e){return Math.min(e,Math.max(t+ji(r2,this).call(this)-1,t))}function aZ(t){const e=[],r=[];return Z(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);je(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);je(o,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function s7e(t,e){lZ(t,e),e.add(t)}function Ec(t,e,r){lZ(t,e),e.set(t,r)}function lZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function q0(t,e,r){return(e=o7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o7e(t){var e=a7e(t,"string");return typeof e=="symbol"?e:e+""}function a7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ps(t,e){return t.get(ys(t,e))}function fa(t,e,r){return t.set(ys(t,e),r),r}function ys(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("afterCopyLimit");Fe.getSingleton().register("modifyCopyableRange");Fe.getSingleton().register("beforeCut");Fe.getSingleton().register("afterCut");Fe.getSingleton().register("beforePaste");Fe.getSingleton().register("afterPaste");Fe.getSingleton().register("beforeCopy");Fe.getSingleton().register("afterCopy");const wA="copyPaste",l7e=80,u7e=["fragmentSelection"],Q6=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var i2=new WeakMap,s2=new WeakMap,o2=new WeakMap,Lg=new WeakMap,_S=new WeakMap,ES=new WeakMap,$g=new WeakMap,L_=new WeakMap,Ws=new WeakSet;class c7e extends zt{constructor(){super(...arguments),s7e(this,Ws),q0(this,"columnsLimit",1/0),q0(this,"rowsLimit",1/0),q0(this,"pasteMode","overwrite"),q0(this,"uiContainer",this.hot.rootDocument.body),Ec(this,i2,!1),Ec(this,s2,!1),Ec(this,o2,!1),Ec(this,Lg,"cells-only"),Ec(this,_S,!1),Ec(this,ES,!1),Ec(this,$g,new n7e({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ec(this,L_,!1),q0(this,"copyableRanges",[])}static get PLUGIN_KEY(){return wA}static get SETTING_KEYS(){return[wA,...u7e]}static get PLUGIN_PRIORITY(){return l7e}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[wA]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),fa(i2,this,this.getSetting("copyColumnHeaders")),fa(s2,this,this.getSetting("copyColumnGroupHeaders")),fa(o2,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>ys(Ws,this,d7e).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ys(Ws,n,g7e).call(n,...s)}),this.addHook("afterSelectionEnd",()=>ys(Ws,this,m7e).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),vy()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ys(Ws,n,p7e).call(n,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return ys(Ws,n,v7e).call(n,...s)}),this.addHook("afterSelection",()=>ys(Ws,this,w7e).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";fa(Lg,this,e),fa(_S,this,!0),ys(Ws,this,Z6).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){fa(ES,this,!0),ys(Ws,this,Z6).call(this,"cut")}getRangedCopyableData(e){return iw(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=aZ(e);return Z(n,s=>{const o=[];Z(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new t7e;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ps($g,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);ps(Lg,this)==="column-headers-only"?r.set("headers",ps($g,this).getMostBottomColumnHeadersRange()):(ps(Lg,this)==="with-column-headers"?r.set("headers",ps($g,this).getMostBottomColumnHeadersRange()):ps(Lg,this)==="with-column-group-headers"&&r.set("headers",ps($g,this).getAllColumnHeadersRange()),r.set("cells",ps($g,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=n;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,s=[],{row:o,col:a}=r.getTopStartCorner(),{row:l,col:u}=r.getBottomEndCorner();let c=o,h=a,f=o,d=a;for(;s.length<n||c<=l;){const{skipRowOnPaste:g,visualRow:m}=this.hot.getCellMeta(c,a);if(c=m+1,g===!0)continue;f=m,h=a;const p=[],w=s.length%n;for(;p.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:y}=this.hot.getCellMeta(o,h);if(h=y+1,v===!0)continue;d=y;const b=p.length%i;p.push(e[w][b])}s.push(p)}return fa(L_,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,f,d]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ps(_S,this)||this.isEditorOpened()||$u(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!jx(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),fa(_S,this,!1);const s=this.getRangedData(this.copyableRanges),o=ys(Ws,this,h7e).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=iw(s);if(e&&e.clipboardData){const u=QW(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[Q6,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}fa(Lg,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ps(ES,this)||this.isEditorOpened()||$u(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!jx(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),fa(ES,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=iw(s);if(e&&e.clipboardData){const l=QW(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[Q6,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||$u(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!jx(r,this.hot.rootElement)))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const c=xF(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?s=NFe(c,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=G3e(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,u]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function Z6(t){if(vy()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&VNe(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function h7e(t){const{rows:e}=aZ(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function f7e(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&Oq(n)}}}function uZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&Mq(n)}}}function d7e(t){t.items.push({name:"---------"},Xze(this)),ps(i2,this)&&t.items.push(Qze(this)),ps(s2,this)&&t.items.push(Jze(this)),ps(o2,this)&&t.items.push(qze(this)),t.items.push(Zze(this))}function g7e(t,e,r,n,i){ps(L_,this)&&(i.value=!0),fa(L_,this,!1)}function m7e(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function p7e(){ys(Ws,this,uZ).call(this)}function v7e(){ys(Ws,this,f7e).call(this)}function w7e(){ys(Ws,this,uZ).call(this)}function cZ(t,e){return`border_row${t}col${e}`}function Iv(){return{width:1,color:"#000"}}function ku(){return{hide:!0}}function y7e(){return{width:1,color:"#000",cornerVisible:!1}}function yA(t){if(Le(t.start)||Le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Le(t.end)||Le(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function J0(t){return Le(t.start)&&(t.left=t.start),Le(t.end)&&(t.right=t.end),t}function CA(t,e){return{id:cZ(t,e),border:y7e(),row:t,col:e,top:ku(),bottom:ku(),start:ku(),end:ku()}}function C7e(t,e){return Pn(e,"border")&&e.border&&(t.border=e.border),Pn(e,"top")&&Le(e.top)&&(e.top?(yt(e.top)||(e.top=Iv()),t.top=e.top):(e.top=ku(),t.top=e.top)),Pn(e,"bottom")&&Le(e.bottom)&&(e.bottom?(yt(e.bottom)||(e.bottom=Iv()),t.bottom=e.bottom):(e.bottom=ku(),t.bottom=e.bottom)),Pn(e,"start")&&Le(e.start)&&(e.start?(yt(e.start)||(e.start=Iv()),t.start=e.start):(e.start=ku(),t.start=e.start)),Pn(e,"end")&&Le(e.end)&&(e.end?(yt(e.end)||(e.end=Iv()),t.end=e.end):(e.end=ku(),t.end=e.end)),t}function qu(t,e){let r=!1;return Z(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!Pn(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function ZR(t){return`<span class="selected">✓</span>${t}`}function S7e(t){return t.some(e=>Le(e.left)||Le(e.right))}function x7e(t){return t.some(e=>Le(e.start)||Le(e.end))}const b7e=new Map([["left","start"],["right","end"]]);function _7e(t){var e;return(e=b7e.get(t))!==null&&e!==void 0?e:t}function E7e(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase($H);return qu(this,"bottom")&&(e=ZR(e)),e},callback(e,r){const n=qu(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function R7e(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(BH);return qu(this,e)&&(r=ZR(r)),r},callback(r,n){const i=qu(this,e);t.prepareBorder(n,e,i)}}}function T7e(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(VH)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!qu(this)}}}function k7e(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(LH);return qu(this,e)&&(r=ZR(r)),r},callback(r,n){const i=qu(this,e);t.prepareBorder(n,e,i)}}}function P7e(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(HH);return qu(this,"top")&&(e=ZR(e)),e},callback(e,r){const n=qu(this,"top");t.prepareBorder(r,"top",n)}}}function A7e(t,e){I7e(t,e),e.add(t)}function I7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function O7e(t,e,r){return(e=M7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M7e(t){var e=N7e(t,"string");return typeof e=="symbol"?e:e+""}function N7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ej(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Qx="customBorders",D7e=90;var SA=new WeakSet;class F7e extends zt{constructor(){super(...arguments),A7e(this,SA),O7e(this,"savedBorders",[])}static get PLUGIN_KEY(){return Qx}static get PLUGIN_PRIORITY(){return D7e}isEnabled(){return!!this.hot.getSettings()[Qx]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>ej(SA,this,H7e).call(this,e)),this.addHook("init",()=>ej(SA,this,L7e).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=yA(r));const s=yp(e),o=Cy(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Z(e,a=>{o(a).forAll((l,u)=>{Z(n,c=>{this.prepareBorderFromCustomAdded(l,u,i,_7e(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=yp(e),n=Cy(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return Z(e,s=>{n(s).forAll((o,a)=>{Z(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(J0(l))})})}),i}clearBorders(e){e?this.setBorders(e):(Z(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||r>=o)return;let a=CA(e,r);n&&(a=C7e(a,n),Z(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,n),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",J0(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);je(e.from.row,n,s=>{je(e.from.col,i,o=>{const a=CA(s,o);let l=0;s===e.from.row&&Pn(r,"top")&&(l+=1,a.top=r.top),s===e.to.row&&Pn(r,"bottom")&&(l+=1,a.bottom=r.bottom),o===e.from.col&&Pn(r,"start")&&(l+=1,a.start=r.start),o===e.to.col&&Pn(r,"end")&&(l+=1,a.end=r.end),l>0&&(this.hot.setCellMeta(s,o,"borders",J0(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,r){const n=cZ(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=CA(e,r):s=yA(s),i?(s[n]=ku(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",J0(s)))):(s[n]=Iv(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",J0(s)))}prepareBorder(e,r,n){Z(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":je(s.col,o.col,a=>{je(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":je(s.col,o.col,a=>{this.setBorder(s.row,a,r,n)});break;case"bottom":je(s.col,o.col,a=>{this.setBorder(o.row,a,r,n)});break;case"start":je(s.row,o.row,a=>{this.setBorder(a,s.col,r,n)});break;case"end":je(s.row,o.row,a=>{this.setBorder(a,o.col,r,n)});break}})}createCustomBorders(e){Z(e,r=>{const n=yA(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return Ms([r,n,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const r=Pt(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){Z(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){Z(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=Pt(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):Z(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return Z(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return Z(o,a=>{a.toggleHiddenClass(r,n)}),i=!0,!1}}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):Z(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),n){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);Z(a,l=>{l.changeBorderStyle(n,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[Qx];if(Array.isArray(e)){const r=rs(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=S7e(e),n=x7e(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function H7e(t){this.hot.getSettings()[Qx]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(FH)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[P7e(this),k7e(this),E7e(this),R7e(this),T7e(this)]}})}function L7e(){this.changeBorderSettings()}function $7e(t,e){B7e(t,e),e.add(t)}function B7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xA(t,e,r){return(e=V7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V7e(t){var e=W7e(t,"string");return typeof e=="symbol"?e:e+""}function W7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tj(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const rj="dragToScroll",j7e=100;var bA=new WeakSet;class U7e extends zt{constructor(){super(...arguments),$7e(this,bA),xA(this,"boundaries",null),xA(this,"callback",null),xA(this,"listening",!1)}static get PLUGIN_KEY(){return rj}static get PLUGIN_PRIORITY(){return j7e}isEnabled(){return!!this.hot.getSettings()[rj]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>tj(bA,this,nj).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>tj(bA,this,nj).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=pp(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function nj(t){if(Md(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,n)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(r)*50,a+Math.sign(n)*20)}),this.listen()}function z7e(t,e){hZ(t,e),e.add(t)}function G7e(t,e,r){hZ(t,e),e.set(t,r)}function hZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _A(t,e,r){return(e=Y7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y7e(t){var e=K7e(t,"string");return typeof e=="symbol"?e:e+""}function K7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X7e(t,e){return t.get(Ao(t,e))}function fZ(t,e,r){return t.set(Ao(t,e),r),r}function Ao(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("afterDropdownMenuDefaultOptions");Fe.getSingleton().register("beforeDropdownMenuShow");Fe.getSingleton().register("afterDropdownMenuShow");Fe.getSingleton().register("afterDropdownMenuHide");Fe.getSingleton().register("afterDropdownMenuExecute");const Zx="dropdownMenu",q7e=230,Ry="changeType",EA=Zx;var eT=new WeakMap,ma=new WeakSet;class tT extends zt{static get PLUGIN_KEY(){return Zx}static get PLUGIN_PRIORITY(){return q7e}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[k1,P1,wt,I1,wt,zR,wt,A1,wt,Po]}constructor(e){super(e),z7e(this,ma),_A(this,"commandExecutor",new ZQ(this.hot)),_A(this,"itemsFactory",null),_A(this,"menu",null),G7e(this,eT,!1),this.hot.addHook("afterGetColHeader",(r,n)=>Ao(ma,this,Q7e).call(this,r,n))}isEnabled(){return this.hot.getSettings()[Zx]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new eZ(this.hot,tT.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ao(ma,e,i9e).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Ao(ma,e,n9e).call(e,...s)});const r=this.hot.getSettings()[Zx],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new Jp(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Ao(ma,this,Z7e).call(this)),this.menu.addLocalHook("afterOpen",()=>Ao(ma,this,e9e).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>Ao(ma,this,t9e).call(this,s)),this.menu.addLocalHook("afterClose",()=>Ao(ma,this,r9e).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),Z(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=UR(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${Ry}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:EA},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:EA}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(EA)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Ao(ma,this,J7e).call(this,e))}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),Ct(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function dZ(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function J7e(t){if(et(t.target,Ry)){const e=UR(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),fZ(eT,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function Q7e(t,e){const r=e.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${Ry}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=Ry,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ze(o,[ng(),mp(" ")]),Ze(e,[lq("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function Z7e(){this.hot.runHooks("beforeDropdownMenuShow",this)}function e9e(){this.hot.runHooks("afterDropdownMenuShow",this),Ao(ma,this,dZ).call(this,this.menu)}function t9e(t){Ao(ma,this,dZ).call(this,t)}function r9e(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function n9e(t){return X7e(eT,this)?null:t}function i9e(t){et(t.target,Ry)&&fZ(eT,this,!0)}tT.SEPARATOR={name:wt};function ij(t,e,r){return(e=s9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s9e(t){var e=o9e(t,"string");return typeof e=="symbol"?e:e+""}function o9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a9e{constructor(e){ij(this,"hot",void 0),ij(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,o=[];return je(e,n,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(je(r,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();je(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();je(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,o=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),o=Math.min(o,e),{startRow:n,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function sj(t,e,r){return(e=l9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l9e(t){var e=u9e(t,"string");return typeof e=="symbol"?e:e+""}function u9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t${static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){sj(this,"dataProvider",void 0),sj(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=Ll(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=In(Ll(t$.DEFAULT_OPTIONS),r),r=In(r,e),r.filename=iq(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}function c9e(t,e){h9e(t,e),e.add(t)}function h9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oj(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const gZ="\r",f9e='"',d9e=`
`,g9e="=",m9e="+",p9e="-",v9e="@",w9e="	";var RA=new WeakSet;class y9e extends t${constructor(){super(...arguments),c9e(this,RA)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(n=Pt(n,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),Z(r,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:r=!1,sanitizeValue:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Fr(e);return i===""||(n&&(r=!0),n instanceof RegExp?i=oj(RA,this,S9e).call(this,i,n):typeof n=="function"?i=n(i):n&&(i=oj(RA,this,C9e).call(this,i)),(r||i.indexOf(gZ)>=0||i.indexOf(f9e)>=0||i.indexOf(d9e)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function C9e(t){return t.startsWith(g9e)||t.startsWith(m9e)||t.startsWith(p9e)||t.startsWith(v9e)||t.startsWith(w9e)||t.startsWith(gZ)?`'${t}`:t}function S9e(t,e){return e.test(t)?`'${t}`:t}const x9e="csv",a2={[x9e]:y9e};function b9e(t,e,r){return typeof a2[t]=="function"?new a2[t](e,r):null}const _9e="exportFile",E9e=240;class R9e extends zt{static get PLUGIN_KEY(){return _9e}static get PLUGIN_PRIORITY(){return E9e}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),o=this._createBlob(s),a=i.URL||i.webkitURL,l=n.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!a2[e])throw new Error(`Export format type "${e}" is not supported.`);return b9e(e,new a9e(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function Bg(t,e,r){return(e=T9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T9e(t){var e=k9e(t,"string");return typeof e=="symbol"?e:e+""}function k9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O1{constructor(e,r){let{id:n,stateless:i=!0}=r;Bg(this,"hot",void 0),Bg(this,"id",void 0),Bg(this,"elements",[]),Bg(this,"hidden",!1),Bg(this,"stateId",""),Bg(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new NR)}getElements(){return this.elements}reset(){Z(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Z(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ur(O1,hi);const Ty={};function Ih(t,e){if(!Ty[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=Ty[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function Zf(t){if(!Ty[t])throw Error(`Filter condition "${t}" does not exist.`);return Ty[t].descriptor}function yn(t,e,r){r.key=t,Ty[t]={condition:e,descriptor:r}}const qn="none";function P9e(){return!0}yn(qn,P9e,{name:DR,inputsCount:0,showOperators:!1});const lw="empty";function A9e(t){return an(t.value)}yn(lw,A9e,{name:KH,inputsCount:0,showOperators:!0});const eb="not_empty";function I9e(t,e){return!Ih(lw,e)(t)}yn(eb,I9e,{name:XH,inputsCount:0,showOperators:!0});const uw="eq";function O9e(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale)===Fr(r)}yn(uw,O9e,{name:qH,inputsCount:1,showOperators:!0});const tb="neq";function M9e(t,e){return!Ih(uw,e)(t)}yn(tb,M9e,{name:JH,inputsCount:1,showOperators:!0});const mZ="gt";function N9e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}yn(mZ,N9e,{name:rL,inputsCount:1,showOperators:!0});const pZ="gte";function D9e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}yn(pZ,D9e,{name:nL,inputsCount:1,showOperators:!0});const vZ="lt";function F9e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}yn(vZ,F9e,{name:iL,inputsCount:1,showOperators:!0});const wZ="lte";function H9e(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}yn(wZ,H9e,{name:sL,inputsCount:1,showOperators:!0});const r$="date_after";function L9e(t,e){let[r]=e;const n=_e(t.value,t.meta.dateFormat),i=_e(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}yn(r$,L9e,{name:lL,inputsCount:1,showOperators:!0});const n$="date_before";function $9e(t,e){let[r]=e;const n=_e(t.value,t.meta.dateFormat),i=_e(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}yn(n$,$9e,{name:uL,inputsCount:1,showOperators:!0});const $_="between";function B9e(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=Ih(n$,[s]),a=Ih(r$,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}yn($_,B9e,{name:oL,inputsCount:2,showOperators:!0});const yZ="not_between";function V9e(t,e){return!Ih($_,e)(t)}yn(yZ,V9e,{name:aL,inputsCount:2,showOperators:!0});const CZ="begins_with";function W9e(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Fr(r))}yn(CZ,W9e,{name:QH,inputsCount:1,showOperators:!0});const SZ="ends_with";function j9e(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Fr(r))}yn(SZ,j9e,{name:ZH,inputsCount:1,showOperators:!0});const i$="contains";function U9e(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Fr(r))>=0}yn(i$,U9e,{name:eL,inputsCount:1,showOperators:!0});const xZ="not_contains";function z9e(t,e){return!Ih(i$,e)(t)}yn(xZ,z9e,{name:tL,inputsCount:1,showOperators:!0});const bZ="date_tomorrow";function G9e(t){const e=_e(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(_e().subtract(-1,"days").startOf("day"),"d"):!1}yn(bZ,G9e,{name:hL,inputsCount:0});const _Z="date_today";function Y9e(t){const e=_e(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(_e().startOf("day"),"d"):!1}yn(_Z,Y9e,{name:cL,inputsCount:0});const EZ="date_yesterday";function K9e(t){const e=_e(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(_e().subtract(1,"days").startOf("day"),"d"):!1}yn(EZ,K9e,{name:fL,inputsCount:0});_Ne();function X9e(t,e){let r=t;return r===""&&(r=`(${e})`),r}function M1(t){const e=new Set(t);return function(r){return e.has(r)}}function s$(t){return t??""}function l2(t){return Array.from(new Set(t)).map(e=>s$(e)).sort((e,r)=>typeof e=="number"&&typeof r=="number"?e-r:e===r?0:e>r?1:-1)}function aj(t,e,r,n){const i=[],s=t===e;let o;return s||(o=M1(e)),t.forEach(a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:X9e(a,r)};n&&n(u),i.push(u)}),i}const ed="by_value";function q9e(t,e){let[r]=e;return r(t.value)}yn(ed,q9e,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[M1(e)]},showOperators:!1});const ky={};function J9e(t){if(!ky[t])throw Error(`Operation with id "${t}" does not exist.`);const e=ky[t].func;return function(r,n){return e(r,n)}}function Q9e(t){return ky[t].name}function o$(t,e,r){ky[t]={name:e,func:r}}const Sh="conjunction",Z9e=mL;function eGe(t,e){return t.every(r=>r.func(e))}o$(Sh,Z9e,eGe);const B_="disjunction",tGe=FR;function rGe(t,e){return t.some(r=>r.func(e))}o$(B_,tGe,rGe);const a$="disjunctionWithExtraCondition",nGe=FR;function iGe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}o$(a$,nGe,iGe);const sGe="numeric",RZ="text",oGe="date",lj={[sGe]:[qn,wt,lw,eb,wt,uw,tb,wt,mZ,pZ,vZ,wZ,$_,yZ],[RZ]:[qn,wt,lw,eb,wt,uw,tb,wt,CZ,SZ,wt,i$,xZ],[oGe]:[qn,wt,lw,eb,wt,uw,tb,wt,n$,r$,$_,wt,bZ,_Z,EZ]};function aGe(t){const e=[];let r=t;return lj[r]||(r=RZ),Z(lj[r],n=>{let i;n===wt?i={name:wt}:i=Ll(Zf(n)),e.push(i)}),e}function Q0(t,e,r){return(e=lGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lGe(t){var e=uGe(t,"string");return typeof e=="symbol"?e:e+""}function uGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const TA="built",kA="building",uj=["click","input","keydown","keypress","keyup","focus","blur","change"];let Na=class TZ{static get DEFAULTS(){return Ll({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){Q0(this,"hot",void 0),Q0(this,"eventManager",new $a(this)),Q0(this,"options",void 0),Q0(this,"_element",void 0),Q0(this,"buildState",void 0),this.hot=e,this.options=In(TZ.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===kA?this._element:this.buildState===TA?(this.update(),this._element):(this.buildState=kA,this.build(),this.buildState=TA,this._element)}isBuilt(){return this.buildState===TA}translateIfPossible(e){return typeof e=="string"&&e.startsWith(ss)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=kA),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Se(this._element,this.options.className),this.options.children.length)Z(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),Ct(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),Z(uj,n=>e(r,n))}else Z(uj,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ur(Na,hi);function cGe(t,e){kZ(t,e),e.add(t)}function hGe(t,e,r){kZ(t,e),e.set(t,r)}function kZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(t,e){return t.get(l$(t,e))}function fGe(t,e,r){return t.set(l$(t,e),r),r}function l$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Vg=new WeakMap,cj=new WeakSet;class xh extends Na{static get DEFAULTS(){return Ll({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,In(xh.DEFAULTS,r)),cGe(this,cj),hGe(this,Vg,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>l$(cj,this,dGe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");fGe(Vg,this,this._element.firstChild),Se(this._element,"htUIInput"),Se(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(RS(Vg,this).type=this.options.type,RS(Vg,this).placeholder=this.translateIfPossible(this.options.placeholder),RS(Vg,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&RS(Vg,this).focus()}}function dGe(t){this.options.value=t.target.value}function gGe(t,e){PZ(t,e),e.add(t)}function Z0(t,e,r){PZ(t,e),e.set(t,r)}function PZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wg(t,e,r){return t.set(cw(t,e),r),r}function Hr(t,e){return t.get(cw(t,e))}function cw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fn=new WeakMap,TS=new WeakMap,kS=new WeakMap,PA=new WeakMap,PS=new WeakMap,AS=new WeakSet;class Py extends Na{static get DEFAULTS(){return Ll({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,In(Py.DEFAULTS,r)),gGe(this,AS),Z0(this,Fn,null),Z0(this,TS,[]),Z0(this,kS,void 0),Z0(this,PA,void 0),Z0(this,PS,void 0),this.registerHooks()}getMenu(){return Hr(Fn,this)}registerHooks(){this.addLocalHook("click",()=>cw(AS,this,vGe).call(this))}setItems(e){Wg(TS,this,this.translateNames(e)),Hr(Fn,this)&&Hr(Fn,this).setMenuItems(Hr(TS,this))}translateNames(e){return Z(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),Wg(Fn,this,new Jp(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Hr(Fn,this).setMenuItems(Hr(TS,this));const e=new Na(this.hot,{className:"htUISelectCaption"}),r=new Na(this.hot,{className:"htUISelectDropdown"});Wg(kS,this,e),Wg(PA,this,e.element),Wg(PS,this,r),this.hot.getSettings().ariaTags&&(Ze(r.element,[ng()]),Ze(this._element,[aq()])),Z([e,r],n=>this._element.appendChild(n.element)),Hr(Fn,this).addLocalHook("select",n=>cw(AS,this,mGe).call(this,n)),Hr(Fn,this).addLocalHook("afterClose",()=>cw(AS,this,pGe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Hr(Fn,this).hot.getTranslatedPhrase(DR),Hr(PA,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Hr(Fn,this)&&(Hr(Fn,this).open(),Hr(Fn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Hr(Fn,this).getNavigator().toFirstItem(),Hr(Fn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Hr(Fn,this)&&Hr(Fn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Hr(Fn,this)&&(Hr(Fn,this).destroy(),Wg(Fn,this,null)),Hr(kS,this)&&Hr(kS,this).destroy(),Hr(PS,this)&&Hr(PS,this).destroy(),super.destroy()}}function mGe(t){t.name!==wt&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function pGe(){this.runLocalHooks("afterClose")}function vGe(){this.openOptions()}function wGe(t,e){yGe(t,e),e.add(t)}function yGe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hj(t,e,r){return(e=CGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CGe(t){var e=SGe(t,"string");return typeof e=="symbol"?e:e+""}function SGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fj(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var AA=new WeakSet;class u2 extends O1{constructor(e,r){super(e,{id:r.id,stateless:!1}),wGe(this,AA),hj(this,"name",""),hj(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new Py(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new xh(this.hot,{placeholder:SL})),this.elements.push(new xh(this.hot,{placeholder:xL})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>fj(AA,this,xGe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),Z(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>fj(AA,this,bGe).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=Ll(e.command);r.name.startsWith(qr)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),Z(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Zf(qn),r=[];return Z(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=Zf(e?e.name:qn);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||Z(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Py)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof xh)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{Se(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Se(r.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Se(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||Z(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[Zf(qn)];if(e!==null){const{visualIndex:n}=e;r=aGe(this.hot.getDataType(0,n,this.hot.countRows(),n))}Z(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function xGe(t){Z(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function bGe(t){y1(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ja(t))}function dj(t,e,r){_Ge(t,e),e.set(t,r)}function _Ge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ev(t,e){return t.get(AZ(t,e))}function gj(t,e,r){return t.set(AZ(t,e),r),r}function AZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jg=new WeakMap,IA=new WeakMap;class V_ extends Na{static get DEFAULTS(){return Ll({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,In(V_.DEFAULTS,r)),dj(this,jg,void 0),dj(this,IA,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),gj(IA,this,e),gj(jg,this,this._element.firstChild),ev(jg,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ev(IA,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?ev(jg,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ev(jg,this).checked=e)}focus(){this.isBuilt()&&ev(jg,this).focus()}}function EGe(t,e){RGe(t,e),e.add(t)}function RGe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TGe(t,e,r){return(e=kGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kGe(t){var e=PGe(t,"string");return typeof e=="symbol"?e:e+""}function PGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AGe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const mj=0;var pj=new WeakSet;class IGe extends O1{constructor(e,r){super(e,{id:r.id,stateless:!1}),EGe(this,pj),TGe(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Se(r.parentNode,"htFiltersMenuOperators"),Z(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[Sh,B_];Z(e,r=>{const n=new V_(this.hot,{name:"operator",label:{htmlFor:r,textContent:Q9e(r)},value:r,checked:r===e[mj],id:r});n.addLocalHook("change",i=>AGe(pj,this,OGe).call(this,i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Jt`Radio button with index ${e} doesn't exist.`);Z(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof V_&&r.isChecked());return e?e.getValue():Sh}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Z(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Sh,r=arguments.length>1?arguments[1]:void 0,n=e;n===a$&&(n=B_),this.state.setValueAtIndex(r,n)}reset(){this.setChecked(mj)}}function OGe(t){this.setState(t.target.value)}function MGe(t,e,r){NGe(t,e),e.set(t,r)}function NGe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OA(t,e){return t.get(IZ(t,e))}function DGe(t,e,r){return t.set(IZ(t,e),r),r}function IZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var tv=new WeakMap;class Ay extends Na{static get DEFAULTS(){return Ll({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,In(Ay.DEFAULTS,r)),MGe(this,tv,void 0)}build(){super.build(),DGe(tv,this,this._element.firstChild)}update(){this.isBuilt()&&(OA(tv,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&OA(tv,this).focus()}activate(){OA(tv,this).click()}}function FGe(t,e){OZ(t,e),e.add(t)}function Ug(t,e,r){OZ(t,e),e.set(t,r)}function OZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ct(t,e){return t.get(Mm(t,e))}function aa(t,e,r){return t.set(Mm(t,e),r),r}function Mm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const vj="multipleSelect.itemBox";var pa=new WeakMap,fn=new WeakMap,MA=new WeakMap,nu=new WeakMap,Rc=new WeakMap,Tc=new WeakMap,rv=new WeakSet;class Iy extends Na{static get DEFAULTS(){return Ll({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,In(Iy.DEFAULTS,r)),FGe(this,rv),Ug(this,pa,[]),Ug(this,fn,void 0),Ug(this,MA,void 0),Ug(this,nu,void 0),Ug(this,Rc,void 0),Ug(this,Tc,void 0),aa(nu,this,new xh(this.hot,{placeholder:CL,className:"htUIMultipleSelectSearch"})),aa(Rc,this,new Ay(this.hot,{textContent:pL,className:"htUISelectAll"})),aa(Tc,this,new Ay(this.hot,{textContent:vL,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ct(fn,this)}registerHooks(){ct(nu,this).addLocalHook("keydown",e=>Mm(rv,this,LGe).call(this,e)),ct(nu,this).addLocalHook("input",e=>Mm(rv,this,HGe).call(this,e)),ct(Rc,this).addLocalHook("click",e=>Mm(rv,this,$Ge).call(this,e)),ct(Tc,this).addLocalHook("click",e=>Mm(rv,this,BGe).call(this,e))}setItems(e){var r;aa(pa,this,e),(r=ct(fn,this))===null||r===void 0||r.loadData(ct(pa,this))}setLocale(e){aa(MA,this,e)}getLocale(){return ct(MA,this)}getItems(){return[...ct(pa,this)]}getValue(){return WGe(ct(pa,this))}getSearchInputElement(){return ct(nu,this)}getSelectAllElement(){return ct(Rc,this)}getClearAllElement(){return ct(Tc,this)}isSelectedAllValues(){return ct(pa,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),n=new Na(this.hot,{className:"htUISelectionControls",children:[ct(Rc,this),ct(Tc,this)]});this._element.appendChild(ct(nu,this).element),this._element.appendChild(n.element),this._element.appendChild(r);const i=s=>{var o;if(!this._element)return;(o=ct(fn,this))===null||o===void 0||o.destroy(),Se(s,"htUIMultipleSelectHot"),aa(fn,this,new this.hot.constructor(s,{data:ct(pa,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,f,d,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ct(fn,this).listen()},modifyColWidth:u=>{const c=ct(fn,this).container.scrollWidth-ei(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ct(fn,this).init();const l=ct(fn,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:vj}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{ct(fn,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:vj})};i(r),this.hot._registerTimeout(()=>i(r),100)}focus(){this.isBuilt()&&ct(fn,this).listen()}reset(){ct(nu,this).reset(),ct(Rc,this).reset(),ct(Tc,this).reset()}update(){this.isBuilt()&&(ct(fn,this).loadData(VGe(ct(pa,this),this.options.value)),super.update())}destroy(){var e;(e=ct(fn,this))===null||e===void 0||e.destroy(),ct(nu,this).destroy(),ct(Tc,this).destroy(),ct(Rc,this).destroy(),aa(nu,this,null),aa(Tc,this,null),aa(Rc,this,null),aa(fn,this,null),aa(pa,this,null),super.destroy()}}function HGe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...ct(pa,this)]:r=ct(pa,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),ct(fn,this).loadData(r)}function LGe(t){this.runLocalHooks("keydown",t,this),Nq(y1,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ja(t),ct(fn,this).listen(),ct(fn,this).selectCell(0,0))}function $Ge(t){const e=[];t.preventDefault(),ct(fn,this).getSourceData().forEach((r,n)=>{r.checked=!0,e.push(gJ(r,n)[0])}),ct(fn,this).setSourceDataAtCell(e)}function BGe(t){const e=[];t.preventDefault(),ct(fn,this).getSourceData().forEach((r,n)=>{r.checked=!1,e.push(gJ(r,n)[0])}),ct(fn,this).setSourceDataAtCell(e)}function VGe(t,e){const r=M1(e);return t.map(n=>(n.checked=r(n.value),n))}function WGe(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function jGe(t,e){UGe(t,e),e.add(t)}function UGe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zGe(t,e,r){return(e=GGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GGe(t){var e=YGe(t,"string");return typeof e=="symbol"?e:e+""}function YGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var nv=new WeakSet;class KGe extends O1{constructor(e,r){super(e,{id:r.id,stateless:!1}),jGe(this,nv),zGe(this,"name",""),this.name=r.name,this.elements.push(new Iy(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>IS(nv,this,XGe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>IS(nv,this,qGe).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ed){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?qn:ed},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,o,a)=>{const[l]=Ad(i,h=>h.name===ed),u={},c=this.hot.getTranslatedPhrase(x_);if(l){const h=o(n,a),f=Pt(h,v=>v.value),d=new Map(h.map(v=>[v.value,this.hot.getCellMeta(v.meta.visualRow,v.meta.visualCol)])),g=l2(f);s&&(l.args[0]=s);const m=[],p=aj(g,l.args[0],c,v=>{v.checked&&m.push(v.value),IS(nv,this,wj).call(this,v,d)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[m],u.command=Zf(ed),u.itemsSnapshot=p}else u.args=[],u.command=Zf(qn);this.state.setValueAtIndex(n,u)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Iy)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{Se(r.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Se(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||Z(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(x_),r=this._getColumnVisibleValues(),n=r.map(l=>l.value),i=new Map(r.map(l=>[l.value,l.meta])),s=l2(n),o=aj(s,s,e,l=>{IS(nv,this,wj).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Pt(this.hot.getDataAtCol(e.visualIndex),(r,n)=>({value:s$(r),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function XGe(t){y1(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ja(t))}function wj(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function qGe(t,e){switch(e.type){case"numeric":return CQ(t,e);default:return t}}var MZ;function JGe(t,e){QGe(t,e),e.add(t)}function QGe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZGe(t,e,r){return(e=eYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eYe(t){var e=tYe(t,"string");return typeof e=="symbol"?e:e+""}function tYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rYe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var yj=new WeakSet;class Oy extends O1{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),JGe(this,yj),ZGe(this,"name",""),this.name=r.name,this.elements.push(new xh(this.hot,{type:"button",value:wL,className:"htUIButton htUIButtonOK",identifier:Oy.BUTTON_OK})),this.elements.push(new xh(this.hot,{type:"button",value:yL,className:"htUIButton htUIButtonCancel",identifier:Oy.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Z(this.elements,e=>{e.addLocalHook("click",(r,n)=>rYe(yj,this,nYe).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Se(r.parentNode,"htFiltersMenuActionBar"),Z(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}MZ=Oy;function nYe(t,e){e.options.identifier===MZ.BUTTON_OK?this.accept():this.cancel()}function NA(t,e,r){return(e=iYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iYe(t){var e=sYe(t,"string");return typeof e=="symbol"?e:e+""}function sYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cj="ConditionCollection.filteringStates";class u${constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;NA(this,"hot",void 0),NA(this,"isMapRegistrable",void 0),NA(this,"filteringStates",new NR),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(Cj,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i==null?void 0:i.conditions)!==null&&n!==void 0?n:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sh;return e.length?J9e(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sh,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=r.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=r.name||r.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==n)throw Error(Jt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Dr(ky[n]))throw new Error(Jt`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:o,func:Ih(a,o)}]},i):u.push({name:a,args:o,func:Ih(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:s.map(o=>{let{name:a,args:l}=o;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(r=>{r.conditions.forEach(n=>this.addCondition(r.column,n))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Cj),this.filteringStates=null,this.clearLocalHooks()}}ur(u$,hi);function Sj(t,e,r){return(e=oYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oYe(t){var e=aYe(t,"string");return typeof e=="symbol"?e:e+""}function aYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NZ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];Sj(this,"conditionCollection",void 0),Sj(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return Z(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return Z(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return Z(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}function lYe(t,e){uYe(t,e),e.add(t)}function uYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vf(t,e,r){return(e=cYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cYe(t){var e=hYe(t,"string");return typeof e=="symbol"?e:e+""}function hYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DA(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var OS=new WeakSet;class DZ{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];lYe(this,OS),vf(this,"hot",void 0),vf(this,"conditionCollection",void 0),vf(this,"columnDataFactory",void 0),vf(this,"changes",[]),vf(this,"grouping",!1),vf(this,"latestEditedColumnPosition",-1),vf(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",i=>DA(OS,this,fYe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>DA(OS,this,dYe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>DA(OS,this,gYe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Z(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=WNe(function(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const d=new u$(n.hot,!1),g=[].concat(c,f);d.importAllConditions(g);const m=n.columnDataFactory(h);let p;d.isEmpty()?p=m:p=new NZ(d,v=>n.columnDataFactory(v)).filter(),p=Pt(p,v=>v.meta.visualRow);const w=M1(p);return d.destroy(),Ad(m,v=>w(v.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),Ct(this,(e,r)=>{this[r]=null})}}function fYe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function dYe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function gYe(){Z(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ur(DZ,hi);function mYe(t){return rZ({initialPage:0,size:()=>t.length,onItemSelect:(r,n)=>{const i=t[r];if(i instanceof Iy)return n;if(i.element&&!vp(i.element))return!1;i.focus()}})}const iv="filters";function pYe(t,e){let r=-1,n;const i=mYe(e),s=h=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(iv),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Na&&(h.addLocalHook("click",s(h)),h.addLocalHook("focus",s(h)),h.addLocalHook("afterClose",s(h)))}),l(t);function o(h){const f=n.getKeyboardShortcutsCtrl(),d=h.getKeyboardShortcutsCtrl();i.clear(),d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:f.getContext(iv),callback:()=>{h.isSubMenu()&&h.close(),f.listen(iv)}}]),!h.isSubMenu()&&f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const m=n.getNavigator();m.getCurrentPage()>-1&&(r=m.getCurrentPage()),m.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const m=e[i.getCurrentPage()];m instanceof Py&&(m.openOptions(),g.preventDefault()),m instanceof Ay&&(m.activate(),g.preventDefault()),m instanceof Na||g.preventDefault()}}],iv)}function a(){n.focus(),n.getKeyboardShortcutsCtrl().listen(iv)}function l(h){h.addLocalHook("afterSelectionChange",f=>{f.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",o),h.addLocalHook("afterOpen",o),n=h}function u(){return n}function c(){return r}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function vYe(t,e){FZ(t,e),e.add(t)}function FA(t,e,r){FZ(t,e),e.set(t,r)}function FZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sv(t,e,r){return(e=wYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wYe(t){var e=yYe(t,"string");return typeof e=="symbol"?e:e+""}function yYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rb(t,e,r){return t.set(ds(t,e),r),r}function Io(t,e){return t.get(ds(t,e))}function ds(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const c2="filters",CYe=250,xj=c2;var cu=new WeakMap,h2=new WeakMap,Uf=new WeakMap,Ns=new WeakSet;class SYe extends zt{static get PLUGIN_KEY(){return c2}static get PLUGIN_PRIORITY(){return CYe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var r;super(e),r=this,vYe(this,Ns),sv(this,"dropdownMenuPlugin",null),sv(this,"conditionCollection",null),sv(this,"conditionUpdateObserver",null),sv(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),sv(this,"filtersRowsMap",null),FA(this,cu,void 0),FA(this,h2,new WeakSet),FA(this,Uf,[]),this.hot.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ds(Ns,r,kYe).call(r,...i)})}isEnabled(){return!!this.hot.getSettings()[c2]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new b1),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,n=r&&r.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>ds(Ns,this,bj).call(this,"accept")),a.addLocalHook("cancel",()=>ds(Ns,this,bj).call(this,"cancel")),a.addLocalHook("change",l=>ds(Ns,this,TYe).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(dL)}:`,o=()=>`${this.hot.getTranslatedPhrase(gL)}:`;if(!this.components.get("filter_by_condition")){const a=new u2(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:n});a.addLocalHook("afterClose",()=>ds(Ns,this,_j).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new IGe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new u2(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});a.addLocalHook("afterClose",()=>ds(Ns,this,_j).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new KGe(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Oy(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new u$(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new DZ(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>ds(Ns,this,PYe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return ds(Ns,e,RYe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>ds(Ns,this,EYe).call(this)),this.addHook("afterDropdownMenuShow",()=>ds(Ns,this,bYe).call(this)),this.addHook("afterDropdownMenuHide",()=>ds(Ns,this,_Ye).call(this)),this.addHook("afterChange",a=>ds(Ns,this,xYe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Io(cu,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Io(cu,this).getMenu(),c=u.getNavigator(),h=Io(cu,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];rb(cu,this,pYe(this.dropdownMenuPlugin.menu,a));const l=u=>{Io(cu,this).listen(),u.preventDefault(),y1(u.keyCode,"TAB")&&(u.shiftKey?Io(cu,this).toPreviousItem():Io(cu,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:xj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xj)}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Sh;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const s=this.exportConditions(),o=this.hot.runHooks("beforeFilter",s,Io(Uf,this));if(o!==!1&&n){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Pt(r.filter(),u=>u.meta.visualRow);const l=M1(i);je(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),Z(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),rb(Uf,this,this.exportConditions())}else o!==!1&&!n?(rb(Uf,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Io(Uf,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),o!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return Z(this.hot.getSourceDataAtCol(r),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:d,locale:g}=this.hot.getCellMeta(s,r),m=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&o!==void 0?o:i;n.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:d,locale:g},value:s$(m)})}),n}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=l2(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===B_&&r.command.key!==qn&&n.command.key!==qn&&i.command.key!==qn?s=a$:i.command.key!==qn&&(r.command.key===qn||n.command.key===qn)&&(s=Sh),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new NZ(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Z(i,o=>{Z(r.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function xYe(t){t&&Z(t,e=>{const[,r]=e,n=this.hot.propToCol(r);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function bYe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function _Ye(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function EYe(){const t=this.dropdownMenuPlugin.menu;Io(h2,this).has(t)||Io(cu,this).setMenu(t),Io(h2,this).add(t)}function RYe(t){t.items.push({name:wt}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function bj(t){var e;if(t==="accept"){const n=this.getSelectedColumn();if(n===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=n,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==qn&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==qn&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==qn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function TYe(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===u2&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function _j(){this.setListeningDropdownMenu()}function kYe(t,e,r){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)&&r===this.hot.view.getColumnHeadersCount()-1?Se(e,"htFiltersActive"):qe(e,"htFiltersActive")}function PYe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:n},conditionArgsChange:i}=t;Array.isArray(i)&&rb(Uf,this,Io(Uf,this).map(a=>(a.column===n&&r.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const s=r.filter(a=>a.name===ed),o=r.filter(a=>a.name!==ed);if(s.length>=2||o.length>=3)Ut(Jt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_operators").updateState(a,n),this.components.get("filter_by_value").updateState(t)}}const HZ="internal-use-in-handsontable",f2={licenseKey:HZ,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function LZ(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Ri])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function $Z(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function AYe(t){var e;const r=t[Ri],n=$Z(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=LZ(t);return{...f2,...n,...i}}function IYe(t){var e;const r=t[Ri],n=$Z(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=LZ(t);return{...n,...i}}function OYe(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function rT(){const t="engine_relationship",e=Qo(Ri);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function c$(){const t="shared_engine_usage",e=Qo(Ri);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function MYe(t){const e=t.getSettings(),r=e[Ri],n=r==null?void 0:r.engine;if(r===!0||Dr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return NYe((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&Dr(n.hyperformula)){const s=rT(),o=c$().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:HZ}),(n.getConfig().leapYear1900!==f2.leapYear1900||EF(n.getConfig().nullDate,f2.nullDate)===!1)&&Ut(Jt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function NYe(t,e,r){const n=e[Ri],i=AYe(e),s=rT(),o=c$();DYe(t,n.functions),FYe(t,n.language);const a=t.buildEmpty(i);return s.set(a,[r]),o.set(a,[r.guid]),HYe(a,n.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function Ej(t){var e;const r=rT(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function Rj(t,e){if(t){const r=rT(),n=r.get(t),i=c$(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function DYe(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(o){Ut(o.message)}})}function FYe(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){Ut(n.message)}}}function HYe(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:o}=r;try{t.addNamedExpression(n,i,s,o)}catch(a){Ut(a.message)}}),t.resumeEvaluation())}function LYe(t,e){return(Dr(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const BZ="DD/MM/YYYY";function $Ye(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function BYe(t){return $Ye(t)?t.substr(1):t}function VYe(t){return typeof t=="string"&&t.startsWith("=")}function h$(t,e){return typeof t=="string"&&e==="date"}function VZ(t,e){return _e(t,e,!0).isValid()}function WZ(t,e){return _e(t,e,!0).format(BZ)}function WYe(t,e){return _e(t,BZ,!0).format(e)}function jZ(t,e){const n=new Date(Date.UTC(0,0,t+-1));return _e(n).format(e)}function jYe(t,e,r){const n=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function UYe(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function zYe(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function f$(t,e,r){const n=UYe(t,jYe(t,e,r));return zYe(n)}function wf(t,e,r){GYe(t,e),e.set(t,r)}function GYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e){return t.get(UZ(t,e))}function kc(t,e,r){return t.set(UZ(t,e),r),r}function UZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ov=new WeakMap,Pc=new WeakMap,Ds=new WeakMap,MS=new WeakMap,HA=new WeakMap,LA=new WeakMap,NS=new WeakMap;class Tj{constructor(e,r,n){wf(this,ov,void 0),wf(this,Pc,void 0),wf(this,Ds,void 0),wf(this,MS,[]),wf(this,HA,[]),wf(this,LA,void 0),wf(this,NS,[]),kc(ov,this,e),kc(Pc,this,r),kc(Ds,this,n)}setRemovedHfIndexes(e){return kc(NS,this,e.map(r=>{const n=_r(Pc,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),_r(NS,this)}getRemovedHfIndexes(){return _r(NS,this)}getHfIndexFromVisualIndex(e){const r=_r(Pc,this).getIndexesSequence(),n=_r(Pc,this).getNotTrimmedIndexes();return r.indexOf(n[e],e)}syncMoves(e){const n=`move${La(_r(ov,this))}s`;_r(Ds,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&_r(Ds,this).getEngine()[n](_r(Ds,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(kc(HA,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),kc(LA,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(_r(Ds,this).isPerformingUndoRedo()||e===!1||r===!1)return;const n=f$(_r(HA,this),_r(LA,this),_r(Pc,this).getNumberOfIndexes());_r(Ds,this).getSheetId()===null?_r(Ds,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${La(_r(ov,this))}Order`;return r=>{if(_r(Ds,this).isPerformingUndoRedo())return;const n=_r(Pc,this).getIndexesSequence();if(r==="update"&&n.length>0){const i=_r(MS,this).map(l=>n.indexOf(l)),s=_r(Ds,this).getEngine().getSheetDimensions(_r(Ds,this).getSheetId());let o;_r(ov,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);_r(Ds,this).getEngine()[e](_r(Ds,this).getSheetId(),i)}kc(MS,this,n)}}init(){kc(MS,this,_r(Pc,this).getIndexesSequence())}}function yf(t,e,r){YYe(t,e),e.set(t,r)}function YYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iu(t,e){return t.get(zZ(t,e))}function Cf(t,e,r){return t.set(zZ(t,e),r),r}function zZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var DS=new WeakMap,FS=new WeakMap,$A=new WeakMap,BA=new WeakMap,VA=new WeakMap,WA=new WeakMap,jA=new WeakMap;class KYe{constructor(e,r,n){yf(this,DS,void 0),yf(this,FS,void 0),yf(this,$A,void 0),yf(this,BA,!1),yf(this,VA,!1),yf(this,WA,null),yf(this,jA,null),Cf(DS,this,new Tj("row",e,this)),Cf(FS,this,new Tj("column",r,this)),Cf($A,this,n)}getForAxis(e){return e==="row"?iu(DS,this):iu(FS,this)}setPerformUndo(e){Cf(BA,this,e)}setPerformRedo(e){Cf(VA,this,e)}isPerformingUndoRedo(){return iu(BA,this)||iu(VA,this)}getSheetId(){return iu(jA,this)}getEngine(){return iu(WA,this)}getPostponeAction(){return iu($A,this)}setupSyncEndpoint(e,r){Cf(WA,this,e),Cf(jA,this,r),iu(DS,this).init(),iu(FS,this).init()}}function XYe(t,e){GZ(t,e),e.add(t)}function Sf(t,e,r){return(e=qYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qYe(t){var e=JYe(t,"string");return typeof e=="symbol"?e:e+""}function JYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UA(t,e,r){GZ(t,e),e.set(t,r)}function GZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oh(t,e,r){return t.set(Dt(t,e),r),r}function fd(t,e){return t.get(Dt(t,e))}function Dt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Ri="formulas",QYe=["maxRows","maxColumns","language"],ZYe=260;Fe.getSingleton().register("afterNamedExpressionAdded");Fe.getSingleton().register("afterNamedExpressionRemoved");Fe.getSingleton().register("afterSheetAdded");Fe.getSingleton().register("afterSheetRemoved");Fe.getSingleton().register("afterSheetRenamed");Fe.getSingleton().register("afterFormulasValuesUpdate");const Qp=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Ju=new WeakMap,nT=new WeakMap,av=new WeakMap,Vt=new WeakSet;class eKe extends zt{constructor(){var e;super(...arguments),e=this,XYe(this,Vt),UA(this,Ju,!1),UA(this,nT,!1),UA(this,av,[["valuesUpdated",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Vt,e,pKe).call(e,...n)}],["namedExpressionAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Vt,e,vKe).call(e,...n)}],["namedExpressionRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Vt,e,wKe).call(e,...n)}],["sheetAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Vt,e,yKe).call(e,...n)}],["sheetRenamed",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Vt,e,CKe).call(e,...n)}],["sheetRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt(Vt,e,SKe).call(e,...n)}]]),Sf(this,"staticRegister",Qo("formulas")),Sf(this,"engine",null),Sf(this,"sheetId",null),Sf(this,"sheetName",null),Sf(this,"indexSyncer",null),Sf(this,"rowAxisSyncer",null),Sf(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Ri}static get PLUGIN_PRIORITY(){return ZYe}static get SETTING_KEYS(){return[Ri,...QYe]}isEnabled(){return!!this.hot.getSettings()[Ri]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=MYe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ut("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&Dt(Vt,this,hw).call(this,n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,kj).call(r,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,Pj).call(r,...i)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,kj).call(r,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,Pj).call(r,...i)}),this.addHook("modifyData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,iKe).call(r,...i)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,sKe).call(r,...i)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,tKe).call(r,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,oKe).call(r,...i)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,Aj).call(r,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,Aj).call(r,...i)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,aKe).call(r,...i)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,lKe).call(r,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,hKe).call(r,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,fKe).call(r,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,uKe).call(r,...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,cKe).call(r,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,dKe).call(r,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,gKe).call(r,...i)}),this.indexSyncer=new KYe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("beforeColumnMove",(n,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("afterRowMove",(n,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(n,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,nKe).call(r,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,mKe).call(r,...i)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dt(Vt,r,rKe).call(r,...i)}),fd(av,this).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){fd(av,this).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),Rj(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=IYe(this.hot.getSettings());OYe(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[Ri];if(Le(n)&&Le(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Ri].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const s=this.addSheet(i??void 0,this.hot.getSourceDataArray());Dt(Vt,this,hw).call(this,s)}}super.updatePlugin(e)}destroy(){fd(av,this).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),Oh(av,this,null),Rj(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(Le(r)&&!R4e(r))return Ut("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ut("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return Ut(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){IF(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Dt(Vt,this,hw).call(this,e);const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${La(Ri)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(n.has(o)||n.add(o))}),Ej(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var o;const{row:a,col:l,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return Le(u)?`${u}:${a}x${l}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(Le(l)===!1||Le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=n(s);if(c!==void 0&&!i.has(h)){const f=Ej(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ut(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return h$(n,s.type)&&(VZ(n,s.dateFormat)?n=WZ(n,s.dateFormat):VYe(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function hw(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function tKe(t,e,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(e,n)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},s=this.hot.getCellMeta(e,n);let o=this.engine.getCellValue(i);return s.type==="date"&&qi(o)&&(o=jZ(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function rKe(t,e,r){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=r.getTopStartCorner(),{row:u,col:c}=r.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const d=this.engine.getFillRangeData(h,f),{row:g,col:m}=h.start,{row:p,col:w}=h.end,v=p-g+1,y=w-m+1;for(let b=0;b<d.length;b+=1)for(let T=0;T<d[b].length;T+=1){const E=d[b][T],x=g+b%v,P=m+T%y,A=this.hot.getCellMeta(x,P);h$(E,A.type)&&(E.startsWith("'")?d[b][T]=E.slice(1):this.isFormulaCellType(x,P,this.sheetId)===!1&&(d[b][T]=WYe(E,A.dateFormat)))}return d}function kj(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(La(Ri))||Oh(nT,this,Dr(this.hot.getSettings().data))}function nKe(){if(fd(nT,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((r,n)=>{r.forEach((i,s)=>{const o=this.hot.getCellMeta(n,s,{skipMetaExtension:!0}),a=o.dateFormat;h$(i,o.type)&&(VZ(i,a)?t[n][s]=WZ(i,a):i.startsWith("=")||(t[n][s]=`'${i}`))})}),Oh(Ju,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Oh(Ju,this,!1)}function Pj(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(r.includes(La(Ri)))return;const n=LYe(this.engine,this.hot.getSettings()[Ri].sheetName);if(Dt(Vt,this,hw).call(this,n),r!=="updateSettings")if(fd(nT,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Oh(Ju,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Oh(Ju,this,!1)}}}function iKe(t,e,r,n){if(n!=="get"||fd(Ju,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){r.value=BYe(r.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let o=this.engine.getCellValue(s);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&qi(o)&&(o=jZ(o,a.dateFormat)),r.value=typeof o=="object"&&o!==null?o.value:o}function sKe(t,e,r,n){if(n!=="get"||fd(Ju,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null)return;const o=this.getCellType(i,s);if(o==="VALUE"||o==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(l)}function Aj(t,e){if(Qp(e))return;const r=[],n=[],i=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(o,u,l):r.push([o,u,l]),n.push({address:f})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function oKe(t,e){if(Qp(e))return;const r=[],n=[];t.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!qi(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Ut(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}n.push({address:u}),r.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function aKe(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function lKe(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function uKe(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function cKe(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function hKe(t,e,r){if(Qp(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function fKe(t,e,r){if(Qp(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function dKe(t,e,r,n){if(Qp(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function gKe(t,e,r,n){if(Qp(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function mKe(t,e,r){var n;Oh(Ju,this,!0);const i=this.hot.getSourceDataArray(r,0,r+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());Oh(Ju,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:r+o,sheet:this.sheetId},[[a]])})})}function pKe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function vKe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function wKe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function yKe(t){this.hot.runHooks("afterSheetAdded",t)}function CKe(t,e){Dt(Vt,this,hw).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function SKe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function xKe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(UH,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function bKe(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(zH,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=Pt(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,f=l-a+1;if(h>f){const d=u.slice(i,s+1);c.push(...d.filter(g=>r.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===f&&h>s&&c.push(...u.slice(s+1))}return Z(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function _Ke(t,e){YZ(t,e),e.add(t)}function EKe(t,e,r){YZ(t,e),e.set(t,r)}function YZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xf(t,e){return t.get($c(t,e))}function Ij(t,e,r){return t.set($c(t,e),r),r}function $c(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeHideColumns");Fe.getSingleton().register("afterHideColumns");Fe.getSingleton().register("beforeUnhideColumns");Fe.getSingleton().register("afterUnhideColumns");const Oj="hiddenColumns",RKe=310;var il=new WeakMap,bf=new WeakSet;class TKe extends zt{constructor(){super(...arguments),_Ke(this,bf),EKe(this,il,null)}static get PLUGIN_KEY(){return Oj}static get PLUGIN_PRIORITY(){return RKe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[Oj]}enablePlugin(){var e=this;this.enabled||(Ij(il,this,new MR),xf(il,this).addLocalHook("init",()=>$c(bf,this,MKe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,xf(il,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $c(bf,e,OKe).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>$c(bf,this,PKe).call(this,r,n,i)),this.addHook("modifyColWidth",(r,n)=>$c(bf,this,kKe).call(this,r,n),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $c(bf,e,IKe).call(e,...n)}),this.addHook("modifyCopyableRange",r=>$c(bf,this,AKe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=xf(il,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));Z(l,u=>{s[u]=!1}),i=Ms(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&o)!==!1&&(n&&o&&xf(il,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&o,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{Z(e,o=>{xf(il,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return Pt(xf(il,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return xf(il,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){Z(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){Ij(il,this,null),super.destroy()}}function kKe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function PKe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenColumn");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function AKe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return Z(t,n=>{let i=!0,s=0;je(n.startCol,n.endCol,o=>{this.isHidden(o)?(i||r(n.startRow,n.endRow,s,o-1),i=!0):(i&&(s=o),o===n.endCol&&r(n.startRow,n.endRow,s,o),i=!1)})}),e}function IKe(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),Se(e,r)}function OKe(t){t.items.push({name:wt},xKe(this),bKe(this))}function MKe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function NKe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(GH,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function DKe(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(YH,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=Pt(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,f=l-a+1;if(h>f){const d=u.slice(i,s+1);c.push(...d.filter(g=>r.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===f&&h>s&&c.push(...u.slice(s+1))}return Z(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function FKe(t,e){KZ(t,e),e.add(t)}function HKe(t,e,r){KZ(t,e),e.set(t,r)}function KZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _f(t,e){return t.get(Bc(t,e))}function Mj(t,e,r){return t.set(Bc(t,e),r),r}function Bc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeHideRows");Fe.getSingleton().register("afterHideRows");Fe.getSingleton().register("beforeUnhideRows");Fe.getSingleton().register("afterUnhideRows");const Nj="hiddenRows",LKe=320;var sl=new WeakMap,Ef=new WeakSet;class $Ke extends zt{constructor(){super(...arguments),FKe(this,Ef),HKe(this,sl,null)}static get PLUGIN_KEY(){return Nj}static get PLUGIN_PRIORITY(){return LKe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[Nj]}enablePlugin(){var e=this;this.enabled||(Mj(sl,this,new MR),_f(sl,this).addLocalHook("init",()=>Bc(Ef,this,zKe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_f(sl,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bc(Ef,e,UKe).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>Bc(Ef,this,VKe).call(this,r,n,i)),this.addHook("modifyRowHeight",(r,n)=>Bc(Ef,this,BKe).call(this,r,n)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bc(Ef,e,jKe).call(e,...n)}),this.addHook("modifyCopyableRange",r=>Bc(Ef,this,WKe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=_f(sl,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));Z(l,u=>{s[u]=!1}),i=Ms(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&o)!==!1&&(n&&o&&_f(sl,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&o,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{Z(e,o=>{_f(sl,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return Pt(_f(sl,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _f(sl,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){Z(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){Mj(sl,this,null),super.destroy()}}function BKe(t,e){return this.isHidden(e)?0:t}function VKe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenRow");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function WKe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return Z(t,n=>{let i=!0,s=0;je(n.startRow,n.endRow,o=>{this.isHidden(o)?(i||r(s,o-1,n.startCol,n.endCol),i=!0):(i&&(s=o),o===n.endRow&&r(s,o,n.startCol,n.endCol),i=!1)})}),e}function jKe(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),Se(e,r)}function UKe(t){t.items.push({name:wt},NKe(this),DKe(this))}function zKe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function GKe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CH)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function YKe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(SH)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function KKe(t,e){XZ(t,e),e.add(t)}function XKe(t,e,r){XZ(t,e),e.set(t,r)}function XZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d2(t,e){return t.get(W_(t,e))}function zA(t,e,r){return t.set(W_(t,e),r),r}function W_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeColumnFreeze");Fe.getSingleton().register("afterColumnFreeze");Fe.getSingleton().register("beforeColumnUnfreeze");Fe.getSingleton().register("afterColumnUnfreeze");const Dj="manualColumnFreeze",qKe=110;var Bf=new WeakMap,GA=new WeakSet;class JKe extends zt{constructor(){super(...arguments),KKe(this,GA),XKe(this,Bf,!1)}static get PLUGIN_KEY(){return Dj}static get PLUGIN_PRIORITY(){return qKe}isEnabled(){return!!this.hot.getSettings()[Dj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>W_(GA,this,QKe).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>W_(GA,this,ZKe).call(this,e,r)),super.enablePlugin())}disablePlugin(){zA(Bf,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;d2(Bf,this)||zA(Bf,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;d2(Bf,this)||zA(Bf,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function QKe(t){t.items.push({name:"---------"},GKe(this),YKe(this))}function ZKe(t,e){if(d2(Bf,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(n=>n<r))return!1}}function HS(t,e,r){return(e=eXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eXe(t){var e=tXe(t,"string");return typeof e=="symbol"?e:e+""}function tXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const YA=0,Fj=1,Hj=2,zg="px";let qZ=class{constructor(e){HS(this,"hot",void 0),HS(this,"_element",null),HS(this,"state",YA),HS(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=Hj}build(){this.state===YA&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Fj)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=YA}isAppended(){return this.state===Hj}isBuilt(){return this.state>=Fj}setPosition(e,r){qi(e)&&(this._element.style.top=e+zg),qi(r)&&(this._element.style[this.inlineProperty]=r+zg)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){qi(e)&&(this._element.style.width=e+zg),qi(r)&&(this._element.style.height=r+zg)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){qi(e)&&(this._element.style.marginTop=e+zg),qi(r)&&(this._element.style[`margin${La(this.inlineProperty)}`]=r+zg)}getOffset(){const e=this._element.style,r=`margin${La(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const rXe="ht__manualColumnMove--backlight";let nXe=class extends qZ{build(){super.build(),Se(this._element,rXe)}};const iXe="ht__manualColumnMove--guideline";let sXe=class extends qZ{build(){super.build(),Se(this._element,iXe)}};function oXe(t,e){JZ(t,e),e.add(t)}function la(t,e,r){JZ(t,e),e.set(t,r)}function JZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cs(t,e,r){return t.set(Vc(t,e),r),r}function Ve(t,e){return t.get(Vc(t,e))}function Vc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeColumnMove");Fe.getSingleton().register("afterColumnMove");const KA="manualColumnMove",aXe=120,Lj="ht__manualColumnMove",j_="show-ui",g2="on-moving--columns",m2="after-selection--columns";var Ki=new WeakMap,zc=new WeakMap,Pu=new WeakMap,nb=new WeakMap,ah=new WeakMap,zi=new WeakMap,LS=new WeakMap,Eo=new WeakMap,um=new WeakMap,U_=new WeakMap,fw=new WeakMap,Rf=new WeakSet;class lXe extends zt{constructor(){super(...arguments),oXe(this,Rf),la(this,Ki,new nXe(this.hot)),la(this,zc,new sXe(this.hot)),la(this,Pu,[]),la(this,nb,0),la(this,ah,!1),la(this,zi,{}),la(this,LS,void 0),la(this,Eo,void 0),la(this,um,void 0),la(this,U_,void 0),la(this,fw,void 0)}static get PLUGIN_KEY(){return KA}static get PLUGIN_PRIORITY(){return aXe}isEnabled(){return!!this.hot.getSettings()[KA]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vc(Rf,e,uXe).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vc(Rf,e,hXe).call(e,...n)}),this.addHook("afterScrollVertically",()=>Vc(Rf,this,dXe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vc(Rf,e,gXe).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Se(this.hot.rootElement,Lj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){qe(this.hot.rootElement,Lj),this.unregisterEvents(),Ve(Ki,this).destroy(),Ve(zc,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=Ve(LS,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,n,i);if(Cs(LS,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=i&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,n,i,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r);return Cs(LS,this,r),this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Ms(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const o=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[KA];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return je(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Ve(Eo,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Ve(Eo,this)-1);const o=r.hider.offsetWidth,a=r.TBODY.offsetLeft,l=Ve(Ki,this).getOffset().start,u=Ve(Ki,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,m=mn(this.hot.rootElement),p=g.innerWidth-Ve(um,this)-m;h=g.innerWidth-Ve(zi,this).eventPageX-p-(n.scrollX===void 0?i:0)}else h=Ve(zi,this).eventPageX-(Ve(um,this)-(n.scrollX===void 0?i:0));if(Ve(U_,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Ve(Eo,this))&&(s+=i),s+=c,Ve(Eo,this)<0)Ve(fw,this)>0?Ve(zi,this).col=0:Ve(zi,this).col=e>0?e-1:e;else if(Ve(zi,this).TD.offsetWidth/2+s<=h){const g=Ve(Eo,this)>=Ve(nb,this)?Ve(nb,this)-1:Ve(Eo,this);Ve(zi,this).col=g+1,s+=Ve(zi,this).TD.offsetWidth}else Ve(zi,this).col=Ve(Eo,this);let f=h,d=s;h+u+l>=o?f=o-u-l:h+l<a+c&&(f=a+c+Math.abs(l)),s>=o-1?d=o-1:d===0?d=1:n.scrollX!==void 0&&Ve(Eo,this)<Ve(fw,this)&&(d-=Ve(um,this)<=n.scrollX?Ve(um,this):0),Ve(Ki,this).setPosition(null,f),Ve(zc,this).setPosition(null,d)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Vc(Rf,this,cXe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Vc(Rf,this,fXe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ve(Ki,this).build(),Ve(zc,this).build()}destroy(){Ve(Ki,this).destroy(),Ve(zc,this).destroy(),super.destroy()}}function uXe(t,e,r,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=et(t.target,"sortAction");if(!o||!s||Ve(ah,this)||t.button!==0||a){Cs(ah,this,!1),Ve(Pu,this).length=0,qe(this.hot.rootElement,[g2,j_]);return}const l=Ve(zc,this).isBuilt()&&!Ve(zc,this).isAppended(),u=Ve(Ki,this).isBuilt()&&!Ve(Ki,this).isAppended();l&&u&&(Ve(zc,this).appendTo(i.hider),Ve(Ki,this).appendTo(i.hider));const{from:c,to:h}=o,f=Math.min(c.col,h.col),d=Math.max(c.col,h.col);if(e.row<0&&e.col>=f&&e.col<=d){n.column=!0,Cs(ah,this,!0);const g=r.firstChild?YNe(t,r.firstChild).x:t.offsetX;Ve(zi,this).eventPageX=t.pageX,Cs(Eo,this,e.col),Ve(zi,this).TD=r,Ve(zi,this).col=e.col,Cs(Pu,this,this.prepareColumnsToMoving(f,d)),Cs(U_,this,!!this.hot.getSettings().rowHeaders),Cs(nb,this,this.hot.countCols()),Cs(fw,this,this.hot.getSettings().fixedColumnsStart),Cs(um,this,Pi(this.hot.rootElement).left);const m=Ve(U_,this)?-1:0,p=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,w=e.col<Ve(fw,this),v=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),y=Math.abs(g-(this.hot.isRtl()?r.offsetWidth:0)),b=this.getColumnsWidth(f,e.col-1)+y,T=this.getColumnsWidth(m,f-1)+(w?v:0)+b;Ve(Ki,this).setPosition(p,T),Ve(Ki,this).setSize(this.getColumnsWidth(f,d),i.hider.offsetHeight-p),Ve(Ki,this).setOffset(null,-b),Se(this.hot.rootElement,g2)}else qe(this.hot.rootElement,m2),Cs(ah,this,!1),Ve(Pu,this).length=0}function cXe(t){Ve(ah,this)&&(Ve(zi,this).eventPageX=t.pageX,this.refreshPositions())}function hXe(t,e,r,n){!this.hot.getSelectedRangeLast()||!Ve(ah,this)||(Ve(Pu,this).indexOf(e.col)>-1?qe(this.hot.rootElement,j_):Se(this.hot.rootElement,j_),n.row=!0,n.column=!0,n.cell=!0,Cs(Eo,this,e.col),Ve(zi,this).TD=r)}function fXe(){const t=Ve(zi,this).col,e=Ve(Pu,this).length;if(Cs(Eo,this,void 0),Cs(ah,this,!1),qe(this.hot.rootElement,[g2,j_,m2]),this.hot.selection.isSelectedByColumnHeader()&&Se(this.hot.rootElement,m2),e<1||t===void 0)return;const r=Ve(Pu,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns(Ve(Pu,this),t);if(Ve(Pu,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(n),o=s+e-1;this.hot.selectColumns(s,o)}}function dXe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,n=e+r;Ve(Ki,this).setPosition(n),Ve(Ki,this).setSize(null,t.hider.offsetHeight-n)}function gXe(){this.moveBySettingsOrLoad()}function mXe(t,e){QZ(t,e),e.add(t)}function pi(t,e,r){QZ(t,e),e.set(t,r)}function QZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tn(t,e,r){return t.set(va(t,e),r),r}function He(t,e){return t.get(va(t,e))}function va(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const z_="manualColumnResize",pXe=130,$j="manualColumnWidths";var pu=new WeakMap,$S=new WeakMap,Us=new WeakMap,G_=new WeakMap,Rl=new WeakMap,vXe=new WeakMap,Qm=new WeakMap,BS=new WeakMap,fs=new WeakMap,hu=new WeakMap,Ld=new WeakMap,Y_=new WeakMap,dw=new WeakMap,gw=new WeakMap,Ys=new WeakMap,mw=new WeakMap,ol=new WeakSet;class wXe extends zt{static get PLUGIN_KEY(){return z_}static get PLUGIN_PRIORITY(){return pXe}constructor(e){super(e),mXe(this,ol),pi(this,pu,null),pi(this,$S,null),pi(this,Us,[]),pi(this,G_,null),pi(this,Rl,null),pi(this,vXe,null),pi(this,Qm,null),pi(this,BS,null),pi(this,fs,this.hot.rootDocument.createElement("DIV")),pi(this,hu,this.hot.rootDocument.createElement("DIV")),pi(this,Ld,null),pi(this,Y_,!1),pi(this,dw,0),pi(this,gw,null),pi(this,Ys,void 0),pi(this,mw,void 0),Se(He(fs,this),"manualColumnResizer"),Se(He(hu,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[z_]}enablePlugin(){var e=this;this.enabled||(tn(Ys,this,new jh),He(Ys,this).addLocalHook("init",()=>va(ol,this,yXe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,He(Ys,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return va(ol,e,EXe).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return va(ol,e,RXe).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return va(ol,e,TXe).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tn(mw,this,He(Ys,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",$j,He(Ys,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",$j,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return He(Ys,this).setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);He(Ys,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;tn(pu,this,e);const{_wt:r}=this.hot.view,n=r.wtTable.getCoords(He(pu,this)),i=n.col;if(i<0)return;const s=An(He(pu,this)),o=He(pu,this).getBoundingClientRect(),a=i<r.getSetting("fixedColumnsStart");let l;a&&(l=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(He(pu,this),n.row,n.col)),l||(l=r.wtOverlays.topOverlay.getRelativeCellPosition(He(pu,this),n.row,n.col)),tn($S,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),tn(Us,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();Z(c,h=>{const f=h.getTopStartCorner().col,d=h.getBottomEndCorner().col;je(f,d,g=>{He(Us,this).includes(g)||He(Us,this).push(g)})})}He(Us,this).includes(He($S,this))||tn(Us,this,[He($S,this)]),tn(BS,this,l.start-6),tn(Qm,this,parseInt(o.width,10)),He(fs,this).style.top=`${l.top}px`,He(fs,this).style[this.inlineDir]=`${He(BS,this)+He(Qm,this)}px`,He(fs,this).style.height=`${s}px`,this.hot.rootElement.appendChild(He(fs,this))}refreshHandlePosition(){He(fs,this).style[this.inlineDir]=`${He(BS,this)+He(G_,this)}px`}setupGuidePosition(){const e=parseInt(An(He(fs,this)),10),r=parseInt(He(fs,this).style.top,10)+e,n=this.hot.view.getTableHeight();Se(He(fs,this),"active"),Se(He(hu,this),"active"),He(hu,this).style.top=`${r}px`,this.refreshGuidePosition(),He(hu,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(He(hu,this))}refreshGuidePosition(){He(hu,this).style[this.inlineDir]=He(fs,this).style[this.inlineDir]}hideHandleAndGuide(){qe(He(fs,this),"active"),qe(He(hu,this),"active")}checkIfColumnHeader(e){const r=Id(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",He(Rl,this),n,!0);s!==void 0&&tn(Rl,this,s),this.setManualSize(n,He(Rl,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",He(Rl,this),n,!0),i&&e()};He(dw,this)>=2&&(He(Us,this).length>1?(Z(He(Us,this),i=>{r(i)}),e()):Z(He(Us,this),i=>{r(i,!0)})),tn(dw,this,0),tn(gw,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>va(ol,this,CXe).call(this,n)),this.eventManager.addEventListener(r,"mousedown",n=>va(ol,this,SXe).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>va(ol,this,xXe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>va(ol,this,bXe).call(this)),this.eventManager.addEventListener(He(fs,this),"contextmenu",()=>va(ol,this,_Xe).call(this))}destroy(){super.destroy()}}function yXe(){const t=this.hot.getSettings()[z_],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,n)=>{He(Ys,this).setValueAtIndex(n,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,n)=>{He(Ys,this).setValueAtIndex(n,r)})},!0),tn(mw,this,t)):t===!0&&Array.isArray(He(mw,this))&&this.hot.batchExecution(()=>{He(mw,this).forEach((r,n)=>{He(Ys,this).setValueAtIndex(n,r)})},!0)}function CXe(t){if(!Iq(t.target)&&He(Y_,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(He(Ld,this)||this.setupHandlePosition(e))}}function SXe(t){t.target.parentNode===this.hot.rootElement&&et(t.target,"manualColumnResizer")&&(this.setupHandlePosition(He(pu,this)),this.setupGuidePosition(),tn(Ld,this,!0),He(gw,this)===null&&(tn(gw,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(He(gw,this))),tn(dw,this,He(dw,this)+1),this.startX=t.pageX,tn(Rl,this,He(Qm,this)))}function xXe(t){if(He(Ld,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();tn(G_,this,He(Qm,this)+e),Z(He(Us,this),r=>{tn(Rl,this,this.setManualSize(r,He(G_,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function bXe(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeColumnResize",He(Rl,this),r,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",He(Rl,this),r,!1)};He(Ld,this)&&(this.hideHandleAndGuide(),tn(Ld,this,!1),He(Rl,this)!==He(Qm,this)&&(He(Us,this).length>1?(Z(He(Us,this),n=>{e(n)}),t()):Z(He(Us,this),n=>{e(n,!0)})),this.setupHandlePosition(He(pu,this)))}function _Xe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(He(fs,this)),this.hot.rootElement.removeChild(He(hu,this)),tn(Ld,this,!1),tn(Y_,this,!0),this.hot._registerImmediate(()=>{tn(Y_,this,!1)})}function EXe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalColumn(e),i=He(Ys,this).getValueAtIndex(n);this.hot.getSettings()[z_]&&i&&(r=i)}return r}function RXe(t,e){const r=He(Ys,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function TXe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function XA(t,e,r){return(e=kXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kXe(t){var e=PXe(t,"string");return typeof e=="symbol"?e:e+""}function PXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qA=0,Bj=1,Vj=2,Gg="px";let ZZ=class{constructor(e){XA(this,"hot",void 0),XA(this,"_element",null),XA(this,"state",qA),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=Vj}build(){this.state===qA&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Bj)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=qA}isAppended(){return this.state===Vj}isBuilt(){return this.state>=Bj}setPosition(e,r){e!==void 0&&(this._element.style.top=e+Gg),r!==void 0&&(this._element.style.left=r+Gg)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+Gg),r&&(this._element.style.height=r+Gg)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+Gg),r&&(this._element.style.marginLeft=r+Gg)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const AXe="ht__manualRowMove--backlight";class IXe extends ZZ{build(){super.build(),Se(this._element,AXe)}}const OXe="ht__manualRowMove--guideline";class MXe extends ZZ{build(){super.build(),Se(this._element,OXe)}}function NXe(t,e){eee(t,e),e.add(t)}function Yg(t,e,r){eee(t,e),e.set(t,r)}function eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function td(t,e,r){return t.set(Wc(t,e),r),r}function at(t,e){return t.get(Wc(t,e))}function Wc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeRowMove");Fe.getSingleton().register("afterRowMove");const JA="manualRowMove",DXe=140,Wj="ht__manualRowMove",K_="show-ui",p2="on-moving--rows",v2="after-selection--rows";var Xi=new WeakMap,Gc=new WeakMap,Au=new WeakMap,lh=new WeakMap,Ss=new WeakMap,VS=new WeakMap,Tf=new WeakSet;class FXe extends zt{constructor(){super(...arguments),NXe(this,Tf),Yg(this,Xi,new IXe(this.hot)),Yg(this,Gc,new MXe(this.hot)),Yg(this,Au,[]),Yg(this,lh,void 0),Yg(this,Ss,{}),Yg(this,VS,void 0)}static get PLUGIN_KEY(){return JA}static get PLUGIN_PRIORITY(){return DXe}isEnabled(){return!!this.hot.getSettings()[JA]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Wc(Tf,e,HXe).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Wc(Tf,e,$Xe).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>Wc(Tf,this,VXe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Wc(Tf,e,WXe).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Se(this.hot.rootElement,Wj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){qe(this.hot.rootElement,Wj),this.unregisterEvents(),at(Xi,this).destroy(),at(Gc,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=at(VS,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,n,i);if(td(VS,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=i&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,n,i,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r);return td(VS,this,r),this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Ms(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const o=n.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[JA];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),o=Math.max(n.row,i.row);return je(s,o,a=>{r.push(a)}),r}refreshPositions(){const e=at(Ss,this).coords,r=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=at(Ss,this).TD,a=this.hot.rootElement,l=Pi(a),u=wy(a),c=s.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-h,d=at(Ss,this).eventPageY-f+c,g=s.hider.offsetHeight,m=s.TBODY.offsetTop,p=at(Xi,this).getOffset().top,w=at(Xi,this).getSize().height,v=o.offsetHeight/2,y=o.offsetHeight;let b=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const T=d>=b+v;this.isFixedRowTop(e.row)&&(b+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?at(Ss,this).row=r>0?r-1:r:T?(at(Ss,this).row=e.row+1,b+=e.row===0?y-1:y):at(Ss,this).row=e.row;let E=d,x=b;d+w+p>=g?E=g-w-p:d+p<m&&(E=m+Math.abs(p)),b>=g-1&&(x=g-1),at(Xi,this).setPosition(E),at(Gc,this).setPosition(x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Wc(Tf,this,LXe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Wc(Tf,this,BXe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){at(Xi,this).build(),at(Gc,this).build()}destroy(){at(Xi,this).destroy(),at(Gc,this).destroy(),super.destroy()}}function HXe(t,e,r,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||at(lh,this)||t.button!==0){td(lh,this,!1),at(Au,this).length=0,qe(this.hot.rootElement,[p2,K_]);return}const l=at(Gc,this).isBuilt()&&!at(Gc,this).isAppended(),u=at(Xi,this).isBuilt()&&!at(Xi,this).isAppended();l&&u&&(at(Gc,this).appendTo(i.hider),at(Xi,this).appendTo(i.hider));const{from:c,to:h}=a,f=Math.min(c.row,h.row),d=Math.max(c.row,h.row);if(e.col<0&&e.row>=f&&e.row<=d){n.row=!0,td(lh,this,!0),at(Ss,this).eventPageY=t.pageY,at(Ss,this).coords=e,at(Ss,this).TD=r,td(Au,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+s.getRowHeaderWidth(),m=this.getRowsHeight(f,e.row-1)+(t.clientY-r.getBoundingClientRect().top);at(Xi,this).setPosition(null,g),at(Xi,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(f,d)),at(Xi,this).setOffset(-m,null),Se(this.hot.rootElement,p2),this.refreshPositions()}else qe(this.hot.rootElement,v2),td(lh,this,!1),at(Au,this).length=0}function LXe(t){at(lh,this)&&(at(Ss,this).eventPageY=t.pageY,this.refreshPositions())}function $Xe(t,e,r,n){!this.hot.getSelectedRangeLast()||!at(lh,this)||(at(Au,this).indexOf(e.row)>-1?qe(this.hot.rootElement,K_):Se(this.hot.rootElement,K_),n.row=!0,n.column=!0,n.cell=!0,at(Ss,this).coords=e,at(Ss,this).TD=r)}function BXe(){const t=at(Ss,this).row,e=at(Au,this).length;if(td(lh,this,!1),qe(this.hot.rootElement,[p2,K_,v2]),this.hot.selection.isSelectedByRowHeader()&&Se(this.hot.rootElement,v2),e<1||t===void 0)return;const r=at(Au,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(at(Au,this),t);if(at(Au,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(n),o=s+e-1;this.hot.selectRows(s,o)}}function VXe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,n=e+r;at(Xi,this).setPosition(null,n),at(Xi,this).setSize(t.hider.offsetWidth-n)}function WXe(){this.moveBySettingsOrLoad()}function jXe(t,e){tee(t,e),e.add(t)}function vi(t,e,r){tee(t,e),e.set(t,r)}function tee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vr(t,e,r){return t.set(vu(t,e),r),r}function De(t,e){return t.get(vu(t,e))}function vu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const X_="manualRowResize",UXe=30,jj="manualRowHeights";var yl=new WeakMap,WS=new WeakMap,zs=new WeakMap,pw=new WeakMap,Yc=new WeakMap,d$=new WeakMap,Zm=new WeakMap,jS=new WeakMap,Wi=new WeakMap,ml=new WeakMap,$d=new WeakMap,q_=new WeakMap,vw=new WeakMap,ww=new WeakMap,Sa=new WeakMap,yw=new WeakMap,Ac=new WeakSet;class zXe extends zt{static get PLUGIN_KEY(){return X_}static get PLUGIN_PRIORITY(){return UXe}constructor(e){super(e),jXe(this,Ac),vi(this,yl,null),vi(this,WS,null),vi(this,zs,[]),vi(this,pw,null),vi(this,Yc,null),vi(this,d$,null),vi(this,Zm,null),vi(this,jS,null),vi(this,Wi,this.hot.rootDocument.createElement("DIV")),vi(this,ml,this.hot.rootDocument.createElement("DIV")),vi(this,$d,!1),vi(this,q_,!1),vi(this,vw,0),vi(this,ww,null),vi(this,Sa,void 0),vi(this,yw,void 0),Se(De(Wi,this),"manualRowResizer"),Se(De(ml,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[X_]}enablePlugin(){this.enabled||(Vr(Sa,this,new jh),De(Sa,this).addLocalHook("init",()=>vu(Ac,this,QXe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,De(Sa,this)),this.addHook("modifyRowHeight",(e,r)=>vu(Ac,this,JXe).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vr(yw,this,De(Sa,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",jj,De(Sa,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",jj,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,this.hot.stylesHandler.getDefaultRowHeight());return De(Sa,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return De(pw,this)}setupHandlePosition(e){Vr(yl,this,e);const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(De(yl,this)),s=i.row;if(s<0)return;const o=mn(De(yl,this)),a=De(yl,this).getBoundingClientRect(),l=s<n.getSetting("fixedRowsTop"),u=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let c;l?c=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(De(yl,this),i.row,i.col):u&&(c=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(De(yl,this),i.row,i.col)),c||(c=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(De(yl,this),i.row,i.col)),Vr(WS,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Vr(zs,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();Z(f,d=>{const g=d.getTopStartCorner().row,m=d.getBottomStartCorner().row;je(g,m,p=>{De(zs,this).includes(p)||De(zs,this).push(p)})})}De(zs,this).includes(De(WS,this))||Vr(zs,this,[De(WS,this)]),Vr(jS,this,c.top-6),Vr(Zm,this,parseInt(a.height,10)),De(Wi,this).style.top=`${De(jS,this)+De(Zm,this)}px`,De(Wi,this).style[this.inlineDir]=`${c.start}px`,De(Wi,this).style.width=`${o}px`,this.hot.rootElement.appendChild(De(Wi,this))}refreshHandlePosition(){De(Wi,this).style.top=`${De(jS,this)+De(pw,this)}px`}setupGuidePosition(){const e=parseInt(mn(De(Wi,this)),10),r=parseInt(De(Wi,this).style[this.inlineDir],10)+e,n=this.hot.view.getTableWidth();Se(De(Wi,this),"active"),Se(De(ml,this),"active"),De(ml,this).style.top=De(Wi,this).style.top,De(ml,this).style[this.inlineDir]=`${r}px`,De(ml,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(De(ml,this))}refreshGuidePosition(){De(ml,this).style.top=De(Wi,this).style.top}hideHandleAndGuide(){qe(De(Wi,this),"active"),qe(De(ml,this),"active")}checkIfRowHeader(e){const r=Id(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&De(Yc,this)<r?r:De(Yc,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&Vr(Yc,this,s),this.setManualSize(n,De(Yc,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};De(vw,this)>=2&&(De(zs,this).length>1?(Z(De(zs,this),i=>{r(i)}),e()):Z(De(zs,this),i=>{r(i,!0)})),Vr(vw,this,0),Vr(ww,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>vu(Ac,this,GXe).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>vu(Ac,this,YXe).call(this,n)),this.eventManager.addEventListener(r,"mousemove",n=>vu(Ac,this,KXe).call(this,n)),this.eventManager.addEventListener(r,"mouseup",()=>vu(Ac,this,XXe).call(this)),this.eventManager.addEventListener(De(Wi,this),"contextmenu",()=>vu(Ac,this,qXe).call(this))}destroy(){super.destroy()}}function GXe(t){if(!Iq(t.target)&&De(q_,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(De($d,this)||this.setupHandlePosition(e))}}function YXe(t){et(t.target,"manualRowResizer")&&(this.setupHandlePosition(De(yl,this)),this.setupGuidePosition(),Vr($d,this,!0),De(ww,this)===null&&(Vr(ww,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(De(ww,this))),Vr(vw,this,De(vw,this)+1),Vr(d$,this,t.pageY),Vr(Yc,this,De(Zm,this)))}function KXe(t){De($d,this)&&(Vr(pw,this,De(Zm,this)+(t.pageY-De(d$,this))),Z(De(zs,this),e=>{Vr(Yc,this,this.setManualSize(e,De(pw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function XXe(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};De($d,this)&&(this.hideHandleAndGuide(),Vr($d,this,!1),De(Yc,this)!==De(Zm,this)&&(De(zs,this).length>1?(Z(De(zs,this),n=>{e(n)}),t()):Z(De(zs,this),n=>{e(n,!0)})),this.setupHandlePosition(De(yl,this)))}function qXe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(De(Wi,this)),this.hot.rootElement.removeChild(De(ml,this)),Vr($d,this,!1),Vr(q_,this,!0),this.hot._registerImmediate(()=>{Vr(q_,this,!1)})}function JXe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalRow(e),i=De(Sa,this).getValueAtIndex(n);this.hot.getSettings()[X_]&&i&&(r=i)}return r}function QXe(){const t=this.hot.getSettings()[X_],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,n)=>{De(Sa,this).setValueAtIndex(n,r)}):Array.isArray(t)?(t.forEach((r,n)=>{De(Sa,this).setValueAtIndex(n,r)}),Vr(yw,this,t)):t===!0&&Array.isArray(De(yw,this))&&De(yw,this).forEach((r,n)=>{De(Sa,this).setValueAtIndex(n,r)})},!0)}var ZXe=PR;ZXe("flatMap");var eqe=Mn,Uj=Dn,tqe=jl,rqe=UD,nqe=function(t,e){(!e||typeof t!="string")&&Uj(t);var r=rqe(t);return tqe(Uj(r!==void 0?eqe(r,t):t))},iqe=wr,w2=Mn,sqe=Is,y2=Dn,oqe=jl,aqe=nqe,lqe=qD,C2=Os,uqe=JD,cqe=Bh,ree=!uqe("flatMap",function(){}),S2=!ree&&cqe("flatMap",TypeError),hqe=ree||S2,fqe=lqe(function(){for(var t=this.iterator,e=this.mapper,r,n;;){if(n=this.inner)try{if(r=y2(w2(n.next,n.iterator)),!r.done)return r.value;this.inner=null}catch(i){C2(t,"throw",i)}if(r=y2(w2(this.next,t)),this.done=!!r.done)return;try{this.inner=aqe(e(r.value,this.counter++),!1)}catch(i){C2(t,"throw",i)}}});iqe({target:"Iterator",proto:!0,real:!0,forced:hqe},{flatMap:function(e){y2(this);try{sqe(e)}catch(r){C2(this,"throw",r)}return S2?w2(S2,this,e):new fqe(oqe(this),{mapper:e,inner:null})}});function dqe(t,e,r){gqe(t,e),e.set(t,r)}function gqe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kf(t,e,r){return(e=mqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mqe(t){var e=pqe(t,"string");return typeof e=="symbol"?e:e+""}function pqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zj(t,e){return t.get(nee(t,e))}function US(t,e,r){return t.set(nee(t,e),r),r}function nee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pf=new WeakMap;class Cl{constructor(e,r,n,i,s,o){kf(this,"row",void 0),kf(this,"col",void 0),kf(this,"rowspan",void 0),kf(this,"colspan",void 0),kf(this,"removed",!1),kf(this,"cellCoordsFactory",void 0),kf(this,"cellRangeFactory",void 0),dqe(this,Pf,null),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return Jt`The merged cell declared with {row: ${r}, col: ${n},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:n}=e;return Jt`The merged cell declared at [${r}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:n}=e;return Jt`The merged cell declared at [${r}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:n}=e;return Jt`The merged cell declared at [${r}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return r<0||n<0||i<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:n}=e;return n===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:n}=e;return n===0||r===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),US(Pf,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(r,i),l=Math.max(r,i),u=this[o],c=this[o]+this[s]-1;if(u>=r&&(this[o]+=n),n>0)r<=c&&r>u&&(this[s]+=n);else if(n<0){if(a<=u&&l>=c)return this.removed=!0,US(Pf,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,f=Math.abs(n)-h;this[o]-=f+n,this[s]-=h}else if(u<=a&&c>=l)this[s]+=n;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return US(Pf,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return zj(Pf,this)||US(Pf,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),zj(Pf,this)}}function vqe(t,e){wqe(t,e),e.add(t)}function wqe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zS(t,e,r){return(e=yqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yqe(t){var e=Cqe(t,"string");return typeof e=="symbol"?e:e+""}function Cqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Af(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ic=new WeakSet;class J_{constructor(e){vqe(this,Ic),zS(this,"plugin",void 0),zS(this,"mergedCells",[]),zS(this,"mergedCellsMatrix",new Map),zS(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:n}=e;return Jt`The merged cell declared at [${r}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(r))!==null&&n!==void 0?n:!1}getByRange(e){const{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let l=0;l<o;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:f,colspan:d}=u;if(c>=r&&c+f-1<=i&&h>=n&&h+d-1<=s){a=u;break}}return a}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let c=o;c<o+a;c++)r.add(`r${u},c${c}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=s;h<s+l;h++){for(let f=o;f<o+a;f++){const d=`r${h},c${f}`;if(r.has(d)){Ut(J_.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(d)}if(c)break}return c||r.add(...u),!c})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=n;l<=s;l++)for(let u=i;u<=o;u++){const c=this.get(l,u);c&&(r||!r&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new Cl(n,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,i),u=r?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Af(Ic,this,Gj).call(this,a),a):(u&&Ut(J_.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,r){const n=this.get(e,r),i=n?this.mergedCells.indexOf(n):-1;return n&&i!==-1?(this.mergedCells.splice(i,1),Af(Ic,this,Sqe).call(this,n),n):!1}clear(){Z(this.mergedCells,e=>{let{row:r,col:n,rowspan:i,colspan:s}=e;je(r,r+i,o=>{je(n,n+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);if(!n)return!1;const{row:i,col:s,rowspan:o,colspan:a}=n,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ot(u,i,i+o-1),f=Ot(c,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(f,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,r){const n=Af(Ic,this,GS).call(this,e,"col",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getEndMostColumnIndex(e,r){const n=Af(Ic,this,GS).call(this,e,"col",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}getTopMostRowIndex(e,r){const n=Af(Ic,this,GS).call(this,e,"row",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getBottomMostRowIndex(e,r){const n=Af(Ic,this,GS).call(this,e,"row",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,r),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{Af(Ic,this,Gj).call(this,o)})}}function GS(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,i=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=i.row;r===1?o<=s.row:o>=s.row;o+=r)for(let a=i.col;r===1?a<=s.col:a>=s.col;a+=r){const l=e==="row"?o:a,u=this.get(o,a);let c=l;u&&(c=r===1?u[e]+u[`${e}span`]-1:u[e]),n.has(l)||n.set(l,new Set),n.get(l).add(c)}return Array.from(new Set(Array.from(n.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function Gj(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function Sqe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function QA(t,e,r){return(e=xqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xqe(t){var e=bqe(t,"string");return typeof e=="symbol"?e:e+""}function bqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _qe{constructor(e){QA(this,"plugin",void 0),QA(this,"mergedCellsCollection",void 0),QA(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),o=this.getAutofillSize(e,r,n),[a,l,u,c]=e,f=["up","down"].indexOf(n)>-1?u-a+1:c-l+1,d=Math.floor(o/f)*f,g=o-d,m=this.getFarthestCollection(e,r,n,i);if(m){if(n==="down"){const p=m.row+m.rowspan-a-g;s[2]+p>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?p:0}else if(n==="right"){const p=m.col+m.colspan-l-g;s[3]+p>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?p:0}else if(n==="up"){const p=u-g-m.row+1;s[0]+p<0?s[0]+=g:s[0]-=g?p:0}else if(n==="left"){const p=c-g-m.col+1;s[1]+p<0?s[1]+=g:s[1]-=g?p:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:f}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),In(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,o,a]=e,[l,u,c,h]=r;switch(n){case"up":return i-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,r,n){const[i,s,o,a]=e,[l,u,c,h]=r;switch(n){case"up":return[l,u,i-1,a];case"down":{const f=this.mergedCellsCollection.get(c,a),d=f?f.rowspan-1:0;return[o+1,s,c+d,a]}case"left":return[l,u,o,s-1];case"right":{const f=this.mergedCellsCollection.get(c,a),d=f?f.colspan-1:0;return[i,a+d,c,h]}default:return null}}getFarthestCollection(e,r,n,i){const[s,o,a,l]=e,u=["up","down"].indexOf(n)>-1,c=u?a:l,h=u?s:o,f=this.getAutofillSize(e,r,n),d=u?a-s+1:l-o+1,g=Math.floor(f/d)*d,m=f-g;let p=null,w=null,v=null;switch(n){case"up":p="includesVertically",v=c-m+1;break;case"left":p="includesHorizontally",v=c-m+1;break;case"down":p="includesVertically",v=h+m-1;break;case"right":p="includesHorizontally",v=h+m-1;break}return Z(i,y=>{y[p](v)&&y.isFarther(w,n)&&(w=y)}),w}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,c)=>{switch(i){case"up":return u.row-c>=r.from.row;case"down":return u.row+u.rowspan-1+c<=r.to.row;case"left":return u.col-c>=r.from.column;case"right":return u.col+u.colspan-1+c<=r.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<n.length;u+=1){if(a=n[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0);break}u===n.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return Z(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const d=this.mergedCellsCollection.getWithinRange(h,!1);return d.length===0?!0:n==="up"||n==="down"?!d.every(g=>{let{colspan:m}=g;return m===h.getWidth()}):!d.every(g=>{let{rowspan:m}=g;return m===h.getHeight()})}}function ZA(t,e,r){return(e=Eqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eqe(t){var e=Rqe(t,"string");return typeof e=="symbol"?e:e+""}function Rqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tqe{constructor(e){ZA(this,"plugin",void 0),ZA(this,"hot",void 0),ZA(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const c=this.plugin.mergedCellsCollection.get(e,r);if(!c)return;const h=c.getLastRow(),f=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let o=0;o<r.length;o+=1)s[o]=r[o].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function kqe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(bH)}return this.getTranslatedPhrase(xH)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?Cl.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Cw(t,e,r){return(e=Pqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pqe(t){var e=Aqe(t,"string");return typeof e=="symbol"?e:e+""}function Aqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yj{constructor(e){Cw(this,"data",void 0),Cw(this,"next",null),Cw(this,"prev",null),this.data=e}}class YS{constructor(){Cw(this,"first",null),Cw(this,"last",null)}push(e){const r=new Yj(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.last;this.last=r,r.prev=n,n.next=r}return r}unshift(e){const r=new Yj(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.first;this.first=r,r.next=n,n.prev=r}}inorder(e){let r=this.first;for(;r;){const n=e(r);if(r===this.last||n===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,n,i;for(;r;){if(r.data===e)return n=r.next,i=r.prev,n&&(n.prev=i),i&&(i.next=n),r===this.first&&(this.first=n),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,i){i&&(e(i,i.next),i.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,n;for(;e;)n=e.next,e.next=r,r.prev=e,r=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=r,this.last=n}}function Iqe(t,e){iee(t,e),e.add(t)}function If(t,e,r){iee(t,e),e.set(t,r)}function iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(Q_(t,e))}function Fs(t,e,r){return t.set(Q_(t,e),r),r}function Q_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var al=new WeakMap,ll=new WeakMap,ul=new WeakMap,cl=new WeakMap,x2=new WeakMap,KS=new WeakMap,XS=new WeakMap,eI=new WeakSet;class Oqe{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:n,columnIndexMapper:i}=e;Iqe(this,eI),If(this,al,new YS),If(this,ll,new YS),If(this,ul,null),If(this,cl,null),If(this,x2,null),If(this,KS,null),If(this,XS,null),Fs(x2,this,r),Fs(KS,this,n),Fs(XS,this,i)}getCurrentVerticalNode(){return qt(cl,this).data}getFirstVerticalNode(){return qt(ll,this).first.data}getNextVerticalNode(){return qt(cl,this).next.data}getPrevVerticalNode(){return qt(cl,this).prev.data}getCurrentHorizontalNode(){return qt(ul,this).data}getFirstHorizontalNode(){return qt(al,this).first.data}getNextHorizontalNode(){return qt(ul,this).next.data}getPrevHorizontalNode(){return qt(ul,this).prev.data}setPrevNodeAsActive(){Fs(cl,this,qt(cl,this).prev),Fs(ul,this,qt(ul,this).prev)}setNextNodeAsActive(){Fs(cl,this,qt(cl,this).next),Fs(ul,this,qt(ul,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),n=e.getBottomEndCorner(),i=new WeakSet;Fs(al,this,new YS);for(let o=r.row;o<=n.row;o++)if(!qt(KS,this).isHidden(o))for(let a=r.col;a<=n.col;a++){if(qt(XS,this).isHidden(a))continue;const l=Q_(eI,this,Kj).call(this,e,qt(al,this),i,o,a);l&&Fs(ul,this,l)}qt(al,this).first&&(qt(al,this).first.prev=qt(al,this).last,qt(al,this).last.next=qt(al,this).first);const s=new WeakSet;Fs(ll,this,new YS);for(let o=r.col;o<=n.col;o++)if(!qt(XS,this).isHidden(o))for(let a=r.row;a<=n.row;a++){if(qt(KS,this).isHidden(a))continue;const l=Q_(eI,this,Kj).call(this,e,qt(ll,this),s,a,o);l&&Fs(cl,this,l)}qt(ll,this).first&&(qt(ll,this).first.prev=qt(ll,this).last,qt(ll,this).last.next=qt(ll,this).first)}setActiveNode(e,r){return qt(al,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return Fs(ul,this,n),!1}),qt(ll,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return Fs(cl,this,n),!1}),this}}function Kj(t,e,r,n,i){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=qt(x2,this).call(this,n,i);if(l&&r.has(l))return null;const u={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(l){if(r.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return n===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function see(t,e,r){const{rowIndexMapper:n,stylesHandler:i}=t,s=i.getDefaultRowHeight();let o=0;for(let l=e;l<e+r;l++)if(!n.isHidden(l)){var a;o+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:s,l===0&&!i.isClassicTheme()&&(o+=1)}return o}function Mqe(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:n}=e,i=new Map;function s(){}function o(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!yt(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),vy()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:f,colspan:d,rowspan:g}=c,[m,p]=t.translateMergedCellToRenderable(h,g,f,d),w=t.getSetting("virtualized");if(vy()&&f===0&&!e.getSettings().rowHeaders){const O=see(e,h,g);i.set(l,O/g)}const v=r.getRenderableFromVisualIndex(l),y=n.getRenderableFromVisualIndex(u),b=m-v+1,T=p-y+1;let E=r.getNearestNotHiddenIndex(h,1),x=n.getNearestNotHiddenIndex(f,1);if(w){const O=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(O)||(E=Math.max(E,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(O)||(x=Math.max(x,e.getFirstRenderedVisibleColumn()))}const P=Math.min(g,b),A=Math.min(d,T);E===l&&x===u?(a.setAttribute("rowspan",P),a.setAttribute("colspan",A)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function Nqe(t,e){oee(t,e),e.add(t)}function qS(t,e,r){oee(t,e),e.set(t,r)}function oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tI(t,e,r){return(e=Dqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dqe(t){var e=Fqe(t,"string");return typeof e=="symbol"?e:e+""}function Fqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function My(t,e,r){return t.set(Qt(t,e),r),r}function pr(t,e){return t.get(Qt(t,e))}function Qt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeMergeCells");Fe.getSingleton().register("afterMergeCells");Fe.getSingleton().register("beforeUnmergeCells");Fe.getSingleton().register("afterUnmergeCells");const b2="mergeCells",Hqe=150,Xj=b2;var Fo=new WeakMap,Ho=new WeakMap,Tl=new WeakMap,qj=new WeakMap,nr=new WeakSet;class Lqe extends zt{constructor(){super(...arguments),Nqe(this,nr),tI(this,"mergedCellsCollection",null),tI(this,"autofillCalculations",null),tI(this,"selectionCalculations",null),qS(this,Fo,null),qS(this,Ho,{row:0,col:0}),qS(this,Tl,new Oqe({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),qS(this,qj,Mqe(this))}static get PLUGIN_KEY(){return b2}static get PLUGIN_PRIORITY(){return Hqe}static get DEFAULT_SETTINGS(){return{[_Q]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[b2]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new J_(this),this.autofillCalculations=new _qe(this),this.selectionCalculations=new Tqe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,$qe).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Vqe).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Wqe).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,jqe).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Uqe).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Qj).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Qj).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Gqe).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Yqe).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Kqe).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Jj).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Jj).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Bqe).call(e,...n)}),this.addHook("afterRenderer",function(){return pr(qj,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,zqe).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Xqe).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,qqe).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Jqe).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Qqe).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,Zqe).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,eJe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,tJe).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,rJe).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,nJe).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,iJe).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,sJe).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,oJe).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,aJe).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Qt(nr,e,lJe).call(e,...n)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!vq())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let o=i+1;o<i+s;o++)r.push(o)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=w_(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{var i;n.style.background=(i=w_(n,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Cl.containsNegativeValues(e)?(Ut(Cl.NEGATIVE_VALUES_WARNING(e)),!1):Cl.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ut(Cl.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Cl.isSingleCell(e)?(Ut(Cl.IS_SINGLE_CELL(e)),!1):Cl.containsZeroSpan(e)?(Ut(Cl.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];r.forEach(i=>{const{row:s,col:o,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(s,o),c=this.hot._createCellCoords(s+a-1,o+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let f=s;f<s+a;f++)for(let d=o;d<o+l;d++)(f!==s||d!==o)&&n.push([f,d,null])}),n.length!==0&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),je(0,o.rowspan-1,c=>{je(0,o.colspan-1,h=>{let f=null;a[c]||(a[c]=[]),c===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=f})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(n?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),l):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),Z(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),je(0,i.rowspan-1,s=>{je(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const{from:r,to:n}=e.clone().normalize(),i=this.mergedCellsCollection.get(r.row,r.col);i.row===r.row&&i.col===r.col&&i.row+i.rowspan-1===n.row&&i.col+i.colspan-1===n.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:Xj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Xj)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(yt(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(yt(o)){const a=o.row+o.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(yt(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(yt(o)){const a=o.col+o.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;r===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?l=o.getNearestNotHiddenIndex(n,1):l=o.getNearestNotHiddenIndex(n+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=n>=0?o.getRenderableFromVisualIndex(l):n;return[u,c]}}function $qe(){this.generateFromSettings(),this.hot.render()}function Bqe(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(n.row===e[s].row&&n.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function Vqe(t){pr(Ho,this).row=t.row,pr(Ho,this).col=t.col}function Wqe(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;pr(Fo,this)&&(i.getRenderableFromVisualIndex(pr(Fo,this).row)!==null&&(r.row=pr(Fo,this).row),n.getRenderableFromVisualIndex(pr(Fo,this).col)!==null&&(r.col=pr(Fo,this).col),My(Fo,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const c=r.col>=o&&r.col<=a?o-1:a,h=n.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,r.col)-1,1)}else if(t.col>0){const c=r.col>=o&&r.col<=a?a+1:o,h=n.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,h)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(t.row<0){const c=r.row>=l&&r.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,r.row)-1,1)}else if(t.row>0){const c=r.row>=l&&r.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,h)-1,1)}}function jqe(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{r.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(a=r.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,n.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(a=r.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(a=r.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,n.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(a=r.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,l)-1,1))}}function Uqe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){My(Fo,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);My(Fo,this,e.clone()),r&&e.assign(r)}function Jj(t,e,r,n){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:s,col:o,colspan:a,rowspan:l}=i,u=s,c=o,h=s+l-1,f=o+a-1;if(n==="render"&&this.getSetting("virtualized")){const d=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(d)?0:this.hot.getFirstRenderedVisibleRow(),m=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(d)?0:this.hot.getFirstRenderedVisibleColumn();return[Ot(g,u,h),Ot(m,c,f),Ot(this.hot.getLastRenderedVisibleRow(),u,h),Ot(this.hot.getLastRenderedVisibleColumn(),c,f)]}return[u,c,h,f]}function zqe(t){t.items.push({name:"---------"},kqe(this))}function Qj(){My(Fo,this,null)}function Gqe(){if(pr(Fo,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),n=pr(Fo,this).clone().normalize();pr(Tl,this).setActiveNode(n.row,n.col),pr(Ho,this).row>0||pr(Ho,this).col>0?pr(Tl,this).setPrevNodeAsActive():(r==="E-W"&&pr(Ho,this).col<0||e==="S-N"&&pr(Ho,this).row<0)&&pr(Tl,this).setNextNodeAsActive()}function Yqe(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let s=null,o=null;if(pr(Ho,this).col<0){const{rowEnd:a,colEnd:l}=pr(Tl,this).getPrevHorizontalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(pr(Ho,this).col>0){const{rowStart:a,colStart:l}=pr(Tl,this).getNextHorizontalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(pr(Ho,this).row<0){const{rowEnd:a,colEnd:l}=pr(Tl,this).getPrevVerticalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(pr(Ho,this).row>0){const{rowStart:a,colStart:l}=pr(Tl,this).getNextVerticalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):r.highlight.assign(a),u.clear(),u.add(a).commit()}pr(Tl,this).setActiveNode(t,e),My(Ho,this,{row:0,col:0})}function Kqe(){this.hot.getSelectedRangeLast().isHeader()||pr(Tl,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function Xqe(t,e,r){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function qqe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Jqe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Qqe(t,e){const r=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,r))return e;const n=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(n,n,i),o=this.mergedCellsCollection.getWithinRange(s);return o.length===0?t:this.autofillCalculations.snapDragArea(e,t,r,o)}function Zqe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function eJe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function tJe(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function rJe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function nJe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function iJe(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(r);Z(n,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function sJe(t,e,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,n)}function oJe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function aJe(t,e,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function lJe(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let n,i;if(r==="master")n=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const f=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(f.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(f.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return t;const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((f,d)=>{let{rowspan:g}=d;return Math.max(f,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(f=>{let{rowspan:d}=f,g=0;r==="top"||r==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=d-h,t=Math.max(t??0,see(this.hot,e,g))}),t}function uJe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function o(a){const l=t[a],u=e[a],c=i[a],h=s[a],f=u.multiColumnSorting,g=(f.compareFunctionFactory?f.compareFunctionFactory:DQ(u.type))(l,u,f)(c,h);if(g===Dl){const m=a+1;if(typeof e[m]<"u")return o(m)}return g}(0)}}const aee="sort";function cJe(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${aee}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function hJe(t){const e=t.className.split(" "),r=new RegExp(`^${aee}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}function fJe(t,e,r){return(e=dJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dJe(t){var e=gJe(t,"string");return typeof e=="symbol"?e:e+""}function gJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Z_="multiColumnSorting",mJe=170,Zj=Z_;NQ(Z_,uJe);class pJe extends UQ{constructor(){super(...arguments),fJe(this,"pluginKey",Z_)}static get PLUGIN_KEY(){return Z_}static get PLUGIN_PRIORITY(){return mJe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,N_)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:Uh,position:"before",group:Zj})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Zj)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),qe(e,hJe(e)),this.enabled!==!1&&Se(e,cJe(...n))}onAfterOnCellMouseDown(e,r){ZL(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,N_))):this.sort(this.getColumnNextConfig(r.col)))}}function eU(t,e,r){return(e=vJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vJe(t){var e=wJe(t,"string");return typeof e=="symbol"?e:e+""}function wJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yJe="multipleSelectionHandles",CJe=160;class SJe extends zt{constructor(){super(...arguments),eU(this,"dragged",[]),eU(this,"lastSetCell",null)}static get PLUGIN_KEY(){return yJe}static get PLUGIN_PRIORITY(){return CJe}isEnabled(){return Al()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(et(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(et(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(et(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(et(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const f=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(o=e.hot.getCoords(f),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(l.row,r.col)}:c={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?c={start:r,end:l}:c.end=r;break;case"NW-SE":s==="top"?c={start:r,end:a}:c.end=r;break;case"SE-NW":s==="top"?c={start:r,end:o}:c.end=r;break;case"SW-NE":s==="top"?c={start:r,end:u}:c.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(l.row,r.col)}:c={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)}:c={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(r.row,u.col),end:this.hot._createCellCoords(o.row,r.col)}:s==="top"&&(c={start:l,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=r);break;case"SE-NW":s==="top"?c.end=r:c={start:r,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function _2(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function lee(){return{label:"",isPlaceholder:!0}}function xJe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;Z(t,i=>{const s=[];let o=0;r.push(s),Z(i,a=>{const l=_2();if(yt(a)){const{label:c,colspan:h,headerClassName:f}=a;l.label=Fr(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof f=="string"&&(l.headerClassNames=[...f.split(" ")])}else l.label=Fr(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(lee());return!u})});const n=Math.max(...Pt(r,i=>i.length));return Z(r,i=>{if(i.length<n){const s=Pt(new Array(n-i.length),()=>_2());i.splice(i.length,0,...s)}}),r}function rI(t,e,r){bJe(t,e),e.set(t,r)}function bJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(t,e){return t.get(uee(t,e))}function lv(t,e,r){return t.set(uee(t,e),r),r}function uee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tU=["label","collapsible"];var su=new WeakMap,Of=new WeakMap,nI=new WeakMap;class _Je{constructor(){rI(this,su,[]),rI(this,Of,0),rI(this,nI,1/0)}setColumnsLimit(e){lv(nI,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];lv(su,this,xJe(e,ua(nI,this))),lv(Of,this,ua(su,this).length)}getData(){return ua(su,this)}mergeWith(e){Z(e,r=>{let{row:n,col:i,...s}=r;const o=this.getHeaderSettings(n,i);o!==null&&In(o,s,tU)})}map(e){Z(ua(su,this),r=>{Z(r,n=>{const i=e({...n});yt(i)&&In(n,i,tU)})})}getHeaderSettings(e,r){var n;if(e>=ua(Of,this)||e<0)return null;const i=ua(su,this)[e];return Array.isArray(i)===!1||r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=ua(Of,this)||e<0)return i;const s=ua(su,this)[e];let o=0;for(let a=r;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return ua(Of,this)}getColumnsCount(){return ua(Of,this)>0?ua(su,this)[0].length:0}clear(){lv(su,this,[]),lv(Of,this,0)}}function iI(t,e,r){return(e=EJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EJe(t){var e=RJe(t,"string");return typeof e=="symbol"?e:e+""}function RJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cee="DF-pre-order";function hee(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=hee.call(this.childs[n],t,e)}return r}const TJe="DF-post-order";function fee(t,e){for(let r=0;r<this.childs.length;r++)if(fee.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const dee="BF";function kJe(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const PJe=dee,rU=new Map([[cee,hee],[TJe,fee],[dee,kJe]]);class eE{constructor(e){iI(this,"data",{}),iI(this,"parent",null),iI(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new eE({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:PJe;if(!rU.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);rU.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function sI(t,e,r){AJe(t,e),e.set(t,r)}function AJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(t,e){return t.get(gee(t,e))}function IJe(t,e,r){return t.set(gee(t,e),r),r}function gee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Kg=new WeakMap,Mf=new WeakMap,Xg=new WeakMap;class OJe{constructor(e){sI(this,Kg,new Map),sI(this,Mf,new Map),sI(this,Xg,null),IJe(Xg,this,e)}getRoots(){return Array.from(Bi(Kg,this).values())}getRootByColumn(e){let r;return Bi(Mf,this).has(e)&&(r=Bi(Kg,this).get(Bi(Mf,this).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-Bi(Mf,this).get(r);let s=0,o;return n.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=r===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Bi(Mf,this).clear(),Z(Bi(Kg,this),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)Bi(Mf,this).set(i,e);e+=n})}buildTree(){this.clear();const e=Bi(Xg,this).getColumnsCount();let r=0;for(;r<e;){const n=Bi(Xg,this).getHeaderSettings(0,r),i=new eE;Bi(Kg,this).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Bi(Xg,this).getHeadersSettings(n,r,i);n+=1,Z(s,o=>{const a={...o,headerLevel:n-1,columnIndex:r};let l;n===1?(e.data=a,l=e):(l=new eE(a),e.addChild(l)),n<Bi(Xg,this).getLayersCount()&&this.buildLeaves(l,r,n,o.origColspan),r+=o.origColspan})}clear(){Bi(Kg,this).clear(),Bi(Mf,this).clear()}}function mee(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function tE(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function rE(t){return tE(t,"origColspan")===t.data.origColspan}function g$(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(rE(t))return g$(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let o=0;if(i.length>0)Z(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,mee(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):rE(a)&&(l.isCollapsed=tE(a,"isCollapsed"))}),{rollbackModification:()=>m$(t),affectedColumns:Array.from(s),colspanCompensation:o}}function m$(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(rE(t))return m$(n[0]);r.isCollapsed=!0;const s=n.slice(1),o=new Set;if(s.length>0)Z(s,l=>{mee(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=r;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=r.colspan-((e=tE(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):rE(l)&&(u.isCollapsed=tE(l,"isCollapsed"))}),{rollbackModification:()=>g$(t),affectedColumns:Array.from(o),colspanCompensation:a}}function MJe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Jt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function NJe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Jt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const nU=new Map([["collapse",m$],["expand",g$],["hide-column",MJe],["show-column",NJe]]);function DJe(t,e,r){if(!nU.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return nU.get(t)(e,r)}function JS(t){const e=[];return Z(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=HJe(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(lee());else{const d=FJe(i);d.isRoot=!0,u.push(d),c=!0}})}),e}function FJe(t){const{crossHiddenColumns:e,...r}=_2(t);return r}function HJe(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function oI(t,e,r){LJe(t,e),e.set(t,r)}function LJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uv(t,e,r){return t.set(pee(t,e),r),r}function Lr(t,e){return t.get(pee(t,e))}function pee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hl=new WeakMap,hs=new WeakMap,Nf=new WeakMap;class $Je{constructor(){oI(this,hl,new _Je),oI(this,hs,new OJe(Lr(hl,this))),oI(this,Nf,[[]])}setState(e){Lr(hl,this).setData(e);let r=!1;try{Lr(hs,this).buildTree()}catch{Lr(hs,this).clear(),Lr(hl,this).clear(),r=!0}return uv(Nf,this,JS(Lr(hs,this).getRoots())),r}setColumnsLimit(e){Lr(hl,this).setColumnsLimit(e)}mergeStateWith(e){const r=Pt(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Lr(hl,this).mergeWith(r),Lr(hs,this).buildTree(),uv(Nf,this,JS(Lr(hs,this).getRoots()))}mapState(e){Lr(hl,this).map(e),Lr(hs,this).buildTree(),uv(Nf,this,JS(Lr(hs,this).getRoots()))}mapNodes(e){return Ms(Lr(hs,this).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=Lr(hs,this).getNode(r,n);let s;return i&&(s=DJe(e,i,n),uv(Nf,this,JS(Lr(hs,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=Lr(Nf,this)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){const n=this.getHeaderTreeNode(e,r);return n?{...n.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=Lr(hs,this).getNode(e,r);return n||null}findTopMostEntireHeaderLevel(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const n=r-e+1;let i=!1,s=null;for(let o=e;o<=r;o++){const a=Lr(hs,this).getRootByColumn(o);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:f}=l.data;f||h<=n&&u>=e&&u+h-1<=r&&(s===null||c<s)&&(s=c)},cee)}return i&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,r){var n;const{isRoot:i,origColspan:s}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(i)return r+s-1;let o=r+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return Lr(hl,this).getLayersCount()}getColumnsCount(){return Lr(hl,this).getColumnsCount()}clear(){uv(Nf,this,[]),Lr(hl,this).clear(),Lr(hs,this).clear()}}function cv(t,e,r){return(e=BJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BJe(t){var e=VJe(t,"string");return typeof e=="symbol"?e:e+""}function VJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WJe{constructor(e,r){cv(this,"hot",void 0),cv(this,"nestedHeaderSettingsGetter",void 0),cv(this,"layersCount",0),cv(this,"container",void 0),cv(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(let i=0;i<n;i++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=r.createElement("tr");for(let c=0;c<a;c++){let h=n.getVisualFromRenderableIndex(c);h===null&&(h=c);const f=r.createElement("th"),d=this.nestedHeaderSettingsGetter(l,h);if(d&&(!d.isPlaceholder||d.isHidden)){let g=d.label;o&&(g+='<button class="changeType"></button>'),Gp(f,g),f.colSpan=d.colspan,u.appendChild(f)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function jJe(t,e){vee(t,e),e.add(t)}function iU(t,e,r){return(e=UJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UJe(t){var e=zJe(t,"string");return typeof e=="symbol"?e:e+""}function zJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hv(t,e,r){vee(t,e),e.set(t,r)}function vee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iu(t,e,r){return t.set($r(t,e),r),r}function Rt(t,e){return t.get($r(t,e))}function $r(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const sU="nestedHeaders",GJe=280;var er=new WeakMap,Oc=new WeakMap,Sw=new WeakMap,iT=new WeakMap,nE=new WeakMap,Qr=new WeakSet;class YJe extends zt{constructor(){super(...arguments),jJe(this,Qr),hv(this,er,new $Je),hv(this,Oc,null),hv(this,Sw,null),hv(this,iT,!1),hv(this,nE,null),iU(this,"ghostTable",new WJe(this.hot,(e,r)=>this.getHeaderSettings(e,r))),iU(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return sU}static get PLUGIN_PRIORITY(){return GJe}isEnabled(){return!!this.hot.getSettings()[sU]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&Ut(Jt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>$r(Qr,this,uQe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,cQe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,JJe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,QJe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,ZJe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,eQe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,tQe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,rQe).call(e,...i)}),this.addHook("afterSelection",()=>$r(Qr,this,QS).call(this)),this.addHook("afterSelectionFocusSet",()=>$r(Qr,this,QS).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,KJe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",n=>$r(Qr,this,iQe).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,oQe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,aQe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,XJe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,qJe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,nQe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,sQe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,lQe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>$r(Qr,this,QS).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>$r(Qr,this,QS).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Rt(er,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Rt(er,this).setState(e)),this.detectedOverlappedHeaders&&Ut(Jt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";Rt(er,this).triggerColumnModification(i,n)}),!Rt(Oc,this)&&this.enabled&&Iu(Oc,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:o}=n;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Rt(er,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Rt(er,this).clear(),Rt(Oc,this).unsubscribe(),Iu(Oc,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Rt(er,this)}getLayersCount(){return Rt(er,this).getLayersCount()}getHeaderSettings(e,r){return Rt(er,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const a=n.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),qe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),qe(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),qe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),qe(s,"hiddenHeader"),qe(s,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:f,headerClassNames:d}=(o=Rt(er,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{};if(f||h)Se(s,"hiddenHeader");else if(c>1){var g,m,p;const{wtOverlays:w}=l._wt,v=(g=w.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),y=(m=w.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s);((p=w.topOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s))&&u<n&&Se(s,"hiddenHeaderText");const T=v||y?Math.min(c,n-i):c;T>1&&s.setAttribute("colspan",T)}if(this.hot.view.appendColHeader(u,s,function(){return r.getColumnHeaderValue(...arguments)},e),!f&&!h){const w=s.querySelector("div.relative");w&&d&&d.length>0&&(qe(w,this.hot.getColumnMeta(u).headerClassName),Se(w,d))}}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=Rt(er,this).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}destroy(){Iu(er,this,null),Rt(Oc,this)!==null&&(Rt(Oc,this).unsubscribe(),Iu(Oc,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Rt(er,this).getHeaderTreeNodeData(e.row,e.col)}}function QS(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const i=Rt(er,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function KJe(t,e){var r;const n=this.hot.getSelectedRangeLast();if(!n)return t;const{highlight:i}=n,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?i.row:(r=Rt(nE,this))===null||r===void 0?void 0:r.row,l=o?t:i.col,u=a<0&&l>=0;if(Iu(nE,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),f=h-c+1,d=Rt(er,this).findLeftMostColumnIndex(a,l),g=Rt(er,this).findRightMostColumnIndex(a,l),m=g-d+1;if(d<c&&g>h)return d;if(o){let p=null;return d>=c&&g>h?m>f?(e.value="start",p=d):(e.value="end",p=g):d<c&&g<=h&&(m>f?(e.value="end",p=g):(e.value="start",p=d)),p}return d<=c?d:g}function XJe(t,e,r){const n=Rt(er,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:o}=r,{isRoot:a,colspan:l}=Rt(er,this).getHeaderSettings(e,t);if(s===jF){if(!a)return n.columnIndex}else if(s===aJ&&(l>o-i||!a))return null;return t}function qJe(t,e,r){let{columnHeadersCount:n}=r;if(n!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],c=l-o+1,h=a-u+1;if(o>=0||h===1)break;for(let f=a;f<=u;f++)for(let d=o;d<=l;d++){var i;const g=c+d,m=f-a;if(m===0)continue;((i=Rt(er,this).getHeaderTreeNodeData(d,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][m]="")}}}function JJe(t,e,r,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function QJe(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;Iu(Sw,this,e.clone()),Iu(iT,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=r,l=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(AF(t)||Md(t)&&l||GNe(t))&&s.push(o,o+a-1,e.row),n.selectColumns(...s)}function ZJe(t,e,r,n){if(!this.hot.view.isMouseDown()||n.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;n.column=!0,n.cell=!0;const h=[],f=Ot(e.row,-1/0,-1);e.col<c.col?h.push(u.col,s,f):e.col>c.col?h.push(l.col,s+o-1,f):h.push(s,s+o-1,f),this.hot.selection.selectColumns(...h)}function eQe(){Iu(iT,this,!1)}function tQe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Rt(iT,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Rt(er,this).getHeaderTreeNodeData(Rt(Sw,this).row,Rt(Sw,this).col);if(e.setHighlight(Rt(Sw,this)),s>e.getWidth()||i<r||i+s-1>n){const o=Rt(er,this).findTopMostEntireHeaderLevel(Ot(r,i,i+s-1),Ot(n,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function rQe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const i=Rt(er,this).findLeftMostColumnIndex(r.row,r.col),s=Rt(er,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function nQe(t,e,r){const n=t.row,i=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});Iu(nE,this,r.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function iQe(t){if(Rt(er,this).getLayersCount()>0){t.length=0;for(let e=0;e<Rt(er,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function sQe(t){const e=Rt(er,this).getLayersCount();let r=t.startColumn,n=!!e;for(let i=0;i<e;i++){const s=Rt(er,this).findLeftMostColumnIndex(i,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(n=!1),qi(o)&&o<t.startColumn){r=o;break}}t.startColumn=n?Rt(er,this).getHeaderTreeNodeData(0,r).columnIndex:r}function oQe(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function aQe(t,e,r){var n;const{label:i}=(n=Rt(er,this).getHeaderTreeNodeData(r,e))!==null&&n!==void 0?n:{label:""};return i}function lQe(t,e){if(t<0)return this.hot.getCell(t,Rt(er,this).findLeftMostColumnIndex(t,e),!0)}function uQe(){this.updatePlugin()}function cQe(t,e){e||this.updatePlugin()}function fv(t,e,r){return(e=hQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hQe(t){var e=fQe(t,"string");return typeof e=="symbol"?e:e+""}function fQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dQe{constructor(e,r){fv(this,"hot",void 0),fv(this,"data",null),fv(this,"plugin",void 0),fv(this,"parentReference",new WeakMap),fv(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},je(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&Z(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,o=r;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),n!=null&&o===n?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&Z(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,n,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ct(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(Z(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const a=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(je(e[0],e[2],f=>{const d=this.translateTrimmedRow(f);i.push(this.getDataObject(d))}),je(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),o=this.countChildren(n),a=this.getRowIndexWithinParent(n),l=this.getRowParent(n),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,n),a!=null){const f=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,f,this.plugin.pluginName),u){h=c+this.countChildren(u);const d=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),u.__children.push(n)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];Z(n,s=>{i.push(this.getDataObject(s))}),Z(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(o,r,...n):s.__children.splice(o,r):n?this.data.splice(o,r,...n):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=r;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>r;let c=s?this.getRowParent(r-1):this.getRowParent(r);c==null&&(c=this.getRowParent(r-1)),c==null&&(c=this.getDataObject(r-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(r),c.__children=[]);const h=s||n||i?c.__children.length:this.getRowIndexWithinParent(r),f=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(o),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function oU(t,e,r){return(e=gQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gQe(t){var e=mQe(t,"string");return typeof e=="symbol"?e:e+""}function mQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p${constructor(e,r){oU(this,"hot",void 0),oU(this,"plugin",void 0),this.hot=r,this.plugin=e}}class xl extends p${static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(n),s=this.dataManager.getDataObject(n),o=r.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(Z(l,c=>{c&&o.removeChild(c)}),Se(r,xl.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);o.innerHTML="",je(0,i-1,()=>{const f=c.createElement("SPAN");Se(f,xl.CSS_CLASSES.emptyIndicator),o.appendChild(f)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const c=this.hot.rootDocument.createElement("DIV");u&&Ze(c,[ng()]),Se(r,xl.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Se(c,`${xl.CSS_CLASSES.button} ${xl.CSS_CLASSES.expandButton}`),u&&Ze(r,[Wo(!1)])):(Se(c,`${xl.CSS_CLASSES.button} ${xl.CSS_CLASSES.collapseButton}`),u&&Ze(r,[Wo(!0)])),o.appendChild(c)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);let n=11;this.hot.stylesHandler.isClassicTheme()||(n=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,n+10*r+25),this.hot.render()}}class pQe extends p${constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),Z(n.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(n.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{je(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&Z(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),n&&this.trimRows(a),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];Z(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return Z(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);Z(i.__children,s=>{const o=this.dataManager.getRowIndex(s);r.push(o),this.collapseChildRows(o,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return Z(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);Z(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);r.push(o),this.expandChildRows(o,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&Z(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),n&&this.untrimRows(a),r&&this.renderAndAdjust(),a}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];Z(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];Z(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];Z(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{Z(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{Z(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&Z(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);et(e.target,xl.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),ja(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function vQe(t,e,r){wQe(t,e),e.set(t,r)}function wQe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yQe(t,e,r){return(e=CQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CQe(t){var e=SQe(t,"string");return typeof e=="symbol"?e:e+""}function SQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xQe(t,e){return t.get(bQe(t,e))}function bQe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var aU=new WeakMap;class _Qe extends p${constructor(){super(...arguments),yQe(this,"dataManager",this.plugin.dataManager),vQe(this,aU,{row_above:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(WH)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(jH)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return je(0,e.items.length-1,n=>{if(n===0)return Z(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return je(0,e.items.length-1,r=>{const n=xQe(aU,this)[e.items[r].key];n!=null&&(e.items[r].callback=n)}),e}}function ZS(t,e,r){return(e=EQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EQe(t){var e=RQe(t,"string");return typeof e=="symbol"?e:e+""}function RQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TQe{constructor(e){ZS(this,"plugin",void 0),ZS(this,"hot",void 0),ZS(this,"dataManager",void 0),ZS(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=n===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let l=!0;const u=e.map(g=>{if(!l)return!1;const m=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(m,a),m}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),f=this.getTargetParent(o,a),d=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,d),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let o=!1;return Dr(i)&&(Ut(Jt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0;if(this.movedToCollapsed){let o=null;e[n-1]<r?o=this.dataManager.translateTrimmedRow(r-n):o=this.dataManager.translateTrimmedRow(r);const a=this.dataManager.getRowParent(o===null?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);this.hot.selectCells([[i,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}function kQe(t,e){wee(t,e),e.add(t)}function lU(t,e,r){wee(t,e),e.set(t,r)}function wee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aI(t,e,r){return(e=PQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PQe(t){var e=AQe(t,"string");return typeof e=="symbol"?e:e+""}function AQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ib(t,e){return t.get(Ln(t,e))}function iE(t,e,r){return t.set(Ln(t,e),r),r}function Ln(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const sE="nestedRows",IQe=300,uU=sE,OQe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var sT=new WeakMap,qg=new WeakMap,Gn=new WeakSet;class MQe extends zt{constructor(){super(...arguments),kQe(this,Gn),aI(this,"dataManager",null),aI(this,"headersUI",null),aI(this,"collapsedRowsMap",null),lU(this,sT,!1),lU(this,qg,!1)}static get PLUGIN_KEY(){return sE}static get PLUGIN_PRIORITY(){return IQe}isEnabled(){return!!this.hot.getSettings()[sE]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new b1),this.dataManager=new dQe(this,this.hot),this.collapsingUI=new pQe(this,this.hot),this.headersUI=new xl(this,this.hot),this.contextMenuUI=new _Qe(this,this.hot),this.rowMoveController=new TQe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,YQe).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,KQe).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,FQe).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,HQe).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,LQe).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,DQe).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,VQe).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,BQe).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,WQe).call(e,...n)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,jQe).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,UQe).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,zQe).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,$Qe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,GQe).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,NQe).call(e,...n)}),this.addHook("beforeLoadData",r=>Ln(Gn,this,cU).call(this,r)),this.addHook("beforeUpdateData",r=>Ln(Gn,this,cU).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:uU,relativeToGroup:Uh,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uU)}disableCoreAPIModifiers(){iE(qg,this,!0)}enableCoreAPIModifiers(){iE(qg,this,!1)}onModifyRowData(e){if(!ib(qg,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!ib(qg,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return ib(qg,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}destroy(){super.destroy()}}function NQe(t,e,r,n){return this.rowMoveController.onBeforeRowMove(t,e,r,n)}function DQe(t,e,r){this.collapsingUI.toggleState(t,e,r)}function FQe(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),iE(sT,this,!0),this.dataManager.getData().slice()}function HQe(t){return this.contextMenuUI.appendOptions(t)}function LQe(t,e){this.headersUI.appendLevelIndicators(t,e)}function $Qe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function BQe(t,e,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{iE(sT,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function VQe(t,e,r){const n=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));r.length=0,r.push(...n)}function WQe(){this.collapsingUI.collapsedRowsStash.stash()}function jQe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function UQe(){this.collapsingUI.collapsedRowsStash.stash()}function zQe(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function GQe(){this.dataManager.rewriteCache()}function YQe(){this.headersUI.updateRowHeaderWidth()}function KQe(t,e){ib(sT,this)&&(e.skipRender=!0)}function cU(t){if(!T4e(t)){IF(OQe),this.hot.getSettings()[sE]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function lI(t,e,r){return(e=XQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XQe(t){var e=qQe(t,"string");return typeof e=="symbol"?e:e+""}function qQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQe{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;lI(this,"rootWindow",void 0),lI(this,"prefix",void 0),lI(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Z(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function QQe(t,e,r){return(e=ZQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZQe(t){var e=eZe(t,"string");return typeof e=="symbol"?e:e+""}function eZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Fe.getSingleton().register("persistentStateSave");Fe.getSingleton().register("persistentStateLoad");Fe.getSingleton().register("persistentStateReset");const hU="persistentState",tZe=0;class rZe extends zt{constructor(){super(...arguments),QQe(this,"storage",void 0)}static get PLUGIN_KEY(){return hU}static get PLUGIN_PRIORITY(){return tZe}isEnabled(){return!!this.hot.getSettings()[hU]}enablePlugin(){this.enabled||(this.storage||(this.storage=new JQe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function nZe(t,e){iZe(t,e),e.add(t)}function iZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uI(t,e,r){return(e=sZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sZe(t){var e=oZe(t,"string");return typeof e=="symbol"?e:e+""}function oZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fU(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cI="search",aZe=190,lZe="htSearchResult",uZe=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},cZe=function(t,e,r){return Dr(t)||t===null||!t.toLocaleLowerCase||t.length===0||Dr(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var hI=new WeakSet;class hZe extends zt{constructor(){super(...arguments),nZe(this,hI),uI(this,"callback",uZe),uI(this,"queryMethod",cZe),uI(this,"searchResultClass",lZe)}static get PLUGIN_KEY(){return cI}static get PLUGIN_PRIORITY(){return aZe}isEnabled(){return this.hot.getSettings()[cI]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[cI];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fU(hI,e,dU).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fU(hI,e,dU).call(e,...i)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return je(0,i-1,l=>{je(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),f=h.search.callback||r,g=(h.search.queryMethod||n)(e,c,h);if(g){const m={row:l,col:u,data:c};o.push(m)}f&&f(a,l,u,c,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){yt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function dU(t,e,r,n,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function ex(t,e,r){return(e=fZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fZe(t){var e=dZe(t,"string");return typeof e=="symbol"?e:e+""}function dZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yee{constructor(e){ex(this,"viewportWidth",void 0),ex(this,"overwriteColumnWidthFn",void 0),ex(this,"baseWidths",new Map),ex(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class gZe extends yee{calculate(){const e=Array.from(this.baseWidths).reduce((h,f)=>{let[,d]=f;return h+d},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const n=this.viewportWidth/e,i=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,f)=>{const d=Math.round(h*n),g=this.overwriteColumnWidthFn(d,f);d===g&&d>=wp?(i.push([f,g]),a+=g):d!==g&&(i.push([f,g]),s.push(f),o-=g)}),o<=wp){this.stretchedWidths.clear();return}const l=o/a;let u=-1,c=0;i.forEach((h,f)=>{let[d,g]=h,m=g;s.includes(d)||(m=Math.round(g*l)),this.stretchedWidths.set(d,m),u=d,f<i.length-1&&(c+=m)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function gU(t,e,r){mZe(t,e),e.set(t,r)}function mZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fI(t,e){return t.get(Cee(t,e))}function tx(t,e,r){return t.set(Cee(t,e),r),r}function Cee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rx=new WeakMap,dv=new WeakMap;class pZe extends yee{constructor(){super(...arguments),gU(this,rx,0),gU(this,dv,-1)}prepare(e){super.prepare(e),tx(rx,this,0),tx(dv,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),tx(dv,this,e),tx(rx,this,r)}calculate(){if(fI(dv,this)===-1)return;const e=Array.from(this.baseWidths).reduce((n,i)=>{let[,s]=i;return n+s},0),r=Math.max(this.viewportWidth-e+fI(rx,this),0);this.stretchedWidths.set(fI(dv,this),r)}}function vZe(t,e){See(t,e),e.add(t)}function nx(t,e,r){See(t,e),e.set(t,r)}function See(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zr(t,e){return t.get(Nm(t,e))}function dI(t,e,r){return t.set(Nm(t,e),r),r}function Nm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wZe="stretchColumns";var Ci=new WeakMap,Jg=new WeakMap,gI=new WeakMap,ix=new WeakMap,gv=new WeakSet;class yZe{constructor(e){vZe(this,gv),nx(this,Ci,void 0),nx(this,Jg,void 0),nx(this,gI,new Map([["all",new gZe(Nm(gv,this,mU).bind(this))],["last",new pZe(Nm(gv,this,mU).bind(this))]])),nx(this,ix,"none"),dI(Ci,this,e),dI(Jg,this,Zr(Ci,this).columnIndexMapper.createAndRegisterIndexMap(wZe,"physicalIndexToValue"))}useStrategy(e){dI(ix,this,Zr(gI,this).has(e)?e:"none")}refreshStretching(){if(Zr(ix,this)==="none"){Zr(Jg,this).clear();return}Zr(Ci,this).batchExecution(()=>{Zr(Jg,this).clear();const e=Zr(gI,this).get(Zr(ix,this));let n=Zr(Ci,this).view.getViewportWidth();Nm(gv,this,CZe).call(this)&&(n-=ei(Zr(Ci,this).rootDocument)),e.prepare({viewportWidth:n});for(let i=0;i<Zr(Ci,this).countCols();i++)Zr(Ci,this).columnIndexMapper.isHidden(Zr(Ci,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Nm(gv,this,SZe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,o]=i;Zr(Jg,this).setValueAtIndex(Zr(Ci,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return Zr(Jg,this).getValueAtIndex(Zr(Ci,this).toPhysicalColumn(e))}}function CZe(){const{view:t,stylesHandler:e}=Zr(Ci,this);if(t.isVerticallyScrollableByWindow())return!1;const r=t.getViewportHeight(),n=Zr(Ci,this).countRows(),i=e.getDefaultRowHeight();let s=0,o=!1;for(let l=0;l<n;l++){var a;if(s+=((a=Zr(Ci,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),s>r){o=!0;break}}return o}function SZe(t){var e;return(e=Zr(Ci,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:wp}function mU(t,e){return Zr(Ci,this).runHooks("beforeStretchingColumnWidth",t,e)}function xZe(t,e){xee(t,e),e.add(t)}function mI(t,e,r){xee(t,e),e.set(t,r)}function xee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pI(t,e,r){return t.set(oE(t,e),r),r}function fu(t,e){return t.get(oE(t,e))}function oE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bZe="stretchColumns",_Ze=155;var cm=new WeakMap,sx=new WeakMap,mv=new WeakMap,vI=new WeakSet;class EZe extends zt{constructor(){super(...arguments),xZe(this,vI),mI(this,cm,new yZe(this.hot)),mI(this,sx,null),mI(this,mv,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(n=>{let{contentRect:i}=n;fu(sx,this)!==null&&fu(sx,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),pI(sx,this,i.width)})})}))}static get PLUGIN_KEY(){return bZe}static get PLUGIN_PRIORITY(){return _Ze}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(fu(cm,this).useStrategy(this.hot.getSettings().stretchH),fu(mv,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return oE(vI,e,TZe).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return oE(vI,e,RZe).call(e,...n)},10),super.enablePlugin())}updatePlugin(){fu(cm,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),fu(mv,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return fu(cm,this).getStretchedWidth(e)}destroy(){fu(mv,this).disconnect(),pI(mv,this,null),pI(cm,this,null),super.destroy()}}function RZe(t,e,r){if(r===this.pluginName)return;const n=this.getColumnWidth(e);return typeof n=="number"?n:t}function TZe(t){t&&fu(cm,this).refreshStretching()}function kZe(t,e){PZe(t,e),e.add(t)}function PZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ox(t,e,r){return(e=AZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AZe(t){var e=IZe(t,"string");return typeof e=="symbol"?e:e+""}function IZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const OZe="touchScroll",MZe=200;var ax=new WeakSet;class NZe extends zt{constructor(){super(...arguments),kZe(this,ax),ox(this,"scrollbars",[]),ox(this,"clones",[]),ox(this,"lockedCollection",!1),ox(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return OZe}static get PLUGIN_PRIORITY(){return MZe}static get SETTING_KEYS(){return!0}isEnabled(){return pq()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>wI(ax,this,DZe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>wI(ax,this,FZe).call(this)),this.addHook("afterMomentumScroll",()=>wI(ax,this,HZe).call(this))}}function DZe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function FZe(){this.freezeOverlays=!0,Z(this.clones,t=>{Se(t,"hide-tween")})}function HZe(){this.freezeOverlays=!1,Z(this.clones,t=>{qe(t,"hide-tween"),Se(t,"show-tween")}),this.hot._registerTimeout(()=>{Z(this.clones,t=>{qe(t,"show-tween")})},400),Z(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function LZe(t,e){$Ze(t,e),e.add(t)}function $Ze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BZe(t,e,r){return(e=VZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VZe(t){var e=WZe(t,"string");return typeof e=="symbol"?e:e+""}function WZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jZe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const sb="trimRows",UZe=330;var pU=new WeakSet;class zZe extends zt{constructor(){super(...arguments),LZe(this,pU),BZe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return sb}static get PLUGIN_PRIORITY(){return UZe}isEnabled(){return!!this.hot.getSettings()[sb]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new b1),this.trimmedRowsMap.addLocalHook("init",()=>jZe(pU,this,GZe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[sb];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),Z(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{Z(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(Z(e,l=>{s[l]=!1}),i=Ms(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&o)!==!1&&(n&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&o,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}destroy(){super.destroy()}}function GZe(){const t=this.hot.getSettings()[sb];Array.isArray(t)&&this.hot.batchExecution(()=>{Z(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function YZe(t,e,r){return(e=KZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KZe(t){var e=XZe(t,"string");return typeof e=="symbol"?e:e+""}function XZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zo{constructor(e){YZe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function lx(t,e,r){return(e=qZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qZe(t){var e=JZe(t,"string");return typeof e=="symbol"?e:e+""}function JZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v$ extends Zo{constructor(e){let{stateBefore:r,range:n,type:i,alignment:s}=e;super("cell_alignment"),lx(this,"stateBefore",void 0),lx(this,"range",void 0),lx(this,"type",void 0),lx(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=s}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,s,o)=>{r.done(()=>new v$({stateBefore:n,range:i,type:s,alignment:o}))})}undo(e,r){Z(this.range,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&e.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){Nc(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,s,o)=>e.setCellMeta(n,i,s,o)),e.addHookOnce("afterViewRender",r),e.render()}}function vU(t,e,r){return(e=QZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QZe(t){var e=ZZe(t,"string");return typeof e=="symbol"?e:e+""}function ZZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w$ extends Zo{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),vU(this,"columns",void 0),vU(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new w$({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),f$(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),n.moveColumn(a,o)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function wU(t,e,r){return(e=eet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eet(t){var e=tet(t,"string");return typeof e=="symbol"?e:e+""}function tet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y$ extends Zo{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),wU(this,"previousSortState",void 0),wU(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,s)=>{s&&r.done(()=>new y$({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),s=i.isEnabled()?i:n;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function yU(t,e,r){return(e=ret(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ret(t){var e=net(t,"string");return typeof e=="symbol"?e:e+""}function net(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C$ extends Zo{constructor(e){let{index:r,amount:n}=e;super("insert_col"),yU(this,"index",void 0),yU(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,s)=>{r.done(()=>new C$({index:n,amount:i}),s)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function CU(t,e,r){return(e=iet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iet(t){var e=set(t,"string");return typeof e=="symbol"?e:e+""}function set(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S$ extends Zo{constructor(e){let{index:r,amount:n}=e;super("insert_row"),CU(this,"index",void 0),CU(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,s)=>{r.done(()=>new S$({index:n,amount:i}),s)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function ux(t,e,r){return(e=oet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oet(t){var e=aet(t,"string");return typeof e=="symbol"?e:e+""}function aet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x$ extends Zo{constructor(e){let{changes:r,selected:n,countCols:i,countRows:s}=e;super("change"),ux(this,"changes",void 0),ux(this,"selected",void 0),ux(this,"countCols",void 0),ux(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=s}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const s=n&&n.length;if(!s||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new x$({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=rs(this.changes);for(let o=0,a=n.length;o<a;o++)n[o].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const n=rs(this.changes);for(let i=0,s=n.length;i<s;i++)n[i].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function SU(t,e,r){return(e=uet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uet(t){var e=cet(t,"string");return typeof e=="symbol"?e:e+""}function cet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b$ extends Zo{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),SU(this,"conditionsStack",void 0),SU(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new b$({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function het(t,e,r){return(e=fet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fet(t){var e=det(t,"string");return typeof e=="symbol"?e:e+""}function det(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _$ extends Zo{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),het(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const s=n.getTopStartCorner(),o=n.getBottomEndCorner(),a=e.getData(s.row,s.col,o.row,o.col);r.done(()=>new _$({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function bee(t,e,r,n,i){const s=["visualRow","visualCol","row","col","prop"],o=s.length,a=[];return je(n,i,l=>{je(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==o){const h=Object.fromEntries(Object.entries(c).filter(f=>{let[d]=f;return s.includes(d)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function ou(t,e,r){return(e=get(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function get(t){var e=met(t,"string");return typeof e=="symbol"?e:e+""}function met(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E$ extends Zo{constructor(e){let{index:r,indexes:n,data:i,amount:s,headers:o,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),ou(this,"index",void 0),ou(this,"indexes",void 0),ou(this,"data",void 0),ou(this,"amount",void 0),ou(this,"headers",void 0),ou(this,"columnPositions",void 0),ou(this,"rowPositions",void 0),ou(this,"fixedColumnsStart",void 0),ou(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=s,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,s,o)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],f=[],d=[];return je(l.length-1,g=>{const m=[],p=l[g];je(u,c,w=>{m.push(p[e.toPhysicalColumn(w)])}),h.push(m)}),je(i-1,g=>{d.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&je(i-1,g=>{f.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new E$({index:u,indexes:d,data:h,amount:i,headers:f,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:bee(e,0,e.countRows(),u,c)})};r.done(a,o)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),s=(c,h,f)=>f[this.indexes.indexOf(i[h])],o=this.data.length,a=[];for(let c=0;c<o;c++)a.push(Pt(this.data[c],s));const l=Pt(this.headers,s),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),Z(e.getSourceDataArray(),(c,h)=>{Z(i,(f,d)=>{c[f]=a[h][d],u.push([h,f,c[f]])})}),typeof this.headers<"u"&&Z(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,f,d]=c;e.setCellMetaObject(h,f,d)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Qg(t,e,r){return(e=pet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pet(t){var e=vet(t,"string");return typeof e=="symbol"?e:e+""}function vet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R$ extends Zo{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:s,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),Qg(this,"index",void 0),Qg(this,"data",void 0),Qg(this,"fixedRowsBottom",void 0),Qg(this,"fixedRowsTop",void 0),Qg(this,"rowIndexesSequence",void 0),Qg(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=s,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,s,o)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=rs(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new R$({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:bee(e,l,u,0,e.countCols()-1)})};r.done(a,o)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);i.push([this.index+o,isNaN(l)?a:l,s[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;e.setCellMetaObject(o,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function xU(t,e,r){return(e=wet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wet(t){var e=yet(t,"string");return typeof e=="symbol"?e:e+""}function yet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T$ extends Zo{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),xU(this,"rows",void 0),xU(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new T$({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),f$(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),n.moveRow(a,o)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Cet(t,e,r){return(e=xet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xet(t){var e=bet(t,"string");return typeof e=="symbol"?e:e+""}function bet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k$ extends Zo{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),Cet(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new k$({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function _et(t,e){[v$,w$,y$,C$,S$,x$,b$,_$,E$,R$,T$,k$].forEach(r=>r.startRegisteringEvents(t,e))}function Eet(t,e){Ret(t,e),e.add(t)}function Ret(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yI(t,e,r){return(e=Tet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tet(t){var e=ket(t,"string");return typeof e=="symbol"?e:e+""}function ket(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bU="undoRedo",Pet="undoRedo",Aet=1e3;Fe.getSingleton().register("beforeUndo");Fe.getSingleton().register("afterUndo");Fe.getSingleton().register("beforeRedo");Fe.getSingleton().register("afterRedo");const _U=new Set;var cx=new WeakSet;class Iet extends zt{static get PLUGIN_KEY(){return Pet}static get PLUGIN_PRIORITY(){return Aet}static get SETTING_KEYS(){return!0}constructor(e){super(e),Eet(this,cx),yI(this,"doneActions",[]),yI(this,"undoneActions",[]),yI(this,"ignoreNewActions",!1),_et(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return CI(cx,e,Oet).call(e,...n)}),this.registerShortcuts(),CI(cx,this,Met).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),CI(cx,this,Net).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:bU};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bU)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const o=e(),a=this.undoneActions.slice();this.doneActions.push(o),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=rs(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=rs(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Oet(t,e){e==="loadData"&&this.clear()}function Met(){const t=e=>{_U.has(e)||(Ut(Jt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),_U.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Net(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function Det(){Nt(ow),Nt(Lje),Nt(aw),Nt(mUe),Nt(bUe),Nt(UQ),Nt(w5e),Nt(rze),Nt(QR),Nt(c7e),Nt(F7e),Nt(U7e),Nt(tT),Nt(R9e),Nt(SYe),Nt(eKe),Nt(TKe),Nt($Ke),Nt(JKe),Nt(lXe),Nt(wXe),Nt(FXe),Nt(zXe),Nt(Lqe),Nt(pJe),Nt(SJe),Nt(YJe),Nt(MQe),Nt(rZe),Nt(hZe),Nt(EZe),Nt(NZe),Nt(zZe),Nt(Iet)}function Fet(){l8e(),I6e(),B6e(),oje(),Det()}Fet();const ea=({title:t,sheetName:e,data:r,setData:n})=>{const i=pe.useRef(null),[s,o]=pe.useState(""),[a,l]=pe.useState(""),u=E=>{l(E),setTimeout(()=>l(""),2e3)},c=()=>{var E;return(E=i.current)==null?void 0:E.hotInstance},h=()=>{const E=c();return E?E.getPlugin("CopyPaste")??null:null},f=E=>{const x=E.getSelected();if(!x)return null;const[P,A,O,Y]=x[0],L=Math.min(P,O),ie=Math.max(P,O),ce=Math.min(A,Y),he=Math.max(A,Y);return{r1:L,r2:ie,c1:ce,c2:he}},d=E=>{const x=f(E);if(!x)return"";const{r1:P,r2:A,c1:O,c2:Y}=x,L=[];for(let ie=P;ie<=A;ie++){const ce=[];for(let he=O;he<=Y;he++)ce.push(E.getDataAtCell(ie,he)??"");L.push(ce)}return L.map(ie=>ie.join("	")).join(`
`)},g=(E,x,P,A)=>{const O=x+A.length,Y=P+Math.max(0,...A.map(ce=>ce.length)),L=E.map(ce=>[...ce]),ie=Math.max(Y,Math.max(0,...L.map(ce=>ce.length)));for(let ce=0;ce<L.length;ce++)L[ce].length<ie&&(L[ce]=[...L[ce],...Array(ie-L[ce].length).fill("")]);for(;L.length<O;)L.push(Array(ie).fill(""));return L},m=E=>{var A;const x=(A=E.target.files)==null?void 0:A[0];if(!x)return;o(x.name);const P=new FileReader;P.onload=O=>{var ge;const Y=(ge=O.target)==null?void 0:ge.result;if(!Y)return;const L=ly(Y,{type:"array"}),ie=L.SheetNames[0],ce=L.Sheets[ie],he=th.sheet_to_json(ce,{header:1}),Ee=Math.max(0,...he.map(Q=>Q.length)),Ce=he.map(Q=>Array.from({length:Ee},(ye,Re)=>Q[Re]??""));n(Ce),u("Файл загружен")},P.readAsArrayBuffer(x)},p=()=>{const E=th.aoa_to_sheet(r),x=th.book_new();th.book_append_sheet(x,E,e),n_(x,`${e}.xlsx`),u("Файл экспортирован")},w=()=>{var E;n([...r,Array(((E=r[0])==null?void 0:E.length)||1).fill("")]),u("Строка добавлена")},v=()=>{r.length>1&&(n(r.slice(0,-1)),u("Строка удалена"))},y=async()=>{const E=h(),x=c();if(E&&x){E.copy(),u("Скопировано");return}if(x){const P=d(x);if(P)try{await navigator.clipboard.writeText(P),u("Скопировано")}catch{u("Не удалось скопировать")}}},b=async()=>{const E=h(),x=c();if(E&&x){E.cut(),u("Вырезано");return}if(x){const P=f(x),A=d(x);try{A&&await navigator.clipboard.writeText(A)}catch{}if(P){const{r1:O,r2:Y,c1:L,c2:ie}=P,ce=r.map(he=>[...he]);for(let he=O;he<=Y;he++)for(let Ee=L;Ee<=ie;Ee++)ce[he]||(ce[he]=[]),ce[he][Ee]="";n(ce)}u("Вырезано")}},T=async()=>{const E=h(),x=c();if(x)try{const P=await navigator.clipboard.readText();if(E&&typeof E.paste=="function"){E.paste(P),u("Вставлено");return}const A=P.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).map(ce=>ce.split("	")),O=x.getSelected();if(!O)return;const[Y,L]=O[0];let ie=g(r,Y,L,A);A.forEach((ce,he)=>{ce.forEach((Ee,Ce)=>{const ge=Y+he,Q=L+Ce;ie[ge]||(ie[ge]=[]),ie[ge][Q]=Ee})}),n(ie),u("Вставлено")}catch(P){console.error("Ошибка чтения буфера обмена:",P),u("Не удалось вставить")}};return j.jsxs("div",{children:[j.jsx("h3",{style:{marginBottom:10},children:t}),j.jsx(rQ,{ref:i,data:r,colHeaders:!0,rowHeaders:!0,width:"100%",height:"400px",stretchH:"all",autoColumnSize:!0,licenseKey:"non-commercial-and-evaluation",copyPaste:!0,afterChange:(E,x)=>{x!=="loadData"&&E&&n([...r])}}),j.jsxs("div",{style:{marginTop:15,display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[j.jsxs("label",{style:{cursor:"pointer"},children:[j.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:m,style:{display:"none"}}),j.jsx("span",{style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4},children:"Выберите файл"})]}),s&&j.jsxs("span",{style:{fontSize:14},children:["📄 ",s]}),j.jsx("button",{onClick:p,children:"Экспорт текущей"}),j.jsx("button",{onClick:w,children:"Добавить строку"}),j.jsx("button",{onClick:v,children:"Удалить строку"}),j.jsx("button",{onClick:y,children:"Скопировать"}),j.jsx("button",{onClick:b,children:"Вырезать"}),j.jsx("button",{onClick:T,children:"Вставить"})]}),a&&j.jsx("div",{style:{position:"fixed",bottom:20,right:20,background:"#333",color:"#fff",padding:"10px 15px",borderRadius:8,fontSize:14,boxShadow:"0 2px 6px rgba(0,0,0,0.3)",opacity:.95,zIndex:9999},children:a})]})},EU=({data:t,setData:e})=>j.jsx(ea,{title:"Основное",sheetName:"Основное",data:t,setData:e}),Het=({data:t,setData:e})=>j.jsx(ea,{title:"Каталог скважин",sheetName:"Каталог скважин",data:t,setData:e}),Let=({data:t,setData:e})=>j.jsx(ea,{title:"Каталог скважин для термометрии",sheetName:"Каталог термоскважин",data:t,setData:e}),$et=({data:t,setData:e})=>j.jsx(ea,{title:"Каталог ВЭЗ",sheetName:"Каталог ВЭЗ",data:t,setData:e}),Bet=({data:t,setData:e})=>j.jsx(ea,{title:"Каталог БТ",sheetName:"Каталог БТ",data:t,setData:e}),Vet=({data:t,setData:e})=>j.jsx(ea,{title:"Литологический разрез",sheetName:"Литология",data:t,setData:e}),Wet=({data:t,setData:e})=>j.jsx(ea,{title:"Данные термометрии",sheetName:"Термометрия",data:t,setData:e}),jet=({data:t,setData:e})=>j.jsx(ea,{title:"Данные ВЭЗ",sheetName:"Данные ВЭЗ",data:t,setData:e}),Uet=({data:t,setData:e})=>j.jsx(ea,{title:"Данные БТ",sheetName:"Данные БТ",data:t,setData:e}),zet=({data:t,setData:e})=>j.jsx(ea,{title:"Региональные данные",sheetName:"Региональные",data:t,setData:e}),Get=({data:t,setData:e})=>j.jsx(ea,{title:"Перечень ИГЭ",sheetName:"ИГЭ",data:t,setData:e}),Yet=({data:t,setData:e})=>j.jsx(ea,{title:"Выводы",sheetName:"Выводы",data:t,setData:e}),SI="my-profgeo-tables",RU=["Основное","Каталог скважин","Каталог скважин для термометрии","Каталог ВЭЗ","Каталог БТ","Литологический разрез","Данные термометрии","Данные ВЭЗ","Данные БТ","Региональные данные","Перечень ИГЭ","Выводы"],TU=[[["ID","Название","Описание"],[1,"Проект А","Основные данные"]],[["ID","Скважина","Глубина"]],[["ID","Скважина термо","Глубина"]],[["ID","ВЭЗ"]],[["ID","БТ"]],[["ID","Литология"]],[["ID","Температура"]],[["ID","Данные ВЭЗ"]],[["ID","Данные БТ"]],[["ID","Регион"]],[["ID","ИГЭ"]],[["Выводы"]]],Ket=()=>{const[t,e]=pe.useState(0),[r,n]=pe.useState(TU);pe.useEffect(()=>{const l=localStorage.getItem(SI);if(l)try{const u=JSON.parse(l);Array.isArray(u)&&n(u)}catch(u){console.error("Ошибка загрузки данных из localStorage:",u)}},[]),pe.useEffect(()=>{localStorage.setItem(SI,JSON.stringify(r))},[r]);const i=(l,u)=>{n(c=>{const h=[...c];return h[l]=u,h})},s=()=>{const l=th.book_new();r.forEach((u,c)=>{const h=th.aoa_to_sheet(u);th.book_append_sheet(l,h,RU[c])}),n_(l,"all_tables.xlsx")},o=()=>{window.confirm("Вы уверены, что хотите очистить все таблицы?")&&(n(TU),localStorage.removeItem(SI))},a=()=>{const l={data:r[t],setData:u=>i(t,u)};switch(t){case 0:return j.jsx(EU,{...l});case 1:return j.jsx(Het,{...l});case 2:return j.jsx(Let,{...l});case 3:return j.jsx($et,{...l});case 4:return j.jsx(Bet,{...l});case 5:return j.jsx(Vet,{...l});case 6:return j.jsx(Wet,{...l});case 7:return j.jsx(jet,{...l});case 8:return j.jsx(Uet,{...l});case 9:return j.jsx(zet,{...l});case 10:return j.jsx(Get,{...l});case 11:return j.jsx(Yet,{...l});default:return j.jsx(EU,{...l})}};return j.jsxs("div",{style:{padding:20},children:[j.jsx("div",{style:{display:"flex",overflowX:"auto",marginBottom:15,gap:"10px"},children:RU.map((l,u)=>j.jsx("button",{onClick:()=>e(u),style:{padding:"8px 12px",background:t===u?"#1976d2":"#eee",color:t===u?"#fff":"#000",borderRadius:6,cursor:"pointer"},children:l},u))}),a(),j.jsxs("div",{style:{marginTop:20,display:"flex",gap:10},children:[j.jsx("button",{onClick:s,children:"Экспортировать все таблицы"}),j.jsx("button",{onClick:o,style:{background:"#e53935",color:"#fff"},children:"Сбросить все данные"})]})]})},Xet=()=>j.jsxs("div",{className:"min-h-screen flex flex-col",children:[j.jsx(Roe,{}),j.jsx(Toe,{}),j.jsxs(wie,{children:[j.jsx(Vi,{path:"/",element:j.jsx(Tce,{})}),j.jsx(Vi,{path:"/login",element:j.jsx(kce,{})}),j.jsx(Vi,{path:"/register",element:j.jsx(Pce,{})}),j.jsxs(Vi,{path:"/lk",element:j.jsx(L3,{children:j.jsx(zoe,{})}),children:[j.jsx(Vi,{index:!0,element:j.jsx(hue,{})}),j.jsx(Vi,{path:"objects",element:j.jsx(Cce,{})}),j.jsx(Vi,{path:"objects/create",element:j.jsx(Sce,{})}),j.jsx(Vi,{path:"account",element:j.jsx(xce,{})}),j.jsx(Vi,{path:"subscription",element:j.jsx(bce,{})}),j.jsx(Vi,{path:"users",element:j.jsx(_ce,{})}),j.jsx(Vi,{path:"settings",element:j.jsx(Ece,{})})]}),j.jsx(Vi,{path:"/work",element:j.jsx(L3,{children:j.jsx(nae,{})}),children:j.jsx(Vi,{path:"app1",element:j.jsx(Ket,{})})}),j.jsx(Vi,{path:"*",element:j.jsx("div",{style:{padding:24},children:"Страница не найдена"})})]}),j.jsx(vse,{position:"bottom-right",autoClose:5e3})]});var P$="persist:",A$="persist/FLUSH",oT="persist/REHYDRATE",I$="persist/PAUSE",O$="persist/PERSIST",M$="persist/PURGE",N$="persist/REGISTER",qet=-1;function ob(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ob=function(r){return typeof r}:ob=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ob(t)}function kU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jet(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kU(r,!0).forEach(function(n){Qet(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kU(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Qet(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zet(t,e,r,n){n.debug;var i=Jet({},r);return t&&ob(t)==="object"&&Object.keys(t).forEach(function(s){s!=="_persist"&&e[s]===r[s]&&(i[s]=t[s])}),i}function ett(t){var e=t.blacklist||null,r=t.whitelist||null,n=t.transforms||[],i=t.throttle||0,s="".concat(t.keyPrefix!==void 0?t.keyPrefix:P$).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(T){return T}:typeof t.serialize=="function"?a=t.serialize:a=ttt;var l=t.writeFailHandler||null,u={},c={},h=[],f=null,d=null,g=function(T){Object.keys(T).forEach(function(E){w(E)&&u[E]!==T[E]&&h.indexOf(E)===-1&&h.push(E)}),Object.keys(u).forEach(function(E){T[E]===void 0&&w(E)&&h.indexOf(E)===-1&&u[E]!==void 0&&h.push(E)}),f===null&&(f=setInterval(m,i)),u=T};function m(){if(h.length===0){f&&clearInterval(f),f=null;return}var b=h.shift(),T=n.reduce(function(E,x){return x.in(E,b,u)},u[b]);if(T!==void 0)try{c[b]=a(T)}catch(E){console.error("redux-persist/createPersistoid: error serializing state",E)}else delete c[b];h.length===0&&p()}function p(){Object.keys(c).forEach(function(b){u[b]===void 0&&delete c[b]}),d=o.setItem(s,a(c)).catch(v)}function w(b){return!(r&&r.indexOf(b)===-1&&b!=="_persist"||e&&e.indexOf(b)!==-1)}function v(b){l&&l(b)}var y=function(){for(;h.length!==0;)m();return d||Promise.resolve()};return{update:g,flush:y}}function ttt(t){return JSON.stringify(t)}function rtt(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:P$).concat(t.key),n=t.storage;t.debug;var i;return t.deserialize===!1?i=function(o){return o}:typeof t.deserialize=="function"?i=t.deserialize:i=ntt,n.getItem(r).then(function(s){if(s)try{var o={},a=i(s);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(u,c){return c.out(u,l,a)},i(a[l]))}),o}catch(l){throw l}else return})}function ntt(t){return JSON.parse(t)}function itt(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:P$).concat(t.key);return e.removeItem(r,stt)}function stt(t){}function PU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function au(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PU(r,!0).forEach(function(n){ott(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PU(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ott(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function att(t,e){if(t==null)return{};var r=ltt(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ltt(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var utt=5e3;function ctt(t,e){var r=t.version!==void 0?t.version:qet;t.debug;var n=t.stateReconciler===void 0?Zet:t.stateReconciler,i=t.getStoredState||rtt,s=t.timeout!==void 0?t.timeout:utt,o=null,a=!1,l=!0,u=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(c,h){var f=c||{},d=f._persist,g=att(f,["_persist"]),m=g;if(h.type===O$){var p=!1,w=function(P,A){p||(h.rehydrate(t.key,P,A),p=!0)};if(s&&setTimeout(function(){!p&&w(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},s),l=!1,o||(o=ett(t)),d)return au({},e(m,h),{_persist:d});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),i(t).then(function(x){var P=t.migrate||function(A,O){return Promise.resolve(A)};P(x,r).then(function(A){w(A)},function(A){w(void 0,A)})},function(x){w(void 0,x)}),au({},e(m,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===M$)return a=!0,h.result(itt(t)),au({},e(m,h),{_persist:d});if(h.type===A$)return h.result(o&&o.flush()),au({},e(m,h),{_persist:d});if(h.type===I$)l=!0;else if(h.type===oT){if(a)return au({},m,{_persist:au({},d,{rehydrated:!0})});if(h.key===t.key){var v=e(m,h),y=h.payload,b=n!==!1&&y!==void 0?n(y,c,v,t):v,T=au({},b,{_persist:au({},d,{rehydrated:!0})});return u(T)}}}if(!d)return e(c,h);var E=e(m,h);return E===m?c:u(au({},E,{_persist:d}))}}function AU(t){return dtt(t)||ftt(t)||htt()}function htt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function ftt(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function dtt(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function IU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function E2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?IU(r,!0).forEach(function(n){gtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):IU(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gtt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var _ee={registry:[],bootstrapped:!1},mtt=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_ee,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case N$:return E2({},e,{registry:[].concat(AU(e.registry),[r.key])});case oT:var n=e.registry.indexOf(r.key),i=AU(e.registry);return i.splice(n,1),E2({},e,{registry:i,bootstrapped:i.length===0});default:return e}};function ptt(t,e,r){var n=_N(mtt,_ee,void 0),i=function(l){n.dispatch({type:N$,key:l})},s=function(l,u,c){var h={type:oT,payload:u,err:c,key:l};t.dispatch(h),n.dispatch(h)},o=E2({},n,{purge:function(){var l=[];return t.dispatch({type:M$,result:function(c){l.push(c)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:A$,result:function(c){l.push(c)}}),Promise.all(l)},pause:function(){t.dispatch({type:I$})},persist:function(){t.dispatch({type:O$,register:i,rehydrate:s})}});return o.persist(),o}var D$={},F$={};F$.__esModule=!0;F$.default=ytt;function ab(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ab=function(r){return typeof r}:ab=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ab(t)}function xI(){}var vtt={getItem:xI,setItem:xI,removeItem:xI};function wtt(t){if((typeof self>"u"?"undefined":ab(self))!=="object"||!(t in self))return!1;try{var e=self[t],r="redux-persist ".concat(t," test");e.setItem(r,"test"),e.getItem(r),e.removeItem(r)}catch{return!1}return!0}function ytt(t){var e="".concat(t,"Storage");return wtt(e)?self[e]:vtt}D$.__esModule=!0;D$.default=xtt;var Ctt=Stt(F$);function Stt(t){return t&&t.__esModule?t:{default:t}}function xtt(t){var e=(0,Ctt.default)(t);return{getItem:function(n){return new Promise(function(i,s){i(e.getItem(n))})},setItem:function(n,i){return new Promise(function(s,o){s(e.setItem(n,i))})},removeItem:function(n){return new Promise(function(i,s){i(e.removeItem(n))})}}}var Eee=void 0,btt=_tt(D$);function _tt(t){return t&&t.__esModule?t:{default:t}}var Ett=(0,btt.default)("local");Eee=Ett;const Rtt=p7({auth:coe,objectForm:Ble}),Ttt={key:"root",storage:Eee,whitelist:["auth"]},ktt=ctt(Ttt,Rtt),Ree=Wse({reducer:ktt,middleware:t=>t({serializableCheck:{ignoredActions:[A$,oT,I$,O$,M$,N$]}})}),Ptt=ptt(Ree),Att="/my-profgeo-app",Itt=bI.createRoot(document.getElementById("root"));Itt.render(j.jsx(Ge.StrictMode,{children:j.jsx(xne,{store:Ree,children:j.jsx(l7,{loading:null,persistor:Ptt,children:j.jsx(Rie,{basename:Att,children:j.jsx(Xet,{})})})})}))});export default Ott();
