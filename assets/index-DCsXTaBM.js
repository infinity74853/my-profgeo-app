var Mee=Object.defineProperty;var Nee=(t,e,r)=>e in t?Mee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Dee=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var gT=(t,e,r)=>Nee(t,typeof e!="symbol"?e+"":e,r);var mrt=Dee((ent,hb)=>{function Fee(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var V1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var HU={exports:{}},fE={},LU={exports:{}},Pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hy=Symbol.for("react.element"),Hee=Symbol.for("react.portal"),Lee=Symbol.for("react.fragment"),$ee=Symbol.for("react.strict_mode"),Bee=Symbol.for("react.profiler"),Vee=Symbol.for("react.provider"),Wee=Symbol.for("react.context"),jee=Symbol.for("react.forward_ref"),Uee=Symbol.for("react.suspense"),zee=Symbol.for("react.memo"),Gee=Symbol.for("react.lazy"),V$=Symbol.iterator;function Yee(t){return t===null||typeof t!="object"?null:(t=V$&&t[V$]||t["@@iterator"],typeof t=="function"?t:null)}var $U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},BU=Object.assign,VU={};function Pp(t,e,r){this.props=t,this.context=e,this.refs=VU,this.updater=r||$U}Pp.prototype.isReactComponent={};Pp.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Pp.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function WU(){}WU.prototype=Pp.prototype;function A2(t,e,r){this.props=t,this.context=e,this.refs=VU,this.updater=r||$U}var I2=A2.prototype=new WU;I2.constructor=A2;BU(I2,Pp.prototype);I2.isPureReactComponent=!0;var W$=Array.isArray,jU=Object.prototype.hasOwnProperty,O2={current:null},UU={key:!0,ref:!0,__self:!0,__source:!0};function zU(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)jU.call(e,n)&&!UU.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:Hy,type:t,key:s,ref:o,props:i,_owner:O2.current}}function Kee(t,e){return{$$typeof:Hy,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function M2(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hy}function Xee(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var j$=/\/+/g;function mT(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Xee(""+t.key):e.toString(36)}function gx(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Hy:case Hee:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+mT(o,0):n,W$(i)?(r="",t!=null&&(r=t.replace(j$,"$&/")+"/"),gx(i,e,r,"",function(c){return c})):i!=null&&(M2(i)&&(i=Kee(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(j$,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",W$(t))for(var a=0;a<t.length;a++){s=t[a];var l=n+mT(s,a);o+=gx(s,e,r,l,i)}else if(l=Yee(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=n+mT(s,a++),o+=gx(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function W1(t,e,r){if(t==null)return t;var n=[],i=0;return gx(t,n,"","",function(s){return e.call(r,s,i++)}),n}function qee(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var is={current:null},mx={transition:null},Jee={ReactCurrentDispatcher:is,ReactCurrentBatchConfig:mx,ReactCurrentOwner:O2};function GU(){throw Error("act(...) is not supported in production builds of React.")}Pt.Children={map:W1,forEach:function(t,e,r){W1(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return W1(t,function(){e++}),e},toArray:function(t){return W1(t,function(e){return e})||[]},only:function(t){if(!M2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Pt.Component=Pp;Pt.Fragment=Lee;Pt.Profiler=Bee;Pt.PureComponent=A2;Pt.StrictMode=$ee;Pt.Suspense=Uee;Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jee;Pt.act=GU;Pt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=BU({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=O2.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)jU.call(e,l)&&!UU.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:Hy,type:t.type,key:i,ref:s,props:n,_owner:o}};Pt.createContext=function(t){return t={$$typeof:Wee,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Vee,_context:t},t.Consumer=t};Pt.createElement=zU;Pt.createFactory=function(t){var e=zU.bind(null,t);return e.type=t,e};Pt.createRef=function(){return{current:null}};Pt.forwardRef=function(t){return{$$typeof:jee,render:t}};Pt.isValidElement=M2;Pt.lazy=function(t){return{$$typeof:Gee,_payload:{_status:-1,_result:t},_init:qee}};Pt.memo=function(t,e){return{$$typeof:zee,type:t,compare:e===void 0?null:e}};Pt.startTransition=function(t){var e=mx.transition;mx.transition={};try{t()}finally{mx.transition=e}};Pt.unstable_act=GU;Pt.useCallback=function(t,e){return is.current.useCallback(t,e)};Pt.useContext=function(t){return is.current.useContext(t)};Pt.useDebugValue=function(){};Pt.useDeferredValue=function(t){return is.current.useDeferredValue(t)};Pt.useEffect=function(t,e){return is.current.useEffect(t,e)};Pt.useId=function(){return is.current.useId()};Pt.useImperativeHandle=function(t,e,r){return is.current.useImperativeHandle(t,e,r)};Pt.useInsertionEffect=function(t,e){return is.current.useInsertionEffect(t,e)};Pt.useLayoutEffect=function(t,e){return is.current.useLayoutEffect(t,e)};Pt.useMemo=function(t,e){return is.current.useMemo(t,e)};Pt.useReducer=function(t,e,r){return is.current.useReducer(t,e,r)};Pt.useRef=function(t){return is.current.useRef(t)};Pt.useState=function(t){return is.current.useState(t)};Pt.useSyncExternalStore=function(t,e,r){return is.current.useSyncExternalStore(t,e,r)};Pt.useTransition=function(){return is.current.useTransition()};Pt.version="18.3.1";LU.exports=Pt;var me=LU.exports;const Ge=hE(me),Qee=Fee({__proto__:null,default:Ge},[me]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zee=me,ete=Symbol.for("react.element"),tte=Symbol.for("react.fragment"),rte=Object.prototype.hasOwnProperty,nte=Zee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ite={key:!0,ref:!0,__self:!0,__source:!0};function YU(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)rte.call(e,n)&&!ite.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:ete,type:t,key:s,ref:o,props:i,_owner:nte.current}}fE.Fragment=tte;fE.jsx=YU;fE.jsxs=YU;HU.exports=fE;var F=HU.exports,TI={},KU={exports:{}},co={},XU={exports:{}},qU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ge,Q){var ye=ge.length;ge.push(Q);e:for(;0<ye;){var Re=ye-1>>>1,j=ge[Re];if(0<i(j,Q))ge[Re]=Q,ge[ye]=j,ye=Re;else break e}}function r(ge){return ge.length===0?null:ge[0]}function n(ge){if(ge.length===0)return null;var Q=ge[0],ye=ge.pop();if(ye!==Q){ge[0]=ye;e:for(var Re=0,j=ge.length,C=j>>>1;Re<C;){var S=2*(Re+1)-1,_=ge[S],D=S+1,U=ge[D];if(0>i(_,ye))D<j&&0>i(U,_)?(ge[Re]=U,ge[D]=ye,Re=D):(ge[Re]=_,ge[S]=ye,Re=S);else if(D<j&&0>i(U,ye))ge[Re]=U,ge[D]=ye,Re=D;else break e}}return Q}function i(ge,Q){var ye=ge.sortIndex-Q.sortIndex;return ye!==0?ye:ge.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,d=!1,g=!1,m=!1,p=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ge){for(var Q=r(c);Q!==null;){if(Q.callback===null)n(c);else if(Q.startTime<=ge)n(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=r(c)}}function b(ge){if(m=!1,y(ge),!g)if(r(l)!==null)g=!0,Ee(T);else{var Q=r(c);Q!==null&&Ce(b,Q.startTime-ge)}}function T(ge,Q){g=!1,m&&(m=!1,w(P),P=-1),d=!0;var ye=f;try{for(y(Q),h=r(l);h!==null&&(!(h.expirationTime>Q)||ge&&!Y());){var Re=h.callback;if(typeof Re=="function"){h.callback=null,f=h.priorityLevel;var j=Re(h.expirationTime<=Q);Q=t.unstable_now(),typeof j=="function"?h.callback=j:h===r(l)&&n(l),y(Q)}else n(l);h=r(l)}if(h!==null)var C=!0;else{var S=r(c);S!==null&&Ce(b,S.startTime-Q),C=!1}return C}finally{h=null,f=ye,d=!1}}var E=!1,x=null,P=-1,A=5,O=-1;function Y(){return!(t.unstable_now()-O<A)}function B(){if(x!==null){var ge=t.unstable_now();O=ge;var Q=!0;try{Q=x(!0,ge)}finally{Q?ie():(E=!1,x=null)}}else E=!1}var ie;if(typeof v=="function")ie=function(){v(B)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,he=ue.port2;ue.port1.onmessage=B,ie=function(){he.postMessage(null)}}else ie=function(){p(B,0)};function Ee(ge){x=ge,E||(E=!0,ie())}function Ce(ge,Q){P=p(function(){ge(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ge){ge.callback=null},t.unstable_continueExecution=function(){g||d||(g=!0,Ee(T))},t.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ge?Math.floor(1e3/ge):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ge){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var ye=f;f=Q;try{return ge()}finally{f=ye}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ge,Q){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var ye=f;f=ge;try{return Q()}finally{f=ye}},t.unstable_scheduleCallback=function(ge,Q,ye){var Re=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Re+ye:Re):ye=Re,ge){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ye+j,ge={id:u++,callback:Q,priorityLevel:ge,startTime:ye,expirationTime:j,sortIndex:-1},ye>Re?(ge.sortIndex=ye,e(c,ge),r(l)===null&&ge===r(c)&&(m?(w(P),P=-1):m=!0,Ce(b,ye-Re))):(ge.sortIndex=j,e(l,ge),g||d||(g=!0,Ee(T))),ge},t.unstable_shouldYield=Y,t.unstable_wrapCallback=function(ge){var Q=f;return function(){var ye=f;f=Q;try{return ge.apply(this,arguments)}finally{f=ye}}}})(qU);XU.exports=qU;var ste=XU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ote=me,no=ste;function Te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var JU=new Set,Ew={};function Wd(t,e){np(t,e),np(t+"Capture",e)}function np(t,e){for(Ew[t]=e,t=0;t<e.length;t++)JU.add(e[t])}var Vc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kI=Object.prototype.hasOwnProperty,ate=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,U$={},z$={};function lte(t){return kI.call(z$,t)?!0:kI.call(U$,t)?!1:ate.test(t)?z$[t]=!0:(U$[t]=!0,!1)}function cte(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ute(t,e,r,n){if(e===null||typeof e>"u"||cte(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ss(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var hi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hi[t]=new ss(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hi[e]=new ss(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){hi[t]=new ss(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hi[t]=new ss(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hi[t]=new ss(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){hi[t]=new ss(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){hi[t]=new ss(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){hi[t]=new ss(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){hi[t]=new ss(t,5,!1,t.toLowerCase(),null,!1,!1)});var N2=/[\-:]([a-z])/g;function D2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(N2,D2);hi[e]=new ss(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(N2,D2);hi[e]=new ss(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(N2,D2);hi[e]=new ss(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){hi[t]=new ss(t,1,!1,t.toLowerCase(),null,!1,!1)});hi.xlinkHref=new ss("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){hi[t]=new ss(t,1,!1,t.toLowerCase(),null,!0,!0)});function F2(t,e,r,n){var i=hi.hasOwnProperty(e)?hi[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ute(e,r,i,n)&&(r=null),n||i===null?lte(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Zc=ote.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j1=Symbol.for("react.element"),dm=Symbol.for("react.portal"),gm=Symbol.for("react.fragment"),H2=Symbol.for("react.strict_mode"),PI=Symbol.for("react.profiler"),QU=Symbol.for("react.provider"),ZU=Symbol.for("react.context"),L2=Symbol.for("react.forward_ref"),AI=Symbol.for("react.suspense"),II=Symbol.for("react.suspense_list"),$2=Symbol.for("react.memo"),Fu=Symbol.for("react.lazy"),e5=Symbol.for("react.offscreen"),G$=Symbol.iterator;function i0(t){return t===null||typeof t!="object"?null:(t=G$&&t[G$]||t["@@iterator"],typeof t=="function"?t:null)}var Kr=Object.assign,pT;function yv(t){if(pT===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);pT=e&&e[1]||""}return`
`+pT+t}var vT=!1;function wT(t,e){if(!t||vT)return"";vT=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{vT=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?yv(t):""}function hte(t){switch(t.tag){case 5:return yv(t.type);case 16:return yv("Lazy");case 13:return yv("Suspense");case 19:return yv("SuspenseList");case 0:case 2:case 15:return t=wT(t.type,!1),t;case 11:return t=wT(t.type.render,!1),t;case 1:return t=wT(t.type,!0),t;default:return""}}function OI(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case gm:return"Fragment";case dm:return"Portal";case PI:return"Profiler";case H2:return"StrictMode";case AI:return"Suspense";case II:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ZU:return(t.displayName||"Context")+".Consumer";case QU:return(t._context.displayName||"Context")+".Provider";case L2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $2:return e=t.displayName||null,e!==null?e:OI(t.type)||"Memo";case Fu:e=t._payload,t=t._init;try{return OI(t(e))}catch{}}return null}function fte(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return OI(e);case 8:return e===H2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function t5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function dte(t){var e=t5(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function U1(t){t._valueTracker||(t._valueTracker=dte(t))}function r5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=t5(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function fb(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function MI(t,e){var r=e.checked;return Kr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Y$(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=bh(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function n5(t,e){e=e.checked,e!=null&&F2(t,"checked",e,!1)}function NI(t,e){n5(t,e);var r=bh(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?DI(t,e.type,r):e.hasOwnProperty("defaultValue")&&DI(t,e.type,bh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function K$(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function DI(t,e,r){(e!=="number"||fb(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Cv=Array.isArray;function Lm(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+bh(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function FI(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Te(91));return Kr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function X$(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Te(92));if(Cv(r)){if(1<r.length)throw Error(Te(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:bh(r)}}function i5(t,e){var r=bh(e.value),n=bh(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function q$(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function s5(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function HI(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?s5(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var z1,o5=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(z1=z1||document.createElement("div"),z1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=z1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Rw(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Dv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gte=["Webkit","ms","Moz","O"];Object.keys(Dv).forEach(function(t){gte.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Dv[e]=Dv[t]})});function a5(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Dv.hasOwnProperty(t)&&Dv[t]?(""+e).trim():e+"px"}function l5(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=a5(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var mte=Kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function LI(t,e){if(e){if(mte[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Te(62))}}function $I(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var BI=null;function B2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var VI=null,$m=null,Bm=null;function J$(t){if(t=By(t)){if(typeof VI!="function")throw Error(Te(280));var e=t.stateNode;e&&(e=vE(e),VI(t.stateNode,t.type,e))}}function c5(t){$m?Bm?Bm.push(t):Bm=[t]:$m=t}function u5(){if($m){var t=$m,e=Bm;if(Bm=$m=null,J$(t),e)for(t=0;t<e.length;t++)J$(e[t])}}function h5(t,e){return t(e)}function f5(){}var yT=!1;function d5(t,e,r){if(yT)return t(e,r);yT=!0;try{return h5(t,e,r)}finally{yT=!1,($m!==null||Bm!==null)&&(f5(),u5())}}function Tw(t,e){var r=t.stateNode;if(r===null)return null;var n=vE(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Te(231,e,typeof r));return r}var WI=!1;if(Vc)try{var s0={};Object.defineProperty(s0,"passive",{get:function(){WI=!0}}),window.addEventListener("test",s0,s0),window.removeEventListener("test",s0,s0)}catch{WI=!1}function pte(t,e,r,n,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var Fv=!1,db=null,gb=!1,jI=null,vte={onError:function(t){Fv=!0,db=t}};function wte(t,e,r,n,i,s,o,a,l){Fv=!1,db=null,pte.apply(vte,arguments)}function yte(t,e,r,n,i,s,o,a,l){if(wte.apply(this,arguments),Fv){if(Fv){var c=db;Fv=!1,db=null}else throw Error(Te(198));gb||(gb=!0,jI=c)}}function jd(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function g5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Q$(t){if(jd(t)!==t)throw Error(Te(188))}function Cte(t){var e=t.alternate;if(!e){if(e=jd(t),e===null)throw Error(Te(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Q$(i),t;if(s===n)return Q$(i),e;s=s.sibling}throw Error(Te(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(Te(189))}}if(r.alternate!==n)throw Error(Te(190))}if(r.tag!==3)throw Error(Te(188));return r.stateNode.current===r?t:e}function m5(t){return t=Cte(t),t!==null?p5(t):null}function p5(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=p5(t);if(e!==null)return e;t=t.sibling}return null}var v5=no.unstable_scheduleCallback,Z$=no.unstable_cancelCallback,Ste=no.unstable_shouldYield,xte=no.unstable_requestPaint,gn=no.unstable_now,bte=no.unstable_getCurrentPriorityLevel,V2=no.unstable_ImmediatePriority,w5=no.unstable_UserBlockingPriority,mb=no.unstable_NormalPriority,_te=no.unstable_LowPriority,y5=no.unstable_IdlePriority,dE=null,Ol=null;function Ete(t){if(Ol&&typeof Ol.onCommitFiberRoot=="function")try{Ol.onCommitFiberRoot(dE,t,void 0,(t.current.flags&128)===128)}catch{}}var Aa=Math.clz32?Math.clz32:kte,Rte=Math.log,Tte=Math.LN2;function kte(t){return t>>>=0,t===0?32:31-(Rte(t)/Tte|0)|0}var G1=64,Y1=4194304;function Sv(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pb(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=Sv(a):(s&=o,s!==0&&(n=Sv(s)))}else o=r&~i,o!==0?n=Sv(o):s!==0&&(n=Sv(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Aa(e),i=1<<r,n|=t[r],e&=~i;return n}function Pte(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ate(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Aa(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=Pte(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function UI(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function C5(){var t=G1;return G1<<=1,!(G1&4194240)&&(G1=64),t}function CT(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Ly(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Aa(e),t[e]=r}function Ite(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Aa(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function W2(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Aa(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var cr=0;function S5(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var x5,j2,b5,_5,E5,zI=!1,K1=[],ch=null,uh=null,hh=null,kw=new Map,Pw=new Map,ju=[],Ote="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function e4(t,e){switch(t){case"focusin":case"focusout":ch=null;break;case"dragenter":case"dragleave":uh=null;break;case"mouseover":case"mouseout":hh=null;break;case"pointerover":case"pointerout":kw.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pw.delete(e.pointerId)}}function o0(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=By(e),e!==null&&j2(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Mte(t,e,r,n,i){switch(e){case"focusin":return ch=o0(ch,t,e,r,n,i),!0;case"dragenter":return uh=o0(uh,t,e,r,n,i),!0;case"mouseover":return hh=o0(hh,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return kw.set(s,o0(kw.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Pw.set(s,o0(Pw.get(s)||null,t,e,r,n,i)),!0}return!1}function R5(t){var e=Gf(t.target);if(e!==null){var r=jd(e);if(r!==null){if(e=r.tag,e===13){if(e=g5(r),e!==null){t.blockedOn=e,E5(t.priority,function(){b5(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function px(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=GI(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);BI=n,r.target.dispatchEvent(n),BI=null}else return e=By(r),e!==null&&j2(e),t.blockedOn=r,!1;e.shift()}return!0}function t4(t,e,r){px(t)&&r.delete(e)}function Nte(){zI=!1,ch!==null&&px(ch)&&(ch=null),uh!==null&&px(uh)&&(uh=null),hh!==null&&px(hh)&&(hh=null),kw.forEach(t4),Pw.forEach(t4)}function a0(t,e){t.blockedOn===e&&(t.blockedOn=null,zI||(zI=!0,no.unstable_scheduleCallback(no.unstable_NormalPriority,Nte)))}function Aw(t){function e(i){return a0(i,t)}if(0<K1.length){a0(K1[0],t);for(var r=1;r<K1.length;r++){var n=K1[r];n.blockedOn===t&&(n.blockedOn=null)}}for(ch!==null&&a0(ch,t),uh!==null&&a0(uh,t),hh!==null&&a0(hh,t),kw.forEach(e),Pw.forEach(e),r=0;r<ju.length;r++)n=ju[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ju.length&&(r=ju[0],r.blockedOn===null);)R5(r),r.blockedOn===null&&ju.shift()}var Vm=Zc.ReactCurrentBatchConfig,vb=!0;function Dte(t,e,r,n){var i=cr,s=Vm.transition;Vm.transition=null;try{cr=1,U2(t,e,r,n)}finally{cr=i,Vm.transition=s}}function Fte(t,e,r,n){var i=cr,s=Vm.transition;Vm.transition=null;try{cr=4,U2(t,e,r,n)}finally{cr=i,Vm.transition=s}}function U2(t,e,r,n){if(vb){var i=GI(t,e,r,n);if(i===null)AT(t,e,n,wb,r),e4(t,n);else if(Mte(i,t,e,r,n))n.stopPropagation();else if(e4(t,n),e&4&&-1<Ote.indexOf(t)){for(;i!==null;){var s=By(i);if(s!==null&&x5(s),s=GI(t,e,r,n),s===null&&AT(t,e,n,wb,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else AT(t,e,n,null,r)}}var wb=null;function GI(t,e,r,n){if(wb=null,t=B2(n),t=Gf(t),t!==null)if(e=jd(t),e===null)t=null;else if(r=e.tag,r===13){if(t=g5(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return wb=t,null}function T5(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bte()){case V2:return 1;case w5:return 4;case mb:case _te:return 16;case y5:return 536870912;default:return 16}default:return 16}}var Ku=null,z2=null,vx=null;function k5(){if(vx)return vx;var t,e=z2,r=e.length,n,i="value"in Ku?Ku.value:Ku.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return vx=i.slice(t,1<n?1-n:void 0)}function wx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function X1(){return!0}function r4(){return!1}function uo(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?X1:r4,this.isPropagationStopped=r4,this}return Kr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=X1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=X1)},persist:function(){},isPersistent:X1}),e}var Ap={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},G2=uo(Ap),$y=Kr({},Ap,{view:0,detail:0}),Hte=uo($y),ST,xT,l0,gE=Kr({},$y,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Y2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==l0&&(l0&&t.type==="mousemove"?(ST=t.screenX-l0.screenX,xT=t.screenY-l0.screenY):xT=ST=0,l0=t),ST)},movementY:function(t){return"movementY"in t?t.movementY:xT}}),n4=uo(gE),Lte=Kr({},gE,{dataTransfer:0}),$te=uo(Lte),Bte=Kr({},$y,{relatedTarget:0}),bT=uo(Bte),Vte=Kr({},Ap,{animationName:0,elapsedTime:0,pseudoElement:0}),Wte=uo(Vte),jte=Kr({},Ap,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ute=uo(jte),zte=Kr({},Ap,{data:0}),i4=uo(zte),Gte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kte={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xte(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Kte[t])?!!e[t]:!1}function Y2(){return Xte}var qte=Kr({},$y,{key:function(t){if(t.key){var e=Gte[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=wx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Yte[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Y2,charCode:function(t){return t.type==="keypress"?wx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?wx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Jte=uo(qte),Qte=Kr({},gE,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s4=uo(Qte),Zte=Kr({},$y,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Y2}),ere=uo(Zte),tre=Kr({},Ap,{propertyName:0,elapsedTime:0,pseudoElement:0}),rre=uo(tre),nre=Kr({},gE,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ire=uo(nre),sre=[9,13,27,32],K2=Vc&&"CompositionEvent"in window,Hv=null;Vc&&"documentMode"in document&&(Hv=document.documentMode);var ore=Vc&&"TextEvent"in window&&!Hv,P5=Vc&&(!K2||Hv&&8<Hv&&11>=Hv),o4=" ",a4=!1;function A5(t,e){switch(t){case"keyup":return sre.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mm=!1;function are(t,e){switch(t){case"compositionend":return I5(e);case"keypress":return e.which!==32?null:(a4=!0,o4);case"textInput":return t=e.data,t===o4&&a4?null:t;default:return null}}function lre(t,e){if(mm)return t==="compositionend"||!K2&&A5(t,e)?(t=k5(),vx=z2=Ku=null,mm=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return P5&&e.locale!=="ko"?null:e.data;default:return null}}var cre={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function l4(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!cre[t.type]:e==="textarea"}function O5(t,e,r,n){c5(n),e=yb(e,"onChange"),0<e.length&&(r=new G2("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Lv=null,Iw=null;function ure(t){j5(t,0)}function mE(t){var e=wm(t);if(r5(e))return t}function hre(t,e){if(t==="change")return e}var M5=!1;if(Vc){var _T;if(Vc){var ET="oninput"in document;if(!ET){var c4=document.createElement("div");c4.setAttribute("oninput","return;"),ET=typeof c4.oninput=="function"}_T=ET}else _T=!1;M5=_T&&(!document.documentMode||9<document.documentMode)}function u4(){Lv&&(Lv.detachEvent("onpropertychange",N5),Iw=Lv=null)}function N5(t){if(t.propertyName==="value"&&mE(Iw)){var e=[];O5(e,Iw,t,B2(t)),d5(ure,e)}}function fre(t,e,r){t==="focusin"?(u4(),Lv=e,Iw=r,Lv.attachEvent("onpropertychange",N5)):t==="focusout"&&u4()}function dre(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mE(Iw)}function gre(t,e){if(t==="click")return mE(e)}function mre(t,e){if(t==="input"||t==="change")return mE(e)}function pre(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Fa=typeof Object.is=="function"?Object.is:pre;function Ow(t,e){if(Fa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!kI.call(e,i)||!Fa(t[i],e[i]))return!1}return!0}function h4(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function f4(t,e){var r=h4(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=h4(r)}}function D5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?D5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function F5(){for(var t=window,e=fb();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=fb(t.document)}return e}function X2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function vre(t){var e=F5(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&D5(r.ownerDocument.documentElement,r)){if(n!==null&&X2(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=f4(r,s);var o=f4(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wre=Vc&&"documentMode"in document&&11>=document.documentMode,pm=null,YI=null,$v=null,KI=!1;function d4(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;KI||pm==null||pm!==fb(n)||(n=pm,"selectionStart"in n&&X2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),$v&&Ow($v,n)||($v=n,n=yb(YI,"onSelect"),0<n.length&&(e=new G2("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=pm)))}function q1(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var vm={animationend:q1("Animation","AnimationEnd"),animationiteration:q1("Animation","AnimationIteration"),animationstart:q1("Animation","AnimationStart"),transitionend:q1("Transition","TransitionEnd")},RT={},H5={};Vc&&(H5=document.createElement("div").style,"AnimationEvent"in window||(delete vm.animationend.animation,delete vm.animationiteration.animation,delete vm.animationstart.animation),"TransitionEvent"in window||delete vm.transitionend.transition);function pE(t){if(RT[t])return RT[t];if(!vm[t])return t;var e=vm[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in H5)return RT[t]=e[r];return t}var L5=pE("animationend"),$5=pE("animationiteration"),B5=pE("animationstart"),V5=pE("transitionend"),W5=new Map,g4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mh(t,e){W5.set(t,e),Wd(e,[t])}for(var TT=0;TT<g4.length;TT++){var kT=g4[TT],yre=kT.toLowerCase(),Cre=kT[0].toUpperCase()+kT.slice(1);Mh(yre,"on"+Cre)}Mh(L5,"onAnimationEnd");Mh($5,"onAnimationIteration");Mh(B5,"onAnimationStart");Mh("dblclick","onDoubleClick");Mh("focusin","onFocus");Mh("focusout","onBlur");Mh(V5,"onTransitionEnd");np("onMouseEnter",["mouseout","mouseover"]);np("onMouseLeave",["mouseout","mouseover"]);np("onPointerEnter",["pointerout","pointerover"]);np("onPointerLeave",["pointerout","pointerover"]);Wd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sre=new Set("cancel close invalid load scroll toggle".split(" ").concat(xv));function m4(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,yte(n,e,void 0,t),t.currentTarget=null}function j5(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;m4(i,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;m4(i,a,c),s=l}}}if(gb)throw t=jI,gb=!1,jI=null,t}function Er(t,e){var r=e[ZI];r===void 0&&(r=e[ZI]=new Set);var n=t+"__bubble";r.has(n)||(U5(e,t,2,!1),r.add(n))}function PT(t,e,r){var n=0;e&&(n|=4),U5(r,t,n,e)}var J1="_reactListening"+Math.random().toString(36).slice(2);function Mw(t){if(!t[J1]){t[J1]=!0,JU.forEach(function(r){r!=="selectionchange"&&(Sre.has(r)||PT(r,!1,t),PT(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[J1]||(e[J1]=!0,PT("selectionchange",!1,e))}}function U5(t,e,r,n){switch(T5(e)){case 1:var i=Dte;break;case 4:i=Fte;break;default:i=U2}r=i.bind(null,e,r,t),i=void 0,!WI||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function AT(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Gf(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}d5(function(){var c=s,u=B2(r),h=[];e:{var f=W5.get(t);if(f!==void 0){var d=G2,g=t;switch(t){case"keypress":if(wx(r)===0)break e;case"keydown":case"keyup":d=Jte;break;case"focusin":g="focus",d=bT;break;case"focusout":g="blur",d=bT;break;case"beforeblur":case"afterblur":d=bT;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=n4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=$te;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=ere;break;case L5:case $5:case B5:d=Wte;break;case V5:d=rre;break;case"scroll":d=Hte;break;case"wheel":d=ire;break;case"copy":case"cut":case"paste":d=Ute;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=s4}var m=(e&4)!==0,p=!m&&t==="scroll",w=m?f!==null?f+"Capture":null:f;m=[];for(var v=c,y;v!==null;){y=v;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,w!==null&&(b=Tw(v,w),b!=null&&m.push(Nw(v,b,y)))),p)break;v=v.return}0<m.length&&(f=new d(f,g,null,r,u),h.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",f&&r!==BI&&(g=r.relatedTarget||r.fromElement)&&(Gf(g)||g[Wc]))break e;if((d||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,d?(g=r.relatedTarget||r.toElement,d=c,g=g?Gf(g):null,g!==null&&(p=jd(g),g!==p||g.tag!==5&&g.tag!==6)&&(g=null)):(d=null,g=c),d!==g)){if(m=n4,b="onMouseLeave",w="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=s4,b="onPointerLeave",w="onPointerEnter",v="pointer"),p=d==null?f:wm(d),y=g==null?f:wm(g),f=new m(b,v+"leave",d,r,u),f.target=p,f.relatedTarget=y,b=null,Gf(u)===c&&(m=new m(w,v+"enter",g,r,u),m.target=y,m.relatedTarget=p,b=m),p=b,d&&g)t:{for(m=d,w=g,v=0,y=m;y;y=ug(y))v++;for(y=0,b=w;b;b=ug(b))y++;for(;0<v-y;)m=ug(m),v--;for(;0<y-v;)w=ug(w),y--;for(;v--;){if(m===w||w!==null&&m===w.alternate)break t;m=ug(m),w=ug(w)}m=null}else m=null;d!==null&&p4(h,f,d,m,!1),g!==null&&p!==null&&p4(h,p,g,m,!0)}}e:{if(f=c?wm(c):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var T=hre;else if(l4(f))if(M5)T=mre;else{T=dre;var E=fre}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=gre);if(T&&(T=T(t,c))){O5(h,T,r,u);break e}E&&E(t,f,c),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&DI(f,"number",f.value)}switch(E=c?wm(c):window,t){case"focusin":(l4(E)||E.contentEditable==="true")&&(pm=E,YI=c,$v=null);break;case"focusout":$v=YI=pm=null;break;case"mousedown":KI=!0;break;case"contextmenu":case"mouseup":case"dragend":KI=!1,d4(h,r,u);break;case"selectionchange":if(wre)break;case"keydown":case"keyup":d4(h,r,u)}var x;if(K2)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else mm?A5(t,r)&&(P="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(P5&&r.locale!=="ko"&&(mm||P!=="onCompositionStart"?P==="onCompositionEnd"&&mm&&(x=k5()):(Ku=u,z2="value"in Ku?Ku.value:Ku.textContent,mm=!0)),E=yb(c,P),0<E.length&&(P=new i4(P,t,null,r,u),h.push({event:P,listeners:E}),x?P.data=x:(x=I5(r),x!==null&&(P.data=x)))),(x=ore?are(t,r):lre(t,r))&&(c=yb(c,"onBeforeInput"),0<c.length&&(u=new i4("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=x))}j5(h,e)})}function Nw(t,e,r){return{instance:t,listener:e,currentTarget:r}}function yb(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Tw(t,r),s!=null&&n.unshift(Nw(t,s,i)),s=Tw(t,e),s!=null&&n.push(Nw(t,s,i))),t=t.return}return n}function ug(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function p4(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,i?(l=Tw(r,s),l!=null&&o.unshift(Nw(r,l,a))):i||(l=Tw(r,s),l!=null&&o.push(Nw(r,l,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var xre=/\r\n?/g,bre=/\u0000|\uFFFD/g;function v4(t){return(typeof t=="string"?t:""+t).replace(xre,`
`).replace(bre,"")}function Q1(t,e,r){if(e=v4(e),v4(t)!==e&&r)throw Error(Te(425))}function Cb(){}var XI=null,qI=null;function JI(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var QI=typeof setTimeout=="function"?setTimeout:void 0,_re=typeof clearTimeout=="function"?clearTimeout:void 0,w4=typeof Promise=="function"?Promise:void 0,Ere=typeof queueMicrotask=="function"?queueMicrotask:typeof w4<"u"?function(t){return w4.resolve(null).then(t).catch(Rre)}:QI;function Rre(t){setTimeout(function(){throw t})}function IT(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Aw(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Aw(e)}function fh(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function y4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ip=Math.random().toString(36).slice(2),_l="__reactFiber$"+Ip,Dw="__reactProps$"+Ip,Wc="__reactContainer$"+Ip,ZI="__reactEvents$"+Ip,Tre="__reactListeners$"+Ip,kre="__reactHandles$"+Ip;function Gf(t){var e=t[_l];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Wc]||r[_l]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=y4(t);t!==null;){if(r=t[_l])return r;t=y4(t)}return e}t=r,r=t.parentNode}return null}function By(t){return t=t[_l]||t[Wc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wm(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Te(33))}function vE(t){return t[Dw]||null}var eO=[],ym=-1;function Nh(t){return{current:t}}function Tr(t){0>ym||(t.current=eO[ym],eO[ym]=null,ym--)}function xr(t,e){ym++,eO[ym]=t.current,t.current=e}var _h={},Ni=Nh(_h),Rs=Nh(!1),md=_h;function ip(t,e){var r=t.type.contextTypes;if(!r)return _h;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ts(t){return t=t.childContextTypes,t!=null}function Sb(){Tr(Rs),Tr(Ni)}function C4(t,e,r){if(Ni.current!==_h)throw Error(Te(168));xr(Ni,e),xr(Rs,r)}function z5(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Te(108,fte(t)||"Unknown",i));return Kr({},r,n)}function xb(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_h,md=Ni.current,xr(Ni,t),xr(Rs,Rs.current),!0}function S4(t,e,r){var n=t.stateNode;if(!n)throw Error(Te(169));r?(t=z5(t,e,md),n.__reactInternalMemoizedMergedChildContext=t,Tr(Rs),Tr(Ni),xr(Ni,t)):Tr(Rs),xr(Rs,r)}var yc=null,wE=!1,OT=!1;function G5(t){yc===null?yc=[t]:yc.push(t)}function Pre(t){wE=!0,G5(t)}function Dh(){if(!OT&&yc!==null){OT=!0;var t=0,e=cr;try{var r=yc;for(cr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}yc=null,wE=!1}catch(i){throw yc!==null&&(yc=yc.slice(t+1)),v5(V2,Dh),i}finally{cr=e,OT=!1}}return null}var Cm=[],Sm=0,bb=null,_b=0,No=[],Do=0,pd=null,Sc=1,xc="";function Df(t,e){Cm[Sm++]=_b,Cm[Sm++]=bb,bb=t,_b=e}function Y5(t,e,r){No[Do++]=Sc,No[Do++]=xc,No[Do++]=pd,pd=t;var n=Sc;t=xc;var i=32-Aa(n)-1;n&=~(1<<i),r+=1;var s=32-Aa(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Sc=1<<32-Aa(e)+i|r<<i|n,xc=s+t}else Sc=1<<s|r<<i|n,xc=t}function q2(t){t.return!==null&&(Df(t,1),Y5(t,1,0))}function J2(t){for(;t===bb;)bb=Cm[--Sm],Cm[Sm]=null,_b=Cm[--Sm],Cm[Sm]=null;for(;t===pd;)pd=No[--Do],No[Do]=null,xc=No[--Do],No[Do]=null,Sc=No[--Do],No[Do]=null}var to=null,Qs=null,Nr=!1,ba=null;function K5(t,e){var r=$o(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function x4(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,to=t,Qs=fh(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,to=t,Qs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=pd!==null?{id:Sc,overflow:xc}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=$o(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,to=t,Qs=null,!0):!1;default:return!1}}function tO(t){return(t.mode&1)!==0&&(t.flags&128)===0}function rO(t){if(Nr){var e=Qs;if(e){var r=e;if(!x4(t,e)){if(tO(t))throw Error(Te(418));e=fh(r.nextSibling);var n=to;e&&x4(t,e)?K5(n,r):(t.flags=t.flags&-4097|2,Nr=!1,to=t)}}else{if(tO(t))throw Error(Te(418));t.flags=t.flags&-4097|2,Nr=!1,to=t}}}function b4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;to=t}function Z1(t){if(t!==to)return!1;if(!Nr)return b4(t),Nr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!JI(t.type,t.memoizedProps)),e&&(e=Qs)){if(tO(t))throw X5(),Error(Te(418));for(;e;)K5(t,e),e=fh(e.nextSibling)}if(b4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Qs=fh(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Qs=null}}else Qs=to?fh(t.stateNode.nextSibling):null;return!0}function X5(){for(var t=Qs;t;)t=fh(t.nextSibling)}function sp(){Qs=to=null,Nr=!1}function Q2(t){ba===null?ba=[t]:ba.push(t)}var Are=Zc.ReactCurrentBatchConfig;function c0(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Te(309));var n=r.stateNode}if(!n)throw Error(Te(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Te(284));if(!r._owner)throw Error(Te(290,t))}return t}function eC(t,e){throw t=Object.prototype.toString.call(e),Error(Te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _4(t){var e=t._init;return e(t._payload)}function q5(t){function e(w,v){if(t){var y=w.deletions;y===null?(w.deletions=[v],w.flags|=16):y.push(v)}}function r(w,v){if(!t)return null;for(;v!==null;)e(w,v),v=v.sibling;return null}function n(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function i(w,v){return w=ph(w,v),w.index=0,w.sibling=null,w}function s(w,v,y){return w.index=y,t?(y=w.alternate,y!==null?(y=y.index,y<v?(w.flags|=2,v):y):(w.flags|=2,v)):(w.flags|=1048576,v)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,v,y,b){return v===null||v.tag!==6?(v=$T(y,w.mode,b),v.return=w,v):(v=i(v,y),v.return=w,v)}function l(w,v,y,b){var T=y.type;return T===gm?u(w,v,y.props.children,b,y.key):v!==null&&(v.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Fu&&_4(T)===v.type)?(b=i(v,y.props),b.ref=c0(w,v,y),b.return=w,b):(b=Ex(y.type,y.key,y.props,null,w.mode,b),b.ref=c0(w,v,y),b.return=w,b)}function c(w,v,y,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=BT(y,w.mode,b),v.return=w,v):(v=i(v,y.children||[]),v.return=w,v)}function u(w,v,y,b,T){return v===null||v.tag!==7?(v=sd(y,w.mode,b,T),v.return=w,v):(v=i(v,y),v.return=w,v)}function h(w,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=$T(""+v,w.mode,y),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case j1:return y=Ex(v.type,v.key,v.props,null,w.mode,y),y.ref=c0(w,null,v),y.return=w,y;case dm:return v=BT(v,w.mode,y),v.return=w,v;case Fu:var b=v._init;return h(w,b(v._payload),y)}if(Cv(v)||i0(v))return v=sd(v,w.mode,y,null),v.return=w,v;eC(w,v)}return null}function f(w,v,y,b){var T=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return T!==null?null:a(w,v,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case j1:return y.key===T?l(w,v,y,b):null;case dm:return y.key===T?c(w,v,y,b):null;case Fu:return T=y._init,f(w,v,T(y._payload),b)}if(Cv(y)||i0(y))return T!==null?null:u(w,v,y,b,null);eC(w,y)}return null}function d(w,v,y,b,T){if(typeof b=="string"&&b!==""||typeof b=="number")return w=w.get(y)||null,a(v,w,""+b,T);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case j1:return w=w.get(b.key===null?y:b.key)||null,l(v,w,b,T);case dm:return w=w.get(b.key===null?y:b.key)||null,c(v,w,b,T);case Fu:var E=b._init;return d(w,v,y,E(b._payload),T)}if(Cv(b)||i0(b))return w=w.get(y)||null,u(v,w,b,T,null);eC(v,b)}return null}function g(w,v,y,b){for(var T=null,E=null,x=v,P=v=0,A=null;x!==null&&P<y.length;P++){x.index>P?(A=x,x=null):A=x.sibling;var O=f(w,x,y[P],b);if(O===null){x===null&&(x=A);break}t&&x&&O.alternate===null&&e(w,x),v=s(O,v,P),E===null?T=O:E.sibling=O,E=O,x=A}if(P===y.length)return r(w,x),Nr&&Df(w,P),T;if(x===null){for(;P<y.length;P++)x=h(w,y[P],b),x!==null&&(v=s(x,v,P),E===null?T=x:E.sibling=x,E=x);return Nr&&Df(w,P),T}for(x=n(w,x);P<y.length;P++)A=d(x,w,P,y[P],b),A!==null&&(t&&A.alternate!==null&&x.delete(A.key===null?P:A.key),v=s(A,v,P),E===null?T=A:E.sibling=A,E=A);return t&&x.forEach(function(Y){return e(w,Y)}),Nr&&Df(w,P),T}function m(w,v,y,b){var T=i0(y);if(typeof T!="function")throw Error(Te(150));if(y=T.call(y),y==null)throw Error(Te(151));for(var E=T=null,x=v,P=v=0,A=null,O=y.next();x!==null&&!O.done;P++,O=y.next()){x.index>P?(A=x,x=null):A=x.sibling;var Y=f(w,x,O.value,b);if(Y===null){x===null&&(x=A);break}t&&x&&Y.alternate===null&&e(w,x),v=s(Y,v,P),E===null?T=Y:E.sibling=Y,E=Y,x=A}if(O.done)return r(w,x),Nr&&Df(w,P),T;if(x===null){for(;!O.done;P++,O=y.next())O=h(w,O.value,b),O!==null&&(v=s(O,v,P),E===null?T=O:E.sibling=O,E=O);return Nr&&Df(w,P),T}for(x=n(w,x);!O.done;P++,O=y.next())O=d(x,w,P,O.value,b),O!==null&&(t&&O.alternate!==null&&x.delete(O.key===null?P:O.key),v=s(O,v,P),E===null?T=O:E.sibling=O,E=O);return t&&x.forEach(function(B){return e(w,B)}),Nr&&Df(w,P),T}function p(w,v,y,b){if(typeof y=="object"&&y!==null&&y.type===gm&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case j1:e:{for(var T=y.key,E=v;E!==null;){if(E.key===T){if(T=y.type,T===gm){if(E.tag===7){r(w,E.sibling),v=i(E,y.props.children),v.return=w,w=v;break e}}else if(E.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Fu&&_4(T)===E.type){r(w,E.sibling),v=i(E,y.props),v.ref=c0(w,E,y),v.return=w,w=v;break e}r(w,E);break}else e(w,E);E=E.sibling}y.type===gm?(v=sd(y.props.children,w.mode,b,y.key),v.return=w,w=v):(b=Ex(y.type,y.key,y.props,null,w.mode,b),b.ref=c0(w,v,y),b.return=w,w=b)}return o(w);case dm:e:{for(E=y.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(w,v.sibling),v=i(v,y.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else e(w,v);v=v.sibling}v=BT(y,w.mode,b),v.return=w,w=v}return o(w);case Fu:return E=y._init,p(w,v,E(y._payload),b)}if(Cv(y))return g(w,v,y,b);if(i0(y))return m(w,v,y,b);eC(w,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(w,v.sibling),v=i(v,y),v.return=w,w=v):(r(w,v),v=$T(y,w.mode,b),v.return=w,w=v),o(w)):r(w,v)}return p}var op=q5(!0),J5=q5(!1),Eb=Nh(null),Rb=null,xm=null,Z2=null;function eN(){Z2=xm=Rb=null}function tN(t){var e=Eb.current;Tr(Eb),t._currentValue=e}function nO(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Wm(t,e){Rb=t,Z2=xm=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(_s=!0),t.firstContext=null)}function Uo(t){var e=t._currentValue;if(Z2!==t)if(t={context:t,memoizedValue:e,next:null},xm===null){if(Rb===null)throw Error(Te(308));xm=t,Rb.dependencies={lanes:0,firstContext:t}}else xm=xm.next=t;return e}var Yf=null;function rN(t){Yf===null?Yf=[t]:Yf.push(t)}function Q5(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,rN(e)):(r.next=i.next,i.next=r),e.interleaved=r,jc(t,n)}function jc(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Hu=!1;function nN(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Z5(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function dh(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,jt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,jc(t,r)}return i=n.interleaved,i===null?(e.next=e,rN(n)):(e.next=i.next,i.next=e),n.interleaved=e,jc(t,r)}function yx(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,W2(t,r)}}function E4(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Tb(t,e,r,n){var i=t.updateQueue;Hu=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,u=c=l=null,a=s;do{var f=a.lane,d=a.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,m=a;switch(f=e,d=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(d,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,f=typeof g=="function"?g.call(d,h,f):g,f==null)break e;h=Kr({},h,f);break e;case 2:Hu=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else d={eventTime:d,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=d,l=h):u=u.next=d,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);wd|=o,t.lanes=o,t.memoizedState=h}}function R4(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Te(191,i));i.call(n)}}}var Vy={},Ml=Nh(Vy),Fw=Nh(Vy),Hw=Nh(Vy);function Kf(t){if(t===Vy)throw Error(Te(174));return t}function iN(t,e){switch(xr(Hw,e),xr(Fw,t),xr(Ml,Vy),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:HI(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=HI(e,t)}Tr(Ml),xr(Ml,e)}function ap(){Tr(Ml),Tr(Fw),Tr(Hw)}function ez(t){Kf(Hw.current);var e=Kf(Ml.current),r=HI(e,t.type);e!==r&&(xr(Fw,t),xr(Ml,r))}function sN(t){Fw.current===t&&(Tr(Ml),Tr(Fw))}var Wr=Nh(0);function kb(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var MT=[];function oN(){for(var t=0;t<MT.length;t++)MT[t]._workInProgressVersionPrimary=null;MT.length=0}var Cx=Zc.ReactCurrentDispatcher,NT=Zc.ReactCurrentBatchConfig,vd=0,Gr=null,$n=null,Kn=null,Pb=!1,Bv=!1,Lw=0,Ire=0;function di(){throw Error(Te(321))}function aN(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Fa(t[r],e[r]))return!1;return!0}function lN(t,e,r,n,i,s){if(vd=s,Gr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Cx.current=t===null||t.memoizedState===null?Dre:Fre,t=r(n,i),Bv){s=0;do{if(Bv=!1,Lw=0,25<=s)throw Error(Te(301));s+=1,Kn=$n=null,e.updateQueue=null,Cx.current=Hre,t=r(n,i)}while(Bv)}if(Cx.current=Ab,e=$n!==null&&$n.next!==null,vd=0,Kn=$n=Gr=null,Pb=!1,e)throw Error(Te(300));return t}function cN(){var t=Lw!==0;return Lw=0,t}function vl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?Gr.memoizedState=Kn=t:Kn=Kn.next=t,Kn}function zo(){if($n===null){var t=Gr.alternate;t=t!==null?t.memoizedState:null}else t=$n.next;var e=Kn===null?Gr.memoizedState:Kn.next;if(e!==null)Kn=e,$n=t;else{if(t===null)throw Error(Te(310));$n=t,t={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},Kn===null?Gr.memoizedState=Kn=t:Kn=Kn.next=t}return Kn}function $w(t,e){return typeof e=="function"?e(t):e}function DT(t){var e=zo(),r=e.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=t;var n=$n,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((vd&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,Gr.lanes|=u,wd|=u}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,Fa(n,e.memoizedState)||(_s=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Gr.lanes|=s,wd|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function FT(t){var e=zo(),r=e.queue;if(r===null)throw Error(Te(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Fa(s,e.memoizedState)||(_s=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function tz(){}function rz(t,e){var r=Gr,n=zo(),i=e(),s=!Fa(n.memoizedState,i);if(s&&(n.memoizedState=i,_s=!0),n=n.queue,uN(sz.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Kn!==null&&Kn.memoizedState.tag&1){if(r.flags|=2048,Bw(9,iz.bind(null,r,n,i,e),void 0,null),Zn===null)throw Error(Te(349));vd&30||nz(r,e,i)}return i}function nz(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function iz(t,e,r,n){e.value=r,e.getSnapshot=n,oz(e)&&az(t)}function sz(t,e,r){return r(function(){oz(e)&&az(t)})}function oz(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Fa(t,r)}catch{return!0}}function az(t){var e=jc(t,1);e!==null&&Ia(e,t,1,-1)}function T4(t){var e=vl();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$w,lastRenderedState:t},e.queue=t,t=t.dispatch=Nre.bind(null,Gr,t),[e.memoizedState,t]}function Bw(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Gr.updateQueue,e===null?(e={lastEffect:null,stores:null},Gr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function lz(){return zo().memoizedState}function Sx(t,e,r,n){var i=vl();Gr.flags|=t,i.memoizedState=Bw(1|e,r,void 0,n===void 0?null:n)}function yE(t,e,r,n){var i=zo();n=n===void 0?null:n;var s=void 0;if($n!==null){var o=$n.memoizedState;if(s=o.destroy,n!==null&&aN(n,o.deps)){i.memoizedState=Bw(e,r,s,n);return}}Gr.flags|=t,i.memoizedState=Bw(1|e,r,s,n)}function k4(t,e){return Sx(8390656,8,t,e)}function uN(t,e){return yE(2048,8,t,e)}function cz(t,e){return yE(4,2,t,e)}function uz(t,e){return yE(4,4,t,e)}function hz(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fz(t,e,r){return r=r!=null?r.concat([t]):null,yE(4,4,hz.bind(null,e,t),r)}function hN(){}function dz(t,e){var r=zo();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&aN(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function gz(t,e){var r=zo();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&aN(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function mz(t,e,r){return vd&21?(Fa(r,e)||(r=C5(),Gr.lanes|=r,wd|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_s=!0),t.memoizedState=r)}function Ore(t,e){var r=cr;cr=r!==0&&4>r?r:4,t(!0);var n=NT.transition;NT.transition={};try{t(!1),e()}finally{cr=r,NT.transition=n}}function pz(){return zo().memoizedState}function Mre(t,e,r){var n=mh(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},vz(t))wz(e,r);else if(r=Q5(t,e,r,n),r!==null){var i=Zi();Ia(r,t,n,i),yz(r,e,n)}}function Nre(t,e,r){var n=mh(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(vz(t))wz(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,Fa(a,o)){var l=e.interleaved;l===null?(i.next=i,rN(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Q5(t,e,i,n),r!==null&&(i=Zi(),Ia(r,t,n,i),yz(r,e,n))}}function vz(t){var e=t.alternate;return t===Gr||e!==null&&e===Gr}function wz(t,e){Bv=Pb=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function yz(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,W2(t,r)}}var Ab={readContext:Uo,useCallback:di,useContext:di,useEffect:di,useImperativeHandle:di,useInsertionEffect:di,useLayoutEffect:di,useMemo:di,useReducer:di,useRef:di,useState:di,useDebugValue:di,useDeferredValue:di,useTransition:di,useMutableSource:di,useSyncExternalStore:di,useId:di,unstable_isNewReconciler:!1},Dre={readContext:Uo,useCallback:function(t,e){return vl().memoizedState=[t,e===void 0?null:e],t},useContext:Uo,useEffect:k4,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Sx(4194308,4,hz.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Sx(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sx(4,2,t,e)},useMemo:function(t,e){var r=vl();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=vl();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Mre.bind(null,Gr,t),[n.memoizedState,t]},useRef:function(t){var e=vl();return t={current:t},e.memoizedState=t},useState:T4,useDebugValue:hN,useDeferredValue:function(t){return vl().memoizedState=t},useTransition:function(){var t=T4(!1),e=t[0];return t=Ore.bind(null,t[1]),vl().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Gr,i=vl();if(Nr){if(r===void 0)throw Error(Te(407));r=r()}else{if(r=e(),Zn===null)throw Error(Te(349));vd&30||nz(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,k4(sz.bind(null,n,s,t),[t]),n.flags|=2048,Bw(9,iz.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=vl(),e=Zn.identifierPrefix;if(Nr){var r=xc,n=Sc;r=(n&~(1<<32-Aa(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Lw++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Ire++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Fre={readContext:Uo,useCallback:dz,useContext:Uo,useEffect:uN,useImperativeHandle:fz,useInsertionEffect:cz,useLayoutEffect:uz,useMemo:gz,useReducer:DT,useRef:lz,useState:function(){return DT($w)},useDebugValue:hN,useDeferredValue:function(t){var e=zo();return mz(e,$n.memoizedState,t)},useTransition:function(){var t=DT($w)[0],e=zo().memoizedState;return[t,e]},useMutableSource:tz,useSyncExternalStore:rz,useId:pz,unstable_isNewReconciler:!1},Hre={readContext:Uo,useCallback:dz,useContext:Uo,useEffect:uN,useImperativeHandle:fz,useInsertionEffect:cz,useLayoutEffect:uz,useMemo:gz,useReducer:FT,useRef:lz,useState:function(){return FT($w)},useDebugValue:hN,useDeferredValue:function(t){var e=zo();return $n===null?e.memoizedState=t:mz(e,$n.memoizedState,t)},useTransition:function(){var t=FT($w)[0],e=zo().memoizedState;return[t,e]},useMutableSource:tz,useSyncExternalStore:rz,useId:pz,unstable_isNewReconciler:!1};function ya(t,e){if(t&&t.defaultProps){e=Kr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function iO(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Kr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var CE={isMounted:function(t){return(t=t._reactInternals)?jd(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Zi(),i=mh(t),s=Mc(n,i);s.payload=e,r!=null&&(s.callback=r),e=dh(t,s,i),e!==null&&(Ia(e,t,i,n),yx(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Zi(),i=mh(t),s=Mc(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=dh(t,s,i),e!==null&&(Ia(e,t,i,n),yx(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Zi(),n=mh(t),i=Mc(r,n);i.tag=2,e!=null&&(i.callback=e),e=dh(t,i,n),e!==null&&(Ia(e,t,n,r),yx(e,t,n))}};function P4(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ow(r,n)||!Ow(i,s):!0}function Cz(t,e,r){var n=!1,i=_h,s=e.contextType;return typeof s=="object"&&s!==null?s=Uo(s):(i=Ts(e)?md:Ni.current,n=e.contextTypes,s=(n=n!=null)?ip(t,i):_h),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=CE,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function A4(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&CE.enqueueReplaceState(e,e.state,null)}function sO(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},nN(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Uo(s):(s=Ts(e)?md:Ni.current,i.context=ip(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(iO(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&CE.enqueueReplaceState(i,i.state,null),Tb(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function lp(t,e){try{var r="",n=e;do r+=hte(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function HT(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function oO(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Lre=typeof WeakMap=="function"?WeakMap:Map;function Sz(t,e,r){r=Mc(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ob||(Ob=!0,pO=n),oO(t,e)},r}function xz(t,e,r){r=Mc(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){oO(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){oO(t,e),typeof n!="function"&&(gh===null?gh=new Set([this]):gh.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function I4(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Lre;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=Qre.bind(null,t,e,r),e.then(t,t))}function O4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function M4(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Mc(-1,1),e.tag=2,dh(r,e,1))),r.lanes|=1),t)}var $re=Zc.ReactCurrentOwner,_s=!1;function zi(t,e,r,n){e.child=t===null?J5(e,null,r,n):op(e,t.child,r,n)}function N4(t,e,r,n,i){r=r.render;var s=e.ref;return Wm(e,i),n=lN(t,e,r,n,s,i),r=cN(),t!==null&&!_s?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Uc(t,e,i)):(Nr&&r&&q2(e),e.flags|=1,zi(t,e,n,i),e.child)}function D4(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!yN(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,bz(t,e,s,n,i)):(t=Ex(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ow,r(o,n)&&t.ref===e.ref)return Uc(t,e,i)}return e.flags|=1,t=ph(s,n),t.ref=e.ref,t.return=e,e.child=t}function bz(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Ow(s,n)&&t.ref===e.ref)if(_s=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(_s=!0);else return e.lanes=t.lanes,Uc(t,e,i)}return aO(t,e,r,n,i)}function _z(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(_m,Ys),Ys|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xr(_m,Ys),Ys|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,xr(_m,Ys),Ys|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,xr(_m,Ys),Ys|=n;return zi(t,e,i,r),e.child}function Ez(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function aO(t,e,r,n,i){var s=Ts(r)?md:Ni.current;return s=ip(e,s),Wm(e,i),r=lN(t,e,r,n,s,i),n=cN(),t!==null&&!_s?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Uc(t,e,i)):(Nr&&n&&q2(e),e.flags|=1,zi(t,e,r,i),e.child)}function F4(t,e,r,n,i){if(Ts(r)){var s=!0;xb(e)}else s=!1;if(Wm(e,i),e.stateNode===null)xx(t,e),Cz(e,r,n),sO(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=Uo(c):(c=Ts(r)?md:Ni.current,c=ip(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&A4(e,o,n,c),Hu=!1;var f=e.memoizedState;o.state=f,Tb(e,n,o,i),l=e.memoizedState,a!==n||f!==l||Rs.current||Hu?(typeof u=="function"&&(iO(e,r,u,n),l=e.memoizedState),(a=Hu||P4(e,r,a,n,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Z5(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ya(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=Uo(l):(l=Ts(r)?md:Ni.current,l=ip(e,l));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&A4(e,o,n,l),Hu=!1,f=e.memoizedState,o.state=f,Tb(e,n,o,i);var g=e.memoizedState;a!==h||f!==g||Rs.current||Hu?(typeof d=="function"&&(iO(e,r,d,n),g=e.memoizedState),(c=Hu||P4(e,r,c,n,f,g,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),o.props=n,o.state=g,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return lO(t,e,r,n,s,i)}function lO(t,e,r,n,i,s){Ez(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&S4(e,r,!1),Uc(t,e,s);n=e.stateNode,$re.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=op(e,t.child,null,s),e.child=op(e,null,a,s)):zi(t,e,a,s),e.memoizedState=n.state,i&&S4(e,r,!0),e.child}function Rz(t){var e=t.stateNode;e.pendingContext?C4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&C4(t,e.context,!1),iN(t,e.containerInfo)}function H4(t,e,r,n,i){return sp(),Q2(i),e.flags|=256,zi(t,e,r,n),e.child}var cO={dehydrated:null,treeContext:null,retryLane:0};function uO(t){return{baseLanes:t,cachePool:null,transitions:null}}function Tz(t,e,r){var n=e.pendingProps,i=Wr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),xr(Wr,i&1),t===null)return rO(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=bE(o,n,0,null),t=sd(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=uO(r),e.memoizedState=cO,t):fN(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Bre(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=ph(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ph(a,s):(s=sd(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?uO(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=cO,n}return s=t.child,t=s.sibling,n=ph(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function fN(t,e){return e=bE({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function tC(t,e,r,n){return n!==null&&Q2(n),op(e,t.child,null,r),t=fN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Bre(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=HT(Error(Te(422))),tC(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=bE({mode:"visible",children:n.children},i,0,null),s=sd(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&op(e,t.child,null,o),e.child.memoizedState=uO(o),e.memoizedState=cO,s);if(!(e.mode&1))return tC(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(Te(419)),n=HT(s,n,void 0),tC(t,e,o,n)}if(a=(o&t.childLanes)!==0,_s||a){if(n=Zn,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,jc(t,i),Ia(n,t,i,-1))}return wN(),n=HT(Error(Te(421))),tC(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Zre.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Qs=fh(i.nextSibling),to=e,Nr=!0,ba=null,t!==null&&(No[Do++]=Sc,No[Do++]=xc,No[Do++]=pd,Sc=t.id,xc=t.overflow,pd=e),e=fN(e,n.children),e.flags|=4096,e)}function L4(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),nO(t.return,e,r)}function LT(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function kz(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(zi(t,e,n.children,r),n=Wr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&L4(t,r,e);else if(t.tag===19)L4(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(xr(Wr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&kb(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),LT(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&kb(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}LT(e,!0,r,null,s);break;case"together":LT(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Uc(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),wd|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Te(153));if(e.child!==null){for(t=e.child,r=ph(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ph(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Vre(t,e,r){switch(e.tag){case 3:Rz(e),sp();break;case 5:ez(e);break;case 1:Ts(e.type)&&xb(e);break;case 4:iN(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;xr(Eb,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(xr(Wr,Wr.current&1),e.flags|=128,null):r&e.child.childLanes?Tz(t,e,r):(xr(Wr,Wr.current&1),t=Uc(t,e,r),t!==null?t.sibling:null);xr(Wr,Wr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return kz(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xr(Wr,Wr.current),n)break;return null;case 22:case 23:return e.lanes=0,_z(t,e,r)}return Uc(t,e,r)}var Pz,hO,Az,Iz;Pz=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};hO=function(){};Az=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Kf(Ml.current);var s=null;switch(r){case"input":i=MI(t,i),n=MI(t,n),s=[];break;case"select":i=Kr({},i,{value:void 0}),n=Kr({},n,{value:void 0}),s=[];break;case"textarea":i=FI(t,i),n=FI(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Cb)}LI(r,n);var o;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ew.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ew.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Er("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Iz=function(t,e,r,n){r!==n&&(e.flags|=4)};function u0(t,e){if(!Nr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function gi(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Wre(t,e,r){var n=e.pendingProps;switch(J2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gi(e),null;case 1:return Ts(e.type)&&Sb(),gi(e),null;case 3:return n=e.stateNode,ap(),Tr(Rs),Tr(Ni),oN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Z1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ba!==null&&(yO(ba),ba=null))),hO(t,e),gi(e),null;case 5:sN(e);var i=Kf(Hw.current);if(r=e.type,t!==null&&e.stateNode!=null)Az(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Te(166));return gi(e),null}if(t=Kf(Ml.current),Z1(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[_l]=e,n[Dw]=s,t=(e.mode&1)!==0,r){case"dialog":Er("cancel",n),Er("close",n);break;case"iframe":case"object":case"embed":Er("load",n);break;case"video":case"audio":for(i=0;i<xv.length;i++)Er(xv[i],n);break;case"source":Er("error",n);break;case"img":case"image":case"link":Er("error",n),Er("load",n);break;case"details":Er("toggle",n);break;case"input":Y$(n,s),Er("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Er("invalid",n);break;case"textarea":X$(n,s),Er("invalid",n)}LI(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&Q1(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Q1(n.textContent,a,t),i=["children",""+a]):Ew.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Er("scroll",n)}switch(r){case"input":U1(n),K$(n,s,!0);break;case"textarea":U1(n),q$(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Cb)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=s5(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[_l]=e,t[Dw]=n,Pz(t,e,!1,!1),e.stateNode=t;e:{switch(o=$I(r,n),r){case"dialog":Er("cancel",t),Er("close",t),i=n;break;case"iframe":case"object":case"embed":Er("load",t),i=n;break;case"video":case"audio":for(i=0;i<xv.length;i++)Er(xv[i],t);i=n;break;case"source":Er("error",t),i=n;break;case"img":case"image":case"link":Er("error",t),Er("load",t),i=n;break;case"details":Er("toggle",t),i=n;break;case"input":Y$(t,n),i=MI(t,n),Er("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Kr({},n,{value:void 0}),Er("invalid",t);break;case"textarea":X$(t,n),i=FI(t,n),Er("invalid",t);break;default:i=n}LI(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?l5(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&o5(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Rw(t,l):typeof l=="number"&&Rw(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ew.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Er("scroll",t):l!=null&&F2(t,s,l,o))}switch(r){case"input":U1(t),K$(t,n,!1);break;case"textarea":U1(t),q$(t);break;case"option":n.value!=null&&t.setAttribute("value",""+bh(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Lm(t,!!n.multiple,s,!1):n.defaultValue!=null&&Lm(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Cb)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gi(e),null;case 6:if(t&&e.stateNode!=null)Iz(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Te(166));if(r=Kf(Hw.current),Kf(Ml.current),Z1(e)){if(n=e.stateNode,r=e.memoizedProps,n[_l]=e,(s=n.nodeValue!==r)&&(t=to,t!==null))switch(t.tag){case 3:Q1(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Q1(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[_l]=e,e.stateNode=n}return gi(e),null;case 13:if(Tr(Wr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Nr&&Qs!==null&&e.mode&1&&!(e.flags&128))X5(),sp(),e.flags|=98560,s=!1;else if(s=Z1(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Te(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Te(317));s[_l]=e}else sp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gi(e),s=!1}else ba!==null&&(yO(ba),ba=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Wr.current&1?Vn===0&&(Vn=3):wN())),e.updateQueue!==null&&(e.flags|=4),gi(e),null);case 4:return ap(),hO(t,e),t===null&&Mw(e.stateNode.containerInfo),gi(e),null;case 10:return tN(e.type._context),gi(e),null;case 17:return Ts(e.type)&&Sb(),gi(e),null;case 19:if(Tr(Wr),s=e.memoizedState,s===null)return gi(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)u0(s,!1);else{if(Vn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=kb(t),o!==null){for(e.flags|=128,u0(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return xr(Wr,Wr.current&1|2),e.child}t=t.sibling}s.tail!==null&&gn()>cp&&(e.flags|=128,n=!0,u0(s,!1),e.lanes=4194304)}else{if(!n)if(t=kb(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),u0(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Nr)return gi(e),null}else 2*gn()-s.renderingStartTime>cp&&r!==1073741824&&(e.flags|=128,n=!0,u0(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=gn(),e.sibling=null,r=Wr.current,xr(Wr,n?r&1|2:r&1),e):(gi(e),null);case 22:case 23:return vN(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ys&1073741824&&(gi(e),e.subtreeFlags&6&&(e.flags|=8192)):gi(e),null;case 24:return null;case 25:return null}throw Error(Te(156,e.tag))}function jre(t,e){switch(J2(e),e.tag){case 1:return Ts(e.type)&&Sb(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ap(),Tr(Rs),Tr(Ni),oN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return sN(e),null;case 13:if(Tr(Wr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Te(340));sp()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Tr(Wr),null;case 4:return ap(),null;case 10:return tN(e.type._context),null;case 22:case 23:return vN(),null;case 24:return null;default:return null}}var rC=!1,Ei=!1,Ure=typeof WeakSet=="function"?WeakSet:Set,Be=null;function bm(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rn(t,e,n)}else r.current=null}function fO(t,e,r){try{r()}catch(n){rn(t,e,n)}}var $4=!1;function zre(t,e){if(XI=vb,t=F5(),X2(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,f=null;t:for(;;){for(var d;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===t)break t;if(f===r&&++c===i&&(a=o),f===s&&++u===n&&(l=o),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(qI={focusedElem:t,selectionRange:r},vb=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,p=g.memoizedState,w=e.stateNode,v=w.getSnapshotBeforeUpdate(e.elementType===e.type?m:ya(e.type,m),p);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(b){rn(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return g=$4,$4=!1,g}function Vv(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&fO(e,r,s)}i=i.next}while(i!==n)}}function SE(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function dO(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Oz(t){var e=t.alternate;e!==null&&(t.alternate=null,Oz(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_l],delete e[Dw],delete e[ZI],delete e[Tre],delete e[kre])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Mz(t){return t.tag===5||t.tag===3||t.tag===4}function B4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Mz(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gO(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Cb));else if(n!==4&&(t=t.child,t!==null))for(gO(t,e,r),t=t.sibling;t!==null;)gO(t,e,r),t=t.sibling}function mO(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(mO(t,e,r),t=t.sibling;t!==null;)mO(t,e,r),t=t.sibling}var ai=null,Ca=!1;function mu(t,e,r){for(r=r.child;r!==null;)Nz(t,e,r),r=r.sibling}function Nz(t,e,r){if(Ol&&typeof Ol.onCommitFiberUnmount=="function")try{Ol.onCommitFiberUnmount(dE,r)}catch{}switch(r.tag){case 5:Ei||bm(r,e);case 6:var n=ai,i=Ca;ai=null,mu(t,e,r),ai=n,Ca=i,ai!==null&&(Ca?(t=ai,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ai.removeChild(r.stateNode));break;case 18:ai!==null&&(Ca?(t=ai,r=r.stateNode,t.nodeType===8?IT(t.parentNode,r):t.nodeType===1&&IT(t,r),Aw(t)):IT(ai,r.stateNode));break;case 4:n=ai,i=Ca,ai=r.stateNode.containerInfo,Ca=!0,mu(t,e,r),ai=n,Ca=i;break;case 0:case 11:case 14:case 15:if(!Ei&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&fO(r,e,o),i=i.next}while(i!==n)}mu(t,e,r);break;case 1:if(!Ei&&(bm(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){rn(r,e,a)}mu(t,e,r);break;case 21:mu(t,e,r);break;case 22:r.mode&1?(Ei=(n=Ei)||r.memoizedState!==null,mu(t,e,r),Ei=n):mu(t,e,r);break;default:mu(t,e,r)}}function V4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Ure),e.forEach(function(n){var i=ene.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ra(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ai=a.stateNode,Ca=!1;break e;case 3:ai=a.stateNode.containerInfo,Ca=!0;break e;case 4:ai=a.stateNode.containerInfo,Ca=!0;break e}a=a.return}if(ai===null)throw Error(Te(160));Nz(s,o,i),ai=null,Ca=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){rn(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Dz(e,t),e=e.sibling}function Dz(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ra(e,t),Ga(t),n&4){try{Vv(3,t,t.return),SE(3,t)}catch(m){rn(t,t.return,m)}try{Vv(5,t,t.return)}catch(m){rn(t,t.return,m)}}break;case 1:ra(e,t),Ga(t),n&512&&r!==null&&bm(r,r.return);break;case 5:if(ra(e,t),Ga(t),n&512&&r!==null&&bm(r,r.return),t.flags&32){var i=t.stateNode;try{Rw(i,"")}catch(m){rn(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&n5(i,s),$I(a,o);var c=$I(a,s);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?l5(i,h):u==="dangerouslySetInnerHTML"?o5(i,h):u==="children"?Rw(i,h):F2(i,u,h,c)}switch(a){case"input":NI(i,s);break;case"textarea":i5(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Lm(i,!!s.multiple,d,!1):f!==!!s.multiple&&(s.defaultValue!=null?Lm(i,!!s.multiple,s.defaultValue,!0):Lm(i,!!s.multiple,s.multiple?[]:"",!1))}i[Dw]=s}catch(m){rn(t,t.return,m)}}break;case 6:if(ra(e,t),Ga(t),n&4){if(t.stateNode===null)throw Error(Te(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){rn(t,t.return,m)}}break;case 3:if(ra(e,t),Ga(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Aw(e.containerInfo)}catch(m){rn(t,t.return,m)}break;case 4:ra(e,t),Ga(t);break;case 13:ra(e,t),Ga(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(mN=gn())),n&4&&V4(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Ei=(c=Ei)||u,ra(e,t),Ei=c):ra(e,t),Ga(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Be=t,u=t.child;u!==null;){for(h=Be=u;Be!==null;){switch(f=Be,d=f.child,f.tag){case 0:case 11:case 14:case 15:Vv(4,f,f.return);break;case 1:bm(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){rn(n,r,m)}}break;case 5:bm(f,f.return);break;case 22:if(f.memoizedState!==null){j4(h);continue}}d!==null?(d.return=f,Be=d):j4(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=a5("display",o))}catch(m){rn(t,t.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){rn(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ra(e,t),Ga(t),n&4&&V4(t);break;case 21:break;default:ra(e,t),Ga(t)}}function Ga(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Mz(r)){var n=r;break e}r=r.return}throw Error(Te(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Rw(i,""),n.flags&=-33);var s=B4(t);mO(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=B4(t);gO(t,a,o);break;default:throw Error(Te(161))}}catch(l){rn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Gre(t,e,r){Be=t,Fz(t)}function Fz(t,e,r){for(var n=(t.mode&1)!==0;Be!==null;){var i=Be,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||rC;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Ei;a=rC;var c=Ei;if(rC=o,(Ei=l)&&!c)for(Be=i;Be!==null;)o=Be,l=o.child,o.tag===22&&o.memoizedState!==null?U4(i):l!==null?(l.return=o,Be=l):U4(i);for(;s!==null;)Be=s,Fz(s),s=s.sibling;Be=i,rC=a,Ei=c}W4(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Be=s):W4(t)}}function W4(t){for(;Be!==null;){var e=Be;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ei||SE(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ei)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:ya(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&R4(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}R4(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Aw(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}Ei||e.flags&512&&dO(e)}catch(f){rn(e,e.return,f)}}if(e===t){Be=null;break}if(r=e.sibling,r!==null){r.return=e.return,Be=r;break}Be=e.return}}function j4(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Be=r;break}Be=e.return}}function U4(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{SE(4,e)}catch(l){rn(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){rn(e,i,l)}}var s=e.return;try{dO(e)}catch(l){rn(e,s,l)}break;case 5:var o=e.return;try{dO(e)}catch(l){rn(e,o,l)}}}catch(l){rn(e,e.return,l)}if(e===t){Be=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Be=a;break}Be=e.return}}var Yre=Math.ceil,Ib=Zc.ReactCurrentDispatcher,dN=Zc.ReactCurrentOwner,Vo=Zc.ReactCurrentBatchConfig,jt=0,Zn=null,kn=null,ui=0,Ys=0,_m=Nh(0),Vn=0,Vw=null,wd=0,xE=0,gN=0,Wv=null,bs=null,mN=0,cp=1/0,gc=null,Ob=!1,pO=null,gh=null,nC=!1,Xu=null,Mb=0,jv=0,vO=null,bx=-1,_x=0;function Zi(){return jt&6?gn():bx!==-1?bx:bx=gn()}function mh(t){return t.mode&1?jt&2&&ui!==0?ui&-ui:Are.transition!==null?(_x===0&&(_x=C5()),_x):(t=cr,t!==0||(t=window.event,t=t===void 0?16:T5(t.type)),t):1}function Ia(t,e,r,n){if(50<jv)throw jv=0,vO=null,Error(Te(185));Ly(t,r,n),(!(jt&2)||t!==Zn)&&(t===Zn&&(!(jt&2)&&(xE|=r),Vn===4&&Uu(t,ui)),ks(t,n),r===1&&jt===0&&!(e.mode&1)&&(cp=gn()+500,wE&&Dh()))}function ks(t,e){var r=t.callbackNode;Ate(t,e);var n=pb(t,t===Zn?ui:0);if(n===0)r!==null&&Z$(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Z$(r),e===1)t.tag===0?Pre(z4.bind(null,t)):G5(z4.bind(null,t)),Ere(function(){!(jt&6)&&Dh()}),r=null;else{switch(S5(n)){case 1:r=V2;break;case 4:r=w5;break;case 16:r=mb;break;case 536870912:r=y5;break;default:r=mb}r=Uz(r,Hz.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Hz(t,e){if(bx=-1,_x=0,jt&6)throw Error(Te(327));var r=t.callbackNode;if(jm()&&t.callbackNode!==r)return null;var n=pb(t,t===Zn?ui:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Nb(t,n);else{e=n;var i=jt;jt|=2;var s=$z();(Zn!==t||ui!==e)&&(gc=null,cp=gn()+500,id(t,e));do try{qre();break}catch(a){Lz(t,a)}while(!0);eN(),Ib.current=s,jt=i,kn!==null?e=0:(Zn=null,ui=0,e=Vn)}if(e!==0){if(e===2&&(i=UI(t),i!==0&&(n=i,e=wO(t,i))),e===1)throw r=Vw,id(t,0),Uu(t,n),ks(t,gn()),r;if(e===6)Uu(t,n);else{if(i=t.current.alternate,!(n&30)&&!Kre(i)&&(e=Nb(t,n),e===2&&(s=UI(t),s!==0&&(n=s,e=wO(t,s))),e===1))throw r=Vw,id(t,0),Uu(t,n),ks(t,gn()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Te(345));case 2:Ff(t,bs,gc);break;case 3:if(Uu(t,n),(n&130023424)===n&&(e=mN+500-gn(),10<e)){if(pb(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Zi(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=QI(Ff.bind(null,t,bs,gc),e);break}Ff(t,bs,gc);break;case 4:if(Uu(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-Aa(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=gn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Yre(n/1960))-n,10<n){t.timeoutHandle=QI(Ff.bind(null,t,bs,gc),n);break}Ff(t,bs,gc);break;case 5:Ff(t,bs,gc);break;default:throw Error(Te(329))}}}return ks(t,gn()),t.callbackNode===r?Hz.bind(null,t):null}function wO(t,e){var r=Wv;return t.current.memoizedState.isDehydrated&&(id(t,e).flags|=256),t=Nb(t,e),t!==2&&(e=bs,bs=r,e!==null&&yO(e)),t}function yO(t){bs===null?bs=t:bs.push.apply(bs,t)}function Kre(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Fa(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Uu(t,e){for(e&=~gN,e&=~xE,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Aa(e),n=1<<r;t[r]=-1,e&=~n}}function z4(t){if(jt&6)throw Error(Te(327));jm();var e=pb(t,0);if(!(e&1))return ks(t,gn()),null;var r=Nb(t,e);if(t.tag!==0&&r===2){var n=UI(t);n!==0&&(e=n,r=wO(t,n))}if(r===1)throw r=Vw,id(t,0),Uu(t,e),ks(t,gn()),r;if(r===6)throw Error(Te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ff(t,bs,gc),ks(t,gn()),null}function pN(t,e){var r=jt;jt|=1;try{return t(e)}finally{jt=r,jt===0&&(cp=gn()+500,wE&&Dh())}}function yd(t){Xu!==null&&Xu.tag===0&&!(jt&6)&&jm();var e=jt;jt|=1;var r=Vo.transition,n=cr;try{if(Vo.transition=null,cr=1,t)return t()}finally{cr=n,Vo.transition=r,jt=e,!(jt&6)&&Dh()}}function vN(){Ys=_m.current,Tr(_m)}function id(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,_re(r)),kn!==null)for(r=kn.return;r!==null;){var n=r;switch(J2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Sb();break;case 3:ap(),Tr(Rs),Tr(Ni),oN();break;case 5:sN(n);break;case 4:ap();break;case 13:Tr(Wr);break;case 19:Tr(Wr);break;case 10:tN(n.type._context);break;case 22:case 23:vN()}r=r.return}if(Zn=t,kn=t=ph(t.current,null),ui=Ys=e,Vn=0,Vw=null,gN=xE=wd=0,bs=Wv=null,Yf!==null){for(e=0;e<Yf.length;e++)if(r=Yf[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Yf=null}return t}function Lz(t,e){do{var r=kn;try{if(eN(),Cx.current=Ab,Pb){for(var n=Gr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Pb=!1}if(vd=0,Kn=$n=Gr=null,Bv=!1,Lw=0,dN.current=null,r===null||r.return===null){Vn=1,Vw=e,kn=null;break}e:{var s=t,o=r.return,a=r,l=e;if(e=ui,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=O4(o);if(d!==null){d.flags&=-257,M4(d,o,a,s,e),d.mode&1&&I4(s,c,e),e=d,l=c;var g=e.updateQueue;if(g===null){var m=new Set;m.add(l),e.updateQueue=m}else g.add(l);break e}else{if(!(e&1)){I4(s,c,e),wN();break e}l=Error(Te(426))}}else if(Nr&&a.mode&1){var p=O4(o);if(p!==null){!(p.flags&65536)&&(p.flags|=256),M4(p,o,a,s,e),Q2(lp(l,a));break e}}s=l=lp(l,a),Vn!==4&&(Vn=2),Wv===null?Wv=[s]:Wv.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=Sz(s,l,e);E4(s,w);break e;case 1:a=l;var v=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(gh===null||!gh.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=xz(s,a,e);E4(s,b);break e}}s=s.return}while(s!==null)}Vz(r)}catch(T){e=T,kn===r&&r!==null&&(kn=r=r.return);continue}break}while(!0)}function $z(){var t=Ib.current;return Ib.current=Ab,t===null?Ab:t}function wN(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),Zn===null||!(wd&268435455)&&!(xE&268435455)||Uu(Zn,ui)}function Nb(t,e){var r=jt;jt|=2;var n=$z();(Zn!==t||ui!==e)&&(gc=null,id(t,e));do try{Xre();break}catch(i){Lz(t,i)}while(!0);if(eN(),jt=r,Ib.current=n,kn!==null)throw Error(Te(261));return Zn=null,ui=0,Vn}function Xre(){for(;kn!==null;)Bz(kn)}function qre(){for(;kn!==null&&!Ste();)Bz(kn)}function Bz(t){var e=jz(t.alternate,t,Ys);t.memoizedProps=t.pendingProps,e===null?Vz(t):kn=e,dN.current=null}function Vz(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=jre(r,e),r!==null){r.flags&=32767,kn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Vn=6,kn=null;return}}else if(r=Wre(r,e,Ys),r!==null){kn=r;return}if(e=e.sibling,e!==null){kn=e;return}kn=e=t}while(e!==null);Vn===0&&(Vn=5)}function Ff(t,e,r){var n=cr,i=Vo.transition;try{Vo.transition=null,cr=1,Jre(t,e,r,n)}finally{Vo.transition=i,cr=n}return null}function Jre(t,e,r,n){do jm();while(Xu!==null);if(jt&6)throw Error(Te(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Te(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(Ite(t,s),t===Zn&&(kn=Zn=null,ui=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||nC||(nC=!0,Uz(mb,function(){return jm(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Vo.transition,Vo.transition=null;var o=cr;cr=1;var a=jt;jt|=4,dN.current=null,zre(t,r),Dz(r,t),vre(qI),vb=!!XI,qI=XI=null,t.current=r,Gre(r),xte(),jt=a,cr=o,Vo.transition=s}else t.current=r;if(nC&&(nC=!1,Xu=t,Mb=i),s=t.pendingLanes,s===0&&(gh=null),Ete(r.stateNode),ks(t,gn()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ob)throw Ob=!1,t=pO,pO=null,t;return Mb&1&&t.tag!==0&&jm(),s=t.pendingLanes,s&1?t===vO?jv++:(jv=0,vO=t):jv=0,Dh(),null}function jm(){if(Xu!==null){var t=S5(Mb),e=Vo.transition,r=cr;try{if(Vo.transition=null,cr=16>t?16:t,Xu===null)var n=!1;else{if(t=Xu,Xu=null,Mb=0,jt&6)throw Error(Te(331));var i=jt;for(jt|=4,Be=t.current;Be!==null;){var s=Be,o=s.child;if(Be.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Be=c;Be!==null;){var u=Be;switch(u.tag){case 0:case 11:case 15:Vv(8,u,s)}var h=u.child;if(h!==null)h.return=u,Be=h;else for(;Be!==null;){u=Be;var f=u.sibling,d=u.return;if(Oz(u),u===c){Be=null;break}if(f!==null){f.return=d,Be=f;break}Be=d}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var p=m.sibling;m.sibling=null,m=p}while(m!==null)}}Be=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Be=o;else e:for(;Be!==null;){if(s=Be,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Vv(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Be=w;break e}Be=s.return}}var v=t.current;for(Be=v;Be!==null;){o=Be;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,Be=y;else e:for(o=v;Be!==null;){if(a=Be,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:SE(9,a)}}catch(T){rn(a,a.return,T)}if(a===o){Be=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,Be=b;break e}Be=a.return}}if(jt=i,Dh(),Ol&&typeof Ol.onPostCommitFiberRoot=="function")try{Ol.onPostCommitFiberRoot(dE,t)}catch{}n=!0}return n}finally{cr=r,Vo.transition=e}}return!1}function G4(t,e,r){e=lp(r,e),e=Sz(t,e,1),t=dh(t,e,1),e=Zi(),t!==null&&(Ly(t,1,e),ks(t,e))}function rn(t,e,r){if(t.tag===3)G4(t,t,r);else for(;e!==null;){if(e.tag===3){G4(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(gh===null||!gh.has(n))){t=lp(r,t),t=xz(e,t,1),e=dh(e,t,1),t=Zi(),e!==null&&(Ly(e,1,t),ks(e,t));break}}e=e.return}}function Qre(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Zi(),t.pingedLanes|=t.suspendedLanes&r,Zn===t&&(ui&r)===r&&(Vn===4||Vn===3&&(ui&130023424)===ui&&500>gn()-mN?id(t,0):gN|=r),ks(t,e)}function Wz(t,e){e===0&&(t.mode&1?(e=Y1,Y1<<=1,!(Y1&130023424)&&(Y1=4194304)):e=1);var r=Zi();t=jc(t,e),t!==null&&(Ly(t,e,r),ks(t,r))}function Zre(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Wz(t,r)}function ene(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Te(314))}n!==null&&n.delete(e),Wz(t,r)}var jz;jz=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rs.current)_s=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return _s=!1,Vre(t,e,r);_s=!!(t.flags&131072)}else _s=!1,Nr&&e.flags&1048576&&Y5(e,_b,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;xx(t,e),t=e.pendingProps;var i=ip(e,Ni.current);Wm(e,r),i=lN(null,e,n,t,i,r);var s=cN();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ts(n)?(s=!0,xb(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,nN(e),i.updater=CE,e.stateNode=i,i._reactInternals=e,sO(e,n,t,r),e=lO(null,e,n,!0,s,r)):(e.tag=0,Nr&&s&&q2(e),zi(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(xx(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=rne(n),t=ya(n,t),i){case 0:e=aO(null,e,n,t,r);break e;case 1:e=F4(null,e,n,t,r);break e;case 11:e=N4(null,e,n,t,r);break e;case 14:e=D4(null,e,n,ya(n.type,t),r);break e}throw Error(Te(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ya(n,i),aO(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ya(n,i),F4(t,e,n,i,r);case 3:e:{if(Rz(e),t===null)throw Error(Te(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Z5(t,e),Tb(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=lp(Error(Te(423)),e),e=H4(t,e,n,r,i);break e}else if(n!==i){i=lp(Error(Te(424)),e),e=H4(t,e,n,r,i);break e}else for(Qs=fh(e.stateNode.containerInfo.firstChild),to=e,Nr=!0,ba=null,r=J5(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(sp(),n===i){e=Uc(t,e,r);break e}zi(t,e,n,r)}e=e.child}return e;case 5:return ez(e),t===null&&rO(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,JI(n,i)?o=null:s!==null&&JI(n,s)&&(e.flags|=32),Ez(t,e),zi(t,e,o,r),e.child;case 6:return t===null&&rO(e),null;case 13:return Tz(t,e,r);case 4:return iN(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=op(e,null,n,r):zi(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ya(n,i),N4(t,e,n,i,r);case 7:return zi(t,e,e.pendingProps,r),e.child;case 8:return zi(t,e,e.pendingProps.children,r),e.child;case 12:return zi(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,xr(Eb,n._currentValue),n._currentValue=o,s!==null)if(Fa(s.value,o)){if(s.children===i.children&&!Rs.current){e=Uc(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Mc(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),nO(s.return,r,e),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Te(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),nO(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}zi(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Wm(e,r),i=Uo(i),n=n(i),e.flags|=1,zi(t,e,n,r),e.child;case 14:return n=e.type,i=ya(n,e.pendingProps),i=ya(n.type,i),D4(t,e,n,i,r);case 15:return bz(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:ya(n,i),xx(t,e),e.tag=1,Ts(n)?(t=!0,xb(e)):t=!1,Wm(e,r),Cz(e,n,i),sO(e,n,i,r),lO(null,e,n,!0,t,r);case 19:return kz(t,e,r);case 22:return _z(t,e,r)}throw Error(Te(156,e.tag))};function Uz(t,e){return v5(t,e)}function tne(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $o(t,e,r,n){return new tne(t,e,r,n)}function yN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function rne(t){if(typeof t=="function")return yN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===L2)return 11;if(t===$2)return 14}return 2}function ph(t,e){var r=t.alternate;return r===null?(r=$o(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ex(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")yN(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case gm:return sd(r.children,i,s,e);case H2:o=8,i|=8;break;case PI:return t=$o(12,r,e,i|2),t.elementType=PI,t.lanes=s,t;case AI:return t=$o(13,r,e,i),t.elementType=AI,t.lanes=s,t;case II:return t=$o(19,r,e,i),t.elementType=II,t.lanes=s,t;case e5:return bE(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case QU:o=10;break e;case ZU:o=9;break e;case L2:o=11;break e;case $2:o=14;break e;case Fu:o=16,n=null;break e}throw Error(Te(130,t==null?t:typeof t,""))}return e=$o(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function sd(t,e,r,n){return t=$o(7,t,n,e),t.lanes=r,t}function bE(t,e,r,n){return t=$o(22,t,n,e),t.elementType=e5,t.lanes=r,t.stateNode={isHidden:!1},t}function $T(t,e,r){return t=$o(6,t,null,e),t.lanes=r,t}function BT(t,e,r){return e=$o(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function nne(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=CT(0),this.expirationTimes=CT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=CT(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function CN(t,e,r,n,i,s,o,a,l){return t=new nne(t,e,r,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=$o(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},nN(s),t}function ine(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dm,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function zz(t){if(!t)return _h;t=t._reactInternals;e:{if(jd(t)!==t||t.tag!==1)throw Error(Te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ts(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Te(171))}if(t.tag===1){var r=t.type;if(Ts(r))return z5(t,r,e)}return e}function Gz(t,e,r,n,i,s,o,a,l){return t=CN(r,n,!0,t,i,s,o,a,l),t.context=zz(null),r=t.current,n=Zi(),i=mh(r),s=Mc(n,i),s.callback=e??null,dh(r,s,i),t.current.lanes=i,Ly(t,i,n),ks(t,n),t}function _E(t,e,r,n){var i=e.current,s=Zi(),o=mh(i);return r=zz(r),e.context===null?e.context=r:e.pendingContext=r,e=Mc(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=dh(i,e,o),t!==null&&(Ia(t,i,o,s),yx(t,i,o)),o}function Db(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Y4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function SN(t,e){Y4(t,e),(t=t.alternate)&&Y4(t,e)}function sne(){return null}var Yz=typeof reportError=="function"?reportError:function(t){console.error(t)};function xN(t){this._internalRoot=t}EE.prototype.render=xN.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Te(409));_E(t,e,null,null)};EE.prototype.unmount=xN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yd(function(){_E(null,t,null,null)}),e[Wc]=null}};function EE(t){this._internalRoot=t}EE.prototype.unstable_scheduleHydration=function(t){if(t){var e=_5();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ju.length&&e!==0&&e<ju[r].priority;r++);ju.splice(r,0,t),r===0&&R5(t)}};function bN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function RE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function K4(){}function one(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Db(o);s.call(c)}}var o=Gz(e,n,t,0,null,!1,!1,"",K4);return t._reactRootContainer=o,t[Wc]=o.current,Mw(t.nodeType===8?t.parentNode:t),yd(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var c=Db(l);a.call(c)}}var l=CN(t,0,!1,null,null,!1,!1,"",K4);return t._reactRootContainer=l,t[Wc]=l.current,Mw(t.nodeType===8?t.parentNode:t),yd(function(){_E(e,l,r,n)}),l}function TE(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Db(o);a.call(l)}}_E(e,o,t,i)}else o=one(r,e,t,i,n);return Db(o)}x5=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Sv(e.pendingLanes);r!==0&&(W2(e,r|1),ks(e,gn()),!(jt&6)&&(cp=gn()+500,Dh()))}break;case 13:yd(function(){var n=jc(t,1);if(n!==null){var i=Zi();Ia(n,t,1,i)}}),SN(t,1)}};j2=function(t){if(t.tag===13){var e=jc(t,134217728);if(e!==null){var r=Zi();Ia(e,t,134217728,r)}SN(t,134217728)}};b5=function(t){if(t.tag===13){var e=mh(t),r=jc(t,e);if(r!==null){var n=Zi();Ia(r,t,e,n)}SN(t,e)}};_5=function(){return cr};E5=function(t,e){var r=cr;try{return cr=t,e()}finally{cr=r}};VI=function(t,e,r){switch(e){case"input":if(NI(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=vE(n);if(!i)throw Error(Te(90));r5(n),NI(n,i)}}}break;case"textarea":i5(t,r);break;case"select":e=r.value,e!=null&&Lm(t,!!r.multiple,e,!1)}};h5=pN;f5=yd;var ane={usingClientEntryPoint:!1,Events:[By,wm,vE,c5,u5,pN]},h0={findFiberByHostInstance:Gf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lne={bundleType:h0.bundleType,version:h0.version,rendererPackageName:h0.rendererPackageName,rendererConfig:h0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=m5(t),t===null?null:t.stateNode},findFiberByHostInstance:h0.findFiberByHostInstance||sne,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iC.isDisabled&&iC.supportsFiber)try{dE=iC.inject(lne),Ol=iC}catch{}}co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ane;co.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bN(e))throw Error(Te(200));return ine(t,e,null,r)};co.createRoot=function(t,e){if(!bN(t))throw Error(Te(299));var r=!1,n="",i=Yz;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=CN(t,1,!1,null,null,r,!1,n,i),t[Wc]=e.current,Mw(t.nodeType===8?t.parentNode:t),new xN(e)};co.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Te(188)):(t=Object.keys(t).join(","),Error(Te(268,t)));return t=m5(e),t=t===null?null:t.stateNode,t};co.flushSync=function(t){return yd(t)};co.hydrate=function(t,e,r){if(!RE(e))throw Error(Te(200));return TE(null,t,e,!0,r)};co.hydrateRoot=function(t,e,r){if(!bN(t))throw Error(Te(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=Yz;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Gz(e,null,t,1,r??null,i,!1,s,o),t[Wc]=e.current,Mw(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new EE(e)};co.render=function(t,e,r){if(!RE(e))throw Error(Te(200));return TE(null,t,e,!1,r)};co.unmountComponentAtNode=function(t){if(!RE(t))throw Error(Te(40));return t._reactRootContainer?(yd(function(){TE(null,null,t,!1,function(){t._reactRootContainer=null,t[Wc]=null})}),!0):!1};co.unstable_batchedUpdates=pN;co.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!RE(r))throw Error(Te(200));if(t==null||t._reactInternals===void 0)throw Error(Te(38));return TE(t,e,r,!1,n)};co.version="18.3.1-next-f1338f8080-20240426";function Kz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kz)}catch(t){console.error(t)}}Kz(),KU.exports=co;var Xz=KU.exports;const qz=hE(Xz);var X4=Xz;TI.createRoot=X4.createRoot,TI.hydrateRoot=X4.hydrateRoot;var Jz={exports:{}},Qz={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy=me;function cne(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var une=typeof Object.is=="function"?Object.is:cne,hne=Wy.useSyncExternalStore,fne=Wy.useRef,dne=Wy.useEffect,gne=Wy.useMemo,mne=Wy.useDebugValue;Qz.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=fne(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=gne(function(){function l(d){if(!c){if(c=!0,u=d,d=n(d),i!==void 0&&o.hasValue){var g=o.value;if(i(g,d))return h=g}return h=d}if(g=h,une(u,d))return g;var m=n(d);return i!==void 0&&i(g,m)?(u=d,g):(u=d,h=m)}var c=!1,u,h,f=r===void 0?null:r;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,r,n,i]);var a=hne(t,s[0],s[1]);return dne(function(){o.hasValue=!0,o.value=a},[a]),mne(a),a};Jz.exports=Qz;var pne=Jz.exports;function vne(t){t()}function wne(){let t=null,e=null;return{clear(){t=null,e=null},notify(){vne(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var q4={notify(){},get:()=>[]};function yne(t,e){let r,n=q4,i=0,s=!1;function o(m){u();const p=n.subscribe(m);let w=!1;return()=>{w||(w=!0,p(),h())}}function a(){n.notify()}function l(){g.onStateChange&&g.onStateChange()}function c(){return s}function u(){i++,r||(r=t.subscribe(l),n=wne())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=q4)}function f(){s||(s=!0,u())}function d(){s&&(s=!1,h())}const g={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:f,tryUnsubscribe:d,getListeners:()=>n};return g}var Cne=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Sne=Cne(),xne=()=>typeof navigator<"u"&&navigator.product==="ReactNative",bne=xne(),_ne=()=>Sne||bne?me.useLayoutEffect:me.useEffect,Ene=_ne(),VT=Symbol.for("react-redux-context"),WT=typeof globalThis<"u"?globalThis:{};function Rne(){if(!me.createContext)return{};const t=WT[VT]??(WT[VT]=new Map);let e=t.get(me.createContext);return e||(e=me.createContext(null),t.set(me.createContext,e)),e}var Eh=Rne();function Tne(t){const{children:e,context:r,serverState:n,store:i}=t,s=me.useMemo(()=>{const l=yne(i);return{store:i,subscription:l,getServerState:n?()=>n:void 0}},[i,n]),o=me.useMemo(()=>i.getState(),[i]);Ene(()=>{const{subscription:l}=s;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[s,o]);const a=r||Eh;return me.createElement(a.Provider,{value:s},e)}var kne=Tne;function _N(t=Eh){return function(){return me.useContext(t)}}var Zz=_N();function e9(t=Eh){const e=t===Eh?Zz:_N(t),r=()=>{const{store:n}=e();return n};return Object.assign(r,{withTypes:()=>r}),r}var Pne=e9();function Ane(t=Eh){const e=t===Eh?Pne:e9(t),r=()=>e().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var jy=Ane(),Ine=(t,e)=>t===e;function One(t=Eh){const e=t===Eh?Zz:_N(t),r=(n,i={})=>{const{equalityFn:s=Ine}=typeof i=="function"?{equalityFn:i}:i,o=e(),{store:a,subscription:l,getServerState:c}=o;me.useRef(!0);const u=me.useCallback({[n.name](f){return n(f)}}[n.name],[n]),h=pne.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,s);return me.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var kE=One();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ww(){return Ww=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ww.apply(this,arguments)}var qu;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(qu||(qu={}));const J4="popstate";function Mne(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:o,hash:a}=n.location;return CO("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Fb(i)}return Dne(e,r,null,t)}function Yr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function t9(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Nne(){return Math.random().toString(36).substr(2,8)}function Q4(t,e){return{usr:t.state,key:t.key,idx:e}}function CO(t,e,r,n){return r===void 0&&(r=null),Ww({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Op(e):e,{state:r,key:e&&e.key||n||Nne()})}function Fb(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Op(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Dne(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,a=qu.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Ww({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=qu.Pop;let p=u(),w=p==null?null:p-c;c=p,l&&l({action:a,location:m.location,delta:w})}function f(p,w){a=qu.Push;let v=CO(m.location,p,w);c=u()+1;let y=Q4(v,c),b=m.createHref(v);try{o.pushState(y,"",b)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(b)}s&&l&&l({action:a,location:m.location,delta:1})}function d(p,w){a=qu.Replace;let v=CO(m.location,p,w);c=u();let y=Q4(v,c),b=m.createHref(v);o.replaceState(y,"",b),s&&l&&l({action:a,location:m.location,delta:0})}function g(p){let w=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof p=="string"?p:Fb(p);return v=v.replace(/ $/,"%20"),Yr(w,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,w)}let m={get action(){return a},get location(){return t(i,o)},listen(p){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(J4,h),l=p,()=>{i.removeEventListener(J4,h),l=null}},createHref(p){return e(i,p)},createURL:g,encodeLocation(p){let w=g(p);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:d,go(p){return o.go(p)}};return m}var Z4;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Z4||(Z4={}));function Fne(t,e,r){return r===void 0&&(r="/"),Hne(t,e,r)}function Hne(t,e,r,n){let i=typeof e=="string"?Op(e):e,s=up(i.pathname||"/",r);if(s==null)return null;let o=r9(t);Lne(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=Xne(s);a=Yne(o[l],c)}return a}function r9(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Yr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=vh([n,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(Yr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),r9(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:zne(c,s.index),routesMeta:u})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of n9(s.path))i(s,o,l)}),e}function n9(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=n9(n.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Lne(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Gne(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const $ne=/^:[\w-]+$/,Bne=3,Vne=2,Wne=1,jne=10,Une=-2,e3=t=>t==="*";function zne(t,e){let r=t.split("/"),n=r.length;return r.some(e3)&&(n+=Une),e&&(n+=Vne),r.filter(i=>!e3(i)).reduce((i,s)=>i+($ne.test(s)?Bne:s===""?Wne:jne),n)}function Gne(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Yne(t,e,r){let{routesMeta:n}=t,i={},s="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",h=SO({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:vh([s,h.pathname]),pathnameBase:Zne(vh([s,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(s=vh([s,h.pathnameBase]))}return o}function SO(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=Kne(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:f,isOptional:d}=u;if(f==="*"){let m=a[h]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=a[h];return d&&!g?c[f]=void 0:c[f]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:t}}function Kne(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),t9(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Xne(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return t9(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function up(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function qne(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Op(t):t;return{pathname:r?r.startsWith("/")?r:Jne(r,e):e,search:eie(n),hash:tie(i)}}function Jne(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function jT(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Qne(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function EN(t,e){let r=Qne(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function RN(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Op(t):(i=Ww({},t),Yr(!i.pathname||!i.pathname.includes("?"),jT("?","pathname","search",i)),Yr(!i.pathname||!i.pathname.includes("#"),jT("#","pathname","hash",i)),Yr(!i.search||!i.search.includes("#"),jT("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=r;else{let h=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;i.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=qne(i,a),c=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const vh=t=>t.join("/").replace(/\/\/+/g,"/"),Zne=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),eie=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,tie=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function rie(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const i9=["post","put","patch","delete"];new Set(i9);const nie=["get",...i9];new Set(nie);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jw(){return jw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jw.apply(this,arguments)}const PE=me.createContext(null),s9=me.createContext(null),eu=me.createContext(null),AE=me.createContext(null),tu=me.createContext({outlet:null,matches:[],isDataRoute:!1}),o9=me.createContext(null);function iie(t,e){let{relative:r}=e===void 0?{}:e;Mp()||Yr(!1);let{basename:n,navigator:i}=me.useContext(eu),{hash:s,pathname:o,search:a}=IE(t,{relative:r}),l=o;return n!=="/"&&(l=o==="/"?n:vh([n,o])),i.createHref({pathname:l,search:a,hash:s})}function Mp(){return me.useContext(AE)!=null}function Fh(){return Mp()||Yr(!1),me.useContext(AE).location}function a9(t){me.useContext(eu).static||me.useLayoutEffect(t)}function Uy(){let{isDataRoute:t}=me.useContext(tu);return t?yie():sie()}function sie(){Mp()||Yr(!1);let t=me.useContext(PE),{basename:e,future:r,navigator:n}=me.useContext(eu),{matches:i}=me.useContext(tu),{pathname:s}=Fh(),o=JSON.stringify(EN(i,r.v7_relativeSplatPath)),a=me.useRef(!1);return a9(()=>{a.current=!0}),me.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){n.go(c);return}let h=RN(c,JSON.parse(o),s,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:vh([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,o,s,t])}const oie=me.createContext(null);function aie(t){let e=me.useContext(tu).outlet;return e&&me.createElement(oie.Provider,{value:t},e)}function IE(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=me.useContext(eu),{matches:i}=me.useContext(tu),{pathname:s}=Fh(),o=JSON.stringify(EN(i,n.v7_relativeSplatPath));return me.useMemo(()=>RN(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function lie(t,e){return cie(t,e)}function cie(t,e,r,n){Mp()||Yr(!1);let{navigator:i}=me.useContext(eu),{matches:s}=me.useContext(tu),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Fh(),u;if(e){var h;let p=typeof e=="string"?Op(e):e;l==="/"||(h=p.pathname)!=null&&h.startsWith(l)||Yr(!1),u=p}else u=c;let f=u.pathname||"/",d=f;if(l!=="/"){let p=l.replace(/^\//,"").split("/");d="/"+f.replace(/^\//,"").split("/").slice(p.length).join("/")}let g=Fne(t,{pathname:d}),m=gie(g&&g.map(p=>Object.assign({},p,{params:Object.assign({},a,p.params),pathname:vh([l,i.encodeLocation?i.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?l:vh([l,i.encodeLocation?i.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),s,r,n);return e&&m?me.createElement(AE.Provider,{value:{location:jw({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:qu.Pop}},m):m}function uie(){let t=wie(),e=rie(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return me.createElement(me.Fragment,null,me.createElement("h2",null,"Unexpected Application Error!"),me.createElement("h3",{style:{fontStyle:"italic"}},e),r?me.createElement("pre",{style:i},r):null,null)}const hie=me.createElement(uie,null);class fie extends me.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?me.createElement(tu.Provider,{value:this.props.routeContext},me.createElement(o9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function die(t){let{routeContext:e,match:r,children:n}=t,i=me.useContext(PE);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),me.createElement(tu.Provider,{value:e},n)}function gie(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,a=(i=r)==null?void 0:i.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Yr(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:f,errors:d}=r,g=h.route.loader&&f[h.route.id]===void 0&&(!d||d[h.route.id]===void 0);if(h.route.lazy||g){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let d,g=!1,m=null,p=null;r&&(d=a&&h.route.id?a[h.route.id]:void 0,m=h.route.errorElement||hie,l&&(c<0&&f===0?(Cie("route-fallback"),g=!0,p=null):c===f&&(g=!0,p=h.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,f+1)),v=()=>{let y;return d?y=m:g?y=p:h.route.Component?y=me.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=u,me.createElement(die,{match:h,routeContext:{outlet:u,matches:w,isDataRoute:r!=null},children:y})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?me.createElement(fie,{location:r.location,revalidation:r.revalidation,component:m,error:d,children:v(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):v()},null)}var l9=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(l9||{}),c9=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(c9||{});function mie(t){let e=me.useContext(PE);return e||Yr(!1),e}function pie(t){let e=me.useContext(s9);return e||Yr(!1),e}function vie(t){let e=me.useContext(tu);return e||Yr(!1),e}function u9(t){let e=vie(),r=e.matches[e.matches.length-1];return r.route.id||Yr(!1),r.route.id}function wie(){var t;let e=me.useContext(o9),r=pie(),n=u9();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function yie(){let{router:t}=mie(l9.UseNavigateStable),e=u9(c9.UseNavigateStable),r=me.useRef(!1);return a9(()=>{r.current=!0}),me.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,jw({fromRouteId:e},s)))},[t,e])}const t3={};function Cie(t,e,r){t3[t]||(t3[t]=!0)}function Sie(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function xie(t){let{to:e,replace:r,state:n,relative:i}=t;Mp()||Yr(!1);let{future:s,static:o}=me.useContext(eu),{matches:a}=me.useContext(tu),{pathname:l}=Fh(),c=Uy(),u=RN(e,EN(a,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(u);return me.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:i}),[c,h,i,r,n]),null}function h9(t){return aie(t.context)}function Wi(t){Yr(!1)}function bie(t){let{basename:e="/",children:r=null,location:n,navigationType:i=qu.Pop,navigator:s,static:o=!1,future:a}=t;Mp()&&Yr(!1);let l=e.replace(/^\/*/,"/"),c=me.useMemo(()=>({basename:l,navigator:s,static:o,future:jw({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof n=="string"&&(n=Op(n));let{pathname:u="/",search:h="",hash:f="",state:d=null,key:g="default"}=n,m=me.useMemo(()=>{let p=up(u,l);return p==null?null:{location:{pathname:p,search:h,hash:f,state:d,key:g},navigationType:i}},[l,u,h,f,d,g,i]);return m==null?null:me.createElement(eu.Provider,{value:c},me.createElement(AE.Provider,{children:r,value:m}))}function _ie(t){let{children:e,location:r}=t;return lie(xO(e),r)}new Promise(()=>{});function xO(t,e){e===void 0&&(e=[]);let r=[];return me.Children.forEach(t,(n,i)=>{if(!me.isValidElement(n))return;let s=[...e,i];if(n.type===me.Fragment){r.push.apply(r,xO(n.props.children,s));return}n.type!==Wi&&Yr(!1),!n.props.index||!n.props.children||Yr(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=xO(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hb(){return Hb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hb.apply(this,arguments)}function f9(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function Eie(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Rie(t,e){return t.button===0&&(!e||e==="_self")&&!Eie(t)}const Tie=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kie=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Pie="6";try{window.__reactRouterVersion=Pie}catch{}const Aie=me.createContext({isTransitioning:!1}),Iie="startTransition",r3=Qee[Iie];function Oie(t){let{basename:e,children:r,future:n,window:i}=t,s=me.useRef();s.current==null&&(s.current=Mne({window:i,v5Compat:!0}));let o=s.current,[a,l]=me.useState({action:o.action,location:o.location}),{v7_startTransition:c}=n||{},u=me.useCallback(h=>{c&&r3?r3(()=>l(h)):l(h)},[l,c]);return me.useLayoutEffect(()=>o.listen(u),[o,u]),me.useEffect(()=>Sie(n),[n]),me.createElement(bie,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:o,future:n})}const Mie=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Nie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xf=me.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,f=f9(e,Tie),{basename:d}=me.useContext(eu),g,m=!1;if(typeof c=="string"&&Nie.test(c)&&(g=c,Mie))try{let y=new URL(window.location.href),b=c.startsWith("//")?new URL(y.protocol+c):new URL(c),T=up(b.pathname,d);b.origin===y.origin&&T!=null?c=T+b.search+b.hash:m=!0}catch{}let p=iie(c,{relative:i}),w=Fie(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:h});function v(y){n&&n(y),y.defaultPrevented||w(y)}return me.createElement("a",Hb({},f,{href:g||p,onClick:m||s?n:v,ref:r,target:l}))}),tm=me.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:o=!1,style:a,to:l,viewTransition:c,children:u}=e,h=f9(e,kie),f=IE(l,{relative:h.relative}),d=Fh(),g=me.useContext(s9),{navigator:m,basename:p}=me.useContext(eu),w=g!=null&&Hie(f)&&c===!0,v=m.encodeLocation?m.encodeLocation(f).pathname:f.pathname,y=d.pathname,b=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;i||(y=y.toLowerCase(),b=b?b.toLowerCase():null,v=v.toLowerCase()),b&&p&&(b=up(b,p)||b);const T=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let E=y===v||!o&&y.startsWith(v)&&y.charAt(T)==="/",x=b!=null&&(b===v||!o&&b.startsWith(v)&&b.charAt(v.length)==="/"),P={isActive:E,isPending:x,isTransitioning:w},A=E?n:void 0,O;typeof s=="function"?O=s(P):O=[s,E?"active":null,x?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let Y=typeof a=="function"?a(P):a;return me.createElement(Xf,Hb({},h,{"aria-current":A,className:O,ref:r,style:Y,to:l,viewTransition:c}),typeof u=="function"?u(P):u)});var bO;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(bO||(bO={}));var n3;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(n3||(n3={}));function Die(t){let e=me.useContext(PE);return e||Yr(!1),e}function Fie(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=Uy(),c=Fh(),u=IE(t,{relative:o});return me.useCallback(h=>{if(Rie(h,r)){h.preventDefault();let f=n!==void 0?n:Fb(c)===Fb(u);l(t,{replace:f,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[c,l,u,n,i,r,t,s,o,a])}function Hie(t,e){e===void 0&&(e={});let r=me.useContext(Aie);r==null&&Yr(!1);let{basename:n}=Die(bO.useViewTransitionState),i=IE(t,{relative:e.relative});if(!r.isTransitioning)return!1;let s=up(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=up(r.nextLocation.pathname,n)||r.nextLocation.pathname;return SO(i.pathname,o)!=null||SO(i.pathname,s)!=null}function Rx(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rx=function(r){return typeof r}:Rx=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Rx(t)}function Lie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bie(t,e,r){return e&&$ie(t.prototype,e),t}function Vie(t,e){return e&&(Rx(e)==="object"||typeof e=="function")?e:Tx(t)}function _O(t){return _O=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},_O(t)}function Tx(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wie(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&EO(t,e)}function EO(t,e){return EO=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},EO(t,e)}function kx(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var d9=function(t){Wie(e,t);function e(){var r,n;Lie(this,e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n=Vie(this,(r=_O(e)).call.apply(r,[this].concat(s))),kx(Tx(n),"state",{bootstrapped:!1}),kx(Tx(n),"_unsubscribe",void 0),kx(Tx(n),"handlePersistorState",function(){var a=n.props.persistor,l=a.getState(),c=l.bootstrapped;c&&(n.props.onBeforeLift?Promise.resolve(n.props.onBeforeLift()).finally(function(){return n.setState({bootstrapped:!0})}):n.setState({bootstrapped:!0}),n._unsubscribe&&n._unsubscribe())}),n}return Bie(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(me.PureComponent);kx(d9,"defaultProps",{children:null,loading:null});function g9(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=g9(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function od(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=g9(t))&&(n&&(n+=" "),n+=e);return n}function jie(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}jie(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var zy=t=>typeof t=="number"&&!isNaN(t),Cd=t=>typeof t=="string",zc=t=>typeof t=="function",Uie=t=>Cd(t)||zy(t),RO=t=>Cd(t)||zc(t)?t:null,zie=(t,e)=>t===!1||zy(t)&&t>0?t:e,TO=t=>me.isValidElement(t)||Cd(t)||zc(t)||zy(t);function Gie(t,e,r=300){let{scrollHeight:n,style:i}=t;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,r)})})}function Yie({enter:t,exit:e,appendPosition:r=!1,collapse:n=!0,collapseDuration:i=300}){return function({children:s,position:o,preventExitTransition:a,done:l,nodeRef:c,isIn:u,playToast:h}){let f=r?`${t}--${o}`:t,d=r?`${e}--${o}`:e,g=me.useRef(0);return me.useLayoutEffect(()=>{let m=c.current,p=f.split(" "),w=v=>{v.target===c.current&&(h(),m.removeEventListener("animationend",w),m.removeEventListener("animationcancel",w),g.current===0&&v.type!=="animationcancel"&&m.classList.remove(...p))};m.classList.add(...p),m.addEventListener("animationend",w),m.addEventListener("animationcancel",w)},[]),me.useEffect(()=>{let m=c.current,p=()=>{m.removeEventListener("animationend",p),n?Gie(m,l,i):l()};u||(a?p():(g.current=1,m.className+=` ${d}`,m.addEventListener("animationend",p)))},[u]),Ge.createElement(Ge.Fragment,null,s)}}function i3(t,e){return{content:m9(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function m9(t,e,r=!1){return me.isValidElement(t)&&!Cd(t.type)?me.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):zc(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):t}function Kie({closeToast:t,theme:e,ariaLabel:r="close"}){return Ge.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:n=>{n.stopPropagation(),t(!0)},"aria-label":r},Ge.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ge.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Xie({delay:t,isRunning:e,closeToast:r,type:n="default",hide:i,className:s,controlledProgress:o,progress:a,rtl:l,isIn:c,theme:u}){let h=i||o&&a===0,f={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};o&&(f.transform=`scaleX(${a})`);let d=od("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":l}),g=zc(s)?s({rtl:l,type:n,defaultClassName:d}):od(d,s),m={[o&&a>=1?"onTransitionEnd":"onAnimationEnd"]:o&&a<1?null:()=>{c&&r()}};return Ge.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":h},Ge.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${n}`}),Ge.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:g,style:f,...m}))}var qie=1,p9=()=>`${qie++}`;function Jie(t,e,r){let n=1,i=0,s=[],o=[],a=e,l=new Map,c=new Set,u=v=>(c.add(v),()=>c.delete(v)),h=()=>{o=Array.from(l.values()),c.forEach(v=>v())},f=({containerId:v,toastId:y,updateId:b})=>{let T=v?v!==t:t!==1,E=l.has(y)&&b==null;return T||E},d=(v,y)=>{l.forEach(b=>{var T;(y==null||y===b.props.toastId)&&((T=b.toggle)==null||T.call(b,v))})},g=v=>{var y,b;(b=(y=v.props)==null?void 0:y.onClose)==null||b.call(y,v.removalReason),v.isActive=!1},m=v=>{if(v==null)l.forEach(g);else{let y=l.get(v);y&&g(y)}h()},p=()=>{i-=s.length,s=[]},w=v=>{var y,b;let{toastId:T,updateId:E}=v.props,x=E==null;v.staleId&&l.delete(v.staleId),v.isActive=!0,l.set(T,v),h(),r(i3(v,x?"added":"updated")),x&&((b=(y=v.props).onOpen)==null||b.call(y))};return{id:t,props:a,observe:u,toggle:d,removeToast:m,toasts:l,clearQueue:p,buildToast:(v,y)=>{if(f(y))return;let{toastId:b,updateId:T,data:E,staleId:x,delay:P}=y,A=T==null;A&&i++;let O={...a,style:a.toastStyle,key:n++,...Object.fromEntries(Object.entries(y).filter(([B,ie])=>ie!=null)),toastId:b,updateId:T,data:E,isIn:!1,className:RO(y.className||a.toastClassName),progressClassName:RO(y.progressClassName||a.progressClassName),autoClose:y.isLoading?!1:zie(y.autoClose,a.autoClose),closeToast(B){l.get(b).removalReason=B,m(b)},deleteToast(){let B=l.get(b);if(B!=null){if(r(i3(B,"removed")),l.delete(b),i--,i<0&&(i=0),s.length>0){w(s.shift());return}h()}}};O.closeButton=a.closeButton,y.closeButton===!1||TO(y.closeButton)?O.closeButton=y.closeButton:y.closeButton===!0&&(O.closeButton=TO(a.closeButton)?a.closeButton:!0);let Y={content:v,props:O,staleId:x};a.limit&&a.limit>0&&i>a.limit&&A?s.push(Y):zy(P)?setTimeout(()=>{w(Y)},P):w(Y)},setProps(v){a=v},setToggle:(v,y)=>{let b=l.get(v);b&&(b.toggle=y)},isToastActive:v=>{var y;return(y=l.get(v))==null?void 0:y.isActive},getSnapshot:()=>o}}var Qi=new Map,Uw=[],kO=new Set,Qie=t=>kO.forEach(e=>e(t)),v9=()=>Qi.size>0;function Zie(){Uw.forEach(t=>y9(t.content,t.options)),Uw=[]}var ese=(t,{containerId:e})=>{var r;return(r=Qi.get(e||1))==null?void 0:r.toasts.get(t)};function w9(t,e){var r;if(e)return!!((r=Qi.get(e))!=null&&r.isToastActive(t));let n=!1;return Qi.forEach(i=>{i.isToastActive(t)&&(n=!0)}),n}function tse(t){if(!v9()){Uw=Uw.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||Uie(t))Qi.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=Qi.get(t.containerId);e?e.removeToast(t.id):Qi.forEach(r=>{r.removeToast(t.id)})}}var rse=(t={})=>{Qi.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function y9(t,e){TO(t)&&(v9()||Uw.push({content:t,options:e}),Qi.forEach(r=>{r.buildToast(t,e)}))}function nse(t){var e;(e=Qi.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function C9(t,e){Qi.forEach(r=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===r.id)&&r.toggle(t,e==null?void 0:e.id)})}function ise(t){let e=t.containerId||1;return{subscribe(r){let n=Jie(e,t,Qie);Qi.set(e,n);let i=n.observe(r);return Zie(),()=>{i(),Qi.delete(e)}},setProps(r){var n;(n=Qi.get(e))==null||n.setProps(r)},getSnapshot(){var r;return(r=Qi.get(e))==null?void 0:r.getSnapshot()}}}function sse(t){return kO.add(t),()=>{kO.delete(t)}}function ose(t){return t&&(Cd(t.toastId)||zy(t.toastId))?t.toastId:p9()}function Gy(t,e){return y9(t,e),e.toastId}function OE(t,e){return{...e,type:e&&e.type||t,toastId:ose(e)}}function ME(t){return(e,r)=>Gy(e,OE(t,r))}function kt(t,e){return Gy(t,OE("default",e))}kt.loading=(t,e)=>Gy(t,OE("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function ase(t,{pending:e,error:r,success:n},i){let s;e&&(s=Cd(e)?kt.loading(e,i):kt.loading(e.render,{...i,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=(c,u,h)=>{if(u==null){kt.dismiss(s);return}let f={type:c,...o,...i,data:h},d=Cd(u)?{render:u}:u;return s?kt.update(s,{...f,...d}):kt(d.render,{...f,...d}),h},l=zc(t)?t():t;return l.then(c=>a("success",n,c)).catch(c=>a("error",r,c)),l}kt.promise=ase;kt.success=ME("success");kt.info=ME("info");kt.error=ME("error");kt.warning=ME("warning");kt.warn=kt.warning;kt.dark=(t,e)=>Gy(t,OE("default",{theme:"dark",...e}));function lse(t){tse(t)}kt.dismiss=lse;kt.clearWaitingQueue=rse;kt.isActive=w9;kt.update=(t,e={})=>{let r=ese(t,e);if(r){let{props:n,content:i}=r,s={delay:100,...n,...e,toastId:e.toastId||t,updateId:p9()};s.toastId!==t&&(s.staleId=t);let o=s.render||i;delete s.render,Gy(o,s)}};kt.done=t=>{kt.update(t,{progress:1})};kt.onChange=sse;kt.play=t=>C9(!0,t);kt.pause=t=>C9(!1,t);function cse(t){var e;let{subscribe:r,getSnapshot:n,setProps:i}=me.useRef(ise(t)).current;i(t);let s=(e=me.useSyncExternalStore(r,n,n))==null?void 0:e.slice();function o(a){if(!s)return[];let l=new Map;return t.newestOnTop&&s.reverse(),s.forEach(c=>{let{position:u}=c.props;l.has(u)||l.set(u,[]),l.get(u).push(c)}),Array.from(l,c=>a(c[0],c[1]))}return{getToastToRender:o,isToastActive:w9,count:s==null?void 0:s.length}}function use(t){let[e,r]=me.useState(!1),[n,i]=me.useState(!1),s=me.useRef(null),o=me.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:u,closeOnClick:h}=t;nse({id:t.toastId,containerId:t.containerId,fn:r}),me.useEffect(()=>{if(t.pauseOnFocusLoss)return f(),()=>{d()}},[t.pauseOnFocusLoss]);function f(){document.hasFocus()||w(),window.addEventListener("focus",p),window.addEventListener("blur",w)}function d(){window.removeEventListener("focus",p),window.removeEventListener("blur",w)}function g(x){if(t.draggable===!0||t.draggable===x.pointerType){v();let P=s.current;o.canCloseOnClick=!0,o.canDrag=!0,P.style.transition="none",t.draggableDirection==="x"?(o.start=x.clientX,o.removalDistance=P.offsetWidth*(t.draggablePercent/100)):(o.start=x.clientY,o.removalDistance=P.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function m(x){let{top:P,bottom:A,left:O,right:Y}=s.current.getBoundingClientRect();x.nativeEvent.type!=="touchend"&&t.pauseOnHover&&x.clientX>=O&&x.clientX<=Y&&x.clientY>=P&&x.clientY<=A?w():p()}function p(){r(!0)}function w(){r(!1)}function v(){o.didMove=!1,document.addEventListener("pointermove",b),document.addEventListener("pointerup",T)}function y(){document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",T)}function b(x){let P=s.current;if(o.canDrag&&P){o.didMove=!0,e&&w(),t.draggableDirection==="x"?o.delta=x.clientX-o.start:o.delta=x.clientY-o.start,o.start!==x.clientX&&(o.canCloseOnClick=!1);let A=t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;P.style.transform=`translate3d(${A},0)`,P.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function T(){y();let x=s.current;if(o.canDrag&&o.didMove&&x){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){i(!0),t.closeToast(!0),t.collapseAll();return}x.style.transition="transform 0.2s, opacity 0.2s",x.style.removeProperty("transform"),x.style.removeProperty("opacity")}}let E={onPointerDown:g,onPointerUp:m};return a&&l&&(E.onMouseEnter=w,t.stacked||(E.onMouseLeave=p)),h&&(E.onClick=x=>{u&&u(x),o.canCloseOnClick&&c(!0)}),{playToast:p,pauseToast:w,isRunning:e,preventExitTransition:n,toastRef:s,eventHandlers:E}}var hse=typeof window<"u"?me.useLayoutEffect:me.useEffect,NE=({theme:t,type:e,isLoading:r,...n})=>Ge.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...n});function fse(t){return Ge.createElement(NE,{...t},Ge.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function dse(t){return Ge.createElement(NE,{...t},Ge.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function gse(t){return Ge.createElement(NE,{...t},Ge.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function mse(t){return Ge.createElement(NE,{...t},Ge.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function pse(){return Ge.createElement("div",{className:"Toastify__spinner"})}var PO={info:dse,warning:fse,success:gse,error:mse,spinner:pse},vse=t=>t in PO;function wse({theme:t,type:e,isLoading:r,icon:n}){let i=null,s={theme:t,type:e};return n===!1||(zc(n)?i=n({...s,isLoading:r}):me.isValidElement(n)?i=me.cloneElement(n,s):r?i=PO.spinner():vse(e)&&(i=PO[e](s))),i}var yse=t=>{let{isRunning:e,preventExitTransition:r,toastRef:n,eventHandlers:i,playToast:s}=use(t),{closeButton:o,children:a,autoClose:l,onClick:c,type:u,hideProgressBar:h,closeToast:f,transition:d,position:g,className:m,style:p,progressClassName:w,updateId:v,role:y,progress:b,rtl:T,toastId:E,deleteToast:x,isIn:P,isLoading:A,closeOnClick:O,theme:Y,ariaLabel:B}=t,ie=od("Toastify__toast",`Toastify__toast-theme--${Y}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":T},{"Toastify__toast--close-on-click":O}),ue=zc(m)?m({rtl:T,position:g,type:u,defaultClassName:ie}):od(ie,m),he=wse(t),Ee=!!b||!l,Ce={closeToast:f,type:u,theme:Y},ge=null;return o===!1||(zc(o)?ge=o(Ce):me.isValidElement(o)?ge=me.cloneElement(o,Ce):ge=Kie(Ce)),Ge.createElement(d,{isIn:P,done:x,position:g,preventExitTransition:r,nodeRef:n,playToast:s},Ge.createElement("div",{id:E,tabIndex:0,onClick:c,"data-in":P,className:ue,...i,style:p,ref:n,...P&&{role:y,"aria-label":B}},he!=null&&Ge.createElement("div",{className:od("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!A})},he),m9(a,t,!e),ge,!t.customProgressBar&&Ge.createElement(Xie,{...v&&!Ee?{key:`p-${v}`}:{},rtl:T,theme:Y,delay:l,isRunning:e,isIn:P,closeToast:f,hide:h,type:u,className:w,controlledProgress:Ee,progress:b||0})))},Cse=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),Sse=Yie(Cse("bounce",!0)),xse={position:"top-right",transition:Sse,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function bse(t){let e={...xse,...t},r=t.stacked,[n,i]=me.useState(!0),s=me.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=cse(e),{className:c,style:u,rtl:h,containerId:f,hotKeys:d}=e;function g(p){let w=od("Toastify__toast-container",`Toastify__toast-container--${p}`,{"Toastify__toast-container--rtl":h});return zc(c)?c({position:p,rtl:h,defaultClassName:w}):od(w,RO(c))}function m(){r&&(i(!0),kt.play())}return hse(()=>{var p;if(r){let w=s.current.querySelectorAll('[data-in="true"]'),v=12,y=(p=e.position)==null?void 0:p.includes("top"),b=0,T=0;Array.from(w).reverse().forEach((E,x)=>{let P=E;P.classList.add("Toastify__toast--stacked"),x>0&&(P.dataset.collapsed=`${n}`),P.dataset.pos||(P.dataset.pos=y?"top":"bot");let A=b*(n?.2:1)+(n?0:v*x);P.style.setProperty("--y",`${y?A:A*-1}px`),P.style.setProperty("--g",`${v}`),P.style.setProperty("--s",`${1-(n?T:0)}`),b+=P.offsetHeight,T+=.025})}},[n,l,r]),me.useEffect(()=>{function p(w){var v;let y=s.current;d(w)&&((v=y.querySelector('[tabIndex="0"]'))==null||v.focus(),i(!1),kt.pause()),w.key==="Escape"&&(document.activeElement===y||y!=null&&y.contains(document.activeElement))&&(i(!0),kt.play())}return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[d]),Ge.createElement("section",{ref:s,className:"Toastify",id:f,onMouseEnter:()=>{r&&(i(!1),kt.pause())},onMouseLeave:m,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((p,w)=>{let v=w.length?{...u}:{...u,pointerEvents:"none"};return Ge.createElement("div",{tabIndex:-1,className:g(p),"data-stacked":r,style:v,key:`c-${p}`},w.map(({content:y,props:b})=>Ge.createElement(yse,{...b,stacked:r,collapseAll:m,isIn:a(b.toastId,b.containerId),key:`t-${b.key}`},y)))}))}function oi(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var _se=typeof Symbol=="function"&&Symbol.observable||"@@observable",s3=_se,UT=()=>Math.random().toString(36).substring(7).split("").join("."),Ese={INIT:`@@redux/INIT${UT()}`,REPLACE:`@@redux/REPLACE${UT()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${UT()}`},Lb=Ese;function TN(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function kN(t,e,r){if(typeof t!="function")throw new Error(oi(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(oi(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(oi(1));return r(kN)(t,e)}let n=t,i=e,s=new Map,o=s,a=0,l=!1;function c(){o===s&&(o=new Map,s.forEach((p,w)=>{o.set(w,p)}))}function u(){if(l)throw new Error(oi(3));return i}function h(p){if(typeof p!="function")throw new Error(oi(4));if(l)throw new Error(oi(5));let w=!0;c();const v=a++;return o.set(v,p),function(){if(w){if(l)throw new Error(oi(6));w=!1,c(),o.delete(v),s=null}}}function f(p){if(!TN(p))throw new Error(oi(7));if(typeof p.type>"u")throw new Error(oi(8));if(typeof p.type!="string")throw new Error(oi(17));if(l)throw new Error(oi(9));try{l=!0,i=n(i,p)}finally{l=!1}return(s=o).forEach(v=>{v()}),p}function d(p){if(typeof p!="function")throw new Error(oi(10));n=p,f({type:Lb.REPLACE})}function g(){const p=h;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(oi(11));function v(){const b=w;b.next&&b.next(u())}return v(),{unsubscribe:p(v)}},[s3](){return this}}}return f({type:Lb.INIT}),{dispatch:f,subscribe:h,getState:u,replaceReducer:d,[s3]:g}}function Rse(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Lb.INIT})>"u")throw new Error(oi(12));if(typeof r(void 0,{type:Lb.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(oi(13))})}function S9(t){const e=Object.keys(t),r={};for(let s=0;s<e.length;s++){const o=e[s];typeof t[o]=="function"&&(r[o]=t[o])}const n=Object.keys(r);let i;try{Rse(r)}catch(s){i=s}return function(o={},a){if(i)throw i;let l=!1;const c={};for(let u=0;u<n.length;u++){const h=n[u],f=r[h],d=o[h],g=f(d,a);if(typeof g>"u")throw a&&a.type,new Error(oi(14));c[h]=g,l=l||g!==d}return l=l||n.length!==Object.keys(o).length,l?c:o}}function $b(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function Tse(...t){return e=>(r,n)=>{const i=e(r,n);let s=()=>{throw new Error(oi(15))};const o={getState:i.getState,dispatch:(l,...c)=>s(l,...c)},a=t.map(l=>l(o));return s=$b(...a)(i.dispatch),{...i,dispatch:s}}}function kse(t){return TN(t)&&"type"in t&&typeof t.type=="string"}var x9=Symbol.for("immer-nothing"),o3=Symbol.for("immer-draftable"),io=Symbol.for("immer-state");function Ea(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var hp=Object.getPrototypeOf;function Sd(t){return!!t&&!!t[io]}function Gc(t){var e;return t?b9(t)||Array.isArray(t)||!!t[o3]||!!((e=t.constructor)!=null&&e[o3])||FE(t)||HE(t):!1}var Pse=Object.prototype.constructor.toString();function b9(t){if(!t||typeof t!="object")return!1;const e=hp(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Pse}function Bb(t,e){DE(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function DE(t){const e=t[io];return e?e.type_:Array.isArray(t)?1:FE(t)?2:HE(t)?3:0}function AO(t,e){return DE(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function _9(t,e,r){const n=DE(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function Ase(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function FE(t){return t instanceof Map}function HE(t){return t instanceof Set}function Hf(t){return t.copy_||t.base_}function IO(t,e){if(FE(t))return new Map(t);if(HE(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=b9(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[io];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],a=n[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(hp(t),n)}else{const n=hp(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function PN(t,e=!1){return LE(t)||Sd(t)||!Gc(t)||(DE(t)>1&&(t.set=t.add=t.clear=t.delete=Ise),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>PN(n,!0))),t}function Ise(){Ea(2)}function LE(t){return Object.isFrozen(t)}var Ose={};function xd(t){const e=Ose[t];return e||Ea(0,t),e}var zw;function E9(){return zw}function Mse(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function a3(t,e){e&&(xd("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function OO(t){MO(t),t.drafts_.forEach(Nse),t.drafts_=null}function MO(t){t===zw&&(zw=t.parent_)}function l3(t){return zw=Mse(zw,t)}function Nse(t){const e=t[io];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function c3(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[io].modified_&&(OO(e),Ea(4)),Gc(t)&&(t=Vb(e,t),e.parent_||Wb(e,t)),e.patches_&&xd("Patches").generateReplacementPatches_(r[io].base_,t,e.patches_,e.inversePatches_)):t=Vb(e,r,[]),OO(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==x9?t:void 0}function Vb(t,e,r){if(LE(e))return e;const n=e[io];if(!n)return Bb(e,(i,s)=>u3(t,n,e,i,s,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return Wb(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let s=i,o=!1;n.type_===3&&(s=new Set(i),i.clear(),o=!0),Bb(s,(a,l)=>u3(t,n,i,a,l,r,o)),Wb(t,i,!1),r&&t.patches_&&xd("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function u3(t,e,r,n,i,s,o){if(Sd(i)){const a=s&&e&&e.type_!==3&&!AO(e.assigned_,n)?s.concat(n):void 0,l=Vb(t,i,a);if(_9(r,n,l),Sd(l))t.canAutoFreeze_=!1;else return}else o&&r.add(i);if(Gc(i)&&!LE(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Vb(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Wb(t,i)}}function Wb(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&PN(e,r)}function Dse(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:E9(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=AN;r&&(i=[n],s=Gw);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return n.draft_=a,n.revoke_=o,a}var AN={get(t,e){if(e===io)return t;const r=Hf(t);if(!AO(r,e))return Fse(t,r,e);const n=r[e];return t.finalized_||!Gc(n)?n:n===zT(t.base_,e)?(GT(t),t.copy_[e]=DO(n,t)):n},has(t,e){return e in Hf(t)},ownKeys(t){return Reflect.ownKeys(Hf(t))},set(t,e,r){const n=R9(Hf(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=zT(Hf(t),e),s=i==null?void 0:i[io];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Ase(r,i)&&(r!==void 0||AO(t.base_,e)))return!0;GT(t),NO(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return zT(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,GT(t),NO(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=Hf(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Ea(11)},getPrototypeOf(t){return hp(t.base_)},setPrototypeOf(){Ea(12)}},Gw={};Bb(AN,(t,e)=>{Gw[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Gw.deleteProperty=function(t,e){return Gw.set.call(this,t,e,void 0)};Gw.set=function(t,e,r){return AN.set.call(this,t[0],e,r,t[0])};function zT(t,e){const r=t[io];return(r?Hf(r):t)[e]}function Fse(t,e,r){var i;const n=R9(e,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(t.draft_):void 0}function R9(t,e){if(!(e in t))return;let r=hp(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=hp(r)}}function NO(t){t.modified_||(t.modified_=!0,t.parent_&&NO(t.parent_))}function GT(t){t.copy_||(t.copy_=IO(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Hse=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const o=this;return function(l=s,...c){return o.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&Ea(6),n!==void 0&&typeof n!="function"&&Ea(7);let i;if(Gc(e)){const s=l3(this),o=DO(e,void 0);let a=!0;try{i=r(o),a=!1}finally{a?OO(s):MO(s)}return a3(s,n),c3(i,s)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===x9&&(i=void 0),this.autoFreeze_&&PN(i,!0),n){const s=[],o=[];xd("Patches").generateReplacementPatches_(e,i,s,o),n(s,o)}return i}else Ea(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let n,i;return[this.produce(e,r,(o,a)=>{n=o,i=a}),n,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Gc(t)||Ea(8),Sd(t)&&(t=Lse(t));const e=l3(this),r=DO(t,void 0);return r[io].isManual_=!0,MO(e),r}finishDraft(t,e){const r=t&&t[io];(!r||!r.isManual_)&&Ea(9);const{scope_:n}=r;return a3(n,e),c3(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=xd("Patches").applyPatches_;return Sd(t)?n(t,e):this.produce(t,i=>n(i,e))}};function DO(t,e){const r=FE(t)?xd("MapSet").proxyMap_(t,e):HE(t)?xd("MapSet").proxySet_(t,e):Dse(t,e);return(e?e.scope_:E9()).drafts_.push(r),r}function Lse(t){return Sd(t)||Ea(10,t),T9(t)}function T9(t){if(!Gc(t)||LE(t))return t;const e=t[io];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=IO(t,e.scope_.immer_.useStrictShallowCopy_)}else r=IO(t,!0);return Bb(r,(n,i)=>{_9(r,n,T9(i))}),e&&(e.finalized_=!1),r}var so=new Hse,k9=so.produce;so.produceWithPatches.bind(so);so.setAutoFreeze.bind(so);so.setUseStrictShallowCopy.bind(so);so.applyPatches.bind(so);so.createDraft.bind(so);so.finishDraft.bind(so);function P9(t){return({dispatch:r,getState:n})=>i=>s=>typeof s=="function"?s(r,n,t):i(s)}var $se=P9(),Bse=P9,Vse=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?$b:$b.apply(null,arguments)},Wse=t=>t&&typeof t.match=="function";function Uv(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Nc(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>kse(n)&&n.type===t,r}var A9=class bv extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,bv.prototype)}static get[Symbol.species](){return bv}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new bv(...e[0].concat(this)):new bv(...e.concat(this))}};function h3(t){return Gc(t)?k9(t,()=>{}):t}function sC(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function jse(t){return typeof t=="boolean"}var Use=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=e??{};let o=new A9;return r&&(jse(r)?o.push($se):o.push(Bse(r.extraArgument))),o},zse="RTK_autoBatch",f3=t=>e=>{setTimeout(e,t)},Gse=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,s=!1,o=!1;const a=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:f3(10):t.type==="callback"?t.queueNotification:f3(t.timeout),c=()=>{o=!1,s&&(s=!1,a.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>i&&u(),f=n.subscribe(h);return a.add(u),()=>{f(),a.delete(u)}},dispatch(u){var h;try{return i=!((h=u==null?void 0:u.meta)!=null&&h[zse]),s=!i,s&&(o||(o=!0,l(c))),n.dispatch(u)}finally{i=!0}}})},Yse=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new A9(t);return n&&i.push(Gse(typeof n=="object"?n:void 0)),i};function Kse(t){const e=Use(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=t||{};let a;if(typeof r=="function")a=r;else if(TN(r))a=S9(r);else throw new Error(Nc(1));let l;typeof n=="function"?l=n(e):l=e();let c=$b;i&&(c=Vse({trace:!1,...typeof i=="object"&&i}));const u=Tse(...l),h=Yse(u);let f=typeof o=="function"?o(h):h();const d=c(...f);return kN(a,s,d)}function I9(t){const e={},r=[];let n;const i={addCase(s,o){const a=typeof s=="string"?s:s.type;if(!a)throw new Error(Nc(28));if(a in e)throw new Error(Nc(29));return e[a]=o,i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return n=s,i}};return t(i),[e,r,n]}function Xse(t){return typeof t=="function"}function qse(t,e){let[r,n,i]=I9(e),s;if(Xse(t))s=()=>h3(t());else{const a=h3(t);s=()=>a}function o(a=s(),l){let c=[r[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[i]),c.reduce((u,h)=>{if(h)if(Sd(u)){const d=h(u,l);return d===void 0?u:d}else{if(Gc(u))return k9(u,f=>h(f,l));{const f=h(u,l);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},a)}return o.getInitialState=s,o}var Jse=(t,e)=>Wse(t)?t.match(e):t(e);function Qse(...t){return e=>t.some(r=>Jse(r,e))}var Zse="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",eoe=(t=21)=>{let e="",r=t;for(;r--;)e+=Zse[Math.random()*64|0];return e},toe=["name","message","stack","code"],YT=class{constructor(t,e){gT(this,"_type");this.payload=t,this.meta=e}},d3=class{constructor(t,e){gT(this,"_type");this.payload=t,this.meta=e}},roe=t=>{if(typeof t=="object"&&t!==null){const e={};for(const r of toe)typeof t[r]=="string"&&(e[r]=t[r]);return e}return{message:String(t)}},g3="External signal was aborted",IN=(()=>{function t(e,r,n){const i=Uv(e+"/fulfilled",(l,c,u,h)=>({payload:l,meta:{...h||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),s=Uv(e+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=Uv(e+"/rejected",(l,c,u,h,f)=>({payload:h,error:(n&&n.serializeError||roe)(l||"Rejected"),meta:{...f||{},arg:u,requestId:c,rejectedWithValue:!!h,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function a(l,{signal:c}={}){return(u,h,f)=>{const d=n!=null&&n.idGenerator?n.idGenerator(l):eoe(),g=new AbortController;let m,p;function w(y){p=y,g.abort()}c&&(c.aborted?w(g3):c.addEventListener("abort",()=>w(g3),{once:!0}));const v=async function(){var T,E;let y;try{let x=(T=n==null?void 0:n.condition)==null?void 0:T.call(n,l,{getState:h,extra:f});if(ioe(x)&&(x=await x),x===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const P=new Promise((A,O)=>{m=()=>{O({name:"AbortError",message:p||"Aborted"})},g.signal.addEventListener("abort",m)});u(s(d,l,(E=n==null?void 0:n.getPendingMeta)==null?void 0:E.call(n,{requestId:d,arg:l},{getState:h,extra:f}))),y=await Promise.race([P,Promise.resolve(r(l,{dispatch:u,getState:h,extra:f,requestId:d,signal:g.signal,abort:w,rejectWithValue:(A,O)=>new YT(A,O),fulfillWithValue:(A,O)=>new d3(A,O)})).then(A=>{if(A instanceof YT)throw A;return A instanceof d3?i(A.payload,d,l,A.meta):i(A,d,l)})])}catch(x){y=x instanceof YT?o(null,d,l,x.payload,x.meta):o(x,d,l)}finally{m&&g.signal.removeEventListener("abort",m)}return n&&!n.dispatchConditionRejection&&o.match(y)&&y.meta.condition||u(y),y}();return Object.assign(v,{abort:w,requestId:d,arg:l,unwrap(){return v.then(noe)}})}}return Object.assign(a,{pending:s,rejected:o,fulfilled:i,settled:Qse(o,i),typePrefix:e})}return t.withTypes=()=>t,t})();function noe(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function ioe(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var soe=Symbol.for("rtk-slice-createasyncthunk");function ooe(t,e){return`${t}/${e}`}function aoe({creators:t}={}){var r;const e=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[soe];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(Nc(11));const a=(typeof i.reducers=="function"?i.reducers(coe()):i.reducers)||{},l=Object.keys(a),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(b,T){const E=typeof b=="string"?b:b.type;if(!E)throw new Error(Nc(12));if(E in c.sliceCaseReducersByType)throw new Error(Nc(13));return c.sliceCaseReducersByType[E]=T,u},addMatcher(b,T){return c.sliceMatchers.push({matcher:b,reducer:T}),u},exposeAction(b,T){return c.actionCreators[b]=T,u},exposeCaseReducer(b,T){return c.sliceCaseReducersByName[b]=T,u}};l.forEach(b=>{const T=a[b],E={reducerName:b,type:ooe(s,b),createNotation:typeof i.reducers=="function"};hoe(T)?doe(E,T,u,e):uoe(E,T,u)});function h(){const[b={},T=[],E=void 0]=typeof i.extraReducers=="function"?I9(i.extraReducers):[i.extraReducers],x={...b,...c.sliceCaseReducersByType};return qse(i.initialState,P=>{for(let A in x)P.addCase(A,x[A]);for(let A of c.sliceMatchers)P.addMatcher(A.matcher,A.reducer);for(let A of T)P.addMatcher(A.matcher,A.reducer);E&&P.addDefaultCase(E)})}const f=b=>b,d=new Map,g=new WeakMap;let m;function p(b,T){return m||(m=h()),m(b,T)}function w(){return m||(m=h()),m.getInitialState()}function v(b,T=!1){function E(P){let A=P[b];return typeof A>"u"&&T&&(A=sC(g,E,w)),A}function x(P=f){const A=sC(d,T,()=>new WeakMap);return sC(A,P,()=>{const O={};for(const[Y,B]of Object.entries(i.selectors??{}))O[Y]=loe(B,P,()=>sC(g,P,w),T);return O})}return{reducerPath:b,getSelectors:x,get selectors(){return x(E)},selectSlice:E}}const y={name:s,reducer:p,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:w,...v(o),injectInto(b,{reducerPath:T,...E}={}){const x=T??o;return b.inject({reducerPath:x,reducer:p},E),{...y,...v(x,!0)}}};return y}}function loe(t,e,r,n){function i(s,...o){let a=e(s);return typeof a>"u"&&n&&(a=r()),t(a,...o)}return i.unwrapped=t,i}var O9=aoe();function coe(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function uoe({type:t,reducerName:e,createNotation:r},n,i){let s,o;if("reducer"in n){if(r&&!foe(n))throw new Error(Nc(17));s=n.reducer,o=n.prepare}else s=n;i.addCase(t,s).exposeCaseReducer(e,s).exposeAction(e,o?Uv(t,o):Uv(t))}function hoe(t){return t._reducerDefinitionType==="asyncThunk"}function foe(t){return t._reducerDefinitionType==="reducerWithPrepare"}function doe({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Nc(18));const{payloadCreator:s,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=r,h=i(t,s,u);n.exposeAction(e,h),o&&n.addCase(h.fulfilled,o),a&&n.addCase(h.pending,a),l&&n.addCase(h.rejected,l),c&&n.addMatcher(h.settled,c),n.exposeCaseReducer(e,{fulfilled:o||oC,pending:a||oC,rejected:l||oC,settled:c||oC})}function oC(){}function Nc(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const m3=localStorage.getItem("user"),goe=m3?{isAuthenticated:!0,user:JSON.parse(m3)}:{isAuthenticated:!1,user:null},M9=O9({name:"auth",initialState:goe,reducers:{login:(t,e)=>{const{email:r,password:n}=e.payload;r==="exsample@mail.ru"&&n==="password"?(t.isAuthenticated=!0,t.user={name:"Иван Петров",email:r},localStorage.setItem("user",JSON.stringify(t.user))):alert("Неверные данные. Используйте e-mail: exsample@mail.ru, пароль: password")},logout:t=>{t.isAuthenticated=!1,t.user=null,localStorage.removeItem("user")}}}),{login:moe,logout:ON}=M9.actions,poe=M9.reducer,voe="_header_9aulg_1",woe="_header__logoContainer_9aulg_23",yoe="_header__logo_9aulg_23",Coe="_header__logoText_9aulg_51",Soe="_header__right_9aulg_65",xoe="_header__navButtons_9aulg_75",boe="_header__navButton_9aulg_75",_oe="_header__userBlock_9aulg_161",Eoe="_header__userName_9aulg_177",Roe="_header__avatar_9aulg_195",Toe="_header__menu_9aulg_335",koe="_header__menuItem_9aulg_379",ti={header:voe,header__logoContainer:woe,header__logo:yoe,header__logoText:Coe,header__right:Soe,header__navButtons:xoe,header__navButton:boe,header__userBlock:_oe,header__userName:Eoe,header__avatar:Roe,"header__navButton--active":"_header__navButton--active_9aulg_223",header__menu:Toe,"header__menu--open":"_header__menu--open_9aulg_367",header__menuItem:koe},Poe=()=>{const t=Fh(),e=jy(),{isAuthenticated:r,user:n}=kE(u=>u.auth),[i,s]=me.useState(t.pathname.startsWith("/lk")?"lk":"work"),[o,a]=me.useState(!1),l=me.useRef(null);me.useEffect(()=>{const u=h=>{l.current&&!l.current.contains(h.target)&&a(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]);const c=()=>{e(ON()),a(!1)};return F.jsxs("header",{className:ti.header,children:[F.jsxs(Xf,{to:"/",className:ti.header__logoContainer,children:[F.jsx("div",{className:ti.header__logo,"aria-hidden":"true"}),F.jsx("span",{className:ti.header__logoText,children:"Profgeo"})]}),F.jsxs("div",{className:ti.header__right,children:[F.jsx("div",{className:ti.header__navButtons,children:r?F.jsx(F.Fragment,{}):F.jsxs(F.Fragment,{children:[F.jsx(Xf,{to:"/login",className:`${ti.header__navButton} ${ti["header__navButton--active"]}`,children:F.jsx("span",{children:"Войти"})}),F.jsx(Xf,{to:"/register",className:`${ti.header__navButton} ${ti["header__navButton--active"]}`,children:F.jsx("span",{children:"Зарегистрироваться"})})]})}),r&&F.jsxs("div",{className:ti.header__userBlock,ref:l,children:[F.jsx("span",{className:ti.header__userName,children:(n==null?void 0:n.name)||"Без имени"}),F.jsx("button",{type:"button",className:ti.header__avatar,onClick:()=>a(!o),children:n!=null&&n.name?n.name.split(" ").map(u=>u[0]).join("").toUpperCase():"?"}),F.jsxs("div",{className:`${ti.header__menu} ${o?ti["header__menu--open"]:""}`,children:[F.jsx(Xf,{to:"/lk",className:ti.header__menuItem,children:"Профиль"}),F.jsx("button",{onClick:c,className:ti.header__menuItem,style:{width:"100%",textAlign:"left",background:"none",border:"none",cursor:"pointer"},children:"Выйти"})]})]})]})]})},p3={"title-container":"_title-container_1r4j8_1"},Aoe=()=>{const t=Fh(),e=kE(n=>n.auth.isAuthenticated);if(t.pathname==="/login"||t.pathname==="/register")return null;let r="";return e?t.pathname.startsWith("/work")?r="Перечень графических приложений":r="Страница пользователя":r="Добро пожаловать на сайт Profgeo! Пожалуйста, зарегистрируйтесь или авторизуйтесь.",F.jsx("div",{className:p3["title-container"],children:F.jsx("h1",{className:p3["title-container__text"],children:r})})},Ioe="_sidebar_1bqot_1",Ooe="_sidebar__menuContainer_1bqot_23",Moe="_sidebar__menu_1bqot_23",Noe="_sidebar__menuItem_1bqot_45",Doe="_sidebar__icon_1bqot_75",Foe="_sidebar__iconList_1bqot_87",Hoe="_sidebar__iconInfo_1bqot_97",Loe="_sidebar__iconCreditCard_1bqot_107",$oe="_sidebar__iconUsers_1bqot_117",Boe="_sidebar__iconSettings_1bqot_127",Voe="_sidebar__footer_1bqot_137",Woe="_sidebar__logout_1bqot_145",joe="_sidebar__iconLogout_1bqot_183",Uoe="_active_1bqot_259",mr={sidebar:Ioe,sidebar__menuContainer:Ooe,sidebar__menu:Moe,sidebar__menuItem:Noe,sidebar__icon:Doe,sidebar__iconList:Foe,sidebar__iconInfo:Hoe,sidebar__iconCreditCard:Loe,sidebar__iconUsers:$oe,sidebar__iconSettings:Boe,sidebar__footer:Voe,sidebar__logout:Woe,sidebar__iconLogout:joe,active:Uoe},zoe=()=>{const t=jy();return F.jsxs("aside",{className:mr.sidebar,children:[F.jsx("div",{className:mr.sidebar__menuContainer,children:F.jsxs("ul",{className:mr.sidebar__menu,children:[F.jsx("li",{children:F.jsxs(tm,{to:"/lk",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[F.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconList}`}),F.jsx("span",{children:"Объекты"})]})}),F.jsx("li",{children:F.jsxs(tm,{to:"/account",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[F.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconInfo}`}),F.jsx("span",{children:"Аккаунт"})]})}),F.jsx("li",{children:F.jsxs(tm,{to:"/subscription",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[F.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconCreditCard}`}),F.jsx("span",{children:"Подписка"})]})}),F.jsx("li",{children:F.jsxs(tm,{to:"/users",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[F.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconUsers}`}),F.jsx("span",{children:"Список пользователей"})]})}),F.jsx("li",{children:F.jsxs(tm,{to:"/settings",className:({isActive:e})=>`${mr.sidebar__menuItem} ${e?mr.active:""}`,children:[F.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconSettings}`}),F.jsx("span",{children:"Настройки"})]})})]})}),F.jsx("div",{className:mr.sidebar__footer,children:F.jsxs("button",{className:mr.sidebar__logout,onClick:()=>t(ON()),children:[F.jsx("div",{className:`${mr.sidebar__icon} ${mr.sidebar__iconLogout}`}),F.jsx("span",{children:"Выйти"})]})})]})},Goe="_mainContent_226eh_1",Yoe="_content_226eh_21",v3={mainContent:Goe,content:Yoe},Koe=()=>F.jsxs("div",{className:v3.mainContent,children:[F.jsx(zoe,{}),F.jsx("section",{className:v3.content,children:F.jsx(h9,{})})]}),Xoe="_sidebar_qld18_1",qoe="_sidebar__menuContainer_qld18_23",Joe="_sidebar__menuItem_qld18_49",Qoe="_sidebar__footer_qld18_103",Zoe="_sidebar__logout_qld18_111",eae="_sidebar__icon_qld18_141",tae="_sidebar__iconLogout_qld18_153",rae="_active_qld18_223",Ya={sidebar:Xoe,sidebar__menuContainer:qoe,sidebar__menuItem:Joe,sidebar__footer:Qoe,sidebar__logout:Zoe,sidebar__icon:eae,sidebar__iconLogout:tae,active:rae},nae=()=>{const t=jy(),e=Uy(),r=()=>{t(ON()),e("/")};return F.jsxs("aside",{className:Ya.sidebar,children:[F.jsx("div",{className:Ya.sidebar__menuContainer,children:F.jsxs(tm,{to:"/work/app1",className:({isActive:n})=>`${Ya.sidebar__menuItem} ${n?Ya.active:""}`,children:[F.jsx("div",{className:`${Ya.sidebar__icon} ${Ya.sidebar__iconList}`}),F.jsx("span",{children:"Модуль1 - ModuleExcelEditor"})]})}),F.jsx("div",{className:Ya.sidebar__footer,children:F.jsxs("button",{type:"button",className:Ya.sidebar__logout,onClick:r,children:[F.jsx("div",{className:`${Ya.sidebar__icon} ${Ya.sidebar__iconLogout}`}),F.jsx("span",{children:"Выйти"})]})})]})},iae="_mainContent_1rgp8_1",sae="_content_1rgp8_17",w3={mainContent:iae,content:sae},oae=()=>F.jsxs("div",{className:w3.mainContent,children:[F.jsx(nae,{}),F.jsx("section",{className:w3.content,children:F.jsx(h9,{})})]}),MN=()=>jy(),aae=kE,lae="modulepreload",cae=function(t){return"/my-profgeo-app/"+t},y3={},uae=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=cae(l),l in y3)return;y3[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":lae,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((f,d)=>{h.addEventListener("load",f),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function N9(t,e){return function(){return t.apply(e,arguments)}}const{toString:hae}=Object.prototype,{getPrototypeOf:NN}=Object,{iterator:$E,toStringTag:D9}=Symbol,BE=(t=>e=>{const r=hae.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Va=t=>(t=t.toLowerCase(),e=>BE(e)===t),VE=t=>e=>typeof e===t,{isArray:Np}=Array,Yw=VE("undefined");function Yy(t){return t!==null&&!Yw(t)&&t.constructor!==null&&!Yw(t.constructor)&&Ps(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const F9=Va("ArrayBuffer");function fae(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&F9(t.buffer),e}const dae=VE("string"),Ps=VE("function"),H9=VE("number"),Ky=t=>t!==null&&typeof t=="object",gae=t=>t===!0||t===!1,Px=t=>{if(BE(t)!=="object")return!1;const e=NN(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(D9 in t)&&!($E in t)},mae=t=>{if(!Ky(t)||Yy(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},pae=Va("Date"),vae=Va("File"),wae=Va("Blob"),yae=Va("FileList"),Cae=t=>Ky(t)&&Ps(t.pipe),Sae=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ps(t.append)&&((e=BE(t))==="formdata"||e==="object"&&Ps(t.toString)&&t.toString()==="[object FormData]"))},xae=Va("URLSearchParams"),[bae,_ae,Eae,Rae]=["ReadableStream","Request","Response","Headers"].map(Va),Tae=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xy(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,i;if(typeof t!="object"&&(t=[t]),Np(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{if(Yy(t))return;const s=r?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(n=0;n<o;n++)a=s[n],e.call(null,t[a],a,t)}}function L9(t,e){if(Yy(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,i;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const qf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,$9=t=>!Yw(t)&&t!==qf;function FO(){const{caseless:t}=$9(this)&&this||{},e={},r=(n,i)=>{const s=t&&L9(e,i)||i;Px(e[s])&&Px(n)?e[s]=FO(e[s],n):Px(n)?e[s]=FO({},n):Np(n)?e[s]=n.slice():e[s]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Xy(arguments[n],r);return e}const kae=(t,e,r,{allOwnKeys:n}={})=>(Xy(e,(i,s)=>{r&&Ps(i)?t[s]=N9(i,r):t[s]=i},{allOwnKeys:n}),t),Pae=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Aae=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},Iae=(t,e,r,n)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!n||n(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&NN(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},Oae=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},Mae=t=>{if(!t)return null;if(Np(t))return t;let e=t.length;if(!H9(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},Nae=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&NN(Uint8Array)),Dae=(t,e)=>{const n=(t&&t[$E]).call(t);let i;for(;(i=n.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},Fae=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},Hae=Va("HTMLFormElement"),Lae=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),C3=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),$ae=Va("RegExp"),B9=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Xy(r,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(n[s]=o||i)}),Object.defineProperties(t,n)},Bae=t=>{B9(t,(e,r)=>{if(Ps(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(Ps(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Vae=(t,e)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return Np(t)?n(t):n(String(t).split(e)),r},Wae=()=>{},jae=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Uae(t){return!!(t&&Ps(t.append)&&t[D9]==="FormData"&&t[$E])}const zae=t=>{const e=new Array(10),r=(n,i)=>{if(Ky(n)){if(e.indexOf(n)>=0)return;if(Yy(n))return n;if(!("toJSON"in n)){e[i]=n;const s=Np(n)?[]:{};return Xy(n,(o,a)=>{const l=r(o,i+1);!Yw(l)&&(s[a]=l)}),e[i]=void 0,s}}return n};return r(t,0)},Gae=Va("AsyncFunction"),Yae=t=>t&&(Ky(t)||Ps(t))&&Ps(t.then)&&Ps(t.catch),V9=((t,e)=>t?setImmediate:e?((r,n)=>(qf.addEventListener("message",({source:i,data:s})=>{i===qf&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),qf.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ps(qf.postMessage)),Kae=typeof queueMicrotask<"u"?queueMicrotask.bind(qf):typeof process<"u"&&process.nextTick||V9,Xae=t=>t!=null&&Ps(t[$E]),pe={isArray:Np,isArrayBuffer:F9,isBuffer:Yy,isFormData:Sae,isArrayBufferView:fae,isString:dae,isNumber:H9,isBoolean:gae,isObject:Ky,isPlainObject:Px,isEmptyObject:mae,isReadableStream:bae,isRequest:_ae,isResponse:Eae,isHeaders:Rae,isUndefined:Yw,isDate:pae,isFile:vae,isBlob:wae,isRegExp:$ae,isFunction:Ps,isStream:Cae,isURLSearchParams:xae,isTypedArray:Nae,isFileList:yae,forEach:Xy,merge:FO,extend:kae,trim:Tae,stripBOM:Pae,inherits:Aae,toFlatObject:Iae,kindOf:BE,kindOfTest:Va,endsWith:Oae,toArray:Mae,forEachEntry:Dae,matchAll:Fae,isHTMLForm:Hae,hasOwnProperty:C3,hasOwnProp:C3,reduceDescriptors:B9,freezeMethods:Bae,toObjectSet:Vae,toCamelCase:Lae,noop:Wae,toFiniteNumber:jae,findKey:L9,global:qf,isContextDefined:$9,isSpecCompliantForm:Uae,toJSONObject:zae,isAsyncFn:Gae,isThenable:Yae,setImmediate:V9,asap:Kae,isIterable:Xae};function dt(t,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}pe.inherits(dt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:pe.toJSONObject(this.config),code:this.code,status:this.status}}});const W9=dt.prototype,j9={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{j9[t]={value:t}});Object.defineProperties(dt,j9);Object.defineProperty(W9,"isAxiosError",{value:!0});dt.from=(t,e,r,n,i,s)=>{const o=Object.create(W9);return pe.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),dt.call(o,t.message,e,r,n,i),o.cause=t,o.name=t.name,s&&Object.assign(o,s),o};const qae=null;function HO(t){return pe.isPlainObject(t)||pe.isArray(t)}function U9(t){return pe.endsWith(t,"[]")?t.slice(0,-2):t}function S3(t,e,r){return t?t.concat(e).map(function(i,s){return i=U9(i),!r&&s?"["+i+"]":i}).join(r?".":""):e}function Jae(t){return pe.isArray(t)&&!t.some(HO)}const Qae=pe.toFlatObject(pe,{},null,function(e){return/^is[A-Z]/.test(e)});function WE(t,e,r){if(!pe.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=pe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,p){return!pe.isUndefined(p[m])});const n=r.metaTokens,i=r.visitor||u,s=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&pe.isSpecCompliantForm(e);if(!pe.isFunction(i))throw new TypeError("visitor must be a function");function c(g){if(g===null)return"";if(pe.isDate(g))return g.toISOString();if(pe.isBoolean(g))return g.toString();if(!l&&pe.isBlob(g))throw new dt("Blob is not supported. Use a Buffer instead.");return pe.isArrayBuffer(g)||pe.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,m,p){let w=g;if(g&&!p&&typeof g=="object"){if(pe.endsWith(m,"{}"))m=n?m:m.slice(0,-2),g=JSON.stringify(g);else if(pe.isArray(g)&&Jae(g)||(pe.isFileList(g)||pe.endsWith(m,"[]"))&&(w=pe.toArray(g)))return m=U9(m),w.forEach(function(y,b){!(pe.isUndefined(y)||y===null)&&e.append(o===!0?S3([m],b,s):o===null?m:m+"[]",c(y))}),!1}return HO(g)?!0:(e.append(S3(p,m,s),c(g)),!1)}const h=[],f=Object.assign(Qae,{defaultVisitor:u,convertValue:c,isVisitable:HO});function d(g,m){if(!pe.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(g),pe.forEach(g,function(w,v){(!(pe.isUndefined(w)||w===null)&&i.call(e,w,pe.isString(v)?v.trim():v,m,f))===!0&&d(w,m?m.concat(v):[v])}),h.pop()}}if(!pe.isObject(t))throw new TypeError("data must be an object");return d(t),e}function x3(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function DN(t,e){this._pairs=[],t&&WE(t,this,e)}const z9=DN.prototype;z9.append=function(e,r){this._pairs.push([e,r])};z9.toString=function(e){const r=e?function(n){return e.call(this,n,x3)}:x3;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function Zae(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function G9(t,e,r){if(!e)return t;const n=r&&r.encode||Zae;pe.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(e,r):s=pe.isURLSearchParams(e)?e.toString():new DN(e,r).toString(n),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class b3{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){pe.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Y9={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ele=typeof URLSearchParams<"u"?URLSearchParams:DN,tle=typeof FormData<"u"?FormData:null,rle=typeof Blob<"u"?Blob:null,nle={isBrowser:!0,classes:{URLSearchParams:ele,FormData:tle,Blob:rle},protocols:["http","https","file","blob","url","data"]},FN=typeof window<"u"&&typeof document<"u",LO=typeof navigator=="object"&&navigator||void 0,ile=FN&&(!LO||["ReactNative","NativeScript","NS"].indexOf(LO.product)<0),sle=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ole=FN&&window.location.href||"http://localhost",ale=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:FN,hasStandardBrowserEnv:ile,hasStandardBrowserWebWorkerEnv:sle,navigator:LO,origin:ole},Symbol.toStringTag,{value:"Module"})),ki={...ale,...nle};function lle(t,e){return WE(t,new ki.classes.URLSearchParams,{visitor:function(r,n,i,s){return ki.isNode&&pe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function cle(t){return pe.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function ule(t){const e={},r=Object.keys(t);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],e[s]=t[s];return e}function K9(t){function e(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=r.length;return o=!o&&pe.isArray(i)?i.length:o,l?(pe.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!a):((!i[o]||!pe.isObject(i[o]))&&(i[o]=[]),e(r,n,i[o],s)&&pe.isArray(i[o])&&(i[o]=ule(i[o])),!a)}if(pe.isFormData(t)&&pe.isFunction(t.entries)){const r={};return pe.forEachEntry(t,(n,i)=>{e(cle(n),i,r,0)}),r}return null}function hle(t,e,r){if(pe.isString(t))try{return(e||JSON.parse)(t),pe.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const qy={transitional:Y9,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=pe.isObject(e);if(s&&pe.isHTMLForm(e)&&(e=new FormData(e)),pe.isFormData(e))return i?JSON.stringify(K9(e)):e;if(pe.isArrayBuffer(e)||pe.isBuffer(e)||pe.isStream(e)||pe.isFile(e)||pe.isBlob(e)||pe.isReadableStream(e))return e;if(pe.isArrayBufferView(e))return e.buffer;if(pe.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return lle(e,this.formSerializer).toString();if((a=pe.isFileList(e))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return WE(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),hle(e)):e}],transformResponse:[function(e){const r=this.transitional||qy.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(pe.isResponse(e)||pe.isReadableStream(e))return e;if(e&&pe.isString(e)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?dt.from(a,dt.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ki.classes.FormData,Blob:ki.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};pe.forEach(["delete","get","head","post","put","patch"],t=>{qy.headers[t]={}});const fle=pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),dle=t=>{const e={};let r,n,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||e[r]&&fle[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},_3=Symbol("internals");function f0(t){return t&&String(t).trim().toLowerCase()}function Ax(t){return t===!1||t==null?t:pe.isArray(t)?t.map(Ax):String(t)}function gle(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const mle=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function KT(t,e,r,n,i){if(pe.isFunction(n))return n.call(this,e,r);if(i&&(e=r),!!pe.isString(e)){if(pe.isString(n))return e.indexOf(n)!==-1;if(pe.isRegExp(n))return n.test(e)}}function ple(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function vle(t,e){const r=pe.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(i,s,o){return this[n].call(this,e,i,s,o)},configurable:!0})})}let As=class{constructor(e){e&&this.set(e)}set(e,r,n){const i=this;function s(a,l,c){const u=f0(l);if(!u)throw new Error("header name must be a non-empty string");const h=pe.findKey(i,u);(!h||i[h]===void 0||c===!0||c===void 0&&i[h]!==!1)&&(i[h||l]=Ax(a))}const o=(a,l)=>pe.forEach(a,(c,u)=>s(c,u,l));if(pe.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(pe.isString(e)&&(e=e.trim())&&!mle(e))o(dle(e),r);else if(pe.isObject(e)&&pe.isIterable(e)){let a={},l,c;for(const u of e){if(!pe.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?pe.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,r)}else e!=null&&s(r,e,n);return this}get(e,r){if(e=f0(e),e){const n=pe.findKey(this,e);if(n){const i=this[n];if(!r)return i;if(r===!0)return gle(i);if(pe.isFunction(r))return r.call(this,i,n);if(pe.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=f0(e),e){const n=pe.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||KT(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let i=!1;function s(o){if(o=f0(o),o){const a=pe.findKey(n,o);a&&(!r||KT(n,n[a],a,r))&&(delete n[a],i=!0)}}return pe.isArray(e)?e.forEach(s):s(e),i}clear(e){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!e||KT(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const r=this,n={};return pe.forEach(this,(i,s)=>{const o=pe.findKey(n,s);if(o){r[o]=Ax(i),delete r[s];return}const a=e?ple(s):String(s).trim();a!==s&&delete r[s],r[a]=Ax(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return pe.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=e&&pe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[_3]=this[_3]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=f0(o);n[a]||(vle(i,o),n[a]=!0)}return pe.isArray(e)?e.forEach(s):s(e),this}};As.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);pe.reduceDescriptors(As.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});pe.freezeMethods(As);function XT(t,e){const r=this||qy,n=e||r,i=As.from(n.headers);let s=n.data;return pe.forEach(t,function(a){s=a.call(r,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function X9(t){return!!(t&&t.__CANCEL__)}function Dp(t,e,r){dt.call(this,t??"canceled",dt.ERR_CANCELED,e,r),this.name="CanceledError"}pe.inherits(Dp,dt,{__CANCEL__:!0});function q9(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new dt("Request failed with status code "+r.status,[dt.ERR_BAD_REQUEST,dt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function wle(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function yle(t,e){t=t||10;const r=new Array(t),n=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=n[s];o||(o=c),r[i]=l,n[i]=c;let h=s,f=0;for(;h!==i;)f+=r[h++],h=h%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),c-o<e)return;const d=u&&c-u;return d?Math.round(f*1e3/d):void 0}}function Cle(t,e){let r=0,n=1e3/e,i,s;const o=(c,u=Date.now())=>{r=u,i=null,s&&(clearTimeout(s),s=null),t(...c)};return[(...c)=>{const u=Date.now(),h=u-r;h>=n?o(c,u):(i=c,s||(s=setTimeout(()=>{s=null,o(i)},n-h)))},()=>i&&o(i)]}const jb=(t,e,r=3)=>{let n=0;const i=yle(50,250);return Cle(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-n,c=i(l),u=o<=a;n=o;const h={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(h)},r)},E3=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},R3=t=>(...e)=>pe.asap(()=>t(...e)),Sle=ki.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,ki.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(ki.origin),ki.navigator&&/(msie|trident)/i.test(ki.navigator.userAgent)):()=>!0,xle=ki.hasStandardBrowserEnv?{write(t,e,r,n,i,s){const o=[t+"="+encodeURIComponent(e)];pe.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),pe.isString(n)&&o.push("path="+n),pe.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ble(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function _le(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function J9(t,e,r){let n=!ble(e);return t&&(n||r==!1)?_le(t,e):e}const T3=t=>t instanceof As?{...t}:t;function bd(t,e){e=e||{};const r={};function n(c,u,h,f){return pe.isPlainObject(c)&&pe.isPlainObject(u)?pe.merge.call({caseless:f},c,u):pe.isPlainObject(u)?pe.merge({},u):pe.isArray(u)?u.slice():u}function i(c,u,h,f){if(pe.isUndefined(u)){if(!pe.isUndefined(c))return n(void 0,c,h,f)}else return n(c,u,h,f)}function s(c,u){if(!pe.isUndefined(u))return n(void 0,u)}function o(c,u){if(pe.isUndefined(u)){if(!pe.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function a(c,u,h){if(h in e)return n(c,u);if(h in t)return n(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,h)=>i(T3(c),T3(u),h,!0)};return pe.forEach(Object.keys({...t,...e}),function(u){const h=l[u]||i,f=h(t[u],e[u],u);pe.isUndefined(f)&&h!==a||(r[u]=f)}),r}const Q9=t=>{const e=bd({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:a}=e;e.headers=o=As.from(o),e.url=G9(J9(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(pe.isFormData(r)){if(ki.hasStandardBrowserEnv||ki.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...u]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(ki.hasStandardBrowserEnv&&(n&&pe.isFunction(n)&&(n=n(e)),n||n!==!1&&Sle(e.url))){const c=i&&s&&xle.read(s);c&&o.set(i,c)}return e},Ele=typeof XMLHttpRequest<"u",Rle=Ele&&function(t){return new Promise(function(r,n){const i=Q9(t);let s=i.data;const o=As.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=i,u,h,f,d,g;function m(){d&&d(),g&&g(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let p=new XMLHttpRequest;p.open(i.method.toUpperCase(),i.url,!0),p.timeout=i.timeout;function w(){if(!p)return;const y=As.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),T={data:!a||a==="text"||a==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:y,config:t,request:p};q9(function(x){r(x),m()},function(x){n(x),m()},T),p=null}"onloadend"in p?p.onloadend=w:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(w)},p.onabort=function(){p&&(n(new dt("Request aborted",dt.ECONNABORTED,t,p)),p=null)},p.onerror=function(){n(new dt("Network Error",dt.ERR_NETWORK,t,p)),p=null},p.ontimeout=function(){let b=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const T=i.transitional||Y9;i.timeoutErrorMessage&&(b=i.timeoutErrorMessage),n(new dt(b,T.clarifyTimeoutError?dt.ETIMEDOUT:dt.ECONNABORTED,t,p)),p=null},s===void 0&&o.setContentType(null),"setRequestHeader"in p&&pe.forEach(o.toJSON(),function(b,T){p.setRequestHeader(T,b)}),pe.isUndefined(i.withCredentials)||(p.withCredentials=!!i.withCredentials),a&&a!=="json"&&(p.responseType=i.responseType),c&&([f,g]=jb(c,!0),p.addEventListener("progress",f)),l&&p.upload&&([h,d]=jb(l),p.upload.addEventListener("progress",h),p.upload.addEventListener("loadend",d)),(i.cancelToken||i.signal)&&(u=y=>{p&&(n(!y||y.type?new Dp(null,t,p):y),p.abort(),p=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const v=wle(i.url);if(v&&ki.protocols.indexOf(v)===-1){n(new dt("Unsupported protocol "+v+":",dt.ERR_BAD_REQUEST,t));return}p.send(s||null)})},Tle=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,i;const s=function(c){if(!i){i=!0,a();const u=c instanceof Error?c:this.reason;n.abort(u instanceof dt?u:new Dp(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,s(new dt(`timeout ${e} of ms exceeded`,dt.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),t=null)};t.forEach(c=>c.addEventListener("abort",s));const{signal:l}=n;return l.unsubscribe=()=>pe.asap(a),l}},kle=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,i;for(;n<r;)i=n+e,yield t.slice(n,i),n=i},Ple=async function*(t,e){for await(const r of Ale(t))yield*kle(r,e)},Ale=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},k3=(t,e,r,n)=>{const i=Ple(t,e);let s=0,o,a=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await i.next();if(c){a(),l.close();return}let h=u.byteLength;if(r){let f=s+=h;r(f)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},jE=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Z9=jE&&typeof ReadableStream=="function",Ile=jE&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),e7=(t,...e)=>{try{return!!t(...e)}catch{return!1}},Ole=Z9&&e7(()=>{let t=!1;const e=new Request(ki.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),P3=64*1024,$O=Z9&&e7(()=>pe.isReadableStream(new Response("").body)),Ub={stream:$O&&(t=>t.body)};jE&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Ub[e]&&(Ub[e]=pe.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new dt(`Response type '${e}' is not supported`,dt.ERR_NOT_SUPPORT,n)})})})(new Response);const Mle=async t=>{if(t==null)return 0;if(pe.isBlob(t))return t.size;if(pe.isSpecCompliantForm(t))return(await new Request(ki.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(pe.isArrayBufferView(t)||pe.isArrayBuffer(t))return t.byteLength;if(pe.isURLSearchParams(t)&&(t=t+""),pe.isString(t))return(await Ile(t)).byteLength},Nle=async(t,e)=>{const r=pe.toFiniteNumber(t.getContentLength());return r??Mle(e)},Dle=jE&&(async t=>{let{url:e,method:r,data:n,signal:i,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:f}=Q9(t);c=c?(c+"").toLowerCase():"text";let d=Tle([i,s&&s.toAbortSignal()],o),g;const m=d&&d.unsubscribe&&(()=>{d.unsubscribe()});let p;try{if(l&&Ole&&r!=="get"&&r!=="head"&&(p=await Nle(u,n))!==0){let T=new Request(e,{method:"POST",body:n,duplex:"half"}),E;if(pe.isFormData(n)&&(E=T.headers.get("content-type"))&&u.setContentType(E),T.body){const[x,P]=E3(p,jb(R3(l)));n=k3(T.body,P3,x,P)}}pe.isString(h)||(h=h?"include":"omit");const w="credentials"in Request.prototype;g=new Request(e,{...f,signal:d,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:w?h:void 0});let v=await fetch(g,f);const y=$O&&(c==="stream"||c==="response");if($O&&(a||y&&m)){const T={};["status","statusText","headers"].forEach(A=>{T[A]=v[A]});const E=pe.toFiniteNumber(v.headers.get("content-length")),[x,P]=a&&E3(E,jb(R3(a),!0))||[];v=new Response(k3(v.body,P3,x,()=>{P&&P(),m&&m()}),T)}c=c||"text";let b=await Ub[pe.findKey(Ub,c)||"text"](v,t);return!y&&m&&m(),await new Promise((T,E)=>{q9(T,E,{data:b,headers:As.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:g})})}catch(w){throw m&&m(),w&&w.name==="TypeError"&&/Load failed|fetch/i.test(w.message)?Object.assign(new dt("Network Error",dt.ERR_NETWORK,t,g),{cause:w.cause||w}):dt.from(w,w&&w.code,t,g)}}),BO={http:qae,xhr:Rle,fetch:Dle};pe.forEach(BO,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const A3=t=>`- ${t}`,Fle=t=>pe.isFunction(t)||t===null||t===!1,t7={getAdapter:t=>{t=pe.isArray(t)?t:[t];const{length:e}=t;let r,n;const i={};for(let s=0;s<e;s++){r=t[s];let o;if(n=r,!Fle(r)&&(n=BO[(o=String(r)).toLowerCase()],n===void 0))throw new dt(`Unknown adapter '${o}'`);if(n)break;i[o||"#"+s]=n}if(!n){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(A3).join(`
`):" "+A3(s[0]):"as no adapter specified";throw new dt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:BO};function qT(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Dp(null,t)}function I3(t){return qT(t),t.headers=As.from(t.headers),t.data=XT.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),t7.getAdapter(t.adapter||qy.adapter)(t).then(function(n){return qT(t),n.data=XT.call(t,t.transformResponse,n),n.headers=As.from(n.headers),n},function(n){return X9(n)||(qT(t),n&&n.response&&(n.response.data=XT.call(t,t.transformResponse,n.response),n.response.headers=As.from(n.response.headers))),Promise.reject(n)})}const r7="1.11.0",UE={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{UE[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const O3={};UE.transitional=function(e,r,n){function i(s,o){return"[Axios v"+r7+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,a)=>{if(e===!1)throw new dt(i(o," has been removed"+(r?" in "+r:"")),dt.ERR_DEPRECATED);return r&&!O3[o]&&(O3[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(s,o,a):!0}};UE.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Hle(t,e,r){if(typeof t!="object")throw new dt("options must be an object",dt.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let i=n.length;for(;i-- >0;){const s=n[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new dt("option "+s+" must be "+l,dt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new dt("Unknown option "+s,dt.ERR_BAD_OPTION)}}const Ix={assertOptions:Hle,validators:UE},Ka=Ix.validators;let ad=class{constructor(e){this.defaults=e||{},this.interceptors={request:new b3,response:new b3}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=bd(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Ix.assertOptions(n,{silentJSONParsing:Ka.transitional(Ka.boolean),forcedJSONParsing:Ka.transitional(Ka.boolean),clarifyTimeoutError:Ka.transitional(Ka.boolean)},!1),i!=null&&(pe.isFunction(i)?r.paramsSerializer={serialize:i}:Ix.assertOptions(i,{encode:Ka.function,serialize:Ka.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ix.assertOptions(r,{baseUrl:Ka.spelling("baseURL"),withXsrfToken:Ka.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&pe.merge(s.common,s[r.method]);s&&pe.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),r.headers=As.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,h=0,f;if(!l){const g=[I3.bind(this),void 0];for(g.unshift(...a),g.push(...c),f=g.length,u=Promise.resolve(r);h<f;)u=u.then(g[h++],g[h++]);return u}f=a.length;let d=r;for(h=0;h<f;){const g=a[h++],m=a[h++];try{d=g(d)}catch(p){m.call(this,p);break}}try{u=I3.call(this,d)}catch(g){return Promise.reject(g)}for(h=0,f=c.length;h<f;)u=u.then(c[h++],c[h++]);return u}getUri(e){e=bd(this.defaults,e);const r=J9(e.baseURL,e.url,e.allowAbsoluteUrls);return G9(r,e.params,e.paramsSerializer)}};pe.forEach(["delete","get","head","options"],function(e){ad.prototype[e]=function(r,n){return this.request(bd(n||{},{method:e,url:r,data:(n||{}).data}))}});pe.forEach(["post","put","patch"],function(e){function r(n){return function(s,o,a){return this.request(bd(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}ad.prototype[e]=r(),ad.prototype[e+"Form"]=r(!0)});let Lle=class n7{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{n.subscribe(a),s=a}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},e(function(s,o,a){n.reason||(n.reason=new Dp(s,o,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new n7(function(i){e=i}),cancel:e}}};function $le(t){return function(r){return t.apply(null,r)}}function Ble(t){return pe.isObject(t)&&t.isAxiosError===!0}const VO={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(VO).forEach(([t,e])=>{VO[e]=t});function i7(t){const e=new ad(t),r=N9(ad.prototype.request,e);return pe.extend(r,ad.prototype,e,{allOwnKeys:!0}),pe.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return i7(bd(t,i))},r}const Xr=i7(qy);Xr.Axios=ad;Xr.CanceledError=Dp;Xr.CancelToken=Lle;Xr.isCancel=X9;Xr.VERSION=r7;Xr.toFormData=WE;Xr.AxiosError=dt;Xr.Cancel=Xr.CanceledError;Xr.all=function(e){return Promise.all(e)};Xr.spread=$le;Xr.isAxiosError=Ble;Xr.mergeConfig=bd;Xr.AxiosHeaders=As;Xr.formToJSON=t=>K9(pe.isHTMLForm(t)?new FormData(t):t);Xr.getAdapter=t7.getAdapter;Xr.HttpStatusCode=VO;Xr.default=Xr;const{Axios:yrt,AxiosError:Crt,CanceledError:Srt,isCancel:xrt,CancelToken:brt,VERSION:_rt,all:Ert,Cancel:Rrt,isAxiosError:Trt,spread:krt,toFormData:Prt,AxiosHeaders:Art,HttpStatusCode:Irt,formToJSON:Ort,getAdapter:Mrt,mergeConfig:Nrt}=Xr;IN("object/save",async(t,{rejectWithValue:e})=>{var r,n;try{return(await Xr.post("/objects",t)).data}catch(i){return e(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка при сохранении")}});IN("object/import",async(t,{rejectWithValue:e})=>{var r,n;try{return(await Xr.post("/objects/import",t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(i){return e(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка при импорте данных")}});const JT=IN("object/submitForm",async(t,{rejectWithValue:e})=>{var r,n;try{return(await Xr.post("/objects",t)).data}catch(i){return e(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||"Ошибка при отправке формы")}}),Vle={showObjectForm:!1,isLoading:!1,error:null},s7=O9({name:"objectForm",initialState:Vle,reducers:{showCreateForm:t=>{t.showObjectForm=!0},hideCreateForm:t=>{t.showObjectForm=!1}},extraReducers:t=>{t.addCase(JT.pending,e=>{e.isLoading=!0,e.error=null}).addCase(JT.fulfilled,e=>{e.isLoading=!1,e.showObjectForm=!1}).addCase(JT.rejected,(e,r)=>{e.isLoading=!1,e.error=r.error.message||"Ошибка сохранения"})}}),{showCreateForm:Wle,hideCreateForm:o7}=s7.actions,jle=s7.reducer,Ule="_wrapper_12zcq_1",zle="_header_12zcq_25",Gle="_backButton_12zcq_37",Yle="_title_12zcq_61",Kle="_form_12zcq_75",Xle="_inputs_12zcq_87",qle="_subTitle_12zcq_143",Jle="_searchPanel_12zcq_157",Qle="_searchInput_12zcq_171",Zle="_actions_12zcq_187",ece="_importBtn_12zcq_197",tce="_addRowBtn_12zcq_199",rce="_tableWrapper_12zcq_243",nce="_table_12zcq_243",ice="_emptyTable_12zcq_309",sce="_footer_12zcq_323",oce="_saveBtn_12zcq_333",ri={wrapper:Ule,header:zle,backButton:Gle,title:Yle,form:Kle,inputs:Xle,subTitle:qle,searchPanel:Jle,searchInput:Qle,actions:Zle,importBtn:ece,addRowBtn:tce,tableWrapper:rce,table:nce,emptyTable:ice,footer:sce,saveBtn:oce},a7=({onSubmit:t})=>{const e=MN(),[r,n]=me.useState([]),i=me.useRef(null),s=me.useRef(1),o=()=>s.current++,a=()=>{e(o7())},l=()=>{n(g=>[...g,{id:o(),name:"",type:"",profileDefined:"",scaleHorizontal:"",scaleVertical:""}])},c=(g,m,p)=>{n(w=>w.map(v=>v.id===g?{...v,[m]:p}:v))},u=g=>{n(m=>m.filter(p=>p.id!==g))},h=()=>{var g;(g=i.current)==null||g.click()},f=g=>{const m=g.split(/\r?\n/).map(E=>E.trim()).filter(Boolean);if(!m.length)return[];const p=m[0],w=p.includes(";")?";":p.includes("	")?"	":",",v=m.map(E=>E.split(w).map(x=>x.trim())),b=(E=>E.some(x=>/наимен|тип|профил|масшт|name|type|profile|scale/i.test(x)))(v[0])?1:0,T=E=>{let x=[...E];x.length>=6&&/^\d+$/.test(x[0])&&(x=x.slice(1));const[P="",A="",O="",Y="",B=""]=x;return{id:o(),name:P,type:A,profileDefined:O,scaleHorizontal:Y,scaleVertical:B}};return v.slice(b).map(T).filter(E=>Object.values(E).some(Boolean))},d=async g=>{var w,v;const m=(w=g.target.files)==null?void 0:w[0];if(i.current&&(i.current.value=""),!m)return;const p=(v=m.name.split(".").pop())==null?void 0:v.toLowerCase();try{if(p==="csv"||p==="txt"){const y=await m.text(),b=f(y);if(!b.length){kt.info("Файл прочитан, но данных не найдено");return}n(T=>[...T,...b]),kt.success(`Импортировано строк: ${b.length}`);return}if(p==="json"){const y=await m.text(),T=(JSON.parse(y)||[]).map(E=>({id:o(),name:E.name??"",type:E.type??"",profileDefined:E.profileDefined??"",scaleHorizontal:E.scaleHorizontal??"",scaleVertical:E.scaleVertical??""}));if(!T.length){kt.info("JSON прочитан, но данных не найдено");return}n(E=>[...E,...T]),kt.success(`Импортировано строк: ${T.length}`);return}if(p==="xlsx"||p==="xls")try{const y=await uae(()=>Promise.resolve().then(()=>dSe),void 0),b=await m.arrayBuffer(),T=y.read(b,{type:"array"}),E=T.Sheets[T.SheetNames[0]],x=y.utils.sheet_to_json(E,{header:1});if(!x||!x.length){kt.info("Лист Excel пуст");return}const A=(Y=>Y.some(B=>typeof B=="string"&&/наимен|тип|профил|масшт|name|type|profile|scale/i.test(B)))(x[0])?1:0,O=x.slice(A).map(Y=>Array.isArray(Y)?Y:[]).map(Y=>{let B=[...Y];B.length>=6&&typeof B[0]=="number"&&(B=B.slice(1));const[ie="",ue="",he="",Ee="",Ce=""]=B;return{id:o(),name:String(ie??""),type:String(ue??""),profileDefined:String(he??""),scaleHorizontal:String(Ee??""),scaleVertical:String(Ce??"")}}).filter(Y=>Object.values(Y).some(Boolean));if(!O.length){kt.info("Excel прочитан, но данных не найдено");return}n(Y=>[...Y,...O]),kt.success(`Импортировано строк: ${O.length}`);return}catch{kt.error("Для импорта .xlsx установите пакет: npm i xlsx @types/xlsx");return}kt.error("Поддерживаются форматы: .csv, .json, .xlsx, .xls")}catch(y){console.error(y),kt.error("Не удалось импортировать файл")}};return F.jsxs("div",{className:ri.wrapper,children:[F.jsxs("div",{className:ri.header,children:[F.jsx("button",{className:ri.backButton,onClick:a}),F.jsx("h1",{className:ri.title,children:"Создание объекта"})]}),F.jsxs("form",{className:ri.form,onSubmit:g=>{g.preventDefault();const m=new FormData(g.currentTarget),p={name:m.get("name")||"",code:m.get("code")||"",contractNumber:m.get("contractNumber")||void 0,contractDate:m.get("contractDate")||void 0,designation:m.get("designation")||void 0,customer:m.get("customer")||void 0,contractor:m.get("contractor")||void 0,tableRows:r};t(p)},children:[F.jsxs("div",{className:ri.inputs,children:[F.jsxs("label",{children:["Наименование объекта",F.jsx("input",{name:"name",placeholder:"Введите наименование",required:!0})]}),F.jsxs("label",{children:["Код объекта",F.jsx("input",{name:"code",placeholder:"Введите код",required:!0})]}),F.jsxs("label",{children:["Номер контракта",F.jsx("input",{name:"contractNumber",placeholder:"Введите номер"})]}),F.jsxs("label",{children:["Дата контракта",F.jsx("input",{name:"contractDate",type:"date"})]}),F.jsxs("label",{children:["Назначение",F.jsx("input",{name:"designation",placeholder:"Введите назначение"})]}),F.jsxs("label",{children:["Заказчик",F.jsx("input",{name:"customer",placeholder:"Введите заказчика"})]}),F.jsxs("label",{children:["Подрядчик",F.jsx("input",{name:"contractor",placeholder:"Введите подрядчика"})]})]}),F.jsx("h2",{className:ri.subTitle,children:"Перечень графических приложений"}),F.jsxs("div",{className:ri.searchPanel,children:[F.jsx("input",{type:"text",placeholder:"Поиск...",className:ri.searchInput}),F.jsxs("div",{className:ri.actions,children:[F.jsx("button",{type:"button",className:ri.importBtn,onClick:h,children:"Импорт"}),F.jsx("button",{type:"button",className:ri.addRowBtn,onClick:l,children:"+ Добавить строку"})]})]}),F.jsx("input",{ref:i,type:"file",accept:".csv,.json,.xlsx,.xls,.txt",style:{display:"none"},onChange:d}),F.jsx("div",{className:ri.tableWrapper,children:F.jsxs("table",{className:ri.table,children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{children:"№"}),F.jsx("th",{children:"Наименование графического приложения"}),F.jsx("th",{children:"Тип объекта"}),F.jsx("th",{children:"Профиль определен"}),F.jsx("th",{children:"Масштаб (гор.)"}),F.jsx("th",{children:"Масштаб (верт.)"}),F.jsx("th",{})]})}),F.jsx("tbody",{children:r.length===0?F.jsx("tr",{children:F.jsx("td",{colSpan:7,className:ri.emptyTable,children:"Данных нет"})}):r.map((g,m)=>F.jsxs("tr",{children:[F.jsx("td",{children:m+1}),F.jsx("td",{children:F.jsx("input",{value:g.name,onChange:p=>c(g.id,"name",p.target.value)})}),F.jsx("td",{children:F.jsx("input",{value:g.type,onChange:p=>c(g.id,"type",p.target.value)})}),F.jsx("td",{children:F.jsx("input",{value:g.profileDefined,onChange:p=>c(g.id,"profileDefined",p.target.value)})}),F.jsx("td",{children:F.jsx("input",{value:g.scaleHorizontal,onChange:p=>c(g.id,"scaleHorizontal",p.target.value)})}),F.jsx("td",{children:F.jsx("input",{value:g.scaleVertical,onChange:p=>c(g.id,"scaleVertical",p.target.value)})}),F.jsx("td",{children:F.jsx("button",{type:"button",onClick:()=>u(g.id),children:"✕"})})]},g.id))})]})}),F.jsx("div",{className:ri.footer,children:F.jsx("button",{type:"submit",className:ri.saveBtn,children:"Сохранить"})})]})]})},ace="_content__header_1ss6r_77",lce="_content__title_1ss6r_91",cce="_content__createButton_1ss6r_101",uce="_content__createIcon_1ss6r_151",hce="_content__empty_1ss6r_167",fce="_content__emptyTitle_1ss6r_191",dce="_content__emptyText_1ss6r_201",Yh={content__header:ace,content__title:lce,content__createButton:cce,content__createIcon:uce,content__empty:hce,content__emptyTitle:fce,content__emptyText:dce},gce=()=>{const t=MN(),{showObjectForm:e}=aae(n=>n.objectForm),r=()=>{t(Wle())};return F.jsx(F.Fragment,{children:e?F.jsx(a7,{onSubmit:n=>{console.log("Форма отправлена:",n)}}):F.jsxs(F.Fragment,{children:[F.jsxs("div",{className:Yh.content__header,children:[F.jsx("h2",{className:Yh.content__title,children:"Объекты"}),F.jsxs("button",{className:Yh.content__createButton,onClick:r,children:[F.jsx("div",{className:Yh.content__createIcon}),F.jsx("span",{children:"Создать объект"})]})]}),F.jsxs("div",{className:Yh.content__empty,children:[F.jsx("p",{className:Yh.content__emptyTitle,children:"Пока пусто"}),F.jsx("p",{className:Yh.content__emptyText,children:"Ваши объекты будут здесь"})]})]})})};function mce(t,e){for(const r in t)e(t[r],r)}function Ra(t,e){t.forEach(e)}function Es(t,e,r){if(!t)throw Error(`${r?r+": ":""}${e}`)}function Rh({node:t=[],from:e,source:r,parent:n=e||r,to:i,target:s,child:o=i||s,scope:a={},meta:l={},family:c={type:"regular"},regional:u}={}){const h=lC(n),f=lC(c.links),d=lC(c.owners),g=[];Ra(t,p=>p&&bc(g,p));const m={id:kce(),seq:g,next:lC(o),meta:l,scope:a,family:{triggers:h.length,type:c.type||"crosslink",links:f,owners:d}};return Ra(f,p=>bc(GE(p),m)),Ra(d,p=>bc(YE(p),m)),Ra(h,p=>bc(p.next,m)),m}function Kw(t,e,r){let n,i=_c,s=null,o=Sr;if(t.target&&(e=t.params,r=t.defer,n=t.meta,i="page"in t?t.page:i,t.stack&&(s=t.stack),o=Em(t)||o,t=t.target),o&&Sr&&o!==Sr&&(Sr=null),Array.isArray(t))for(let g=0;g<t.length;g++)Kh("pure",i,oo(t[g]),s,e[g],o,n);else Kh("pure",i,oo(t),s,e,o,n);if(r&&!cC)return;const a={isRoot:cC,currentPage:_c,scope:Sr,isWatch:Nx,isPure:Dx};let l,c,u,h,f,d;cC=0;e:for(;h=Vce();){const{idx:g,stack:m,type:p}=h;u=m.node,_c=f=m.page,Sr=Em(m),f?d=f.reg:Sr&&(d=Sr.reg);const w=!!f,v=!!Sr,y={fail:0,scope:u.scope};l=c=0;for(let b=g;b<u.seq.length&&!l;b++){const T=u.seq[b];if(T.order){const{priority:E,barrierID:x}=T.order,P=x?f?`${f.fullID}_${x}`:x:0;if(b!==g||p!==E){x?ek.has(P)||(ek.add(P),jO(b,m,E,x)):jO(b,m,E,0);continue e}x&&ek.delete(P)}switch(T.type){case"mov":{const x=T.data;let P;switch(x.from){case"stack":P=Ox(m);break;case"a":case"b":P=m[x.from];break;case"value":P=x.store;break;case"store":if(d&&!d[x.store.id])if(w){const A=m7(f,x.store.id);m.page=f=A,A?d=A.reg:v?(fp(Sr,x.store,0,1,x.softRead),d=Sr.reg):d=void 0}else v&&fp(Sr,x.store,0,1,x.softRead);P=g7(d&&d[x.store.id]||x.store)}switch(x.to){case"stack":m.value=P;break;case"a":case"b":m[x.to]=P;break;case"store":Wce(f,Sr,x.target,0).current=P}break}case"compute":const E=T.data;if(E.fn){Nx=u.meta.op==="watch",Dx=E.pure;const x=E.safe?(0,E.fn)(Ox(m),y.scope,m):Uce(y,E.fn,m);E.filter?c=!x:m.value=x,Nx=a.isWatch,Dx=a.isPure}}l=y.fail||c}if(!l){const b=Ox(m),T=Em(m);if(Ra(u.next,E=>{Kh("child",f,E,m,b,T)}),T){u.meta.needFxCounter&&Kh("child",f,T.fxCount,m,b,T),u.meta.storeChange&&Kh("child",f,T.storeChange,m,b,T),u.meta.warnSerialize&&Kh("child",f,T.warnSerializeNode,m,b,T);const E=T.additionalLinks[u.id];E&&Ra(E,x=>{Kh("child",f,x,m,b,T)})}}}cC=a.isRoot,_c=a.currentPage,Sr=Em(a)}function pce(t,e){let r,n;const i=t;if(e){const s=xce(e);t.length===0?(r=s.path,n=s.fullName):(r=s.path.concat([t]),n=s.fullName.length===0?t:s.fullName+"/"+t)}else r=t.length===0?[]:[t],n=t;return{shortName:i,fullName:n,path:r}}function HN(t,e){if(!e||!e.name&&!e.named&&!e.loc)return t;let r=`[${t}]`;const n=e.named||e.name;n&&(r+=` unit '${n}'`);const i=e.loc;return!n&&i&&(r+=` (${i.file}:${i.line}:${i.column})`),r}function WO(t){const e=()=>t();return e.unsubscribe=()=>t(),e}function zv(t,...e){}function Yc(t,e){const r=dp({or:e,and:typeof t=="string"?{name:t}:t}),n=HN("event",r),i=(a,...l)=>(Es(!Dc(i,"derived"),"call of derived event is not supported, use createEvent instead",n),Es(!Dx,"unit call from pure function is not supported, use operators like sample instead",n),_c?((c,u,h,f)=>{const d=_c;H3(null);const m=c.create(h,f);return H3(d),m})(i,s,a,l):i.create(a,l)),s=Ice(),o=Object.assign(i,{graphite:Rh({meta:v7(r.actualOp||"event",i,r,WN()),regional:1}),create:a=>(Kw({target:i,params:a,scope:Sr}),a),watch:a=>p7(i,a),map:a=>tk(i,Xw,a,[Rm()]),filter:a=>tk(i,"filter",a.fn?a:a.fn,[Rm(JE,1)]),filterMap:a=>tk(i,"filterMap",a,[Rm(),Um(l=>!Gv(l),1)]),prepend(a){Es(i.targetable,".prepend of derived event is not supported, call source event instead",n);const l=Yc("* → "+i.shortName,{parent:qw(i)});return zv("eventPrepend",oo(l)),VN(l,i,[Rm()],"prepend",a),Gce(i,l),l}});return r!=null&&r.domain&&r.domain.hooks.event(o),Pl(o,"id",o.graphite.id),h7(o.graphite),o}function M3(t,e,r,n,i){return Nce(r,`${i} ${e}`,"first argument"),Es(Ta(n),"second argument should be a function",i),Gb(!Dc(t,"derived"),`${e} in derived store`,`${e} in store created via createStore`,i),Ra(Array.isArray(r)?r:[r],s=>{t.off(s),w7(s,t,"on",Fce,n)}),t}function zE(t,e){const r=dp(e),n=$ce(t),i=HN("store",r),s=Yc({named:"updates",derived:1});zv("storeBase",n);const o=n.id,a="skipVoid"in r,l=a&&!r.skipVoid;Gb(!(a&&r.skipVoid),"{skipVoid: true}","updateFilter",i);const c={updates:s,defaultState:t,stateRef:n,getState(){let w,v=n;if(_c){let y=_c;for(;y&&!y.reg[o];)y=qw(y);y&&(w=y)}return!w&&Sr&&(fp(Sr,n,1),w=Sr),w&&(v=w.reg[o]),g7(v)},setState:w=>Kw({target:c,params:w,defer:1,scope:Sr}),reset:(...w)=>(Es(c.targetable,".reset of derived store is not supported",i),Ra(w,v=>M3(c,".reset",v,()=>c.defaultState,i)),c),on:(w,v)=>(Es(c.targetable,".on of derived store is not supported",i),M3(c,".on",w,v,i)),off(w){const v=oo(w).id,y=oo(c).family.links.find(b=>b.meta.onTrigger===v);return y&&Yb(y),c},map(w,v){let y,b;Ud(w)&&(y=w,w=w.fn);const T=c.getState(),E=Gv(T);(!E||E&&l)&&(b=w(T));const x=zE(b,{name:`${c.shortName} → *`,derived:1,...v,and:y}),P=w7(c,x,Xw,JE,w);return Bce(zb(x),{type:Xw,fn:w,from:n}),zb(x).noInit=1,zv("storeMap",n,P),x},watch(w,v){if(Gb(!v,"watch second argument","sample",i),!v||!KE(w)){const y=p7(c,w);return zv("storeWatch",n,w)||w(c.getState()),y}return Es(Ta(v),"second argument should be a function",i),w.watch(y=>v(c.getState(),y))}},u=v7("store",c,r,WN()),h=c.defaultConfig.updateFilter;c.graphite=Rh({scope:{state:n,fn:h},node:[Um((w,v,y)=>(y.scope&&!y.scope.reg[n.id]&&(y.b=1),w)),Lce(n),Um((w,v,{a:y,b})=>{const T=Gv(w);return T&&!a&&Rce(`${rk}`,c.graphite),(T&&l||!T)&&(w!==y||b)},1),h&&Rm(Dce,1),QE({from:"stack",target:n})],child:s,meta:{...u,defaultState:t,stateRef:n},regional:1}),Pl(c,"id",c.graphite.id),Pl(c,"rootStateRefId",o);const f=Dc(c,"serialize"),d=Dc(c,"derived"),g=f==="ignore",m=Dc(c,"sid");m&&(Pl(c,"storeChange",1),n.sid=m),m||g||d||Pl(c,"warnSerialize",1);const p=Gv(t);return Es(d||!p||p&&l,rk,i),d&&p&&!a&&console.error(`${i}: ${rk}`),f7(c,[s]),r!=null&&r.domain&&r.domain.hooks.store(c),d||(c.reinit=Yc({named:"reinit"}),c.reset(c.reinit)),n.meta=c.graphite.meta,h7(c.graphite),c}function vce(){const t={};return t.req=new Promise((e,r)=>{t.rs=e,t.rj=r}),t.req.catch(()=>{}),t}function l7(t,e={}){const r=dp(Ta(t)?{handler:t}:t,e),n=HN("effect",r),i=Yc(Ta(t)?{handler:t}:t,{...e,actualOp:"effect"});Yce(i,WN());const s=oo(i);Pl(s,"op",i.kind="effect"),i.use=g=>(Es(Ta(g),".use argument should be a function",n),h.scope.handler=g,i),i.use.getCurrent=()=>h.scope.handler;const o=i.finally=Yc({named:"finally",derived:1}),a=i.done=o.filterMap({named:"done",fn({status:g,params:m,result:p}){if(g==="done")return{params:m,result:p}}}),l=i.fail=o.filterMap({named:"fail",fn({status:g,params:m,error:p}){if(g==="fail")return{params:m,error:p}}}),c=i.doneData=a.map({named:"doneData",fn:({result:g})=>g}),u=i.failData=l.map({named:"failData",fn:({error:g})=>g}),h=Rh({scope:{handler:i.defaultConfig.handler||(()=>Es(0,`no handler used in ${i.compositeName.fullName}`))},node:[Um((g,m,p)=>{let w=m.handler;const v=Em(p);if(v){const y=v.handlers.unitMap.get(i)||v.handlers.sidMap[i.sid];y&&(w=y)}return g.handler=w,g},0,1),Um((g,m,p)=>{if(m.runnerFn&&!m.runnerFn(g,null,p))return;const{params:w,req:v,handler:y,args:b=[w]}=g,T=B3(w,v,1,o,p),E=B3(w,v,0,o,p),[x,P]=Kce(y,E,b);x&&(Ud(P)&&Ta(P.then)?P.then(T,E):T(P))},0,1)],meta:{op:"fx",fx:"runner"},regional:1});s.scope.runner=h,bc(s.seq,Um((g,{runner:m},p)=>{const w=qw(p)?{params:g,req:{rs(v){},rj(v){}}}:g;return p.meta||(p.meta={fxID:Pce()}),Kw({target:m,params:w,defer:1,scope:Em(p),meta:p.meta}),w.params})),i.create=g=>{const m=vce(),p={params:g,req:m};if(Sr&&!Nx){const w=Sr;m.req.finally(()=>{zO(w)}).catch(()=>{})}return Kw({target:i,params:p,scope:Sr}),m.req};const f=i.inFlight=zE(0,{serialize:"ignore",named:(Dc(i,"name")||i.graphite.id)+".inFlight"}).on(i,g=>g+1).on(o,g=>g-1).map({fn:g=>g,named:"inFlight"});Pl(o,"needFxCounter","dec"),Pl(i,"needFxCounter",1);const d=i.pending=f.map({fn:g=>g>0,named:"pending"});return f7(i,[o,a,l,c,u,d,f]),r!=null&&r.domain&&r.domain.hooks.effect(i),i}function wce(t,{scope:e,safe:r}={}){Es(e||Sr||r,"scopeBind: scope not found");const n=e||Sr;return(...i)=>{function s(){zO(l)}let o,a=0;const l=Sr;zO(n);try{o=t(...i)}catch(c){o=c,a=1}if(s(),a)throw o;return o instanceof Promise&&o.then(s,s),o}}function yce({unit:t,fn:e,scope:r,batch:n}){const i=[Mx.run({fn:o=>e(o)})];i.unshift(Mx.compute({priority:"sampler",batch:1})),XE(t)&&i.unshift(Mx.mov({store:t.stateRef,to:"stack"}));const s=Array.isArray(t)?t:[t];if(r){const o=[],a=r.additionalLinks;return s.forEach(l=>{const c=a[l.graphite.id]||[];a[l.graphite.id]=c;const u=Rh({node:Cce(i,l),meta:{watchOp:l.kind}});c.push(u),o.push(()=>{const h=c.indexOf(u);h!==-1&&c.splice(h,1),Yb(u)})}),WO(()=>{o.forEach(l=>l())})}{const o=Rh({node:i,parent:s,family:{owners:s}});return WO(()=>{Yb(o)})}}function Cce(t,e){return XE(e)?[Mx.mov({store:e.stateRef,to:"stack"}),...t]:t}const Sce=typeof Symbol<"u"&&Symbol.observable||"@@observable",Xw="map",oo=t=>t.graphite||t,GE=t=>t.family.owners,YE=t=>t.family.links,zb=t=>t.stateRef,Ox=t=>t.value,qw=t=>t.parent,Em=t=>t.scope,Dc=(t,e)=>oo(t).meta[e],Pl=(t,e,r)=>oo(t).meta[e]=r,xce=t=>t.compositeName,KE=t=>(Ta(t)||Ud(t))&&"kind"in t,Jy=t=>e=>KE(e)&&e.kind===t,XE=Jy("store"),bce=Jy("event"),N3=Jy("effect"),_ce=t=>KE(t)&&!!t.targetable,c7=Jy("domain"),Ece=Jy("scope");var aC={__proto__:null,unit:KE,store:XE,event:bce,effect:N3,targetable:_ce,domain:c7,scope:Ece,attached:t=>N3(t)&&Dc(t,"attached")==1};const QT=(t,e)=>t.includes(e),ZT=(t,e)=>{const r=t.indexOf(e);r!==-1&&t.splice(r,1)},bc=(t,e)=>t.push(e),Gb=(t,e,r,n)=>!t&&console.error(`${n?n+": ":""}${e} is deprecated${r?`, use ${r} instead`:""}`),Rce=(t,e)=>{const r=Dc(e,"unitTrace"),n=Dc(e,"config"),i=n!=null&&n.loc?` at ${n.loc.file}`:null,s=n==null?void 0:n.name;let o=t;s&&(o=`${s}: ${t}`),i&&(o=`${s}${i}: ${t}`);const a=Error(o);r&&(a.stack=r),r||s||i||console.log(`Add effector's Babel or SWC plugin to your config for more detailed debug information or "import "effector/enable_debug_traces" to your code entry module to see full stack traces`),console.error(a)},qE=()=>{let t=0;return()=>""+ ++t},Tce=qE(),u7=qE(),kce=qE(),Pce=qE();let Ace=null;const h7=t=>{},Ice=()=>Ace,Oce=t=>t,f7=(t,e)=>{const r=oo(t);Ra(e,n=>{const i=oo(n);r.family.type!=="domain"&&(i.family.type="crosslink"),bc(GE(i),r),bc(YE(r),i)})},lC=(t=[])=>(Array.isArray(t)?t:[t]).flat().map(oo),Ud=t=>typeof t=="object"&&t!==null,Ta=t=>typeof t=="function",Gv=t=>t===void 0,Mce=t=>Es(Ud(t)||Ta(t),"expect first argument be an object"),D3=(t,e,r,n)=>Es(!(!Ud(t)&&!Ta(t)||!("family"in t)&&!("graphite"in t)),`${e}: expect ${r} to be a unit (store, event or effect)${n}`),Nce=(t,e,r)=>{Array.isArray(t)?Ra(t,(n,i)=>D3(n,e,`${i} item of ${r}`,"")):D3(t,e,r," or array of units")},Dce=(t,{fn:e},{a:r})=>e(t,r),Fce=(t,{fn:e},{a:r})=>e(r,t),JE=(t,{fn:e})=>e(t),d7=(t,e,r,n)=>{const i={id:u7(),type:t,data:e};return r&&(i.order={priority:r},n&&(i.order.barrierID=++Hce)),i};let Hce=0;const QE=({from:t="store",store:e,target:r,to:n=r?"store":"stack",batch:i,priority:s})=>d7("mov",{from:t,store:e,to:n,target:r},s,i),Jw=({fn:t,batch:e,priority:r,safe:n=0,filter:i=0,pure:s=0})=>d7("compute",{fn:t,safe:n,filter:i,pure:s},r,e),LN=({fn:t})=>Jw({fn:t,priority:"effect"}),Um=(t,e,r)=>Jw({fn:t,safe:1,filter:e,priority:r&&"effect"}),Lce=(t,e,r)=>QE({store:t,to:"a",priority:r,batch:1}),Rm=(t=JE,e)=>Jw({fn:t,pure:1,filter:e}),Mx={mov:QE,compute:Jw,filter:({fn:t,pure:e})=>Jw({fn:t,filter:1,pure:e}),run:LN},$ce=t=>({id:u7(),current:t,initial:t}),g7=({current:t})=>t,Bce=(t,e)=>{t.before||(t.before=[]),bc(t.before,e)};let Tm=null;const $N=(t,e)=>{if(!t)return e;if(!e)return t;let r;return(t.v.type===e.v.type&&t.v.id>e.v.id||UO(t.v.type)>UO(e.v.type))&&(r=t,t=e,e=r),r=$N(t.r,e),t.r=t.l,t.l=r,t},BN=[];let F3=0;for(;F3<6;)bc(BN,{first:null,last:null,size:0}),F3+=1;const Vce=()=>{for(let t=0;t<6;t++){const e=BN[t];if(e.size>0){if(t===3||t===4){e.size-=1;const n=Tm.v;return Tm=$N(Tm.l,Tm.r),n}e.size===1&&(e.last=null);const r=e.first;return e.first=r.r,e.size-=1,r.v}}},Kh=(t,e,r,n,i,s,o)=>jO(0,{a:null,b:null,node:r,parent:n,value:i,page:e,scope:s,meta:o},t,0),jO=(t,e,r,n)=>{const i=UO(r),s=BN[i],o={v:{idx:t,stack:e,type:r,id:n},l:null,r:null};i===3||i===4?Tm=$N(Tm,o):(s.size===0?s.first=o:s.last.r=o,s.last=o),s.size+=1},UO=t=>{switch(t){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},ek=new Set;let Sr,cC=1,Nx=0,Dx=0,_c=null;const zO=t=>{Sr=t},H3=t=>{_c=t},m7=(t,e)=>{if(t){for(;t&&!t.reg[e];)t=t.parent;if(t)return t}return null},Wce=(t,e,r,n)=>{const i=m7(t,r.id);return i?i.reg[r.id]:e?(fp(e,r,n),e.reg[r.id]):r},jce=t=>t,fp=(t,e,r,n,i)=>{const s=t.reg;if(s[e.id])return;const o=e.sid,a={id:e.id,current:e.initial,meta:e.meta};if(a.id in t.values.idMap)a.current=t.values.idMap[a.id];else if(o&&o in t.values.sidMap&&!(o in t.sidIdMap)){var l;const c=e==null||(l=e.meta)===null||l===void 0?void 0:l.serialize;a.current=(t.fromSerialize&&c!=="ignore"&&(c==null?void 0:c.read)||jce)(t.values.sidMap[o])}else if(e.before&&!i){let c=0;const u=r||!e.noInit||n;Ra(e.before,h=>{switch(h.type){case"map":{const f=h.from;if((f||h.fn)&&(f&&fp(t,f,r,n),u)){const d=f&&s[f.id].current;a.current=h.fn?h.fn(d):d}break}case"field":fp(t,h.from,r,n),c||(c=1,a.current=Array.isArray(a.current)?[...a.current]:{...a.current}),u&&(a.current[h.field]=s[s[h.from.id].id].current)}})}o&&(t.sidIdMap[o]=e.id),s[e.id]=a},Uce=(t,e,r)=>{try{return e(Ox(r),t.scope,r)}catch(n){console.error(n),t.fail=1,t.failReason=n}},dp=(t,e={})=>(Ud(t)&&(dp(t.or,e),mce(t,(r,n)=>{Gv(r)||n==="or"||n==="and"||(e[n]=r)}),dp(t.and,e)),e),L3=(t,e)=>{ZT(t.next,e),ZT(GE(t),e),ZT(YE(t),e)},$3=["on","reset","sample","split","merge","guard","forward"],Fx=(t,e,r,n,i)=>{let s;t.next.length=0,t.seq.length=0,t.scope=null;let o=YE(t);const{stateRef:a,defaultShape:l,isRegion:c,op:u}=t.meta;if(a&&(a.before=[],t.meta.stateRef=null),l)for(const f in l)l[f]=null;const h=c?t:n;if(o.length>0){const f=QT($3,u),d=!c&&!i,g=d&&r&&!f;for(;s=o.pop();){const m=QT(s.next,t);L3(s,t),c&&Fx(s,0,0,t,1),m||(s.family.triggers-=1),(e||g||d&&s.family.type==="crosslink"&&!f||i&&QT($3,s.meta.op)&&(m&&s.next.length===0||!m&&s.family.triggers<=0))&&Fx(s,e,r&&s.meta.op!=="on",h,i)}}for(o=GE(t);s=o.pop();)L3(s,t),r&&s.family.type==="crosslink"&&Fx(s,e,s.meta.op!=="on",h,i)},uC=t=>t.clear(),Yb=(t,{deep:e}={})=>{let r=0;if(t.ownerSet&&t.ownerSet.delete(t),c7(t)){r=1;const n=t.history;uC(n.events),uC(n.effects),uC(n.stores),uC(n.domains)}Fx(oo(t),!!e,r,null,0)},zce=t=>WO(()=>Yb(t)),VN=(t,e,r,n,i)=>Rh({node:r,parent:t,child:e,scope:{fn:i},meta:{op:n},family:{owners:[t,e],links:e},regional:1}),p7=(t,e)=>(Es(Ta(e),".watch argument should be a function"),zce(Rh({scope:{fn:e},node:[LN({fn:JE})],parent:t,meta:{op:"watch"},family:{owners:t},regional:1}))),Gce=(t,e,r="event")=>{qw(t)&&qw(t).hooks[r](e)},Yce=(t,e)=>Pl(t,"unitTrace",e),WN=t=>"",v7=(t,e,r,n)=>{const i=dp(r),s=t==="domain",o=Tce(),{sid:a=null,named:l=null,domain:c=null,parent:u=c}=i,h=l||i.name||(s?"":o),f=pce(h,u),d={op:e.kind=t,name:e.shortName=h,sid:e.sid=Oce(a),named:l,unitId:e.id=o,serialize:i.serialize,derived:i.derived,config:i,unitTrace:n};return e.targetable=!i.derived,e.parent=u,e.compositeName=f,e.defaultConfig=i,e.getType=()=>(Gb(0,"getType","compositeName.fullName"),f.fullName),!s&&(e.subscribe=g=>(Mce(g),e.watch(Ta(g)?g:m=>g.next&&g.next(m))),e[Sce]=()=>e),d},tk=(t,e,r,n)=>{let i;Ud(r)&&(i=r,r=r.fn);const s=Yc({name:`${t.shortName} → *`,derived:1,and:i});return VN(t,s,n,e,r),s},rk="undefined is used to skip updates. To allow undefined as a value provide explicit { skipVoid: false } option",w7=(t,e,r,n,i)=>{const s=zb(e),o=QE({store:s,to:"a",priority:"read"});r===Xw&&(o.data.softRead=1);const a=[o,Rm(n)];zv("storeOnMap",s,a,XE(t)&&zb(t));const l=VN(t,e,a,r,i);return r!==Xw&&Pl(l,"onTrigger",oo(t).id),l},Kce=(t,e,r)=>{try{return[1,t(...r)]}catch(n){return e(n),[0,null]}},B3=(t,e,r,n,i)=>s=>{Kw({target:[n,Xce],params:[r?{status:"done",params:t,result:s}:{status:"fail",params:t,error:s},{value:s,fn:r?e.rs:e.rj}],defer:1,page:i.page,scope:i.scope,meta:i.meta})},Xce=Rh({node:[LN({fn:({fn:t,value:e})=>t(e)})],meta:{op:"fx",fx:"sidechain"}});var y7={exports:{}},C7={},S7={exports:{}},x7={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gp=me;function qce(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Jce=typeof Object.is=="function"?Object.is:qce,Qce=gp.useState,Zce=gp.useEffect,eue=gp.useLayoutEffect,tue=gp.useDebugValue;function rue(t,e){var r=e(),n=Qce({inst:{value:r,getSnapshot:e}}),i=n[0].inst,s=n[1];return eue(function(){i.value=r,i.getSnapshot=e,nk(i)&&s({inst:i})},[t,r,e]),Zce(function(){return nk(i)&&s({inst:i}),t(function(){nk(i)&&s({inst:i})})},[t]),tue(r),r}function nk(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Jce(t,r)}catch{return!0}}function nue(t,e){return e()}var iue=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?nue:rue;x7.useSyncExternalStore=gp.useSyncExternalStore!==void 0?gp.useSyncExternalStore:iue;S7.exports=x7;var b7=S7.exports;const sue=hE(b7);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZE=me,oue=b7;function aue(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lue=typeof Object.is=="function"?Object.is:aue,cue=oue.useSyncExternalStore,uue=ZE.useRef,hue=ZE.useEffect,fue=ZE.useMemo,due=ZE.useDebugValue;C7.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=uue(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=fue(function(){function l(d){if(!c){if(c=!0,u=d,d=n(d),i!==void 0&&o.hasValue){var g=o.value;if(i(g,d))return h=g}return h=d}if(g=h,lue(u,d))return g;var m=n(d);return i!==void 0&&i(g,m)?(u=d,g):(u=d,h=m)}var c=!1,u,h,f=r===void 0?null:r;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,r,n,i]);var a=cue(t,s[0],s[1]);return hue(function(){o.hasValue=!0,o.value=a},[a]),due(a),a};y7.exports=C7;var gue=y7.exports;const mue=hE(gue);function pue(t,e){const r=aC.unit(t);let n={};r?n={unit:t}:"@@unitShape"in t?typeof t["@@unitShape"]=="function"?n=t["@@unitShape"]():V3("expect @@unitShape to be a function"):n=t;const i=Array.isArray(n),s=Ge.useRef({stale:1,justSubscribed:0,scope:e}),[o,a,l,c,u]=Ge.useMemo(()=>{s.current.stale=1;const g=Array.isArray(n)?[]:{},m=[],p=[],w=[],v=[];for(const y in n){if(!{}.hasOwnProperty.call(n,y))continue;const b=n[y];aC.unit(b)||V3(`expect useUnit ${r?"argument":`value in key "${y}"`} to be a unit`),aC.event(b)||aC.effect(b)?(g[y]=e?wce(b,{scope:e}):b,w.push(y),v.push(b)):(g[y]=null,m.push(y),p.push(b))}return[g,m,p,w,v]},[s,e,...Object.keys(n),...Object.values(n)]),h=Ge.useRef({value:o,storeKeys:a,eventKeys:c,eventValues:u}),f=Ge.useCallback(g=>{const m=s.current;return m.justSubscribed=1,yce({unit:l,fn:()=>{m.stale||(m.stale=1,g())},scope:e,batch:1})},[l,e,h,s]),d=Ge.useCallback(()=>{const g=h.current,m=s.current;let p,w=0;const v=g.value,y=g.storeKeys,b=g.eventKeys,T=g.eventValues,E=e!==m.scope;if(m.stale||m.justSubscribed||E){w=!m.justSubscribed||E,p=i?[...o]:{...o},y.length===a.length&&b.length===c.length||(w=1);for(let x=0;x<a.length;x++){const P=yue(l[x],e),A=a[x];w||(w=y.includes(A)?v[A]!==P:1),p[A]=P}for(let x=0;x<c.length;x++){const P=u[x],A=c[x];w||(w=b.includes(A)?T[b.indexOf(A)]!==P:1)}}return w&&(g.value=p),g.storeKeys=a,g.eventKeys=c,g.eventValues=u,m.stale=0,m.justSubscribed=!w,m.scope=e,r?g.value.unit:g.value},[f,l,u,e,h,s]);return wue(f,d,d)}function vue(t){return Ge.useContext(_7)}function _v(t,e){return pue(t,vue())}const V3=t=>{throw Error(t)};typeof window<"u"?Ge.useLayoutEffect:Ge.useEffect;const{useSyncExternalStore:wue}=sue,{useSyncExternalStoreWithSelector:Drt}=mue,yue=(t,e)=>e?e.getState(t):t.getState(),_7=Ge.createContext(null),{Provider:Frt}=_7,Cue=Yc(),E7=Yc(),R7=Yc(),T7=l7(async t=>(await new Promise(e=>setTimeout(e,300)),{id:Date.now().toString(),...t})),k7=l7(async t=>(await new Promise(e=>setTimeout(e,300)),Array.isArray(t)?t.map((e,r)=>({id:e.id??(Date.now()+r).toString(),name:e.name??"",code:e.code??"",contractNumber:e.contractNumber,contractDate:e.contractDate,designation:e.designation,customer:e.customer,contractor:e.contractor})):[{id:"1",name:"Импорт 1",code:"IMP001"},{id:"2",name:"Импорт 2",code:"IMP002"}])),Sue=zE([]).on(Cue,(t,e)=>[...t,e]).on(E7,(t,e)=>t.filter(r=>r.id!==e)).on(k7.doneData,(t,e)=>[...t,...e]).on(T7.doneData,(t,e)=>[...t,e]),xue=zE(1).on(R7,(t,e)=>e),bue=()=>{const[t,e]=_v([Sue,xue]),r=_v(E7),n=_v(R7),i=_v(k7),s=5,o=Math.ceil(t.length/s),a=t.slice((e-1)*s,e*s),l=()=>{const c=[{id:String(Date.now()),name:"Объект А",code:"A-001"},{id:String(Date.now()+1),name:"Объект B",code:"B-002"},{id:String(Date.now()+2),name:"Объект C",code:"C-003"}];i(c)};return F.jsxs("div",{style:{padding:24},children:[F.jsx("h2",{children:"Список объектов"}),F.jsx("div",{style:{marginBottom:16},children:F.jsx("button",{onClick:l,children:"Импортировать данные"})}),a.length===0?F.jsx("p",{children:"Нет данных"}):F.jsxs("table",{border:1,cellPadding:8,style:{width:"100%",borderCollapse:"collapse"},children:[F.jsx("thead",{children:F.jsxs("tr",{children:[F.jsx("th",{children:"Наименование"}),F.jsx("th",{children:"Шифр"}),F.jsx("th",{children:"Действия"})]})}),F.jsx("tbody",{children:a.map(c=>F.jsxs("tr",{children:[F.jsx("td",{children:c.name}),F.jsx("td",{children:c.code}),F.jsx("td",{children:F.jsx("button",{onClick:()=>r(c.id),children:"Удалить"})})]},c.id))})]}),o>1&&F.jsx("div",{style:{marginTop:16},children:Array.from({length:o},(c,u)=>u+1).map(c=>F.jsx("button",{style:{marginRight:8,background:c===e?"#ccc":"white"},onClick:()=>n(c),children:c},c))})]})},_ue=()=>{const t=_v(T7),e=MN(),r=i=>{t(i)},n=()=>{e(o7())};return F.jsxs("div",{style:{padding:24},children:[F.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[F.jsx("button",{onClick:n,style:{marginRight:8,background:"none",border:"none",cursor:"pointer",fontSize:18},children:"←"}),F.jsx("h2",{style:{margin:0},children:"Создание объекта"})]}),F.jsx(a7,{onSubmit:r}),F.jsx("div",{style:{marginTop:16},children:F.jsx("button",{type:"submit",form:"object-form",children:"Сохранить"})})]})},Eue=()=>F.jsx("div",{children:"Аккаунт"}),Rue=()=>F.jsx("div",{children:"Подписки"}),Tue=()=>F.jsx("div",{children:"Прзервативзователи"}),kue=()=>F.jsx("div",{children:"Настройки"}),Pue="/my-profgeo-app/assets/hero-_GGGXZ8n.png",Aue=()=>F.jsx("div",{className:"welcome",children:F.jsx("img",{src:Pue,alt:"Добро пожаловать",className:"welcome__image"})}),Iue="_button_168xr_1",Oue={button:Iue},Kb=({children:t,...e})=>F.jsx("button",{className:Oue.button,...e,children:t}),Mue="_input_60i9y_1",Nue={input:Mue},km=t=>F.jsx("input",{className:Nue.input,...t}),Due="_label_1tvfp_1",Fue={label:Due},Vf=({children:t,...e})=>F.jsx("label",{className:Fue.label,...e,children:t}),Hue="_page_ea93g_1",Lue="_left_ea93g_25",$ue="_backRow_ea93g_37",Bue="_backBtn_ea93g_45",Vue="_brandBlock_ea93g_73",Wue="_logoRow_ea93g_89",jue="_logoDot_ea93g_101",Uue="_logoText_ea93g_117",zue="_title_ea93g_129",Gue="_segment_ea93g_147",Yue="_segmentItem_ea93g_169",Kue="_segmentItemActive_ea93g_195",Xue="_form_ea93g_207",que="_row_ea93g_221",Jue="_field_ea93g_233",Que="_label_ea93g_245",Zue="_inputAuth_ea93g_255",ehe="_checkboxRow_ea93g_271",the="_checkboxLabel_ea93g_273",rhe="_link_ea93g_275",nhe="_submit_ea93g_283",ihe="_haveAccount_ea93g_309",she="_right_ea93g_319",ohe="_screenshotCard_ea93g_335",ahe="_screenshotImg_ea93g_359",qe={page:Hue,left:Lue,backRow:$ue,backBtn:Bue,brandBlock:Vue,logoRow:Wue,logoDot:jue,logoText:Uue,title:zue,segment:Gue,segmentItem:Yue,segmentItemActive:Kue,form:Xue,row:que,field:Jue,label:Que,inputAuth:Zue,checkboxRow:ehe,checkboxLabel:the,link:rhe,submit:nhe,haveAccount:ihe,right:she,screenshotCard:ohe,screenshotImg:ahe},P7="/my-profgeo-app/assets/auth-BiPQxPLt.png",lhe=()=>{const t=jy(),e=Uy(),[r,n]=me.useState(""),[i,s]=me.useState(""),o=a=>{a.preventDefault(),t(moe({email:r,password:i})),e("/lk")};return F.jsxs("div",{className:qe.page,children:[F.jsxs("div",{className:qe.left,children:[F.jsx("div",{className:qe.backRow,children:F.jsx(Kb,{className:qe.backBtn,onClick:()=>e(-1),children:"←-"})}),F.jsxs("div",{className:qe.brandBlock,children:[F.jsxs("div",{className:qe.logoRow,children:[F.jsx("div",{className:qe.logoDot}),F.jsx("div",{className:qe.logoText,children:"Profdepo"})]}),F.jsx("h1",{className:qe.title,children:"Вход"})]}),F.jsxs("form",{onSubmit:o,className:qe.form,children:[F.jsxs("div",{className:qe.field,children:[F.jsx(Vf,{htmlFor:"email",children:"почта или телефон"}),F.jsx(km,{id:"email",type:"email",placeholder:"Введите e-mail",className:qe.inputAuth,value:r,onChange:a=>n(a.target.value),required:!0})]}),F.jsxs("div",{className:qe.field,children:[F.jsx(Vf,{htmlFor:"password",children:"Пароль"}),F.jsx(km,{id:"password",type:"password",placeholder:"Введите пароль",className:qe.inputAuth,value:i,onChange:a=>s(a.target.value),required:!0})]}),F.jsx(Kb,{type:"submit",className:qe.submit,children:"Войти"})]}),F.jsxs("p",{className:qe.switchText,children:["Впервые здесь? ",F.jsx(Xf,{to:"/register",children:"Зарегистрироваться"})]})]}),F.jsx("div",{className:qe.right,children:F.jsx("div",{className:qe.screenshotCard,children:F.jsx("img",{src:P7,alt:"Preview",className:qe.screenshotImg})})})]})},che="_wrapper_sanyj_1",uhe="_checkmark_sanyj_21",W3={wrapper:che,checkmark:uhe},hhe=({checked:t,onCheckedChange:e})=>F.jsxs("label",{className:W3.wrapper,children:[F.jsx("input",{type:"checkbox",checked:t,onChange:r=>e(r.target.checked)}),F.jsx("span",{className:W3.checkmark})]}),fhe=()=>{const t=Uy(),[e,r]=me.useState("legal"),[n,i]=me.useState(!1),[s,o]=me.useState(""),[a,l]=me.useState(""),[c,u]=me.useState(""),[h,f]=me.useState(""),d=(e==="individual"?!0:s.trim().length>1)&&c.trim()&&h.trim()&&n,g=m=>{m.preventDefault(),d&&t("/login")};return F.jsxs("div",{className:qe.page,children:[F.jsxs("div",{className:qe.left,children:[F.jsx("div",{className:qe.backRow,children:F.jsx(Kb,{className:qe.backBtn,onClick:()=>t(-1),children:"←-"})}),F.jsxs("div",{className:qe.brandBlock,children:[F.jsxs("div",{className:qe.logoRow,children:[F.jsx("div",{className:qe.logoDot}),F.jsx("div",{className:qe.logoText,children:"Profdepo"})]}),F.jsx("h1",{className:qe.title,children:"Регистрация"}),F.jsxs("div",{className:qe.segment,children:[F.jsx("button",{type:"button",className:`${qe.segmentItem} ${e==="legal"?qe.segmentItemActive:""}`,onClick:()=>r("legal"),children:"Для юридических лиц"}),F.jsx("button",{type:"button",className:`${qe.segmentItem} ${e==="individual"?qe.segmentItemActive:""}`,onClick:()=>r("individual"),children:"Для физических лиц"})]})]}),F.jsxs("form",{className:qe.form,onSubmit:g,children:[F.jsxs("div",{className:qe.row,children:[F.jsxs("div",{className:qe.field,children:[F.jsx(Vf,{htmlFor:"company",className:qe.label,children:"Название компании"}),F.jsx(km,{id:"company",placeholder:"Введите название компании",className:qe.inputAuth,value:s,onChange:m=>o(m.target.value),disabled:e==="individual"})]}),F.jsxs("div",{className:qe.field,children:[F.jsx(Vf,{htmlFor:"inn",className:qe.label,children:"ИНН"}),F.jsx(km,{id:"inn",placeholder:"Введите ИНН",className:qe.inputAuth,value:a,onChange:m=>l(m.target.value),disabled:e==="individual"})]})]}),F.jsxs("div",{className:qe.field,children:[F.jsx(Vf,{htmlFor:"email",className:qe.label,children:"Почта"}),F.jsx(km,{id:"email",type:"email",placeholder:"Введите почту",className:qe.inputAuth,value:c,onChange:m=>u(m.target.value)})]}),F.jsxs("div",{className:qe.field,children:[F.jsx(Vf,{htmlFor:"phone",className:qe.label,children:"Телефон"}),F.jsx(km,{id:"phone",type:"tel",placeholder:"Введите телефон",className:qe.inputAuth,value:h,onChange:m=>f(m.target.value)})]}),F.jsxs("div",{className:qe.checkboxRow,children:[F.jsx(hhe,{checked:n,onCheckedChange:m=>i(m)}),F.jsxs(Vf,{className:qe.checkboxLabel,children:["Я принимаю условия"," ",F.jsx("a",{className:qe.link,href:"https://docs.google.com/document/d/1fo_T40LV_p1axxp1DCMYVrd-vbzQFvFmpmv-IPv-zos/edit?usp=sharing",target:"_blank",rel:"noreferrer",children:"Политики обработки персональных данных"})]})]}),F.jsx(Kb,{className:qe.submit,disabled:!d,children:"Далее"}),F.jsxs("div",{className:qe.haveAccount,children:["Уже есть аккаунт? ",F.jsx(Xf,{to:"/login",children:"Войти"})]})]})]}),F.jsx("div",{className:qe.right,children:F.jsx("div",{className:qe.screenshotCard,children:F.jsx("img",{src:P7,alt:"Preview",className:qe.screenshotImg})})})]})},j3=({children:t})=>kE(r=>r.auth.isAuthenticated)?t:F.jsx(xie,{to:"/login",replace:!0});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Qw={};Qw.version="0.18.5";var ro=1200,_d=1252,dhe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jN={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},eR=function(t){dhe.indexOf(t)!=-1&&(_d=jN[0]=t)};function ghe(){eR(1252)}var Bo=function(t){ro=t,eR(t)};function tR(){Bo(1200),ghe()}function Xb(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function mhe(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function A7(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Pm=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?mhe(t.slice(2)):e==254&&r==255?A7(t.slice(2)):e==65279?t.slice(1):t},Ev=function(e){return String.fromCharCode(e)},GO=function(e){return String.fromCharCode(e)},Lt;function phe(t){Lt=t,Bo=function(e){ro=e,eR(e)},Pm=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?Lt.utils.decode(1200,Xb(e.slice(2))):e},Ev=function(r){return ro===1200?String.fromCharCode(r):Lt.utils.decode(ro,[r&255,r>>8])[0]},GO=function(r){return Lt.utils.decode(_d,[r])[0]},sG()}var Ju="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zw(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),o=(r&3)<<4|n>>4,i=t.charCodeAt(c++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),e+=Ju.charAt(s)+Ju.charAt(o)+Ju.charAt(a)+Ju.charAt(l);return e}function ao(t){var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Ju.indexOf(t.charAt(c++)),o=Ju.indexOf(t.charAt(c++)),r=s<<2|o>>4,e+=String.fromCharCode(r),a=Ju.indexOf(t.charAt(c++)),n=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(n)),l=Ju.indexOf(t.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var bt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ru=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Th(t){return bt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function U3(t){return bt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var qs=function(e){return bt?ru(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Qy(t){if(typeof ArrayBuffer>"u")return qs(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Hh(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function vhe(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function UN(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return UN(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Jn=bt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ru(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function whe(t){for(var e=[],r=0,n=t.length+250,i=Th(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Th(65535),n=65530)}return e.push(i.slice(0,r)),Jn(e)}var Ii=/\u0000/g,Rv=/[\u0001-\u0006]/g;function zm(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ka(t,e){var r=""+t;return r.length>=e?r:nn("0",e-r.length)+r}function zN(t,e){var r=""+t;return r.length>=e?r:nn(" ",e-r.length)+r}function qb(t,e){var r=""+t;return r.length>=e?r:r+nn(" ",e-r.length)}function yhe(t,e){var r=""+Math.round(t);return r.length>=e?r:nn("0",e-r.length)+r}function Che(t,e){var r=""+t;return r.length>=e?r:nn("0",e-r.length)+r}var z3=Math.pow(2,32);function hg(t,e){if(t>z3||t<-z3)return yhe(t,e);var r=Math.round(t);return Che(r,e)}function Jb(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var G3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ik=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function She(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Y3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},xhe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qb(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=s):(u=c,a=o)),!r)return[0,n*a,u];var f=Math.floor(n*a/u);return[f,n*a-f*u,u]}function Qu(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,o=[],a={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=khe(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var I7=new Date(1899,11,31,0,0,0),bhe=I7.getTime(),_he=new Date(1900,2,1,0,0,0);function O7(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=_he&&(r+=24*60*60*1e3),(r-(bhe+(t.getTimezoneOffset()-I7.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function GN(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ehe(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Rhe(t){var e=t<0?12:11,r=GN(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function The(t){var e=GN(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function ey(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Rhe(t):e===10?r=t.toFixed(10).substr(0,12):r=The(t),GN(Ehe(r.toUpperCase()))}function Ed(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ey(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return lo(14,O7(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function khe(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Phe(t,e,r,n){var i="",s=0,o=0,a=r.y,l,c=0;switch(t){case 98:a=r.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return ik[r.m-1][1];case 5:return ik[r.m-1][0];default:return ik[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return G3[r.q][0];default:return G3[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ka(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=ka(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?ka(l,c):"";return u}function Zu(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var M7=/%/g;function Ahe(t,e,r){var n=e.replace(M7,""),i=e.length-n.length;return Fc(t,n,r*Math.pow(10,2*i))+nn("%",i)}function Ihe(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fc(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function N7(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+N7(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var D7=/# (\?+)( ?)\/( ?)(\d+)/;function Ohe(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?nn(" ",t[1].length+1+t[4].length):zN(o,t[1].length)+t[2]+"/"+t[3]+ka(a,t[4].length))}function Mhe(t,e,r){return r+(e===0?"":""+e)+nn(" ",t[1].length+2+t[4].length)}var F7=/^#*0*\.([0#]+)/,H7=/\).*[0#]/,L7=/\(###\) ###\\?-####/;function Yi(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function K3(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function X3(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Nhe(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Dhe(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function So(t,e,r){if(t.charCodeAt(0)===40&&!e.match(H7)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?So("n",n,r):"("+So("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Ihe(t,e,r);if(e.indexOf("%")!==-1)return Ahe(t,e,r);if(e.indexOf("E")!==-1)return N7(e,r);if(e.charCodeAt(0)===36)return"$"+So(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+hg(l,e.length);if(e.match(/^[#?]+$/))return i=hg(r,0),i==="0"&&(i=""),i.length>e.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(D7))return Ohe(s,l,c);if(e.match(/^#+0+$/))return c+hg(l,e.length-e.indexOf("0"));if(s=e.match(F7))return i=K3(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Yi(s[1])).replace(/\.$/,"."+Yi(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+nn("0",Yi(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+K3(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Zu(hg(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+So(t,e,-r):Zu(""+(Math.floor(r)+Nhe(r,s[1].length)))+"."+ka(X3(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return So(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zm(So(t,e.replace(/[\\-]/g,""),r)),o=0,zm(zm(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(e.match(L7))return i=So(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Qb(l,Math.pow(10,o)-1,!1),i=""+c,u=Fc("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=qb(a[2],o),u.length<s[4].length&&(u=Yi(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Qb(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?zN(a[1],o)+s[2]+"/"+s[3]+qb(a[2],o):nn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=hg(r,0),e.length<=i.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Yi(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=X3(r,s[1].length),r<0?"-"+So(t,e,-r):Zu(Dhe(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ka(0,3-g.length):"")+g})+"."+ka(o,s[1].length);switch(e){case"###,##0.00":return So(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Zu(hg(l,0));return d!=="0"?c+d:"";case"###,###.00":return So(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return So(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Fhe(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fc(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Hhe(t,e,r){var n=e.replace(M7,""),i=e.length-n.length;return Fc(t,n,r*Math.pow(10,2*i))+nn("%",i)}function $7(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+$7(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function dl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(H7)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?dl("n",n,r):"("+dl("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Fhe(t,e,r);if(e.indexOf("%")!==-1)return Hhe(t,e,r);if(e.indexOf("E")!==-1)return $7(e,r);if(e.charCodeAt(0)===36)return"$"+dl(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ka(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(D7))return Mhe(s,l,c);if(e.match(/^#+0+$/))return c+ka(l,e.length-e.indexOf("0"));if(s=e.match(F7))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Yi(s[1])).replace(/\.$/,"."+Yi(s[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+nn("0",Yi(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Zu(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+dl(t,e,-r):Zu(""+r)+"."+nn("0",s[1].length);if(s=e.match(/^#,#*,#0/))return dl(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zm(dl(t,e.replace(/[\\-]/g,""),r)),o=0,zm(zm(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(e.match(L7))return i=dl(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Qb(l,Math.pow(10,o)-1,!1),i=""+c,u=Fc("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=qb(a[2],o),u.length<s[4].length&&(u=Yi(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Qb(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?zN(a[1],o)+s[2]+"/"+s[3]+qb(a[2],o):nn(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Yi(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Yi(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+dl(t,e,-r):Zu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ka(0,3-g.length):"")+g})+"."+ka(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var d=Zu(""+l);return d!=="0"?c+d:"";default:if(e.match(/\.[0#?]*$/))return dl(t,e.slice(0,e.lastIndexOf(".")),r)+Yi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Fc(t,e,r){return(r|0)===r?dl(t,e,r):So(t,e,r)}function Lhe(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var B7=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zd(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Jb(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(B7))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function $he(t,e,r,n){for(var i=[],s="",o=0,a="",l="t",c,u,h,f="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!Jb(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var d=t.charAt(++o),g=d==="("||d===")"?d:"t";i[i.length]={t:g,v:d},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(c==null&&(c=Qu(e,r,t.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Qu(e,r),c==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=f),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"上":var m={t:a,v:a};if(c==null&&(c=Qu(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="上午/下午"?(c!=null&&(m.v=c.H>=12?"下午":"上午"),m.t="T",o+=5,f="h"):(m.t="t",++o),c==null&&m.t==="T")return"";i[i.length]=m,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(B7)){if(c==null&&(c=Qu(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",zd(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var p=0,w=0,v;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=f,l="h",p<1&&(p=1);break;case"s":(v=i[o].v.match(/\.0+$/))&&(w=Math.max(w,v[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[o].v.match(/[Hh]/)&&(p=1),p<2&&i[o].v.match(/[Mm]/)&&(p=2),p<3&&i[o].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",b;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Phe(i[o].t.charCodeAt(0),i[o].v,c,w),i[o].t="t";break;case"n":case"?":for(b=o+1;i[b]!=null&&((a=i[b].t)==="?"||a==="D"||(a===" "||a==="t")&&i[b+1]!=null&&(i[b+1].t==="?"||i[b+1].t==="t"&&i[b+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[b].v==="/"||i[b].v===" "&&i[b+1]!=null&&i[b+1].t=="?"));)i[o].v+=i[b].v,i[b]={v:"",t:";"},++b;y+=i[o].v,o=b-1;break;case"G":i[o].t="t",i[o].v=Ed(e,r);break}var T="",E,x;if(y.length>0){y.charCodeAt(0)==40?(E=e<0&&y.charCodeAt(0)===45?-e:e,x=Fc("n",y,E)):(E=e<0&&n>1?-e:e,x=Fc("n",y,E),E<0&&i[0]&&i[0].t=="t"&&(x=x.substr(1),i[0].v="-"+i[0].v)),b=x.length-1;var P=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){P=o;break}var A=i.length;if(P===i.length&&x.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(b>=i[o].v.length-1?(b-=i[o].v.length,i[o].v=x.substr(b+1,i[o].v.length)):b<0?i[o].v="":(i[o].v=x.substr(0,b+1),b=-1),i[o].t="t",A=o);b>=0&&A<i.length&&(i[A].v=x.substr(0,b+1)+i[A].v)}else if(P!==i.length&&x.indexOf("E")===-1){for(b=x.indexOf(".")-1,o=P;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")-1:i[o].v.length-1,T=i[o].v.substr(u+1);u>=0;--u)b>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(T=x.charAt(b--)+T);i[o].v=T,i[o].t="t",A=o}for(b>=0&&A<i.length&&(i[A].v=x.substr(0,b+1)+i[A].v),b=x.indexOf(".")+1,o=P;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==P)){for(u=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")+1:0,T=i[o].v.substr(0,u);u<i[o].v.length;++u)b<x.length&&(T+=x.charAt(b++));i[o].v=T,i[o].t="t",A=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(E=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Fc(i[o].t,i[o].v,E),i[o].t="t");var O="";for(o=0;o!==i.length;++o)i[o]!=null&&(O+=i[o].v);return O}var q3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function J3(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Bhe(t,e){var r=Lhe(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(q3),a=r[1].match(q3);return J3(e,o)?[n,r[0]]:J3(e,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function lo(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[t],n==null&&(n=r.table&&r.table[Y3[t]]||nt[Y3[t]]),n==null&&(n=xhe[t]||"General");break}if(Jb(n,0))return Ed(e,r);e instanceof Date&&(e=O7(e,r.date1904));var i=Bhe(n,e);if(Jb(i[1]))return Ed(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return $he(i[1],e,r,i[0])}function Nl(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(nt[r]==null){e<0&&(e=r);continue}if(nt[r]==t){e=r;break}}e<0&&(e=391)}return nt[e]=t,e}function Zy(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Nl(t[e],e)}function Fp(){nt=She()}var V7={format:lo,load:Nl,_table:nt,load_table:Zy,parse_date_code:Qu,is_date:zd,get_table:function(){return V7._table=nt}},Vhe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},W7=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Whe(t){var e=typeof t=="number"?nt[t]:t;return e=e.replace(W7,"(\\d+)"),new RegExp("^"+e+"$")}function jhe(t,e,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(W7)||[]).forEach(function(h,f){var d=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":o=d;break;case"s":l=d;break;case"m":o>=0?a=d:i=d;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var Uhe=function(){var t={};t.version="1.2.0";function e(){for(var x=0,P=new Array(256),A=0;A!=256;++A)x=A,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,P[A]=x;return typeof Int32Array<"u"?new Int32Array(P):P}var r=e();function n(x){var P=0,A=0,O=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)Y[O]=x[O];for(O=0;O!=256;++O)for(A=x[O],P=256+O;P<4096;P+=256)A=Y[P]=A>>>8^x[A&255];var B=[];for(O=1;O!=16;++O)B[O-1]=typeof Int32Array<"u"?Y.subarray(O*256,O*256+256):Y.slice(O*256,O*256+256);return B}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],f=i[7],d=i[8],g=i[9],m=i[10],p=i[11],w=i[12],v=i[13],y=i[14];function b(x,P){for(var A=P^-1,O=0,Y=x.length;O<Y;)A=A>>>8^r[(A^x.charCodeAt(O++))&255];return~A}function T(x,P){for(var A=P^-1,O=x.length-15,Y=0;Y<O;)A=y[x[Y++]^A&255]^v[x[Y++]^A>>8&255]^w[x[Y++]^A>>16&255]^p[x[Y++]^A>>>24]^m[x[Y++]]^g[x[Y++]]^d[x[Y++]]^f[x[Y++]]^h[x[Y++]]^u[x[Y++]]^c[x[Y++]]^l[x[Y++]]^a[x[Y++]]^o[x[Y++]]^s[x[Y++]]^r[x[Y++]];for(O+=15;Y<O;)A=A>>>8^r[(A^x[Y++])&255];return~A}function E(x,P){for(var A=P^-1,O=0,Y=x.length,B=0,ie=0;O<Y;)B=x.charCodeAt(O++),B<128?A=A>>>8^r[(A^B)&255]:B<2048?(A=A>>>8^r[(A^(192|B>>6&31))&255],A=A>>>8^r[(A^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,ie=x.charCodeAt(O++)&1023,A=A>>>8^r[(A^(240|B>>8&7))&255],A=A>>>8^r[(A^(128|B>>2&63))&255],A=A>>>8^r[(A^(128|ie>>6&15|(B&3)<<4))&255],A=A>>>8^r[(A^(128|ie&63))&255]):(A=A>>>8^r[(A^(224|B>>12&15))&255],A=A>>>8^r[(A^(128|B>>6&63))&255],A=A>>>8^r[(A^(128|B&63))&255]);return~A}return t.table=r,t.bstr=b,t.buf=T,t.str=E,t}(),Xe=function(){var e={};e.version="1.2.1";function r(I,z){for(var H=I.split("/"),L=z.split("/"),G=0,K=0,ce=Math.min(H.length,L.length);G<ce;++G){if(K=H[G].length-L[G].length)return K;if(H[G]!=L[G])return H[G]<L[G]?-1:1}return H.length-L.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var z=I.lastIndexOf("/");return z===-1?I:I.slice(0,z+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var z=I.lastIndexOf("/");return z===-1?I:I.slice(z+1)}function s(I,z){typeof z=="string"&&(z=new Date(z));var H=z.getHours();H=H<<6|z.getMinutes(),H=H<<5|z.getSeconds()>>>1,I.write_shift(2,H);var L=z.getFullYear()-1980;L=L<<4|z.getMonth()+1,L=L<<5|z.getDate(),I.write_shift(2,L)}function o(I){var z=I.read_shift(2)&65535,H=I.read_shift(2)&65535,L=new Date,G=H&31;H>>>=5;var K=H&15;H>>>=4,L.setMilliseconds(0),L.setFullYear(H+1980),L.setMonth(K-1),L.setDate(G);var ce=z&31;z>>>=5;var we=z&63;return z>>>=6,L.setHours(z),L.setMinutes(we),L.setSeconds(ce<<1),L}function a(I){li(I,0);for(var z={},H=0;I.l<=I.length-4;){var L=I.read_shift(2),G=I.read_shift(2),K=I.l+G,ce={};switch(L){case 21589:H=I.read_shift(1),H&1&&(ce.mtime=I.read_shift(4)),G>5&&(H&2&&(ce.atime=I.read_shift(4)),H&4&&(ce.ctime=I.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}I.l=K,z[L]=ce}return z}var l;function c(){return l||(l={})}function u(I,z){if(I[0]==80&&I[1]==75)return za(I,z);if((I[0]|32)==109&&(I[1]|32)==105)return r0(I,z);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var H=3,L=512,G=0,K=0,ce=0,we=0,le=0,ne=[],N=I.slice(0,512);li(N,0);var se=h(N);switch(H=se[0],H){case 3:L=512;break;case 4:L=4096;break;case 0:if(se[1]==0)return za(I,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}L!==512&&(N=I.slice(0,L),li(N,28));var de=I.slice(0,L);f(N,H);var ke=N.read_shift(4,"i");if(H===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);N.l+=4,ce=N.read_shift(4,"i"),N.l+=4,N.chk("00100000","Mini Stream Cutoff Size: "),we=N.read_shift(4,"i"),G=N.read_shift(4,"i"),le=N.read_shift(4,"i"),K=N.read_shift(4,"i");for(var be=-1,Ae=0;Ae<109&&(be=N.read_shift(4,"i"),!(be<0));++Ae)ne[Ae]=be;var Ye=d(I,L);p(le,K,Ye,L,ne);var Vt=v(Ye,ce,ne,L);Vt[ce].name="!Directory",G>0&&we!==ie&&(Vt[we].name="!MiniFAT"),Vt[ne[0]].name="!FAT",Vt.fat_addrs=ne,Vt.ssz=L;var rr={},Sn=[],Jr=[],du=[];y(ce,Vt,Ye,Sn,G,rr,Jr,we),g(Jr,du,Sn),Sn.shift();var gu={FileIndex:Jr,FullPaths:du};return z&&z.raw&&(gu.raw={header:de,sectors:Ye}),gu}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ue,"Header Signature: "),I.l+=16;var z=I.read_shift(2,"u");return[I.read_shift(2,"u"),z]}function f(I,z){var H=9;switch(I.l+=2,H=I.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function d(I,z){for(var H=Math.ceil(I.length/z)-1,L=[],G=1;G<H;++G)L[G-1]=I.slice(G*z,(G+1)*z);return L[H-1]=I.slice(H*z),L}function g(I,z,H){for(var L=0,G=0,K=0,ce=0,we=0,le=H.length,ne=[],N=[];L<le;++L)ne[L]=N[L]=L,z[L]=H[L];for(;we<N.length;++we)L=N[we],G=I[L].L,K=I[L].R,ce=I[L].C,ne[L]===L&&(G!==-1&&ne[G]!==G&&(ne[L]=ne[G]),K!==-1&&ne[K]!==K&&(ne[L]=ne[K])),ce!==-1&&(ne[ce]=L),G!==-1&&L!=ne[L]&&(ne[G]=ne[L],N.lastIndexOf(G)<we&&N.push(G)),K!==-1&&L!=ne[L]&&(ne[K]=ne[L],N.lastIndexOf(K)<we&&N.push(K));for(L=1;L<le;++L)ne[L]===L&&(K!==-1&&ne[K]!==K?ne[L]=ne[K]:G!==-1&&ne[G]!==G&&(ne[L]=ne[G]));for(L=1;L<le;++L)if(I[L].type!==0){if(we=L,we!=ne[we])do we=ne[we],z[L]=z[we]+"/"+z[L];while(we!==0&&ne[we]!==-1&&we!=ne[we]);ne[L]=-1}for(z[0]+="/",L=1;L<le;++L)I[L].type!==2&&(z[L]+="/")}function m(I,z,H){for(var L=I.start,G=I.size,K=[],ce=L;H&&G>0&&ce>=0;)K.push(z.slice(ce*B,ce*B+B)),G-=B,ce=Wf(H,ce*4);return K.length===0?ve(0):Jn(K).slice(0,I.size)}function p(I,z,H,L,G){var K=ie;if(I===ie){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ce=H[I],we=(L>>>2)-1;if(!ce)return;for(var le=0;le<we&&(K=Wf(ce,le*4))!==ie;++le)G.push(K);p(Wf(ce,L-4),z-1,H,L,G)}}function w(I,z,H,L,G){var K=[],ce=[];G||(G=[]);var we=L-1,le=0,ne=0;for(le=z;le>=0;){G[le]=!0,K[K.length]=le,ce.push(I[le]);var N=H[Math.floor(le*4/L)];if(ne=le*4&we,L<4+ne)throw new Error("FAT boundary crossed: "+le+" 4 "+L);if(!I[N])break;le=Wf(I[N],ne)}return{nodes:K,data:cB([ce])}}function v(I,z,H,L){var G=I.length,K=[],ce=[],we=[],le=[],ne=L-1,N=0,se=0,de=0,ke=0;for(N=0;N<G;++N)if(we=[],de=N+z,de>=G&&(de-=G),!ce[de]){le=[];var be=[];for(se=de;se>=0;){be[se]=!0,ce[se]=!0,we[we.length]=se,le.push(I[se]);var Ae=H[Math.floor(se*4/L)];if(ke=se*4&ne,L<4+ke)throw new Error("FAT boundary crossed: "+se+" 4 "+L);if(!I[Ae]||(se=Wf(I[Ae],ke),be[se]))break}K[de]={nodes:we,data:cB([le])}}return K}function y(I,z,H,L,G,K,ce,we){for(var le=0,ne=L.length?2:0,N=z[I].data,se=0,de=0,ke;se<N.length;se+=128){var be=N.slice(se,se+128);li(be,64),de=be.read_shift(2),ke=sR(be,0,de-ne),L.push(ke);var Ae={name:ke,type:be.read_shift(1),color:be.read_shift(1),L:be.read_shift(4,"i"),R:be.read_shift(4,"i"),C:be.read_shift(4,"i"),clsid:be.read_shift(16),state:be.read_shift(4,"i"),start:0,size:0},Ye=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Ye!==0&&(Ae.ct=b(be,be.l-8));var Vt=be.read_shift(2)+be.read_shift(2)+be.read_shift(2)+be.read_shift(2);Vt!==0&&(Ae.mt=b(be,be.l-8)),Ae.start=be.read_shift(4,"i"),Ae.size=be.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=ie,Ae.name=""),Ae.type===5?(le=Ae.start,G>0&&le!==ie&&(z[le].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",z[Ae.start]===void 0&&(z[Ae.start]=w(H,Ae.start,z.fat_addrs,z.ssz)),z[Ae.start].name=Ae.name,Ae.content=z[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:le!==ie&&Ae.start!==ie&&z[le]&&(Ae.content=m(Ae,z[le].data,(z[we]||{}).data))),Ae.content&&li(Ae.content,0),K[ke]=Ae,ce.push(Ae)}}function b(I,z){return new Date((Xn(I,z+4)/1e7*Math.pow(2,32)+Xn(I,z)/1e7-11644473600)*1e3)}function T(I,z){return c(),u(l.readFileSync(I),z)}function E(I,z){var H=z&&z.type;switch(H||bt&&Buffer.isBuffer(I)&&(H="buffer"),H||"base64"){case"file":return T(I,z);case"base64":return u(qs(ao(I)),z);case"binary":return u(qs(I),z)}return u(I,z)}function x(I,z){var H=z||{},L=H.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=L+"/",I.FileIndex[0]={name:L,type:5}),H.CLSID&&(I.FileIndex[0].clsid=H.CLSID),P(I)}function P(I){var z="Sh33tJ5";if(!Xe.find(I,"/"+z)){var H=ve(4);H[0]=55,H[1]=H[3]=50,H[2]=54,I.FileIndex.push({name:z,type:2,content:H,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+z),A(I)}}function A(I,z){x(I);for(var H=!1,L=!1,G=I.FullPaths.length-1;G>=0;--G){var K=I.FileIndex[G];switch(K.type){case 0:L?H=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(K.R*K.L*K.C)&&(H=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!z)){var ce=new Date(1987,1,19),we=0,le=Object.create?Object.create(null):{},ne=[];for(G=0;G<I.FullPaths.length;++G)le[I.FullPaths[G]]=!0,I.FileIndex[G].type!==0&&ne.push([I.FullPaths[G],I.FileIndex[G]]);for(G=0;G<ne.length;++G){var N=n(ne[G][0]);L=le[N],L||(ne.push([N,{name:i(N).replace("/",""),type:1,clsid:Ee,ct:ce,mt:ce,content:null}]),le[N]=!0)}for(ne.sort(function(ke,be){return r(ke[0],be[0])}),I.FullPaths=[],I.FileIndex=[],G=0;G<ne.length;++G)I.FullPaths[G]=ne[G][0],I.FileIndex[G]=ne[G][1];for(G=0;G<ne.length;++G){var se=I.FileIndex[G],de=I.FullPaths[G];if(se.name=i(de).replace("/",""),se.L=se.R=se.C=-(se.color=1),se.size=se.content?se.content.length:0,se.start=0,se.clsid=se.clsid||Ee,G===0)se.C=ne.length>1?1:-1,se.size=0,se.type=5;else if(de.slice(-1)=="/"){for(we=G+1;we<ne.length&&n(I.FullPaths[we])!=de;++we);for(se.C=we>=ne.length?-1:we,we=G+1;we<ne.length&&n(I.FullPaths[we])!=n(de);++we);se.R=we>=ne.length?-1:we,se.type=1}else n(I.FullPaths[G+1]||"")==n(de)&&(se.R=G+1),se.type=2}}}function O(I,z){var H=z||{};if(H.fileType=="mad")return L1(I,H);switch(A(I),H.fileType){case"zip":return zh(I,H)}var L=function(ke){for(var be=0,Ae=0,Ye=0;Ye<ke.FileIndex.length;++Ye){var Vt=ke.FileIndex[Ye];if(Vt.content){var rr=Vt.content.length;rr>0&&(rr<4096?be+=rr+63>>6:Ae+=rr+511>>9)}}for(var Sn=ke.FullPaths.length+3>>2,Jr=be+7>>3,du=be+127>>7,gu=Jr+Ae+Sn+du,Gh=gu+127>>7,dT=Gh<=109?0:Math.ceil((Gh-109)/127);gu+Gh+dT+127>>7>Gh;)dT=++Gh<=109?0:Math.ceil((Gh-109)/127);var Kl=[1,dT,Gh,du,Sn,Ae,be,0];return ke.FileIndex[0].size=be<<6,Kl[7]=(ke.FileIndex[0].start=Kl[0]+Kl[1]+Kl[2]+Kl[3]+Kl[4]+Kl[5])+(Kl[6]+7>>3),Kl}(I),G=ve(L[7]<<9),K=0,ce=0;{for(K=0;K<8;++K)G.write_shift(1,he[K]);for(K=0;K<8;++K)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),K=0;K<3;++K)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,L[2]),G.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:ie),G.write_shift(4,L[3]),G.write_shift(-4,L[1]?L[0]-1:ie),G.write_shift(4,L[1]),K=0;K<109;++K)G.write_shift(-4,K<L[2]?L[1]+K:-1)}if(L[1])for(ce=0;ce<L[1];++ce){for(;K<236+ce*127;++K)G.write_shift(-4,K<L[2]?L[1]+K:-1);G.write_shift(-4,ce===L[1]-1?ie:ce+1)}var we=function(ke){for(ce+=ke;K<ce-1;++K)G.write_shift(-4,K+1);ke&&(++K,G.write_shift(-4,ie))};for(ce=K=0,ce+=L[1];K<ce;++K)G.write_shift(-4,Ce.DIFSECT);for(ce+=L[2];K<ce;++K)G.write_shift(-4,Ce.FATSECT);we(L[3]),we(L[4]);for(var le=0,ne=0,N=I.FileIndex[0];le<I.FileIndex.length;++le)N=I.FileIndex[le],N.content&&(ne=N.content.length,!(ne<4096)&&(N.start=ce,we(ne+511>>9)));for(we(L[6]+7>>3);G.l&511;)G.write_shift(-4,Ce.ENDOFCHAIN);for(ce=K=0,le=0;le<I.FileIndex.length;++le)N=I.FileIndex[le],N.content&&(ne=N.content.length,!(!ne||ne>=4096)&&(N.start=ce,we(ne+63>>6)));for(;G.l&511;)G.write_shift(-4,Ce.ENDOFCHAIN);for(K=0;K<L[4]<<2;++K){var se=I.FullPaths[K];if(!se||se.length===0){for(le=0;le<17;++le)G.write_shift(4,0);for(le=0;le<3;++le)G.write_shift(4,-1);for(le=0;le<12;++le)G.write_shift(4,0);continue}N=I.FileIndex[K],K===0&&(N.start=N.size?N.start-1:ie);var de=K===0&&H.root||N.name;if(ne=2*(de.length+1),G.write_shift(64,de,"utf16le"),G.write_shift(2,ne),G.write_shift(1,N.type),G.write_shift(1,N.color),G.write_shift(-4,N.L),G.write_shift(-4,N.R),G.write_shift(-4,N.C),N.clsid)G.write_shift(16,N.clsid,"hex");else for(le=0;le<4;++le)G.write_shift(4,0);G.write_shift(4,N.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,N.start),G.write_shift(4,N.size),G.write_shift(4,0)}for(K=1;K<I.FileIndex.length;++K)if(N=I.FileIndex[K],N.size>=4096)if(G.l=N.start+1<<9,bt&&Buffer.isBuffer(N.content))N.content.copy(G,G.l,0,N.size),G.l+=N.size+511&-512;else{for(le=0;le<N.size;++le)G.write_shift(1,N.content[le]);for(;le&511;++le)G.write_shift(1,0)}for(K=1;K<I.FileIndex.length;++K)if(N=I.FileIndex[K],N.size>0&&N.size<4096)if(bt&&Buffer.isBuffer(N.content))N.content.copy(G,G.l,0,N.size),G.l+=N.size+63&-64;else{for(le=0;le<N.size;++le)G.write_shift(1,N.content[le]);for(;le&63;++le)G.write_shift(1,0)}if(bt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function Y(I,z){var H=I.FullPaths.map(function(le){return le.toUpperCase()}),L=H.map(function(le){var ne=le.split("/");return ne[ne.length-(le.slice(-1)=="/"?2:1)]}),G=!1;z.charCodeAt(0)===47?(G=!0,z=H[0].slice(0,-1)+z):G=z.indexOf("/")!==-1;var K=z.toUpperCase(),ce=G===!0?H.indexOf(K):L.indexOf(K);if(ce!==-1)return I.FileIndex[ce];var we=!K.match(Rv);for(K=K.replace(Ii,""),we&&(K=K.replace(Rv,"!")),ce=0;ce<H.length;++ce)if((we?H[ce].replace(Rv,"!"):H[ce]).replace(Ii,"")==K||(we?L[ce].replace(Rv,"!"):L[ce]).replace(Ii,"")==K)return I.FileIndex[ce];return null}var B=64,ie=-2,ue="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ge(I,z,H){c();var L=O(I,H);l.writeFileSync(z,L)}function Q(I){for(var z=new Array(I.length),H=0;H<I.length;++H)z[H]=String.fromCharCode(I[H]);return z.join("")}function ye(I,z){var H=O(I,z);switch(z&&z.type||"buffer"){case"file":return c(),l.writeFileSync(z.filename,H),H;case"binary":return typeof H=="string"?H:Q(H);case"base64":return Zw(typeof H=="string"?H:Q(H));case"buffer":if(bt)return Buffer.isBuffer(H)?H:ru(H);case"array":return typeof H=="string"?qs(H):H}return H}var Re;function j(I){try{var z=I.InflateRaw,H=new z;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)Re=I;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function C(I,z){if(!Re)return Hi(I,z);var H=Re.InflateRaw,L=new H,G=L._processChunk(I.slice(I.l),L._finishFlushFlag);return I.l+=L.bytesRead,G}function S(I){return Re?Re.deflateRawSync(I):Ze(I)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function X(I){var z=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(z>>16|z>>8|z)&255}for(var ee=typeof Uint8Array<"u",k=ee?new Uint8Array(256):[],M=0;M<256;++M)k[M]=X(M);function R(I,z){var H=k[I&255];return z<=8?H>>>8-z:(H=H<<8|k[I>>8&255],z<=16?H>>>16-z:(H=H<<8|k[I>>16&255],H>>>24-z))}function W(I,z){var H=z&7,L=z>>>3;return(I[L]|(H<=6?0:I[L+1]<<8))>>>H&3}function q(I,z){var H=z&7,L=z>>>3;return(I[L]|(H<=5?0:I[L+1]<<8))>>>H&7}function J(I,z){var H=z&7,L=z>>>3;return(I[L]|(H<=4?0:I[L+1]<<8))>>>H&15}function re(I,z){var H=z&7,L=z>>>3;return(I[L]|(H<=3?0:I[L+1]<<8))>>>H&31}function V(I,z){var H=z&7,L=z>>>3;return(I[L]|(H<=1?0:I[L+1]<<8))>>>H&127}function te(I,z,H){var L=z&7,G=z>>>3,K=(1<<H)-1,ce=I[G]>>>L;return H<8-L||(ce|=I[G+1]<<8-L,H<16-L)||(ce|=I[G+2]<<16-L,H<24-L)||(ce|=I[G+3]<<24-L),ce&K}function oe(I,z,H){var L=z&7,G=z>>>3;return L<=5?I[G]|=(H&7)<<L:(I[G]|=H<<L&255,I[G+1]=(H&7)>>8-L),z+3}function ae(I,z,H){var L=z&7,G=z>>>3;return H=(H&1)<<L,I[G]|=H,z+1}function fe(I,z,H){var L=z&7,G=z>>>3;return H<<=L,I[G]|=H&255,H>>>=8,I[G+1]=H,z+8}function Me(I,z,H){var L=z&7,G=z>>>3;return H<<=L,I[G]|=H&255,H>>>=8,I[G+1]=H&255,I[G+2]=H>>>8,z+16}function Ne(I,z){var H=I.length,L=2*H>z?2*H:z+5,G=0;if(H>=z)return I;if(bt){var K=U3(L);if(I.copy)I.copy(K);else for(;G<I.length;++G)K[G]=I[G];return K}else if(ee){var ce=new Uint8Array(L);if(ce.set)ce.set(I);else for(;G<H;++G)ce[G]=I[G];return ce}return I.length=L,I}function ze(I){for(var z=new Array(I),H=0;H<I;++H)z[H]=0;return z}function ot(I,z,H){var L=1,G=0,K=0,ce=0,we=0,le=I.length,ne=ee?new Uint16Array(32):ze(32);for(K=0;K<32;++K)ne[K]=0;for(K=le;K<H;++K)I[K]=0;le=I.length;var N=ee?new Uint16Array(le):ze(le);for(K=0;K<le;++K)ne[G=I[K]]++,L<G&&(L=G),N[K]=0;for(ne[0]=0,K=1;K<=L;++K)ne[K+16]=we=we+ne[K-1]<<1;for(K=0;K<le;++K)we=I[K],we!=0&&(N[K]=ne[we+16]++);var se=0;for(K=0;K<le;++K)if(se=I[K],se!=0)for(we=R(N[K],L)>>L-se,ce=(1<<L+4-se)-1;ce>=0;--ce)z[we|ce<<se]=se&15|K<<4;return L}var at=ee?new Uint16Array(512):ze(512),rt=ee?new Uint16Array(32):ze(32);if(!ee){for(var We=0;We<512;++We)at[We]=0;for(We=0;We<32;++We)rt[We]=0}(function(){for(var I=[],z=0;z<32;z++)I.push(5);ot(I,rt,32);var H=[];for(z=0;z<=143;z++)H.push(8);for(;z<=255;z++)H.push(9);for(;z<=279;z++)H.push(7);for(;z<=287;z++)H.push(8);ot(H,at,288)})();var ft=function(){for(var z=ee?new Uint8Array(32768):[],H=0,L=0;H<U.length-1;++H)for(;L<U[H+1];++L)z[L]=H;for(;L<32768;++L)z[L]=29;var G=ee?new Uint8Array(259):[];for(H=0,L=0;H<D.length-1;++H)for(;L<D[H+1];++L)G[L]=H;function K(we,le){for(var ne=0;ne<we.length;){var N=Math.min(65535,we.length-ne),se=ne+N==we.length;for(le.write_shift(1,+se),le.write_shift(2,N),le.write_shift(2,~N&65535);N-- >0;)le[le.l++]=we[ne++]}return le.l}function ce(we,le){for(var ne=0,N=0,se=ee?new Uint16Array(32768):[];N<we.length;){var de=Math.min(65535,we.length-N);if(de<10){for(ne=oe(le,ne,+(N+de==we.length)),ne&7&&(ne+=8-(ne&7)),le.l=ne/8|0,le.write_shift(2,de),le.write_shift(2,~de&65535);de-- >0;)le[le.l++]=we[N++];ne=le.l*8;continue}ne=oe(le,ne,+(N+de==we.length)+2);for(var ke=0;de-- >0;){var be=we[N];ke=(ke<<5^be)&32767;var Ae=-1,Ye=0;if((Ae=se[ke])&&(Ae|=N&-32768,Ae>N&&(Ae-=32768),Ae<N))for(;we[Ae+Ye]==we[N+Ye]&&Ye<250;)++Ye;if(Ye>2){be=G[Ye],be<=22?ne=fe(le,ne,k[be+1]>>1)-1:(fe(le,ne,3),ne+=5,fe(le,ne,k[be-23]>>5),ne+=3);var Vt=be<8?0:be-4>>2;Vt>0&&(Me(le,ne,Ye-D[be]),ne+=Vt),be=z[N-Ae],ne=fe(le,ne,k[be]>>3),ne-=3;var rr=be<4?0:be-2>>1;rr>0&&(Me(le,ne,N-Ae-U[be]),ne+=rr);for(var Sn=0;Sn<Ye;++Sn)se[ke]=N&32767,ke=(ke<<5^we[N])&32767,++N;de-=Ye-1}else be<=143?be=be+48:ne=ae(le,ne,1),ne=fe(le,ne,k[be]),se[ke]=N&32767,++N}ne=fe(le,ne,0)-1}return le.l=(ne+7)/8|0,le.l}return function(le,ne){return le.length<8?K(le,ne):ce(le,ne)}}();function Ze(I){var z=ve(50+Math.floor(I.length*1.1)),H=ft(I,z);return z.slice(0,H)}var qt=ee?new Uint16Array(32768):ze(32768),Or=ee?new Uint16Array(32768):ze(32768),xt=ee?new Uint16Array(128):ze(128),Bt=1,gr=1;function hr(I,z){var H=re(I,z)+257;z+=5;var L=re(I,z)+1;z+=5;var G=J(I,z)+4;z+=4;for(var K=0,ce=ee?new Uint8Array(19):ze(19),we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ne=ee?new Uint8Array(8):ze(8),N=ee?new Uint8Array(8):ze(8),se=ce.length,de=0;de<G;++de)ce[_[de]]=K=q(I,z),le<K&&(le=K),ne[K]++,z+=3;var ke=0;for(ne[0]=0,de=1;de<=le;++de)N[de]=ke=ke+ne[de-1]<<1;for(de=0;de<se;++de)(ke=ce[de])!=0&&(we[de]=N[ke]++);var be=0;for(de=0;de<se;++de)if(be=ce[de],be!=0){ke=k[we[de]]>>8-be;for(var Ae=(1<<7-be)-1;Ae>=0;--Ae)xt[ke|Ae<<be]=be&7|de<<3}var Ye=[];for(le=1;Ye.length<H+L;)switch(ke=xt[V(I,z)],z+=ke&7,ke>>>=3){case 16:for(K=3+W(I,z),z+=2,ke=Ye[Ye.length-1];K-- >0;)Ye.push(ke);break;case 17:for(K=3+q(I,z),z+=3;K-- >0;)Ye.push(0);break;case 18:for(K=11+V(I,z),z+=7;K-- >0;)Ye.push(0);break;default:Ye.push(ke),le<ke&&(le=ke);break}var Vt=Ye.slice(0,H),rr=Ye.slice(H);for(de=H;de<286;++de)Vt[de]=0;for(de=L;de<30;++de)rr[de]=0;return Bt=ot(Vt,qt,286),gr=ot(rr,Or,30),z}function Nt(I,z){if(I[0]==3&&!(I[1]&3))return[Th(z),2];for(var H=0,L=0,G=U3(z||1<<18),K=0,ce=G.length>>>0,we=0,le=0;!(L&1);){if(L=q(I,H),H+=3,L>>>1)L>>1==1?(we=9,le=5):(H=hr(I,H),we=Bt,le=gr);else{H&7&&(H+=8-(H&7));var ne=I[H>>>3]|I[(H>>>3)+1]<<8;if(H+=32,ne>0)for(!z&&ce<K+ne&&(G=Ne(G,K+ne),ce=G.length);ne-- >0;)G[K++]=I[H>>>3],H+=8;continue}for(;;){!z&&ce<K+32767&&(G=Ne(G,K+32767),ce=G.length);var N=te(I,H,we),se=L>>>1==1?at[N]:qt[N];if(H+=se&15,se>>>=4,!(se>>>8&255))G[K++]=se;else{if(se==256)break;se-=257;var de=se<8?0:se-4>>2;de>5&&(de=0);var ke=K+D[se];de>0&&(ke+=te(I,H,de),H+=de),N=te(I,H,le),se=L>>>1==1?rt[N]:Or[N],H+=se&15,se>>>=4;var be=se<4?0:se-2>>1,Ae=U[se];for(be>0&&(Ae+=te(I,H,be),H+=be),!z&&ce<ke&&(G=Ne(G,ke+100),ce=G.length);K<ke;)G[K]=G[K-Ae],++K}}}return z?[G,H+7>>>3]:[G.slice(0,K),H+7>>>3]}function Hi(I,z){var H=I.slice(I.l||0),L=Nt(H,z);return I.l+=L[1],L[0]}function Un(I,z){if(I)typeof console<"u"&&console.error(z);else throw new Error(z)}function za(I,z){var H=I;li(H,0);var L=[],G=[],K={FileIndex:L,FullPaths:G};x(K,{root:z.root});for(var ce=H.length-4;(H[ce]!=80||H[ce+1]!=75||H[ce+2]!=5||H[ce+3]!=6)&&ce>=0;)--ce;H.l=ce+4,H.l+=4;var we=H.read_shift(2);H.l+=6;var le=H.read_shift(4);for(H.l=le,ce=0;ce<we;++ce){H.l+=20;var ne=H.read_shift(4),N=H.read_shift(4),se=H.read_shift(2),de=H.read_shift(2),ke=H.read_shift(2);H.l+=8;var be=H.read_shift(4),Ae=a(H.slice(H.l+se,H.l+se+de));H.l+=se+de+ke;var Ye=H.l;H.l=be+4,lg(H,ne,N,K,Ae),H.l=Ye}return K}function lg(I,z,H,L,G){I.l+=2;var K=I.read_shift(2),ce=I.read_shift(2),we=o(I);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var le=I.read_shift(4),ne=I.read_shift(4),N=I.read_shift(4),se=I.read_shift(2),de=I.read_shift(2),ke="",be=0;be<se;++be)ke+=String.fromCharCode(I[I.l++]);if(de){var Ae=a(I.slice(I.l,I.l+de));(Ae[21589]||{}).mt&&(we=Ae[21589].mt),((G||{})[21589]||{}).mt&&(we=G[21589].mt)}I.l+=de;var Ye=I.slice(I.l,I.l+ne);switch(ce){case 8:Ye=C(I,N);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var Vt=!1;K&8&&(le=I.read_shift(4),le==134695760&&(le=I.read_shift(4),Vt=!0),ne=I.read_shift(4),N=I.read_shift(4)),ne!=z&&Un(Vt,"Bad compressed size: "+z+" != "+ne),N!=H&&Un(Vt,"Bad uncompressed size: "+H+" != "+N),n0(L,ke,Ye,{unsafe:!0,mt:we})}function zh(I,z){var H=z||{},L=[],G=[],K=ve(1),ce=H.compression?8:0,we=0,le=0,ne=0,N=0,se=0,de=I.FullPaths[0],ke=de,be=I.FileIndex[0],Ae=[],Ye=0;for(le=1;le<I.FullPaths.length;++le)if(ke=I.FullPaths[le].slice(de.length),be=I.FileIndex[le],!(!be.size||!be.content||ke=="Sh33tJ5")){var Vt=N,rr=ve(ke.length);for(ne=0;ne<ke.length;++ne)rr.write_shift(1,ke.charCodeAt(ne)&127);rr=rr.slice(0,rr.l),Ae[se]=Uhe.buf(be.content,0);var Sn=be.content;ce==8&&(Sn=S(Sn)),K=ve(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,we),K.write_shift(2,ce),be.mt?s(K,be.mt):K.write_shift(4,0),K.write_shift(-4,Ae[se]),K.write_shift(4,Sn.length),K.write_shift(4,be.content.length),K.write_shift(2,rr.length),K.write_shift(2,0),N+=K.length,L.push(K),N+=rr.length,L.push(rr),N+=Sn.length,L.push(Sn),K=ve(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,we),K.write_shift(2,ce),K.write_shift(4,0),K.write_shift(-4,Ae[se]),K.write_shift(4,Sn.length),K.write_shift(4,be.content.length),K.write_shift(2,rr.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,Vt),Ye+=K.l,G.push(K),Ye+=rr.length,G.push(rr),++se}return K=ve(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,se),K.write_shift(2,se),K.write_shift(4,Ye),K.write_shift(4,N),K.write_shift(2,0),Jn([Jn(L),Jn(G),K])}var cg={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function hT(I,z){if(I.ctype)return I.ctype;var H=I.name||"",L=H.match(/\.([^\.]+)$/);return L&&cg[L[1]]||z&&(L=(H=z).match(/[\.\\]([^\.\\])+$/),L&&cg[L[1]])?cg[L[1]]:"application/octet-stream"}function Cn(I){for(var z=Zw(I),H=[],L=0;L<z.length;L+=76)H.push(z.slice(L,L+76));return H.join(`\r
`)+`\r
`}function hu(I){var z=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var N=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(N.length==1?"0"+N:N)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],L=z.split(`\r
`),G=0;G<L.length;++G){var K=L[G];if(K.length==0){H.push("");continue}for(var ce=0;ce<K.length;){var we=76,le=K.slice(ce,ce+we);le.charAt(we-1)=="="?we--:le.charAt(we-2)=="="?we-=2:le.charAt(we-3)=="="&&(we-=3),le=K.slice(ce,ce+we),ce+=we,ce<K.length&&(le+="="),H.push(le)}}return H.join(`\r
`)}function fT(I){for(var z=[],H=0;H<I.length;++H){for(var L=I[H];H<=I.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+I[++H];z.push(L)}for(var G=0;G<z.length;++G)z[G]=z[G].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return qs(z.join(`\r
`))}function H1(I,z,H){for(var L="",G="",K="",ce,we=0;we<10;++we){var le=z[we];if(!le||le.match(/^\s*$/))break;var ne=le.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":L=ne[2].trim();break;case"content-type":K=ne[2].trim();break;case"content-transfer-encoding":G=ne[2].trim();break}}switch(++we,G.toLowerCase()){case"base64":ce=qs(ao(z.slice(we).join("")));break;case"quoted-printable":ce=fT(z.slice(we));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var N=n0(I,L.slice(H.length),ce,{unsafe:!0});K&&(N.ctype=K)}function r0(I,z){if(Q(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=z&&z.root||"",L=(bt&&Buffer.isBuffer(I)?I.toString("binary"):Q(I)).split(`\r
`),G=0,K="";for(G=0;G<L.length;++G)if(K=L[G],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),H||(H=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),K.slice(0,H.length)!=H););var ce=(L[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var we="--"+(ce[1]||""),le=[],ne=[],N={FileIndex:le,FullPaths:ne};x(N);var se,de=0;for(G=0;G<L.length;++G){var ke=L[G];ke!==we&&ke!==we+"--"||(de++&&H1(N,L.slice(se,G),H),se=G)}return N}function L1(I,z){var H=z||{},L=H.boundary||"SheetJS";L="------="+L;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],K=I.FullPaths[0],ce=K,we=I.FileIndex[0],le=1;le<I.FullPaths.length;++le)if(ce=I.FullPaths[le].slice(K.length),we=I.FileIndex[le],!(!we.size||!we.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var ne=we.content,N=bt&&Buffer.isBuffer(ne)?ne.toString("binary"):Q(ne),se=0,de=Math.min(1024,N.length),ke=0,be=0;be<=de;++be)(ke=N.charCodeAt(be))>=32&&ke<128&&++se;var Ae=se>=de*4/5;G.push(L),G.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+ce),G.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),G.push("Content-Type: "+hT(we,ce)),G.push(""),G.push(Ae?hu(N):Cn(N))}return G.push(L+`--\r
`),G.join(`\r
`)}function $1(I){var z={};return x(z,I),z}function n0(I,z,H,L){var G=L&&L.unsafe;G||x(I);var K=!G&&Xe.find(I,z);if(!K){var ce=I.FullPaths[0];z.slice(0,ce.length)==ce?ce=z:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+z).replace("//","/")),K={name:i(z),type:2},I.FileIndex.push(K),I.FullPaths.push(ce),G||Xe.utils.cfb_gc(I)}return K.content=H,K.size=H?H.length:0,L&&(L.CLSID&&(K.clsid=L.CLSID),L.mt&&(K.mt=L.mt),L.ct&&(K.ct=L.ct)),K}function fo(I,z){x(I);var H=Xe.find(I,z);if(H){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==H)return I.FileIndex.splice(L,1),I.FullPaths.splice(L,1),!0}return!1}function fu(I,z,H){x(I);var L=Xe.find(I,z);if(L){for(var G=0;G<I.FileIndex.length;++G)if(I.FileIndex[G]==L)return I.FileIndex[G].name=i(H),I.FullPaths[G]=H,!0}return!1}function B1(I){A(I,!0)}return e.find=Y,e.read=E,e.parse=u,e.write=ye,e.writeFile=ge,e.utils={cfb_new:$1,cfb_add:n0,cfb_del:fo,cfb_mov:fu,cfb_gc:B1,ReadShift:Yv,CheckField:oG,prep_blob:li,bconcat:Jn,use_zlib:j,_deflateRaw:Ze,_inflateRaw:Hi,consts:Ce},e}();let eh;function zhe(t){eh=t}function Ghe(t){return typeof t=="string"?Qy(t):Array.isArray(t)?vhe(t):t}function e1(t,e,r){if(typeof eh<"u"&&eh.writeFileSync)return r?eh.writeFileSync(t,e,r):eh.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Qy(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Al(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([Ghe(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=Hh(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function Yhe(t){if(typeof eh<"u")return eh.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ln(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Q3(t,e){for(var r=[],n=ln(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function rR(t){for(var e=[],r=ln(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function nR(t){for(var e=[],r=ln(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function Khe(t){for(var e=[],r=ln(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Zb=new Date(1899,11,30,0,0,0);function jn(t,e){var r=t.getTime(),n=Zb.getTime()+(t.getTimezoneOffset()-Zb.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var j7=new Date,Xhe=Zb.getTime()+(j7.getTimezoneOffset()-Zb.getTimezoneOffset())*6e4,Z3=j7.getTimezoneOffset();function iR(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Xhe),e.getTimezoneOffset()!==Z3&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Z3)*6e4),e}function qhe(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var eB=new Date("2017-02-19T19:06:09.000Z"),U7=isNaN(eB.getFullYear())?new Date("2/19/17"):eB,Jhe=U7.getFullYear()==2017;function Pr(t,e){var r=new Date(t);if(Jhe)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(U7.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Rd(t,e){if(bt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Al(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Al(A7(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Al(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Al(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function vr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vr(t[r]));return e}function nn(t,e){for(var r="";r.length<e;)r+=t;return r}function Oa(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var Qhe=["january","february","march","april","may","june","july","august","september","october","november","december"];function mp(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Qhe.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Zhe=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}}();function z7(t){return t?t.content&&t.type?Rd(t.content,!0):t.data?Pm(t.data):t.asNodeBuffer&&bt?Pm(t.asNodeBuffer().toString("binary")):t.asBinary?Pm(t.asBinary()):t._data&&t._data.getContent?Pm(Rd(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function G7(t){if(!t)return null;if(t.data)return Xb(t.data);if(t.asNodeBuffer&&bt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Xb(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function efe(t){return t&&t.name.slice(-4)===".bin"?G7(t):z7(t)}function Eo(t,e){for(var r=t.FullPaths||ln(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function YN(t,e){var r=Eo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function En(t,e,r){if(!r)return efe(YN(t,e));if(!e)return null;try{return En(t,e)}catch{return null}}function Js(t,e,r){if(!r)return z7(YN(t,e));if(!e)return null;try{return Js(t,e)}catch{return null}}function tfe(t,e,r){return G7(YN(t,e))}function tB(t){for(var e=t.FullPaths||ln(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function mt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return bt?n=ru(r):n=whe(r),Xe.utils.cfb_add(t,e,n)}Xe.utils.cfb_add(t,e,r)}else t.file(e,r)}function KN(){return Xe.utils.cfb_new()}function Y7(t,e){switch(e.type){case"base64":return Xe.read(t,{type:"base64"});case"binary":return Xe.read(t,{type:"binary"});case"buffer":case"array":return Xe.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Tv(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var pn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rfe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rB=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nfe=/<[^>]*>/g,Fi=pn.match(rB)?rB:nfe,ife=/<\w*:/,sfe=/<(\/?)\w+:/;function st(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(rfe),a=0,l="",c=0,u="",h="",f=1;if(o)for(c=0;c!=o.length;++c){for(h=o[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(f=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+f,h.length-f),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var d=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(n[d]&&u.slice(a-3,a)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function Bl(t){return t.replace(sfe,"<$1")}var K7={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},XN=rR(K7),Ut=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(a,l){return K7[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(e,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),qN=/[&<>'"]/g,ofe=/[\u0000-\u0008\u000b-\u001f]/g;function lr(t){var e=t+"";return e.replace(qN,function(r){return XN[r]}).replace(ofe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function nB(t){return lr(t).replace(/ /g,"_x0020_")}var X7=/[\u0000-\u001f]/g;function JN(t){var e=t+"";return e.replace(qN,function(r){return XN[r]}).replace(/\n/g,"<br/>").replace(X7,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function afe(t){var e=t+"";return e.replace(qN,function(r){return XN[r]}).replace(X7,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var iB=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function lfe(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Rr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sk(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function sB(t){var e=Th(2*t.length),r,n,i=1,s=0,o=0,a;for(n=0;n<t.length;n+=i)i=1,(a=t.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(t.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function oB(t){return ru(t,"binary").toString("utf8")}var hC="foo bar bazâð£",fr=bt&&(oB(hC)==sk(hC)&&oB||sB(hC)==sk(hC)&&sB)||sk,Al=bt?function(t){return ru(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},ty=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),q7=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),cfe=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ufe=/<\/?(?:vt:)?variant>/g,hfe=/<(?:vt:)([^>]*)>([\s\S]*)</;function aB(t,e){var r=st(t),n=t.match(cfe(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(ufe,"").match(hfe);o&&i.push({v:fr(o[2]),t:o[1]})}),i}var J7=/(^\s|\s$|\n)/;function ci(t,e){return"<"+t+(e.match(J7)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function ry(t){return ln(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ie(t,e,r){return"<"+t+(r!=null?ry(r):"")+(e!=null?(e.match(J7)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function YO(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function ffe(t,e){switch(typeof t){case"string":var r=Ie("vt:lpwstr",lr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ie((t|0)==t?"vt:i4":"vt:r8",lr(String(t)));case"boolean":return Ie("vt:bool",t?"true":"false")}if(t instanceof Date)return Ie("vt:filetime",YO(t));throw new Error("Unable to serialize "+t)}function QN(t){if(bt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return fr(Hh(UN(t)));throw new Error("Bad input format: expected Buffer or string")}var ny=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Bn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Gd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Xs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function dfe(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function gfe(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[r+a]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var lB=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},cB=bt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ru(e)})):lB(t)}:lB,uB=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ec(t,i)));return n.join("").replace(Ii,"")},sR=bt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ii,""):uB(t,e,r)}:uB,hB=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Q7=bt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):hB(t,e,r)}:hB,fB=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(rm(t,i)));return n.join("")},Hp=bt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):fB(e,r,n)}:fB,Z7=function(t,e){var r=Xn(t,e);return r>0?Hp(t,e+4,e+4+r-1):""},ZN=Z7,eG=function(t,e){var r=Xn(t,e);return r>0?Hp(t,e+4,e+4+r-1):""},eD=eG,tG=function(t,e){var r=2*Xn(t,e);return r>0?Hp(t,e+4,e+4+r-1):""},tD=tG,rG=function(e,r){var n=Xn(e,r);return n>0?sR(e,r+4,r+4+n):""},rD=rG,nG=function(t,e){var r=Xn(t,e);return r>0?Hp(t,e+4,e+4+r):""},nD=nG,iG=function(t,e){return dfe(t,e)},e_=iG,iD=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};bt&&(ZN=function(e,r){if(!Buffer.isBuffer(e))return Z7(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},eD=function(e,r){if(!Buffer.isBuffer(e))return eG(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},tD=function(e,r){if(!Buffer.isBuffer(e))return tG(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},rD=function(e,r){if(!Buffer.isBuffer(e))return rG(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},nD=function(e,r){if(!Buffer.isBuffer(e))return nG(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},e_=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):iG(e,r)},iD=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function sG(){sR=function(t,e,r){return Lt.utils.decode(1200,t.slice(e,r)).replace(Ii,"")},Hp=function(t,e,r){return Lt.utils.decode(65001,t.slice(e,r))},ZN=function(t,e){var r=Xn(t,e);return r>0?Lt.utils.decode(_d,t.slice(e+4,e+4+r-1)):""},eD=function(t,e){var r=Xn(t,e);return r>0?Lt.utils.decode(ro,t.slice(e+4,e+4+r-1)):""},tD=function(t,e){var r=2*Xn(t,e);return r>0?Lt.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},rD=function(t,e){var r=Xn(t,e);return r>0?Lt.utils.decode(1200,t.slice(e+4,e+4+r)):""},nD=function(t,e){var r=Xn(t,e);return r>0?Lt.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof Lt<"u"&&sG();var rm=function(t,e){return t[e]},Ec=function(t,e){return t[e+1]*256+t[e]},mfe=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Xn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Wf=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},pfe=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Yv(t,e){var r="",n,i,s=[],o,a,l,c;switch(e){case"dbcs":if(c=this.l,bt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ec(this,c)),c+=2;t*=2;break;case"utf8":r=Hp(this,this.l,this.l+t);break;case"utf16le":t*=2,r=sR(this,this.l,this.l+t);break;case"wstr":if(typeof Lt<"u")r=Lt.utils.decode(ro,this.slice(this.l,this.l+2*t));else return Yv.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=ZN(this,this.l),t=4+Xn(this,this.l);break;case"lpstr-cp":r=eD(this,this.l),t=4+Xn(this,this.l);break;case"lpwstr":r=tD(this,this.l),t=4+2*Xn(this,this.l);break;case"lpp4":t=4+Xn(this,this.l),r=rD(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Xn(this,this.l),r=nD(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=rm(this,this.l+t++))!==0;)s.push(Ev(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=Ec(this,this.l+t))!==0;)s.push(Ev(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=rm(this,c),this.l=c+1,a=Yv.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Ev(Ec(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":if(typeof Lt<"u"){r=Lt.utils.decode(ro,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=rm(this,c),this.l=c+1,a=Yv.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Ev(rm(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=rm(this,this.l),this.l++,n;case 2:return n=(e==="i"?mfe:Ec)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Wf:pfe)(this,this.l),this.l+=4,n):(i=Xn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=e_(this,this.l):i=e_([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Q7(this,this.l,t);break}}return this.l+=t,r}var vfe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},wfe=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},yfe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Cfe(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)yfe(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof Lt<"u"&&_d==874)for(i=0;i!=e.length;++i){var s=Lt.utils.encode(_d,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,vfe(this,e,this.l);break;case 8:if(n=8,r==="f"){gfe(this,e,this.l);break}case 16:break;case-4:n=4,wfe(this,e,this.l);break}return this.l+=n,this}function oG(t,e){var r=Q7(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function li(t,e){t.l=e,t.read_shift=Yv,t.chk=oG,t.write_shift=Cfe}function Di(t,e){t.l+=e}function ve(t){var e=Th(t);return li(e,0),e}function nu(t,e,r){if(t){var n,i,s;li(t,t.l||0);for(var o=t.length,a=0,l=0;t.l<o;){a=t.read_shift(1),a&128&&(a=(a&127)+((t.read_shift(1)&127)<<7));var c=cy[a]||cy[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var u=c.f&&c.f(t,s,r);if(t.l=l,e(u,c,a))return}}}function Is(){var t=[],e=bt?256:2048,r=function(c){var u=ve(c);return li(u,0),u},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},o=function(){return i(),Jn(t)},a=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function xe(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=cy[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&iD(r)&&t.push(r)}}function Kv(t,e,r){var n=vr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function dB(t,e,r){var n=vr(t);return n.s=Kv(n.s,e.s,r),n.e=Kv(n.e,e.s,r),n}function Xv(t,e){if(t.cRel&&t.c<0)for(t=vr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=it(t);return!t.cRel&&t.cRel!=null&&(r=bfe(r)),!t.rRel&&t.rRel!=null&&(r=Sfe(r)),r}function ok(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+kr(t.s.c)+":"+(t.e.cRel?"":"$")+kr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+sn(t.s.r)+":"+(t.e.rRel?"":"$")+sn(t.e.r):Xv(t.s,e.biff)+":"+Xv(t.e,e.biff)}function sD(t){return parseInt(xfe(t),10)-1}function sn(t){return""+(t+1)}function Sfe(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xfe(t){return t.replace(/\$(\d+)$/,"$1")}function oD(t){for(var e=_fe(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function kr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function bfe(t){return t.replace(/^([A-Z])/,"$$$1")}function _fe(t){return t.replace(/^\$([A-Z])/,"$1")}function Efe(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function it(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function es(t){var e=t.indexOf(":");return e==-1?{s:zr(t),e:zr(t)}:{s:zr(t.slice(0,e)),e:zr(t.slice(e+1))}}function gt(t,e){return typeof e>"u"||typeof e=="number"?gt(t.s,t.e):(typeof t!="string"&&(t=it(t)),typeof e!="string"&&(e=it(e)),t==e?t:t+":"+e)}function Ot(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function gB(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=lo(t.z,r?jn(e):e)}catch{}try{return t.w=lo((t.XF||{}).numFmtId||(r?14:0),r?jn(e):e)}catch{return""+e}}function Hl(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?iu[t.v]||t.v:e==null?gB(t,t.v):gB(t,e))}function Lh(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function aG(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Ot(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var d={v:e[h][f]},g=o+h,m=a+f;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))d=e[h][f];else if(Array.isArray(d.v)&&(d.f=e[h][f][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||nt[14],n.cellDates?(d.t="d",d.w=lo(d.z,jn(d.v))):(d.t="n",d.v=jn(d.v),d.w=lo(d.z,d.v))):d.t="s";if(i)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(d.z=s[g][m].z),s[g][m]=d;else{var p=it({c:m,r:g});s[p]&&s[p].z&&(d.z=s[p].z),s[p]=d}}}return c.s.c<1e7&&(s["!ref"]=gt(c)),s}function Lp(t,e){return aG(null,t,e)}function Rfe(t){return t.read_shift(4,"i")}function Ma(t,e){return e||(e=ve(4)),e.write_shift(4,t),e}function Oi(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Qn(t,e){var r=!1;return e==null&&(r=!0,e=ve(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Tfe(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function kfe(t,e){return e||(e=ve(4)),e.write_shift(2,0),e.write_shift(2,0),e}function aD(t,e){var r=t.l,n=t.read_shift(1),i=Oi(t),s=[],o={t:i,h:i};if(n&1){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(Tfe(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function Pfe(t,e){var r=!1;return e==null&&(r=!0,e=ve(15+4*t.t.length)),e.write_shift(1,0),Qn(t.t,e),r?e.slice(0,e.l):e}var Afe=aD;function Ife(t,e){var r=!1;return e==null&&(r=!0,e=ve(23+4*t.t.length)),e.write_shift(1,1),Qn(t.t,e),e.write_shift(4,1),kfe({},e),r?e.slice(0,e.l):e}function Yo(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Yd(t,e){return e==null&&(e=ve(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Kd(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Xd(t,e){return e==null&&(e=ve(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Ofe=Oi,lG=Qn;function lD(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function t_(t,e){var r=!1;return e==null&&(r=!0,e=ve(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var Mfe=Oi,KO=lD,cD=t_;function uD(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?e_([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Wf(e,0)>>2;return r?i/100:i}function cG(t,e){e==null&&(e=ve(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function uG(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Nfe(t,e){return e||(e=ve(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var qd=uG,$p=Nfe;function Pi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Td(t,e){return(e||ve(8)).write_shift(8,t,"f")}function Dfe(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=ld[i];c&&(e.rgb=sy(c));break;case 2:e.rgb=sy([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function r_(t,e){if(e||(e=ve(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Ffe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Hfe(t,e){e||(e=ve(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function hG(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Lfe(t){return hG(t,1)}function $fe(t){return hG(t,2)}var hD=2,ws=3,fC=11,mB=12,n_=19,dC=64,Bfe=65,Vfe=71,Wfe=4108,jfe=4126,Yn=80,fG=81,Ufe=[Yn,fG],XO={1:{n:"CodePage",t:hD},2:{n:"Category",t:Yn},3:{n:"PresentationFormat",t:Yn},4:{n:"ByteCount",t:ws},5:{n:"LineCount",t:ws},6:{n:"ParagraphCount",t:ws},7:{n:"SlideCount",t:ws},8:{n:"NoteCount",t:ws},9:{n:"HiddenCount",t:ws},10:{n:"MultimediaClipCount",t:ws},11:{n:"ScaleCrop",t:fC},12:{n:"HeadingPairs",t:Wfe},13:{n:"TitlesOfParts",t:jfe},14:{n:"Manager",t:Yn},15:{n:"Company",t:Yn},16:{n:"LinksUpToDate",t:fC},17:{n:"CharacterCount",t:ws},19:{n:"SharedDoc",t:fC},22:{n:"HyperlinksChanged",t:fC},23:{n:"AppVersion",t:ws,p:"version"},24:{n:"DigSig",t:Bfe},26:{n:"ContentType",t:Yn},27:{n:"ContentStatus",t:Yn},28:{n:"Language",t:Yn},29:{n:"Version",t:Yn},255:{},2147483648:{n:"Locale",t:n_},2147483651:{n:"Behavior",t:n_},1919054434:{}},qO={1:{n:"CodePage",t:hD},2:{n:"Title",t:Yn},3:{n:"Subject",t:Yn},4:{n:"Author",t:Yn},5:{n:"Keywords",t:Yn},6:{n:"Comments",t:Yn},7:{n:"Template",t:Yn},8:{n:"LastAuthor",t:Yn},9:{n:"RevNumber",t:Yn},10:{n:"EditTime",t:dC},11:{n:"LastPrinted",t:dC},12:{n:"CreatedDate",t:dC},13:{n:"ModifiedDate",t:dC},14:{n:"PageCount",t:ws},15:{n:"WordCount",t:ws},16:{n:"CharCount",t:ws},17:{n:"Thumbnail",t:Vfe},18:{n:"Application",t:Yn},19:{n:"DocSecurity",t:ws},255:{},2147483648:{n:"Locale",t:n_},2147483651:{n:"Behavior",t:n_},1919054434:{}},pB={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zfe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Gfe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Yfe=Gfe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ld=vr(Yfe),iu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},dG={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},JO={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},gC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function fD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Kfe(t){var e=fD();if(!t||!t.match)return e;var r={};if((t.match(Fi)||[]).forEach(function(n){var i=st(n);switch(i[0].replace(ife,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[JO[i.ContentType]]!==void 0&&e[JO[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Bn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function gG(t,e){var r=Khe(JO),n=[],i;n[n.length]=pn,n[n.length]=Ie("Types",null,{xmlns:Bn.CT,"xmlns:xsd":Bn.xsd,"xmlns:xsi":Bn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ie("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Ie("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:gC[l][e.bookType]||gC[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Ie("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:gC[l][e.bookType]||gC[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=Ie("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Et={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function iy(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function qv(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Fi)||[]).forEach(function(i){var s=st(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:Tv(s.Target,e);r[a]=o,n[s.Id]=o}}),r["!id"]=n,r}function Gm(t){var e=[pn,Ie("Relationships",null,{xmlns:Bn.RELS})];return ln(t["!id"]).forEach(function(r){e[e.length]=Ie("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ar(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Et.HLINK,Et.XPATH,Et.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var Xfe="application/vnd.oasis.opendocument.spreadsheet";function qfe(t,e){for(var r=QN(t),n,i;n=ny.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=st(n[0],!1),i.path=="/"&&i.type!==Xfe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function Jfe(t){var e=[pn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function vB(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Qfe(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Zfe(t){var e=[pn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(vB(t[r][0],t[r][1])),e.push(Qfe("",t[r][0]));return e.push(vB("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function mG(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Qw.version+"</meta:generator></office:meta></office:document-meta>"}var Wo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ede=function(){for(var t=new Array(Wo.length),e=0;e<Wo.length;++e){var r=Wo[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function pG(t){var e={};t=fr(t);for(var r=0;r<Wo.length;++r){var n=Wo[r],i=t.match(ede[r]);i!=null&&i.length>0&&(e[n[1]]=Ut(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Pr(e[n[1]]))}return e}function ak(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=lr(e),n[n.length]=r?Ie(t,e,r):ci(t,e))}function vG(t,e){var r=e||{},n=[pn,Ie("cp:coreProperties",null,{"xmlns:cp":Bn.CORE_PROPS,"xmlns:dc":Bn.dc,"xmlns:dcterms":Bn.dcterms,"xmlns:dcmitype":Bn.dcmitype,"xmlns:xsi":Bn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&ak("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:YO(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&ak("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:YO(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Wo.length;++s){var o=Wo[s],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&ak(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var cd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wG=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function yG(t,e,r,n){var i=[];if(typeof t=="string")i=aB(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(u){return{v:u}}));var o=typeof e=="string"?aB(e,n).map(function(u){return u.v}):e,a=0,l=0;if(o.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function tde(t,e,r){var n={};return e||(e={}),t=fr(t),cd.forEach(function(i){var s=(t.match(ty(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Ut(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&yG(n.HeadingPairs,n.TitlesOfParts,e,r),e}function CG(t){var e=[],r=Ie;return t||(t={}),t.Application="SheetJS",e[e.length]=pn,e[e.length]=Ie("Properties",null,{xmlns:Bn.EXT_PROPS,"xmlns:vt":Bn.vt}),cd.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=lr(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+lr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var rde=/<[^>]+>[^<]*/g;function nde(t,e){var r={},n="",i=t.match(rde);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=st(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ut(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ut(u);break;case"bool":r[n]=Rr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Pr(u);break;case"cy":case"error":r[n]=Ut(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function SG(t){var e=[pn,Ie("Properties",null,{xmlns:Bn.CUST_PROPS,"xmlns:vt":Bn.vt})];if(!t)return e.join("");var r=1;return ln(t).forEach(function(i){++r,e[e.length]=Ie("property",ffe(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:lr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var QO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},lk;function ide(t,e,r){lk||(lk=rR(QO)),e=lk[e]||e,t[e]=r}function sde(t,e){var r=[];return ln(QO).map(function(n){for(var i=0;i<Wo.length;++i)if(Wo[i][1]==n)return Wo[i];for(i=0;i<cd.length;++i)if(cd[i][1]==n)return cd[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(ci(QO[n[1]]||n[1],i))}}),Ie("DocumentProperties",r.join(""),{xmlns:Xs.o})}function ode(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&ln(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<Wo.length;++o)if(s==Wo[o][1])return;for(o=0;o<cd.length;++o)if(s==cd[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(Ie(nB(s),a,{"dt:dt":l}))}}),e&&ln(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Ie(nB(s),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+Xs.o+'">'+i.join("")+"</"+n+">"}function dD(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ade(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=ve(8);return o.write_shift(4,n),o.write_shift(4,i),o}function xG(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function bG(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function _G(t,e,r){return e===31?bG(t):xG(t,e,r)}function ZO(t,e,r){return _G(t,e,r===!1?0:4)}function lde(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return _G(t,e,0)}function cde(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Ii,""),t.l-i&2&&(t.l+=2)}return r}function ude(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Ii,"");return r}function hde(t){var e=t.l,r=i_(t,fG);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=i_(t,ws);return[r,n]}function fde(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(hde(t));return r}function wB(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),o=t.read_shift(4);n[s]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Ii,"").replace(Rv,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function EG(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function dde(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function i_(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==mB&&n!==e&&Ufe.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===mB?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return xG(t,n,4).replace(Ii,"");case 31:return bG(t);case 64:return dD(t);case 65:return EG(t);case 71:return dde(t);case 80:return ZO(t,n,!s.raw).replace(Ii,"");case 81:return lde(t,n).replace(Ii,"");case 4108:return fde(t);case 4126:case 4127:return n==4127?cde(t):ude(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function yB(t,e){var r=ve(4),n=ve(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ve(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=ade(e);break;case 31:case 80:for(n=ve(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Jn([r,n])}function CB(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0,a=0,l=-1,c={};for(o=0;o!=i;++o){var u=t.read_shift(4),h=t.read_shift(4);s[o]=[u,h+r]}s.sort(function(v,y){return v[1]-y[1]});var f={};for(o=0;o!=i;++o){if(t.l!==s[o][1]){var d=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:t.l+2===s[o][1]&&(t.l+=2,d=!1);break;case 80:t.l<=s[o][1]&&(t.l=s[o][1],d=!1);break;case 4108:t.l<=s[o][1]&&(t.l=s[o][1],d=!1);break}if((!e||o==0)&&t.l<=s[o][1]&&(d=!1,t.l=s[o][1]),d)throw new Error("Read Error: Expected address "+s[o][1]+" at "+t.l+" :"+o)}if(e){var g=e[s[o][0]];if(f[g.n]=i_(t,g.t,{raw:!0}),g.p==="version"&&(f[g.n]=String(f[g.n]>>16)+"."+("0000"+String(f[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(f[g.n]){case 0:f[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Bo(a=f[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[g.n])}}else if(s[o][0]===1){if(a=f.CodePage=i_(t,hD),Bo(a),l!==-1){var m=t.l;t.l=s[l][1],c=wB(t,a),t.l=m}}else if(s[o][0]===0){if(a===0){l=o,t.l=s[o+1][1];continue}c=wB(t,a)}else{var p=c[s[o][0]],w;switch(t[t.l]){case 65:t.l+=4,w=EG(t);break;case 30:t.l+=4,w=ZO(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,w=ZO(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,w=t.read_shift(4,"i");break;case 19:t.l+=4,w=t.read_shift(4);break;case 5:t.l+=4,w=t.read_shift(8,"f");break;case 11:t.l+=4,w=hn(t,4);break;case 64:t.l+=4,w=Pr(dD(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[p]=w}}return t.l=r+n,f}var RG=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function gde(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function SB(t,e,r){var n=ve(8),i=[],s=[],o=8,a=0,l=ve(8),c=ve(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!e){c=ve(8),c.write_shift(4,0),i.unshift(c);var u=[ve(4)];for(u[0].write_shift(4,t.length),a=0;a<t.length;++a){var h=t[a][0];for(l=ve(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Jn(u),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(RG.indexOf(t[a][0])>-1||wG.indexOf(t[a][0])>-1)&&t[a][1]!=null){var f=t[a][1],d=0;if(e){d=+e[t[a][0]];var g=r[d];if(g.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=yB(g.t,f)}else{var p=gde(f);p==-1&&(p=31,f=String(f)),l=yB(p,f)}s.push(l),c=ve(8),c.write_shift(4,e?d:2+a),i.push(c),o+=8+l.length}var w=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,w),w+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),Jn([n].concat(i).concat(s))}function xB(t,e,r){var n=t.content;if(!n)return{};li(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Xe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),i===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var h=CB(n,e),f={SystemIdentifier:c};for(var d in h)f[d]=h[d];if(f.FMTID=s,i===1)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=CB(n,null)}catch{}for(d in g)f[d]=g[d];return f.FMTID=[s,o],f}function bB(t,e,r,n,i,s){var o=ve(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Xe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=SB(t,r,n);if(a.push(l),i){var c=SB(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Jn(a)}function pu(t,e){return t.read_shift(e),null}function mde(t,e){e||(e=ve(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function pde(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function hn(t,e){return t.read_shift(e)===1}function Ki(t,e){return e||(e=ve(2)),e.write_shift(2,+!!t),e}function Rn(t){return t.read_shift(2,"u")}function To(t,e){return e||(e=ve(2)),e.write_shift(2,t),e}function TG(t,e){return pde(t,e,Rn)}function vde(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function kG(t,e,r){return r||(r=ve(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function t1(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=ro;if(r&&r.biff>=8&&(ro=1200),!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return ro=s,a}function wde(t){var e=ro;ro=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,s=n&8,o=1+(n&1),a=0,l,c={};s&&(a=t.read_shift(2)),i&&(l=t.read_shift(4));var u=o==2?"dbcs-cont":"sbcs-cont",h=r===0?"":t.read_shift(r,u);return s&&(t.l+=4*a),i&&(t.l+=l),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),ro=e,c}function yde(t){var e=t.t||"",r=ve(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ve(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Jn(i)}function kd(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function r1(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):kd(t,n,r)}function Jd(t,e,r){if(r.biff>5)return r1(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function PG(t,e,r){return r||(r=ve(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Cde(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Sde(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Ii,"");return n&&(t.l+=24),i}function xde(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(s>>1,"utf16le").replace(Ii,"");return r+o}function bde(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Sde(t);case"0303000000000000c000000000000046":return xde(t);default:throw new Error("Unsupported Moniker "+r)}}function mC(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Ii,""):"";return r}function _B(t,e){e||(e=ve(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function _de(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,o,a,l,c="",u,h;i&16&&(s=mC(t,r-t.l)),i&128&&(o=mC(t,r-t.l)),(i&257)===257&&(a=mC(t,r-t.l)),(i&257)===1&&(l=bde(t,r-t.l)),i&8&&(c=mC(t,r-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(h=dD(t)),t.l=r;var f=o||a||l||"";f&&c&&(f+="#"+c),f||(f="#"+c),i&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var d={Target:f};return u&&(d.guid=u),h&&(d.time=h),s&&(d.Tooltip=s),d}function Ede(t){var e=ve(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),_B(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var a=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)e.write_shift(2,a.charCodeAt(r));e.write_shift(2,0),s&8&&_B(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function AG(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function IG(t,e){var r=AG(t);return r[3]=0,r}function Vl(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Pd(t,e,r,n){return n||(n=ve(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function Rde(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Tde(t,e,r){return e===0?"":Jd(t,e,r)}function kde(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,s,o]}function OG(t){var e=t.read_shift(2),r=uD(t);return[e,r]}function Pde(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=t1(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function oR(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function MG(t,e){return e||(e=ve(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function NG(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var Ade=NG;function DG(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Ide(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Ode(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function mi(t){t.l+=2,t.l+=t.read_shift(2)}var Mde={0:mi,4:mi,5:mi,6:mi,7:Ode,8:mi,9:mi,10:mi,11:mi,12:mi,13:Ide,14:mi,15:mi,16:mi,17:mi,18:mi,19:mi,20:mi,21:DG};function Nde(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(Mde[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function pC(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function gD(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ve(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Dde(t,e){return e===0||t.read_shift(2),1200}function Fde(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Jd(t,0,r);return t.read_shift(e+n-t.l),i}function Hde(t,e){var r=!e||e.biff==8,n=ve(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Lde(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function $de(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=t1(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Bde(t,e){var r=!e||e.biff>=8?2:1,n=ve(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Vde(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],o=0;o!=i&&t.l<r;++o)s.push(wde(t));return s.Count=n,s.Unique=i,s}function Wde(t,e){var r=ve(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=yde(t[i]);var s=Jn([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function jde(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function Ude(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function zde(t){var e=Rde(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function Gde(t){return t.read_shift(2),t.read_shift(4)}function EB(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function Yde(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:a,Selected:l,TabRatio:c}}function Kde(){var t=ve(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Xde(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function qde(t){var e=ve(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Jde(){}function Qde(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=t1(t,0,r),n}function Zde(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ve(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function ege(t){var e=Vl(t);return e.isst=t.read_shift(4),e}function tge(t,e,r,n){var i=ve(10);return Pd(t,e,n,i),i.write_shift(4,r),i}function rge(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Vl(t);r.biff==2&&t.l++;var s=r1(t,n-t.l,r);return i.val=s,i}function nge(t,e,r,n,i){var s=!i||i.biff==8,o=ve(8+ +s+(1+s)*r.length);return Pd(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function ige(t,e,r){var n=t.read_shift(2),i=Jd(t,0,r);return[n,i]}function sge(t,e,r,n){var i=r&&r.biff==5;n||(n=ve(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var oge=Jd;function RB(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),o=t.read_shift(i),a=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function age(t,e){var r=e.biff==8||!e.biff?4:2,n=ve(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function lge(t){var e=t.read_shift(2),r=t.read_shift(2),n=OG(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function cge(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(OG(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function uge(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function hge(t,e,r,n){var i={},s=t.read_shift(4),o=t.read_shift(4),a=t.read_shift(4),l=t.read_shift(2);return i.patternType=zfe[a>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function fge(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=hge(t,e,n.fStyle,r),n}function TB(t,e,r,n){var i=r&&r.biff==5;n||(n=ve(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function dge(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function gge(t){var e=ve(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function kB(t,e,r){var n=Vl(t);(r.biff==2||e==9)&&++t.l;var i=vde(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function mge(t,e,r,n,i,s){var o=ve(8);return Pd(t,e,n,o),kG(r,s,o),o}function pge(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Vl(t),i=Pi(t);return n.val=i,n}function vge(t,e,r,n){var i=ve(14);return Pd(t,e,n,i),Td(r,i),i}var PB=Tde;function wge(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=kd(t,s),a=[];n>t.l;)a.push(r1(t));return[s,i,o,a]}function AB(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Pde(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var yge=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function IB(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),o=t.read_shift(1),a=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=kd(t,o,r);i&32&&(c=yge[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||a===0||!(u>0)?[]:Nve(t,u,r,a);return{chKey:s,Name:c,itab:l,rgce:h}}function FG(t,e,r){if(r.biff<8)return Cge(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(kde(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function Cge(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=t1(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Sge(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=kd(t,n,r),o=kd(t,i,r);return[s,o]}function xge(t,e,r){var n=NG(t);t.l++;var i=t.read_shift(1);return e-=8,[Dve(t,e,r),i,n]}function OB(t,e,r){var n=Ade(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Ove(t,e,r)]}function bge(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function _ge(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2),a=Jd(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},a,o,s]}}function Ege(t,e,r){return _ge(t,e,r)}function Rge(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(oR(t));return r}function Tge(t){var e=ve(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)MG(t[r],e);return e}function kge(t,e,r){if(r&&r.biff<8)return Age(t,e,r);var n=DG(t),i=Nde(t,e-22,n[1]);return{cmo:n,ft:i}}var Pge={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function Age(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((Pge[n]||Di)(t,e,r)),{cmo:[i,n,s],ft:o}}function Ige(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:o=Cde(t,6,r);var a=t.read_shift(2);t.read_shift(2),Rn(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=kd(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(u?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function Oge(t,e){var r=oR(t);t.l+=16;var n=_de(t,e-24);return[r,n]}function Mge(t){var e=ve(24),r=zr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Jn([e,Ede(t[1])])}function Nge(t,e){t.read_shift(2);var r=oR(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Ii,""),[r,n]}function Dge(t){var e=t[1].Tooltip,r=ve(10+2*(e.length+1));r.write_shift(2,2048);var n=zr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function Fge(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=pB[r]||r,r=t.read_shift(2),e[1]=pB[r]||r,e}function Hge(t){return t||(t=ve(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Lge(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(IG(t));return r}function $ge(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(IG(t));return r}function Bge(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function HG(t,e,r){if(!r.cellStyles)return Di(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Vge(t,e){var r=ve(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Wge(t,e){var r={};return e<32||(t.l+=16,r.header=Pi(t),r.footer=Pi(t),t.l+=2),r}function jge(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function Uge(t){for(var e=ve(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var zge=Vl,Gge=TG,Yge=r1;function Kge(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function Xge(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Vl(t);++t.l;var i=Jd(t,e-7,r);return n.t="str",n.val=i,n}function qge(t){var e=Vl(t);++t.l;var r=Pi(t);return e.t="n",e.val=r,e}function Jge(t,e,r){var n=ve(15);return o1(n,t,e),n.write_shift(8,r,"f"),n}function Qge(t){var e=Vl(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Zge(t,e,r){var n=ve(9);return o1(n,t,e),n.write_shift(2,r),n}function eme(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function tme(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function rme(t,e,r){var n=t.l+e,i=Vl(t),s=t.read_shift(2),o=kd(t,s,r);return t.l=n,i.t="str",i.val=o,i}var nme=[2,3,48,49,131,139,140,245],eM=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=rR({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var c=[],u=Th(1);switch(l.type){case"base64":u=qs(ao(a));break;case"binary":u=qs(a);break;case"buffer":case"array":u=a;break}li(u,0);var h=u.read_shift(1),f=!!(h&136),d=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,f=!0;break;case 49:d=!0,f=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,p=521;h==2&&(m=u.read_shift(2)),u.l+=3,h!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(p=u.read_shift(2));var w=u.read_shift(2),v=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(v=t[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],b={},T=Math.min(u.length,h==2?521:p-10-(d?264:0)),E=g?32:11;u.l<T&&u[u.l]!=13;)switch(b={},b.name=Lt.utils.decode(v,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,b.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(b.offset=u.read_shift(4)),b.len=u.read_shift(1),h==2&&(b.offset=u.read_shift(2)),b.dec=u.read_shift(1),b.name.length&&y.push(b),h!=2&&(u.l+=g?13:14),b.type){case"B":(!d||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(u[u.l]!==13&&(u.l=p-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=p;var x=0,P=0;for(c[0]=[],P=0;P!=y.length;++P)c[0][P]=y[P].name;for(;m-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++x]=[],P=0,P=0;P!=y.length;++P){var A=u.slice(u.l,u.l+y[P].len);u.l+=y[P].len,li(A,0);var O=Lt.utils.decode(v,A);switch(y[P].type){case"C":O.trim().length&&(c[x][P]=O.replace(/\s+$/,""));break;case"D":O.length===8?c[x][P]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):c[x][P]=O;break;case"F":c[x][P]=parseFloat(O.trim());break;case"+":case"I":c[x][P]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":c[x][P]=!0;break;case"N":case"F":c[x][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[x][P]="##MEMO##"+(g?parseInt(O.trim(),10):A.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(c[x][P]=+O||0);break;case"@":c[x][P]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[x][P]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[x][P]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[x][P]=-A.read_shift(-8,"f");break;case"B":if(d&&y[P].len==8){c[x][P]=A.read_shift(8,"f");break}case"G":case"P":A.l+=y[P].len;break;case"0":if(y[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[P].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Lp(r(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return Lh(n(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&Bo(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Is(),h=l_(a,{header:1,raw:!0,cellDates:!0}),f=h[0],d=h.slice(1),g=a["!cols"]||[],m=0,p=0,w=0,v=1;for(m=0;m<f.length;++m){if(((g[m]||{}).DBF||{}).name){f[m]=g[m].DBF.name,++w;continue}if(f[m]!=null){if(++w,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(p=0;p<1024;++p)if(f.indexOf(f[m]+"_"+p)==-1){f[m]+="_"+p;break}}}}var y=Ot(a["!ref"]),b=[],T=[],E=[];for(m=0;m<=y.e.c-y.s.c;++m){var x="",P="",A=0,O=[];for(p=0;p<d.length;++p)d[p][m]!=null&&O.push(d[p][m]);if(O.length==0||f[m]==null){b[m]="?";continue}for(p=0;p<O.length;++p){switch(typeof O[p]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=O[p]instanceof Date?"D":"C";break;default:P="C"}A=Math.max(A,String(O[p]).length),x=x&&x!=P?"C":P}A>250&&(A=250),P=((g[m]||{}).DBF||{}).type,P=="C"&&g[m].DBF.len>A&&(A=g[m].DBF.len),x=="B"&&P=="N"&&(x="N",E[m]=g[m].DBF.dec,A=g[m].DBF.len),T[m]=x=="C"||P=="N"?A:s[x]||0,v+=T[m],b[m]=x}var Y=u.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,d.length),Y.write_shift(2,296+32*w),Y.write_shift(2,v),m=0;m<4;++m)Y.write_shift(4,0);for(Y.write_shift(4,0|(+e[_d]||3)<<8),m=0,p=0;m<f.length;++m)if(f[m]!=null){var B=u.next(32),ie=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,ie,"sbcs"),B.write_shift(1,b[m]=="?"?"C":b[m],"sbcs"),B.write_shift(4,p),B.write_shift(1,T[m]||s[b[m]]||0),B.write_shift(1,E[m]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),p+=T[m]||s[b[m]]||0}var ue=u.next(264);for(ue.write_shift(4,13),m=0;m<65;++m)ue.write_shift(4,0);for(m=0;m<d.length;++m){var he=u.next(v);for(he.write_shift(1,0),p=0;p<f.length;++p)if(f[p]!=null)switch(b[p]){case"L":he.write_shift(1,d[m][p]==null?63:d[m][p]?84:70);break;case"B":he.write_shift(8,d[m][p]||0,"f");break;case"N":var Ee="0";for(typeof d[m][p]=="number"&&(Ee=d[m][p].toFixed(E[p]||0)),w=0;w<T[p]-Ee.length;++w)he.write_shift(1,32);he.write_shift(1,Ee,"sbcs");break;case"D":d[m][p]?(he.write_shift(4,("0000"+d[m][p].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(d[m][p].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+d[m][p].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(d[m][p]!=null?d[m][p]:"").slice(0,T[p]);for(he.write_shift(1,Ce,"sbcs"),w=0;w<T[p]-Ce.length;++w)he.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),LG=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ln(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,d){var g=t[d];return typeof g=="number"?GO(g):g},n=function(f,d,g){var m=d.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?f:GO(m)};t["|"]=254;function i(f,d){switch(d.type){case"base64":return s(ao(f),d);case"binary":return s(f,d);case"buffer":return s(bt&&Buffer.isBuffer(f)?f.toString("binary"):Hh(f),d);case"array":return s(Rd(f),d)}throw new Error("Unrecognized type "+d.type)}function s(f,d){var g=f.split(/[\n\r]+/),m=-1,p=-1,w=0,v=0,y=[],b=[],T=null,E={},x=[],P=[],A=[],O=0,Y;for(+d.codepage>=0&&Bo(+d.codepage);w!==g.length;++w){O=0;var B=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),ie=B.replace(/;;/g,"\0").split(";").map(function(_){return _.replace(/\u0000/g,";")}),ue=ie[0],he;if(B.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ie[1].charAt(0)=="P"&&b.push(B.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,Ce=!1,ge=!1,Q=!1,ye=-1,Re=-1;for(v=1;v<ie.length;++v)switch(ie[v].charAt(0)){case"A":break;case"X":p=parseInt(ie[v].slice(1))-1,Ce=!0;break;case"Y":for(m=parseInt(ie[v].slice(1))-1,Ce||(p=0),Y=y.length;Y<=m;++Y)y[Y]=[];break;case"K":he=ie[v].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(Oa(he))?isNaN(mp(he).getDate())||(he=Pr(he)):(he=Oa(he),T!==null&&zd(T)&&(he=iR(he))),typeof Lt<"u"&&typeof he=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(he=Lt.utils.decode(d.codepage,he)),Ee=!0;break;case"E":Q=!0;var j=Ym(ie[v].slice(1),{r:m,c:p});y[m][p]=[y[m][p],j];break;case"S":ge=!0,y[m][p]=[y[m][p],"S5S"];break;case"G":break;case"R":ye=parseInt(ie[v].slice(1))-1;break;case"C":Re=parseInt(ie[v].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}if(Ee&&(y[m][p]&&y[m][p].length==2?y[m][p][0]=he:y[m][p]=he,T=null),ge){if(Q)throw new Error("SYLK shared formula cannot have own formula");var C=ye>-1&&y[ye][Re];if(!C||!C[1])throw new Error("SYLK shared formula cannot find base");y[m][p][1]=rY(C[1],{r:m-ye,c:p-Re})}break;case"F":var S=0;for(v=1;v<ie.length;++v)switch(ie[v].charAt(0)){case"X":p=parseInt(ie[v].slice(1))-1,++S;break;case"Y":for(m=parseInt(ie[v].slice(1))-1,Y=y.length;Y<=m;++Y)y[Y]=[];break;case"M":O=parseInt(ie[v].slice(1))/20;break;case"F":break;case"G":break;case"P":T=b[parseInt(ie[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=ie[v].slice(1).split(" "),Y=parseInt(A[0],10);Y<=parseInt(A[1],10);++Y)O=parseInt(A[2],10),P[Y-1]=O===0?{hidden:!0}:{wch:O},kh(P[Y-1]);break;case"C":p=parseInt(ie[v].slice(1))-1,P[p]||(P[p]={});break;case"R":m=parseInt(ie[v].slice(1))-1,x[m]||(x[m]={}),O>0?(x[m].hpt=O,x[m].hpx=vp(O)):O===0&&(x[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}S<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+B)}}return x.length>0&&(E["!rows"]=x),P.length>0&&(E["!cols"]=P),d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),[y,E]}function o(f,d){var g=i(f,d),m=g[0],p=g[1],w=Lp(m,d);return ln(p).forEach(function(v){w[v]=p[v]}),w}function a(f,d){return Lh(o(f,d),d)}function l(f,d,g,m){var p="C;Y"+(g+1)+";X"+(m+1)+";K";switch(f.t){case"n":p+=f.v||0,f.f&&!f.F&&(p+=";E"+CD(f.f,{r:g,c:m}));break;case"b":p+=f.v?"TRUE":"FALSE";break;case"e":p+=f.w||f.v;break;case"d":p+='"'+(f.w||f.v)+'"';break;case"s":p+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function c(f,d){d.forEach(function(g,m){var p="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?p+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=oy(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=ay(g.wpx)),typeof g.wch=="number"&&(p+=Math.round(g.wch))),p.charAt(p.length-1)!=" "&&f.push(p)})}function u(f,d){d.forEach(function(g,m){var p="F;";g.hidden?p+="M0;":g.hpt?p+="M"+20*g.hpt+";":g.hpx&&(p+="M"+20*ly(g.hpx)+";"),p.length>2&&f.push(p+"R"+(m+1))})}function h(f,d){var g=["ID;PWXL;N;E"],m=[],p=Ot(f["!ref"]),w,v=Array.isArray(f),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),f["!cols"]&&c(g,f["!cols"]),f["!rows"]&&u(g,f["!rows"]),g.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var b=p.s.r;b<=p.e.r;++b)for(var T=p.s.c;T<=p.e.c;++T){var E=it({r:b,c:T});w=v?(f[b]||[])[T]:f[E],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,f,b,T))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),$G=function(){function t(s,o){switch(o.type){case"base64":return e(ao(s),o);case"binary":return e(s,o);case"buffer":return e(bt&&Buffer.isBuffer(s)?s.toString("binary"):Hh(s),o);case"array":return e(Rd(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var f=a[u].trim().split(","),d=f[0],g=f[1];++u;for(var m=a[u]||"";(m.match(/["]/g)||[]).length&1&&u<a.length-1;)m+=`
`+a[++u];switch(m=m.trim(),+d){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(Oa(g))?isNaN(mp(g).getDate())?h[l][c]=g:h[l][c]=Pr(g):h[l][c]=Oa(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return Lp(t(s,o),o)}function n(s,o){return Lh(r(s,o),o)}var i=function(){var s=function(l,c,u,h,f){l.push(c),l.push(u+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Ot(l["!ref"]),h,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){o(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=it({r:d,c:g});if(h=f?(l[d]||[])[g]:l[m],!h){o(c,1,0,"");continue}switch(h.t){case"n":var p=h.w;!p&&h.v!=null&&(p=h.v),p==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,p,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=lo(h.z||nt[14],jn(Pr(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var w=`\r
`,v=c.join(w);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),BG=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var d=h.split(`
`),g=-1,m=-1,p=0,w=[];p!==d.length;++p){var v=d[p].trim().split(":");if(v[0]==="cell"){var y=zr(v[1]);if(w.length<=y.r)for(g=w.length;g<=y.r;++g)w[g]||(w[g]=[]);switch(g=y.r,m=y.c,v[2]){case"t":w[g][m]=t(v[3]);break;case"v":w[g][m]=+v[3];break;case"vtf":var b=v[v.length-1];case"vtc":switch(v[3]){case"nl":w[g][m]=!!+v[4];break;default:w[g][m]=+v[4];break}v[2]=="vtf"&&(w[g][m]=[w[g][m],b])}}}return f&&f.sheetRows&&(w=w.slice(0,f.sheetRows)),w}function n(h,f){return Lp(r(h,f),f)}function i(h,f){return Lh(n(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],d=[],g,m="",p=es(h["!ref"]),w=Array.isArray(h),v=p.s.r;v<=p.e.r;++v)for(var y=p.s.c;y<=p.e.c;++y)if(m=it({r:v,c:y}),g=w?(h[v]||[])[y]:h[m],!(!g||g.v==null||g.t==="z")){switch(d=["cell",m,"t"],g.t){case"s":case"str":d.push(e(g.v));break;case"n":g.f?(d[2]="vtf",d[3]="n",d[4]=g.v,d[5]=e(g.f)):(d[2]="v",d[3]=g.v);break;case"b":d[2]="vt"+(g.f?"f":"c"),d[3]="nl",d[4]=g.v?"1":"0",d[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var b=jn(Pr(g.v));d[2]="vtc",d[3]="nd",d[4]=""+b,d[5]=g.w||lo(g.z||nt[14],b);break;case"e":continue}f.push(d.join(":"))}return f.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),pp=function(){function t(u,h,f,d,g){g.raw?h[f][d]=u:u===""||(u==="TRUE"?h[f][d]=!0:u==="FALSE"?h[f][d]=!1:isNaN(Oa(u))?isNaN(mp(u).getDate())?h[f][d]=u:h[f][d]=Pr(u):h[f][d]=Oa(u))}function e(u,h){var f=h||{},d=[];if(!u||u.length===0)return d;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var p=10,w=0,v=0;v<=m;++v)w=g[v].indexOf(" "),w==-1?w=g[v].length:w++,p=Math.max(p,w);for(v=0;v<=m;++v){d[v]=[];var y=0;for(t(g[v].slice(0,p).trim(),d,v,y,f),y=1;y<=(g[v].length-p)/10+1;++y)t(g[v].slice(p+(y-1)*10,p+y*10).trim(),d,v,y,f)}return f.sheetRows&&(d=d.slice(0,f.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},f=!1,d=0,g=0;d<u.length;++d)(g=u.charCodeAt(d))==34?f=!f:!f&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d]);if(!g.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&g.push([h[d],d])}return g.sort(function(m,p){return m[0]-p[0]||n[m[1]]-n[p[1]]}),r[g.pop()[1]]||44}function s(u,h){var f=h||{},d="",g=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):f&&f.FS?d=f.FS:d=i(u.slice(0,1024));var p=0,w=0,v=0,y=0,b=0,T=d.charCodeAt(0),E=!1,x=0,P=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var A=f.dateNF!=null?Whe(f.dateNF):null;function O(){var Y=u.slice(y,b),B={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),Y.length===0)B.t="z";else if(f.raw)B.t="s",B.v=Y;else if(Y.trim().length===0)B.t="s",B.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(B.t="s",B.v=Y.slice(2,-1).replace(/""/g,'"')):w0e(Y)?(B.t="n",B.f=Y.slice(1)):(B.t="s",B.v=Y);else if(Y=="TRUE")B.t="b",B.v=!0;else if(Y=="FALSE")B.t="b",B.v=!1;else if(!isNaN(v=Oa(Y)))B.t="n",f.cellText!==!1&&(B.w=Y),B.v=v;else if(!isNaN(mp(Y).getDate())||A&&Y.match(A)){B.z=f.dateNF||nt[14];var ie=0;A&&Y.match(A)&&(Y=jhe(Y,f.dateNF,Y.match(A)||[]),ie=1),f.cellDates?(B.t="d",B.v=Pr(Y,ie)):(B.t="n",B.v=jn(Pr(Y,ie))),f.cellText!==!1&&(B.w=lo(B.z,B.v instanceof Date?jn(B.v):B.v)),f.cellNF||delete B.z}else B.t="s",B.v=Y;if(B.t=="z"||(f.dense?(g[p]||(g[p]=[]),g[p][w]=B):g[it({c:w,r:p})]=B),y=b+1,P=u.charCodeAt(y),m.e.c<w&&(m.e.c=w),m.e.r<p&&(m.e.r=p),x==T)++w;else if(w=0,++p,f.sheetRows&&f.sheetRows<=p)return!0}e:for(;b<u.length;++b)switch(x=u.charCodeAt(b)){case 34:P===34&&(E=!E);break;case T:case 10:case 13:if(!E&&O())break e;break}return b-y>0&&O(),g["!ref"]=gt(m),g}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):Lp(e(u,h),h)}function a(u,h){var f="",d=h.type=="string"?[0,0,0,0]:PD(u,h);switch(h.type){case"base64":f=ao(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof Lt<"u"?f=Lt.utils.decode(h.codepage,u):f=bt&&Buffer.isBuffer(u)?u.toString("binary"):Hh(u);break;case"array":f=Rd(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?f=fr(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=fr(f):h.type=="binary"&&typeof Lt<"u"&&h.codepage&&(f=Lt.utils.decode(h.codepage,Lt.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?BG.to_sheet(h.type=="string"?f:fr(f),h):o(f,h)}function l(u,h){return Lh(a(u,h),h)}function c(u){for(var h=[],f=Ot(u["!ref"]),d,g=Array.isArray(u),m=f.s.r;m<=f.e.r;++m){for(var p=[],w=f.s.c;w<=f.e.c;++w){var v=it({r:m,c:w});if(d=g?(u[m]||[])[w]:u[v],!d||d.v==null){p.push("          ");continue}for(var y=(d.w||(Hl(d),d.w)||"").slice(0,10);y.length<10;)y+=" ";p.push(y+(w===0?" ":""))}h.push(p.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}();function ime(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=LG.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return pp.to_workbook(t,e)}}var ud=function(){function t(j,C,S){if(j){li(j,j.l||0);for(var _=S.Enum||ye;j.l<j.length;){var D=j.read_shift(2),U=_[D]||_[65535],X=j.read_shift(2),ee=j.l+X,k=U.f&&U.f(j,X,S);if(j.l=ee,C(k,U,D))return}}}function e(j,C){switch(C.type){case"base64":return r(qs(ao(j)),C);case"binary":return r(qs(j),C);case"buffer":case"array":return r(j,C)}throw"Unsupported type "+C.type}function r(j,C){if(!j)return j;var S=C||{},_=S.dense?[]:{},D="Sheet1",U="",X=0,ee={},k=[],M=[],R={s:{r:0,c:0},e:{r:0,c:0}},W=S.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)S.Enum=ye,t(j,function(V,te,oe){switch(oe){case 0:S.vers=V,V>=4096&&(S.qpro=!0);break;case 6:R=V;break;case 204:V&&(U=V);break;case 222:U=V;break;case 15:case 51:S.qpro||(V[1].v=V[1].v.slice(1));case 13:case 14:case 16:oe==14&&(V[2]&112)==112&&(V[2]&15)>1&&(V[2]&15)<15&&(V[1].z=S.dateNF||nt[14],S.cellDates&&(V[1].t="d",V[1].v=iR(V[1].v))),S.qpro&&V[3]>X&&(_["!ref"]=gt(R),ee[D]=_,k.push(D),_=S.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},X=V[3],D=U||"Sheet"+(X+1),U="");var ae=S.dense?(_[V[0].r]||[])[V[0].c]:_[it(V[0])];if(ae){ae.t=V[1].t,ae.v=V[1].v,V[1].z!=null&&(ae.z=V[1].z),V[1].f!=null&&(ae.f=V[1].f);break}S.dense?(_[V[0].r]||(_[V[0].r]=[]),_[V[0].r][V[0].c]=V[1]):_[it(V[0])]=V[1];break}},S);else if(j[2]==26||j[2]==14)S.Enum=Re,j[2]==14&&(S.qpro=!0,j.l=0),t(j,function(V,te,oe){switch(oe){case 204:D=V;break;case 22:V[1].v=V[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(V[3]>X&&(_["!ref"]=gt(R),ee[D]=_,k.push(D),_=S.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},X=V[3],D="Sheet"+(X+1)),W>0&&V[0].r>=W)break;S.dense?(_[V[0].r]||(_[V[0].r]=[]),_[V[0].r][V[0].c]=V[1]):_[it(V[0])]=V[1],R.e.c<V[0].c&&(R.e.c=V[0].c),R.e.r<V[0].r&&(R.e.r=V[0].r);break;case 27:V[14e3]&&(M[V[14e3][0]]=V[14e3][1]);break;case 1537:M[V[0]]=V[1],V[0]==X&&(D=V[1]);break}},S);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(_["!ref"]=gt(R),ee[U||D]=_,k.push(U||D),!M.length)return{SheetNames:k,Sheets:ee};for(var q={},J=[],re=0;re<M.length;++re)ee[k[re]]?(J.push(M[re]||k[re]),q[M[re]]=ee[M[re]]||ee[k[re]]):(J.push(M[re]),q[M[re]]={"!ref":"A1"});return{SheetNames:J,Sheets:q}}function n(j,C){var S=C||{};if(+S.codepage>=0&&Bo(+S.codepage),S.type=="string")throw new Error("Cannot write WK1 to JS string");var _=Is(),D=Ot(j["!ref"]),U=Array.isArray(j),X=[];Oe(_,0,s(1030)),Oe(_,6,l(D));for(var ee=Math.min(D.e.r,8191),k=D.s.r;k<=ee;++k)for(var M=sn(k),R=D.s.c;R<=D.e.c;++R){k===D.s.r&&(X[R]=kr(R));var W=X[R]+M,q=U?(j[k]||[])[R]:j[W];if(!(!q||q.t=="z"))if(q.t=="n")(q.v|0)==q.v&&q.v>=-32768&&q.v<=32767?Oe(_,13,d(k,R,q.v)):Oe(_,14,m(k,R,q.v));else{var J=Hl(q);Oe(_,15,h(k,R,J.slice(0,239)))}}return Oe(_,1),_.end()}function i(j,C){var S=C||{};if(+S.codepage>=0&&Bo(+S.codepage),S.type=="string")throw new Error("Cannot write WK3 to JS string");var _=Is();Oe(_,0,o(j));for(var D=0,U=0;D<j.SheetNames.length;++D)(j.Sheets[j.SheetNames[D]]||{})["!ref"]&&Oe(_,27,Q(j.SheetNames[D],U++));var X=0;for(D=0;D<j.SheetNames.length;++D){var ee=j.Sheets[j.SheetNames[D]];if(!(!ee||!ee["!ref"])){for(var k=Ot(ee["!ref"]),M=Array.isArray(ee),R=[],W=Math.min(k.e.r,8191),q=k.s.r;q<=W;++q)for(var J=sn(q),re=k.s.c;re<=k.e.c;++re){q===k.s.r&&(R[re]=kr(re));var V=R[re]+J,te=M?(ee[q]||[])[re]:ee[V];if(!(!te||te.t=="z"))if(te.t=="n")Oe(_,23,O(q,re,X,te.v));else{var oe=Hl(te);Oe(_,22,x(q,re,X,oe.slice(0,239)))}}++X}}return Oe(_,1),_.end()}function s(j){var C=ve(2);return C.write_shift(2,j),C}function o(j){var C=ve(26);C.write_shift(2,4096),C.write_shift(2,4),C.write_shift(4,0);for(var S=0,_=0,D=0,U=0;U<j.SheetNames.length;++U){var X=j.SheetNames[U],ee=j.Sheets[X];if(!(!ee||!ee["!ref"])){++D;var k=es(ee["!ref"]);S<k.e.r&&(S=k.e.r),_<k.e.c&&(_=k.e.c)}}return S>8191&&(S=8191),C.write_shift(2,S),C.write_shift(1,D),C.write_shift(1,_),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(1,1),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(4,0),C}function a(j,C,S){var _={s:{c:0,r:0},e:{c:0,r:0}};return C==8&&S.qpro?(_.s.c=j.read_shift(1),j.l++,_.s.r=j.read_shift(2),_.e.c=j.read_shift(1),j.l++,_.e.r=j.read_shift(2),_):(_.s.c=j.read_shift(2),_.s.r=j.read_shift(2),C==12&&S.qpro&&(j.l+=2),_.e.c=j.read_shift(2),_.e.r=j.read_shift(2),C==12&&S.qpro&&(j.l+=2),_.s.c==65535&&(_.s.c=_.e.c=_.s.r=_.e.r=0),_)}function l(j){var C=ve(8);return C.write_shift(2,j.s.c),C.write_shift(2,j.s.r),C.write_shift(2,j.e.c),C.write_shift(2,j.e.r),C}function c(j,C,S){var _=[{c:0,r:0},{t:"n",v:0},0,0];return S.qpro&&S.vers!=20768?(_[0].c=j.read_shift(1),_[3]=j.read_shift(1),_[0].r=j.read_shift(2),j.l+=2):(_[2]=j.read_shift(1),_[0].c=j.read_shift(2),_[0].r=j.read_shift(2)),_}function u(j,C,S){var _=j.l+C,D=c(j,C,S);if(D[1].t="s",S.vers==20768){j.l++;var U=j.read_shift(1);return D[1].v=j.read_shift(U,"utf8"),D}return S.qpro&&j.l++,D[1].v=j.read_shift(_-j.l,"cstr"),D}function h(j,C,S){var _=ve(7+S.length);_.write_shift(1,255),_.write_shift(2,C),_.write_shift(2,j),_.write_shift(1,39);for(var D=0;D<_.length;++D){var U=S.charCodeAt(D);_.write_shift(1,U>=128?95:U)}return _.write_shift(1,0),_}function f(j,C,S){var _=c(j,C,S);return _[1].v=j.read_shift(2,"i"),_}function d(j,C,S){var _=ve(7);return _.write_shift(1,255),_.write_shift(2,C),_.write_shift(2,j),_.write_shift(2,S,"i"),_}function g(j,C,S){var _=c(j,C,S);return _[1].v=j.read_shift(8,"f"),_}function m(j,C,S){var _=ve(13);return _.write_shift(1,255),_.write_shift(2,C),_.write_shift(2,j),_.write_shift(8,S,"f"),_}function p(j,C,S){var _=j.l+C,D=c(j,C,S);if(D[1].v=j.read_shift(8,"f"),S.qpro)j.l=_;else{var U=j.read_shift(2);b(j.slice(j.l,j.l+U),D),j.l+=U}return D}function w(j,C,S){var _=C&32768;return C&=-32769,C=(_?j:0)+(C>=8192?C-16384:C),(_?"":"$")+(S?kr(C):sn(C))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(j,C){li(j,0);for(var S=[],_=0,D="",U="",X="",ee="";j.l<j.length;){var k=j[j.l++];switch(k){case 0:S.push(j.read_shift(8,"f"));break;case 1:U=w(C[0].c,j.read_shift(2),!0),D=w(C[0].r,j.read_shift(2),!1),S.push(U+D);break;case 2:{var M=w(C[0].c,j.read_shift(2),!0),R=w(C[0].r,j.read_shift(2),!1);U=w(C[0].c,j.read_shift(2),!0),D=w(C[0].r,j.read_shift(2),!1),S.push(M+R+":"+U+D)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:S.push("("+S.pop()+")");break;case 5:S.push(j.read_shift(2));break;case 6:{for(var W="";k=j[j.l++];)W+=String.fromCharCode(k);S.push('"'+W.replace(/"/g,'""')+'"')}break;case 8:S.push("-"+S.pop());break;case 23:S.push("+"+S.pop());break;case 22:S.push("NOT("+S.pop()+")");break;case 20:case 21:ee=S.pop(),X=S.pop(),S.push(["AND","OR"][k-20]+"("+X+","+ee+")");break;default:if(k<32&&y[k])ee=S.pop(),X=S.pop(),S.push(X+y[k]+ee);else if(v[k]){if(_=v[k][1],_==69&&(_=j[j.l++]),_>S.length){console.error("WK1 bad formula parse 0x"+k.toString(16)+":|"+S.join("|")+"|");return}var q=S.slice(-_);S.length-=_,S.push(v[k][0]+"("+q.join(",")+")")}else return k<=7?console.error("WK1 invalid opcode "+k.toString(16)):k<=24?console.error("WK1 unsupported op "+k.toString(16)):k<=30?console.error("WK1 invalid opcode "+k.toString(16)):k<=115?console.error("WK1 unsupported function opcode "+k.toString(16)):console.error("WK1 unrecognized opcode "+k.toString(16))}}S.length==1?C[1].f=""+S[0]:console.error("WK1 bad formula parse |"+S.join("|")+"|")}function T(j){var C=[{c:0,r:0},{t:"n",v:0},0];return C[0].r=j.read_shift(2),C[3]=j[j.l++],C[0].c=j[j.l++],C}function E(j,C){var S=T(j);return S[1].t="s",S[1].v=j.read_shift(C-4,"cstr"),S}function x(j,C,S,_){var D=ve(6+_.length);D.write_shift(2,j),D.write_shift(1,S),D.write_shift(1,C),D.write_shift(1,39);for(var U=0;U<_.length;++U){var X=_.charCodeAt(U);D.write_shift(1,X>=128?95:X)}return D.write_shift(1,0),D}function P(j,C){var S=T(j);S[1].v=j.read_shift(2);var _=S[1].v>>1;if(S[1].v&1)switch(_&7){case 0:_=(_>>3)*5e3;break;case 1:_=(_>>3)*500;break;case 2:_=(_>>3)/20;break;case 3:_=(_>>3)/200;break;case 4:_=(_>>3)/2e3;break;case 5:_=(_>>3)/2e4;break;case 6:_=(_>>3)/16;break;case 7:_=(_>>3)/64;break}return S[1].v=_,S}function A(j,C){var S=T(j),_=j.read_shift(4),D=j.read_shift(4),U=j.read_shift(2);if(U==65535)return _===0&&D===3221225472?(S[1].t="e",S[1].v=15):_===0&&D===3489660928?(S[1].t="e",S[1].v=42):S[1].v=0,S;var X=U&32768;return U=(U&32767)-16446,S[1].v=(1-X*2)*(D*Math.pow(2,U+32)+_*Math.pow(2,U)),S}function O(j,C,S,_){var D=ve(14);if(D.write_shift(2,j),D.write_shift(1,S),D.write_shift(1,C),_==0)return D.write_shift(4,0),D.write_shift(4,0),D.write_shift(2,65535),D;var U=0,X=0,ee=0,k=0;return _<0&&(U=1,_=-_),X=Math.log2(_)|0,_/=Math.pow(2,X-31),k=_>>>0,k&2147483648||(_/=2,++X,k=_>>>0),_-=k,k|=2147483648,k>>>=0,_*=Math.pow(2,32),ee=_>>>0,D.write_shift(4,ee),D.write_shift(4,k),X+=16383+(U?32768:0),D.write_shift(2,X),D}function Y(j,C){var S=A(j);return j.l+=C-14,S}function B(j,C){var S=T(j),_=j.read_shift(4);return S[1].v=_>>6,S}function ie(j,C){var S=T(j),_=j.read_shift(8,"f");return S[1].v=_,S}function ue(j,C){var S=ie(j);return j.l+=C-10,S}function he(j,C){return j[j.l+C-1]==0?j.read_shift(C,"cstr"):""}function Ee(j,C){var S=j[j.l++];S>C-1&&(S=C-1);for(var _="";_.length<S;)_+=String.fromCharCode(j[j.l++]);return _}function Ce(j,C,S){if(!(!S.qpro||C<21)){var _=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var D=j.read_shift(C-21,"cstr");return[_,D]}}function ge(j,C){for(var S={},_=j.l+C;j.l<_;){var D=j.read_shift(2);if(D==14e3){for(S[D]=[0,""],S[D][0]=j.read_shift(2);j[j.l];)S[D][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return S}function Q(j,C){var S=ve(5+j.length);S.write_shift(2,14e3),S.write_shift(2,C);for(var _=0;_<j.length;++_){var D=j.charCodeAt(_);S[S.l++]=D>127?95:D}return S[S.l++]=0,S}var ye={0:{n:"BOF",f:Rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},Re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:Y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ge},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:ie},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function sme(t){var e={},r=t.match(Fi),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=st(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=jN[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var ome=function(){var t=ty("t"),e=ty("rPr");function r(s){var o=s.match(t);if(!o)return{t:"s",v:""};var a={t:"s",v:Ut(o[1])},l=s.match(e);return l&&(a.s=sme(l[1])),a}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(a){return a.v})}}(),ame=function(){var e=/(\r\n|\n)/g;function r(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),lme=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cme=/<(?:\w+:)?r>/,ume=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function mD(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ut(fr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=fr(t),r&&(n.h=JN(n.t))):t.match(cme)&&(n.r=fr(t),n.t=Ut(fr((t.replace(ume,"").match(lme)||[]).join("").replace(Fi,""))),r&&(n.h=ame(ome(n.r)))),n):{t:""}}var hme=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,fme=/<(?:\w+:)?(?:si|sstItem)>/g,dme=/<\/(?:\w+:)?(?:si|sstItem)>/;function gme(t,e){var r=[],n="";if(!t)return r;var i=t.match(hme);if(i){n=i[2].replace(fme,"").split(dme);for(var s=0;s!=n.length;++s){var o=mD(n[s].trim(),e);o!=null&&(r[r.length]=o)}i=st(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var mme=/^\s|\s$|[\t\n\r]/;function VG(t,e){if(!e.bookSST)return"";var r=[pn];r[r.length]=Ie("sst",null,{xmlns:Gd[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(mme)&&(s+=' xml:space="preserve"'),s+=">"+lr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function pme(t){return[t.read_shift(4),t.read_shift(4)]}function vme(t,e){var r=[],n=!1;return nu(t,function(s,o,a){switch(a){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function wme(t,e){return e||(e=ve(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var yme=Pfe;function Cme(t){var e=Is();xe(e,159,wme(t));for(var r=0;r<t.length;++r)xe(e,19,yme(t[r]));return xe(e,160),e.end()}function WG(t){if(typeof Lt<"u")return Lt.utils.encode(_d,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Hc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Sme(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Hc(t,4),e.U=Hc(t,4),e.W=Hc(t,4),e}function xme(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function bme(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(xme(t));return e}function _me(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Eme(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Hc(t,4),e.U=Hc(t,4),e.W=Hc(t,4),e}function Rme(t){var e=Eme(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function jG(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function UG(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Tme(t){var e=Hc(t);switch(e.Minor){case 2:return[e.Minor,kme(t)];case 3:return[e.Minor,Pme()];case 4:return[e.Minor,Ame(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function kme(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=jG(t,r),i=UG(t,t.length-t.l);return{t:"Std",h:n,v:i}}function Pme(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Ame(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Fi,function(s){var o=st(s);switch(Bl(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Ime(t,e){var r={},n=r.EncryptionVersionInfo=Hc(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=jG(t,i),e-=i,r.EncryptionVerifier=UG(t,e),r}function Ome(t){var e={},r=e.EncryptionVersionInfo=Hc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function pD(t){var e=0,r,n=WG(t),i=n.length+1,s,o,a,l,c;for(r=Th(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=e&16384?1:0,l=e<<1&32767,c=a|l,e=c^o;return e^52811}var zG=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,a){return n(o^a)},s=function(o){for(var a=e[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],h=0;h!=7;++h)u&64&&(a^=r[l]),u*=2,--l;return a};return function(o){for(var a=WG(o),l=s(a),c=a.length,u=Th(16),h=0;h!=16;++h)u[h]=0;var f,d,g;for((c&1)===1&&(f=l>>8,u[c]=i(t[0],f),--c,f=l&255,d=a[a.length-1],u[c]=i(d,f));c>0;)--c,f=l>>8,u[c]=i(a[c],f),--c,f=l&255,u[c]=i(a[c],f);for(c=15,g=15-a.length;g>0;)f=l>>8,u[c]=i(t[g],f),--c,--g,f=l&255,u[c]=i(a[c],f),--c,--g;return u}}(),Mme=function(t,e,r,n,i){i||(i=e),n||(n=zG(t));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Nme=function(t){var e=0,r=zG(t);return function(n){var i=Mme("",n,e,r);return e=i[1],i[0]}};function Dme(t,e,r,n){var i={key:Rn(t),verificationBytes:Rn(t)};return r.password&&(i.verifier=pD(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Nme(r.password)),i}function Fme(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Ome(t):n.Data=Ime(t,e),n}function Hme(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Fme(t,e-2,n):Dme(t,r.biff>=8?e:e-2,r,n),n}var GG=function(){function t(i,s){switch(s.type){case"base64":return e(ao(i),s);case"binary":return e(i,s);case"buffer":return e(bt&&Buffer.isBuffer(i)?i.toString("binary"):Hh(i),s);case"array":return e(Rd(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var f=/\\\w+\b/g,d=0,g,m=-1;g=f.exec(u);){switch(g[0]){case"\\cell":var p=u.slice(d,f.lastIndex-g[0].length);if(p[0]==" "&&(p=p.slice(1)),++m,p.length){var w={v:p,t:"s"};Array.isArray(a)?a[h][m]=w:a[it({r:h,c:m})]=w}break}d=f.lastIndex}m>c.e.c&&(c.e.c=m)}),a["!ref"]=gt(c),a}function r(i,s){return Lh(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Ot(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=it({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(Hl(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Lme(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function sy(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function $me(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),o=i-s;if(o===0)return[0,0,e];var a=0,l=0,c=i+s;switch(l=o/(c>1?2-c:c),i){case e:a=((r-n)/o+6)%6;break;case r:a=(n-e)/o+2;break;case n:a=(e-r)/o+4;break}return[a/6,l,c/2]}function Bme(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],a=6*e,l;if(r!==0)switch(a|0){case 0:case 6:l=i*a,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-a),o[0]+=l,o[1]+=i;break;case 2:l=i*(a-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-a),o[1]+=l,o[2]+=i;break;case 4:l=i*(a-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-a),o[2]+=l,o[0]+=i;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function s_(t,e){if(e===0)return t;var r=$me(Lme(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),sy(Bme(r))}var YG=6,Vme=15,Wme=1,Ri=YG;function oy(t){return Math.floor((t+Math.round(128/Ri)/256)*Ri)}function ay(t){return Math.floor((t-5)/Ri*100+.5)/100}function o_(t){return Math.round((t*Ri+5)/Ri*256)/256}function ck(t){return o_(ay(oy(t)))}function vD(t){var e=Math.abs(t-ck(t)),r=Ri;if(e>.005)for(Ri=Wme;Ri<Vme;++Ri)Math.abs(t-ck(t))<=e&&(e=Math.abs(t-ck(t)),r=Ri);Ri=r}function kh(t){t.width?(t.wpx=oy(t.width),t.wch=ay(t.wpx),t.MDW=Ri):t.wpx?(t.wch=ay(t.wpx),t.width=o_(t.wch),t.MDW=Ri):typeof t.wch=="number"&&(t.width=o_(t.wch),t.wpx=oy(t.width),t.MDW=Ri),t.customWidth&&delete t.customWidth}var jme=96,KG=jme;function ly(t){return t*96/KG}function vp(t){return t*KG/96}var Ume={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zme(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Fi)||[]).forEach(function(o){var a=st(o);switch(Bl(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=Rr(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=Rr(a.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function Gme(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Fi)||[]).forEach(function(o){var a=st(o);switch(Bl(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function Yme(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Fi)||[]).forEach(function(o){var a=st(o);switch(Bl(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=fr(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?Rr(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?Rr(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?Rr(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?Rr(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?Rr(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?Rr(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?Rr(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=jN[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=Rr(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=ld[i.color.index];i.color.index==81&&(l=ld[1]),l||(l=ld[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=s_(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function Kme(t,e,r){e.NumberFmt=[];for(var n=ln(nt),i=0;i<n.length;++i)e.NumberFmt[n[i]]=nt[n[i]];var s=t[0].match(Fi);if(s)for(i=0;i<s.length;++i){var o=st(s[i]);switch(Bl(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Ut(fr(o.formatCode)),l=parseInt(o.numFmtId,10);if(e.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=a}Nl(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Xme(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ie("numFmt",null,{numFmtId:n,formatCode:lr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ie("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var vC=["numFmtId","fillId","fontId","borderId","xfId"],wC=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qme(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Fi)||[]).forEach(function(s){var o=st(s),a=0;switch(Bl(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<vC.length;++a)n[vC[a]]&&(n[vC[a]]=parseInt(n[vC[a]],10));for(a=0;a<wC.length;++a)n[wC[a]]&&(n[wC[a]]=Rr(n[wC[a]]));if(e.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[a]){n.numFmtId=a;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Rr(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Jme(t){var e=[];return e[e.length]=Ie("cellXfs",null),t.forEach(function(r){e[e.length]=Ie("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ie("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Qme=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=a.match(e))&&Kme(h,u,c),(h=a.match(i))&&Yme(h,u,l,c),(h=a.match(n))&&Gme(h,u,l,c),(h=a.match(s))&&zme(h,u,l,c),(h=a.match(r))&&qme(h,u,c),u}}();function XG(t,e){var r=[pn,Ie("styleSheet",null,{xmlns:Gd[0],"xmlns:vt":Bn.vt})],n;return t.SSF&&(n=Xme(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Jme(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Zme(t,e){var r=t.read_shift(2),n=Oi(t);return[r,n]}function epe(t,e,r){r||(r=ve(6+4*e.length)),r.write_shift(2,t),Qn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function tpe(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Ffe(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var a=t.read_shift(1);a>0&&(n.family=a);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Dfe(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Oi(t),n}function rpe(t,e){e||(e=ve(25+4*32)),e.write_shift(2,t.sz*20),Hfe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),r_(t.color,e);var n=0;return n=2,e.write_shift(1,n),Qn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var npe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],uk,ipe=Di;function MB(t,e){e||(e=ve(4*3+8*7+16*1)),uk||(uk=rR(npe));var r=uk[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(r_({auto:1},e),r_({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function spe(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function qG(t,e,r){r||(r=ve(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function d0(t,e){return e||(e=ve(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var ope=Di;function ape(t,e){return e||(e=ve(51)),e.write_shift(1,0),d0(null,e),d0(null,e),d0(null,e),d0(null,e),d0(null,e),e.length>e.l?e.slice(0,e.l):e}function lpe(t,e){return e||(e=ve(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),t_(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function cpe(t,e,r){var n=ve(2052);return n.write_shift(4,t),t_(e,n),t_(r,n),n.length>n.l?n.slice(0,n.l):n}function upe(t,e,r){var n={};n.NumberFmt=[];for(var i in nt)n.NumberFmt[i]=nt[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return nu(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Nl(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=s_(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function hpe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(xe(t,615,Ma(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&xe(t,44,epe(i,e[i]))}),xe(t,616))}}function fpe(t){var e=1;xe(t,611,Ma(e)),xe(t,43,rpe({sz:12,color:{theme:1},name:"Calibri",family:2})),xe(t,612)}function dpe(t){var e=2;xe(t,603,Ma(e)),xe(t,45,MB({patternType:"none"})),xe(t,45,MB({patternType:"gray125"})),xe(t,604)}function gpe(t){var e=1;xe(t,613,Ma(e)),xe(t,46,ape()),xe(t,614)}function mpe(t){var e=1;xe(t,626,Ma(e)),xe(t,47,qG({numFmtId:0},65535)),xe(t,627)}function ppe(t,e){xe(t,617,Ma(e.length)),e.forEach(function(r){xe(t,47,qG(r,0))}),xe(t,618)}function vpe(t){var e=1;xe(t,619,Ma(e)),xe(t,48,lpe({xfId:0,name:"Normal"})),xe(t,620)}function wpe(t){var e=0;xe(t,505,Ma(e)),xe(t,506)}function ype(t){var e=0;xe(t,508,cpe(e,"TableStyleMedium9","PivotStyleMedium4")),xe(t,509)}function Cpe(t,e){var r=Is();return xe(r,278),hpe(r,t.SSF),fpe(r),dpe(r),gpe(r),mpe(r),ppe(r,e.cellXfs),vpe(r),wpe(r),ype(r),xe(r,279),r.end()}var Spe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xpe(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Fi)||[]).forEach(function(i){var s=st(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Spe.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function bpe(){}function _pe(){}var Epe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Rpe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Tpe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function kpe(t,e,r){e.themeElements={};var n;[["clrScheme",Epe,xpe],["fontScheme",Rpe,bpe],["fmtScheme",Tpe,_pe]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var Ppe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function JG(t,e){(!t||t.length===0)&&(t=wD());var r,n={};if(!(r=t.match(Ppe)))throw new Error("themeElements not found in theme");return kpe(r[0],n,e),n.raw=t,n}function wD(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[pn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ape(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var o;try{o=Y7(s,{type:"array"})}catch{return}var a=Js(o,"theme/theme/theme1.xml",!0);if(a)return JG(a,r)}}function Ipe(t){return t.read_shift(4)}function Ope(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=Mpe(t,4);break;case 2:e.xclrValue=AG(t);break;case 3:e.xclrValue=Ipe(t);break;case 4:t.l+=4;break}return t.l+=8,e}function Mpe(t,e){return Di(t,e)}function Npe(t,e){return Di(t,e)}function Dpe(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ope(t);break;case 6:n[1]=Npe(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Fpe(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(Dpe(t,r-t.l));return{ixfe:n,ext:s}}function Hpe(t,e){e.forEach(function(r){switch(r[0]){}})}function Lpe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Oi(t)}}function $pe(t){var e=ve(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Qn(t.name,e),e.slice(0,e.l)}function Bpe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Vpe(t){var e=ve(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Wpe(t,e){var r=ve(8+2*e.length);return r.write_shift(4,t),Qn(e,r),r.slice(0,r.l)}function jpe(t){return t.l+=4,t.read_shift(4)!=0}function Upe(t,e){var r=ve(8);return r.write_shift(4,t),r.write_shift(4,1),r}function zpe(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return nu(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){a==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):a==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!c.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function Gpe(){var t=Is();return xe(t,332),xe(t,334,Ma(1)),xe(t,335,$pe({name:"XLDAPR",version:12e4,flags:3496657072})),xe(t,336),xe(t,339,Wpe(1,"XLDAPR")),xe(t,52),xe(t,35,Ma(514)),xe(t,4096,Ma(0)),xe(t,4097,To(1)),xe(t,36),xe(t,53),xe(t,340),xe(t,337,Upe(1)),xe(t,51,Vpe([[1,0]])),xe(t,338),xe(t,333),t.end()}function Ype(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,o;return t.replace(Fi,function(a){var l=st(a);switch(Bl(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(o=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),n}function QG(){var t=[pn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Kpe(t){var e=[];if(!t)return e;var r=1;return(t.match(Fi)||[]).forEach(function(n){var i=st(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function Xpe(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=it(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function qpe(t,e,r){var n=[];return nu(t,function(s,o,a){switch(a){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function Jpe(t,e,r,n){if(!t)return t;var i=n||{},s=!1;nu(t,function(a,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function Qpe(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Am=1024;function ZG(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ie("xml",null,{"xmlns:v":Xs.v,"xmlns:o":Xs.o,"xmlns:x":Xs.x,"xmlns:mv":Xs.mv}).replace(/\/>/,">"),Ie("o:shapelayout",Ie("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ie("v:shapetype",[Ie("v:stroke",null,{joinstyle:"miter"}),Ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Am<t*1e3;)Am+=1e3;return e.forEach(function(s){var o=zr(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?Ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ie("v:fill",l,a),u={on:"t",obscured:"t"};++Am,i=i.concat(["<v:shape"+ry({id:"_x0000_s"+Am,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ie("v:shadow",null,u),Ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ci("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ci("x:AutoFill","False"),ci("x:Row",String(o.r)),ci("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function NB(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(o){var a=zr(o.ref);if(i?(t[a.r]||(t[a.r]=[]),s=t[a.r][a.c]):s=t[o.ref],!s){s={t:"z"},i?t[a.r][a.c]=s:t[o.ref]=s;var l=Ot(t["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=gt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function Zpe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=st(a[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=zr(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&mD(h[1])||{r:"",t:"",h:""};c.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),c.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=f.h),n.push(c)}}}}),n}function eY(t){var e=[pn,Ie("comments",null,{xmlns:Gd[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=lr(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(lr(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(ci("t",lr(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(ci("t",lr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function e0e(t,e){var r=[],n=!1,i={},s=0;return t.replace(Fi,function(a,l){var c=st(a);switch(Bl(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+a.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),r}function t0e(t,e,r){var n=[pn,Ie("ThreadedComments",null,{xmlns:Bn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ie("threadedComment",ci("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function r0e(t,e){var r=[],n=!1;return t.replace(Fi,function(s){var o=st(s);switch(Bl(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function n0e(t){var e=[pn,Ie("personList",null,{xmlns:Bn.TCMNT,"xmlns:x":Gd[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ie("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function i0e(t){var e={};e.iauthor=t.read_shift(4);var r=qd(t);return e.rfx=r.s,e.ref=it(r.s),t.l+=16,e}function s0e(t,e){return e==null&&(e=ve(36)),e.write_shift(4,t[1].iauthor),$p(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var o0e=Oi;function a0e(t){return Qn(t.slice(0,54))}function l0e(t,e){var r=[],n=[],i={},s=!1;return nu(t,function(a,l,c){switch(c){case 632:n.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function c0e(t){var e=Is(),r=[];return xe(e,628),xe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),xe(e,632,a0e(i.a)))})}),xe(e,631),xe(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:zr(n[0]),e:zr(n[0])};xe(e,635,s0e([s,i])),i.t&&i.t.length>0&&xe(e,637,Ife(i)),xe(e,636),delete i.iauthor})}),xe(e,634),xe(e,629),e.end()}var u0e="application/vnd.ms-office.vbaProject";function h0e(t){var e=Xe.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Xe.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Xe.write(e)}function f0e(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var tY=["xlsb","xlsm","xlam","biff8","xla"];function d0e(){return{"!type":"dialog"}}function g0e(){return{"!type":"dialog"}}function m0e(){return{"!type":"macro"}}function p0e(){return{"!type":"macro"}}var Ym=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+kr(u)+(l?"":"$")+sn(c)}return function(i,s){return e=s,i.replace(t,r)}}(),yD=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,CD=function(){return function(e,r){return e.replace(yD,function(n,i,s,o,a,l){var c=oD(o)-(s?0:r.c),u=sD(l)-(a?0:r.r),h=u==0?"":a?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+f})}}();function rY(t,e){return t.replace(yD,function(r,n,i,s,o,a){return n+(i=="$"?i+s:kr(oD(s)+e.c))+(o=="$"?o+a:sn(sD(a)+e.r))})}function v0e(t,e,r){var n=es(e),i=n.s,s=zr(r),o={r:s.r-i.r,c:s.c-i.c};return rY(t,o)}function w0e(t){return t.length!=1}function DB(t){return t.replace(/_xlfn\./g,"")}function xn(t){t.l+=1}function Ph(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function nY(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return iY(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),o=Ph(t),a=Ph(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function iY(t){var e=Ph(t),r=Ph(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function y0e(t,e,r){if(r.biff<8)return iY(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Ph(t),o=Ph(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function sY(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return C0e(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Ph(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function C0e(t){var e=Ph(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function S0e(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function x0e(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return b0e(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function b0e(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function _0e(t,e,r){var n=(t[t.l++]&96)>>5,i=nY(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function E0e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=nY(t,s,r);return[n,i,o]}function R0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function T0e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function k0e(t,e,r){var n=(t[t.l++]&96)>>5,i=y0e(t,e-1,r);return[n,i]}function P0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function FB(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function A0e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function I0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function O0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function M0e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function N0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function oY(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function D0e(t){return t.read_shift(2),oY(t)}function F0e(t){return t.read_shift(2),oY(t)}function H0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=sY(t,0,r);return[n,i]}function L0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=x0e(t,0,r);return[n,i]}function $0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=sY(t,0,r);return[n,i,s]}function B0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[jve[i],cY[i],n]}function V0e(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:W0e(t);return[i,(s[0]===0?cY:Wve)[s[1]]]}function W0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function j0e(t,e,r){t.l+=r&&r.biff==2?3:4}function U0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function z0e(t){return t.l++,iu[t.read_shift(1)]}function G0e(t){return t.l++,t.read_shift(2)}function Y0e(t){return t.l++,t.read_shift(1)!==0}function K0e(t){return t.l++,Pi(t)}function X0e(t,e,r){return t.l++,t1(t,e-1,r)}function q0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=iu[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Pi(t);break;case 2:r[1]=Jd(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function J0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?qd:oR)(t));return i}function Q0e(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=q0e(t,r.biff);return o}function Z0e(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function eve(t,e,r){if(r.biff==5)return tve(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function tve(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function rve(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function nve(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function ive(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function sve(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var ove=Di,ave=Di,lve=Di;function n1(t,e,r){return t.l+=2,[S0e(t)]}function SD(t){return t.l+=6,[]}var cve=n1,uve=SD,hve=SD,fve=n1;function aY(t){return t.l+=2,[Rn(t),t.read_shift(2)&1]}var dve=n1,gve=aY,mve=SD,pve=n1,vve=n1,wve=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function yve(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=wve[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:s}}function Cve(t){return t.l+=2,[t.read_shift(4)]}function Sve(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function xve(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bve(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function _ve(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Eve(t){return t.l+=4,[0,0]}var HB={1:{n:"PtgExp",f:U0e},2:{n:"PtgTbl",f:lve},3:{n:"PtgAdd",f:xn},4:{n:"PtgSub",f:xn},5:{n:"PtgMul",f:xn},6:{n:"PtgDiv",f:xn},7:{n:"PtgPower",f:xn},8:{n:"PtgConcat",f:xn},9:{n:"PtgLt",f:xn},10:{n:"PtgLe",f:xn},11:{n:"PtgEq",f:xn},12:{n:"PtgGe",f:xn},13:{n:"PtgGt",f:xn},14:{n:"PtgNe",f:xn},15:{n:"PtgIsect",f:xn},16:{n:"PtgUnion",f:xn},17:{n:"PtgRange",f:xn},18:{n:"PtgUplus",f:xn},19:{n:"PtgUminus",f:xn},20:{n:"PtgPercent",f:xn},21:{n:"PtgParen",f:xn},22:{n:"PtgMissArg",f:xn},23:{n:"PtgStr",f:X0e},26:{n:"PtgSheet",f:Sve},27:{n:"PtgEndSheet",f:xve},28:{n:"PtgErr",f:z0e},29:{n:"PtgBool",f:Y0e},30:{n:"PtgInt",f:G0e},31:{n:"PtgNum",f:K0e},32:{n:"PtgArray",f:P0e},33:{n:"PtgFunc",f:B0e},34:{n:"PtgFuncVar",f:V0e},35:{n:"PtgName",f:Z0e},36:{n:"PtgRef",f:H0e},37:{n:"PtgArea",f:_0e},38:{n:"PtgMemArea",f:rve},39:{n:"PtgMemErr",f:ove},40:{n:"PtgMemNoMem",f:ave},41:{n:"PtgMemFunc",f:nve},42:{n:"PtgRefErr",f:ive},43:{n:"PtgAreaErr",f:R0e},44:{n:"PtgRefN",f:L0e},45:{n:"PtgAreaN",f:k0e},46:{n:"PtgMemAreaN",f:bve},47:{n:"PtgMemNoMemN",f:_ve},57:{n:"PtgNameX",f:eve},58:{n:"PtgRef3d",f:$0e},59:{n:"PtgArea3d",f:E0e},60:{n:"PtgRefErr3d",f:sve},61:{n:"PtgAreaErr3d",f:T0e},255:{}},Rve={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Tve={1:{n:"PtgElfLel",f:aY},2:{n:"PtgElfRw",f:pve},3:{n:"PtgElfCol",f:cve},6:{n:"PtgElfRwV",f:vve},7:{n:"PtgElfColV",f:fve},10:{n:"PtgElfRadical",f:dve},11:{n:"PtgElfRadicalS",f:mve},13:{n:"PtgElfColS",f:uve},15:{n:"PtgElfColSV",f:hve},16:{n:"PtgElfRadicalLel",f:gve},25:{n:"PtgList",f:yve},29:{n:"PtgSxName",f:Cve},255:{}},kve={0:{n:"PtgAttrNoop",f:Eve},1:{n:"PtgAttrSemi",f:N0e},2:{n:"PtgAttrIf",f:O0e},4:{n:"PtgAttrChoose",f:A0e},8:{n:"PtgAttrGoto",f:I0e},16:{n:"PtgAttrSum",f:j0e},32:{n:"PtgAttrBaxcel",f:FB},33:{n:"PtgAttrBaxcel",f:FB},64:{n:"PtgAttrSpace",f:D0e},65:{n:"PtgAttrSpaceSemi",f:F0e},128:{n:"PtgAttrIfError",f:M0e},255:{}};function i1(t,e,r,n){if(n.biff<8)return Di(t,e);for(var i=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Q0e(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=J0e(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&s.push(Di(t,e)),s}function s1(t,e,r){for(var n=t.l+e,i,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],i=HB[s]||HB[Rve[s]],(s===24||s===25)&&(i=(s===24?Tve:kve)[t[t.l+1]]),!i||!i.f?Di(t,e):o.push([i.n,i.f(t,e,r)]);return o}function Pve(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Ave={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ive(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function lY(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function LB(t,e,r){var n=lY(t,e,r);return n=="#REF"?n:Ive(n,r)}function _i(t,e,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,h=0,f=0,d,g="";if(!t[0]||!t[0][0])return"";for(var m=-1,p="",w=0,v=t[0].length;w<v;++w){var y=t[0][w];switch(y[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),m>=0){switch(t[0][m][1][0]){case 0:p=nn(" ",t[0][m][1][1]);break;case 1:p=nn("\r",t[0][m][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}c=c+p,m=-1}a.push(c+Ave[y[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Kv(y[1][1],o,i),a.push(Xv(u,s));break;case"PtgRefN":u=r?Kv(y[1][1],r,i):y[1][1],a.push(Xv(u,s));break;case"PtgRef3d":h=y[1][1],u=Kv(y[1][2],o,i),g=LB(n,h,i),a.push(g+"!"+Xv(u,s));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],T=y[1][1];b||(b=0),b&=127;var E=b==0?[]:a.slice(-b);a.length-=b,T==="User"&&(T=E.shift()),a.push(T+"("+E.join(",")+")");break;case"PtgBool":a.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(y[1]);break;case"PtgNum":a.push(String(y[1]));break;case"PtgStr":a.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(y[1]);break;case"PtgAreaN":d=dB(y[1][1],r?{s:r}:o,i),a.push(ok(d,i));break;case"PtgArea":d=dB(y[1][1],o,i),a.push(ok(d,i));break;case"PtgArea3d":h=y[1][1],d=y[1][2],g=LB(n,h,i),a.push(g+"!"+ok(d,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var x=(n.names||[])[f-1]||(n[0]||[])[f],P=x?x.Name:"SH33TJSNAME"+String(f);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),a.push(P);break;case"PtgNameX":var A=y[1][1];f=y[1][2];var O;if(i.biff<=5)A<0&&(A=-A),n[A]&&(O=n[A][f]);else{var Y="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][f]&&n[A][f].itab>0&&(Y=n.SheetNames[n[A][f].itab-1]+"!"):Y=n.SheetNames[f-1]+"!"),n[A]&&n[A][f])Y+=n[A][f].Name;else if(n[0]&&n[0][f])Y+=n[0][f].Name;else{var B=(lY(n,A,i)||"").split(";;");B[f-1]?Y=B[f-1]:Y+="SH33TJSERRX"}a.push(Y);break}O||(O={Name:"SH33TJSERRY"}),a.push(O.Name);break;case"PtgParen":var ie="(",ue=")";if(m>=0){switch(p="",t[0][m][1][0]){case 2:ie=nn(" ",t[0][m][1][1])+ie;break;case 3:ie=nn("\r",t[0][m][1][1])+ie;break;case 4:ue=nn(" ",t[0][m][1][1])+ue;break;case 5:ue=nn("\r",t[0][m][1][1])+ue;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}a.push(ie+a.pop()+ue);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[it(u)]){var Ee=n.sharedf[it(u)];a.push(_i(Ee,o,he,n,i))}else{var Ce=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(_i(c[1],o,he,n,i)),Ce=!0;break}Ce||a.push(y[1])}break;case"PtgArray":a.push("{"+Pve(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&ge.indexOf(t[0][w][0])==-1){y=t[0][m];var Q=!0;switch(y[1][0]){case 4:Q=!1;case 0:p=nn(" ",y[1][1]);break;case 5:Q=!1;case 1:p=nn("\r",y[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}a.push((Q?p:"")+a.pop()+(Q?"":p)),m=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function Ove(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],Di(t,e-2)];var a=s1(t,o,r);return e!==o+i&&(s=i1(t,e-o-i,a,r)),t.l=n,[a,s]}function Mve(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,o=t.read_shift(i);if(o==65535)return[[],Di(t,e-2)];var a=s1(t,o,r);return e!==o+i&&(s=i1(t,e-o-i,a,r)),t.l=n,[a,s]}function Nve(t,e,r,n){var i=t.l+e,s=s1(t,n,r),o;return i!==t.l&&(o=i1(t,i-t.l,s,r)),[s,o]}function Dve(t,e,r){var n=t.l+e,i,s=t.read_shift(2),o=s1(t,s,r);return s==65535?[[],Di(t,e-2)]:(e!==s+2&&(i=i1(t,n-s-2,o,r)),[o,i])}function Fve(t){var e;if(Ec(t,t.l+6)!==65535)return[Pi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Hve(t){if(t==null){var e=ve(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Td(t);return Td(0)}function hk(t,e,r){var n=t.l+e,i=Vl(t);r.biff==2&&++t.l;var s=Fve(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var a=Mve(t,n-t.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function Lve(t,e,r,n,i){var s=Pd(e,r,i),o=Hve(t.v),a=ve(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=ve(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var h=Jn([s,o,a,c]);return h}function aR(t,e,r){var n=t.read_shift(4),i=s1(t,n,r),s=t.read_shift(4),o=s>0?i1(t,s,i,r):null;return[i,o]}var $ve=aR,lR=aR,Bve=aR,Vve=aR,Wve={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},cY={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jve={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $B(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Uve(t){var e="of:="+t.replace(yD,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function fk(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function zve(t){return t.replace(/\./,"!")}var Jv={},Km={},Qv=typeof Map<"u";function xD(t,e,r){var n=0,i=t.length;if(r){if(Qv?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Qv?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Qv?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function cR(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ri=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=ay(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=o_(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function hd(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function $h(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Nl(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function uY(t,e,r,n,i,s){try{n.cellNF&&(t.z=nt[e])}catch(a){if(n.WTF)throw a}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Pr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(nt[e]==null&&Nl(Vhe[e]||"General",e),t.t==="e")t.w=t.w||iu[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ey(t.v);else if(t.t==="d"){var o=jn(t.v);(o|0)===o?t.w=o.toString(10):t.w=ey(o)}else{if(t.v===void 0)return"";t.w=Ed(t.v,Km)}else t.t==="d"?t.w=lo(e,jn(t.v),Km):t.w=lo(e,t.v,Km)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=s_(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=s_(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}function Gve(t,e,r){if(t&&t["!ref"]){var n=Ot(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Yve(t,e){var r=Ot(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=gt(r))}var Kve=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Xve=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,qve=/<(?:\w:)?hyperlink [^>]*>/mg,Jve=/"(\w*:\w*)"/,Qve=/<(?:\w:)?col\b[^>]*[\/]?>/g,Zve=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ewe=/<(?:\w:)?pageMargins[^>]*\/>/g,hY=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,twe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rwe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function nwe(t,e,r,n,i,s,o){if(!t)return t;n||(n={"!id":{}});var a=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(Xve);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var f=c.match(hY);f?bD(f[0],a,i,r):(f=c.match(twe))&&swe(f[0],f[1]||"",a,i,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var g=c.slice(d,d+50).match(Jve);g&&Yve(a,g[1])}var m=c.match(rwe);m&&m[1]&&wwe(m[1],i);var p=[];if(e.cellStyles){var w=c.match(Qve);w&&dwe(p,w)}h&&Swe(h[1],a,e,l,s,o);var v=u.match(Zve);v&&(a["!autofilter"]=mwe(v[0]));var y=[],b=u.match(Kve);if(b)for(d=0;d!=b.length;++d)y[d]=Ot(b[d].slice(b[d].indexOf('"')+1));var T=u.match(qve);T&&uwe(a,T,n);var E=u.match(ewe);if(E&&(a["!margins"]=hwe(st(E[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=gt(l)),e.sheetRows>0&&a["!ref"]){var x=Ot(a["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),a["!fullref"]=a["!ref"],a["!ref"]=gt(x))}return p.length>0&&(a["!cols"]=p),y.length>0&&(a["!merges"]=y),a}function iwe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+gt(t[r])+'"/>';return e+"</mergeCells>"}function bD(t,e,r,n){var i=st(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ut(fr(i.codeName)))}function swe(t,e,r,n,i){bD(t.slice(0,t.indexOf(">")),r,n,i)}function owe(t,e,r,n,i){var s=!1,o={},a=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,o.codeName=Al(lr(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),a=(a||"")+Ie("outlinePr",null,c)}!s&&!a||(i[i.length]=Ie("sheetPr",a,o))}var awe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],lwe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function cwe(t){var e={sheet:1};return awe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),lwe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=pD(t.password).toString(16).toUpperCase()),Ie("sheetProtection",null,e)}function uwe(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=st(fr(e[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Ut(s.location))):(s.Target="#"+Ut(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=Ot(s.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=it({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=s)}}}function hwe(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function fwe(t){return hd(t),Ie("pageMargins",null,t)}function dwe(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=st(e[n],!0);i.hidden&&(i.hidden=Rr(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,vD(i.width)),kh(i);s<=o;)t[s++]=vr(i)}}function gwe(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ie("col",null,cR(i,n)));return r[r.length]="</cols>",r.join("")}function mwe(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function pwe(t,e,r,n){var i=typeof t.ref=="string"?t.ref:gt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=es(i);o.s.r==o.e.r&&(o.e.r=es(e["!ref"]).e.r,i=gt(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ie("autoFilter",null,{ref:i})}var vwe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function wwe(t,e){e.Views||(e.Views=[{}]),(t.match(vwe)||[]).forEach(function(r,n){var i=st(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Rr(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function ywe(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ie("sheetViews",Ie("sheetView",null,i),{})}function Cwe(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=iu[t.v];break;case"d":n&&n.cellDates?i=Pr(t.v,-1).toISOString():(t=vr(t),t.t="n",i=""+(t.v=jn(Pr(t.v)))),typeof t.z>"u"&&(t.z=nt[14]);break;default:i=t.v;break}var a=ci("v",lr(i)),l={r:e},c=$h(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=ci("v",""+xD(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=Ie("f",lr(t.f),u)+(t.v!=null?a:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Ie("c",a,l)}var Swe=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=ty("v"),o=ty("f");return function(l,c,u,h,f,d){for(var g=0,m="",p=[],w=[],v=0,y=0,b=0,T="",E,x,P=0,A=0,O,Y,B=0,ie=0,ue=Array.isArray(d.CellXf),he,Ee=[],Ce=[],ge=Array.isArray(c),Q=[],ye={},Re=!1,j=!!u.sheetStubs,C=l.split(e),S=0,_=C.length;S!=_;++S){m=C[S].trim();var D=m.length;if(D!==0){var U=0;e:for(g=0;g<D;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(x=st(m.slice(U,g),!0),P=x.r!=null?parseInt(x.r,10):P+1,A=-1,u.sheetRows&&u.sheetRows<P)continue;ye={},Re=!1,x.ht&&(Re=!0,ye.hpt=parseFloat(x.ht),ye.hpx=vp(ye.hpt)),x.hidden=="1"&&(Re=!0,ye.hidden=!0),x.outlineLevel!=null&&(Re=!0,ye.level=+x.outlineLevel),Re&&(Q[P-1]=ye)}break;case"<":U=g;break}if(U>=g)break;if(x=st(m.slice(U,g),!0),P=x.r!=null?parseInt(x.r,10):P+1,A=-1,!(u.sheetRows&&u.sheetRows<P)){h.s.r>P-1&&(h.s.r=P-1),h.e.r<P-1&&(h.e.r=P-1),u&&u.cellStyles&&(ye={},Re=!1,x.ht&&(Re=!0,ye.hpt=parseFloat(x.ht),ye.hpx=vp(ye.hpt)),x.hidden=="1"&&(Re=!0,ye.hidden=!0),x.outlineLevel!=null&&(Re=!0,ye.level=+x.outlineLevel),Re&&(Q[P-1]=ye)),p=m.slice(g).split(t);for(var X=0;X!=p.length&&p[X].trim().charAt(0)=="<";++X);for(p=p.slice(X),g=0;g!=p.length;++g)if(m=p[g].trim(),m.length!==0){if(w=m.match(r),v=g,y=0,b=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,w!=null&&w.length===2){for(v=0,T=w[1],y=0;y!=T.length&&!((b=T.charCodeAt(y)-64)<1||b>26);++y)v=26*v+b;--v,A=v}else++A;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,x=st(m.slice(0,y),!0),x.r||(x.r=it({r:P-1,c:A})),T=m.slice(y),E={t:""},(w=T.match(s))!=null&&w[1]!==""&&(E.v=Ut(w[1])),u.cellFormula){if((w=T.match(o))!=null&&w[1]!==""){if(E.f=Ut(fr(w[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=DB(E.f)),w[0].indexOf('t="array"')>-1)E.F=(T.match(i)||[])[1],E.F.indexOf(":")>-1&&Ee.push([Ot(E.F),E.F]);else if(w[0].indexOf('t="shared"')>-1){Y=st(w[0]);var ee=Ut(fr(w[1]));u.xlfn||(ee=DB(ee)),Ce[parseInt(Y.si,10)]=[Y,ee,x.r]}}else(w=T.match(/<f[^>]*\/>/))&&(Y=st(w[0]),Ce[Y.si]&&(E.f=v0e(Ce[Y.si][1],Ce[Y.si][2],x.r)));var k=zr(x.r);for(y=0;y<Ee.length;++y)k.r>=Ee[y][0].s.r&&k.r<=Ee[y][0].e.r&&k.c>=Ee[y][0].s.c&&k.c<=Ee[y][0].e.c&&(E.F=Ee[y][1])}if(x.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(j)E.t="z";else continue;else E.t=x.t||"n";switch(h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),E.t){case"n":if(E.v==""||E.v==null){if(!j)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!j)continue;E.t="z"}else O=Jv[parseInt(E.v,10)],E.v=O.t,E.r=O.r,u.cellHTML&&(E.h=O.h);break;case"str":E.t="s",E.v=E.v!=null?fr(E.v):"",u.cellHTML&&(E.h=JN(E.v));break;case"inlineStr":w=T.match(n),E.t="s",w!=null&&(O=mD(w[1]))?(E.v=O.t,u.cellHTML&&(E.h=O.h)):E.v="";break;case"b":E.v=Rr(E.v);break;case"d":u.cellDates?E.v=Pr(E.v,1):(E.v=jn(Pr(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=dG[E.v];break}if(B=ie=0,he=null,ue&&x.s!==void 0&&(he=d.CellXf[x.s],he!=null&&(he.numFmtId!=null&&(B=he.numFmtId),u.cellStyles&&he.fillId!=null&&(ie=he.fillId))),uY(E,B,ie,u,f,d),u.cellDates&&ue&&E.t=="n"&&zd(nt[B])&&(E.t="d",E.v=iR(E.v)),x.cm&&u.xlmeta){var M=(u.xlmeta.Cell||[])[+x.cm-1];M&&M.type=="XLDAPR"&&(E.D=!0)}if(ge){var R=zr(x.r);c[R.r]||(c[R.r]=[]),c[R.r][R.c]=E}else c[x.r]=E}}}}Q.length>0&&(c["!rows"]=Q)}}();function xwe(t,e,r,n){var i=[],s=[],o=Ot(t["!ref"]),a="",l,c="",u=[],h=0,f=0,d=t["!rows"],g=Array.isArray(t),m={r:c},p,w=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=kr(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],c=sn(h),f=o.s.c;f<=o.e.c;++f){l=u[f]+c;var v=g?(t[h]||[])[f]:t[l];v!==void 0&&(a=Cwe(v,l,t,e))!=null&&s.push(a)}(s.length>0||d&&d[h])&&(m={r:c},d&&d[h]&&(p=d[h],p.hidden&&(m.hidden=1),w=-1,p.hpx?w=ly(p.hpx):p.hpt&&(w=p.hpt),w>-1&&(m.ht=w,m.customHeight=1),p.level&&(m.outlineLevel=p.level)),i[i.length]=Ie("row",s.join(""),m))}if(d)for(;h<d.length;++h)d&&d[h]&&(m={r:h+1},p=d[h],p.hidden&&(m.hidden=1),w=-1,p.hpx?w=ly(p.hpx):p.hpt&&(w=p.hpt),w>-1&&(m.ht=w,m.customHeight=1),p.level&&(m.outlineLevel=p.level),i[i.length]=Ie("row","",m));return i.join("")}function fY(t,e,r,n){var i=[pn,Ie("worksheet",null,{xmlns:Gd[0],"xmlns:r":Bn.r})],s=r.SheetNames[t],o=0,a="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Ot(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=gt(u)}n||(n={}),l["!comments"]=[];var h=[];owe(l,r,t,e,i),i[i.length]=Ie("dimension",null,{ref:c}),i[i.length]=ywe(l,e,t,r),e.sheetFormat&&(i[i.length]=Ie("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=gwe(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=xwe(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=cwe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=pwe(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=iwe(l["!merges"]));var f=-1,d,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(d={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=ar(n,-1,lr(m[1].Target).replace(/#.*$/,""),Et.HLINK),d["r:id"]="rId"+g),(f=m[1].Target.indexOf("#"))>-1&&(d.location=lr(m[1].Target.slice(f+1))),m[1].Tooltip&&(d.tooltip=lr(m[1].Tooltip)),i[i.length]=Ie("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=fwe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=ci("ignoredErrors",Ie("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=ar(n,-1,"../drawings/drawing"+(t+1)+".xml",Et.DRAW),i[i.length]=Ie("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=ar(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Et.VML),i[i.length]=Ie("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function bwe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function _we(t,e,r){var n=ve(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=ly(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,f=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[it(c)];g&&(h<0&&(h=d),f=d)}h<0||(++a,n.write_shift(4,h),n.write_shift(4,f))}var m=n.l;return n.l=l,n.write_shift(4,a),n.l=m,n.length>n.l?n.slice(0,n.l):n}function Ewe(t,e,r,n){var i=_we(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&xe(t,0,i)}var Rwe=qd,Twe=$p;function kwe(){}function Pwe(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Ofe(t),r}function Awe(t,e,r){r==null&&(r=ve(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return r_({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),lG(t,r),r.slice(0,r.l)}function Iwe(t){var e=Yo(t);return[e]}function Owe(t,e,r){return r==null&&(r=ve(8)),Yd(e,r)}function Mwe(t){var e=Kd(t);return[e]}function Nwe(t,e,r){return r==null&&(r=ve(4)),Xd(e,r)}function Dwe(t){var e=Yo(t),r=t.read_shift(1);return[e,r,"b"]}function Fwe(t,e,r){return r==null&&(r=ve(9)),Yd(e,r),r.write_shift(1,t.v?1:0),r}function Hwe(t){var e=Kd(t),r=t.read_shift(1);return[e,r,"b"]}function Lwe(t,e,r){return r==null&&(r=ve(5)),Xd(e,r),r.write_shift(1,t.v?1:0),r}function $we(t){var e=Yo(t),r=t.read_shift(1);return[e,r,"e"]}function Bwe(t,e,r){return r==null&&(r=ve(9)),Yd(e,r),r.write_shift(1,t.v),r}function Vwe(t){var e=Kd(t),r=t.read_shift(1);return[e,r,"e"]}function Wwe(t,e,r){return r==null&&(r=ve(8)),Xd(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function jwe(t){var e=Yo(t),r=t.read_shift(4);return[e,r,"s"]}function Uwe(t,e,r){return r==null&&(r=ve(12)),Yd(e,r),r.write_shift(4,e.v),r}function zwe(t){var e=Kd(t),r=t.read_shift(4);return[e,r,"s"]}function Gwe(t,e,r){return r==null&&(r=ve(8)),Xd(e,r),r.write_shift(4,e.v),r}function Ywe(t){var e=Yo(t),r=Pi(t);return[e,r,"n"]}function Kwe(t,e,r){return r==null&&(r=ve(16)),Yd(e,r),Td(t.v,r),r}function dY(t){var e=Kd(t),r=Pi(t);return[e,r,"n"]}function Xwe(t,e,r){return r==null&&(r=ve(12)),Xd(e,r),Td(t.v,r),r}function qwe(t){var e=Yo(t),r=uD(t);return[e,r,"n"]}function Jwe(t,e,r){return r==null&&(r=ve(12)),Yd(e,r),cG(t.v,r),r}function Qwe(t){var e=Kd(t),r=uD(t);return[e,r,"n"]}function Zwe(t,e,r){return r==null&&(r=ve(8)),Xd(e,r),cG(t.v,r),r}function eye(t){var e=Yo(t),r=aD(t);return[e,r,"is"]}function tye(t){var e=Yo(t),r=Oi(t);return[e,r,"str"]}function rye(t,e,r){return r==null&&(r=ve(12+4*t.v.length)),Yd(e,r),Qn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function nye(t){var e=Kd(t),r=Oi(t);return[e,r,"str"]}function iye(t,e,r){return r==null&&(r=ve(8+4*t.v.length)),Xd(e,r),Qn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function sye(t,e,r){var n=t.l+e,i=Yo(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(r.cellFormula){t.l+=2;var a=lR(t,n-t.l,r);o[3]=_i(a,null,i,r.supbooks,r)}else t.l=n;return o}function oye(t,e,r){var n=t.l+e,i=Yo(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(r.cellFormula){t.l+=2;var a=lR(t,n-t.l,r);o[3]=_i(a,null,i,r.supbooks,r)}else t.l=n;return o}function aye(t,e,r){var n=t.l+e,i=Yo(t);i.r=r["!row"];var s=Pi(t),o=[i,s,"n"];if(r.cellFormula){t.l+=2;var a=lR(t,n-t.l,r);o[3]=_i(a,null,i,r.supbooks,r)}else t.l=n;return o}function lye(t,e,r){var n=t.l+e,i=Yo(t);i.r=r["!row"];var s=Oi(t),o=[i,s,"str"];if(r.cellFormula){t.l+=2;var a=lR(t,n-t.l,r);o[3]=_i(a,null,i,r.supbooks,r)}else t.l=n;return o}var cye=qd,uye=$p;function hye(t,e){return e==null&&(e=ve(4)),e.write_shift(4,t),e}function fye(t,e){var r=t.l+e,n=qd(t),i=lD(t),s=Oi(t),o=Oi(t),a=Oi(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function dye(t,e){var r=ve(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));$p({s:zr(t[0]),e:zr(t[0])},r),cD("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Qn(i||"",r),Qn(t[1].Tooltip||"",r),Qn("",r),r.slice(0,r.l)}function gye(){}function mye(t,e,r){var n=t.l+e,i=uG(t),s=t.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=$ve(t,n-t.l,r);o[1]=a}else t.l=n;return o}function pye(t,e,r){var n=t.l+e,i=qd(t),s=[i];if(r.cellFormula){var o=Vve(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function vye(t,e,r){r==null&&(r=ve(18));var n=cR(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var gY=["left","right","top","bottom","header","footer"];function wye(t){var e={};return gY.forEach(function(r){e[r]=Pi(t)}),e}function yye(t,e){return e==null&&(e=ve(6*8)),hd(t),gY.forEach(function(r){Td(t[r],e)}),e}function Cye(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Sye(t,e,r){r==null&&(r=ve(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function xye(t){var e=ve(24);return e.write_shift(4,4),e.write_shift(4,1),$p(t,e),e}function bye(t,e){return e==null&&(e=ve(16*4+2)),e.write_shift(2,t.password?pD(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function _ye(){}function Eye(){}function Rye(t,e,r,n,i,s,o){if(!t)return t;var a=e||{};n||(n={"!id":{}});var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,d,g,m,p,w,v,y,b,T,E=[];a.biff=12,a["!row"]=0;var x=0,P=!1,A=[],O={},Y=a.supbooks||i.supbooks||[[]];if(Y.sharedf=O,Y.arrayf=A,Y.SheetNames=i.SheetNames||i.Sheets.map(function(ge){return ge.name}),!a.supbooks&&(a.supbooks=Y,i.Names))for(var B=0;B<i.Names.length;++B)Y[0][B+1]=i.Names[B];var ie=[],ue=[],he=!1;cy[16]={n:"BrtShortReal",f:dY};var Ee;if(nu(t,function(Q,ye,Re){if(!f)switch(Re){case 148:c=Q;break;case 0:d=Q,a.sheetRows&&a.sheetRows<=d.r&&(f=!0),b=sn(p=d.r),a["!row"]=d.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=vp(Q.hpt)),ue[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:Q[2]},Q[2]){case"n":g.v=Q[1];break;case"s":y=Jv[Q[1]],g.v=y.t,g.r=y.r;break;case"b":g.v=!!Q[1];break;case"e":g.v=Q[1],a.cellText!==!1&&(g.w=iu[g.v]);break;case"str":g.t="s",g.v=Q[1];break;case"is":g.t="s",g.v=Q[1].t;break}if((m=o.CellXf[Q[0].iStyleRef])&&uY(g,m.numFmtId,null,a,s,o),w=Q[0].c==-1?w+1:Q[0].c,a.dense?(l[p]||(l[p]=[]),l[p][w]=g):l[kr(w)+b]=g,a.cellFormula){for(P=!1,x=0;x<A.length;++x){var j=A[x];d.r>=j[0].s.r&&d.r<=j[0].e.r&&w>=j[0].s.c&&w<=j[0].e.c&&(g.F=gt(j[0]),P=!0)}!P&&Q.length>3&&(g.f=Q[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>w&&(u.s.c=w),u.e.r<d.r&&(u.e.r=d.r),u.e.c<w&&(u.e.c=w),a.cellDates&&m&&g.t=="n"&&zd(nt[m.numFmtId])){var C=Qu(g.v);C&&(g.t="d",g.v=new Date(C.y,C.m-1,C.d,C.H,C.M,C.S,C.u))}Ee&&(Ee.type=="XLDAPR"&&(g.D=!0),Ee=void 0);break;case 1:case 12:if(!a.sheetStubs||h)break;g={t:"z",v:void 0},w=Q[0].c==-1?w+1:Q[0].c,a.dense?(l[p]||(l[p]=[]),l[p][w]=g):l[kr(w)+b]=g,u.s.r>d.r&&(u.s.r=d.r),u.s.c>w&&(u.s.c=w),u.e.r<d.r&&(u.e.r=d.r),u.e.c<w&&(u.e.c=w),Ee&&(Ee.type=="XLDAPR"&&(g.D=!0),Ee=void 0);break;case 176:E.push(Q);break;case 49:Ee=((a.xlmeta||{}).Cell||[])[Q-1];break;case 494:var S=n["!id"][Q.relId];for(S?(Q.Target=S.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=S):Q.relId==""&&(Q.Target="#"+Q.loc),p=Q.rfx.s.r;p<=Q.rfx.e.r;++p)for(w=Q.rfx.s.c;w<=Q.rfx.e.c;++w)a.dense?(l[p]||(l[p]=[]),l[p][w]||(l[p][w]={t:"z",v:void 0}),l[p][w].l=Q):(v=it({c:w,r:p}),l[v]||(l[v]={t:"z",v:void 0}),l[v].l=Q);break;case 426:if(!a.cellFormula)break;A.push(Q),T=a.dense?l[p][w]:l[kr(w)+b],T.f=_i(Q[1],u,{r:d.r,c:w},Y,a),T.F=gt(Q[0]);break;case 427:if(!a.cellFormula)break;O[it(Q[0].s)]=Q[1],T=a.dense?l[p][w]:l[kr(w)+b],T.f=_i(Q[1],u,{r:d.r,c:w},Y,a);break;case 60:if(!a.cellStyles)break;for(;Q.e>=Q.s;)ie[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},he||(he=!0,vD(Q.w/256)),kh(ie[Q.e+1]);break;case 161:l["!autofilter"]={ref:gt(Q)};break;case 476:l["!margins"]=Q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Q.name&&(i.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(l["!outline"]={above:Q.above,left:Q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ye.T){if(!h||a.WTF)throw new Error("Unexpected record 0x"+Re.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=gt(c||u)),a.sheetRows&&l["!ref"]){var Ce=Ot(l["!ref"]);a.sheetRows<=+Ce.e.r&&(Ce.e.r=a.sheetRows-1,Ce.e.r>u.e.r&&(Ce.e.r=u.e.r),Ce.e.r<Ce.s.r&&(Ce.s.r=Ce.e.r),Ce.e.c>u.e.c&&(Ce.e.c=u.e.c),Ce.e.c<Ce.s.c&&(Ce.s.c=Ce.e.c),l["!fullref"]=l["!ref"],l["!ref"]=gt(Ce))}return E.length>0&&(l["!merges"]=E),ie.length>0&&(l["!cols"]=ie),ue.length>0&&(l["!rows"]=ue),l}function Tye(t,e,r,n,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=vr(e),e.z=e.z||nt[14],e.v=jn(Pr(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r,c:n};switch(l.s=$h(i.cellXfs,e,i),e.l&&s["!links"].push([it(l),e.l]),e.c&&s["!comments"].push([it(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=xD(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?xe(t,18,Gwe(e,l)):xe(t,7,Uwe(e,l))):(l.t="str",o?xe(t,17,iye(e,l)):xe(t,6,rye(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?xe(t,13,Zwe(e,l)):xe(t,2,Jwe(e,l)):o?xe(t,16,Xwe(e,l)):xe(t,5,Kwe(e,l)),!0;case"b":return l.t="b",o?xe(t,15,Lwe(e,l)):xe(t,4,Fwe(e,l)),!0;case"e":return l.t="e",o?xe(t,14,Wwe(e,l)):xe(t,3,Bwe(e,l)),!0}return o?xe(t,12,Nwe(e,l)):xe(t,1,Owe(e,l)),!0}function kye(t,e,r,n){var i=Ot(e["!ref"]||"A1"),s,o="",a=[];xe(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=sn(u),Ewe(t,e,i,u);var h=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(a[f]=kr(f)),s=a[f]+o;var d=l?(e[u]||[])[f]:e[s];if(!d){h=!1;continue}h=Tye(t,d,u,f,n,e,h)}}xe(t,146)}function Pye(t,e){!e||!e["!merges"]||(xe(t,177,hye(e["!merges"].length)),e["!merges"].forEach(function(r){xe(t,176,uye(r))}),xe(t,178))}function Aye(t,e){!e||!e["!cols"]||(xe(t,390),e["!cols"].forEach(function(r,n){r&&xe(t,60,vye(n,r))}),xe(t,391))}function Iye(t,e){!e||!e["!ref"]||(xe(t,648),xe(t,649,xye(Ot(e["!ref"]))),xe(t,650))}function Oye(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=ar(r,-1,n[1].Target.replace(/#.*$/,""),Et.HLINK);xe(t,494,dye(n,i))}}),delete e["!links"]}function Mye(t,e,r,n){if(e["!comments"].length>0){var i=ar(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Et.VML);xe(t,551,cD("rId"+i)),e["!legacy"]=i}}function Nye(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:gt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=es(s);a.s.r==a.e.r&&(a.e.r=es(e["!ref"]).e.r,s=gt(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),xe(t,161,$p(Ot(s))),xe(t,162)}}function Dye(t,e,r){xe(t,133),xe(t,137,Sye(e,r)),xe(t,138),xe(t,134)}function Fye(t,e){e["!protect"]&&xe(t,535,bye(e["!protect"]))}function Hye(t,e,r,n){var i=Is(),s=r.SheetNames[t],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[t].CodeName||a)}catch{}var l=Ot(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],xe(i,129),(r.vbaraw||o["!outline"])&&xe(i,147,Awe(a,o["!outline"])),xe(i,148,Twe(l)),Dye(i,o,r.Workbook),Aye(i,o),kye(i,o,t,e),Fye(i,o),Nye(i,o,r,t),Pye(i,o),Oye(i,o,n),o["!margins"]&&xe(i,476,yye(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Iye(i,o),Mye(i,o,t,n),xe(i,130),i.end()}function Lye(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=Ut((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function $ye(t,e,r,n,i,s){var o=s||{"!type":"chart"};if(!t)return s;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=Lye(h);u.s.r=u.s.c=0,u.e.c=a,c=kr(a),f[0].forEach(function(d,g){o[c+sn(g)]={t:"n",v:d,z:f[1]},l=g}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(o["!ref"]=gt(u)),o}function Bye(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=t.match(hY);return a&&bD(a[0],s,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Vye(t,e){t.l+=10;var r=Oi(t);return{name:r}}function Wye(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return nu(t,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var _D=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jye=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Uye=[],zye=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function BB(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Rr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function VB(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Rr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function mY(t){VB(t.WBProps,_D),VB(t.CalcPr,zye),BB(t.WBView,jye),BB(t.Sheets,Uye),Km.date1904=Rr(t.WBProps.date1904)}function Gye(t){return!t.Workbook||!t.Workbook.WBProps?"false":Rr(t.Workbook.WBProps.date1904)?"true":"false"}var Yye="][*?/\\".split("");function pY(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Yye.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Kye(t,e,r){t.forEach(function(n,i){pY(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function vY(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Kye(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Gve(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var Xye=/<\w+:workbook/;function qye(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(t.replace(Fi,function(l,c){var u=st(l);switch(Bl(u[0])){case"<?xml":break;case"<workbook":l.match(Xye)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":_D.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Rr(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=fr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ut(fr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=fr(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Rr(u.hidden||"0")&&(s.Hidden=!0),o=c+l.length;break;case"</definedName>":s.Ref=Ut(fr(t.slice(o,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Gd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return mY(r),r}function wY(t){var e=[pn];e[e.length]=Ie("workbook",null,{xmlns:Gd[0],"xmlns:r":Bn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(_D.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ie("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:lr(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ie("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=Ie("definedName",lr(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Jye(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=KO(t),r.name=Oi(t),r}function Qye(t,e){return e||(e=ve(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),cD(t.strRelID,e),Qn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Zye(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Oi(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function e1e(t,e){e||(e=ve(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),lG(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function t1e(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function r1e(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=Mfe(t),o=Bve(t,0,r),a=lD(t);t.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function n1e(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],cy[16]={n:"BrtFRTArchID$",f:t1e},nu(t,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=_i(l.Ptg,null,null,o,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),mY(r),r.Names=s,r.supbooks=o,r}function i1e(t,e){xe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};xe(t,156,Qye(i))}xe(t,144)}function s1e(t,e){e||(e=ve(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Qn("SheetJS",e),Qn(Qw.version,e),Qn(Qw.version,e),Qn("7262",e),e.length>e.l?e.slice(0,e.l):e}function o1e(t,e){e||(e=ve(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function a1e(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(xe(t,135),xe(t,158,o1e(i)),xe(t,136))}}function l1e(t,e){var r=Is();return xe(r,131),xe(r,128,s1e()),xe(r,153,e1e(t.Workbook&&t.Workbook.WBProps||null)),a1e(r,t),i1e(r,t),xe(r,132),r.end()}function c1e(t,e,r){return e.slice(-4)===".bin"?n1e(t,r):qye(t,r)}function u1e(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?Rye(t,n,r,i,s,o,a):nwe(t,n,r,i,s,o,a)}function h1e(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?Wye(t,n,r,i,s):Bye(t,n,r,i,s)}function f1e(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?m0e():p0e()}function d1e(t,e,r,n,i,s,o,a){return e.slice(-4)===".bin"?d0e():g0e()}function g1e(t,e,r,n){return e.slice(-4)===".bin"?upe(t,r,n):Qme(t,r,n)}function m1e(t,e,r){return JG(t,r)}function p1e(t,e,r){return e.slice(-4)===".bin"?vme(t,r):gme(t,r)}function v1e(t,e,r){return e.slice(-4)===".bin"?l0e(t,r):Zpe(t,r)}function w1e(t,e,r){return e.slice(-4)===".bin"?qpe(t):Kpe(t)}function y1e(t,e,r,n){return r.slice(-4)===".bin"?Jpe(t,e,r,n):void 0}function C1e(t,e,r){return e.slice(-4)===".bin"?zpe(t,e,r):Ype(t,e,r)}function S1e(t,e,r){return(e.slice(-4)===".bin"?l1e:wY)(t)}function x1e(t,e,r,n,i){return(e.slice(-4)===".bin"?Hye:fY)(t,r,n,i)}function b1e(t,e,r){return(e.slice(-4)===".bin"?Cpe:XG)(t,r)}function _1e(t,e,r){return(e.slice(-4)===".bin"?Cme:VG)(t,r)}function E1e(t,e,r){return(e.slice(-4)===".bin"?c0e:eY)(t)}function R1e(t){return(t.slice(-4)===".bin"?Gpe:QG)()}var yY=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,CY=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function na(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(yY),s,o,a,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(CY),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),n[a]=s[2].slice(1,s[2].length-1));return n}function T1e(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(yY),i,s,o,a;if(n)for(a=0;a!=n.length;++a)i=n[a].match(CY),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Zv;function k1e(t,e){var r=Zv[t]||Ut(t);return r==="General"?Ed(e):lo(r,e)}function P1e(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Rr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Pr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Ut(e)]=i}function A1e(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||iu[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ey(t.v):t.w=Ed(t.v):t.w=k1e(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Zv[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&zd(n)){var i=Qu(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function I1e(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Ume[n.Pattern]||n.Pattern)}t[e.ID]=e}function O1e(t,e,r,n,i,s,o,a,l,c){var u="General",h=n.StyleID,f={};c=c||{};var d=[],g=0;for(h===void 0&&a&&(h=a.StyleID),h===void 0&&o&&(h=o.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Rr(t);break;case"String":n.t="s",n.r=iB(Ut(t)),n.v=t.indexOf("<")>-1?Ut(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Pr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ut(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=dG[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=iB(e||t));break}if(A1e(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=Ut(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Ym(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ym("RC:RC",i):n.ArrayRange&&(n.F=Ym(n.ArrayRange,i),l.push([Ot(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(d.forEach(function(p){!f.patternType&&p.patternType&&(f.patternType=p.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function M1e(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function dk(t,e){var r=e||{};Fp();var n=Pm(QN(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Lt<"u"?n=Lt.utils.decode(65001,Xb(n)):n=fr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=vr(r);return o.type="string",pp.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(te){i.indexOf("<"+te)>=0&&(s=!0)}),s)return mCe(n,r);Zv={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c,u={},h=[],f=r.dense?[]:{},d="",g={},m={},p=na('<Data ss:Type="String">'),w=0,v=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},E={},x="",P=0,A=[],O={},Y={},B=0,ie=[],ue=[],he={},Ee=[],Ce,ge=!1,Q=[],ye=[],Re={},j=0,C=0,S={Sheets:[],WBProps:{date1904:!1}},_={};ny.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var D="";a=ny.exec(n);)switch(a[3]=(D=a[3]).toLowerCase()){case"data":if(D=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?O1e(n.slice(w,a.index),x,p,l[l.length-1][0]=="comment"?he:g,{c:v,r:y},T,Ee[v],m,Q,r):(x="",p=na(a[0]),w=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(ue.length>0&&(g.c=ue),(!r.sheetRows||r.sheetRows>y)&&g.v!==void 0&&(r.dense?(f[y]||(f[y]=[]),f[y][v]=g):f[kr(v)+sn(y)]=g),g.HRef&&(g.l={Target:Ut(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(j=v+(parseInt(g.MergeAcross,10)|0),C=y+(parseInt(g.MergeDown,10)|0),A.push({s:{c:v,r:y},e:{c:j,r:C}})),!r.sheetStubs)g.MergeAcross?v=j+1:++v;else if(g.MergeAcross||g.MergeDown){for(var U=v;U<=j;++U)for(var X=y;X<=C;++X)(U>v||X>y)&&(r.dense?(f[X]||(f[X]=[]),f[X][U]={t:"z"}):f[kr(U)+sn(X)]={t:"z"});v=j+1}else++v;else g=T1e(a[0]),g.Index&&(v=+g.Index-1),v<b.s.c&&(b.s.c=v),v>b.e.c&&(b.e.c=v),a[0].slice(-2)==="/>"&&++v,ue=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),a[0].slice(-2)==="/>"&&(m=na(a[0]),m.Index&&(y=+m.Index-1)),v=0,++y):(m=na(a[0]),m.Index&&(y=+m.Index-1),Re={},(m.AutoFitHeight=="0"||m.Height)&&(Re.hpx=parseInt(m.Height,10),Re.hpt=ly(Re.hpx),ye[y]=Re),m.Hidden=="1"&&(Re.hidden=!0,ye[y]=Re));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(d),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(f["!ref"]=gt(b),r.sheetRows&&r.sheetRows<=b.e.r&&(f["!fullref"]=f["!ref"],b.e.r=r.sheetRows-1,f["!ref"]=gt(b))),A.length&&(f["!merges"]=A),Ee.length>0&&(f["!cols"]=Ee),ye.length>0&&(f["!rows"]=ye),u[d]=f}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,l.push([a[3],!1]),c=na(a[0]),d=Ut(c.Name),f=r.dense?[]:{},A=[],Q=[],ye=[],_={name:d,Hidden:0},S.Sheets.push(_);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),Ee=[],ge=!1}break;case"style":a[1]==="/"?I1e(T,E,r):E=na(a[0]);break;case"numberformat":E.nf=Ut(na(a[0]).Format||"General"),Zv[E.nf]&&(E.nf=Zv[E.nf]);for(var ee=0;ee!=392&&nt[ee]!=E.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(nt[ee]==null){Nl(E.nf,ee);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Ce=na(a[0]),Ce.Hidden&&(Ce.hidden=!0,delete Ce.Hidden),Ce.Width&&(Ce.wpx=parseInt(Ce.Width,10)),!ge&&Ce.wpx>10){ge=!0,Ri=YG;for(var k=0;k<Ee.length;++k)Ee[k]&&kh(Ee[k])}ge&&kh(Ce),Ee[Ce.Index-1||Ee.length]=Ce;for(var M=0;M<+Ce.Span;++M)Ee[Ee.length]=vr(Ce);break;case"namedrange":if(a[1]==="/")break;S.Names||(S.Names=[]);var R=st(a[0]),W={Name:R.Name,Ref:Ym(R.RefersTo.slice(1),{r:0,c:0})};S.Sheets.length>0&&(W.Sheet=S.Sheets.length-1),S.Names.push(W);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?x+=n.slice(P,a.index):P=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=na(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?ide(O,D,n.slice(B,a.index)):B=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));M1e(he),ue.push(he)}else l.push([a[3],!1]),c=na(a[0]),he={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var q=na(a[0]);f["!autofilter"]={ref:Ym(q.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return GB(n,r);var J=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(a[3]){case"date1904":S.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(B,a.index)){case"SheetHidden":_.Hidden=1;break;case"SheetVeryHidden":_.Hidden=2;break}else B=a.index+a[0].length;break;case"header":f["!margins"]||hd(f["!margins"]={},"xlml"),isNaN(+st(a[0]).Margin)||(f["!margins"].header=+st(a[0]).Margin);break;case"footer":f["!margins"]||hd(f["!margins"]={},"xlml"),isNaN(+st(a[0]).Margin)||(f["!margins"].footer=+st(a[0]).Margin);break;case"pagemargins":var re=st(a[0]);f["!margins"]||hd(f["!margins"]={},"xlml"),isNaN(+re.Top)||(f["!margins"].top=+re.Top),isNaN(+re.Left)||(f["!margins"].left=+re.Left),isNaN(+re.Right)||(f["!margins"].right=+re.Right),isNaN(+re.Bottom)||(f["!margins"].bottom=+re.Bottom);break;case"displayrighttoleft":S.Views||(S.Views=[]),S.Views[0]||(S.Views[0]={}),S.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?P1e(Y,D,ie,n.slice(B,a.index)):(ie=a,B=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var V={};return!r.bookSheets&&!r.bookProps&&(V.Sheets=u),V.SheetNames=h,V.Workbook=S,V.SSF=vr(nt),V.Props=O,V.Custprops=Y,V}function tM(t,e){switch(TD(e=e||{}),e.type||"base64"){case"base64":return dk(ao(t),e);case"binary":case"buffer":case"file":return dk(t,e);case"array":return dk(Hh(t),e)}}function N1e(t,e){var r=[];return t.Props&&r.push(sde(t.Props,e)),t.Custprops&&r.push(ode(t.Props,t.Custprops)),r.join("")}function D1e(){return""}function F1e(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Ie("NumberFormat",null,{"ss:Format":lr(nt[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Ie("Style",s.join(""),o))}),Ie("Styles",r.join(""))}function SY(t){return Ie("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+CD(t.Ref,{r:0,c:0})})}function H1e(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(SY(i)))}return Ie("Names",r.join(""))}function L1e(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(SY(a)))}return s.join("")}function $1e(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ie("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ie("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ie("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ie("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(ci("ProtectContents","True")),t["!protect"].objects&&i.push(ci("ProtectObjects","True")),t["!protect"].scenarios&&i.push(ci("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(ci("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(ci("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Ie("WorksheetOptions",i.join(""),{xmlns:Xs.x})}function B1e(t){return t.map(function(e){var r=lfe(e.t||""),n=Ie("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ie("Comment",n,{"ss:Author":e.a})}).join("")}function V1e(t,e,r,n,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+lr(CD(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=zr(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=lr(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=lr(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=iu[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||nt[14]);break;case"s":h="String",f=afe(t.v||"");break}var d=$h(n.cellXfs,t,n);a["ss:StyleID"]="s"+(21+d),a["ss:Index"]=o.c+1;var g=t.v!=null?f:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(m+=B1e(t.c)),Ie("Cell",m,a)}function W1e(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=vp(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function j1e(t,e,r,n){if(!t["!ref"])return"";var i=Ot(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(p,w){kh(p);var v=!!p.width,y=cR(w,p),b={"ss:Index":w+1};v&&(b["ss:Width"]=oy(y.width)),p.hidden&&(b["ss:Hidden"]="1"),a.push(Ie("Column",null,b))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[W1e(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>c)&&!(s[o].e.c<h)&&!(s[o].e.r<c)){(s[o].s.c!=h||s[o].s.r!=c)&&(f=!0);break}if(!f){var d={r:c,c:h},g=it(d),m=l?(t[c]||[])[h]:t[g];u.push(V1e(m,g,t,e,r,n,d))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function U1e(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],o=s?L1e(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?j1e(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push($1e(s,e,t,r)),n.join("")}function z1e(t,e){e||(e={}),t.SSF||(t.SSF=vr(nt)),t.SSF&&(Fp(),Zy(t.SSF),e.revssf=nR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],$h(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(N1e(t,e)),r.push(D1e()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ie("Worksheet",U1e(n,e,t),{"ss:Name":lr(t.SheetNames[n])}));return r[2]=F1e(t,e),r[3]=H1e(t),pn+Ie("Workbook",r.join(""),{xmlns:Xs.ss,"xmlns:o":Xs.o,"xmlns:x":Xs.x,"xmlns:ss":Xs.ss,"xmlns:dt":Xs.dt,"xmlns:html":Xs.html})}function G1e(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Lfe(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=$fe(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Y1e=[60,1084,2066,2165,2175];function K1e(t,e,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var l=Ec(r,r.l),c=rM[l],u=0;c!=null&&Y1e.indexOf(l)>-1;)s=Ec(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=r.slice(u,r.l+4+s),o.push(a),r.l+=4+s,c=rM[l=Ec(r,r.l)];var h=Jn(o);li(h,0);var f=0;h.lens=[];for(var d=0;d<o.length;++d)h.lens.push(f),f+=o[d].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Xa(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=nt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||iu[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ey(t.v):t.w=Ed(t.v):t.w=lo(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&zd(nt[n]||String(n))){var i=Qu(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function yC(t,e,r){return{v:t,ixfe:e,t:r}}function X1e(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},o={},a=null,l=[],c="",u={},h,f="",d,g,m,p,w={},v=[],y,b,T=[],E=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},A=function(Ze){return Ze<8?ld[Ze]:Ze<64&&E[Ze-8]||ld[Ze]},O=function(Ze,qt,Or){var xt=qt.XF.data;if(!(!xt||!xt.patternType||!Or||!Or.cellStyles)){qt.s={},qt.s.patternType=xt.patternType;var Bt;(Bt=sy(A(xt.icvFore)))&&(qt.s.fgColor={rgb:Bt}),(Bt=sy(A(xt.icvBack)))&&(qt.s.bgColor={rgb:Bt})}},Y=function(Ze,qt,Or){if(!(Re>1)&&!(Or.sheetRows&&Ze.r>=Or.sheetRows)){if(Or.cellStyles&&qt.XF&&qt.XF.data&&O(Ze,qt,Or),delete qt.ixfe,delete qt.XF,h=Ze,f=it(Ze),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<o.s.r&&(o.s.r=Ze.r),Ze.c<o.s.c&&(o.s.c=Ze.c),Ze.r+1>o.e.r&&(o.e.r=Ze.r+1),Ze.c+1>o.e.c&&(o.e.c=Ze.c+1),Or.cellFormula&&qt.f){for(var xt=0;xt<v.length;++xt)if(!(v[xt][0].s.c>Ze.c||v[xt][0].s.r>Ze.r)&&!(v[xt][0].e.c<Ze.c||v[xt][0].e.r<Ze.r)){qt.F=gt(v[xt][0]),(v[xt][0].s.c!=Ze.c||v[xt][0].s.r!=Ze.r)&&delete qt.f,qt.f&&(qt.f=""+_i(v[xt][1],o,Ze,Q,B));break}}Or.dense?(i[Ze.r]||(i[Ze.r]=[]),i[Ze.r][Ze.c]=qt):i[f]=qt}},B={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(B.password=e.password);var ie,ue=[],he=[],Ee=[],Ce=[],ge=!1,Q=[];Q.SheetNames=B.snames,Q.sharedf=B.sharedf,Q.arrayf=B.arrayf,Q.names=[],Q.XTI=[];var ye=0,Re=0,j=0,C=[],S=[],_;B.codepage=1200,Bo(1200);for(var D=!1;t.l<t.length-1;){var U=t.l,X=t.read_shift(2);if(X===0&&ye===10)break;var ee=t.l===t.length?0:t.read_shift(2),k=rM[X];if(k&&k.f){if(e.bookSheets&&ye===133&&X!==133)break;if(ye=X,k.r===2||k.r==12){var M=t.read_shift(2);if(ee-=2,!B.enc&&M!==X&&((M&255)<<8|M>>8)!==X)throw new Error("rt mismatch: "+M+"!="+X);k.r==12&&(t.l+=10,ee-=10)}var R={};if(X===10?R=k.f(t,ee,B):R=K1e(X,k,t,ee,B),Re==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(X){case 34:r.opts.Date1904=x.WBProps.date1904=R;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(B.enc||(t.l=0),B.enc=R,!e.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:B.lastuser=R;break;case 66:var W=Number(R);switch(W){case 21010:W=1200;break;case 32768:W=1e4;break;case 32769:W=1252;break}Bo(B.codepage=W),D=!0;break;case 317:B.rrtabid=R;break;case 25:B.winlocked=R;break;case 439:r.opts.RefreshAll=R;break;case 12:r.opts.CalcCount=R;break;case 16:r.opts.CalcDelta=R;break;case 17:r.opts.CalcIter=R;break;case 13:r.opts.CalcMode=R;break;case 14:r.opts.CalcPrecision=R;break;case 95:r.opts.CalcSaveRecalc=R;break;case 15:B.CalcRefMode=R;break;case 2211:r.opts.FullCalc=R;break;case 129:R.fDialog&&(i["!type"]="dialog"),R.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),R.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(R);break;case 430:Q.push([R]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(R);break;case 24:case 536:_={Name:R.Name,Ref:_i(R.rgce,o,null,Q,B)},R.itab>0&&(_.Sheet=R.itab-1),Q.names.push(_),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(S[R.itab-1]={ref:gt(R.rgce[0][0][1][2])});break;case 22:B.ExternCount=R;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(R),Q.XTI=Q.XTI.concat(R);break;case 2196:if(B.biff<8)break;_!=null&&(_.Comment=R[1]);break;case 18:i["!protect"]=R;break;case 19:R!==0&&B.WTF&&console.error("Password verifier: "+R);break;case 133:s[R.pos]=R,B.snames.push(R.name);break;case 10:{if(--Re)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=gt(o),e.sheetRows&&e.sheetRows<=o.e.r){var q=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=gt(o),o.e.r=q}o.e.r++,o.e.c++}ue.length>0&&(i["!merges"]=ue),he.length>0&&(i["!objects"]=he),Ee.length>0&&(i["!cols"]=Ee),Ce.length>0&&(i["!rows"]=Ce),x.Sheets.push(P)}c===""?u=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(B.biff===8&&(B.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),B.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(B.biff=5,D=!0,Bo(B.codepage=28591)),B.biff==8&&R.BIFFVer==0&&R.dt==16&&(B.biff=2),Re++)break;if(i=e.dense?[]:{},B.biff<8&&!D&&(D=!0,Bo(B.codepage=e.codepage||1252)),B.biff<5||R.BIFFVer==0&&R.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:t.l-ee,name:c};s[J.pos]=J,B.snames.push(c)}else c=(s[U]||{name:""}).name;R.dt==32&&(i["!type"]="chart"),R.dt==64&&(i["!type"]="macro"),ue=[],he=[],B.arrayf=v=[],Ee=[],Ce=[],ge=!1,P={Hidden:(s[U]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[R.r]||[])[R.c]:i[it({c:R.c,r:R.r})])&&++R.c,y={ixfe:R.ixfe,XF:T[R.ixfe]||{},v:R.val,t:"n"},j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 5:case 517:y={ixfe:R.ixfe,XF:T[R.ixfe],v:R.val,t:R.t},j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 638:y={ixfe:R.ixfe,XF:T[R.ixfe],v:R.rknum,t:"n"},j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 189:for(var re=R.c;re<=R.C;++re){var V=R.rkrec[re-R.c][0];y={ixfe:V,XF:T[V],v:R.rkrec[re-R.c][1],t:"n"},j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:re,r:R.r},y,e)}break;case 6:case 518:case 1030:{if(R.val=="String"){a=R;break}if(y=yC(R.val,R.cell.ixfe,R.tt),y.XF=T[y.ixfe],e.cellFormula){var te=R.formula;if(te&&te[0]&&te[0][0]&&te[0][0][0]=="PtgExp"){var oe=te[0][0][1][0],ae=te[0][0][1][1],fe=it({r:oe,c:ae});w[fe]?y.f=""+_i(R.formula,o,R.cell,Q,B):y.F=((e.dense?(i[oe]||[])[ae]:i[fe])||{}).F}else y.f=""+_i(R.formula,o,R.cell,Q,B)}j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y(R.cell,y,e),a=R}break;case 7:case 519:if(a)a.val=R,y=yC(R,a.cell.ixfe,"s"),y.XF=T[y.ixfe],e.cellFormula&&(y.f=""+_i(a.formula,o,a.cell,Q,B)),j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y(a.cell,y,e),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(R);var Me=it(R[0].s);if(d=e.dense?(i[R[0].s.r]||[])[R[0].s.c]:i[Me],e.cellFormula&&d){if(!a||!Me||!d)break;d.f=""+_i(R[1],o,R[0],Q,B),d.F=gt(R[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!a)break;w[it(a.cell)]=R[0],d=e.dense?(i[a.cell.r]||[])[a.cell.c]:i[it(a.cell)],(d||{}).f=""+_i(R[0],o,h,Q,B)}}break;case 253:y=yC(l[R.isst].t,R.ixfe,"s"),l[R.isst].h&&(y.h=l[R.isst].h),y.XF=T[y.ixfe],j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:R.ixfe,XF:T[R.ixfe],t:"z"},j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e));break;case 190:if(e.sheetStubs)for(var Ne=R.c;Ne<=R.C;++Ne){var ze=R.ixfe[Ne-R.c];y={ixfe:ze,XF:T[ze],t:"z"},j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:Ne,r:R.r},y,e)}break;case 214:case 516:case 4:y=yC(R.val,R.ixfe,"s"),y.XF=T[y.ixfe],j>0&&(y.z=C[y.ixfe>>8&63]),Xa(y,e,r.opts.Date1904),Y({c:R.c,r:R.r},y,e);break;case 0:case 512:Re===1&&(o=R);break;case 252:l=R;break;case 1054:if(B.biff==4){C[j++]=R[1];for(var ot=0;ot<j+163&&nt[ot]!=R[1];++ot);ot>=163&&Nl(R[1],j+163)}else Nl(R[1],R[0]);break;case 30:{C[j++]=R;for(var at=0;at<j+163&&nt[at]!=R;++at);at>=163&&Nl(R,j+163)}break;case 229:ue=ue.concat(R);break;case 93:he[R.cmo[0]]=B.lastobj=R;break;case 438:B.lastobj.TxO=R;break;case 127:B.lastobj.ImData=R;break;case 440:for(p=R[0].s.r;p<=R[0].e.r;++p)for(m=R[0].s.c;m<=R[0].e.c;++m)d=e.dense?(i[p]||[])[m]:i[it({c:m,r:p})],d&&(d.l=R[1]);break;case 2048:for(p=R[0].s.r;p<=R[0].e.r;++p)for(m=R[0].s.c;m<=R[0].e.c;++m)d=e.dense?(i[p]||[])[m]:i[it({c:m,r:p})],d&&d.l&&(d.l.Tooltip=R[1]);break;case 28:{if(B.biff<=5&&B.biff>=2)break;d=e.dense?(i[R[0].r]||[])[R[0].c]:i[it(R[0])];var rt=he[R[2]];d||(e.dense?(i[R[0].r]||(i[R[0].r]=[]),d=i[R[0].r][R[0].c]={t:"z"}):d=i[it(R[0])]={t:"z"},o.e.r=Math.max(o.e.r,R[0].r),o.s.r=Math.min(o.s.r,R[0].r),o.e.c=Math.max(o.e.c,R[0].c),o.s.c=Math.min(o.s.c,R[0].c)),d.c||(d.c=[]),g={a:R[1],t:rt.TxO.t},d.c.push(g)}break;case 2173:Hpe(T[R.ixfe],R.ext);break;case 125:{if(!B.cellStyles)break;for(;R.e>=R.s;)Ee[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},ge||(ge=!0,vD(R.w/256)),kh(Ee[R.e+1])}break;case 520:{var We={};R.level!=null&&(Ce[R.r]=We,We.level=R.level),R.hidden&&(Ce[R.r]=We,We.hidden=!0),R.hpt&&(Ce[R.r]=We,We.hpt=R.hpt,We.hpx=vp(R.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||hd(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=R;break;case 161:i["!margins"]||hd(i["!margins"]={}),i["!margins"].header=R.header,i["!margins"].footer=R.footer;break;case 574:R.RTL&&(x.Views[0].RTL=!0);break;case 146:E=R;break;case 2198:ie=R;break;case 140:b=R;break;case 442:c?P.CodeName=R||P.name:x.WBProps.CodeName=R||"ThisWorkbook";break}}else k||console.error("Missing Info for XLS Record 0x"+X.toString(16)),t.l+=ee}return r.SheetNames=ln(s).sort(function(ft,Ze){return Number(ft)-Number(Ze)}).map(function(ft){return s[ft].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&S.forEach(function(ft,Ze){r.Sheets[r.SheetNames[Ze]]["!autofilter"]=ft}),r.Strings=l,r.SSF=vr(nt),B.enc&&(r.Encryption=B.enc),ie&&(r.Themes=ie),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),Q.names.length>0&&(x.Names=Q.names),r.Workbook=x,r}var ew={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function q1e(t,e,r){var n=Xe.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=xB(n,XO,ew.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var o=Xe.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var a=xB(o,qO,ew.SI);for(var l in a)e[l]==null&&(e[l]=a[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(yG(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function J1e(t,e){var r=[],n=[],i=[],s=0,o,a=Q3(XO,"n"),l=Q3(qO,"n");if(t.Props)for(o=ln(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=ln(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)RG.indexOf(i[s][0])>-1||wG.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Xe.utils.cfb_add(e,"/SummaryInformation",bB(n,ew.SI,l,qO)),(r.length||c.length)&&Xe.utils.cfb_add(e,"/DocumentSummaryInformation",bB(r,ew.DSI,a,XO,c.length?c:null,ew.UDI))}function ED(t,e){e||(e={}),TD(e),tR(),e.codepage&&eR(e.codepage);var r,n;if(t.FullPaths){if(Xe.find(t,"/encryption"))throw new Error("File is password-protected");r=Xe.find(t,"!CompObj"),n=Xe.find(t,"/Workbook")||Xe.find(t,"/Book")}else{switch(e.type){case"base64":t=qs(ao(t));break;case"binary":t=qs(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}li(t,0),n={content:t}}var i,s;if(r&&G1e(r),e.bookProps&&!e.bookSheets)i={};else{var o=bt?"buffer":"array";if(n&&n.content)i=X1e(n.content,e);else if((s=Xe.find(t,"PerfectOffice_MAIN"))&&s.content)i=ud.to_workbook(s.content,(e.type=o,e));else if((s=Xe.find(t,"NativeContent_MAIN"))&&s.content)i=ud.to_workbook(s.content,(e.type=o,e));else throw(s=Xe.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Xe.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=h0e(t))}var a={};return t.FullPaths&&q1e(t,a,e),i.Props=i.Custprops=a,e.bookFiles&&(i.cfb=t),i}function Q1e(t,e){var r=e||{},n=Xe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Xe.utils.cfb_add(n,i,xY(t,r)),r.biff==8&&(t.Props||t.Custprops)&&J1e(t,n),r.biff==8&&t.vbaraw&&f0e(n,Xe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var cy={0:{f:bwe},1:{f:Iwe},2:{f:qwe},3:{f:$we},4:{f:Dwe},5:{f:Ywe},6:{f:tye},7:{f:jwe},8:{f:lye},9:{f:aye},10:{f:sye},11:{f:oye},12:{f:Mwe},13:{f:Qwe},14:{f:Vwe},15:{f:Hwe},16:{f:dY},17:{f:nye},18:{f:zwe},19:{f:aD},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:r1e},40:{},42:{},43:{f:tpe},44:{f:Zme},45:{f:ipe},46:{f:ope},47:{f:spe},48:{},49:{f:Rfe},50:{},51:{f:Bpe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:HG},62:{f:eye},63:{f:Xpe},64:{f:_ye},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Di,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Cye},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Pwe},148:{f:Rwe,p:16},151:{f:gye},152:{},153:{f:Zye},154:{},155:{},156:{f:Jye},157:{},158:{},159:{T:1,f:pme},160:{T:-1},161:{T:1,f:qd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cye},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Lpe},336:{T:-1},337:{f:jpe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:KO},357:{},358:{},359:{},360:{T:1},361:{},362:{f:FG},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mye},427:{f:pye},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wye},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kwe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fye},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:KO},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:o0e},633:{T:1},634:{T:-1},635:{T:1,f:i0e},636:{T:-1},637:{f:Afe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Vye},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Eye},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rM={6:{f:hk},10:{f:pu},12:{f:Rn},13:{f:Rn},14:{f:hn},15:{f:hn},16:{f:Pi},17:{f:hn},18:{f:hn},19:{f:Rn},20:{f:PB},21:{f:PB},23:{f:FG},24:{f:IB},25:{f:hn},26:{},27:{},28:{f:Ege},29:{},34:{f:hn},35:{f:AB},38:{f:Pi},39:{f:Pi},40:{f:Pi},41:{f:Pi},42:{f:hn},43:{f:hn},47:{f:Hme},49:{f:Qde},51:{f:Rn},60:{},61:{f:Yde},64:{f:hn},65:{f:Jde},66:{f:Rn},77:{},80:{},81:{},82:{},85:{f:Rn},89:{},90:{},91:{},92:{f:Fde},93:{f:kge},94:{},95:{f:hn},96:{},97:{},99:{f:hn},125:{f:HG},128:{f:dge},129:{f:Lde},130:{f:Rn},131:{f:hn},132:{f:hn},133:{f:$de},134:{},140:{f:Fge},141:{f:Rn},144:{},146:{f:$ge},151:{},152:{},153:{},154:{},155:{},156:{f:Rn},157:{},158:{},160:{f:Gge},161:{f:Wge},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:cge},190:{f:uge},193:{f:pu},197:{},198:{},199:{},200:{},201:{},202:{f:hn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rn},220:{},221:{f:hn},222:{},224:{f:fge},225:{f:Dde},226:{f:pu},227:{},229:{f:Rge},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Vde},253:{f:ege},255:{f:jde},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:TG},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hn},353:{f:pu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:wge},431:{f:hn},432:{},433:{},434:{},437:{},438:{f:Ige},439:{f:hn},440:{f:Oge},441:{},442:{f:r1},443:{},444:{f:Rn},445:{},446:{},448:{f:pu},449:{f:Gde,r:2},450:{f:pu},512:{f:RB},513:{f:zge},515:{f:pge},516:{f:rge},517:{f:kB},519:{f:Yge},520:{f:Ude},523:{},545:{f:OB},549:{f:EB},566:{},574:{f:Xde},638:{f:lge},659:{},1048:{},1054:{f:ige},1084:{},1212:{f:xge},2048:{f:Nge},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:pC},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:pu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Bge,r:12},2173:{f:Fpe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Sge,r:12},2197:{},2198:{f:Ape,r:12},2199:{},2200:{},2201:{},2202:{f:bge,r:12},2203:{f:pu},2204:{},2205:{},2206:{},2207:{},2211:{f:zde},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jge},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Lge},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:RB},1:{},2:{f:Qge},3:{f:qge},4:{f:Xge},5:{f:kB},7:{f:eme},8:{},9:{f:pC},11:{},22:{f:Rn},30:{f:oge},31:{},32:{},33:{f:OB},36:{},37:{f:EB},50:{f:tme},62:{},52:{},67:{},68:{f:Rn},69:{},86:{},126:{},127:{f:Kge},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rme},223:{},234:{},354:{},421:{},518:{f:hk},521:{f:pC},536:{f:IB},547:{f:AB},561:{},579:{},1030:{f:hk},1033:{f:pC},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Oe(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&iD(r)&&t.push(r)}}function Z1e(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Oe(t,e,r,i);var s=e;if(!isNaN(s)){for(var o=r.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function o1(t,e,r){return t||(t=ve(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function eCe(t,e,r,n){var i=ve(9);return o1(i,t,e),kG(r,n||"b",i),i}function tCe(t,e,r){var n=ve(8+2*r.length);return o1(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function rCe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?jn(Pr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Oe(t,2,Zge(r,n,i)):Oe(t,3,Jge(r,n,i));return;case"b":case"e":Oe(t,5,eCe(r,n,e.v,e.t));return;case"s":case"str":Oe(t,4,tCe(r,n,(e.v||"").slice(0,255)));return}Oe(t,1,o1(null,r,n))}function nCe(t,e,r,n){var i=Array.isArray(e),s=Ot(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=gt(s)}for(var c=s.s.r;c<=s.e.r;++c){a=sn(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=kr(u)),o=l[u]+a;var h=i?(e[c]||[])[u]:e[o];h&&rCe(t,h,c,u)}}}function iCe(t,e){for(var r=e||{},n=Is(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Oe(n,r.biff==4?1033:r.biff==3?521:9,gD(t,16,r)),nCe(n,t.Sheets[t.SheetNames[i]],i,r),Oe(n,10),n.end()}function sCe(t,e,r){Oe(t,49,Zde({sz:12,name:"Arial"},r))}function oCe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Oe(t,1054,sge(i,e[i],r))})}function aCe(t,e){var r=ve(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Oe(t,2151,r),r=ve(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),MG(Ot(e["!ref"]||"A1"),r),r.write_shift(4,4),Oe(t,2152,r)}function lCe(t,e){for(var r=0;r<16;++r)Oe(t,224,TB({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Oe(t,224,TB(n,0,e))})}function cCe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Oe(t,440,Mge(n)),n[1].Tooltip&&Oe(t,2048,Dge(n))}delete e["!links"]}function uCe(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Oe(t,125,Vge(cR(i,n),i))})}}function hCe(t,e,r,n,i){var s=16+$h(i.cellXfs,e,i);if(e.v==null&&!e.bf){Oe(t,513,Pd(r,n,s));return}if(e.bf)Oe(t,6,Lve(e,r,n,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?jn(Pr(e.v)):e.v;Oe(t,515,vge(r,n,o,s));break;case"b":case"e":Oe(t,517,mge(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=xD(i.Strings,e.v,i.revStrings);Oe(t,253,tge(r,n,a,s))}else Oe(t,516,nge(r,n,(e.v||"").slice(0,255),s,i));break;default:Oe(t,513,Pd(r,n,s))}}function fCe(t,e,r){var n=Is(),i=r.SheetNames[t],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,u,h="",f=[],d=Ot(s["!ref"]||"A1"),g=c?65536:16384;if(d.e.c>255||d.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,g-1)}Oe(n,2057,gD(r,16,e)),Oe(n,13,To(1)),Oe(n,12,To(100)),Oe(n,15,Ki(!0)),Oe(n,17,Ki(!1)),Oe(n,16,Td(.001)),Oe(n,95,Ki(!0)),Oe(n,42,Ki(!1)),Oe(n,43,Ki(!1)),Oe(n,130,To(1)),Oe(n,128,gge()),Oe(n,131,Ki(!1)),Oe(n,132,Ki(!1)),c&&uCe(n,s["!cols"]),Oe(n,512,age(d,e)),c&&(s["!links"]=[]);for(var m=d.s.r;m<=d.e.r;++m){h=sn(m);for(var p=d.s.c;p<=d.e.c;++p){m===d.s.r&&(f[p]=kr(p)),u=f[p]+h;var w=l?(s[m]||[])[p]:s[u];w&&(hCe(n,w,m,p,e),c&&w.l&&s["!links"].push([u,w.l]))}}var v=a.CodeName||a.name||i;return c&&Oe(n,574,qde((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&Oe(n,229,Tge(s["!merges"])),c&&cCe(n,s),Oe(n,442,PG(v)),c&&aCe(n,s),Oe(n,10),n.end()}function dCe(t,e,r){var n=Is(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,l=r.biff==5;if(Oe(n,2057,gD(t,5,r)),r.bookType=="xla"&&Oe(n,135),Oe(n,225,a?To(1200):null),Oe(n,193,mde(2)),l&&Oe(n,191),l&&Oe(n,192),Oe(n,226),Oe(n,92,Hde("SheetJS",r)),Oe(n,66,To(a?1200:1252)),a&&Oe(n,353,To(0)),a&&Oe(n,448),Oe(n,317,Uge(t.SheetNames.length)),a&&t.vbaraw&&Oe(n,211),a&&t.vbaraw){var c=o.CodeName||"ThisWorkbook";Oe(n,442,PG(c))}Oe(n,156,To(17)),Oe(n,25,Ki(!1)),Oe(n,18,Ki(!1)),Oe(n,19,To(0)),a&&Oe(n,431,Ki(!1)),a&&Oe(n,444,To(0)),Oe(n,61,Kde()),Oe(n,64,Ki(!1)),Oe(n,141,To(0)),Oe(n,34,Ki(Gye(t)=="true")),Oe(n,14,Ki(!0)),a&&Oe(n,439,Ki(!1)),Oe(n,218,To(0)),sCe(n,t,r),oCe(n,t.SSF,r),lCe(n,r),a&&Oe(n,352,Ki(!1));var u=n.end(),h=Is();a&&Oe(h,140,Hge()),a&&r.Strings&&Z1e(h,252,Wde(r.Strings)),Oe(h,10);var f=h.end(),d=Is(),g=0,m=0;for(m=0;m<t.SheetNames.length;++m)g+=(a?12:11)+(a?2:1)*t.SheetNames[m].length;var p=u.length+g+f.length;for(m=0;m<t.SheetNames.length;++m){var w=s[m]||{};Oe(d,133,Bde({pos:p,hs:w.Hidden||0,dt:0,name:t.SheetNames[m]},r)),p+=e[m].length}var v=d.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),f.length&&y.push(f),Jn(y)}function gCe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vr(nt)),t&&t.SSF&&(Fp(),Zy(t.SSF),r.revssf=nR(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kD(r),r.cellXfs=[],$h(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=fCe(i,r,t);return n.unshift(dCe(t,n,r)),Jn(n)}function xY(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=es(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return gCe(t,e);case 4:case 3:case 2:return iCe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function WB(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),o=i.index,a=s&&s.index||t.length,l=Zhe(t.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var m=l[o].trim(),p=m.slice(0,3).toLowerCase();if(p=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(p!="<td"&&p!="<th")){var w=m.split(/<\/t[dh]>/i);for(a=0;a<w.length;++a){var v=w[a].trim();if(v.match(/<t[dh]/i)){for(var y=v,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var T=0;T<g.length;++T){var E=g[T];E.s.c==u&&E.s.r<c&&c<=E.e.r&&(u=E.e.c+1,T=-1)}var x=st(v.slice(0,v.indexOf(">")));f=x.colspan?+x.colspan:1,((h=+x.rowspan)>1||f>1)&&g.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+f-1}});var P=x.t||x["data-t"]||"";if(!y.length){u+=f;continue}if(y=q7(y),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!y.length){u+=f;continue}var A={t:"s",v:y};r.raw||!y.trim().length||P=="s"||(y==="TRUE"?A={t:"b",v:!0}:y==="FALSE"?A={t:"b",v:!1}:isNaN(Oa(y))?isNaN(mp(y).getDate())||(A={t:"d",v:Pr(y)},r.cellDates||(A={t:"n",v:jn(A.v)}),A.z=r.dateNF||nt[14]):A={t:"n",v:Oa(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=A):n[it({r:c,c:u})]=A,u+=f}}}}return n["!ref"]=gt(d),g.length&&(n["!merges"]=g),n}function bY(t,e,r,n){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=it({r,c:o}),h=n.dense?(t[r]||[])[o]:t[u],f=h&&h.v!=null&&(h.h||JN(h.w||(Hl(h),h.w)||""))||"",d={};a>1&&(d.rowspan=a),l>1&&(d.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(Ie("td",f,d))}}var g="<tr>";return g+s.join("")+"</tr>"}var _Y='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',EY="</body></html>";function mCe(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Lh(WB(r[0],e),e);var n=MD();return r.forEach(function(i,s){ND(n,WB(i,e),"Sheet"+(s+1))}),n}function RY(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function TY(t,e){var r=e||{},n=r.header!=null?r.header:_Y,i=r.footer!=null?r.footer:EY,s=[n],o=es(t["!ref"]);r.dense=Array.isArray(t),s.push(RY(t,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(bY(t,o,a,r));return s.push("</table>"+i),s.join("")}function kY(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?zr(n.origin):n.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=es(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],f=0,d=t["!rows"]||(t["!rows"]=[]),g=0,m=0,p=0,w=0,v=0,y=0;for(t["!cols"]||(t["!cols"]=[]);g<a.length&&m<l;++g){var b=a[g];if(jB(b)){if(n.display)continue;d[m]={hidden:!0}}var T=b.children;for(p=w=0;p<T.length;++p){var E=T[p];if(!(n.display&&jB(E))){var x=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):q7(E.innerHTML),P=E.getAttribute("data-z")||E.getAttribute("z");for(f=0;f<h.length;++f){var A=h[f];A.s.c==w+s&&A.s.r<m+i&&m+i<=A.e.r&&(w=A.e.c+1-s,f=-1)}y=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:m+i,c:w+s},e:{r:m+i+(v||1)-1,c:w+s+(y||1)-1}});var O={t:"s",v:x},Y=E.getAttribute("data-t")||E.getAttribute("t")||"";x!=null&&(x.length==0?O.t=Y||"z":n.raw||x.trim().length==0||Y=="s"||(x==="TRUE"?O={t:"b",v:!0}:x==="FALSE"?O={t:"b",v:!1}:isNaN(Oa(x))?isNaN(mp(x).getDate())||(O={t:"d",v:Pr(x)},n.cellDates||(O={t:"n",v:jn(O.v)}),O.z=n.dateNF||nt[14]):O={t:"n",v:Oa(x)})),O.z===void 0&&P!=null&&(O.z=P);var B="",ie=E.getElementsByTagName("A");if(ie&&ie.length)for(var ue=0;ue<ie.length&&!(ie[ue].hasAttribute("href")&&(B=ie[ue].getAttribute("href"),B.charAt(0)!="#"));++ue);B&&B.charAt(0)!="#"&&(O.l={Target:B}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][w+s]=O):t[it({c:w+s,r:m+i})]=O,c.e.c<w+s&&(c.e.c=w+s),w+=y}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),t["!ref"]=gt(c),m>=l&&(t["!fullref"]=gt((c.e.r=a.length-g+m-1+i,c))),t}function PY(t,e){var r=e||{},n=r.dense?[]:{};return kY(n,t,e)}function pCe(t,e){return Lh(PY(t,e),e)}function jB(t){var e="",r=vCe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function vCe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function wCe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ut(e.replace(/<[^>]*>/g,""));return[r]}var UB={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function AY(t,e){var r=e||{},n=QN(t),i=[],s,o,a={name:""},l="",c=0,u,h,f={},d=[],g=r.dense?[]:{},m,p,w={value:""},v="",y=0,b=[],T=-1,E=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,A={},O=[],Y={},B=0,ie=0,ue=[],he=1,Ee=1,Ce=[],ge={Names:[]},Q={},ye=["",""],Re=[],j={},C="",S=0,_=!1,D=!1,U=0;for(ny.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=ny.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(x.e.c>=x.s.c&&x.e.r>=x.s.r?g["!ref"]=gt(x):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=x.e.r&&(g["!fullref"]=g["!ref"],x.e.r=r.sheetRows-1,g["!ref"]=gt(x)),O.length&&(g["!merges"]=O),ue.length&&(g["!rows"]=ue),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),f[u.name]=g,D=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=st(m[0],!1),T=E=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,g=r.dense?[]:{},O=[],ue=[],D=!0);break;case"table-row-group":m[1]==="/"?--P:++P;break;case"table-row":case"行":if(m[1]==="/"){T+=he,he=1;break}if(h=st(m[0],!1),h.行号?T=h.行号-1:T==-1&&(T=0),he=+h["number-rows-repeated"]||1,he<10)for(U=0;U<he;++U)P>0&&(ue[T+U]={level:P});E=-1;break;case"covered-table-cell":m[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(g[T]||(g[T]=[]),g[T][E]={t:"z"}):g[it({r:T,c:E})]={t:"z"}),v="",b=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++E,w=st(m[0],!1),Ee=parseInt(w["number-columns-repeated"]||"1",10),p={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(p.f=$B(Ut(w.formula))),(w.数据类型||w["value-type"])=="string"&&(p.t="s",p.v=Ut(w["string-value"]||""),r.dense?(g[T]||(g[T]=[]),g[T][E]=p):g[it({r:T,c:E})]=p),E+=Ee-1;else if(m[1]!=="/"){++E,v="",y=0,b=[],Ee=1;var X=he?T+he-1:T;if(E>x.e.c&&(x.e.c=E),E<x.s.c&&(x.s.c=E),T<x.s.r&&(x.s.r=T),X>x.e.r&&(x.e.r=X),w=st(m[0],!1),Re=[],j={},p={t:w.数据类型||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=Ut(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(B=parseInt(w["number-matrix-rows-spanned"],10)||0,ie=parseInt(w["number-matrix-columns-spanned"],10)||0,Y={s:{r:T,c:E},e:{r:T+B-1,c:E+ie-1}},p.F=gt(Y),Ce.push([Y,p.F])),w.formula)p.f=$B(w.formula);else for(U=0;U<Ce.length;++U)T>=Ce[U][0].s.r&&T<=Ce[U][0].e.r&&E>=Ce[U][0].s.c&&E<=Ce[U][0].e.c&&(p.F=Ce[U][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(B=parseInt(w["number-rows-spanned"],10)||0,ie=parseInt(w["number-columns-spanned"],10)||0,Y={s:{r:T,c:E},e:{r:T+B-1,c:E+ie-1}},O.push(Y)),w["number-columns-repeated"]&&(Ee=parseInt(w["number-columns-repeated"],10)),p.t){case"boolean":p.t="b",p.v=Rr(w["boolean-value"]);break;case"float":p.t="n",p.v=parseFloat(w.value);break;case"percentage":p.t="n",p.v=parseFloat(w.value);break;case"currency":p.t="n",p.v=parseFloat(w.value);break;case"date":p.t="d",p.v=Pr(w["date-value"]),r.cellDates||(p.t="n",p.v=jn(p.v)),p.z="m/d/yy";break;case"time":p.t="n",p.v=qhe(w["time-value"])/86400,r.cellDates&&(p.t="d",p.v=iR(p.v)),p.z="HH:MM:SS";break;case"number":p.t="n",p.v=parseFloat(w.数据数值);break;default:if(p.t==="string"||p.t==="text"||!p.t)p.t="s",w["string-value"]!=null&&(v=Ut(w["string-value"]),b=[]);else throw new Error("Unsupported value type "+p.t)}}else{if(_=!1,p.t==="s"&&(p.v=v||"",b.length&&(p.R=b),_=y==0),Q.Target&&(p.l=Q),Re.length>0&&(p.c=Re,Re=[]),v&&r.cellText!==!1&&(p.w=v),_&&(p.t="z",delete p.v),(!_||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var ee=0;ee<he;++ee){if(Ee=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(g[T+ee]||(g[T+ee]=[]),g[T+ee][E]=ee==0?p:vr(p);--Ee>0;)g[T+ee][E+Ee]=vr(p);else for(g[it({r:T+ee,c:E})]=p;--Ee>0;)g[it({r:T+ee,c:E+Ee})]=vr(p);x.e.c<=E&&(x.e.c=E)}Ee=parseInt(w["number-columns-repeated"]||"1",10),E+=Ee-1,Ee=0,p={},v="",b=[]}Q={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;j.t=v,b.length&&(j.R=b),j.a=C,Re.push(j)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);C="",S=0,v="",y=0,b=[];break;case"creator":m[1]==="/"?C=n.slice(S,m.index):S=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);v="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(A[a.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",a=st(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=st(m[0],!1),l+=UB[m[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=st(m[0],!1),l+=UB[m[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":o=st(m[0],!1),ye=fk(o["cell-range-address"]);var k={Name:o.name,Ref:ye[0]+"!"+ye[1]};D&&(k.Sheet=d.length),ge.Names.push(k);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!w||!w["string-value"])){var M=wCe(n.slice(y,m.index));v=(v.length>0?v+`
`:"")+M[0]}else st(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ye=fk(st(m[0])["target-range-address"]),f[ye[0]]["!autofilter"]={ref:ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(Q=st(m[0],!1),!Q.href)break;Q.Target=Ut(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(ye=fk(Q.Target.slice(1)),Q.Target="#"+ye[0]+"!"+ye[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var R={Sheets:f,SheetNames:d,Workbook:ge};return r.bookSheets&&delete R.Sheets,R}function zB(t,e){e=e||{},Eo(t,"META-INF/manifest.xml")&&qfe(En(t,"META-INF/manifest.xml"),e);var r=Js(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=AY(fr(r),e);return Eo(t,"meta.xml")&&(n.Props=pG(En(t,"meta.xml"))),n}function GB(t,e){return AY(t,e)}var yCe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+ry({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return pn+e}}(),YB=function(){var t=function(s){return lr(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,a){var l=[];l.push('      <table:table table:name="'+lr(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=es(s["!ref"]||"A1"),f=s["!merges"]||[],d=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",p=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=p[c]?' table:style-name="ro'+p[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=p[c]?' table:style-name="ro'+p[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<h.s.c;++u)l.push(e);for(;u<=h.e.c;++u){var w=!1,v={},y="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>u)&&!(f[d].s.r>c)&&!(f[d].e.c<u)&&!(f[d].e.r<c)){(f[d].s.c!=u||f[d].s.r!=c)&&(w=!0),v["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,v["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(w){l.push(r);continue}var b=it({r:c,c:u}),T=g?(s[c]||[])[u]:s[b];if(T&&T.f&&(v["table:formula"]=lr(Uve(T.f)),T.F&&T.F.slice(0,b.length)==b)){var E=es(T.F);v["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,v["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!T){l.push(e);continue}switch(T.t){case"b":y=T.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=T.v?"true":"false";break;case"n":y=T.w||String(T.v||0),v["office:value-type"]="float",v["office:value"]=T.v||0;break;case"s":case"str":y=T.v==null?"":T.v,v["office:value-type"]="string";break;case"d":y=T.w||Pr(T.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Pr(T.v).toISOString(),v["table:style-name"]="ce1";break;default:l.push(e);continue}var x=t(y);if(T.l&&T.l.Target){var P=T.l.Target;P=P.charAt(0)=="#"?"#"+zve(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),x=Ie("text:a",x,{"xlink:href":P.replace(/&/g,"&amp;")})}l.push("          "+Ie("table:table-cell",Ie("text:p",x,{}),v)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;kh(h),h.ods=a;var f=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[pn],c=ry({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=ry({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(mG().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(n(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function IY(t,e){if(e.bookType=="fods")return YB(t,e);var r=KN(),n="",i=[],s=[];return n="mimetype",mt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",mt(r,n,YB(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",mt(r,n,yCe(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",mt(r,n,pn+mG()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",mt(r,n,Zfe(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",mt(r,n,Jfe(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ad(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function nM(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):fr(Hh(t))}function CCe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):qs(Al(t))}function SCe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Ah(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function KB(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function xCe(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function bCe(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function uy(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function or(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function on(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Yt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=uy(t,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);a=t.slice(l,r[0])}break;case 5:o=4,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=uy(t,r),a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:a,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function ii(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(or(n*8+i.type)),i.type==2&&e.push(or(i.data.length)),e.push(i.data))})}),Ah(e)}function RD(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function xo(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=uy(t,n),s=Yt(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:on(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Yt(a.data),c=on(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(o.merge=on(s[3][0].data)>>>0>0),r.push(o)}return r}function fg(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:or(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:or(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:or(o.data.length)}],n[2].push({data:ii(o.meta),type:2})});var s=ii(n);e.push(or(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),Ah(e)}function _Ce(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=uy(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[r[0]],a>1&&(o|=e[r[0]+1]<<8),a>2&&(o|=e[r[0]+2]<<16),a>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Ah(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Ah(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function bo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(_Ce(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Ah(e)}function dg(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=or(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Ah(e)}function ECe(t,e,r,n){var i=Ad(t),s=i.getUint32(4,!0),o=(n>1?12:8)+KB(s&(n>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=KB(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(o,!0),o+=4),s&32&&(c=i.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function RCe(t,e,r){var n=Ad(t),i=n.getUint32(8,!0),s=12,o=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=xCe(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[a]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function gk(t,e){var r=new Uint8Array(32),n=Ad(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,bCe(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function mk(t,e){var r=new Uint8Array(32),n=Ad(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function TCe(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return ECe(t,e,r,t[0]);case 5:return RCe(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function bi(t){var e=Yt(t);return uy(e[1][0].data)}function XB(t,e){var r=Yt(e.data),n=on(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var a=Yt(o.data),l=on(a[1][0].data)>>>0;switch(n){case 1:s[l]=nM(a[3][0].data);break;case 8:{var c=t[bi(a[9][0].data)][0],u=Yt(c.data),h=t[bi(u[1][0].data)][0],f=on(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var d=Yt(h.data);s[l]=d[3].map(function(g){return nM(g.data)}).join("")}break}}),s}function kCe(t,e){var r,n,i,s,o,a,l,c,u,h,f,d,g,m,p=Yt(t),w=on(p[1][0].data)>>>0,v=on(p[2][0].data)>>>0,y=((n=(r=p[8])==null?void 0:r[0])==null?void 0:n.data)&&on(p[8][0].data)>0||!1,b,T;if((s=(i=p[7])==null?void 0:i[0])!=null&&s.data&&e!=0)b=(a=(o=p[7])==null?void 0:o[0])==null?void 0:a.data,T=(c=(l=p[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=p[4])==null?void 0:u[0])!=null&&h.data&&e!=1)b=(d=(f=p[4])==null?void 0:f[0])==null?void 0:d.data,T=(m=(g=p[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var E=y?4:1,x=Ad(b),P=[],A=0;A<b.length/2;++A){var O=x.getUint16(A*2,!0);O<65535&&P.push([A,O])}if(P.length!=v)throw"Expected ".concat(v," cells, found ").concat(P.length);var Y=[];for(A=0;A<P.length-1;++A)Y[P[A][0]]=T.subarray(P[A][1]*E,P[A+1][1]*E);return P.length>=1&&(Y[P[P.length-1][0]]=T.subarray(P[P.length-1][1]*E)),{R:w,cells:Y}}function PCe(t,e){var r,n=Yt(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?on(n[7][0].data)>>>0>0?1:0:-1,s=RD(n[5],function(o){return kCe(o,i)});return{nrows:on(n[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,c){if(o[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));o[a.R][c]=l}),o},[])}}function ACe(t,e,r){var n,i=Yt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(on(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(on(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=gt(s);var o=Yt(i[4][0].data),a=XB(t,t[bi(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?XB(t,t[bi(o[17][0].data)][0]):[],c=Yt(o[3][0].data),u=0;c[1].forEach(function(h){var f=Yt(h.data),d=t[bi(f[2][0].data)][0],g=on(d.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=PCe(t,d);m.data.forEach(function(p,w){p.forEach(function(v,y){var b=it({r:u+w,c:y}),T=TCe(v,a,l);T&&(r[b]=T)})}),u+=m.nrows})}function ICe(t,e){var r=Yt(e.data),n={"!ref":"A1"},i=t[bi(r[2][0].data)],s=on(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return ACe(t,i[0],n),n}function OCe(t,e){var r,n=Yt(e.data),i={name:(r=n[1])!=null&&r[0]?nM(n[1][0].data):"",sheets:[]},s=RD(n[2],bi);return s.forEach(function(o){t[o].forEach(function(a){var l=on(a.meta[1][0].data);l==6e3&&i.sheets.push(ICe(t,a))})}),i}function MCe(t,e){var r=MD(),n=Yt(e.data),i=RD(n[1],bi);if(i.forEach(function(s){t[s].forEach(function(o){var a=on(o.meta[1][0].data);if(a==2){var l=OCe(t,o);l.sheets.forEach(function(c,u){ND(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function pk(t){var e,r,n,i,s={},o=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=bo(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=xo(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&on(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(l){s[l].forEach(function(c){var u=on(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return MCe(s,a)}function NCe(t,e,r){var n,i,s,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&on(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=Ad(t[7][0].data),u=0,h=[],f=Ad(t[4][0].data),d=0,g=[],m=0;m<e.length;++m){if(e[m]==null){c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),f.setUint16(m*2,d,!0);var p,w;switch(typeof e[m]){case"string":p=gk({t:"s",v:e[m]},r),w=mk({t:"s",v:e[m]},r);break;case"number":p=gk({t:"n",v:e[m]},r),w=mk({t:"n",v:e[m]},r);break;case"boolean":p=gk({t:"b",v:e[m]},r),w=mk({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(p),u+=p.length,g.push(w),d+=w.length,++l}for(t[2][0].data=or(l);m<t[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return t[6][0].data=Ah(h),t[3][0].data=Ah(g),l}function DCe(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=es(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(gt(n)));var s=l_(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(C){return C.forEach(function(S){typeof S=="string"&&o.push(S)})});var a={},l=[],c=Xe.read(e.numbers,{type:"base64"});c.FileIndex.map(function(C,S){return[C,c.FullPaths[S]]}).forEach(function(C){var S=C[0],_=C[1];if(S.type==2&&S.name.match(/\.iwa/)){var D=S.content,U=bo(D),X=xo(U);X.forEach(function(ee){l.push(ee.id),a[ee.id]={deps:[],location:_,type:on(ee.messages[0].meta[1][0].data)}})}}),l.sort(function(C,S){return C-S});var u=l.filter(function(C){return C>1}).map(function(C){return[C,or(C)]});c.FileIndex.map(function(C,S){return[C,c.FullPaths[S]]}).forEach(function(C){var S=C[0];if(C[1],!!S.name.match(/\.iwa/)){var _=xo(bo(S.content));_.forEach(function(D){D.messages.forEach(function(U){u.forEach(function(X){D.messages.some(function(ee){return on(ee.meta[1][0].data)!=11006&&SCe(ee.data,X[1])})&&a[X[0]].deps.push(D.id)})})})}});for(var h=Xe.find(c,a[1].location),f=xo(bo(h.content)),d,g=0;g<f.length;++g){var m=f[g];m.id==1&&(d=m)}var p=bi(Yt(d.messages[0].data)[1][0].data);for(h=Xe.find(c,a[p].location),f=xo(bo(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);for(p=bi(Yt(d.messages[0].data)[2][0].data),h=Xe.find(c,a[p].location),f=xo(bo(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);for(p=bi(Yt(d.messages[0].data)[2][0].data),h=Xe.find(c,a[p].location),f=xo(bo(h.content)),g=0;g<f.length;++g)m=f[g],m.id==p&&(d=m);var w=Yt(d.messages[0].data);{w[6][0].data=or(n.e.r+1),w[7][0].data=or(n.e.c+1);var v=bi(w[46][0].data),y=Xe.find(c,a[v].location),b=xo(bo(y.content));{for(var T=0;T<b.length&&b[T].id!=v;++T);if(b[T].id!=v)throw"Bad ColumnRowUIDMapArchive";var E=Yt(b[T].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var x=0;x<=n.e.c;++x){var P=[];P[1]=P[2]=[{type:0,data:or(x+420690)}],E[1].push({type:2,data:ii(P)}),E[2].push({type:0,data:or(x)}),E[3].push({type:0,data:or(x)})}E[4]=[],E[5]=[],E[6]=[];for(var A=0;A<=n.e.r;++A)P=[],P[1]=P[2]=[{type:0,data:or(A+726270)}],E[4].push({type:2,data:ii(P)}),E[5].push({type:0,data:or(A)}),E[6].push({type:0,data:or(A)});b[T].messages[0].data=ii(E)}y.content=dg(fg(b)),y.size=y.content.length,delete w[46];var O=Yt(w[4][0].data);{O[7][0].data=or(n.e.r+1);var Y=Yt(O[1][0].data),B=bi(Y[2][0].data);y=Xe.find(c,a[B].location),b=xo(bo(y.content));{if(b[0].id!=B)throw"Bad HeaderStorageBucket";var ie=Yt(b[0].messages[0].data);for(A=0;A<s.length;++A){var ue=Yt(ie[2][0].data);ue[1][0].data=or(A),ue[4][0].data=or(s[A].length),ie[2][A]={type:ie[2][0].type,data:ii(ue)}}b[0].messages[0].data=ii(ie)}y.content=dg(fg(b)),y.size=y.content.length;var he=bi(O[2][0].data);y=Xe.find(c,a[he].location),b=xo(bo(y.content));{if(b[0].id!=he)throw"Bad HeaderStorageBucket";for(ie=Yt(b[0].messages[0].data),x=0;x<=n.e.c;++x)ue=Yt(ie[2][0].data),ue[1][0].data=or(x),ue[4][0].data=or(n.e.r+1),ie[2][x]={type:ie[2][0].type,data:ii(ue)};b[0].messages[0].data=ii(ie)}y.content=dg(fg(b)),y.size=y.content.length;var Ee=bi(O[4][0].data);(function(){for(var C=Xe.find(c,a[Ee].location),S=xo(bo(C.content)),_,D=0;D<S.length;++D){var U=S[D];U.id==Ee&&(_=U)}var X=Yt(_.messages[0].data);{X[3]=[];var ee=[];o.forEach(function(R,W){ee[1]=[{type:0,data:or(W)}],ee[2]=[{type:0,data:or(1)}],ee[3]=[{type:2,data:CCe(R)}],X[3].push({type:2,data:ii(ee)})})}_.messages[0].data=ii(X);var k=fg(S),M=dg(k);C.content=M,C.size=C.content.length})();var Ce=Yt(O[3][0].data);{var ge=Ce[1][0];delete Ce[2];var Q=Yt(ge.data);{var ye=bi(Q[2][0].data);(function(){for(var C=Xe.find(c,a[ye].location),S=xo(bo(C.content)),_,D=0;D<S.length;++D){var U=S[D];U.id==ye&&(_=U)}var X=Yt(_.messages[0].data);{delete X[6],delete Ce[7];var ee=new Uint8Array(X[5][0].data);X[5]=[];for(var k=0,M=0;M<=n.e.r;++M){var R=Yt(ee);k+=NCe(R,s[M],o),R[1][0].data=or(M),X[5].push({data:ii(R),type:2})}X[1]=[{type:0,data:or(n.e.c+1)}],X[2]=[{type:0,data:or(n.e.r+1)}],X[3]=[{type:0,data:or(k)}],X[4]=[{type:0,data:or(n.e.r+1)}]}_.messages[0].data=ii(X);var W=fg(S),q=dg(W);C.content=q,C.size=C.content.length})()}ge.data=ii(Q)}O[3][0].data=ii(Ce)}w[4][0].data=ii(O)}d.messages[0].data=ii(w);var Re=fg(f),j=dg(Re);return h.content=j,h.size=h.content.length,c}function OY(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function TD(t){OY([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function kD(t){OY([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function FCe(t){return Et.WS.indexOf(t)>-1?"sheet":t==Et.CS?"chart":t==Et.DS?"dialog":t==Et.MS?"macro":t&&t.length?t:"sheet"}function HCe(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,FCe(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function LCe(t,e,r,n,i,s,o,a,l,c,u,h){try{s[n]=qv(Js(t,r,!0),e);var f=En(t,e),d;switch(a){case"sheet":d=u1e(f,e,i,l,s[n],c,u,h);break;case"chart":if(d=h1e(f,e,i,l,s[n],c,u,h),!d||!d["!drawel"])break;var g=Tv(d["!drawel"].Target,e),m=iy(g),p=Qpe(Js(t,g,!0),qv(Js(t,m,!0),g)),w=Tv(p,g),v=iy(w);d=$ye(Js(t,w,!0),w,l,qv(Js(t,v,!0),w),c,d);break;case"macro":d=f1e(f,e,i,l,s[n],c,u,h);break;case"dialog":d=d1e(f,e,i,l,s[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=d;var y=[];s&&s[n]&&ln(s[n]).forEach(function(b){var T="";if(s[n][b].Type==Et.CMNT){T=Tv(s[n][b].Target,e);var E=v1e(En(t,T,!0),T,l);if(!E||!E.length)return;NB(d,E,!1)}s[n][b].Type==Et.TCMNT&&(T=Tv(s[n][b].Target,e),y=y.concat(e0e(En(t,T,!0),l)))}),y&&y.length&&NB(d,y,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function go(t){return t.charAt(0)=="/"?t.slice(1):t}function MY(t,e){if(Fp(),e=e||{},TD(e),Eo(t,"META-INF/manifest.xml")||Eo(t,"objectdata.xml"))return zB(t,e);if(Eo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof pk<"u"){if(t.FileIndex)return pk(t);var r=Xe.utils.cfb_new();return tB(t).forEach(function(ue){mt(r,ue,tfe(t,ue))}),pk(r)}throw new Error("Unsupported NUMBERS file")}if(!Eo(t,"[Content_Types].xml"))throw Eo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Eo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=tB(t),i=Kfe(Js(t,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",En(t,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!En(t,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Jv=[],i.sst)try{Jv=p1e(En(t,go(i.sst)),i.sst,e)}catch(ue){if(e.WTF)throw ue}e.cellStyles&&i.themes.length&&(l=m1e(Js(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=g1e(En(t,go(i.style)),i.style,l,e))}i.links.map(function(ue){try{var he=qv(Js(t,iy(go(ue))),ue);return y1e(En(t,go(ue)),he,ue,e)}catch{}});var u=c1e(En(t,go(i.workbooks[0])),i.workbooks[0],e),h={},f="";i.coreprops.length&&(f=En(t,go(i.coreprops[0]),!0),f&&(h=pG(f)),i.extprops.length!==0&&(f=En(t,go(i.extprops[0]),!0),f&&tde(f,h,e)));var d={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(f=Js(t,go(i.custprops[0]),!0),f&&(d=nde(f,e)));var g={};if((e.bookSheets||e.bookProps)&&(u.Sheets?o=u.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),e.bookProps&&(g.Props=h,g.Custprops=d),e.bookSheets&&typeof o<"u"&&(g.SheetNames=o),e.bookSheets?g.SheetNames:e.bookProps))return g;o={};var m={};e.bookDeps&&i.calcchain&&(m=w1e(En(t,go(i.calcchain)),i.calcchain));var p=0,w={},v,y;{var b=u.Sheets;h.Worksheets=b.length,h.SheetNames=[];for(var T=0;T!=b.length;++T)h.SheetNames[T]=b[T].name}var E=s?"bin":"xml",x=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,x+1)+"_rels/"+i.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");Eo(t,P)||(P="xl/_rels/workbook."+E+".rels");var A=qv(Js(t,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=C1e(En(t,go(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=r0e(En(t,go(i.people[0])),e)),A&&(A=HCe(A,u.Sheets));var O=En(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(p=0;p!=h.Worksheets;++p){var Y="sheet";if(A&&A[p]?(v="xl/"+A[p][1].replace(/[\/]?xl\//,""),Eo(t,v)||(v=A[p][1]),Eo(t,v)||(v=P.replace(/_rels\/.*$/,"")+A[p][1]),Y=A[p][2]):(v="xl/worksheets/sheet"+(p+1-O)+"."+E,v=v.replace(/sheet0\./,"sheet.")),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(p!=e.sheets)continue e;break;case"string":if(h.SheetNames[p].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var B=!1,ie=0;ie!=e.sheets.length;++ie)typeof e.sheets[ie]=="number"&&e.sheets[ie]==p&&(B=1),typeof e.sheets[ie]=="string"&&e.sheets[ie].toLowerCase()==h.SheetNames[p].toLowerCase()&&(B=1);if(!B)continue e}}LCe(t,v,y,h.SheetNames[p],p,w,o,Y,e,u,l,c)}return g={Directory:i,Workbook:u,Props:h,Custprops:d,Deps:m,Sheets:o,SheetNames:h.SheetNames,Strings:Jv,Styles:c,Themes:l,SSF:vr(nt)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(ue,he){ue=ue.replace(/^Root Entry[\/]/,""),g.keys.push(ue),g.files[ue]=t.FileIndex[he]}))),e&&e.bookVBA&&(i.vba.length>0?g.vbaraw=En(t,go(i.vba[0]),!0):i.defaults&&i.defaults.bin===u0e&&(g.vbaraw=En(t,"xl/vbaProject.bin",!0))),g}function $Ce(t,e){var r=e||{},n="Workbook",i=Xe.find(t,n);try{if(n="/!DataSpaces/Version",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Sme(i.content),n="/!DataSpaces/DataSpaceMap",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=bme(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=_me(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Rme(i.content)}catch{}if(n="/EncryptionInfo",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Tme(i.content);if(n="/EncryptedPackage",i=Xe.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function BCe(t,e){return e.bookType=="ods"?IY(t,e):e.bookType=="numbers"?DCe(t,e):e.bookType=="xlsb"?VCe(t,e):NY(t,e)}function VCe(t,e){Am=1024,t&&!t.SSF&&(t.SSF=vr(nt)),t&&t.SSF&&(Fp(),Zy(t.SSF),e.revssf=nR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Qv?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=tY.indexOf(e.bookType)>-1,i=fD();kD(e=e||{});var s=KN(),o="",a=0;if(e.cellXfs=[],$h(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",mt(s,o,vG(t.Props,e)),i.coreprops.push(o),ar(e.rels,2,o,Et.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,mt(s,o,CG(t.Props)),i.extprops.push(o),ar(e.rels,3,o,Et.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(s,o,SG(t.Custprops)),i.custprops.push(o),ar(e.rels,4,o,Et.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var u={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,mt(s,o,x1e(a-1,o,e,t,u)),i.sheets.push(o),ar(e.wbrels,-1,"worksheets/sheet"+a+"."+r,Et.WS[0])}if(h){var d=h["!comments"],g=!1,m="";d&&d.length>0&&(m="xl/comments"+a+"."+r,mt(s,m,E1e(d,m)),i.comments.push(m),ar(u,-1,"../comments"+a+"."+r,Et.CMNT),g=!0),h["!legacy"]&&g&&mt(s,"xl/drawings/vmlDrawing"+a+".vml",ZG(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&mt(s,iy(o),Gm(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,mt(s,o,_1e(e.Strings,o,e)),i.strs.push(o),ar(e.wbrels,-1,"sharedStrings."+r,Et.SST)),o="xl/workbook."+r,mt(s,o,S1e(t,o)),i.workbooks.push(o),ar(e.rels,1,o,Et.WB),o="xl/theme/theme1.xml",mt(s,o,wD(t.Themes,e)),i.themes.push(o),ar(e.wbrels,-1,"theme/theme1.xml",Et.THEME),o="xl/styles."+r,mt(s,o,b1e(t,o,e)),i.styles.push(o),ar(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",mt(s,o,t.vbaraw),i.vba.push(o),ar(e.wbrels,-1,"vbaProject.bin",Et.VBA)),o="xl/metadata."+r,mt(s,o,R1e(o)),i.metadata.push(o),ar(e.wbrels,-1,"metadata."+r,Et.XLMETA),mt(s,"[Content_Types].xml",gG(i,e)),mt(s,"_rels/.rels",Gm(e.rels)),mt(s,"xl/_rels/workbook."+r+".rels",Gm(e.wbrels)),delete e.revssf,delete e.ssf,s}function NY(t,e){Am=1024,t&&!t.SSF&&(t.SSF=vr(nt)),t&&t.SSF&&(Fp(),Zy(t.SSF),e.revssf=nR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Qv?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=tY.indexOf(e.bookType)>-1,i=fD();kD(e=e||{});var s=KN(),o="",a=0;if(e.cellXfs=[],$h(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",mt(s,o,vG(t.Props,e)),i.coreprops.push(o),ar(e.rels,2,o,Et.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,mt(s,o,CG(t.Props)),i.extprops.push(o),ar(e.rels,3,o,Et.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(s,o,SG(t.Custprops)),i.custprops.push(o),ar(e.rels,4,o,Et.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var h={"!id":{}},f=t.Sheets[t.SheetNames[a-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,mt(s,o,fY(a-1,e,t,h)),i.sheets.push(o),ar(e.wbrels,-1,"worksheets/sheet"+a+"."+r,Et.WS[0])}if(f){var g=f["!comments"],m=!1,p="";if(g&&g.length>0){var w=!1;g.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(w=!0)})}),w&&(p="xl/threadedComments/threadedComment"+a+"."+r,mt(s,p,t0e(g,u,e)),i.threadedcomments.push(p),ar(h,-1,"../threadedComments/threadedComment"+a+"."+r,Et.TCMNT)),p="xl/comments"+a+"."+r,mt(s,p,eY(g)),i.comments.push(p),ar(h,-1,"../comments"+a+"."+r,Et.CMNT),m=!0}f["!legacy"]&&m&&mt(s,"xl/drawings/vmlDrawing"+a+".vml",ZG(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&mt(s,iy(o),Gm(h))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,mt(s,o,VG(e.Strings,e)),i.strs.push(o),ar(e.wbrels,-1,"sharedStrings."+r,Et.SST)),o="xl/workbook."+r,mt(s,o,wY(t)),i.workbooks.push(o),ar(e.rels,1,o,Et.WB),o="xl/theme/theme1.xml",mt(s,o,wD(t.Themes,e)),i.themes.push(o),ar(e.wbrels,-1,"theme/theme1.xml",Et.THEME),o="xl/styles."+r,mt(s,o,XG(t,e)),i.styles.push(o),ar(e.wbrels,-1,"styles."+r,Et.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",mt(s,o,t.vbaraw),i.vba.push(o),ar(e.wbrels,-1,"vbaProject.bin",Et.VBA)),o="xl/metadata."+r,mt(s,o,QG()),i.metadata.push(o),ar(e.wbrels,-1,"metadata."+r,Et.XLMETA),u.length>1&&(o="xl/persons/person.xml",mt(s,o,n0e(u)),i.people.push(o),ar(e.wbrels,-1,"persons/person.xml",Et.PEOPLE)),mt(s,"[Content_Types].xml",gG(i,e)),mt(s,"_rels/.rels",Gm(e.rels)),mt(s,"xl/_rels/workbook."+r+".rels",Gm(e.wbrels)),delete e.revssf,delete e.ssf,s}function PD(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ao(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function WCe(t,e){return Xe.find(t,"EncryptedPackage")?$Ce(t,e):ED(t,e)}function jCe(t,e){var r,n=t,i=e||{};return i.type||(i.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),r=Y7(n,i),MY(r,i)}function DY(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return tM(t.slice(r),e);default:break e}return pp.to_workbook(t,e)}function UCe(t,e){var r="",n=PD(t,e);switch(e.type){case"base64":r=ao(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Rd(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=fr(r)),e.type="binary",DY(r,e)}function zCe(t,e){var r=t;return e.type=="base64"&&(r=ao(r)),r=Lt.utils.decode(1200,r.slice(2),"str"),e.type="binary",DY(r,e)}function GCe(t){return t.match(/[^\x00-\x7F]/)?Al(t):t}function vk(t,e,r,n){return n?(r.type="string",pp.to_workbook(t,r)):pp.to_workbook(e,r)}function hy(t,e){tR();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return hy(new Uint8Array(t),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Km={},r.dateNF&&(Km.dateNF=r.dateNF),r.type||(r.type=bt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=bt?"buffer":"binary",n=Yhe(t),typeof Uint8Array<"u"&&!bt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=GCe(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=vr(r),r.type="array",hy(UN(n),r)}switch((i=PD(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return WCe(Xe.read(n,r),r);break;case 9:if(i[1]<=8)return ED(n,r);break;case 60:return tM(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return ime(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return $G.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?jCe(n,r):vk(t,n,r,s);case 239:return i[3]===60?tM(n,r):vk(t,n,r,s);case 255:if(i[1]===254)return zCe(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return ud.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return ud.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return eM.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return GG.to_workbook(n,r);break;case 10:case 13:case 32:return UCe(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return nme.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?eM.to_workbook(n,r):vk(t,n,r,s)}function qB(t,e){var r=e||{};return r.type="file",hy(t,r)}function FY(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return e1(e.file,Xe.write(t,{type:bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Xe.write(t,e)}function YCe(t,e){var r=vr(e||{}),n=BCe(t,r);return HY(n,r)}function KCe(t,e){var r=vr(e||{}),n=NY(t,r);return HY(n,r)}function HY(t,e){var r={},n=bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Xe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Qy(i))}return e.password&&typeof encrypt_agile<"u"?FY(encrypt_agile(i,e.password),e):e.type==="file"?e1(e.file,i):e.type=="string"?fr(i):i}function XCe(t,e){var r=e||{},n=Q1e(t,r);return FY(n,r)}function gl(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Zw(Al(n));case"binary":return Al(n);case"string":return t;case"file":return e1(e.file,n,"utf8");case"buffer":return bt?ru(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):gl(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function qCe(t,e){switch(e.type){case"base64":return Zw(t);case"binary":return t;case"string":return t;case"file":return e1(e.file,t,"binary");case"buffer":return bt?ru(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function CC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Zw(r):e.type=="string"?fr(r):r;case"file":return e1(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function AD(t,e){tR(),vY(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=AD(t,r);return r.type="array",Qy(n)}return KCe(t,r)}function uR(t,e){tR(),vY(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=uR(t,r);return r.type="array",Qy(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return gl(z1e(t,r),r);case"slk":case"sylk":return gl(LG.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return gl(TY(t.Sheets[t.SheetNames[i]],r),r);case"txt":return qCe(BY(t.Sheets[t.SheetNames[i]],r),r);case"csv":return gl(OD(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return gl($G.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return CC(eM.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return gl(pp.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return gl(GG.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return gl(BG.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return gl(IY(t,r),r);case"wk1":return CC(ud.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return CC(ud.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),CC(xY(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),XCe(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return YCe(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ID(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function a_(t,e,r){var n=r||{};return n.type="file",n.file=e,ID(n),uR(t,n)}function JCe(t,e,r){var n=r||{};return n.type="file",n.file=e,ID(n),AD(t,n)}function QCe(t,e,r,n){var i=r||{};i.type="file",i.file=t,ID(i),i.type="buffer";var s=n;return s instanceof Function||(s=r),eh.writeFile(t,uR(e,i),s)}function LY(t,e,r,n,i,s,o,a){var l=sn(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!o||t[r])for(var d=e.s.c;d<=e.e.c;++d){var g=o?t[r][d]:t[n[d]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[d]!=null&&(f[s[d]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[d]!=null){if(m==null)if(g.t=="e"&&m===null)f[s[d]]=null;else if(c!==void 0)f[s[d]]=c;else if(u&&m===null)f[s[d]]=null;else continue;else f[s[d]]=u&&(g.t!=="n"||g.t==="n"&&a.rawNumbers!==!1)?m:Hl(g,m,a);m!=null&&(h=!1)}}return{row:f,isempty:h}}function l_(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Ot(u);break;case"number":l=Ot(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=sn(l.s.r),f=[],d=[],g=0,m=0,p=Array.isArray(t),w=l.s.r,v=0,y={};p&&!t[w]&&(t[w]=[]);var b=c.skipHidden&&t["!cols"]||[],T=c.skipHidden&&t["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(b[v]||{}).hidden)switch(f[v]=kr(v),r=p?t[w][v]:t[f[v]+h],n){case 1:s[v]=v-l.s.c;break;case 2:s[v]=f[v];break;case 3:s[v]=c.header[v-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=Hl(r,null,c),m=y[o]||0,!m)y[o]=1;else{do a=o+"_"+m++;while(y[a]);y[o]=m,y[a]=1}s[v]=a}for(w=l.s.r+i;w<=l.e.r;++w)if(!(T[w]||{}).hidden){var E=LY(t,l,w,f,n,s,p,c);(E.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[g++]=E.row)}return d.length=g,d}var JB=/"/g;function $Y(t,e,r,n,i,s,o,a){for(var l=!0,c=[],u="",h=sn(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var d=a.dense?(t[r]||[])[f]:t[n[f]+h];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(a.rawNumbers&&d.t=="n"?d.v:Hl(d,null,a));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===i||m===s||m===34||a.forceQuotes){u='"'+u.replace(JB,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(JB,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function OD(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Ot(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],d=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(f[g]||{}).hidden||(h[g]=kr(g));for(var m=0,p=i.s.r;p<=i.e.r;++p)(d[p]||{}).hidden||(u=$Y(t,i,p,h,o,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?a:"")+u)));return delete n.dense,r.join("")}function BY(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=OD(t,e);if(typeof Lt>"u"||e.type=="string")return r;var n=Lt.utils.encode(1200,r,"str");return"ÿþ"+n}function ZCe(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Ot(t["!ref"]),s="",o=[],a,l=[],c=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=kr(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=sn(u),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,r=c?(t[u]||[])[a]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function VY(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=Ot(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+e.length-1+i)}else o==-1&&(o=0,u.e.r=e.length-1+i);var f=n.header||[],d=0;e.forEach(function(m,p){ln(m).forEach(function(w){(d=f.indexOf(w))==-1&&(f[d=f.length]=w);var v=m[w],y="z",b="",T=it({c:a+d,r:o+p+i});c=fy(s,T),v&&typeof v=="object"&&!(v instanceof Date)?s[T]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",n.cellDates||(y="n",v=jn(v)),b=n.dateNF||nt[14]):v===null&&n.nullError&&(y="e",v=0),c?(c.t=y,c.v=v,delete c.w,delete c.R,b&&(c.z=b)):s[T]=c={t:y,v},b&&(c.z=b))})}),u.e.c=Math.max(u.e.c,a+f.length-1);var g=sn(o);if(i)for(d=0;d<f.length;++d)s[kr(d+a)+g]={t:"s",v:f[d]};return s["!ref"]=gt(u),s}function eSe(t,e){return VY(null,t,e)}function fy(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=zr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?fy(t,it(e)):fy(t,it({r:e,c:r||0}))}function tSe(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function MD(){return{SheetNames:[],Sheets:{}}}function ND(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(pY(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function rSe(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=tSe(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function nSe(t,e){return t.z=e,t}function WY(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function iSe(t,e,r){return WY(t,"#"+e,r)}function sSe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function oSe(t,e,r,n){for(var i=typeof e!="string"?e:Ot(e),s=typeof e=="string"?e:gt(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=fy(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var th={encode_col:kr,encode_row:sn,encode_cell:it,encode_range:gt,decode_col:oD,decode_row:sD,split_cell:Efe,decode_cell:zr,decode_range:es,format_cell:Hl,sheet_add_aoa:aG,sheet_add_json:VY,sheet_add_dom:kY,aoa_to_sheet:Lp,json_to_sheet:eSe,table_to_sheet:PY,table_to_book:pCe,sheet_to_csv:OD,sheet_to_txt:BY,sheet_to_json:l_,sheet_to_html:TY,sheet_to_formulae:ZCe,sheet_to_row_object_array:l_,sheet_get_cell:fy,book_new:MD,book_append_sheet:ND,book_set_sheet_visibility:rSe,cell_set_number_format:nSe,cell_set_hyperlink:WY,cell_set_internal_link:iSe,cell_add_comment:sSe,sheet_set_array_formula:oSe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},hR;function aSe(t){hR=t}function lSe(t,e){var r=hR(),n=e??{};if(t==null||t["!ref"]==null)return r.push(null),r;var i=Ot(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],d=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(f[g]||{}).hidden||(h[g]=kr(g));var m=i.s.r,p=!1,w=0;return r._read=function(){if(!p)return p=!0,r.push("\uFEFF");for(;m<=i.e.r;)if(++m,!(d[m-1]||{}).hidden&&(u=$Y(t,i,m-1,h,o,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),u||n.blankrows!==!1)))return r.push((w++?a:"")+u);return r.push(null)},r}function cSe(t,e){var r=hR(),n=e||{},i=n.header!=null?n.header:_Y,s=n.footer!=null?n.footer:EY;r.push(i);var o=es(t["!ref"]);n.dense=Array.isArray(t),r.push(RY(t,o,n));var a=o.s.r,l=!1;return r._read=function(){if(a>o.e.r)return l||(l=!0,r.push("</table>"+s)),r.push(null);for(;a<=o.e.r;){r.push(bY(t,o,a,n)),++a;break}},r}function uSe(t,e){var r=hR({objectMode:!0});if(t==null||t["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},i=0,s=1,o=[],a=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},h=u.range!=null?u.range:t["!ref"];switch(u.header===1?i=1:u.header==="A"?i=2:Array.isArray(u.header)&&(i=3),typeof h){case"string":c=Ot(h);break;case"number":c=Ot(t["!ref"]),c.s.r=h;break;default:c=h}i>0&&(s=0);var f=sn(c.s.r),d=[],g=0,m=Array.isArray(t),p=c.s.r,w=0,v={};m&&!t[p]&&(t[p]=[]);var y=u.skipHidden&&t["!cols"]||[],b=u.skipHidden&&t["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(y[w]||{}).hidden)switch(d[w]=kr(w),n=m?t[p][w]:t[d[w]+f],i){case 1:o[w]=w-c.s.c;break;case 2:o[w]=d[w];break;case 3:o[w]=u.header[w-c.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=a=Hl(n,null,u),g=v[a]||0,!g)v[a]=1;else{do l=a+"_"+g++;while(v[l]);v[a]=g,v[l]=1}o[w]=l}return p=c.s.r+s,r._read=function(){for(;p<=c.e.r;)if(!(b[p-1]||{}).hidden){var T=LY(t,c,p,d,i,o,m,u);if(++p,T.isempty===!1||(i===1?u.blankrows!==!1:u.blankrows)){r.push(T.row);return}}return r.push(null)},r}var hSe={to_json:uSe,to_html:cSe,to_csv:lSe,set_readable:aSe};const fSe=Qw.version,dSe=Object.freeze(Object.defineProperty({__proto__:null,CFB:Xe,SSF:V7,parse_xlscfb:ED,parse_zip:MY,read:hy,readFile:qB,readFileSync:qB,set_cptable:phe,set_fs:zhe,stream:hSe,utils:th,version:fSe,write:uR,writeFile:a_,writeFileAsync:QCe,writeFileSync:a_,writeFileXLSX:JCe,writeXLSX:AD},Symbol.toStringTag,{value:"Module"}));var g0=function(t){return t&&t.Math===Math&&t},vn=g0(typeof globalThis=="object"&&globalThis)||g0(typeof window=="object"&&window)||g0(typeof self=="object"&&self)||g0(typeof V1=="object"&&V1)||g0(typeof V1=="object"&&V1)||function(){return this}()||Function("return this")(),DD={},On=function(t){try{return!!t()}catch{return!0}},gSe=On,Ko=!gSe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),mSe=On,fR=!mSe(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),pSe=fR,SC=Function.prototype.call,Mn=pSe?SC.bind(SC):function(){return SC.apply(SC,arguments)},jY={},UY={}.propertyIsEnumerable,zY=Object.getOwnPropertyDescriptor,vSe=zY&&!UY.call({1:2},1);jY.f=vSe?function(e){var r=zY(this,e);return!!r&&r.enumerable}:UY;var dR=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},GY=fR,YY=Function.prototype,iM=YY.call,wSe=GY&&YY.bind.bind(iM,iM),wn=GY?wSe:function(t){return function(){return iM.apply(t,arguments)}},KY=wn,ySe=KY({}.toString),CSe=KY("".slice),Qd=function(t){return CSe(ySe(t),8,-1)},SSe=wn,xSe=On,bSe=Qd,wk=Object,_Se=SSe("".split),ESe=xSe(function(){return!wk("z").propertyIsEnumerable(0)})?function(t){return bSe(t)==="String"?_Se(t,""):wk(t)}:wk,FD=function(t){return t==null},RSe=FD,TSe=TypeError,a1=function(t){if(RSe(t))throw new TSe("Can't call method on "+t);return t},kSe=ESe,PSe=a1,l1=function(t){return kSe(PSe(t))},yk=typeof document=="object"&&document.all,Nn=typeof yk>"u"&&yk!==void 0?function(t){return typeof t=="function"||t===yk}:function(t){return typeof t=="function"},ASe=Nn,Xo=function(t){return typeof t=="object"?t!==null:ASe(t)},Ck=vn,ISe=Nn,OSe=function(t){return ISe(t)?t:void 0},Bp=function(t,e){return arguments.length<2?OSe(Ck[t]):Ck[t]&&Ck[t][e]},MSe=wn,c1=MSe({}.isPrototypeOf),NSe=vn,QB=NSe.navigator,ZB=QB&&QB.userAgent,gR=ZB?String(ZB):"",XY=vn,Sk=gR,eV=XY.process,tV=XY.Deno,rV=eV&&eV.versions||tV&&tV.version,nV=rV&&rV.v8,_a,c_;nV&&(_a=nV.split("."),c_=_a[0]>0&&_a[0]<4?1:+(_a[0]+_a[1]));!c_&&Sk&&(_a=Sk.match(/Edge\/(\d+)/),(!_a||_a[1]>=74)&&(_a=Sk.match(/Chrome\/(\d+)/),_a&&(c_=+_a[1])));var DSe=c_,iV=DSe,FSe=On,HSe=vn,LSe=HSe.String,HD=!!Object.getOwnPropertySymbols&&!FSe(function(){var t=Symbol("symbol detection");return!LSe(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&iV&&iV<41}),$Se=HD,qY=$Se&&!Symbol.sham&&typeof Symbol.iterator=="symbol",BSe=Bp,VSe=Nn,WSe=c1,jSe=qY,USe=Object,LD=jSe?function(t){return typeof t=="symbol"}:function(t){var e=BSe("Symbol");return VSe(e)&&WSe(e.prototype,USe(t))},zSe=String,mR=function(t){try{return zSe(t)}catch{return"Object"}},GSe=Nn,YSe=mR,KSe=TypeError,Os=function(t){if(GSe(t))return t;throw new KSe(YSe(t)+" is not a function")},XSe=Os,qSe=FD,u1=function(t,e){var r=t[e];return qSe(r)?void 0:XSe(r)},xk=Mn,bk=Nn,_k=Xo,JSe=TypeError,QSe=function(t,e){var r,n;if(e==="string"&&bk(r=t.toString)&&!_k(n=xk(r,t))||bk(r=t.valueOf)&&!_k(n=xk(r,t))||e!=="string"&&bk(r=t.toString)&&!_k(n=xk(r,t)))return n;throw new JSe("Can't convert object to primitive value")},JY={exports:{}},sV=vn,ZSe=Object.defineProperty,$D=function(t,e){try{ZSe(sV,t,{value:e,configurable:!0,writable:!0})}catch{sV[t]=e}return e},exe=vn,txe=$D,oV="__core-js_shared__",aV=JY.exports=exe[oV]||txe(oV,{});(aV.versions||(aV.versions=[])).push({version:"3.45.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"});var BD=JY.exports,lV=BD,QY=function(t,e){return lV[t]||(lV[t]=e||{})},rxe=a1,nxe=Object,Vp=function(t){return nxe(rxe(t))},ixe=wn,sxe=Vp,oxe=ixe({}.hasOwnProperty),qo=Object.hasOwn||function(e,r){return oxe(sxe(e),r)},axe=wn,lxe=0,cxe=Math.random(),uxe=axe(1.1.toString),ZY=function(t){return"Symbol("+(t===void 0?"":t)+")_"+uxe(++lxe+cxe,36)},hxe=vn,fxe=QY,cV=qo,dxe=ZY,gxe=HD,mxe=qY,Im=hxe.Symbol,Ek=fxe("wks"),pxe=mxe?Im.for||Im:Im&&Im.withoutSetter||dxe,Wa=function(t){return cV(Ek,t)||(Ek[t]=gxe&&cV(Im,t)?Im[t]:pxe("Symbol."+t)),Ek[t]},vxe=Mn,uV=Xo,hV=LD,wxe=u1,yxe=QSe,Cxe=Wa,Sxe=TypeError,xxe=Cxe("toPrimitive"),bxe=function(t,e){if(!uV(t)||hV(t))return t;var r=wxe(t,xxe),n;if(r){if(e===void 0&&(e="default"),n=vxe(r,t,e),!uV(n)||hV(n))return n;throw new Sxe("Can't convert object to primitive value")}return e===void 0&&(e="number"),yxe(t,e)},_xe=bxe,Exe=LD,eK=function(t){var e=_xe(t,"string");return Exe(e)?e:e+""},Rxe=vn,fV=Xo,sM=Rxe.document,Txe=fV(sM)&&fV(sM.createElement),VD=function(t){return Txe?sM.createElement(t):{}},kxe=Ko,Pxe=On,Axe=VD,tK=!kxe&&!Pxe(function(){return Object.defineProperty(Axe("div"),"a",{get:function(){return 7}}).a!==7}),Ixe=Ko,Oxe=Mn,Mxe=jY,Nxe=dR,Dxe=l1,Fxe=eK,Hxe=qo,Lxe=tK,dV=Object.getOwnPropertyDescriptor;DD.f=Ixe?dV:function(e,r){if(e=Dxe(e),r=Fxe(r),Lxe)try{return dV(e,r)}catch{}if(Hxe(e,r))return Nxe(!Oxe(Mxe.f,e,r),e[r])};var su={},$xe=Ko,Bxe=On,rK=$xe&&Bxe(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Vxe=Xo,Wxe=String,jxe=TypeError,Dn=function(t){if(Vxe(t))return t;throw new jxe(Wxe(t)+" is not an object")},Uxe=Ko,zxe=tK,Gxe=rK,xC=Dn,gV=eK,Yxe=TypeError,Rk=Object.defineProperty,Kxe=Object.getOwnPropertyDescriptor,Tk="enumerable",kk="configurable",Pk="writable";su.f=Uxe?Gxe?function(e,r,n){if(xC(e),r=gV(r),xC(n),typeof e=="function"&&r==="prototype"&&"value"in n&&Pk in n&&!n[Pk]){var i=Kxe(e,r);i&&i[Pk]&&(e[r]=n.value,n={configurable:kk in n?n[kk]:i[kk],enumerable:Tk in n?n[Tk]:i[Tk],writable:!1})}return Rk(e,r,n)}:Rk:function(e,r,n){if(xC(e),r=gV(r),xC(n),zxe)try{return Rk(e,r,n)}catch{}if("get"in n||"set"in n)throw new Yxe("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var Xxe=Ko,qxe=su,Jxe=dR,Wp=Xxe?function(t,e,r){return qxe.f(t,e,Jxe(1,r))}:function(t,e,r){return t[e]=r,t},nK={exports:{}},oM=Ko,Qxe=qo,iK=Function.prototype,Zxe=oM&&Object.getOwnPropertyDescriptor,ebe=Qxe(iK,"name"),tbe=ebe&&(!oM||oM&&Zxe(iK,"name").configurable),rbe={CONFIGURABLE:tbe},nbe=wn,ibe=Nn,aM=BD,sbe=nbe(Function.toString);ibe(aM.inspectSource)||(aM.inspectSource=function(t){return sbe(t)});var obe=aM.inspectSource,abe=vn,lbe=Nn,mV=abe.WeakMap,cbe=lbe(mV)&&/native code/.test(String(mV)),ube=QY,hbe=ZY,pV=ube("keys"),WD=function(t){return pV[t]||(pV[t]=hbe(t))},jD={},fbe=cbe,sK=vn,dbe=Xo,gbe=Wp,Ak=qo,Ik=BD,mbe=WD,pbe=jD,vV="Object already initialized",lM=sK.TypeError,vbe=sK.WeakMap,u_,dy,h_,wbe=function(t){return h_(t)?dy(t):u_(t,{})},ybe=function(t){return function(e){var r;if(!dbe(e)||(r=dy(e)).type!==t)throw new lM("Incompatible receiver, "+t+" required");return r}};if(fbe||Ik.state){var qa=Ik.state||(Ik.state=new vbe);qa.get=qa.get,qa.has=qa.has,qa.set=qa.set,u_=function(t,e){if(qa.has(t))throw new lM(vV);return e.facade=t,qa.set(t,e),e},dy=function(t){return qa.get(t)||{}},h_=function(t){return qa.has(t)}}else{var gg=mbe("state");pbe[gg]=!0,u_=function(t,e){if(Ak(t,gg))throw new lM(vV);return e.facade=t,gbe(t,gg,e),e},dy=function(t){return Ak(t,gg)?t[gg]:{}},h_=function(t){return Ak(t,gg)}}var oK={set:u_,get:dy,has:h_,enforce:wbe,getterFor:ybe},UD=wn,Cbe=On,Sbe=Nn,bC=qo,cM=Ko,xbe=rbe.CONFIGURABLE,bbe=obe,aK=oK,_be=aK.enforce,Ebe=aK.get,wV=String,Hx=Object.defineProperty,Rbe=UD("".slice),Tbe=UD("".replace),kbe=UD([].join),Pbe=cM&&!Cbe(function(){return Hx(function(){},"length",{value:8}).length!==8}),Abe=String(String).split("String"),Ibe=nK.exports=function(t,e,r){Rbe(wV(e),0,7)==="Symbol("&&(e="["+Tbe(wV(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!bC(t,"name")||xbe&&t.name!==e)&&(cM?Hx(t,"name",{value:e,configurable:!0}):t.name=e),Pbe&&r&&bC(r,"arity")&&t.length!==r.arity&&Hx(t,"length",{value:r.arity});try{r&&bC(r,"constructor")&&r.constructor?cM&&Hx(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=_be(t);return bC(n,"source")||(n.source=kbe(Abe,typeof e=="string"?e:"")),t};Function.prototype.toString=Ibe(function(){return Sbe(this)&&Ebe(this).source||bbe(this)},"toString");var lK=nK.exports,Obe=Nn,Mbe=su,Nbe=lK,Dbe=$D,zD=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(Obe(r)&&Nbe(r,s,n),n.global)i?t[e]=r:Dbe(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:Mbe.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},cK={},Fbe=Math.ceil,Hbe=Math.floor,Lbe=Math.trunc||function(e){var r=+e;return(r>0?Hbe:Fbe)(r)},$be=Lbe,h1=function(t){var e=+t;return e!==e||e===0?0:$be(e)},Bbe=h1,Vbe=Math.max,Wbe=Math.min,jbe=function(t,e){var r=Bbe(t);return r<0?Vbe(r+e,0):Wbe(r,e)},Ube=h1,zbe=Math.min,Gbe=function(t){var e=Ube(t);return e>0?zbe(e,9007199254740991):0},Ybe=Gbe,jp=function(t){return Ybe(t.length)},Kbe=l1,Xbe=jbe,qbe=jp,Jbe=function(t){return function(e,r,n){var i=Kbe(e),s=qbe(i);if(s===0)return!t&&-1;var o=Xbe(n,s),a;if(t&&r!==r){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}},Qbe={indexOf:Jbe(!1)},Zbe=wn,Ok=qo,e_e=l1,t_e=Qbe.indexOf,r_e=jD,yV=Zbe([].push),uK=function(t,e){var r=e_e(t),n=0,i=[],s;for(s in r)!Ok(r_e,s)&&Ok(r,s)&&yV(i,s);for(;e.length>n;)Ok(r,s=e[n++])&&(~t_e(i,s)||yV(i,s));return i},GD=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],n_e=uK,i_e=GD,s_e=i_e.concat("length","prototype");cK.f=Object.getOwnPropertyNames||function(e){return n_e(e,s_e)};var hK={};hK.f=Object.getOwnPropertySymbols;var o_e=Bp,a_e=wn,l_e=cK,c_e=hK,u_e=Dn,h_e=a_e([].concat),f_e=o_e("Reflect","ownKeys")||function(e){var r=l_e.f(u_e(e)),n=c_e.f;return n?h_e(r,n(e)):r},CV=qo,d_e=f_e,g_e=DD,m_e=su,fK=function(t,e,r){for(var n=d_e(e),i=m_e.f,s=g_e.f,o=0;o<n.length;o++){var a=n[o];!CV(t,a)&&!(r&&CV(r,a))&&i(t,a,s(e,a))}},p_e=On,v_e=Nn,w_e=/#|\.prototype\./,f1=function(t,e){var r=C_e[y_e(t)];return r===x_e?!0:r===S_e?!1:v_e(e)?p_e(e):!!e},y_e=f1.normalize=function(t){return String(t).replace(w_e,".").toLowerCase()},C_e=f1.data={},S_e=f1.NATIVE="N",x_e=f1.POLYFILL="P",b_e=f1,_C=vn,__e=DD.f,E_e=Wp,R_e=zD,T_e=$D,k_e=fK,P_e=b_e,wr=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,a,l,c,u;if(n?o=_C:i?o=_C[r]||T_e(r,{}):o=_C[r]&&_C[r].prototype,o)for(a in e){if(c=e[a],t.dontCallGetSet?(u=__e(o,a),l=u&&u.value):l=o[a],s=P_e(n?a:r+(i?".":"#")+a,t.forced),!s&&l!==void 0){if(typeof c==typeof l)continue;k_e(c,l)}(t.sham||l&&l.sham)&&E_e(c,"sham",!0),R_e(o,a,c,t)}},A_e=fR,dK=Function.prototype,SV=dK.apply,xV=dK.call,d1=typeof Reflect=="object"&&Reflect.apply||(A_e?xV.bind(SV):function(){return xV.apply(SV,arguments)}),I_e=wn,O_e=Os,gK=function(t,e,r){try{return I_e(O_e(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},M_e=Xo,N_e=function(t){return M_e(t)||t===null},D_e=N_e,F_e=String,H_e=TypeError,L_e=function(t){if(D_e(t))return t;throw new H_e("Can't set "+F_e(t)+" as a prototype")},$_e=gK,B_e=Xo,V_e=a1,W_e=L_e,mK=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=$_e(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return V_e(i),W_e(s),B_e(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0),j_e=su.f,U_e=function(t,e,r){r in t||j_e(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},z_e=Nn,G_e=Xo,bV=mK,Y_e=function(t,e,r){var n,i;return bV&&z_e(n=e.constructor)&&n!==r&&G_e(i=n.prototype)&&i!==r.prototype&&bV(t,i),t},K_e=Wa,X_e=K_e("toStringTag"),pK={};pK[X_e]="z";var q_e=String(pK)==="[object z]",J_e=q_e,Q_e=Nn,Lx=Qd,Z_e=Wa,eEe=Z_e("toStringTag"),tEe=Object,rEe=Lx(function(){return arguments}())==="Arguments",nEe=function(t,e){try{return t[e]}catch{}},vK=J_e?Lx:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=nEe(e=tEe(t),eEe))=="string"?r:rEe?Lx(e):(n=Lx(e))==="Object"&&Q_e(e.callee)?"Arguments":n},iEe=vK,sEe=String,pR=function(t){if(iEe(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return sEe(t)},oEe=pR,aEe=function(t,e){return t===void 0?arguments.length<2?"":e:oEe(t)},lEe=Xo,cEe=Wp,uEe=function(t,e){lEe(e)&&"cause"in e&&cEe(t,"cause",e.cause)},hEe=wn,wK=Error,fEe=hEe("".replace),dEe=function(t){return String(new wK(t).stack)}("zxcasd"),yK=/\n\s*at [^:]*:[^\n]*/,gEe=yK.test(dEe),mEe=function(t,e){if(gEe&&typeof t=="string"&&!wK.prepareStackTrace)for(;e--;)t=fEe(t,yK,"");return t},pEe=On,vEe=dR,wEe=!pEe(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",vEe(1,7)),t.stack!==7):!0}),yEe=Wp,CEe=mEe,SEe=wEe,_V=Error.captureStackTrace,xEe=function(t,e,r,n){SEe&&(_V?_V(t,e):yEe(t,"stack",CEe(r,n)))},EV=Bp,bEe=qo,RV=Wp,_Ee=c1,TV=mK,kV=fK,PV=U_e,EEe=Y_e,REe=aEe,TEe=uEe,kEe=xEe,PEe=Ko,AEe=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),a=o[o.length-1],l=EV.apply(null,o);if(l){var c=l.prototype;if(bEe(c,"cause")&&delete c.cause,!r)return l;var u=EV("Error"),h=e(function(f,d){var g=REe(n?d:f,void 0),m=n?new l(f):new l;return g!==void 0&&RV(m,"message",g),kEe(m,h,m.stack,2),this&&_Ee(c,this)&&EEe(m,this,h),arguments.length>s&&TEe(m,arguments[s]),m});h.prototype=c,a!=="Error"?TV?TV(h,u):kV(h,u,{name:!0}):PEe&&i in l&&(PV(h,l,i),PV(h,l,"prepareStackTrace")),kV(h,l);try{c.name!==a&&RV(c,"name",a),c.constructor=h}catch{}return h}},CK=wr,IEe=vn,Wl=d1,SK=AEe,uM="WebAssembly",AV=IEe[uM],f_=new Error("e",{cause:7}).cause!==7,Zd=function(t,e){var r={};r[t]=SK(t,e,f_),CK({global:!0,constructor:!0,arity:1,forced:f_},r)},YD=function(t,e){if(AV&&AV[t]){var r={};r[t]=SK(uM+"."+t,e,f_),CK({target:uM,stat:!0,constructor:!0,arity:1,forced:f_},r)}};Zd("Error",function(t){return function(r){return Wl(t,this,arguments)}});Zd("EvalError",function(t){return function(r){return Wl(t,this,arguments)}});Zd("RangeError",function(t){return function(r){return Wl(t,this,arguments)}});Zd("ReferenceError",function(t){return function(r){return Wl(t,this,arguments)}});Zd("SyntaxError",function(t){return function(r){return Wl(t,this,arguments)}});Zd("TypeError",function(t){return function(r){return Wl(t,this,arguments)}});Zd("URIError",function(t){return function(r){return Wl(t,this,arguments)}});YD("CompileError",function(t){return function(r){return Wl(t,this,arguments)}});YD("LinkError",function(t){return function(r){return Wl(t,this,arguments)}});YD("RuntimeError",function(t){return function(r){return Wl(t,this,arguments)}});var OEe=Qd,xK=Array.isArray||function(e){return OEe(e)==="Array"},MEe=Ko,NEe=xK,DEe=TypeError,FEe=Object.getOwnPropertyDescriptor,HEe=MEe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),bK=HEe?function(t,e){if(NEe(t)&&!FEe(t,"length").writable)throw new DEe("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},LEe=TypeError,$Ee=9007199254740991,_K=function(t){if(t>$Ee)throw LEe("Maximum allowed index exceeded");return t},BEe=wr,VEe=Vp,WEe=jp,jEe=bK,UEe=_K,zEe=On,GEe=zEe(function(){return[].push.call({length:4294967296},1)!==4294967297}),YEe=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},KEe=GEe||!YEe();BEe({target:"Array",proto:!0,arity:1,forced:KEe},{push:function(e){var r=VEe(this),n=WEe(r),i=arguments.length;UEe(n+i);for(var s=0;s<i;s++)r[n]=arguments[s],n++;return jEe(r,n),n}});var XEe=Qd,qEe=wn,JEe=function(t){if(XEe(t)==="Function")return qEe(t)},IV=JEe,QEe=Os,ZEe=fR,eRe=IV(IV.bind),EK=function(t,e){return QEe(t),e===void 0?t:ZEe?eRe(t,e):function(){return t.apply(e,arguments)}},RK={},tRe=Wa,rRe=RK,nRe=tRe("iterator"),iRe=Array.prototype,sRe=function(t){return t!==void 0&&(rRe.Array===t||iRe[nRe]===t)},oRe=vK,OV=u1,aRe=FD,lRe=RK,cRe=Wa,uRe=cRe("iterator"),KD=function(t){if(!aRe(t))return OV(t,uRe)||OV(t,"@@iterator")||lRe[oRe(t)]},hRe=Mn,fRe=Os,dRe=Dn,gRe=mR,mRe=KD,pRe=TypeError,vRe=function(t,e){var r=arguments.length<2?mRe(t):e;if(fRe(r))return dRe(hRe(r,t));throw new pRe(gRe(t)+" is not iterable")},wRe=Mn,MV=Dn,yRe=u1,Ms=function(t,e,r){var n,i;MV(t);try{if(n=yRe(t,"return"),!n){if(e==="throw")throw r;return r}n=wRe(n,t)}catch(s){i=!0,n=s}if(e==="throw")throw r;if(i)throw n;return MV(n),r},CRe=EK,SRe=Mn,xRe=Dn,bRe=mR,_Re=sRe,ERe=jp,NV=c1,RRe=vRe,TRe=KD,DV=Ms,kRe=TypeError,$x=function(t,e){this.stopped=t,this.result=e},FV=$x.prototype,Up=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),l=CRe(e,n),c,u,h,f,d,g,m,p=function(v){return c&&DV(c,"normal"),new $x(!0,v)},w=function(v){return i?(xRe(v),a?l(v[0],v[1],p):l(v[0],v[1])):a?l(v,p):l(v)};if(s)c=t.iterator;else if(o)c=t;else{if(u=TRe(t),!u)throw new kRe(bRe(t)+" is not iterable");if(_Re(u)){for(h=0,f=ERe(t);f>h;h++)if(d=w(t[h]),d&&NV(FV,d))return d;return new $x(!1)}c=RRe(t,u)}for(g=s?t.next:c.next;!(m=SRe(g,c)).done;){try{d=w(m.value)}catch(v){DV(c,"throw",v)}if(typeof d=="object"&&d&&NV(FV,d))return d}return new $x(!1)},PRe=Ko,ARe=su,IRe=dR,TK=function(t,e,r){PRe?ARe.f(t,e,IRe(0,r)):t[e]=r},ORe=wr,MRe=Up,NRe=TK;ORe({target:"Object",stat:!0},{fromEntries:function(e){var r={};return MRe(e,function(n,i){NRe(r,n,i)},{AS_ENTRIES:!0}),r}});var Mk=wn,EC=Set.prototype,jl={Set,add:Mk(EC.add),has:Mk(EC.has),remove:Mk(EC.delete),proto:EC},DRe=jl.has,eg=function(t){return DRe(t),t},FRe=Mn,tg=function(t,e,r){for(var n=r?t:t.iterator,i=t.next,s,o;!(s=FRe(i,n)).done;)if(o=e(s.value),o!==void 0)return o},kK=wn,HRe=tg,PK=jl,LRe=PK.Set,AK=PK.proto,$Re=kK(AK.forEach),IK=kK(AK.keys),BRe=IK(new LRe).next,g1=function(t,e,r){return r?HRe({iterator:IK(t),next:BRe},e):$Re(t,e)},OK=jl,VRe=g1,WRe=OK.Set,jRe=OK.add,XD=function(t){var e=new WRe;return VRe(t,function(r){jRe(e,r)}),e},URe=gK,zRe=jl,m1=URe(zRe.proto,"size","get")||function(t){return t.size},Ul=function(t){return{iterator:t,next:t.next,done:!1}},HV=Os,MK=Dn,LV=Mn,GRe=h1,YRe=Ul,$V="Invalid size",KRe=RangeError,XRe=TypeError,qRe=Math.max,NK=function(t,e){this.set=t,this.size=qRe(e,0),this.has=HV(t.has),this.keys=HV(t.keys)};NK.prototype={getIterator:function(){return YRe(MK(LV(this.keys,this.set)))},includes:function(t){return LV(this.has,this.set,t)}};var rg=function(t){MK(t);var e=+t.size;if(e!==e)throw new XRe($V);var r=GRe(e);if(r<0)throw new KRe($V);return new NK(t,r)},JRe=eg,DK=jl,QRe=XD,ZRe=m1,eTe=rg,tTe=g1,rTe=tg,nTe=DK.has,BV=DK.remove,iTe=function(e){var r=JRe(this),n=eTe(e),i=QRe(r);return ZRe(r)<=n.size?tTe(r,function(s){n.includes(s)&&BV(i,s)}):rTe(n.getIterator(),function(s){nTe(i,s)&&BV(i,s)}),i},sTe=Bp,VV=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},WV=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},ng=function(t,e){var r=sTe("Set");try{new r()[t](VV(0));try{return new r()[t](VV(-1)),!1}catch{if(!e)return!0;try{return new r()[t](WV(-1/0)),!1}catch{var n=new r;return n.add(1),n.add(2),e(n[t](WV(1/0)))}}}catch{return!1}},oTe=wr,aTe=iTe,lTe=On,cTe=ng,uTe=!cTe("difference",function(t){return t.size===0}),hTe=uTe||lTe(function(){var t={size:1,has:function(){return!0},keys:function(){var r=0;return{next:function(){var n=r++>1;return e.has(1)&&e.clear(),{done:n,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(t).size!==3});oTe({target:"Set",proto:!0,real:!0,forced:hTe},{difference:aTe});var fTe=eg,qD=jl,dTe=m1,gTe=rg,mTe=g1,pTe=tg,vTe=qD.Set,jV=qD.add,wTe=qD.has,yTe=function(e){var r=fTe(this),n=gTe(e),i=new vTe;return dTe(r)>n.size?pTe(n.getIterator(),function(s){wTe(r,s)&&jV(i,s)}):mTe(r,function(s){n.includes(s)&&jV(i,s)}),i},CTe=wr,STe=On,xTe=yTe,bTe=ng,_Te=!bTe("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||STe(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});CTe({target:"Set",proto:!0,real:!0,forced:_Te},{intersection:xTe});var ETe=eg,RTe=jl.has,TTe=m1,kTe=rg,PTe=g1,ATe=tg,ITe=Ms,OTe=function(e){var r=ETe(this),n=kTe(e);if(TTe(r)<=n.size)return PTe(r,function(s){if(n.includes(s))return!1},!0)!==!1;var i=n.getIterator();return ATe(i,function(s){if(RTe(r,s))return ITe(i,"normal",!1)})!==!1},MTe=wr,NTe=OTe,DTe=ng,FTe=!DTe("isDisjointFrom",function(t){return!t});MTe({target:"Set",proto:!0,real:!0,forced:FTe},{isDisjointFrom:NTe});var HTe=eg,LTe=m1,$Te=g1,BTe=rg,VTe=function(e){var r=HTe(this),n=BTe(e);return LTe(r)>n.size?!1:$Te(r,function(i){if(!n.includes(i))return!1},!0)!==!1},WTe=wr,jTe=VTe,UTe=ng,zTe=!UTe("isSubsetOf",function(t){return t});WTe({target:"Set",proto:!0,real:!0,forced:zTe},{isSubsetOf:jTe});var GTe=eg,YTe=jl.has,KTe=m1,XTe=rg,qTe=tg,JTe=Ms,QTe=function(e){var r=GTe(this),n=XTe(e);if(KTe(r)<n.size)return!1;var i=n.getIterator();return qTe(i,function(s){if(!YTe(r,s))return JTe(i,"normal",!1)})!==!1},ZTe=wr,eke=QTe,tke=ng,rke=!tke("isSupersetOf",function(t){return!t});ZTe({target:"Set",proto:!0,real:!0,forced:rke},{isSupersetOf:eke});var nke=eg,JD=jl,ike=XD,ske=rg,oke=tg,ake=JD.add,lke=JD.has,cke=JD.remove,uke=function(e){var r=nke(this),n=ske(e).getIterator(),i=ike(r);return oke(n,function(s){lke(r,s)?cke(i,s):ake(i,s)}),i},FK=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size===1&&n.values().next().value===4}catch{return!1}},hke=wr,fke=uke,dke=FK,gke=ng,mke=!gke("symmetricDifference")||!dke("symmetricDifference");hke({target:"Set",proto:!0,real:!0,forced:mke},{symmetricDifference:fke});var pke=eg,vke=jl.add,wke=XD,yke=rg,Cke=tg,Ske=function(e){var r=pke(this),n=yke(e).getIterator(),i=wke(r);return Cke(n,function(s){vke(i,s)}),i},xke=wr,bke=Ske,_ke=FK,Eke=ng,Rke=!Eke("union")||!_ke("union");xke({target:"Set",proto:!0,real:!0,forced:Rke},{union:bke});var Tke=c1,kke=TypeError,Pke=function(t,e){if(Tke(e,t))return t;throw new kke("Incorrect invocation")},Ake=On,Ike=!Ake(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Oke=qo,Mke=Nn,Nke=Vp,Dke=WD,Fke=Ike,UV=Dke("IE_PROTO"),hM=Object,Hke=hM.prototype,HK=Fke?hM.getPrototypeOf:function(t){var e=Nke(t);if(Oke(e,UV))return e[UV];var r=e.constructor;return Mke(r)&&e instanceof r?r.prototype:e instanceof hM?Hke:null},zV=lK,Lke=su,$ke=function(t,e,r){return r.get&&zV(r.get,e,{getter:!0}),r.set&&zV(r.set,e,{setter:!0}),Lke.f(t,e,r)},LK={},Bke=uK,Vke=GD,Wke=Object.keys||function(e){return Bke(e,Vke)},jke=Ko,Uke=rK,zke=su,Gke=Dn,Yke=l1,Kke=Wke;LK.f=jke&&!Uke?Object.defineProperties:function(e,r){Gke(e);for(var n=Yke(r),i=Kke(r),s=i.length,o=0,a;s>o;)zke.f(e,a=i[o++],n[a]);return e};var Xke=Bp,$K=Xke("document","documentElement"),qke=Dn,Jke=LK,GV=GD,Qke=jD,Zke=$K,ePe=VD,tPe=WD,YV=">",KV="<",fM="prototype",dM="script",BK=tPe("IE_PROTO"),Nk=function(){},VK=function(t){return KV+dM+YV+t+KV+"/"+dM+YV},XV=function(t){t.write(VK("")),t.close();var e=t.parentWindow.Object;return t=null,e},rPe=function(){var t=ePe("iframe"),e="java"+dM+":",r;return t.style.display="none",Zke.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(VK("document.F=Object")),r.close(),r.F},RC,Bx=function(){try{RC=new ActiveXObject("htmlfile")}catch{}Bx=typeof document<"u"?document.domain&&RC?XV(RC):rPe():XV(RC);for(var t=GV.length;t--;)delete Bx[fM][GV[t]];return Bx()};Qke[BK]=!0;var WK=Object.create||function(e,r){var n;return e!==null?(Nk[fM]=qke(e),n=new Nk,Nk[fM]=null,n[BK]=e):n=Bx(),r===void 0?n:Jke.f(n,r)},nPe=On,iPe=Nn,sPe=Xo,qV=HK,oPe=zD,aPe=Wa,gM=aPe("iterator"),Id,Dk,Fk;[].keys&&(Fk=[].keys(),"next"in Fk&&(Dk=qV(qV(Fk)),Dk!==Object.prototype&&(Id=Dk)));var lPe=!sPe(Id)||nPe(function(){var t={};return Id[gM].call(t)!==t});lPe&&(Id={});iPe(Id[gM])||oPe(Id,gM,function(){return this});var jK={IteratorPrototype:Id},cPe=wr,uPe=vn,hPe=Pke,fPe=Dn,dPe=Nn,gPe=HK,mPe=$ke,pPe=TK,vPe=On,QD=qo,wPe=Wa,Dl=jK.IteratorPrototype,yPe=Ko,Hk="constructor",UK="Iterator",JV=wPe("toStringTag"),zK=TypeError,Lk=uPe[UK],GK=!dPe(Lk)||Lk.prototype!==Dl||!vPe(function(){Lk({})}),ZD=function(){if(hPe(this,Dl),gPe(this)===Dl)throw new zK("Abstract class Iterator not directly constructable")},YK=function(t,e){yPe?mPe(Dl,t,{configurable:!0,get:function(){return e},set:function(r){if(fPe(this),this===Dl)throw new zK("You can't redefine this property");QD(this,t)?this[t]=r:pPe(this,t,r)}}):Dl[t]=e};QD(Dl,JV)||YK(JV,UK);(GK||!QD(Dl,Hk)||Dl[Hk]===Object)&&YK(Hk,ZD);ZD.prototype=Dl;cPe({global:!0,constructor:!0,forced:GK},{Iterator:ZD});var CPe=zD,SPe=function(t,e,r){for(var n in e)CPe(t,n,e[n],r);return t},xPe=function(t,e){return{value:t,done:e}},bPe=Ms,_Pe=function(t,e,r){for(var n=t.length-1;n>=0;n--)if(t[n]!==void 0)try{r=bPe(t[n].iterator,e,r)}catch(i){e="throw",r=i}if(e==="throw")throw r;return r},EPe=Mn,RPe=WK,TPe=Wp,kPe=SPe,PPe=Wa,KK=oK,APe=u1,IPe=jK.IteratorPrototype,TC=xPe,kC=Ms,OPe=_Pe,MPe=PPe("toStringTag"),XK="IteratorHelper",qK="WrapForValidIterator",$k="normal",QV="throw",NPe=KK.set,JK=function(t){var e=KK.getterFor(t?qK:XK);return kPe(RPe(IPe),{next:function(){var n=e(this);if(t)return n.nextHandler();if(n.done)return TC(void 0,!0);try{var i=n.nextHandler();return n.returnHandlerResult?i:TC(i,n.done)}catch(s){throw n.done=!0,s}},return:function(){var r=e(this),n=r.iterator;if(r.done=!0,t){var i=APe(n,"return");return i?EPe(i,n):TC(void 0,!0)}if(r.inner)try{kC(r.inner.iterator,$k)}catch(s){return kC(n,QV,s)}if(r.openIters)try{OPe(r.openIters,$k)}catch(s){return kC(n,QV,s)}return n&&kC(n,$k),TC(void 0,!0)}})},DPe=JK(!0),QK=JK(!1);TPe(QK,MPe,"Iterator Helper");var eF=function(t,e,r){var n=function(s,o){o?(o.iterator=s.iterator,o.next=s.next):o=s,o.type=e?qK:XK,o.returnHandlerResult=!!r,o.nextHandler=t,o.counter=0,o.done=!1,NPe(this,o)};return n.prototype=e?DPe:QK,n},FPe=Dn,HPe=Ms,ZK=function(t,e,r,n){try{return n?e(FPe(r)[0],r[1]):e(r)}catch(i){HPe(t,"throw",i)}},tF=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}},LPe=vn,Bh=function(t,e){var r=LPe.Iterator,n=r&&r.prototype,i=n&&n[t],s=!1;if(i)try{i.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(o){o instanceof e||(s=!1)}if(!s)return i},$Pe=wr,eX=Mn,BPe=Os,tX=Dn,VPe=Ul,WPe=eF,jPe=ZK,UPe=Ms,zPe=tF,GPe=Bh,rX=!zPe("filter",function(){}),mM=!rX&&GPe("filter",TypeError),YPe=rX||mM,KPe=WPe(function(){for(var t=this.iterator,e=this.predicate,r=this.next,n,i,s;;){if(n=tX(eX(r,t)),i=this.done=!!n.done,i)return;if(s=n.value,jPe(t,e,[s,this.counter++],!0))return s}});$Pe({target:"Iterator",proto:!0,real:!0,forced:YPe},{filter:function(e){tX(this);try{BPe(e)}catch(r){UPe(this,"throw",r)}return mM?eX(mM,this,e):new KPe(VPe(this),{predicate:e})}});var XPe=wr,qPe=Mn,JPe=Up,QPe=Os,ZPe=Dn,eAe=Ul,tAe=Ms,rAe=Bh,Bk=rAe("forEach",TypeError);XPe({target:"Iterator",proto:!0,real:!0,forced:Bk},{forEach:function(e){ZPe(this);try{QPe(e)}catch(i){tAe(this,"throw",i)}if(Bk)return qPe(Bk,this,e);var r=eAe(this),n=0;JPe(r,function(i){e(i,n++)},{IS_RECORD:!0})}});var nAe=wr,nX=Mn,iAe=Os,iX=Dn,sAe=Ul,oAe=eF,aAe=ZK,lAe=Ms,cAe=tF,uAe=Bh,sX=!cAe("map",function(){}),pM=!sX&&uAe("map",TypeError),hAe=sX||pM,fAe=oAe(function(){var t=this.iterator,e=iX(nX(this.next,t)),r=this.done=!!e.done;if(!r)return aAe(t,this.mapper,[e.value,this.counter++],!0)});nAe({target:"Iterator",proto:!0,real:!0,forced:hAe},{map:function(e){iX(this);try{iAe(e)}catch(r){lAe(this,"throw",r)}return pM?nX(pM,this,e):new fAe(sAe(this),{mapper:e})}});var dAe=wn,rF=dAe([].slice),gAe=TypeError,oX=function(t,e){if(t<e)throw new gAe("Not enough arguments");return t},mAe=gR,pAe=/(?:ipad|iphone|ipod).*applewebkit/i.test(mAe),m0=vn,vAe=gR,wAe=Qd,PC=function(t){return vAe.slice(0,t.length)===t},aX=function(){return PC("Bun/")?"BUN":PC("Cloudflare-Workers")?"CLOUDFLARE":PC("Deno/")?"DENO":PC("Node.js/")?"NODE":m0.Bun&&typeof Bun.version=="string"?"BUN":m0.Deno&&typeof Deno.version=="object"?"DENO":wAe(m0.process)==="process"?"NODE":m0.window&&m0.document?"BROWSER":"REST"}(),yAe=aX,CAe=yAe==="NODE",Zs=vn,SAe=d1,xAe=EK,ZV=Nn,bAe=qo,lX=On,eW=$K,_Ae=rF,tW=VD,EAe=oX,RAe=pAe,TAe=CAe,vM=Zs.setImmediate,wM=Zs.clearImmediate,kAe=Zs.process,Vk=Zs.Dispatch,PAe=Zs.Function,rW=Zs.MessageChannel,AAe=Zs.String,Wk=0,tw={},nW="onreadystatechange",gy,Xh,jk,Uk;lX(function(){gy=Zs.location});var nF=function(t){if(bAe(tw,t)){var e=tw[t];delete tw[t],e()}},zk=function(t){return function(){nF(t)}},iW=function(t){nF(t.data)},sW=function(t){Zs.postMessage(AAe(t),gy.protocol+"//"+gy.host)};(!vM||!wM)&&(vM=function(e){EAe(arguments.length,1);var r=ZV(e)?e:PAe(e),n=_Ae(arguments,1);return tw[++Wk]=function(){SAe(r,void 0,n)},Xh(Wk),Wk},wM=function(e){delete tw[e]},TAe?Xh=function(t){kAe.nextTick(zk(t))}:Vk&&Vk.now?Xh=function(t){Vk.now(zk(t))}:rW&&!RAe?(jk=new rW,Uk=jk.port2,jk.port1.onmessage=iW,Xh=xAe(Uk.postMessage,Uk)):Zs.addEventListener&&ZV(Zs.postMessage)&&!Zs.importScripts&&gy&&gy.protocol!=="file:"&&!lX(sW)?(Xh=sW,Zs.addEventListener("message",iW,!1)):nW in tW("script")?Xh=function(t){eW.appendChild(tW("script"))[nW]=function(){eW.removeChild(this),nF(t)}}:Xh=function(t){setTimeout(zk(t),0)});var cX={set:vM,clear:wM},IAe=wr,OAe=vn,oW=cX.clear;IAe({global:!0,bind:!0,enumerable:!0,forced:OAe.clearImmediate!==oW},{clearImmediate:oW});var uX=vn,MAe=d1,NAe=Nn,DAe=aX,FAe=gR,HAe=rF,LAe=oX,$Ae=uX.Function,BAe=/MSIE .\./.test(FAe)||DAe==="BUN"&&function(){var t=uX.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),VAe=function(t,e){var r=e?2:1;return BAe?function(n,i){var s=LAe(arguments.length,1)>r,o=NAe(n)?n:$Ae(n),a=s?HAe(arguments,r):[],l=s?function(){MAe(o,this,a)}:o;return e?t(l,i):t(l)}:t},WAe=wr,hX=vn,aW=cX.set,jAe=VAe,lW=hX.setImmediate?jAe(aW,!1):aW;WAe({global:!0,bind:!0,enumerable:!0,forced:hX.setImmediate!==lW},{setImmediate:lW});/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:fX,setPrototypeOf:cW,isFrozen:UAe,getPrototypeOf:zAe,getOwnPropertyDescriptor:GAe}=Object;let{freeze:ts,seal:Go,create:dX}=Object,{apply:yM,construct:CM}=typeof Reflect<"u"&&Reflect;ts||(ts=function(e){return e});Go||(Go=function(e){return e});yM||(yM=function(e,r,n){return e.apply(r,n)});CM||(CM=function(e,r){return new e(...r)});const AC=rs(Array.prototype.forEach),YAe=rs(Array.prototype.lastIndexOf),uW=rs(Array.prototype.pop),p0=rs(Array.prototype.push),KAe=rs(Array.prototype.splice),Vx=rs(String.prototype.toLowerCase),Gk=rs(String.prototype.toString),hW=rs(String.prototype.match),v0=rs(String.prototype.replace),XAe=rs(String.prototype.indexOf),qAe=rs(String.prototype.trim),ga=rs(Object.prototype.hasOwnProperty),Li=rs(RegExp.prototype.test),w0=JAe(TypeError);function rs(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return yM(t,e,n)}}function JAe(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return CM(t,r)}}function Rt(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vx;cW&&cW(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=r(i);s!==i&&(UAe(e)||(e[n]=s),i=s)}t[i]=!0}return t}function QAe(t){for(let e=0;e<t.length;e++)ga(t,e)||(t[e]=null);return t}function cc(t){const e=dX(null);for(const[r,n]of fX(t))ga(t,r)&&(Array.isArray(n)?e[r]=QAe(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=cc(n):e[r]=n);return e}function y0(t,e){for(;t!==null;){const n=GAe(t,e);if(n){if(n.get)return rs(n.get);if(typeof n.value=="function")return rs(n.value)}t=zAe(t)}function r(){return null}return r}const fW=ts(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yk=ts(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Kk=ts(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ZAe=ts(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xk=ts(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),eIe=ts(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),dW=ts(["#text"]),gW=ts(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),qk=ts(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mW=ts(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),IC=ts(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),tIe=Go(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rIe=Go(/<%[\w\W]*|[\w\W]*%>/gm),nIe=Go(/\$\{[\w\W]*/gm),iIe=Go(/^data-[\-\w.\u00B7-\uFFFF]+$/),sIe=Go(/^aria-[\-\w]+$/),gX=Go(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),oIe=Go(/^(?:\w+script|data):/i),aIe=Go(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),mX=Go(/^html$/i),lIe=Go(/^[a-z][.\w]*(-[.\w]+)+$/i);var pW=Object.freeze({__proto__:null,ARIA_ATTR:sIe,ATTR_WHITESPACE:aIe,CUSTOM_ELEMENT:lIe,DATA_ATTR:iIe,DOCTYPE_NAME:mX,ERB_EXPR:rIe,IS_ALLOWED_URI:gX,IS_SCRIPT_OR_DATA:oIe,MUSTACHE_EXPR:tIe,TMPLIT_EXPR:nIe});const C0={element:1,text:3,progressingInstruction:7,comment:8,document:9},cIe=function(){return typeof window>"u"?null:window},uIe=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},vW=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function pX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cIe();const e=ne=>pX(ne);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==C0.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:d}=t,g=l.prototype,m=y0(g,"cloneNode"),p=y0(g,"remove"),w=y0(g,"nextSibling"),v=y0(g,"childNodes"),y=y0(g,"parentNode");if(typeof o=="function"){const ne=r.createElement("template");ne.content&&ne.content.ownerDocument&&(r=ne.content.ownerDocument)}let b,T="";const{implementation:E,createNodeIterator:x,createDocumentFragment:P,getElementsByTagName:A}=r,{importNode:O}=n;let Y=vW();e.isSupported=typeof fX=="function"&&typeof y=="function"&&E&&E.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:B,ERB_EXPR:ie,TMPLIT_EXPR:ue,DATA_ATTR:he,ARIA_ATTR:Ee,IS_SCRIPT_OR_DATA:Ce,ATTR_WHITESPACE:ge,CUSTOM_ELEMENT:Q}=pW;let{IS_ALLOWED_URI:ye}=pW,Re=null;const j=Rt({},[...fW,...Yk,...Kk,...Xk,...dW]);let C=null;const S=Rt({},[...gW,...qk,...mW,...IC]);let _=Object.seal(dX(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),D=null,U=null,X=!0,ee=!0,k=!1,M=!0,R=!1,W=!0,q=!1,J=!1,re=!1,V=!1,te=!1,oe=!1,ae=!0,fe=!1;const Me="user-content-";let Ne=!0,ze=!1,ot={},at=null;const rt=Rt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let We=null;const ft=Rt({},["audio","video","img","source","image","track"]);let Ze=null;const qt=Rt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Or="http://www.w3.org/1998/Math/MathML",xt="http://www.w3.org/2000/svg",Bt="http://www.w3.org/1999/xhtml";let gr=Bt,hr=!1,Nt=null;const Hi=Rt({},[Or,xt,Bt],Gk);let Un=Rt({},["mi","mo","mn","ms","mtext"]),za=Rt({},["annotation-xml"]);const lg=Rt({},["title","style","font","a","script"]);let zh=null;const cg=["application/xhtml+xml","text/html"],hT="text/html";let Cn=null,hu=null;const fT=r.createElement("form"),H1=function(N){return N instanceof RegExp||N instanceof Function},r0=function(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(hu&&hu===N)){if((!N||typeof N!="object")&&(N={}),N=cc(N),zh=cg.indexOf(N.PARSER_MEDIA_TYPE)===-1?hT:N.PARSER_MEDIA_TYPE,Cn=zh==="application/xhtml+xml"?Gk:Vx,Re=ga(N,"ALLOWED_TAGS")?Rt({},N.ALLOWED_TAGS,Cn):j,C=ga(N,"ALLOWED_ATTR")?Rt({},N.ALLOWED_ATTR,Cn):S,Nt=ga(N,"ALLOWED_NAMESPACES")?Rt({},N.ALLOWED_NAMESPACES,Gk):Hi,Ze=ga(N,"ADD_URI_SAFE_ATTR")?Rt(cc(qt),N.ADD_URI_SAFE_ATTR,Cn):qt,We=ga(N,"ADD_DATA_URI_TAGS")?Rt(cc(ft),N.ADD_DATA_URI_TAGS,Cn):ft,at=ga(N,"FORBID_CONTENTS")?Rt({},N.FORBID_CONTENTS,Cn):rt,D=ga(N,"FORBID_TAGS")?Rt({},N.FORBID_TAGS,Cn):cc({}),U=ga(N,"FORBID_ATTR")?Rt({},N.FORBID_ATTR,Cn):cc({}),ot=ga(N,"USE_PROFILES")?N.USE_PROFILES:!1,X=N.ALLOW_ARIA_ATTR!==!1,ee=N.ALLOW_DATA_ATTR!==!1,k=N.ALLOW_UNKNOWN_PROTOCOLS||!1,M=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,R=N.SAFE_FOR_TEMPLATES||!1,W=N.SAFE_FOR_XML!==!1,q=N.WHOLE_DOCUMENT||!1,V=N.RETURN_DOM||!1,te=N.RETURN_DOM_FRAGMENT||!1,oe=N.RETURN_TRUSTED_TYPE||!1,re=N.FORCE_BODY||!1,ae=N.SANITIZE_DOM!==!1,fe=N.SANITIZE_NAMED_PROPS||!1,Ne=N.KEEP_CONTENT!==!1,ze=N.IN_PLACE||!1,ye=N.ALLOWED_URI_REGEXP||gX,gr=N.NAMESPACE||Bt,Un=N.MATHML_TEXT_INTEGRATION_POINTS||Un,za=N.HTML_INTEGRATION_POINTS||za,_=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&H1(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(_.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&H1(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(_.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(_.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),R&&(ee=!1),te&&(V=!0),ot&&(Re=Rt({},dW),C=[],ot.html===!0&&(Rt(Re,fW),Rt(C,gW)),ot.svg===!0&&(Rt(Re,Yk),Rt(C,qk),Rt(C,IC)),ot.svgFilters===!0&&(Rt(Re,Kk),Rt(C,qk),Rt(C,IC)),ot.mathMl===!0&&(Rt(Re,Xk),Rt(C,mW),Rt(C,IC))),N.ADD_TAGS&&(Re===j&&(Re=cc(Re)),Rt(Re,N.ADD_TAGS,Cn)),N.ADD_ATTR&&(C===S&&(C=cc(C)),Rt(C,N.ADD_ATTR,Cn)),N.ADD_URI_SAFE_ATTR&&Rt(Ze,N.ADD_URI_SAFE_ATTR,Cn),N.FORBID_CONTENTS&&(at===rt&&(at=cc(at)),Rt(at,N.FORBID_CONTENTS,Cn)),Ne&&(Re["#text"]=!0),q&&Rt(Re,["html","head","body"]),Re.table&&(Rt(Re,["tbody"]),delete D.tbody),N.TRUSTED_TYPES_POLICY){if(typeof N.TRUSTED_TYPES_POLICY.createHTML!="function")throw w0('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof N.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw w0('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');b=N.TRUSTED_TYPES_POLICY,T=b.createHTML("")}else b===void 0&&(b=uIe(d,i)),b!==null&&typeof T=="string"&&(T=b.createHTML(""));ts&&ts(N),hu=N}},L1=Rt({},[...Yk,...Kk,...ZAe]),$1=Rt({},[...Xk,...eIe]),n0=function(N){let se=y(N);(!se||!se.tagName)&&(se={namespaceURI:gr,tagName:"template"});const de=Vx(N.tagName),ke=Vx(se.tagName);return Nt[N.namespaceURI]?N.namespaceURI===xt?se.namespaceURI===Bt?de==="svg":se.namespaceURI===Or?de==="svg"&&(ke==="annotation-xml"||Un[ke]):!!L1[de]:N.namespaceURI===Or?se.namespaceURI===Bt?de==="math":se.namespaceURI===xt?de==="math"&&za[ke]:!!$1[de]:N.namespaceURI===Bt?se.namespaceURI===xt&&!za[ke]||se.namespaceURI===Or&&!Un[ke]?!1:!$1[de]&&(lg[de]||!L1[de]):!!(zh==="application/xhtml+xml"&&Nt[N.namespaceURI]):!1},fo=function(N){p0(e.removed,{element:N});try{y(N).removeChild(N)}catch{p(N)}},fu=function(N,se){try{p0(e.removed,{attribute:se.getAttributeNode(N),from:se})}catch{p0(e.removed,{attribute:null,from:se})}if(se.removeAttribute(N),N==="is")if(V||te)try{fo(se)}catch{}else try{se.setAttribute(N,"")}catch{}},B1=function(N){let se=null,de=null;if(re)N="<remove></remove>"+N;else{const Ae=hW(N,/^[\r\n\t ]+/);de=Ae&&Ae[0]}zh==="application/xhtml+xml"&&gr===Bt&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");const ke=b?b.createHTML(N):N;if(gr===Bt)try{se=new f().parseFromString(ke,zh)}catch{}if(!se||!se.documentElement){se=E.createDocument(gr,"template",null);try{se.documentElement.innerHTML=hr?T:ke}catch{}}const be=se.body||se.documentElement;return N&&de&&be.insertBefore(r.createTextNode(de),be.childNodes[0]||null),gr===Bt?A.call(se,q?"html":"body")[0]:q?se.documentElement:be},I=function(N){return x.call(N.ownerDocument||N,N,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},z=function(N){return N instanceof h&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof u)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},H=function(N){return typeof a=="function"&&N instanceof a};function L(ne,N,se){AC(ne,de=>{de.call(e,N,se,hu)})}const G=function(N){let se=null;if(L(Y.beforeSanitizeElements,N,null),z(N))return fo(N),!0;const de=Cn(N.nodeName);if(L(Y.uponSanitizeElement,N,{tagName:de,allowedTags:Re}),W&&N.hasChildNodes()&&!H(N.firstElementChild)&&Li(/<[/\w!]/g,N.innerHTML)&&Li(/<[/\w!]/g,N.textContent)||N.nodeType===C0.progressingInstruction||W&&N.nodeType===C0.comment&&Li(/<[/\w]/g,N.data))return fo(N),!0;if(!Re[de]||D[de]){if(!D[de]&&ce(de)&&(_.tagNameCheck instanceof RegExp&&Li(_.tagNameCheck,de)||_.tagNameCheck instanceof Function&&_.tagNameCheck(de)))return!1;if(Ne&&!at[de]){const ke=y(N)||N.parentNode,be=v(N)||N.childNodes;if(be&&ke){const Ae=be.length;for(let Ye=Ae-1;Ye>=0;--Ye){const Vt=m(be[Ye],!0);Vt.__removalCount=(N.__removalCount||0)+1,ke.insertBefore(Vt,w(N))}}}return fo(N),!0}return N instanceof l&&!n0(N)||(de==="noscript"||de==="noembed"||de==="noframes")&&Li(/<\/no(script|embed|frames)/i,N.innerHTML)?(fo(N),!0):(R&&N.nodeType===C0.text&&(se=N.textContent,AC([B,ie,ue],ke=>{se=v0(se,ke," ")}),N.textContent!==se&&(p0(e.removed,{element:N.cloneNode()}),N.textContent=se)),L(Y.afterSanitizeElements,N,null),!1)},K=function(N,se,de){if(ae&&(se==="id"||se==="name")&&(de in r||de in fT))return!1;if(!(ee&&!U[se]&&Li(he,se))){if(!(X&&Li(Ee,se))){if(!C[se]||U[se]){if(!(ce(N)&&(_.tagNameCheck instanceof RegExp&&Li(_.tagNameCheck,N)||_.tagNameCheck instanceof Function&&_.tagNameCheck(N))&&(_.attributeNameCheck instanceof RegExp&&Li(_.attributeNameCheck,se)||_.attributeNameCheck instanceof Function&&_.attributeNameCheck(se))||se==="is"&&_.allowCustomizedBuiltInElements&&(_.tagNameCheck instanceof RegExp&&Li(_.tagNameCheck,de)||_.tagNameCheck instanceof Function&&_.tagNameCheck(de))))return!1}else if(!Ze[se]){if(!Li(ye,v0(de,ge,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&N!=="script"&&XAe(de,"data:")===0&&We[N])){if(!(k&&!Li(Ce,v0(de,ge,"")))){if(de)return!1}}}}}}return!0},ce=function(N){return N!=="annotation-xml"&&hW(N,Q)},we=function(N){L(Y.beforeSanitizeAttributes,N,null);const{attributes:se}=N;if(!se||z(N))return;const de={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:C,forceKeepAttr:void 0};let ke=se.length;for(;ke--;){const be=se[ke],{name:Ae,namespaceURI:Ye,value:Vt}=be,rr=Cn(Ae),Sn=Vt;let Jr=Ae==="value"?Sn:qAe(Sn);if(de.attrName=rr,de.attrValue=Jr,de.keepAttr=!0,de.forceKeepAttr=void 0,L(Y.uponSanitizeAttribute,N,de),Jr=de.attrValue,fe&&(rr==="id"||rr==="name")&&(fu(Ae,N),Jr=Me+Jr),W&&Li(/((--!?|])>)|<\/(style|title)/i,Jr)){fu(Ae,N);continue}if(de.forceKeepAttr)continue;if(!de.keepAttr){fu(Ae,N);continue}if(!M&&Li(/\/>/i,Jr)){fu(Ae,N);continue}R&&AC([B,ie,ue],gu=>{Jr=v0(Jr,gu," ")});const du=Cn(N.nodeName);if(!K(du,rr,Jr)){fu(Ae,N);continue}if(b&&typeof d=="object"&&typeof d.getAttributeType=="function"&&!Ye)switch(d.getAttributeType(du,rr)){case"TrustedHTML":{Jr=b.createHTML(Jr);break}case"TrustedScriptURL":{Jr=b.createScriptURL(Jr);break}}if(Jr!==Sn)try{Ye?N.setAttributeNS(Ye,Ae,Jr):N.setAttribute(Ae,Jr),z(N)?fo(N):uW(e.removed)}catch{fu(Ae,N)}}L(Y.afterSanitizeAttributes,N,null)},le=function ne(N){let se=null;const de=I(N);for(L(Y.beforeSanitizeShadowDOM,N,null);se=de.nextNode();)L(Y.uponSanitizeShadowNode,se,null),G(se),we(se),se.content instanceof s&&ne(se.content);L(Y.afterSanitizeShadowDOM,N,null)};return e.sanitize=function(ne){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se=null,de=null,ke=null,be=null;if(hr=!ne,hr&&(ne="<!-->"),typeof ne!="string"&&!H(ne))if(typeof ne.toString=="function"){if(ne=ne.toString(),typeof ne!="string")throw w0("dirty is not a string, aborting")}else throw w0("toString is not a function");if(!e.isSupported)return ne;if(J||r0(N),e.removed=[],typeof ne=="string"&&(ze=!1),ze){if(ne.nodeName){const Vt=Cn(ne.nodeName);if(!Re[Vt]||D[Vt])throw w0("root node is forbidden and cannot be sanitized in-place")}}else if(ne instanceof a)se=B1("<!---->"),de=se.ownerDocument.importNode(ne,!0),de.nodeType===C0.element&&de.nodeName==="BODY"||de.nodeName==="HTML"?se=de:se.appendChild(de);else{if(!V&&!R&&!q&&ne.indexOf("<")===-1)return b&&oe?b.createHTML(ne):ne;if(se=B1(ne),!se)return V?null:oe?T:""}se&&re&&fo(se.firstChild);const Ae=I(ze?ne:se);for(;ke=Ae.nextNode();)G(ke),we(ke),ke.content instanceof s&&le(ke.content);if(ze)return ne;if(V){if(te)for(be=P.call(se.ownerDocument);se.firstChild;)be.appendChild(se.firstChild);else be=se;return(C.shadowroot||C.shadowrootmode)&&(be=O.call(n,be,!0)),be}let Ye=q?se.outerHTML:se.innerHTML;return q&&Re["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&Li(mX,se.ownerDocument.doctype.name)&&(Ye="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+Ye),R&&AC([B,ie,ue],Vt=>{Ye=v0(Ye,Vt," ")}),b&&oe?b.createHTML(Ye):Ye},e.setConfig=function(){let ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};r0(ne),J=!0},e.clearConfig=function(){hu=null,J=!1},e.isValidAttribute=function(ne,N,se){hu||r0({});const de=Cn(ne),ke=Cn(N);return K(de,ke,se)},e.addHook=function(ne,N){typeof N=="function"&&p0(Y[ne],N)},e.removeHook=function(ne,N){if(N!==void 0){const se=YAe(Y[ne],N);return se===-1?void 0:KAe(Y[ne],se,1)[0]}return uW(Y[ne])},e.removeHooks=function(ne){Y[ne]=[]},e.removeAllHooks=function(){Y=vW()},e}var hIe=pX();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var vX;function _e(){return vX.apply(null,arguments)}function fIe(t){vX=t}function Ha(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function fd(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Kt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function iF(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Kt(t,e))return!1;return!0}function ms(t){return t===void 0}function Kc(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function p1(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function wX(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function rh(t,e){for(var r in e)Kt(e,r)&&(t[r]=e[r]);return Kt(e,"toString")&&(t.toString=e.toString),Kt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function zl(t,e,r,n){return VX(t,e,r,n,!0).utc()}function dIe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function pt(t){return t._pf==null&&(t._pf=dIe()),t._pf}var SM;Array.prototype.some?SM=Array.prototype.some:SM=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function sF(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=pt(t),r=SM.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function vR(t){var e=zl(NaN);return t!=null?rh(pt(e),t):pt(e).userInvalidated=!0,e}var wW=_e.momentProperties=[],Jk=!1;function oF(t,e){var r,n,i,s=wW.length;if(ms(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ms(e._i)||(t._i=e._i),ms(e._f)||(t._f=e._f),ms(e._l)||(t._l=e._l),ms(e._strict)||(t._strict=e._strict),ms(e._tzm)||(t._tzm=e._tzm),ms(e._isUTC)||(t._isUTC=e._isUTC),ms(e._offset)||(t._offset=e._offset),ms(e._pf)||(t._pf=pt(e)),ms(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=wW[r],i=e[n],ms(i)||(t[n]=i);return t}function v1(t){oF(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Jk===!1&&(Jk=!0,_e.updateOffset(this),Jk=!1)}function La(t){return t instanceof v1||t!=null&&t._isAMomentObject!=null}function yX(t){_e.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Jo(t,e){var r=!0;return rh(function(){if(_e.deprecationHandler!=null&&_e.deprecationHandler(null,t),r){var n=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Kt(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}yX(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var yW={};function CX(t,e){_e.deprecationHandler!=null&&_e.deprecationHandler(t,e),yW[t]||(yX(e),yW[t]=!0)}_e.suppressDeprecationWarnings=!1;_e.deprecationHandler=null;function Gl(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function gIe(t){var e,r;for(r in t)Kt(t,r)&&(e=t[r],Gl(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function xM(t,e){var r=rh({},t),n;for(n in e)Kt(e,n)&&(fd(t[n])&&fd(e[n])?(r[n]={},rh(r[n],t[n]),rh(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Kt(t,n)&&!Kt(e,n)&&fd(t[n])&&(r[n]=rh({},r[n]));return r}function aF(t){t!=null&&this.set(t)}var bM;Object.keys?bM=Object.keys:bM=function(t){var e,r=[];for(e in t)Kt(t,e)&&r.push(e);return r};var mIe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function pIe(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Gl(n)?n.call(e,r):n}function Ll(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var lF=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,OC=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Qk={},Xm={};function Qe(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Xm[t]=i),e&&(Xm[e[0]]=function(){return Ll(i.apply(this,arguments),e[1],e[2])}),r&&(Xm[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function vIe(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function wIe(t){var e=t.match(lF),r,n;for(r=0,n=e.length;r<n;r++)Xm[e[r]]?e[r]=Xm[e[r]]:e[r]=vIe(e[r]);return function(i){var s="",o;for(o=0;o<n;o++)s+=Gl(e[o])?e[o].call(i,t):e[o];return s}}function Wx(t,e){return t.isValid()?(e=SX(e,t.localeData()),Qk[e]=Qk[e]||wIe(e),Qk[e](t)):t.localeData().invalidDate()}function SX(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(OC.lastIndex=0;r>=0&&OC.test(t);)t=t.replace(OC,n),OC.lastIndex=0,r-=1;return t}var yIe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function CIe(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(lF).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var SIe="Invalid date";function xIe(){return this._invalidDate}var bIe="%d",_Ie=/\d{1,2}/;function EIe(t){return this._ordinal.replace("%d",t)}var RIe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function TIe(t,e,r,n){var i=this._relativeTime[r];return Gl(i)?i(t,e,r,n):i.replace(/%d/i,t)}function kIe(t,e){var r=this._relativeTime[t>0?"future":"past"];return Gl(r)?r(e):r.replace(/%s/i,e)}var CW={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Qo(t){return typeof t=="string"?CW[t]||CW[t.toLowerCase()]:void 0}function cF(t){var e={},r,n;for(n in t)Kt(t,n)&&(r=Qo(n),r&&(e[r]=t[n]));return e}var PIe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function AIe(t){var e=[],r;for(r in t)Kt(t,r)&&e.push({unit:r,priority:PIe[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var xX=/\d/,ho=/\d\d/,bX=/\d{3}/,uF=/\d{4}/,wR=/[+-]?\d{6}/,Ir=/\d\d?/,_X=/\d\d\d\d?/,EX=/\d\d\d\d\d\d?/,yR=/\d{1,3}/,hF=/\d{1,4}/,CR=/[+-]?\d{1,6}/,zp=/\d+/,SR=/[+-]?\d+/,IIe=/Z|[+-]\d\d:?\d\d/gi,xR=/Z|[+-]\d\d(?::?\d\d)?/gi,OIe=/[+-]?\d+(\.\d{1,3})?/,w1=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Gp=/^[1-9]\d?/,fF=/^([1-9]\d|\d)/,d_;d_={};function $e(t,e,r){d_[t]=Gl(e)?e:function(n,i){return n&&r?r:e}}function MIe(t,e){return Kt(d_,t)?d_[t](e._strict,e._locale):new RegExp(NIe(t))}function NIe(t){return Lc(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function Lc(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Fo(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function It(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Fo(e)),r}var _M={};function dr(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Kc(e)&&(n=function(s,o){o[e]=It(s)}),i=t.length,r=0;r<i;r++)_M[t[r]]=n}function y1(t,e){dr(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function DIe(t,e,r){e!=null&&Kt(_M,t)&&_M[t](e,r._a,r,t)}function bR(t){return t%4===0&&t%100!==0||t%400===0}var Mi=0,Rc=1,El=2,Wn=3,Pa=4,Tc=5,Jf=6,FIe=7,HIe=8;Qe("Y",0,0,function(){var t=this.year();return t<=9999?Ll(t,4):"+"+t});Qe(0,["YY",2],0,function(){return this.year()%100});Qe(0,["YYYY",4],0,"year");Qe(0,["YYYYY",5],0,"year");Qe(0,["YYYYYY",6,!0],0,"year");$e("Y",SR);$e("YY",Ir,ho);$e("YYYY",hF,uF);$e("YYYYY",CR,wR);$e("YYYYYY",CR,wR);dr(["YYYYY","YYYYYY"],Mi);dr("YYYY",function(t,e){e[Mi]=t.length===2?_e.parseTwoDigitYear(t):It(t)});dr("YY",function(t,e){e[Mi]=_e.parseTwoDigitYear(t)});dr("Y",function(t,e){e[Mi]=parseInt(t,10)});function rw(t){return bR(t)?366:365}_e.parseTwoDigitYear=function(t){return It(t)+(It(t)>68?1900:2e3)};var RX=Yp("FullYear",!0);function LIe(){return bR(this.year())}function Yp(t,e){return function(r){return r!=null?(TX(this,t,r),_e.updateOffset(this,e),this):my(this,t)}}function my(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function TX(t,e,r){var n,i,s,o,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,o=t.month(),a=t.date(),a=a===29&&o===1&&!bR(s)?28:a,i?n.setUTCFullYear(s,o,a):n.setFullYear(s,o,a)}}function $Ie(t){return t=Qo(t),Gl(this[t])?this[t]():this}function BIe(t,e){if(typeof t=="object"){t=cF(t);var r=AIe(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Qo(t),Gl(this[t]))return this[t](e);return this}function VIe(t,e){return(t%e+e)%e}var dn;Array.prototype.indexOf?dn=Array.prototype.indexOf:dn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function dF(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=VIe(e,12);return t+=(e-r)/12,r===1?bR(t)?29:28:31-r%7%2}Qe("M",["MM",2],"Mo",function(){return this.month()+1});Qe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Qe("MMMM",0,0,function(t){return this.localeData().months(this,t)});$e("M",Ir,Gp);$e("MM",Ir,ho);$e("MMM",function(t,e){return e.monthsShortRegex(t)});$e("MMMM",function(t,e){return e.monthsRegex(t)});dr(["M","MM"],function(t,e){e[Rc]=It(t)-1});dr(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Rc]=i:pt(r).invalidMonth=t});var WIe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),kX="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),PX=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,jIe=w1,UIe=w1;function zIe(t,e){return t?Ha(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||PX).test(e)?"format":"standalone"][t.month()]:Ha(this._months)?this._months:this._months.standalone}function GIe(t,e){return t?Ha(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[PX.test(e)?"format":"standalone"][t.month()]:Ha(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function YIe(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=zl([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=dn.call(this._shortMonthsParse,o),i!==-1?i:null):(i=dn.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=dn.call(this._shortMonthsParse,o),i!==-1?i:(i=dn.call(this._longMonthsParse,o),i!==-1?i:null)):(i=dn.call(this._longMonthsParse,o),i!==-1?i:(i=dn.call(this._shortMonthsParse,o),i!==-1?i:null))}function KIe(t,e,r){var n,i,s;if(this._monthsParseExact)return YIe.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=zl([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function AX(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=It(e);else if(e=t.localeData().monthsParse(e),!Kc(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,dF(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function IX(t){return t!=null?(AX(this,t),_e.updateOffset(this,!0),this):my(this,"Month")}function XIe(){return dF(this.year(),this.month())}function qIe(t){return this._monthsParseExact?(Kt(this,"_monthsRegex")||OX.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Kt(this,"_monthsShortRegex")||(this._monthsShortRegex=jIe),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function JIe(t){return this._monthsParseExact?(Kt(this,"_monthsRegex")||OX.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Kt(this,"_monthsRegex")||(this._monthsRegex=UIe),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function OX(){function t(l,c){return c.length-l.length}var e=[],r=[],n=[],i,s,o,a;for(i=0;i<12;i++)s=zl([2e3,i]),o=Lc(this.monthsShort(s,"")),a=Lc(this.months(s,"")),e.push(o),r.push(a),n.push(a),n.push(o);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function QIe(t,e,r,n,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,s,o),a}function py(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function g_(t,e,r){var n=7+e-r,i=(7+py(t,0,n).getUTCDay()-e)%7;return-i+n-1}function MX(t,e,r,n,i){var s=(7+r-n)%7,o=g_(t,n,i),a=1+7*(e-1)+s+o,l,c;return a<=0?(l=t-1,c=rw(l)+a):a>rw(t)?(l=t+1,c=a-rw(t)):(l=t,c=a),{year:l,dayOfYear:c}}function vy(t,e,r){var n=g_(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+$c(o,e,r)):i>$c(t.year(),e,r)?(s=i-$c(t.year(),e,r),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function $c(t,e,r){var n=g_(t,e,r),i=g_(t+1,e,r);return(rw(t)-n+i)/7}Qe("w",["ww",2],"wo","week");Qe("W",["WW",2],"Wo","isoWeek");$e("w",Ir,Gp);$e("ww",Ir,ho);$e("W",Ir,Gp);$e("WW",Ir,ho);y1(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=It(t)});function ZIe(t){return vy(t,this._week.dow,this._week.doy).week}var eOe={dow:0,doy:6};function tOe(){return this._week.dow}function rOe(){return this._week.doy}function nOe(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function iOe(t){var e=vy(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Qe("d",0,"do","day");Qe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Qe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Qe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Qe("e",0,0,"weekday");Qe("E",0,0,"isoWeekday");$e("d",Ir);$e("e",Ir);$e("E",Ir);$e("dd",function(t,e){return e.weekdaysMinRegex(t)});$e("ddd",function(t,e){return e.weekdaysShortRegex(t)});$e("dddd",function(t,e){return e.weekdaysRegex(t)});y1(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:pt(r).invalidWeekday=t});y1(["d","e","E"],function(t,e,r,n){e[n]=It(t)});function sOe(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function oOe(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function gF(t,e){return t.slice(e,7).concat(t.slice(0,e))}var aOe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),NX="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),lOe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),cOe=w1,uOe=w1,hOe=w1;function fOe(t,e){var r=Ha(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?gF(r,this._week.dow):t?r[t.day()]:r}function dOe(t){return t===!0?gF(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function gOe(t){return t===!0?gF(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function mOe(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=zl([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=dn.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=dn.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=dn.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=dn.call(this._weekdaysParse,o),i!==-1||(i=dn.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=dn.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=dn.call(this._shortWeekdaysParse,o),i!==-1||(i=dn.call(this._weekdaysParse,o),i!==-1)?i:(i=dn.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=dn.call(this._minWeekdaysParse,o),i!==-1||(i=dn.call(this._weekdaysParse,o),i!==-1)?i:(i=dn.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function pOe(t,e,r){var n,i,s;if(this._weekdaysParseExact)return mOe.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=zl([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function vOe(t){if(!this.isValid())return t!=null?this:NaN;var e=my(this,"Day");return t!=null?(t=sOe(t,this.localeData()),this.add(t-e,"d")):e}function wOe(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function yOe(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=oOe(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function COe(t){return this._weekdaysParseExact?(Kt(this,"_weekdaysRegex")||mF.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Kt(this,"_weekdaysRegex")||(this._weekdaysRegex=cOe),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function SOe(t){return this._weekdaysParseExact?(Kt(this,"_weekdaysRegex")||mF.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Kt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=uOe),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function xOe(t){return this._weekdaysParseExact?(Kt(this,"_weekdaysRegex")||mF.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Kt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=hOe),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function mF(){function t(u,h){return h.length-u.length}var e=[],r=[],n=[],i=[],s,o,a,l,c;for(s=0;s<7;s++)o=zl([2e3,1]).day(s),a=Lc(this.weekdaysMin(o,"")),l=Lc(this.weekdaysShort(o,"")),c=Lc(this.weekdays(o,"")),e.push(a),r.push(l),n.push(c),i.push(a),i.push(l),i.push(c);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function pF(){return this.hours()%12||12}function bOe(){return this.hours()||24}Qe("H",["HH",2],0,"hour");Qe("h",["hh",2],0,pF);Qe("k",["kk",2],0,bOe);Qe("hmm",0,0,function(){return""+pF.apply(this)+Ll(this.minutes(),2)});Qe("hmmss",0,0,function(){return""+pF.apply(this)+Ll(this.minutes(),2)+Ll(this.seconds(),2)});Qe("Hmm",0,0,function(){return""+this.hours()+Ll(this.minutes(),2)});Qe("Hmmss",0,0,function(){return""+this.hours()+Ll(this.minutes(),2)+Ll(this.seconds(),2)});function DX(t,e){Qe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}DX("a",!0);DX("A",!1);function FX(t,e){return e._meridiemParse}$e("a",FX);$e("A",FX);$e("H",Ir,fF);$e("h",Ir,Gp);$e("k",Ir,Gp);$e("HH",Ir,ho);$e("hh",Ir,ho);$e("kk",Ir,ho);$e("hmm",_X);$e("hmmss",EX);$e("Hmm",_X);$e("Hmmss",EX);dr(["H","HH"],Wn);dr(["k","kk"],function(t,e,r){var n=It(t);e[Wn]=n===24?0:n});dr(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});dr(["h","hh"],function(t,e,r){e[Wn]=It(t),pt(r).bigHour=!0});dr("hmm",function(t,e,r){var n=t.length-2;e[Wn]=It(t.substr(0,n)),e[Pa]=It(t.substr(n)),pt(r).bigHour=!0});dr("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Wn]=It(t.substr(0,n)),e[Pa]=It(t.substr(n,2)),e[Tc]=It(t.substr(i)),pt(r).bigHour=!0});dr("Hmm",function(t,e,r){var n=t.length-2;e[Wn]=It(t.substr(0,n)),e[Pa]=It(t.substr(n))});dr("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Wn]=It(t.substr(0,n)),e[Pa]=It(t.substr(n,2)),e[Tc]=It(t.substr(i))});function _Oe(t){return(t+"").toLowerCase().charAt(0)==="p"}var EOe=/[ap]\.?m?\.?/i,ROe=Yp("Hours",!0);function TOe(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var HX={calendar:mIe,longDateFormat:yIe,invalidDate:SIe,ordinal:bIe,dayOfMonthOrdinalParse:_Ie,relativeTime:RIe,months:WIe,monthsShort:kX,week:eOe,weekdays:aOe,weekdaysMin:lOe,weekdaysShort:NX,meridiemParse:EOe},Mr={},S0={},wy;function kOe(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function SW(t){return t&&t.toLowerCase().replace("_","-")}function POe(t){for(var e=0,r,n,i,s;e<t.length;){for(s=SW(t[e]).split("-"),r=s.length,n=SW(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=_R(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&kOe(s,n)>=r-1)break;r--}e++}return wy}function AOe(t){return!!(t&&t.match("^[^/\\\\]*$"))}function _R(t){var e=null,r;if(Mr[t]===void 0&&typeof hb<"u"&&hb&&hb.exports&&AOe(t))try{e=wy._abbr,r=require,r("./locale/"+t),wh(e)}catch{Mr[t]=null}return Mr[t]}function wh(t,e){var r;return t&&(ms(e)?r=ou(t):r=vF(t,e),r?wy=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),wy._abbr}function vF(t,e){if(e!==null){var r,n=HX;if(e.abbr=t,Mr[t]!=null)CX("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Mr[t]._config;else if(e.parentLocale!=null)if(Mr[e.parentLocale]!=null)n=Mr[e.parentLocale]._config;else if(r=_R(e.parentLocale),r!=null)n=r._config;else return S0[e.parentLocale]||(S0[e.parentLocale]=[]),S0[e.parentLocale].push({name:t,config:e}),null;return Mr[t]=new aF(xM(n,e)),S0[t]&&S0[t].forEach(function(i){vF(i.name,i.config)}),wh(t),Mr[t]}else return delete Mr[t],null}function IOe(t,e){if(e!=null){var r,n,i=HX;Mr[t]!=null&&Mr[t].parentLocale!=null?Mr[t].set(xM(Mr[t]._config,e)):(n=_R(t),n!=null&&(i=n._config),e=xM(i,e),n==null&&(e.abbr=t),r=new aF(e),r.parentLocale=Mr[t],Mr[t]=r),wh(t)}else Mr[t]!=null&&(Mr[t].parentLocale!=null?(Mr[t]=Mr[t].parentLocale,t===wh()&&wh(t)):Mr[t]!=null&&delete Mr[t]);return Mr[t]}function ou(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return wy;if(!Ha(t)){if(e=_R(t),e)return e;t=[t]}return POe(t)}function OOe(){return bM(Mr)}function wF(t){var e,r=t._a;return r&&pt(t).overflow===-2&&(e=r[Rc]<0||r[Rc]>11?Rc:r[El]<1||r[El]>dF(r[Mi],r[Rc])?El:r[Wn]<0||r[Wn]>24||r[Wn]===24&&(r[Pa]!==0||r[Tc]!==0||r[Jf]!==0)?Wn:r[Pa]<0||r[Pa]>59?Pa:r[Tc]<0||r[Tc]>59?Tc:r[Jf]<0||r[Jf]>999?Jf:-1,pt(t)._overflowDayOfYear&&(e<Mi||e>El)&&(e=El),pt(t)._overflowWeeks&&e===-1&&(e=FIe),pt(t)._overflowWeekday&&e===-1&&(e=HIe),pt(t).overflow=e),t}var MOe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,NOe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,DOe=/Z|[+-]\d\d(?::?\d\d)?/,MC=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Zk=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],FOe=/^\/?Date\((-?\d+)/i,HOe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,LOe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function LX(t){var e,r,n=t._i,i=MOe.exec(n)||NOe.exec(n),s,o,a,l,c=MC.length,u=Zk.length;if(i){for(pt(t).iso=!0,e=0,r=c;e<r;e++)if(MC[e][1].exec(i[1])){o=MC[e][0],s=MC[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,r=u;e<r;e++)if(Zk[e][1].exec(i[3])){a=(i[2]||" ")+Zk[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(DOe.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),CF(t)}else t._isValid=!1}function $Oe(t,e,r,n,i,s){var o=[BOe(t),kX.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function BOe(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function VOe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function WOe(t,e,r){if(t){var n=NX.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return pt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function jOe(t,e,r){if(t)return LOe[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function $X(t){var e=HOe.exec(VOe(t._i)),r;if(e){if(r=$Oe(e[4],e[3],e[2],e[5],e[6],e[7]),!WOe(e[1],r,t))return;t._a=r,t._tzm=jOe(e[8],e[9],e[10]),t._d=py.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),pt(t).rfc2822=!0}else t._isValid=!1}function UOe(t){var e=FOe.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(LX(t),t._isValid===!1)delete t._isValid;else return;if($X(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:_e.createFromInputFallback(t)}_e.createFromInputFallback=Jo("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function nm(t,e,r){return t??e??r}function zOe(t){var e=new Date(_e.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function yF(t){var e,r,n=[],i,s,o;if(!t._d){for(i=zOe(t),t._w&&t._a[El]==null&&t._a[Rc]==null&&GOe(t),t._dayOfYear!=null&&(o=nm(t._a[Mi],i[Mi]),(t._dayOfYear>rw(o)||t._dayOfYear===0)&&(pt(t)._overflowDayOfYear=!0),r=py(o,0,t._dayOfYear),t._a[Rc]=r.getUTCMonth(),t._a[El]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Wn]===24&&t._a[Pa]===0&&t._a[Tc]===0&&t._a[Jf]===0&&(t._nextDay=!0,t._a[Wn]=0),t._d=(t._useUTC?py:QIe).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Wn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(pt(t).weekdayMismatch=!0)}}function GOe(t){var e,r,n,i,s,o,a,l,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,r=nm(e.GG,t._a[Mi],vy(Ar(),1,4).year),n=nm(e.W,1),i=nm(e.E,1),(i<1||i>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,c=vy(Ar(),s,o),r=nm(e.gg,t._a[Mi],c.year),n=nm(e.w,c.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),n<1||n>$c(r,s,o)?pt(t)._overflowWeeks=!0:l!=null?pt(t)._overflowWeekday=!0:(a=MX(r,n,i,s,o),t._a[Mi]=a.year,t._dayOfYear=a.dayOfYear)}_e.ISO_8601=function(){};_e.RFC_2822=function(){};function CF(t){if(t._f===_e.ISO_8601){LX(t);return}if(t._f===_e.RFC_2822){$X(t);return}t._a=[],pt(t).empty=!0;var e=""+t._i,r,n,i,s,o,a=e.length,l=0,c,u;for(i=SX(t._f,t._locale).match(lF)||[],u=i.length,r=0;r<u;r++)s=i[r],n=(e.match(MIe(s,t))||[])[0],n&&(o=e.substr(0,e.indexOf(n)),o.length>0&&pt(t).unusedInput.push(o),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Xm[s]?(n?pt(t).empty=!1:pt(t).unusedTokens.push(s),DIe(s,n,t)):t._strict&&!n&&pt(t).unusedTokens.push(s);pt(t).charsLeftOver=a-l,e.length>0&&pt(t).unusedInput.push(e),t._a[Wn]<=12&&pt(t).bigHour===!0&&t._a[Wn]>0&&(pt(t).bigHour=void 0),pt(t).parsedDateParts=t._a.slice(0),pt(t).meridiem=t._meridiem,t._a[Wn]=YOe(t._locale,t._a[Wn],t._meridiem),c=pt(t).era,c!==null&&(t._a[Mi]=t._locale.erasConvertYear(c,t._a[Mi])),yF(t),wF(t)}function YOe(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function KOe(t){var e,r,n,i,s,o,a=!1,l=t._f.length;if(l===0){pt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=oF({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],CF(e),sF(e)&&(o=!0),s+=pt(e).charsLeftOver,s+=pt(e).unusedTokens.length*10,pt(e).score=s,a?s<n&&(n=s,r=e):(n==null||s<n||o)&&(n=s,r=e,o&&(a=!0));rh(t,r||e)}function XOe(t){if(!t._d){var e=cF(t._i),r=e.day===void 0?e.date:e.day;t._a=wX([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),yF(t)}}function qOe(t){var e=new v1(wF(BX(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function BX(t){var e=t._i,r=t._f;return t._locale=t._locale||ou(t._l),e===null||r===void 0&&e===""?vR({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),La(e)?new v1(wF(e)):(p1(e)?t._d=e:Ha(r)?KOe(t):r?CF(t):JOe(t),sF(t)||(t._d=null),t))}function JOe(t){var e=t._i;ms(e)?t._d=new Date(_e.now()):p1(e)?t._d=new Date(e.valueOf()):typeof e=="string"?UOe(t):Ha(e)?(t._a=wX(e.slice(0),function(r){return parseInt(r,10)}),yF(t)):fd(e)?XOe(t):Kc(e)?t._d=new Date(e):_e.createFromInputFallback(t)}function VX(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(fd(t)&&iF(t)||Ha(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,qOe(s)}function Ar(t,e,r,n){return VX(t,e,r,n,!1)}var QOe=Jo("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ar.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:vR()}),ZOe=Jo("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ar.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:vR()});function WX(t,e){var r,n;if(e.length===1&&Ha(e[0])&&(e=e[0]),!e.length)return Ar();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function eMe(){var t=[].slice.call(arguments,0);return WX("isBefore",t)}function tMe(){var t=[].slice.call(arguments,0);return WX("isAfter",t)}var rMe=function(){return Date.now?Date.now():+new Date},x0=["year","quarter","month","week","day","hour","minute","second","millisecond"];function nMe(t){var e,r=!1,n,i=x0.length;for(e in t)if(Kt(t,e)&&!(dn.call(x0,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[x0[n]]){if(r)return!1;parseFloat(t[x0[n]])!==It(t[x0[n]])&&(r=!0)}return!0}function iMe(){return this._isValid}function sMe(){return ja(NaN)}function ER(t){var e=cF(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,u=e.millisecond||0;this._isValid=nMe(e),this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=ou(),this._bubble()}function jx(t){return t instanceof ER}function EM(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function oMe(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<n;o++)It(t[o])!==It(e[o])&&s++;return s+i}function jX(t,e){Qe(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Ll(~~(r/60),2)+e+Ll(~~r%60,2)})}jX("Z",":");jX("ZZ","");$e("Z",xR);$e("ZZ",xR);dr(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=SF(xR,t)});var aMe=/([\+\-]|\d\d)/gi;function SF(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(aMe)||["-",0,0],s=+(i[1]*60)+It(i[2]),s===0?0:i[0]==="+"?s:-s)}function xF(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(La(t)||p1(t)?t.valueOf():Ar(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),_e.updateOffset(r,!1),r):Ar(t).local()}function RM(t){return-Math.round(t._d.getTimezoneOffset())}_e.updateOffset=function(){};function lMe(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=SF(xR,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=RM(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?GX(this,ja(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,_e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:RM(this)}function cMe(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function uMe(t){return this.utcOffset(0,t)}function hMe(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(RM(this),"m")),this}function fMe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=SF(IIe,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function dMe(t){return this.isValid()?(t=t?Ar(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function gMe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function mMe(){if(!ms(this._isDSTShifted))return this._isDSTShifted;var t={},e;return oF(t,this),t=BX(t),t._a?(e=t._isUTC?zl(t._a):Ar(t._a),this._isDSTShifted=this.isValid()&&oMe(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function pMe(){return this.isValid()?!this._isUTC:!1}function vMe(){return this.isValid()?this._isUTC:!1}function UX(){return this.isValid()?this._isUTC&&this._offset===0:!1}var wMe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,yMe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ja(t,e){var r=t,n=null,i,s,o;return jx(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Kc(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=wMe.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:It(n[El])*i,h:It(n[Wn])*i,m:It(n[Pa])*i,s:It(n[Tc])*i,ms:It(EM(n[Jf]*1e3))*i}):(n=yMe.exec(t))?(i=n[1]==="-"?-1:1,r={y:qh(n[2],i),M:qh(n[3],i),w:qh(n[4],i),d:qh(n[5],i),h:qh(n[6],i),m:qh(n[7],i),s:qh(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=CMe(Ar(r.from),Ar(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new ER(r),jx(t)&&Kt(t,"_locale")&&(s._locale=t._locale),jx(t)&&Kt(t,"_isValid")&&(s._isValid=t._isValid),s}ja.fn=ER.prototype;ja.invalid=sMe;function qh(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function xW(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function CMe(t,e){var r;return t.isValid()&&e.isValid()?(e=xF(e,t),t.isBefore(e)?r=xW(t,e):(r=xW(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function zX(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(CX(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=ja(r,n),GX(this,i,t),this}}function GX(t,e,r,n){var i=e._milliseconds,s=EM(e._days),o=EM(e._months);t.isValid()&&(n=n??!0,o&&AX(t,my(t,"Month")+o*r),s&&TX(t,"Date",my(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&_e.updateOffset(t,s||o))}var SMe=zX(1,"add"),xMe=zX(-1,"subtract");function YX(t){return typeof t=="string"||t instanceof String}function bMe(t){return La(t)||p1(t)||YX(t)||Kc(t)||EMe(t)||_Me(t)||t===null||t===void 0}function _Me(t){var e=fd(t)&&!iF(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=n.length;for(i=0;i<o;i+=1)s=n[i],r=r||Kt(t,s);return e&&r}function EMe(t){var e=Ha(t),r=!1;return e&&(r=t.filter(function(n){return!Kc(n)&&YX(t)}).length===0),e&&r}function RMe(t){var e=fd(t)&&!iF(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||Kt(t,s);return e&&r}function TMe(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function kMe(t,e){arguments.length===1&&(arguments[0]?bMe(arguments[0])?(t=arguments[0],e=void 0):RMe(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ar(),n=xF(r,this).startOf("day"),i=_e.calendarFormat(this,n)||"sameElse",s=e&&(Gl(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,Ar(r)))}function PMe(){return new v1(this)}function AMe(t,e){var r=La(t)?t:Ar(t);return this.isValid()&&r.isValid()?(e=Qo(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function IMe(t,e){var r=La(t)?t:Ar(t);return this.isValid()&&r.isValid()?(e=Qo(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function OMe(t,e,r,n){var i=La(t)?t:Ar(t),s=La(e)?e:Ar(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function MMe(t,e){var r=La(t)?t:Ar(t),n;return this.isValid()&&r.isValid()?(e=Qo(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function NMe(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function DMe(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function FMe(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=xF(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Qo(e),e){case"year":s=Ux(this,n)/12;break;case"month":s=Ux(this,n);break;case"quarter":s=Ux(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:Fo(s)}function Ux(t,e){if(t.date()<e.date())return-Ux(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}_e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";_e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function HMe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function LMe(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Wx(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Gl(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Wx(r,"Z")):Wx(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function $Me(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function BMe(t){t||(t=this.isUtc()?_e.defaultFormatUtc:_e.defaultFormat);var e=Wx(this,t);return this.localeData().postformat(e)}function VMe(t,e){return this.isValid()&&(La(t)&&t.isValid()||Ar(t).isValid())?ja({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function WMe(t){return this.from(Ar(),t)}function jMe(t,e){return this.isValid()&&(La(t)&&t.isValid()||Ar(t).isValid())?ja({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function UMe(t){return this.to(Ar(),t)}function KX(t){var e;return t===void 0?this._locale._abbr:(e=ou(t),e!=null&&(this._locale=e),this)}var XX=Jo("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function qX(){return this._locale}var m_=1e3,qm=60*m_,p_=60*qm,JX=(365*400+97)*24*p_;function Jm(t,e){return(t%e+e)%e}function QX(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-JX:new Date(t,e,r).valueOf()}function ZX(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-JX:Date.UTC(t,e,r)}function zMe(t){var e,r;if(t=Qo(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?ZX:QX,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Jm(e+(this._isUTC?0:this.utcOffset()*qm),p_);break;case"minute":e=this._d.valueOf(),e-=Jm(e,qm);break;case"second":e=this._d.valueOf(),e-=Jm(e,m_);break}return this._d.setTime(e),_e.updateOffset(this,!0),this}function GMe(t){var e,r;if(t=Qo(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?ZX:QX,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=p_-Jm(e+(this._isUTC?0:this.utcOffset()*qm),p_)-1;break;case"minute":e=this._d.valueOf(),e+=qm-Jm(e,qm)-1;break;case"second":e=this._d.valueOf(),e+=m_-Jm(e,m_)-1;break}return this._d.setTime(e),_e.updateOffset(this,!0),this}function YMe(){return this._d.valueOf()-(this._offset||0)*6e4}function KMe(){return Math.floor(this.valueOf()/1e3)}function XMe(){return new Date(this.valueOf())}function qMe(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function JMe(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function QMe(){return this.isValid()?this.toISOString():null}function ZMe(){return sF(this)}function e2e(){return rh({},pt(this))}function t2e(){return pt(this).overflow}function r2e(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Qe("N",0,0,"eraAbbr");Qe("NN",0,0,"eraAbbr");Qe("NNN",0,0,"eraAbbr");Qe("NNNN",0,0,"eraName");Qe("NNNNN",0,0,"eraNarrow");Qe("y",["y",1],"yo","eraYear");Qe("y",["yy",2],0,"eraYear");Qe("y",["yyy",3],0,"eraYear");Qe("y",["yyyy",4],0,"eraYear");$e("N",bF);$e("NN",bF);$e("NNN",bF);$e("NNNN",d2e);$e("NNNNN",g2e);dr(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?pt(r).era=i:pt(r).invalidEra=t});$e("y",zp);$e("yy",zp);$e("yyy",zp);$e("yyyy",zp);$e("yo",m2e);dr(["y","yy","yyy","yyyy"],Mi);dr(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Mi]=r._locale.eraYearOrdinalParse(t,i):e[Mi]=parseInt(t,10)});function n2e(t,e){var r,n,i,s=this._eras||ou("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=_e(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=_e(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function i2e(t,e,r){var n,i,s=this.eras(),o,a,l;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(o=s[n].name.toUpperCase(),a=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[n];break;case"NNNN":if(o===t)return s[n];break;case"NNNNN":if(l===t)return s[n];break}else if([o,a,l].indexOf(t)>=0)return s[n]}function s2e(t,e){var r=t.since<=t.until?1:-1;return e===void 0?_e(t.since).year():_e(t.since).year()+(e-t.offset)*r}function o2e(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function a2e(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function l2e(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function c2e(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-_e(i[t].since).year())*r+i[t].offset;return this.year()}function u2e(t){return Kt(this,"_erasNameRegex")||_F.call(this),t?this._erasNameRegex:this._erasRegex}function h2e(t){return Kt(this,"_erasAbbrRegex")||_F.call(this),t?this._erasAbbrRegex:this._erasRegex}function f2e(t){return Kt(this,"_erasNarrowRegex")||_F.call(this),t?this._erasNarrowRegex:this._erasRegex}function bF(t,e){return e.erasAbbrRegex(t)}function d2e(t,e){return e.erasNameRegex(t)}function g2e(t,e){return e.erasNarrowRegex(t)}function m2e(t,e){return e._eraYearOrdinalRegex||zp}function _F(){var t=[],e=[],r=[],n=[],i,s,o,a,l,c=this.eras();for(i=0,s=c.length;i<s;++i)o=Lc(c[i].name),a=Lc(c[i].abbr),l=Lc(c[i].narrow),e.push(o),t.push(a),r.push(l),n.push(o),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Qe(0,["gg",2],0,function(){return this.weekYear()%100});Qe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function RR(t,e){Qe(0,[t,t.length],0,e)}RR("gggg","weekYear");RR("ggggg","weekYear");RR("GGGG","isoWeekYear");RR("GGGGG","isoWeekYear");$e("G",SR);$e("g",SR);$e("GG",Ir,ho);$e("gg",Ir,ho);$e("GGGG",hF,uF);$e("gggg",hF,uF);$e("GGGGG",CR,wR);$e("ggggg",CR,wR);y1(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=It(t)});y1(["gg","GG"],function(t,e,r,n){e[n]=_e.parseTwoDigitYear(t)});function p2e(t){return eq.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function v2e(t){return eq.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function w2e(){return $c(this.year(),1,4)}function y2e(){return $c(this.isoWeekYear(),1,4)}function C2e(){var t=this.localeData()._week;return $c(this.year(),t.dow,t.doy)}function S2e(){var t=this.localeData()._week;return $c(this.weekYear(),t.dow,t.doy)}function eq(t,e,r,n,i){var s;return t==null?vy(this,n,i).year:(s=$c(t,n,i),e>s&&(e=s),x2e.call(this,t,e,r,n,i))}function x2e(t,e,r,n,i){var s=MX(t,e,r,n,i),o=py(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Qe("Q",0,"Qo","quarter");$e("Q",xX);dr("Q",function(t,e){e[Rc]=(It(t)-1)*3});function b2e(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Qe("D",["DD",2],"Do","date");$e("D",Ir,Gp);$e("DD",Ir,ho);$e("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});dr(["D","DD"],El);dr("Do",function(t,e){e[El]=It(t.match(Ir)[0])});var tq=Yp("Date",!0);Qe("DDD",["DDDD",3],"DDDo","dayOfYear");$e("DDD",yR);$e("DDDD",bX);dr(["DDD","DDDD"],function(t,e,r){r._dayOfYear=It(t)});function _2e(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Qe("m",["mm",2],0,"minute");$e("m",Ir,fF);$e("mm",Ir,ho);dr(["m","mm"],Pa);var E2e=Yp("Minutes",!1);Qe("s",["ss",2],0,"second");$e("s",Ir,fF);$e("ss",Ir,ho);dr(["s","ss"],Tc);var R2e=Yp("Seconds",!1);Qe("S",0,0,function(){return~~(this.millisecond()/100)});Qe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Qe(0,["SSS",3],0,"millisecond");Qe(0,["SSSS",4],0,function(){return this.millisecond()*10});Qe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Qe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Qe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Qe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Qe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});$e("S",yR,xX);$e("SS",yR,ho);$e("SSS",yR,bX);var nh,rq;for(nh="SSSS";nh.length<=9;nh+="S")$e(nh,zp);function T2e(t,e){e[Jf]=It(("0."+t)*1e3)}for(nh="S";nh.length<=9;nh+="S")dr(nh,T2e);rq=Yp("Milliseconds",!1);Qe("z",0,0,"zoneAbbr");Qe("zz",0,0,"zoneName");function k2e(){return this._isUTC?"UTC":""}function P2e(){return this._isUTC?"Coordinated Universal Time":""}var Pe=v1.prototype;Pe.add=SMe;Pe.calendar=kMe;Pe.clone=PMe;Pe.diff=FMe;Pe.endOf=GMe;Pe.format=BMe;Pe.from=VMe;Pe.fromNow=WMe;Pe.to=jMe;Pe.toNow=UMe;Pe.get=$Ie;Pe.invalidAt=t2e;Pe.isAfter=AMe;Pe.isBefore=IMe;Pe.isBetween=OMe;Pe.isSame=MMe;Pe.isSameOrAfter=NMe;Pe.isSameOrBefore=DMe;Pe.isValid=ZMe;Pe.lang=XX;Pe.locale=KX;Pe.localeData=qX;Pe.max=ZOe;Pe.min=QOe;Pe.parsingFlags=e2e;Pe.set=BIe;Pe.startOf=zMe;Pe.subtract=xMe;Pe.toArray=qMe;Pe.toObject=JMe;Pe.toDate=XMe;Pe.toISOString=LMe;Pe.inspect=$Me;typeof Symbol<"u"&&Symbol.for!=null&&(Pe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Pe.toJSON=QMe;Pe.toString=HMe;Pe.unix=KMe;Pe.valueOf=YMe;Pe.creationData=r2e;Pe.eraName=o2e;Pe.eraNarrow=a2e;Pe.eraAbbr=l2e;Pe.eraYear=c2e;Pe.year=RX;Pe.isLeapYear=LIe;Pe.weekYear=p2e;Pe.isoWeekYear=v2e;Pe.quarter=Pe.quarters=b2e;Pe.month=IX;Pe.daysInMonth=XIe;Pe.week=Pe.weeks=nOe;Pe.isoWeek=Pe.isoWeeks=iOe;Pe.weeksInYear=C2e;Pe.weeksInWeekYear=S2e;Pe.isoWeeksInYear=w2e;Pe.isoWeeksInISOWeekYear=y2e;Pe.date=tq;Pe.day=Pe.days=vOe;Pe.weekday=wOe;Pe.isoWeekday=yOe;Pe.dayOfYear=_2e;Pe.hour=Pe.hours=ROe;Pe.minute=Pe.minutes=E2e;Pe.second=Pe.seconds=R2e;Pe.millisecond=Pe.milliseconds=rq;Pe.utcOffset=lMe;Pe.utc=uMe;Pe.local=hMe;Pe.parseZone=fMe;Pe.hasAlignedHourOffset=dMe;Pe.isDST=gMe;Pe.isLocal=pMe;Pe.isUtcOffset=vMe;Pe.isUtc=UX;Pe.isUTC=UX;Pe.zoneAbbr=k2e;Pe.zoneName=P2e;Pe.dates=Jo("dates accessor is deprecated. Use date instead.",tq);Pe.months=Jo("months accessor is deprecated. Use month instead",IX);Pe.years=Jo("years accessor is deprecated. Use year instead",RX);Pe.zone=Jo("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",cMe);Pe.isDSTShifted=Jo("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",mMe);function A2e(t){return Ar(t*1e3)}function I2e(){return Ar.apply(null,arguments).parseZone()}function nq(t){return t}var Xt=aF.prototype;Xt.calendar=pIe;Xt.longDateFormat=CIe;Xt.invalidDate=xIe;Xt.ordinal=EIe;Xt.preparse=nq;Xt.postformat=nq;Xt.relativeTime=TIe;Xt.pastFuture=kIe;Xt.set=gIe;Xt.eras=n2e;Xt.erasParse=i2e;Xt.erasConvertYear=s2e;Xt.erasAbbrRegex=h2e;Xt.erasNameRegex=u2e;Xt.erasNarrowRegex=f2e;Xt.months=zIe;Xt.monthsShort=GIe;Xt.monthsParse=KIe;Xt.monthsRegex=JIe;Xt.monthsShortRegex=qIe;Xt.week=ZIe;Xt.firstDayOfYear=rOe;Xt.firstDayOfWeek=tOe;Xt.weekdays=fOe;Xt.weekdaysMin=gOe;Xt.weekdaysShort=dOe;Xt.weekdaysParse=pOe;Xt.weekdaysRegex=COe;Xt.weekdaysShortRegex=SOe;Xt.weekdaysMinRegex=xOe;Xt.isPM=_Oe;Xt.meridiem=TOe;function v_(t,e,r,n){var i=ou(),s=zl().set(n,e);return i[r](s,t)}function iq(t,e,r){if(Kc(t)&&(e=t,t=void 0),t=t||"",e!=null)return v_(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=v_(t,n,r,"month");return i}function EF(t,e,r,n){typeof t=="boolean"?(Kc(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Kc(e)&&(r=e,e=void 0),e=e||"");var i=ou(),s=t?i._week.dow:0,o,a=[];if(r!=null)return v_(e,(r+s)%7,n,"day");for(o=0;o<7;o++)a[o]=v_(e,(o+s)%7,n,"day");return a}function O2e(t,e){return iq(t,e,"months")}function M2e(t,e){return iq(t,e,"monthsShort")}function N2e(t,e,r){return EF(t,e,r,"weekdays")}function D2e(t,e,r){return EF(t,e,r,"weekdaysShort")}function F2e(t,e,r){return EF(t,e,r,"weekdaysMin")}wh("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=It(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});_e.lang=Jo("moment.lang is deprecated. Use moment.locale instead.",wh);_e.langData=Jo("moment.langData is deprecated. Use moment.localeData instead.",ou);var Xl=Math.abs;function H2e(){var t=this._data;return this._milliseconds=Xl(this._milliseconds),this._days=Xl(this._days),this._months=Xl(this._months),t.milliseconds=Xl(t.milliseconds),t.seconds=Xl(t.seconds),t.minutes=Xl(t.minutes),t.hours=Xl(t.hours),t.months=Xl(t.months),t.years=Xl(t.years),this}function sq(t,e,r,n){var i=ja(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function L2e(t,e){return sq(this,t,e,1)}function $2e(t,e){return sq(this,t,e,-1)}function bW(t){return t<0?Math.floor(t):Math.ceil(t)}function B2e(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,o,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=bW(TM(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Fo(t/1e3),n.seconds=i%60,s=Fo(i/60),n.minutes=s%60,o=Fo(s/60),n.hours=o%24,e+=Fo(o/24),l=Fo(oq(e)),r+=l,e-=bW(TM(l)),a=Fo(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function oq(t){return t*4800/146097}function TM(t){return t*146097/4800}function V2e(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Qo(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+oq(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(TM(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function au(t){return function(){return this.as(t)}}var aq=au("ms"),W2e=au("s"),j2e=au("m"),U2e=au("h"),z2e=au("d"),G2e=au("w"),Y2e=au("M"),K2e=au("Q"),X2e=au("y"),q2e=aq;function J2e(){return ja(this)}function Q2e(t){return t=Qo(t),this.isValid()?this[t+"s"]():NaN}function ig(t){return function(){return this.isValid()?this._data[t]:NaN}}var Z2e=ig("milliseconds"),eNe=ig("seconds"),tNe=ig("minutes"),rNe=ig("hours"),nNe=ig("days"),iNe=ig("months"),sNe=ig("years");function oNe(){return Fo(this.days()/7)}var mc=Math.round,Om={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function aNe(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function lNe(t,e,r,n){var i=ja(t).abs(),s=mc(i.as("s")),o=mc(i.as("m")),a=mc(i.as("h")),l=mc(i.as("d")),c=mc(i.as("M")),u=mc(i.as("w")),h=mc(i.as("y")),f=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(f=f||u<=1&&["w"]||u<r.w&&["ww",u]),f=f||c<=1&&["M"]||c<r.M&&["MM",c]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=n,aNe.apply(null,f)}function cNe(t){return t===void 0?mc:typeof t=="function"?(mc=t,!0):!1}function uNe(t,e){return Om[t]===void 0?!1:e===void 0?Om[t]:(Om[t]=e,t==="s"&&(Om.ss=e-1),!0)}function hNe(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Om,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Om,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=lNe(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var eP=Math.abs;function mg(t){return(t>0)-(t<0)||+t}function TR(){if(!this.isValid())return this.localeData().invalidDate();var t=eP(this._milliseconds)/1e3,e=eP(this._days),r=eP(this._months),n,i,s,o,a=this.asSeconds(),l,c,u,h;return a?(n=Fo(t/60),i=Fo(n/60),t%=60,n%=60,s=Fo(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=mg(this._months)!==mg(a)?"-":"",u=mg(this._days)!==mg(a)?"-":"",h=mg(this._milliseconds)!==mg(a)?"-":"",l+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(e?u+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+o+"S":"")):"P0D"}var $t=ER.prototype;$t.isValid=iMe;$t.abs=H2e;$t.add=L2e;$t.subtract=$2e;$t.as=V2e;$t.asMilliseconds=aq;$t.asSeconds=W2e;$t.asMinutes=j2e;$t.asHours=U2e;$t.asDays=z2e;$t.asWeeks=G2e;$t.asMonths=Y2e;$t.asQuarters=K2e;$t.asYears=X2e;$t.valueOf=q2e;$t._bubble=B2e;$t.clone=J2e;$t.get=Q2e;$t.milliseconds=Z2e;$t.seconds=eNe;$t.minutes=tNe;$t.hours=rNe;$t.days=nNe;$t.weeks=oNe;$t.months=iNe;$t.years=sNe;$t.humanize=hNe;$t.toISOString=TR;$t.toString=TR;$t.toJSON=TR;$t.locale=KX;$t.localeData=qX;$t.toIsoString=Jo("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",TR);$t.lang=XX;Qe("X",0,0,"unix");Qe("x",0,0,"valueOf");$e("x",SR);$e("X",OIe);dr("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});dr("x",function(t,e,r){r._d=new Date(It(t))});//! moment.js
_e.version="2.30.1";fIe(Ar);_e.fn=Pe;_e.min=eMe;_e.max=tMe;_e.now=rMe;_e.utc=zl;_e.unix=A2e;_e.months=O2e;_e.isDate=p1;_e.locale=wh;_e.invalid=vR;_e.duration=ja;_e.isMoment=La;_e.weekdays=N2e;_e.parseZone=I2e;_e.localeData=ou;_e.isDuration=jx;_e.monthsShort=M2e;_e.weekdaysMin=F2e;_e.defineLocale=vF;_e.updateLocale=IOe;_e.locales=OOe;_e.weekdaysShort=D2e;_e.normalizeUnits=Qo;_e.relativeTimeRounding=cNe;_e.relativeTimeThreshold=uNe;_e.calendarFormat=TMe;_e.prototype=Pe;_e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function fNe(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function _W(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function zx(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function Ns(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function Od(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function At(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function Z(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function dNe(t){const e=[];return Z(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function EW(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return Z(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function RW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Qt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Ns(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),c=r[a]?r[a]:"";return s+l+c},"").trim()}function Fr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Le(t){return typeof t<"u"}function Dr(t){return typeof t>"u"}function an(t){return t===null||t===""||Dr(t)}function gNe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const kv="length",nw=t=>parseInt(t,16),TW=t=>parseInt(t,10),w_=(t,e,r)=>t.substr(e,r),iw=t=>t.codePointAt(0)-65,kM=t=>`${t}`.replace(/\-/g,""),mNe=t=>nw(w_(kM(t),nw("12"),iw("F")))/(nw(w_(kM(t),iw("B"),~~![][kv]))||9),pNe=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let kW=!1;const PW={invalid:()=>Qt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Qt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Qt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},AW={invalid:()=>Qt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Qt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Qt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function vNe(t,e){const r=!an(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let s,o="invalid",a="invalid";t=kM(t||"");const l=wNe(t);if(r||n||l)if(l){const c=_e("10/07/2025","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),h=mNe(t);s=_e((h+1)*864e5,"x").format("MMMM DD, YYYY"),u>h?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(pNe()&&(o="valid",a="valid"),!kW&&o!=="valid"&&(PW[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](PW[o]({keyValidityDate:s,hotVersion:i})),kW=!0),a!=="valid"&&e&&AW[a]({keyValidityDate:s,hotVersion:i})){const u=document.createElement("div");u.className="handsontable hot-display-license-info",u.innerHTML=AW[a]({keyValidityDate:s,hotVersion:i}),e.appendChild(u)}}function wNe(t){let e=[][kv],r=e;if(t[kv]!==iw("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=iw(i.shift());s;s=iw(i.shift()||"A"))--s<""[kv]?r=r|(TW(`${TW(nw(n)+(nw(w_(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=w_(t,s,s?i[kv]===1?9:8:6);return r===e}function $a(t){return t[0].toUpperCase()+t.substr(1)}function lq(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function cq(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function uq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function IW(t){return RF(`${t}`,{ALLOWED_TAGS:[]})}function RF(t,e){return hIe.sanitize(t,e)}const Vh=t=>["tabindex",t],yNe=()=>["role","treegrid"],kc=()=>["role","presentation"],CNe=()=>["role","gridcell"],SNe=()=>["role","gridcell button"],xNe=()=>["role","rowheader"],hq=()=>["role","rowgroup"],bNe=()=>["role","columnheader"],fq=()=>["role","row"],_Ne=()=>["role","menu"],ENe=()=>["role","menuitem"],RNe=()=>["role","menuitemcheckbox"],TNe=()=>["role","combobox"],dq=()=>["role","listbox"],kNe=()=>["role","option"],PNe=()=>["role","checkbox"],ANe=()=>["scope","col"],INe=()=>["scope","row"],ONe=()=>["type","text"],wp=t=>["aria-label",t],sg=()=>["aria-hidden","true"],MNe=()=>["aria-disabled","true"],NNe=()=>["aria-multiselectable","true"],gq=t=>["aria-haspopup",t],mq=t=>["aria-rowcount",t],kR=t=>["aria-colcount",t],pq=t=>["aria-rowindex",t],TF=t=>["aria-colindex",t],jo=t=>["aria-expanded",t],DNe=t=>["aria-sort",t],OW=()=>["aria-readonly","true"],MW=()=>["aria-invalid","true"],vq=t=>["aria-checked",t],kF=()=>["aria-selected","true"],FNe=()=>["aria-autocomplete","list"],HNe=t=>["aria-controls",t],LNe=t=>["aria-activedescendant",t],$Ne=t=>["aria-live",t],BNe=t=>["aria-relevant",t],VNe=t=>["aria-setsize",t],WNe=t=>["aria-posinset",t];var jNe=wn,NW=xK,UNe=Nn,DW=Qd,zNe=pR,FW=jNe([].push),GNe=function(t){if(UNe(t))return t;if(NW(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?FW(r,i):(typeof i=="number"||DW(i)==="Number"||DW(i)==="String")&&FW(r,zNe(i))}var s=r.length,o=!0;return function(a,l){if(o)return o=!1,l;if(NW(this))return l;for(var c=0;c<s;c++)if(r[c]===a)return l}}},YNe=wr,wq=Bp,yq=d1,KNe=Mn,C1=wn,Cq=On,HW=Nn,LW=LD,Sq=rF,XNe=GNe,qNe=HD,JNe=String,yh=wq("JSON","stringify"),NC=C1(/./.exec),$W=C1("".charAt),QNe=C1("".charCodeAt),ZNe=C1("".replace),eDe=C1(1.1.toString),tDe=/[\uD800-\uDFFF]/g,BW=/^[\uD800-\uDBFF]$/,VW=/^[\uDC00-\uDFFF]$/,WW=!qNe||Cq(function(){var t=wq("Symbol")("stringify detection");return yh([t])!=="[null]"||yh({a:t})!=="{}"||yh(Object(t))!=="{}"}),jW=Cq(function(){return yh("\uDF06\uD834")!=='"\\udf06\\ud834"'||yh("\uDEAD")!=='"\\udead"'}),rDe=function(t,e){var r=Sq(arguments),n=XNe(e);if(!(!HW(n)&&(t===void 0||LW(t))))return r[1]=function(i,s){if(HW(n)&&(s=KNe(n,this,JNe(i),s)),!LW(s))return s},yq(yh,null,r)},nDe=function(t,e,r){var n=$W(r,e-1),i=$W(r,e+1);return NC(BW,t)&&!NC(VW,i)||NC(VW,t)&&!NC(BW,n)?"\\u"+eDe(QNe(t,0),16):t};yh&&YNe({target:"JSON",stat:!0,arity:3,forced:WW||jW},{stringify:function(e,r,n){var i=Sq(arguments),s=yq(WW?rDe:yh,null,i);return jW&&typeof s=="string"?ZNe(s,tDe,nDe):s}});function yy(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},St(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=yy(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[yy(r[0])]:e[n]=[]:e[n]=null)})),e}function iDe(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function In(t,e,r){const n=Array.isArray(r);return St(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function PR(t,e){St(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),PR(t[n],e[n])):t[n]=e[n]})}function ns(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function $l(t){const e={};return St(t,(r,n)=>{e[n]=r}),e}function ur(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Z(r,i=>{t.MIXINS.push(i.MIXIN_NAME),St(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(u,h){const f=`_${u}`,d=g=>{let m=g;return(Array.isArray(m)||Ct(m))&&(m=ns(m)),m};return function(){return this[f]===void 0&&(this[f]=d(h)),this[f]}},l=function(u){const h=`_${u}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function PF(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ct(t){return Object.prototype.toString.call(t)==="[object Object]"}function lu(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function St(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function sDe(t,e){const r=e.split(".");let n=t;return St(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function tP(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==n.length-1?(Pn(i,s)||(i[s]={}),i=i[s]):i[s]=r)})}function AF(t){if(!Ct(t))return 0;const e=function(r){let n=0;return Ct(r)?St(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function eo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function y_(t){return window.requestAnimationFrame(t)}function C_(t){window.cancelAnimationFrame(t)}function xq(){return"ontouchstart"in window}function oDe(){return typeof window<"u"}let pg;function aDe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return pg||(typeof Intl=="object"?pg=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?pg=(r,n)=>`${r}`.localeCompare(n):pg=(r,n)=>r===n?0:r>n?-1:1,pg)}const ko=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Wh={chrome:ko((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ko(t=>/CriOS/.test(t)),edge:ko(t=>/Edge/.test(t)),edgeWebKit:ko(t=>/EdgiOS/.test(t)),firefox:ko(t=>/Firefox/.test(t)),firefoxWebKit:ko(t=>/FxiOS/.test(t)),mobile:ko(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ko((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},S1={mac:ko(t=>/^Mac/.test(t)),win:ko(t=>/^Win/.test(t)),linux:ko(t=>/^Linux/.test(t)),ios:ko(t=>/iPhone|iPad|iPod/i.test(t))};function lDe(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};St(Wh,r=>{let{test:n}=r;return void n(t,e)})}function cDe(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};St(S1,e=>{let{test:r}=e;return void r(t)})}oDe()&&(lDe(),cDe());function bq(){return Wh.chrome.value}function uDe(){return Wh.chromeWebKit.value}function rP(){return Wh.firefox.value}function hDe(){return Wh.firefoxWebKit.value}function Cy(){return Wh.safari.value}function fDe(){return Wh.edge.value}function Il(){return Wh.mobile.value}function _q(){return S1.ios.value}function Eq(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&S1.mac.value}function PM(){return S1.win.value}function UW(){return S1.mac.value}function dDe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Gx(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function gDe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function yp(t){return gDe(t)&&t.parent}function Md(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function DC(t,e,r){const n=[];let i=t;for(;i&&(i=Md(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function mDe(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(s=>e.test(s));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function dd(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function pDe(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Jh(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function Rq(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Tq(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function tt(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Se(t,e){typeof e=="string"&&(e=e.split(" ")),e=Rq(e),e.length>0&&t.classList.add(...e)}function Je(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=Tq(e,!0);r=Rq(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function et(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Kp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=Tq(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function kq(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)kq(e[r])}}function Xc(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const vDe=/(<(.*)>|&(.*);)/;function Xp(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;vDe.test(e)?t.innerHTML=r?RF(e):e:Nd(t,e)}function Nd(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Xc(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Cp(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Cp(n.host.impl);if(n.host)return Cp(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function wDe(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Ai(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function Pq(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function IF(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function OF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Pq(e):t.scrollTop}function Aq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?IF(e):t.scrollLeft}function S_(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function yDe(t){return t.scrollHeight-t.clientHeight}function CDe(t){return t.scrollWidth-t.clientWidth}function Sy(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return n;n=n.parentNode}return r}function x_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function mn(t){return t.offsetWidth}function An(t){return t.offsetHeight}function sw(t){return t.clientHeight||t.innerHeight}function Iq(t){return t.clientWidth||t.innerWidth}function Oq(t){return t.selectionStart?t.selectionStart:0}function SDe(t){return t.selectionEnd?t.selectionEnd:0}function zW(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function AR(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let nP;function Mq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return PM()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function xDe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");Cy()&&!Il()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i+Mq(t)}function ei(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return nP===void 0&&(nP=xDe(t)),nP}function Nq(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function Dq(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function MF(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function IR(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Yx(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Fq(t){return Yx(t)&&t.hasAttribute("data-hot-input")===!1}function Hq(t){return!t.parentNode}function bDe(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Lq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();et(t,"contenteditable",!0),r&&et(t,...sg()),e&&Se(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function $q(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Je(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function _De(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Lq(t,r),e(),$q(t,r)}function Bc(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function er(t){return typeof t=="function"}function OR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function Bq(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function EDe(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=n.concat(o);let c;return l.length>=e?c=t.apply(this,l):c=r(l),c}}return r([])}function AM(t,e,r,n,i,s,o,a){return Le(a)?t.call(e,r,n,i,s,o,a):Le(o)?t.call(e,r,n,i,s,o):Le(s)?t.call(e,r,n,i,s):Le(i)?t.call(e,r,n,i):Le(n)?t.call(e,r,n):Le(r)?t.call(e,r):t.call(e)}const Ke={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:rP()?182:174,AUDIO_MUTE:rP()?181:173,AUDIO_UP:rP()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},RDe=[Ke.ALT,Ke.ARROW_DOWN,Ke.ARROW_LEFT,Ke.ARROW_RIGHT,Ke.ARROW_UP,Ke.AUDIO_DOWN,Ke.AUDIO_MUTE,Ke.AUDIO_UP,Ke.BACKSPACE,Ke.CAPS_LOCK,Ke.DELETE,Ke.END,Ke.ENTER,Ke.ESCAPE,Ke.F1,Ke.F2,Ke.F3,Ke.F4,Ke.F5,Ke.F6,Ke.F7,Ke.F8,Ke.F9,Ke.F10,Ke.F11,Ke.F12,Ke.F13,Ke.F14,Ke.F15,Ke.F16,Ke.F17,Ke.F18,Ke.F19,Ke.HOME,Ke.INSERT,Ke.MEDIA_NEXT,Ke.MEDIA_PLAY_PAUSE,Ke.MEDIA_PREV,Ke.MEDIA_STOP,Ke.NULL,Ke.NUM_LOCK,Ke.PAGE_DOWN,Ke.PAGE_UP,Ke.PAUSE,Ke.SCROLL_LOCK,Ke.SHIFT,Ke.TAB];function TDe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Vq(t){return RDe.includes(t)}function kDe(t){return[Ke.CONTROL,Ke.COMMAND_LEFT,Ke.COMMAND_RIGHT,Ke.COMMAND_FIREFOX].includes(t)}function x1(t,e){const r=e.split("|");let n=!1;return Z(r,i=>{if(t===Ke[i])return n=!0,!1}),n}function Ua(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function jf(t){return t.isImmediatePropagationEnabled===!1}function Dd(t){return t.button===2}function NF(t){return t.button===0}function PDe(t){return t instanceof TouchEvent}function ADe(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!Bc(e)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}function zt(){Le(console)&&console.warn(...arguments)}function DF(){Le(console)&&console.error(...arguments)}const Uf=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],iP=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),sP=new Map([[]]);var IDe=jp,ODe=function(t,e,r){for(var n=0,i=arguments.length>2?r:IDe(e),s=new t(i);i>n;)s[n]=e[n++];return s},MDe=vn,NDe=function(t,e){var r=MDe[t],n=r&&r.prototype;return n&&n[e]},DDe=Wa,FDe=WK,HDe=su.f,IM=DDe("unscopables"),OM=Array.prototype;OM[IM]===void 0&&HDe(OM,IM,{configurable:!0,value:FDe(null)});var MR=function(t){OM[IM][t]=!0},LDe=wr,$De=wn,BDe=Os,VDe=l1,WDe=ODe,jDe=NDe,UDe=MR,zDe=Array,GDe=$De(jDe("Array","sort"));LDe({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&BDe(e);var r=VDe(this),n=WDe(zDe,r);return GDe(n,e)}});UDe("toSorted");var YDe=wr,KDe=Mn,XDe=Up,qDe=Os,JDe=Dn,QDe=Ul,ZDe=Ms,eFe=Bh,oP=eFe("find",TypeError);YDe({target:"Iterator",proto:!0,real:!0,forced:oP},{find:function(e){JDe(this);try{qDe(e)}catch(i){ZDe(this,"throw",i)}if(oP)return KDe(oP,this,e);var r=QDe(this),n=0;return XDe(r,function(i,s){if(e(i,n++))return s(i)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function tFe(t,e){Wq(t,e),e.add(t)}function aP(t,e,r){Wq(t,e),e.set(t,r)}function Wq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GW(t,e,r){return t.set(b_(t,e),r),r}function si(t,e){return t.get(b_(t,e))}function b_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const rFe=100;var Ls=new WeakMap,im=new WeakMap,lP=new WeakMap,cP=new WeakSet;class YW{constructor(){tFe(this,cP),aP(this,Ls,new Map),aP(this,im,new Map),aP(this,lP,new Set),Uf.forEach(e=>b_(cP,this,KW).call(this,e))}getHooks(e){var r;return(r=si(Ls,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};si(Ls,this).has(e)||(b_(cP,this,KW).call(this,e),Uf.push(e));const i=si(Ls,this).get(e);if(i.find(c=>c.callback===r))return;const s=Number.isInteger(n.orderIndex)?n.orderIndex:0,o=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const c=i.find(u=>u.initialHook);c&&(c.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:s,runOnce:o,initialHook:a,skip:!1});let c=si(lP,this).has(e);!c&&s!==0&&(c=!0,si(lP,this).add(e)),c&&i.length>1&&si(Ls,this).set(e,i.toSorted((u,h)=>u.orderIndex-h.orderIndex))}}has(e){return si(Ls,this).has(e)&&si(Ls,this).get(e).length>0}remove(e,r){if(!si(Ls,this).has(e))return!1;const n=si(Ls,this).get(e),i=n.find(s=>s.callback===r);if(i){let s=si(im,this).get(e);return i.skip=!0,s+=1,s>rFe&&(si(Ls,this).set(e,n.filter(o=>!o.skip)),s=0),si(im,this).set(e,s),!0}return!1}destroy(){si(Ls,this).clear(),si(im,this).clear(),GW(Ls,this,null),GW(im,this,null)}}function KW(t){si(Ls,this).set(t,[]),si(im,this).set(t,0)}function nFe(t,e,r){return(e=iFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iFe(t){var e=sFe(t,"string");return typeof e=="symbol"?e:e+""}function sFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oFe=Qt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Fe{constructor(){nFe(this,"globalBucket",new YW)}static getSingleton(){return lFe()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new YW),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Z(r,s=>this.add(e,s,n)):(iP.has(e)&&zt(uq(oFe,{hookName:e,removedInVersion:iP.get(e)})),sP.has(e)&&zt(sP.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Z(r,s=>this.once(e,s,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?Z(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,s,o,a,l){{const c=this.getBucket().getHooks(r),u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const f=AM(c[h].callback,e,n,i,s,o,a,l);f!==void 0&&(n=f),c[h]&&c[h].runOnce&&this.remove(r,c[h].callback),h+=1}}{const c=this.getBucket(e).getHooks(r),u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const f=AM(c[h].callback,e,n,i,s,o,a,l);f!==void 0&&(n=f),c[h]&&c[h].runOnce&&this.remove(r,c[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Uf.push(e)}deregister(e){this.isRegistered(e)&&Uf.splice(Uf.indexOf(e),1)}isDeprecated(e){return sP.has(e)||iP.has(e)}isRegistered(e){return Uf.indexOf(e)>=0}getRegistered(){return Uf}}const aFe=new Fe;function lFe(){return aFe}const Qf=new Map;function Zo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Qf.has(t)||Qf.set(t,new Map);const e=Qf.get(t);function r(l,c){e.set(l,c)}function n(l){return e.get(l)}function i(l){return e.has(l)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){Qf.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o,clear:a}}function cFe(t,e){var r;return Qf==null||(r=Qf.get(t.guid))===null||r===void 0?void 0:r.get(e)}const MM=new WeakMap,{register:uFe,getItem:jq,hasItem:Uq,getNames:Hrt,getValues:Lrt}=Zo("editors");function hFe(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},Fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function zq(t,e){let r;if(typeof t=="function")MM.get(t)||Bs(null,t),r=MM.get(t);else if(typeof t=="string")r=jq(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function NM(t){if(typeof t=="function")return t;if(!Uq(t))throw Error(`No registered editor found under "${t}" name`);return jq(t).getConstructor()}function Bs(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new hFe(e);typeof t=="string"&&uFe(t,r),MM.set(e,r)}function fFe(t,e,r){return(e=dFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dFe(t){var e=gFe(t,"string");return typeof e=="symbol"?e:e+""}function gFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ba{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fFe(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,mFe(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function mFe(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ua(this)},t}function pFe(t,e){vFe(t,e),e.add(t)}function vFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qh(t,e,r){return(e=wFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wFe(t){var e=yFe(t,"string");return typeof e=="symbol"?e:e+""}function yFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var FC=new WeakSet;class DM{constructor(e,r,n){pFe(this,FC),Qh(this,"hot",void 0),Qh(this,"tableMeta",void 0),Qh(this,"selection",void 0),Qh(this,"eventManager",void 0),Qh(this,"destroyed",!1),Qh(this,"activeEditor",void 0),Qh(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Ba(e),this.hot.addHook("afterDocumentKeyDown",i=>uP(FC,this,XW).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>uP(FC,this,XW).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>uP(FC,this,CFe).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let o=n,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const c=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=zq(c,this.hot),this.activeEditor.prepare(n,i,u,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function XW(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||jf(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Vq(r)&&!kDe(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function CFe(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const qW=new WeakMap;DM.getInstance=function(t,e,r){let n=qW.get(t);return n||(n=new DM(t,e,r),qW.set(t,n)),n};function SFe(t,e){Gq(t,e),e.add(t)}function b0(t,e,r){Gq(t,e),e.set(t,r)}function Gq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yr(t,e){return t.get(Cc(t,e))}function _0(t,e,r){return t.set(Cc(t,e),r),r}function Cc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Qm=Object.freeze({CELL:"cell",MIXED:"mixed"});var Tn=new WeakMap,HC=new WeakMap,LC=new WeakMap,$C=new WeakMap,BC=new WeakMap,Lu=new WeakSet;class xFe{constructor(e){var r=this;SFe(this,Lu),b0(this,Tn,void 0),b0(this,HC,void 0),b0(this,LC,1),b0(this,$C,null),b0(this,BC,new Map);const n=e.getSettings();_0(Tn,this,e),_0(HC,this,n.imeFastEdit?Qm.MIXED:Qm.CELL),yr(Tn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Cc(Lu,r,_Fe).call(r,...s)}),yr(Tn,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Cc(Lu,r,JW).call(r,...s)}),yr(Tn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Cc(Lu,r,JW).call(r,...s)}),yr(Tn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Cc(Lu,r,bFe).call(r,...s)})}getFocusMode(){return yr(HC,this)}setFocusMode(e){Object.values(Qm).includes(e)?_0(HC,this,e):zt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return yr(LC,this)}setRefocusDelay(e){_0(LC,this,e)}setRefocusElementGetter(e){_0($C,this,e)}getRefocusElement(){var e;return typeof yr($C,this)=="function"?yr($C,this).call(this):(e=yr(Tn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const o=(i=yr(Tn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=yr(Tn,this).runHooks("modifyFocusedElement",o.row,o.col,n);Bc(a)||(a=n),a&&!((s=yr(Tn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):Cc(Lu,this,FF).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yr(LC,this);if(yr(Tn,this).getSettings().imeFastEdit&&!((e=yr(Tn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=yr(Tn,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),yr(BC,this).has(r)||yr(BC,this).set(r,OR(()=>{if(!yr(Tn,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},r)),yr(BC,this).get(r)()}}}function FF(t){var e;const r=(e=yr(Tn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!yr(Tn,this).selection.isCellVisible(r)){t(null);return}const n=yr(Tn,this).getCell(r.row,r.col,!0);n===null?yr(Tn,this).addHookOnce("afterScroll",()=>{t(yr(Tn,this).getCell(r.row,r.col,!0))}):t(n)}function JW(){Cc(Lu,this,FF).call(this,t=>{const{activeElement:e}=yr(Tn,this).rootDocument;e&&Fq(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function bFe(){Cc(Lu,this,FF).call(this,t=>{this.getFocusMode()===Qm.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function _Fe(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Qm.MIXED:Qm.CELL)}var EFe=Xo,RFe=Qd,TFe=Wa,kFe=TFe("match"),PFe=function(t){var e;return EFe(t)&&((e=t[kFe])!==void 0?!!e:RFe(t)==="RegExp")},AFe=vn,IFe=On,QW=AFe.RegExp,OFe=!IFe(function(){var t=!0;try{QW(".","d")}catch{t=!1}var e={},r="",n=t?"dgimsy":"gimsy",i=function(l,c){Object.defineProperty(e,l,{get:function(){return r+=c,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};t&&(s.hasIndices="d");for(var o in s)i(o,s[o]);var a=Object.getOwnPropertyDescriptor(QW.prototype,"flags").get.call(e);return a!==n||r!==n}),MFe={correct:OFe},NFe=Dn,DFe=function(){var t=NFe(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},FFe=Mn,HFe=qo,LFe=c1,ZW=MFe,$Fe=DFe,BFe=RegExp.prototype,VFe=ZW.correct?function(t){return t.flags}:function(t){return!ZW.correct&&LFe(BFe,t)&&!HFe(t,"flags")?FFe($Fe,t):t.flags},HF=wn,WFe=Vp,jFe=Math.floor,hP=HF("".charAt),UFe=HF("".replace),fP=HF("".slice),zFe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,GFe=/\$([$&'`]|\d{1,2})/g,YFe=function(t,e,r,n,i,s){var o=r+t.length,a=n.length,l=GFe;return i!==void 0&&(i=WFe(i),l=zFe),UFe(s,l,function(c,u){var h;switch(hP(u,0)){case"$":return"$";case"&":return t;case"`":return fP(e,0,r);case"'":return fP(e,o);case"<":h=i[fP(u,1,-1)];break;default:var f=+u;if(f===0)return c;if(f>a){var d=jFe(f/10);return d===0?c:d<=a?n[d-1]===void 0?hP(u,1):n[d-1]+hP(u,1):c}h=n[f-1]}return h===void 0?"":h})},KFe=wr,XFe=Mn,LF=wn,e8=a1,qFe=Nn,JFe=Xo,QFe=PFe,E0=pR,ZFe=u1,eHe=VFe,tHe=YFe,rHe=Wa,nHe=rHe("replace"),iHe=TypeError,dP=LF("".indexOf);LF("".replace);var t8=LF("".slice),sHe=Math.max;KFe({target:"String",proto:!0},{replaceAll:function(e,r){var n=e8(this),i,s,o,a,l,c,u,h,f,d,g=0,m="";if(JFe(e)){if(i=QFe(e),i&&(s=E0(e8(eHe(e))),!~dP(s,"g")))throw new iHe("`.replaceAll` does not allow non-global regexes");if(o=ZFe(e,nHe),o)return XFe(o,e,n,r)}for(a=E0(n),l=E0(e),c=qFe(r),c||(r=E0(r)),u=l.length,h=sHe(1,u),f=dP(a,l);f!==-1;)d=c?E0(r(l,f,a)):tHe(l,a,f,[],void 0,r),m+=t8(a,g,f)+d,g=f+u,f=f+h>a.length?-1:dP(a,l,f+h);return g<a.length&&(m+=t8(a,g)),m}});var oHe=wr,aHe=Up,lHe=Os,cHe=Dn,uHe=Ul,hHe=Ms,fHe=Bh,dHe=d1,gHe=On,Yq=TypeError,Kq=gHe(function(){[].keys().reduce(function(){},void 0)}),gP=!Kq&&fHe("reduce",Yq);oHe({target:"Iterator",proto:!0,real:!0,forced:Kq||gP},{reduce:function(e){cHe(this);try{lHe(e)}catch(o){hHe(this,"throw",o)}var r=arguments.length<2,n=r?void 0:arguments[1];if(gP)return dHe(gP,this,r?[e]:[e,n]);var i=uHe(this),s=0;if(aHe(i,function(o){r?(r=!1,n=o):n=e(n,o,s),s++},{IS_RECORD:!0}),r)throw new Yq("Reduce of empty iterator with no initial value");return n}});const Xq={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},mHe=new RegExp(Object.keys(Xq).map(t=>`(${t})`).join("|"),"gi");function pHe(t){return(t&&t.nodeName||"")==="TABLE"}function r8(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=r?1:0,h=e?1:0;for(let f=0;f<s;f+=1){const d=e&&f===0,g=[];for(let p=0;p<o;p+=1){const w=!d&&r&&p===0;let v="";if(d)v=`<th>${t.getColHeader(p-u)}</th>`;else if(w)v=`<th>${t.getRowHeader(f-h)}</th>`;else{const y=i[f][p],{hidden:b,rowspan:T,colspan:E}=t.getCellMeta(f-h,p-u);if(!b){const x=[];if(T&&x.push(`rowspan="${T}"`),E&&x.push(`colspan="${E}"`),an(y))v=`<td ${x.join(" ")}></td>`;else{const P=y.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${x.join(" ")}>${P}</td>`}}}g.push(v)}const m=["<tr>",...g,"</tr>"].join("");d?l.splice(1,0,m):c.splice(-1,0,m)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function n8(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,o=[];n===0&&r.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],c=an(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${c}</td>`)}r.push("<tr>",...o,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function vHe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const y=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,b=>{const T=b.match(/<td\b[^>]*?>/g)[0],E=/<p.*?>/g,x=b.substring(T.length,b.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(E,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${T}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${y}`),s=i.querySelector("table")}if(!s||!pHe(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),c=l?Array.from(l.cells).reduce((y,b)=>y+b.colSpan,0)-(a?1:0):0,u=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let f=!1,d=0,g=0;if(s.tHead){const y=Array.from(s.tHead.rows).filter(b=>{const T=b.querySelector("td")!==null;return T&&h.push(b),!T});d=y.length,f=d>0,d>1?r.nestedHeaders=Array.from(y).reduce((b,T)=>{const E=Array.from(T.cells).reduce((x,P,A)=>{if(a&&A===0)return x;const{colSpan:O,innerHTML:Y}=P,B=O>1?{label:Y,colspan:O}:Y;return x.push(B),x},[]);return b.push(E),b},[]):f&&(r.colHeaders=Array.from(y[0].children).reduce((b,T,E)=>(a&&E===0||b.push(T.innerHTML),b),[]))}h.length&&(r.fixedRowsTop=h.length),u.length&&(r.fixedRowsBottom=u.length);const m=[...h,...Array.from(s.tBodies).reduce((y,b)=>(y.push(...Array.from(b.rows)),y),[]),...u];g=m.length;const p=new Array(g);for(let y=0;y<g;y++)p[y]=new Array(c);const w=[],v=[];for(let y=0;y<g;y++){const b=m[y],T=Array.from(b.cells),E=T.length;for(let x=0;x<E;x++){const P=T[x],{nodeName:A,innerHTML:O,rowSpan:Y,colSpan:B}=P,ie=p[y].findIndex(ue=>ue===void 0);if(A==="TD"){if(Y>1||B>1){for(let Ce=y;Ce<y+Y;Ce++)if(Ce<g)for(let ge=ie;ge<ie+B;ge++)p[Ce][ge]=null;const he=P.getAttribute("style");he&&he.includes("mso-ignore:colspan")||w.push({col:ie,row:y,rowspan:Y,colspan:B})}let ue="";o&&/excel/gi.test(o.content)?ue=O.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ue=O.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),p[y][ie]=ue.replace(mHe,he=>Xq[he])}else v.push(O)}}return w.length&&(r.mergeCells=w),v.length&&(r.rowHeaders=v),p.length&&(r.data=p),r}function Ji(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function wHe(t){return Ji(t,[","])}function je(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function i8(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function qq(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Mt(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const FM="asc",yHe="desc",s8=new Map([[FM,[-1,1]],[yHe,[1,-1]]]),CHe=t=>`The priority '${t}' is already declared in a map.`,SHe=t=>`The priority '${t}' is not a number.`;function xHe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=er(t)?t:CHe,e=er(e)?e:SHe;function n(s,o){if(!Ji(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:FM;const[o,a]=s8.get(s)||s8.get(FM);return[...r].sort((l,c)=>l[0]<c[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:i}}const bHe=t=>`The id '${t}' is already declared in a map.`;function NR(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=er(t)?t:bHe;function r(c,u){if(l(c))throw new Error(t(c));e.set(c,u)}function n(c){return e.delete(c)}function i(){e.clear()}function s(c){const[u]=a().find(h=>{let[f,d]=h;return c===d?f:!1})||[null];return u}function o(c){return e.get(c)}function a(){return[...e]}function l(c){return e.has(c)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:n}}const _He=t=>`'${t}' value is already declared in a unique set.`;function EHe(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=er(t)?t:_He;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const $F=t=>`There is already registered "${t}" plugin.`,RHe=t=>`There is already registered plugin on priority "${t}".`,THe=t=>`The priority "${t}" is not a number.`,Jq=xHe({errorPriorityExists:RHe,errorPriorityNaN:THe}),Qq=EHe({errorItemExists:$F}),HM=NR({errorIdExists:$F});function Zq(){return[...Jq.getItems(),...Qq.getItems()]}function BF(t){const e=$a(t);return HM.getItem(e)}function kHe(t){return!!BF(t)}function Dt(t,e,r){[t,e,r]=AHe(t,e,r),BF(t)===void 0&&PHe(t,e,r)}function PHe(t,e,r){const n=$a(t);if(HM.hasItem(n))throw new Error($F(n));r===void 0?Qq.addItem(n):Jq.addItem(r,n),HM.addItem(n,e)}function AHe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:IHe,getItem:OHe,hasItem:eJ,getNames:$rt,getValues:Brt}=Zo("renderers");function LM(t){if(typeof t=="function")return t;if(!eJ(t))throw Error(`No registered renderer found under "${t}" name`);return OHe(t)}function _o(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),IHe(t,e)}const{register:MHe,getItem:NHe,hasItem:tJ,getNames:Vrt,getValues:Wrt}=Zo("validators");function DHe(t){if(typeof t=="function")return t;if(!tJ(t))throw Error(`No registered validator found under "${t}" name`);return NHe(t)}function sm(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),MHe(t,e)}var FHe=wr,HHe=Vp,LHe=jp,$He=h1,BHe=MR;FHe({target:"Array",proto:!0},{at:function(e){var r=HHe(this),n=LHe(r),i=$He(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:r[s]}});BHe("at");var VHe=wr,WHe=wn,jHe=a1,UHe=h1,zHe=pR,GHe=On,YHe=WHe("".charAt),KHe=GHe(function(){return"𠮷".at(-2)!=="\uD842"});VHe({target:"String",proto:!0,forced:KHe},{at:function(e){var r=zHe(jHe(this)),n=r.length,i=UHe(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:YHe(r,s)}});function R0(t,e,r){return(e=XHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XHe(t){var e=qHe(t,"string");return typeof e=="symbol"?e:e+""}function qHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JHe{constructor(){R0(this,"count",0),R0(this,"startColumn",null),R0(this,"endColumn",null),R0(this,"startPosition",null),R0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=r,a=i>0?s+1:s;n>=i&&n+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=c[this.endColumn]+u-c[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i,f=n+i-h,d=this.startColumn===null?0:e.getColumnWidth(this.startColumn);f<-1*s||n>c.at(-1)||-1*n-i>-1*d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function T0(t,e,r){return(e=QHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QHe(t){var e=ZHe(t,"string");return typeof e=="symbol"?e:e+""}function ZHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eLe{constructor(){T0(this,"count",0),T0(this,"startRow",null),T0(this,"endRow",null),T0(this,"startPosition",null),T0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=r;n>=i&&n+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const f=l[this.endRow]+c-l[this.startRow-1];if(f<=i-s&&(this.startRow-=1),f>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const u=n+i-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);u<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function k0(t,e,r){return(e=tLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tLe(t){var e=rLe(t,"string");return typeof e=="symbol"?e:e+""}function rLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rJ{constructor(){k0(this,"count",0),k0(this,"startColumn",null),k0(this,"endColumn",null),k0(this,"startPosition",null),k0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const o=i>0?s+1:s;n>=i&&n<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const d=c[this.endColumn]+u-c[this.startColumn-1];if(this.startColumn-=1,d>i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i;n+i-h<-1*s||n>c.at(-1)+u||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function P0(t,e,r){return(e=nLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nLe(t){var e=iLe(t,"string");return typeof e=="symbol"?e:e+""}function iLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nJ{constructor(){P0(this,"count",0),P0(this,"startRow",null),P0(this,"endRow",null),P0(this,"startPosition",null),P0(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+c-l[this.startRow-1];if(this.startRow-=1,h>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>l.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function A0(t,e,r){return(e=sLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sLe(t){var e=oLe(t,"string");return typeof e=="symbol"?e:e+""}function oLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aLe{constructor(){A0(this,"count",0),A0(this,"startColumn",0),A0(this,"endColumn",0),A0(this,"startPosition",0),A0(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function I0(t,e,r){return(e=lLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lLe(t){var e=cLe(t,"string");return typeof e=="symbol"?e:e+""}function cLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uLe{constructor(){I0(this,"count",0),I0(this,"startRow",0),I0(this,"endRow",0),I0(this,"startPosition",0),I0(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function o8(t,e,r){return(e=hLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hLe(t){var e=fLe(t,"string");return typeof e=="symbol"?e:e+""}function fLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dLe extends rJ{constructor(){super(...arguments),o8(this,"columnStartOffset",0),o8(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof n=="function"){const o=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function a8(t,e,r){return(e=gLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gLe(t){var e=mLe(t,"string");return typeof e=="symbol"?e:e+""}function mLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pLe extends nJ{constructor(){super(...arguments),a8(this,"rowStartOffset",0),a8(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof n=="function"){const o=this.startRow,a=this.endRow;n(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function l8(t,e,r){return(e=vLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vLe(t){var e=wLe(t,"string");return typeof e=="symbol"?e:e+""}function wLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iJ{constructor(e){l8(this,"calculationTypes",[]),l8(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ia(t,e,r){return(e=yLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yLe(t){var e=CLe(t,"string");return typeof e=="symbol"?e:e+""}function CLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Sp=50;class SLe extends iJ{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(r),ia(this,"viewportWidth",0),ia(this,"scrollOffset",0),ia(this,"zeroBasedScrollOffset",0),ia(this,"totalColumns",0),ia(this,"columnWidthFn",null),ia(this,"columnWidth",0),ia(this,"overrideFn",null),ia(this,"inlineStartOffset",0),ia(this,"totalCalculatedWidth",0),ia(this,"startPositions",[]),ia(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Sp:r}}function mo(t,e,r){return(e=xLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xLe(t){var e=bLe(t,"string");return typeof e=="symbol"?e:e+""}function bLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _Le extends iJ{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:c}=e;super(r),mo(this,"viewportHeight",0),mo(this,"scrollOffset",0),mo(this,"zeroBasedScrollOffset",0),mo(this,"totalRows",0),mo(this,"rowHeightFn",null),mo(this,"rowHeight",0),mo(this,"overrideFn",null),mo(this,"horizontalScrollbarHeight",0),mo(this,"innerViewportHeight",0),mo(this,"totalCalculatedHeight",0),mo(this,"startPositions",[]),mo(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=c??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function ELe(t,e,r){RLe(t,e),e.set(t,r)}function RLe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c8(t,e,r){return(e=TLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TLe(t){var e=kLe(t,"string");return typeof e=="symbol"?e:e+""}function kLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vg(t,e){return t.get(sJ(t,e))}function u8(t,e,r){return t.set(sJ(t,e),r),r}function sJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ql=new WeakMap;class Fd{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;c8(this,"row",null),c8(this,"col",null),ELe(this,ql,!1),u8(ql,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return vg(ql,this)}isSouthEastOf(e){return this.row>=e.row&&(vg(ql,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(vg(ql,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(vg(ql,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(vg(ql,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Fd&&u8(ql,this,e.isRtl()),this}clone(){return new Fd(this.row,this.col,vg(ql,this))}toObject(){return{row:this.row,col:this.col}}}function PLe(t,e,r){ALe(t,e),e.set(t,r)}function ALe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mP(t,e,r){return(e=ILe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ILe(t){var e=OLe(t,"string");return typeof e=="symbol"?e:e+""}function OLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function po(t,e){return t.get(oJ(t,e))}function MLe(t,e,r){return t.set(oJ(t,e),r),r}function oJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var as=new WeakMap;class b1{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;mP(this,"highlight",null),mP(this,"from",null),mP(this,"to",null),PLe(this,as,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),MLe(as,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),c=Math.min(n.col,o.col),u=Math.max(i.row,a.row),h=Math.max(i.col,a.col),f=this._createCellCoords(l,c),d=this._createCellCoords(u,h);return this.from=f,this.to=d,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return po(as,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return po(as,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return po(as,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return po(as,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return po(as,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return po(as,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return po(as,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return po(as,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Fd))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(po(as,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(po(as,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new b1(this.highlight,this.from,this.to,po(as,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Fd(e,r,po(as,this))}}function Ja(t,e,r){NLe(t,e),e.set(t,r)}function NLe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(t,e){return t.get(aJ(t,e))}function vu(t,e,r){return t.set(aJ(t,e),r),r}function aJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var vo=new WeakMap,pP=new WeakMap,zn=new WeakMap,wg=new WeakMap,VC=new WeakMap,sa=new WeakMap,vP=new WeakMap,O0=new WeakMap,Zh=new WeakMap,Qa=new WeakMap;let lJ=class{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ja(this,vo,void 0),Ja(this,pP,void 0),Ja(this,zn,void 0),Ja(this,wg,void 0),Ja(this,VC,void 0),Ja(this,sa,void 0),Ja(this,vP,void 0),Ja(this,O0,void 0),Ja(this,Zh,[null,null]),Ja(this,Qa,[null,null]),vu(vo,this,n),vu(pP,this,r),vu(zn,this,s),vu(wg,this,o),vu(VC,this,a),vu(sa,this,i),vu(vP,this,e),this.registerEvents()}registerEvents(){Ue(sa,this).addEventListener(Ue(zn,this).holder,"contextmenu",n=>this.onContextMenu(n)),Ue(sa,this).addEventListener(Ue(zn,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Ue(sa,this).addEventListener(Ue(zn,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Ue(sa,this).addEventListener(Ue(zn,this).holder,"touchstart",n=>this.onTouchStart(n)),Ue(sa,this).addEventListener(Ue(zn,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Ue(sa,this).addEventListener(Ue(zn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ue(vo,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ue(vo,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Ue(sa,this).addEventListener(Ue(zn,this).holder,"mouseup",n=>this.onMouseUp(n)),Ue(sa,this).addEventListener(Ue(zn,this).holder,"mousedown",n=>this.onMouseDown(n))};Il()?e():(xq()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Ue(O0,this)&&n){const[i,s]=[n.row,Ue(O0,this).from.row],[o,a]=[n.col,Ue(O0,this).from.col];return i===s&&o===a}return!1}parentCell(e){const r={},n=Ue(zn,this).TABLE,i=DC(e,["TD","TH"],n);return i?(r.coords=Ue(zn,this).getCoords(i),r.TD=i):tt(e,"wtBorder")&&tt(e,"current")?(r.coords=Ue(wg,this).getFocusSelection().cellRange.highlight,r.TD=Ue(zn,this).getCell(r.coords)):tt(e,"wtBorder")&&tt(e,"area")&&Ue(wg,this).getAreaSelection().cellRange&&(r.coords=Ue(wg,this).getAreaSelection().cellRange.to,r.TD=Ue(zn,this).getCell(r.coords)),r}onMouseDown(e){const r=Ue(pP,this).rootDocument.activeElement,n=Bq(dDe,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);tt(i,"corner")?Ue(vo,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&Ue(vo,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(Ue(Qa,this)[0]=s.TD,clearTimeout(Ue(Zh,this)[0]),Ue(Zh,this)[0]=setTimeout(()=>{Ue(Qa,this)[0]=null},1e3))}onContextMenu(e){if(Ue(vo,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Ue(vo,this).has("onCellMouseOver"))return;const r=Ue(zn,this).TABLE,n=DC(e.target,["TD","TH"],r),i=Ue(VC,this)||this;n&&n!==i.lastMouseOver&&dd(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Ue(zn,this).getCoords(n),n))}onMouseOut(e){if(!Ue(vo,this).has("onCellMouseOut"))return;const r=Ue(zn,this).TABLE,n=DC(e.target,["TD","TH"],r),i=DC(e.relatedTarget,["TD","TH"],r),s=Ue(VC,this)||this;n&&n!==i&&dd(n,r)&&(this.callListener("onCellMouseOut",e,Ue(zn,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&Ue(vo,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Ue(Qa,this)[0]&&r.TD===Ue(Qa,this)[1]?(tt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Ue(Qa,this)[0]=null,Ue(Qa,this)[1]=null):r.TD===Ue(Qa,this)[0]&&(Ue(Qa,this)[1]=r.TD,clearTimeout(Ue(Zh,this)[1]),Ue(Zh,this)[1]=setTimeout(()=>{Ue(Qa,this)[1]=null},500)))}onTouchStart(e){vu(O0,this,Ue(wg,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=Le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&Ue(vo,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];_q()&&(uDe()||hDe())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=Ue(vo,this).getSettingPure(e);s&&s(r,n,i,Ue(vP,this).call(this))}destroy(){clearTimeout(Ue(Zh,this)[0]),clearTimeout(Ue(Zh,this)[1]),Ue(sa,this).destroy()}};function wP(t,e,r){return(e=DLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DLe(t){var e=FLe(t,"string");return typeof e=="symbol"?e:e+""}function FLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HLe{constructor(e,r,n){wP(this,"offset",void 0),wP(this,"total",void 0),wP(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function yP(t,e,r){return(e=LLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LLe(t){var e=$Le(t,"string");return typeof e=="symbol"?e:e+""}function $Le(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BLe{constructor(e,r,n){yP(this,"offset",void 0),yP(this,"total",void 0),yP(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function WC(t,e,r){return(e=VLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VLe(t){var e=WLe(t,"string");return typeof e=="symbol"?e:e+""}function WLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jLe{constructor(){WC(this,"currentSize",0),WC(this,"nextSize",0),WC(this,"currentOffset",0),WC(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const ULe=0,h8=1,$M=2;function CP(t,e,r){return(e=zLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zLe(t){var e=GLe(t,"string");return typeof e=="symbol"?e:e+""}function GLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YLe{constructor(){CP(this,"size",new jLe),CP(this,"workingSpace",ULe),CP(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=h8,e.workingSpace=$M,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=$M,e.workingSpace=h8,this.sharedSize=e.getViewSize()}}var f8=mR,KLe=TypeError,XLe=function(t,e){if(!delete t[e])throw new KLe("Cannot delete property "+f8(e)+" of "+f8(t))},qLe=wr,JLe=Vp,QLe=jp,ZLe=bK,e$e=XLe,t$e=_K,r$e=[].unshift(0)!==1,n$e=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},i$e=r$e||!n$e();qLe({target:"Array",proto:!0,arity:1,forced:i$e},{unshift:function(e){var r=JLe(this),n=QLe(r),i=arguments.length;if(i){t$e(n+i);for(var s=n;s--;){var o=s+i;s in r?r[o]=r[s]:e$e(r,o)}for(var a=0;a<i;a++)r[a]=arguments[a]}return ZLe(r,n+i)}});function s$e(t,e,r){return(e=o$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o$e(t){var e=a$e(t,"string");return typeof e=="symbol"?e:e+""}function a$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d8{constructor(e,r){s$e(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function l$e(t,e,r){return(e=c$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c$e(t){var e=u$e(t,"string");return typeof e=="symbol"?e:e+""}function u$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h$e{constructor(e){l$e(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new d8(s,r),l=new d8(o,n),c=[];for(let u=0;u<i;u++){const h=a.get(u),f=l.get(u);if(f===-1)c.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn($M)?c.push(["append",f]):c.push(["prepend",f]);else if(f>h)a.has(f)&&(a.remove(f),n<=a.length&&(i-=1)),c.push(["replace",f,h]);else if(f<h){const d=a.prepend(f);c.push(["insert_before",f,h,d])}else c.push(["none",f])}return c}}function yg(t,e,r){return(e=f$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f$e(t){var e=d$e(t,"string");return typeof e=="symbol"?e:e+""}function d$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cJ{constructor(e,r){yg(this,"rootNode",void 0),yg(this,"nodesPool",void 0),yg(this,"sizeSet",new YLe),yg(this,"collectedNodes",[]),yg(this,"viewDiffer",new h$e(this.sizeSet)),yg(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,s,o]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(s)),r.removeChild(this.nodesPool(o));break;case"replace":r.replaceChild(a,this.nodesPool(s));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class uJ extends cJ{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function g8(t,e,r){return(e=g$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g$e(t){var e=m$e(t,"string");return typeof e=="symbol"?e:e+""}function m$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p$e{constructor(e){g8(this,"nodeType",void 0),g8(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,s),s}}function M0(t,e,r){return(e=v$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v$e(t){var e=w$e(t,"string");return typeof e=="symbol"?e:e+""}function w$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _1{constructor(e,r){M0(this,"nodesPool",null),M0(this,"nodeType",void 0),M0(this,"rootNode",void 0),M0(this,"table",null),M0(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new p$e(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function m8(t,e,r){return(e=y$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y$e(t){var e=C$e(t,"string");return typeof e=="symbol"?e:e+""}function C$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S$e extends _1{constructor(){super("TH"),m8(this,"orderViews",new WeakMap),m8(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new uJ(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const c=this.obtainOrderView(l),u=s.obtainOrderView(l);c.appendView(u).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){c.render();const f=c.getCurrentNode();f.className="",f.removeAttribute("style"),Kp(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&et(f,[xNe(),INe(),TF(h+1),Vh(-1)]),r[h](a,f,h)}c.end()}}}class x$e extends _1{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Xc(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&et(this.rootNode,[hq()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&et(o,[fq(),pq(r+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),c=o.childNodes[a+s];c.className="",c.removeAttribute("style"),Kp(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&et(c,[TF(a+1+this.table.rowHeadersCount),Vh(-1),bNe(),...a>=0?[ANe()]:[SNe(),wp("Select whole grid")]]),n[r](l,c,r)}}}}let p8=!1;class b$e extends _1{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!p8&&e>1e3&&(p8=!0,zt(Qt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&Se(n,"rowHeader")}}function _$e(t,e,r){return(e=E$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E$e(t){var e=R$e(t,"string");return typeof e=="symbol"?e:e+""}function R$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cg={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let v8=!1;class T$e extends _1{constructor(e){super("TR",e),_$e(this,"orderView",void 0),this.orderView=new cJ(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!v8&&e>1e3&&(v8=!0,zt(Qt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&et(this.rootNode,[hq()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;et(s,[fq(),pq(o+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(o+1)%2===0?tt(s,Cg.rowEven)||(Je(s,Cg.rowOdd),Se(s,Cg.rowEven)):tt(s,Cg.rowOdd)||(Je(s,Cg.rowEven),Se(s,Cg.rowOdd))}this.orderView.end()}}function w8(t,e,r){return(e=k$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k$e(t){var e=P$e(t,"string");return typeof e=="symbol"?e:e+""}function P$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A$e extends _1{constructor(){super("TD"),w8(this,"orderViews",new WeakMap),w8(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new uJ(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),c=n.getRenderedNode(a);this.sourceRowIndex=l;const u=this.obtainOrderView(c),h=i.obtainOrderView(c);u.prependView(h).setSize(r).setOffset(0).start();for(let f=0;f<r;f++){u.render();const d=this.table.renderedColumnToSource(f),g=u.getCurrentNode();if(tt(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Kp(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,d,g),this.table.isAriaEnabled()){var s,o;et(g,[...g.hasAttribute("role")?[]:[CNe()],Vh(-1),TF(d+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}u.end()}}}function bn(t,e,r){return(e=I$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I$e(t){var e=O$e(t,"string");return typeof e=="symbol"?e:e+""}function O$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M$e{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};bn(this,"rootNode",void 0),bn(this,"rootDocument",void 0),bn(this,"rowHeaders",null),bn(this,"columnHeaders",null),bn(this,"colGroup",null),bn(this,"rows",null),bn(this,"cells",null),bn(this,"rowFilter",null),bn(this,"columnFilter",null),bn(this,"rowUtils",null),bn(this,"columnUtils",null),bn(this,"rowsToRender",0),bn(this,"columnsToRender",0),bn(this,"rowHeaderFunctions",[]),bn(this,"rowHeadersCount",0),bn(this,"columnHeaderFunctions",[]),bn(this,"columnHeadersCount",0),bn(this,"cellRenderer",void 0),bn(this,"activeOverlayName",void 0),bn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),s=this.rowUtils;if(i.firstChild){const o=this.renderedRowToSource(n),a=s.getHeightByOverlayName(o,this.activeOverlayName),c=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-c}px`:i.firstChild.style.height=""}}}}class N$e{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new M$e(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new S$e,columnHeaders:new x$e(r),colGroup:new b$e(n),rows:new T$e(i),cells:new A$e}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function SP(t,e,r){return(e=D$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D$e(t){var e=F$e(t,"string");return typeof e=="symbol"?e:e+""}function F$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H$e{constructor(e,r){SP(this,"dataAccessObject",void 0),SP(this,"wtSettings",void 0),SP(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let o=Array.isArray(r)?r[s]:r;o=o??i,this.headerWidths.set(s,o)}}}}function y8(t,e,r){return(e=L$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L$e(t){var e=$$e(t,"string");return typeof e=="symbol"?e:e+""}function $$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B$e{constructor(e,r){y8(this,"dataAccessObject",void 0),y8(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Za(t,e,r){return(e=V$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V$e(t){var e=W$e(t,"string");return typeof e=="symbol"?e:e+""}function W$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qp{constructor(e,r,n,i,s){Za(this,"wtSettings",null),Za(this,"domBindings",void 0),Za(this,"TBODY",null),Za(this,"THEAD",null),Za(this,"COLGROUP",null),Za(this,"hasTableHeight",!0),Za(this,"hasTableWidth",!0),Za(this,"isTableVisible",!1),Za(this,"tableOffset",0),Za(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,kq(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new B$e(this.dataAccessObject,this.wtSettings),this.columnUtils=new H$e(this.dataAccessObject,this.wtSettings),this.tableRenderer=new N$e({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!tt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&et(n,[kc()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!tt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&et(n,[kc()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!tt(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&et(n,[Vh(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&et(n.parentNode,[kc()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&et(n,[kc()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,c=r.getSetting("columnHeaders"),u=c.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Ai(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const d=n.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=d!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Ai(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const d=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new BLe(d,s,u),this.columnFilter=new HLe(g,o,l);let m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const p={};this.wtSettings.getSetting("beforeDraw",!0,p),m=p.skipRender!==!0}m&&(this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(Rl)||this.is(Ch))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Rl))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Rl)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let f=!1;return this.isMaster&&(f=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(f=n.bottomOverlay.resetFixedPosition()||f),f=n.inlineStartOverlay.resetFixedPosition()||f,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=sw(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Rl))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=Md(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let s=pDe(n),o=r.cellIndex;Jh($d,r,this.wtRootElement)||Jh(Hd,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Jh(Ch,r,this.wtRootElement)||Jh(Rl,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),Jh($d,r,this.wtRootElement)||Jh(Ld,r,this.wtRootElement)||Jh(Ch,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=sw(this.TBODY)-1,s=r.areCellsBorderBox(),o=s?An:sw,a=s?0:1,l=s?1:0;let c,u,h,f,d;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),c=this.getRowHeight(h),f=this.getTrForRow(h),d=f.querySelector("th");const g=h===0?l:0;d?u=o(d):u=o(f)-a,(!c&&r.getDefaultRowHeight()<u-g||c<u)&&(s||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return mn(this.TABLE)}getHeight(){return An(this.TABLE)}getTotalWidth(){const e=mn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=An(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Cp(this.TABLE)}_modifyRowHeaderWidth(e){let r=er(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const j$e="stickyRowsBottom",VF={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};lu(VF,"MIXIN_NAME",j$e,{writable:!1,enumerable:!1});const U$e="stickyColumnsStart",DR={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lu(DR,"MIXIN_NAME",U$e,{writable:!1,enumerable:!1});class WF extends qp{constructor(e,r,n,i){super(e,r,n,i,Ch)}}ur(WF,VF);ur(WF,DR);const Hd="top",Rl="bottom",Ld="inline_start",$d="top_inline_start_corner",Ch="bottom_inline_start_corner",hJ=[Hd,Rl,Ld,$d,Ch],z$e=new Map([[Hd,`ht_clone_${Hd}`],[Rl,`ht_clone_${Rl}`],[Ld,`ht_clone_${Ld} ht_clone_left`],[$d,`ht_clone_${$d} ht_clone_top_left_corner`],[Ch,`ht_clone_${Ch} ht_clone_bottom_left_corner`]]);function G$e(t,e){Y$e(t,e),e.add(t)}function Y$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K$e(t,e,r){return(e=X$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X$e(t){var e=q$e(t,"string");return typeof e=="symbol"?e:e+""}function q$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jC(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var N0=new WeakSet;class J$e{constructor(e){G$e(this,N0),K$e(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,n);return i||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const s=eo(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<o)return!1;const c=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();let h=!1;return(l&&(e<c||e>u)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const s=eo(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,c=r==="auto";if(c&&(e<a||e>i-o-1))return!1;const u=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let f=!1;return(c&&(e<u||e>h)||!c)&&(f=l.scrollTo(e,c?e>=this.getLastPartiallyVisibleRow():r==="bottom")),f}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return jC(N0,this,S8).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return jC(N0,this,S8).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return jC(N0,this,C8).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return jC(N0,this,C8).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function C8(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const u=n.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(u.right-f)}else l=Ai(n.wtRootElement).left;const c=Math.abs(Aq(o,o));if(l>c){const u=Iq(o);let h=i.getRowHeaderWidth();for(let f=1;f<=s;f++)if(h+=r.sumCellSizes(f-1,f),l+h-c>=u){t=f-2;break}}}return t}function S8(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=Ai(r.wtRootElement),a=OF(s,s);if(o.top>a){const l=sw(s);let c=n.getColumnHeaderHeight();for(let u=1;u<=i;u++)if(c+=e.sumCellSizes(u-1,u),o.top+c-a>=l){t=u-2;break}}}return t}function wo(t,e,r){return(e=Q$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q$e(t){var e=Z$e(t,"string");return typeof e=="symbol"?e:e+""}function Z$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jF{get eventManager(){return new Ba(this)}constructor(e,r){wo(this,"wtTable",void 0),wo(this,"wtScroll",void 0),wo(this,"wtViewport",void 0),wo(this,"wtOverlays",void 0),wo(this,"selectionManager",void 0),wo(this,"wtEvent",void 0),wo(this,"guid",`wt_${lq()}`),wo(this,"drawInterrupted",!1),wo(this,"drawn",!1),wo(this,"activeOverlayName","master"),wo(this,"domBindings",void 0),wo(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new J$e(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Nd(n,e[r])}])}}createCellCoords(e,r){return new Fd(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new b1(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||wDe(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function x8(t,e,r){return(e=e4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e4e(t){var e=t4e(t,"string");return typeof e=="symbol"?e:e+""}function t4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r4e extends jF{constructor(e,r,n){super(e,r),x8(this,"cloneSource",void 0),x8(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new lJ(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function n4e(t,e,r){return(e=i4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i4e(t){var e=s4e(t,"string");return typeof e=="symbol"?e:e+""}function s4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E1{constructor(e,r,n,i,s){n4e(this,"wtSettings",null),lu(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=Sy(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Sy(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=S_(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){zt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,u,c):h=this.getRelativeCellPositionWithinHolder(o,a,s,u,c),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+ei())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=o.horizontal-s.start),r){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(hJ.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${z$e.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&et(s,[kc()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===Hd||c==="vertical"&&this.type===Ld?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=S_(e.TABLE),new r4e(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class o4e extends E1{constructor(e,r,n,i,s,o){super(e,r,Ch,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new WF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else IR(r),this.repositionOverlay();let n=An(this.clone.wtTable.TABLE);const i=mn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=ei(n)),i.style.bottom=`${s}px`}}const a4e="calculatedColumns",FR={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lu(FR,"MIXIN_NAME",a4e,{writable:!1,enumerable:!1});class UF extends qp{constructor(e,r,n,i){super(e,r,n,i,Rl)}}ur(UF,VF);ur(UF,FR);function l4e(t,e,r){return(e=c4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c4e(t){var e=u4e(t,"string");return typeof e=="symbol"?e:e+""}function u4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h4e extends E1{constructor(e,r,n,i){super(e,r,Rl,n,i),l4e(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new UF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=ei(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(IF(r),top),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<r;){const l=n.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=ei(n)),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=An(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=ei(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return OF(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=tt(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Se(o,"innerBorderBottom"),s=!a):(Je(o,"innerBorderBottom"),s=a)}return s}}const f4e="calculatedRows",zF={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lu(zF,"MIXIN_NAME",f4e,{writable:!1,enumerable:!1});class GF extends qp{constructor(e,r,n,i){super(e,r,n,i,Ld)}}ur(GF,zF);ur(GF,DR);const d4e="localHooks",fi={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)AM(this._localHooks[t][l],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};lu(fi,"MIXIN_NAME",d4e,{writable:!1,enumerable:!1});let fJ=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};ur(fJ,fi);const dJ="active-header",YF="header",KF="area",__="focus",g4e="fill",m4e="row",p4e="column",v4e="custom-selection",XF=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var w4e=MR;w4e("flat");function y4e(t,e){gJ(t,e),e.add(t)}function b8(t,e,r){gJ(t,e),e.set(t,r)}function gJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(t,e){return t.get(ow(t,e))}function _8(t,e,r){return t.set(ow(t,e),r),r}function ow(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ha=new WeakMap,yi=new WeakMap,UC=new WeakSet;class C4e{constructor(){y4e(this,UC),b8(this,ha,void 0),b8(this,yi,void 0)}setActiveOverlay(e){return _8(yi,this,e),this}setActiveSelection(e){return _8(ha,this,e),this}scan(){const e=Br(ha,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=Br(ha,this).getCorners(),{wtTable:o}=Br(yi,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let c=0;for(let u=-o.getRowHeadersCount();u<a;u++){const h=o.columnFilter.renderedToSource(u);if(!(h<n||h>s)){for(let f=-l;f<0;f++){if(f<r||f>i)continue;const d=f+l;let g=o.getColumnHeader(h,d);const m=Br(yi,this).getSetting("onBeforeHighlightingColumnHeader",h,d,{selectionType:Br(ha,this).settings.selectionType,columnCursor:c,selectionWidth:s-n+1});m!==null&&(m!==h&&(g=o.getColumnHeader(m,d)),e(g))}c+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=Br(ha,this).getCorners(),{wtTable:o}=Br(yi,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let c=0;for(let u=-o.getColumnHeadersCount();u<a;u++){const h=o.rowFilter.renderedToSource(u);if(!(h<r||h>i)){for(let f=-l;f<0;f++){if(f<n||f>s)continue;const d=f+l;let g=o.getRowHeader(h,d);const m=Br(yi,this).getSetting("onBeforeHighlightingRowHeader",h,d,{selectionType:Br(ha,this).settings.selectionType,rowCursor:c,selectionHeight:i-r+1});m!==null&&(m!==h&&(g=o.getRowHeader(m,d)),e(g))}c+=1}}}scanCellsRange(e){const{wtTable:r}=Br(yi,this);ow(UC,this,S4e).call(this,(n,i)=>{const s=r.getCell(Br(yi,this).createCellCoords(n,i)),o=Br(yi,this).getSetting("onAfterDrawSelection",n,i,Br(ha,this).settings.layerLevel);typeof o=="string"&&Se(s,o),e(s)})}scanRowsInCellsRange(e){const[r,,n]=Br(ha,this).getCorners(),{wtTable:i}=Br(yi,this);ow(UC,this,E8).call(this,(s,o)=>{if(s>=r&&s<=n){const a=i.getCell(Br(yi,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Br(ha,this).getCorners(),{wtTable:i}=Br(yi,this);ow(UC,this,E8).call(this,(s,o)=>{if(o>=r&&o<=n){const a=i.getCell(Br(yi,this).createCellCoords(s,o));e(a)}})}}function S4e(t){let[e,r,n,i]=Br(ha,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:s}=Br(yi,this),o=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),o){if(r=Math.max(r,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),i<r||n<e)return}else{const a=s.getCell(Br(yi,this).createCellCoords(e,r));if(!Bc(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function E8(t){const{wtTable:e}=Br(yi,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<n;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class R8{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=XF(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ua(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],c=r.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),i=c.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Il()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),s=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const c=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};St(h,(d,g)=>{this.selectionHandles.styles.bottomHitArea[g]=d,this.selectionHandles.styles.topHitArea[g]=d});const f=n.isClassicTheme()?{position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${l}`};St(f,(d,g)=>{this.selectionHandles.styles.bottom[g]=d,this.selectionHandles.styles.top[g]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,d=parseInt(c.borderWidth,10),g=parseInt(c.width,10),m=parseInt(u.width,10),p=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();c.top=`${parseInt(n-g-1,10)}px`,c[l]=`${parseInt(i-g-1,10)}px`,u.top=`${parseInt(n-m/4*3,10)}px`,u[l]=`${parseInt(i-m/4*3,10)}px`;const v=Math.min(parseInt(i+s,10),p-g-d*2),y=Math.min(parseInt(i+s-m/4,10),p-m-d*2);h[l]=`${v}px`,f[l]=`${y}px`;const b=Math.min(parseInt(n+o,10),w-g-d*2),T=Math.min(parseInt(n+o-m/4,10),w-m-d*2);h.top=`${b}px`,f.top=`${T}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,r)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(c.display="none",h.display="none",u.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,s]=e;if(r<0&&i<0||n<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,c=r!==i||n!==s,u=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=o.getFirstRenderedRow(),f=o.getLastRenderedRow(),d=o.getFirstRenderedColumn(),g=o.getLastRenderedColumn();if(d<0&&g<0||h<0&&f<0){this.disappear();return}let m;if(c){if(n=Math.max(n,d),s=Math.min(s,g),r=Math.max(r,h),i=Math.min(i,f),s<n||i<r){this.disappear();return}m=o.getCell(this.wot.createCellCoords(r,n))}else if(m=o.getCell(this.wot.createCellCoords(r,n)),!Bc(m)){this.disappear();return}const p=c?o.getCell(this.wot.createCellCoords(i,s)):m,w=Ai(m),v=c?Ai(p):w,y=Ai(o.TABLE),b=w.top,T=w.left,E=this.wot.wtSettings.getSetting("rtlMode");let x=0,P=0;if(E){const ge=mn(o.TABLE),Q=mn(m),ye=l.innerWidth-y.left-ge;P=T+Q-v.left,x=l.innerWidth-T-Q-ye-1}else P=v.left+mn(p)-T,x=T-y.left-1;if(this.isEntireColumnSelected(r,i)){const ge=r,Q=this.getDimensionsFromHeader("columns",n,s,ge,y);let ye=null;Q&&([ye,x,P]=Q),ye&&(m=ye)}let A=b-y.top-1,O=v.top+An(p)-b;if(this.isEntireRowSelected(n,s)){const ge=n,Q=this.getDimensionsFromHeader("rows",r,i,ge,y);let ye=null;Q&&([ye,A,O]=Q),ye&&(m=ye)}const Y=l.getComputedStyle(m);parseInt(Y.borderTopWidth,10)>0&&(A+=1,O=O>0?O-1:0),parseInt(Y[E?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,P=P>0?P-1:0);const B=E?"right":"left",ie=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${A}px`,this.topStyle[B]=`${x}px`,this.topStyle.width=`${P+ie}px`,this.topStyle.display="block",this.startStyle.top=`${A}px`,this.startStyle[B]=`${x}px`,this.startStyle.height=`${O+ie}px`,this.startStyle.display="block",this.bottomStyle.top=`${A+O-parseInt(this.bottomStyle.height,10)+ie}px`,this.bottomStyle[B]=`${x}px`,this.bottomStyle.width=`${P+ie}px`,this.bottomStyle.display="block",this.endStyle.top=`${A}px`,this.endStyle[B]=`${x+P-parseInt(this.endStyle.width,10)+ie}px`,this.endStyle.height=`${O+ie}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const he=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[Ee,Ce]=[i,s];if(he&&Array.isArray(he)&&([,,Ee,Ce]=he),Il()||!ue||this.isPartRange(Ee,Ce))this.cornerStyle.display="none";else{this.cornerStyle.top=`${A+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[B]=`${x+P+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ge=Sy(o.TABLE);const Q=ge===l;Q&&(ge=a.documentElement);const ye=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Re=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),j=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const C=Q?p.getBoundingClientRect().left:p.offsetLeft;let S=!1,_=0;if(E?(_=C-parseInt(this.cornerDefaultStyle.width,10)/2,S=_<0):(_=C+mn(p)+parseInt(this.cornerDefaultStyle.width,10)/2,S=_>=Iq(ge)),S){const D=Math.floor(x+P+this.cornerCenterPointOffset-Re-ye);u?(this.cornerStyle[B]=`${D}px`,this.cornerStyle[E?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[B]=`${D-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Q?p.getBoundingClientRect().top:p.offsetTop)+An(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=sw(ge)){const D=Math.floor(A+O+this.cornerCenterPointOffset-j-ye);u?(this.cornerStyle.top=`${D}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${D-1}px`}this.cornerStyle.display="block"}Il()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,A,x,P,O)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,c=null,u=null,h=null,f=null,d=null,g=null,m=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},c=function(){return An(...arguments)},u="ht__selection--rows",d="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},c=function(){return mn(...arguments)},u="ht__selection--columns",d="left";break}if(a.classList.contains(u)){const p=this.wot.getSetting("columnHeaders").length;if(g=l(r,p-i),m=l(n,p-i),!g||!m)return!1;const w=Ai(g),v=Ai(m);return g&&m&&(h=w[d]-s[d]-1,f=v[d]+c(m)-w[d]),[g,h,f]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?Se(this[e],"hidden"):(tt(this[e],"hidden")&&Je(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Se(this[e],"hidden"):Je(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Il()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function x4e(t,e){mJ(t,e),e.add(t)}function Sg(t,e,r){mJ(t,e),e.set(t,r)}function mJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(qF(t,e))}function T8(t,e,r){return t.set(qF(t,e),r),r}function qF(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ci=new WeakMap,ps=new WeakMap,xP=new WeakMap,Pv=new WeakMap,bP=new WeakMap,ef=new WeakMap,k8=new WeakSet;class b4e{constructor(e){x4e(this,k8),Sg(this,Ci,void 0),Sg(this,ps,void 0),Sg(this,xP,new C4e),Sg(this,Pv,new WeakMap),Sg(this,bP,new WeakSet),Sg(this,ef,new Map),T8(ps,this,e)}setActiveOverlay(e){return T8(Ci,this,e),vt(xP,this).setActiveOverlay(vt(Ci,this)),vt(Pv,this).has(vt(Ci,this))||vt(Pv,this).set(vt(Ci,this),new Set),this}getFocusSelection(){return vt(ps,this)!==null?vt(ps,this).getFocus():null}getAreaSelection(){return vt(ps,this)!==null?vt(ps,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(vt(ef,this).has(e)){const n=vt(ef,this).get(e);if(n.has(vt(Ci,this)))return n.get(vt(Ci,this));const i=new R8(vt(Ci,this),e.settings);return n.set(vt(Ci,this),i),i}const r=new R8(vt(Ci,this),e.settings);return vt(ef,this).set(e,new Map([[vt(Ci,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=vt(ef,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){vt(ef,this).get(e).forEach(r=>r.destroy()),vt(ef,this).delete(e)}render(e){if(vt(ps,this)===null)return;e&&qF(k8,this,_4e).call(this);const r=Array.from(vt(ps,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const o=r[s],{className:a,headerAttributes:l,createLayers:c,selectionType:u}=o.settings;vt(bP,this).has(o)||(vt(bP,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&vt(xP,this).setActiveSelection(o).scan().forEach(g=>{if(n.has(g)){const m=n.get(g);m.has(a)&&c===!0?m.set(a,m.get(a)+1):m.set(a,1)}else n.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const f=o.getCorners();vt(Ci,this).getSetting("onBeforeDrawBorders",f,u),h==null||h.appear(f)}n.forEach((s,o)=>{var a;const l=Array.from(s).map(c=>{let[u,h]=c;return h===1?u:[u,...Array.from({length:h-1},(f,d)=>`${u}-${d+1}`)]}).flat();l.forEach(c=>vt(Pv,this).get(vt(Ci,this)).add(c)),Se(o,l),o.nodeName==="TD"&&Array.isArray((a=vt(ps,this).options)===null||a===void 0?void 0:a.cellAttributes)&&et(o,vt(ps,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{et(s,[...i.get(s)])})}}function _4e(){const t=vt(Pv,this).get(vt(Ci,this)),e=vt(Ci,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=vt(Ci,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((n=vt(ps,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=vt(ps,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=vt(ps,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...vt(ps,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)Je(s[a],r),Kp(s[a],o)}),t.clear()}class E4e extends E1{constructor(e,r,n,i){super(e,r,Ld,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new GF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),MF(n,`${s}px`,"0px")):(s=this.getScrollPosition(),IR(n));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const s=r.scrollX;r.scrollTo(e,Pq(r)),n=s!==r.scrollX}else if(e!==i.scrollLeft){const s=i.scrollLeft;i.scrollLeft=e,n=s!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let c=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(c-=ei(n)),c=Math.min(c,e.wtRootElement.scrollHeight),o.height=`${c}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=mn(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=XF(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!tt(a.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),u=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),f=this.wot.wtViewport.getViewportWidth();h>f&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(u=ei(this.domBindings.rootDocument)),r?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=l):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=u,CDe(this.mainTableScrollableElement)===c-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(Aq(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?Je(n,"emptyRows"):Se(n,"emptyRows");let l=!1;if(!a){if(s&&!i.length)Se(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const c=tt(n,"innerBorderInlineStart");e?(Se(n,"innerBorderLeft innerBorderInlineStart"),l=!c):(Je(n,"innerBorderLeft innerBorderInlineStart"),l=c)}}return l}}const R4e="stickyRowsTop",JF={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lu(JF,"MIXIN_NAME",R4e,{writable:!1,enumerable:!1});class QF extends qp{constructor(e,r,n,i){super(e,r,n,i,$d)}}ur(QF,JF);ur(QF,DR);function P8(t,e,r){return(e=T4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T4e(t){var e=k4e(t,"string");return typeof e=="symbol"?e:e+""}function k4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P4e extends E1{constructor(e,r,n,i,s,o){super(e,r,$d,n,i),P8(this,"topOverlay",void 0),P8(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new QF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();MF(e,`${i}px`,`${s}px`)}else IR(e);let r=An(this.clone.wtTable.TABLE);const n=mn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class ZF extends qp{constructor(e,r,n,i){super(e,r,n,i,Hd)}}ur(ZF,JF);ur(ZF,FR);function A4e(t,e,r){return(e=I4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I4e(t){var e=O4e(t,"string");return typeof e=="symbol"?e:e+""}function O4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M4e extends E1{constructor(e,r,n,i){super(e,r,Hd,n,i),A4e(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new ZF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;s=c===u,i=this.getOverlayOffset(),MF(e,"0px",`${i}px`)}else i=this.getScrollPosition(),IR(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo(IF(r),e),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,s=0;for(;i<r;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=ei(n)),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=An(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=XF(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),c=i.getSetting("fixedRowsTop")===0&&a.length>0&&!tt(o.parentNode,"innerBorderTop")?1:0;let u=this.getTableParentOffset(),h=0;if(r){const f=this.wot.wtTable.getRowHeight(e),d=this.wot.wtViewport.getViewportHeight();f>d&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(h=ei(this.domBindings.rootDocument)),r){const f=i.getSetting("fixedRowsBottom"),d=i.getSetting("totalRows");u+=this.sumCellSizes(0,e+1),u-=n.wtViewport.getViewportHeight()-this.sumCellSizes(d-f,d),u+=1,u+=c}else u+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return u+=h,yDe(this.mainTableScrollableElement)===u-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return OF(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";s?Je(i,"emptyColumns"):Se(i,"emptyColumns");let a=!1;if(!r&&!o){const l=n.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,u=n.getSetting("columnHeaders");if((c||l===0)&&u.length>0){const h=tt(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(Se(i,"innerBorderTop"),a=!h):(Je(i,"innerBorderTop"),a=h)}}return a}}function zC(t,e,r){N4e(t,e),e.set(t,r)}function N4e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jl(t,e,r){return(e=D4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D4e(t){var e=F4e(t,"string");return typeof e=="symbol"?e:e+""}function F4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tf(t,e,r){return t.set(pJ(t,e),r),r}function Ql(t,e){return t.get(pJ(t,e))}function pJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xg=new WeakMap,GC=new WeakMap,bg=new WeakMap,YC=new WeakMap;class H4e{constructor(e,r,n,i,s,o){Jl(this,"wot",null),zC(this,xg,[]),Jl(this,"topOverlay",null),Jl(this,"bottomOverlay",null),Jl(this,"inlineStartOverlay",null),Jl(this,"topInlineStartCornerOverlay",null),Jl(this,"bottomInlineStartCornerOverlay",null),Jl(this,"browserLineHeight",void 0),Jl(this,"wtSettings",null),zC(this,GC,!1),zC(this,bg,0),zC(this,YC,null),Jl(this,"resizeObserver",new ResizeObserver(u=>{y_(()=>{!Array.isArray(u)||!u.length||(tf(bg,this,Ql(bg,this)+1),Ql(bg,this)===100&&(zt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Ql(YC,this)!==null&&clearTimeout(Ql(YC,this)),tf(YC,this,setTimeout(()=>{tf(bg,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=ei(a);const c=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:S_(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Ql(xg,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new M4e(...e),this.bottomOverlay=new h4e(...e),this.inlineStartOverlay=new E4e(...e),this.topInlineStartCornerOverlay=new P4e(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new o4e(...e,this.bottomOverlay,this.inlineStartOverlay),tf(xg,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){tf(GC,this,Ql(xg,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Ql(xg,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Ql(xg,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!bq())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",f=>this.onCloneWheel(f,a),l)});let u;this.eventManager.addEventListener(r,"resize",()=>{y_(()=>{clearTimeout(u),this.wtSettings.getSetting("onWindowResize"),u=setTimeout(()=>{tf(bg,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const c=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=x1(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Ql(GC,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),tf(GC,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=S_(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,u=a+this.inlineStartOverlay.sumCellSizes(0,s),f=r.hider.style,d=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,u-r.holder.clientWidth),m=d()?1:0,p=g()?1:0;f.width=`${u+p}px`,f.height=`${c+m}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Z(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Z(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function A8(t,e,r){return(e=L4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L4e(t){var e=$4e(t,"string");return typeof e=="symbol"?e:e+""}function $4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B4e{constructor(e){A8(this,"settings",{}),A8(this,"defaults",Object.freeze(this.getDefaults())),St(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Nd(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?St(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class eH extends qp{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Sy(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=x_(e,"height",r),s=x_(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let c=e.offsetWidth,u=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?n.insertBefore(f,e.nextElementSibling):n.appendChild(f);const d=parseInt(r.getComputedStyle(f).height,10);n.removeChild(f),d===0&&(u=0)}u=Math.min(u,l),o.height=i==="auto"?"auto":`${u}px`,c=Math.min(c,a),o.width=`${c}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=Cp(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<s;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);r.hasOversizedColumnHeadersMarked[n]=!0}}}ur(eH,zF);ur(eH,FR);class V4e{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new uLe:new pLe],["fullyVisible",()=>new eLe],["partiallyVisible",()=>new nJ]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new aLe:new dLe],["fullyVisible",()=>new JHe],["partiallyVisible",()=>new rJ]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=An(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollWidth>s.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Ai(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=An(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=mn(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),c=r.getSetting("fixedRowsBottom"),u=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),c&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=ei(this.domBindings.rootDocument),new _Le({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=ei(this.domBindings.rootDocument)),new SLe({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s,rowStartOffset:o,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,c=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(o,c)),n=Math.min(l,n+Math.min(a,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s,columnStartOffset:o,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,c=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(o,c)),n=Math.min(l,n+Math.min(a,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<l)}resetHasOversizedColumnHeadersMarked(){St(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class W4e extends jF{constructor(e,r){super(e,new B4e(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new eH(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new V4e(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new b4e(this.wtSettings.getSetting("selections")),this.wtEvent=new lJ(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new H4e(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];St(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),Je(this.wtTable.wtRootElement.parentNode,r),Se(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!hJ.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class tH{constructor(e){e instanceof jF?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new tH(r);return()=>n},this._wot=new W4e(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function I8(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,c=s.isSelectedByCorner(),u=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):c&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),f=r||n&&h;i.row<0&&i.col>=0&&!o.column?f&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?f&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?f&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function j4e(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),c=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(s(c-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function O8(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),s=i.clone().map(a=>n.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!r.isMultiple(o)){const a=s.findAll(o);a.length===s.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:c}=l;return c})),r.refresh())}}const U4e=new Map([["touchstart",I8],["touchend",O8],["mousedown",I8],["mouseover",j4e],["mouseup",O8]]);function _P(t,e){U4e.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:NF(t)||t.type==="touchstart",isRightClick:Dd(t),...e})}const vJ=new WeakMap,rH=Symbol("rootInstance");function z4e(t){vJ.set(t,!0)}function G4e(t){return t===rH}function om(t){return vJ.has(t)}function Y4e(t,e){wJ(t,e),e.add(t)}function wu(t,e,r){wJ(t,e),e.set(t,r)}function wJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,r){return(e=K4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K4e(t){var e=X4e(t,"string");return typeof e=="symbol"?e:e+""}function X4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function un(t,e){return t.get(Zm(t,e))}function ls(t,e,r){return t.set(Zm(t,e),r),r}function Zm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var EP=new WeakMap,KC=new WeakMap,XC=new WeakMap,Zl=new WeakMap,oa=new WeakMap,RP=new WeakMap,TP=new WeakMap,_g=new WeakMap,Av=new WeakSet;class q4e{constructor(e){Y4e(this,Av),yu(this,"hot",void 0),yu(this,"eventManager",void 0),yu(this,"settings",void 0),yu(this,"THEAD",void 0),yu(this,"TBODY",void 0),yu(this,"_wt",void 0),yu(this,"activeWt",void 0),wu(this,EP,0),wu(this,KC,0),yu(this,"postponedAdjustElementsSize",!1),wu(this,XC,!1),wu(this,Zl,void 0),wu(this,oa,void 0),wu(this,RP,0),wu(this,TP,0),wu(this,_g,null),this.hot=e,this.eventManager=new Ba(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Zm(Av,this,Q4e).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Se(e,"handsontable"),ls(oa,this,r.createElement("TABLE")),Se(un(oa,this),"htCore"),this.hot.getSettings().tableClassName&&Se(un(oa,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(et(un(oa,this),[kc()]),et(e,[yNe(),mq(-1),kR(this.hot.countCols()),NNe()])),this.THEAD=r.createElement("THEAD"),un(oa,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),un(oa,this).appendChild(this.TBODY),this.hot.table=un(oa,this),this.hot.container.insertBefore(un(oa,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{ls(XC,this,!0),this.isTextSelectionAllowed(a.target)||(zW(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{ls(XC,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{un(XC,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&zW(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{n.isInProgress()&&NF(a)&&n.finish(),ls(Zl,this,!1);const l=Fq(r.activeElement);Yx(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Dd(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{n.isInProgress()&&Dd(a)&&(n.finish(),ls(Zl,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{n.isInProgress()&&n.finish(),ls(Zl,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,c=a.x||a.clientX,u=a.y||a.clientY;let h=a.target;if(un(Zl,this)||!e||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(h===f){const g=ei(r);if(r.elementFromPoint(c+g,u)!==f||r.elementFromPoint(c,u+g)!==f)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=yp(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=yp(o);this.eventManager.addEventListener(un(oa,this),"selectstart",a=>{this.settings.fragmentSelection||Yx(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Se(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Je(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:un(oa,this),isDataViewInstance:()=>om(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),ls(KC,this,s.length),this.hot.getSettings().ariaTags&&Zm(Av,this,yJ).call(this)===this.hot.countCols()&&Zm(Av,this,J4e).call(this,un(KC,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),ls(EP,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,c]=this.translateFromRenderableToVisualIndex(s,o),u=this.hot.runHooks("modifyGetCellCoords",l,c,!1,"meta");let h=l,f=c;Array.isArray(u)&&([h,f]=u);const d=this.hot.getCellMeta(h,f),g=this.hot.colToProp(f);let m=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(m=this.hot.runHooks("beforeValueRender",m,d)),this.hot.runHooks("beforeRenderer",a,l,c,g,m,d),this.hot.getCellRenderer(d)(this.hot,a,l,c,g,m,d),this.hot.runHooks("afterRenderer",a,l,c,g,m,d)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Cp(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,ls(Zl,this,!0),ls(_g,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,c,a,u),!jf(s)&&(_P(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",s,c,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,ls(Zl,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,c,a),!jf(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,c,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,c,a),!jf(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,c,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,c,a,u),!jf(s)&&(un(Zl,this)&&(!un(_g,this)||un(_g,this).x!==s.clientX||un(_g,this).y!==s.clientY)&&_P(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",s,c,a),this.activeWt=this._wt,ls(_g,this,null))},onCellMouseUp:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,c,a),!(jf(s)||this.hot.isDestroyed)&&(_P(s,{coords:c,selection:this.hot.selection,cellRangeMapper:cFe(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let c=s;return!l&&(c=a.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollVertically",c,o),this.hot.runHooks("beforeViewportScroll"),l?c:a.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let c=s;return!l&&(c=a.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c,o),this.hot.runHooks("beforeViewportScroll"),l?c:a.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",u,o,a);return c?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",u,o,a);return c?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[c,u]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const d=h.peekByIndex(a??0);l=[d.from.row,d.from.col,d.to.row,d.to.col]}return this.hot.runHooks("afterDrawSelection",c,u,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,c,u]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const c=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,h=o>=0?u.getVisualFromRenderableIndex(o):o,f=s>=0?c.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",f,h,a,l);if(Array.isArray(d)){const[g,m,p,w]=d;return[g>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1)):g,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,-1)):p,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,-1)):w]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,c=o>=0?l.getVisualFromRenderableIndex(o):o,u=s>=0?a.getVisualFromRenderableIndex(s):s,h=this.hot.runHooks("modifyGetCoordsElement",u,c);if(Array.isArray(h)){const[f,d]=h;return[f>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,1)):f,d>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1)):d]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,c=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(c+o,a-1);else if(o==="auto"){const u=Math.max(1,Math.ceil(c/a*12));s.startRow=Math.max(l-u,0),s.endRow=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,c=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(c+o,a-1)),o==="auto"){const u=Math.max(1,Math.ceil(c/a*6));s.startColumn=Math.max(l-u,0),s.endColumn=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new tH(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Yx(e))return!0;const r=dd(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return un(Zl,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!tt(n,"relative")){Xc(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;tt(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,i),o.className="",Se(o,["relative",...s()])):(Xc(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),c=s();a.classList.add("relative",...c),l.className="colHeader",this.settings.ariaTags&&(et(a,...kc()),et(l,...kc())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(tt(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):tt(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?Xp(e,n(r,i)):(Nd(e," "),Se(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){ls(RP,this,e),ls(TP,this,r)}getLastSize(){return{width:un(RP,this),height:un(TP,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return un(EP,this)}getRowHeadersCount(){return un(KC,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function yJ(){return parseInt(this.hot.rootElement.getAttribute(kR()[0]),10)}function J4e(t){const e=Zm(Av,this,yJ).call(this)+t;et(this.hot.rootElement,...kR(e))}function Q4e(){const t=this.hot.rootElement;this.hasVerticalScroll()?Se(t,"htHasScrollY"):Je(t,"htHasScrollY"),this.hasHorizontalScroll()?Se(t,"htHasScrollX"):Je(t,"htHasScrollX")}var Z4e=wr,e3e=Mn,t3e=Up,r3e=Os,n3e=Dn,i3e=Ul,s3e=Ms,o3e=Bh,kP=o3e("every",TypeError);Z4e({target:"Iterator",proto:!0,real:!0,forced:kP},{every:function(e){n3e(this);try{r3e(e)}catch(i){s3e(this,"throw",i)}if(kP)return e3e(kP,this,e);var r=i3e(this),n=0;return!t3e(r,function(i,s){if(!e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const a3e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",M8=a3e.length;function l3e(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%M8,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/M8,10);return r}function CJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{n.push([s+e,a,o])}):Object.keys(i).forEach(o=>{n.push([s+e,o,i[o]])})}),n}function SJ(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ct(t[0])&&(e=AF(t[0]))),e}function c3e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function u3e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function D0(t,e,r){return(e=h3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h3e(t){var e=f3e(t,"string");return typeof e=="symbol"?e:e+""}function f3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d3e{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];D0(this,"hot",void 0),D0(this,"data",void 0),D0(this,"dataType","array"),D0(this,"colToProp",()=>{}),D0(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return Z(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((c,u)=>{l[u]=this.getAtPhysicalCell(e,u,a)}):je(r,n,c=>{l[c-r]=this.getAtPhysicalCell(e,c,a)});else if(Ct(a)||er(a))if(i?l=[]:l={},!s||i){const u=this.countFirstRowKeys()-1;je(0,u,h=>{const f=this.colToProp(h);if(h>=(r||0)&&h<=(n||u)&&!Number.isInteger(f)){const d=this.getAtPhysicalCell(e,f,a);i?l.push(d):o?tP(l,f,d):l[f]=d}})}else St(a,(c,u)=>{const h=this.getAtPhysicalCell(e,u,a);o?tP(l,u,h):l[u]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=eo(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:tP(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?sDe(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=eo(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const c=[];return je(s,a,u=>{c.push(i?this.getAtRow(u,void 0,void 0,n):this.getAtRow(u,o,l,n))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return SJ(this.data)}destroy(){this.data=null,this.hot=null}}var g3e=wr,m3e=Mn,p3e=Up,v3e=Os,w3e=Dn,y3e=Ul,C3e=Ms,S3e=Bh,PP=S3e("some",TypeError);g3e({target:"Iterator",proto:!0,real:!0,forced:PP},{some:function(e){w3e(this);try{v3e(e)}catch(i){C3e(this,"throw",i)}if(PP)return m3e(PP,this,e);var r=y3e(this),n=0;return p3e(r,function(i,s){if(e(i,n++))return s()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function N8(t,e,r){return(e=x3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x3e(t){var e=b3e(t,"string");return typeof e=="symbol"?e:e+""}function b3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class og{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;N8(this,"indexedValues",[]),N8(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,er(this.initValueOrFn)?je(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):je(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ur(og,fi);function nH(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>er(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function iH(t,e){return Od(t,(r,n)=>e.includes(n)===!1)}class jh extends og{insert(e,r){this.indexedValues=nH(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=iH(this.indexedValues,e),super.remove(e)}}class HR extends jh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Ns(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function sH(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function xy(t,e){return Od(t,r=>e.includes(r)===!1)}function oH(t,e){return At(t,r=>r-e.filter(n=>n<r).length)}function aH(t,e){const r=e[0],n=e.length;return At(t,i=>i>=r?i+n:i)}function _3e(t,e,r){return(e=E3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E3e(t){var e=R3e(t,"string");return typeof e=="symbol"?e:e+""}function R3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LR extends og{constructor(){super(...arguments),_3e(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=xy(this.orderOfIndexes,[e]),er(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=nH(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=aH(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=iH(this.indexedValues,e),this.orderOfIndexes=xy(this.orderOfIndexes,e),this.orderOfIndexes=oH(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class R1 extends jh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Ns(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const D8=new Map([["indexesSequence",{getListWithInsertedItems:sH,getListWithRemovedItems:xy}],["physicallyIndexed",{getListWithInsertedItems:nH,getListWithRemovedItems:iH}]]),xJ=t=>{if(D8.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return D8.get(t)};class bJ extends og{constructor(){super(e=>e)}insert(e,r){const n=aH(this.indexedValues,r);this.indexedValues=sH(n,e,r),super.insert(e,r)}remove(e){const r=xy(this.indexedValues,e);this.indexedValues=oH(r,e),super.remove(e)}}const F8=new Map([["hiding",HR],["index",og],["linkedPhysicalIndexToValue",LR],["physicalIndexToValue",jh],["trimming",R1]]);function T3e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!F8.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(F8.get(t))(e)}function k3e(t,e,r){return(e=P3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P3e(t){var e=A3e(t,"string");return typeof e=="symbol"?e:e+""}function A3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lH{constructor(){k3e(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);Le(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Dr(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}ur(lH,fi);function AP(t,e,r){return(e=I3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I3e(t){var e=O3e(t,"string");return typeof e=="symbol"?e:e+""}function O3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H8 extends lH{constructor(e,r){super(),AP(this,"mergedValuesCache",[]),AP(this,"aggregationFunction",void 0),AP(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=At(this.get(),s=>s.getValues()),n=[],i=Le(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return At(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return Le(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function M3e(t,e,r){N3e(t,e),e.set(t,r)}function N3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D3e(t,e,r){return t.set(_J(t,e),r),r}function F3e(t,e){return t.get(_J(t,e))}function _J(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var IP=new WeakMap;class EJ{constructor(){M3e(this,IP,[])}subscribe(e){return this.addLocalHook("change",e),this._write(F3e(IP,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){D3e(IP,this,e)}}ur(EJ,fi);function L8(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function F0(t,e,r){H3e(t,e),e.set(t,r)}function H3e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yo(t,e){return t.get(RJ(t,e))}function qC(t,e,r){return t.set(RJ(t,e),r),r}function RJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var JC=new WeakMap,H0=new WeakMap,QC=new WeakMap,ZC=new WeakMap,eS=new WeakMap;class L3e{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};F0(this,JC,new Set),F0(this,H0,[]),F0(this,QC,[]),F0(this,ZC,!1),F0(this,eS,!1),qC(eS,this,e??!1)}createObserver(){const e=new EJ;return yo(JC,this).add(e),e.addLocalHook("unsubscribe",()=>{yo(JC,this).delete(e)}),e._writeInitialChanges(L8(yo(H0,this),yo(QC,this))),e}emit(e){let r=yo(QC,this);(!yo(ZC,this)||yo(H0,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(yo(eS,this)):qC(H0,this,new Array(e.length).fill(yo(eS,this))),yo(ZC,this)||(qC(ZC,this,!0),r=yo(H0,this)));const n=L8(r,e);yo(JC,this).forEach(i=>i._write(n)),qC(QC,this,e)}}function $i(t,e,r){return(e=$3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $3e(t){var e=B3e(t,"string");return typeof e=="symbol"?e:e+""}function B3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BM{constructor(){$i(this,"indexesSequence",new bJ),$i(this,"trimmingMapsCollection",new H8(e=>e.some(r=>r===!0),!1)),$i(this,"hidingMapsCollection",new H8(e=>e.some(r=>r===!0),!1)),$i(this,"variousMapsCollection",new lH),$i(this,"hidingChangesObservable",new L3e({initialIndexValue:!1})),$i(this,"notTrimmedIndexesCache",[]),$i(this,"notHiddenIndexesCache",[]),$i(this,"isBatched",!1),$i(this,"indexesSequenceChanged",!1),$i(this,"indexesChangeSource",void 0),$i(this,"trimmedIndexesChanged",!1),$i(this,"hiddenIndexesChanged",!1),$i(this,"renderablePhysicalIndexesCache",[]),$i(this,"fromPhysicalToVisualIndexesCache",new Map),$i(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,T3e(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof R1?this.trimmingMapsCollection.register(e,r):r instanceof HR?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return Le(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return Le(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return Le(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return Le(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=At(e,c=>this.getPhysicalFromVisualIndex(c)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=xy(this.getIndexesSequence(),n),a=o.filter(c=>this.isTrimmed(c)===!1);let l=o.indexOf(a[a.length-1])+1;if(r+s<i){const c=a[r];l=o.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(sH(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],s=Le(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=At(new Array(r).fill(s),(c,u)=>c+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(c=>c+1):a;this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}ur(BM,fi);function V3e(t,e){return St(e,(r,n)=>{Dr(t[n])&&(t[n]=r)}),t}function TJ(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function kJ(t){Le(t)&&DF(Qt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function W3e(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:j3e,getValues:U3e}=Zo("phraseFormatters");function z3e(t,e){j3e(t,e)}function G3e(){return U3e()}z3e("pluralize",W3e);const PJ="ContextMenu:items",ct=PJ,cH=`${ct}.noItems`,uH=`${ct}.insertRowAbove`,hH=`${ct}.insertRowBelow`,fH=`${ct}.insertColumnOnTheLeft`,dH=`${ct}.insertColumnOnTheRight`,gH=`${ct}.removeRow`,mH=`${ct}.removeColumn`,pH=`${ct}.undo`,vH=`${ct}.redo`,E_=`${ct}.readOnly`,wH=`${ct}.clearColumn`,yH=`${ct}.copy`,CH=`${ct}.copyWithHeaders`,SH=`${ct}.copyWithGroupHeaders`,xH=`${ct}.copyHeadersOnly`,bH=`${ct}.cut`,_H=`${ct}.freezeColumn`,EH=`${ct}.unfreezeColumn`,RH=`${ct}.mergeCells`,TH=`${ct}.unmergeCells`,kH=`${ct}.addComment`,PH=`${ct}.editComment`,AH=`${ct}.removeComment`,IH=`${ct}.readOnlyComment`,OH=`${ct}.align`,MH=`${ct}.align.left`,NH=`${ct}.align.center`,DH=`${ct}.align.right`,FH=`${ct}.align.justify`,HH=`${ct}.align.top`,LH=`${ct}.align.middle`,$H=`${ct}.align.bottom`,BH=`${ct}.borders`,VH=`${ct}.borders.top`,WH=`${ct}.borders.right`,jH=`${ct}.borders.bottom`,UH=`${ct}.borders.left`,zH=`${ct}.borders.remove`,GH=`${ct}.nestedHeaders.insertChildRow`,YH=`${ct}.nestedHeaders.detachFromParent`,KH=`${ct}.hideColumn`,XH=`${ct}.showColumn`,qH=`${ct}.hideRow`,JH=`${ct}.showRow`,os="Filters:",qr=`${os}conditions`,$R=`${qr}.none`,QH=`${qr}.isEmpty`,ZH=`${qr}.isNotEmpty`,eL=`${qr}.isEqualTo`,tL=`${qr}.isNotEqualTo`,rL=`${qr}.beginsWith`,nL=`${qr}.endsWith`,iL=`${qr}.contains`,sL=`${qr}.doesNotContain`,Y3e=`${qr}.byValue`,oL=`${qr}.greaterThan`,aL=`${qr}.greaterThanOrEqualTo`,lL=`${qr}.lessThan`,cL=`${qr}.lessThanOrEqualTo`,uL=`${qr}.isBetween`,hL=`${qr}.isNotBetween`,fL=`${qr}.after`,dL=`${qr}.before`,gL=`${qr}.today`,mL=`${qr}.tomorrow`,pL=`${qr}.yesterday`,vL=`${os}labels.filterByCondition`,wL=`${os}labels.filterByValue`,yL=`${os}labels.conjunction`,BR=`${os}labels.disjunction`,R_=`${os}values.blankCells`,CL=`${os}buttons.selectAll`,SL=`${os}buttons.clear`,xL=`${os}buttons.ok`,bL=`${os}buttons.cancel`,_L=`${os}buttons.placeholder.search`,EL=`${os}buttons.placeholder.value`,RL=`${os}buttons.placeholder.secondValue`,TL="CheckboxRenderer:",kL=`${TL}checked`,PL=`${TL}unchecked`,K3e=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:kL,CHECKBOX_RENDERER_NAMESPACE:TL,CHECKBOX_UNCHECKED:PL,CONTEXTMENU_ITEMS_ADD_COMMENT:kH,CONTEXTMENU_ITEMS_ALIGNMENT:OH,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:$H,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:NH,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:FH,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:MH,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:LH,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:DH,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:HH,CONTEXTMENU_ITEMS_BORDERS:BH,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:jH,CONTEXTMENU_ITEMS_BORDERS_LEFT:UH,CONTEXTMENU_ITEMS_BORDERS_RIGHT:WH,CONTEXTMENU_ITEMS_BORDERS_TOP:VH,CONTEXTMENU_ITEMS_CLEAR_COLUMN:wH,CONTEXTMENU_ITEMS_COPY:yH,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:xH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:SH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:CH,CONTEXTMENU_ITEMS_CUT:bH,CONTEXTMENU_ITEMS_EDIT_COMMENT:PH,CONTEXTMENU_ITEMS_FREEZE_COLUMN:_H,CONTEXTMENU_ITEMS_HIDE_COLUMN:KH,CONTEXTMENU_ITEMS_HIDE_ROW:qH,CONTEXTMENU_ITEMS_INSERT_LEFT:fH,CONTEXTMENU_ITEMS_INSERT_RIGHT:dH,CONTEXTMENU_ITEMS_MERGE_CELLS:RH,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:YH,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:GH,CONTEXTMENU_ITEMS_NO_ITEMS:cH,CONTEXTMENU_ITEMS_READ_ONLY:E_,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:IH,CONTEXTMENU_ITEMS_REDO:vH,CONTEXTMENU_ITEMS_REMOVE_BORDERS:zH,CONTEXTMENU_ITEMS_REMOVE_COLUMN:mH,CONTEXTMENU_ITEMS_REMOVE_COMMENT:AH,CONTEXTMENU_ITEMS_REMOVE_ROW:gH,CONTEXTMENU_ITEMS_ROW_ABOVE:uH,CONTEXTMENU_ITEMS_ROW_BELOW:hH,CONTEXTMENU_ITEMS_SHOW_COLUMN:XH,CONTEXTMENU_ITEMS_SHOW_ROW:JH,CONTEXTMENU_ITEMS_UNDO:pH,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:EH,CONTEXTMENU_ITEMS_UNMERGE_CELLS:TH,CONTEXT_MENU_ITEMS_NAMESPACE:PJ,FILTERS_BUTTONS_CANCEL:bL,FILTERS_BUTTONS_CLEAR:SL,FILTERS_BUTTONS_OK:xL,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:_L,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:RL,FILTERS_BUTTONS_PLACEHOLDER_VALUE:EL,FILTERS_BUTTONS_SELECT_ALL:CL,FILTERS_CONDITIONS_AFTER:fL,FILTERS_CONDITIONS_BEFORE:dL,FILTERS_CONDITIONS_BEGINS_WITH:rL,FILTERS_CONDITIONS_BETWEEN:uL,FILTERS_CONDITIONS_BY_VALUE:Y3e,FILTERS_CONDITIONS_CONTAINS:iL,FILTERS_CONDITIONS_EMPTY:QH,FILTERS_CONDITIONS_ENDS_WITH:nL,FILTERS_CONDITIONS_EQUAL:eL,FILTERS_CONDITIONS_GREATER_THAN:oL,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:aL,FILTERS_CONDITIONS_LESS_THAN:lL,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:cL,FILTERS_CONDITIONS_NAMESPACE:qr,FILTERS_CONDITIONS_NONE:$R,FILTERS_CONDITIONS_NOT_BETWEEN:hL,FILTERS_CONDITIONS_NOT_CONTAIN:sL,FILTERS_CONDITIONS_NOT_EMPTY:ZH,FILTERS_CONDITIONS_NOT_EQUAL:tL,FILTERS_CONDITIONS_TODAY:gL,FILTERS_CONDITIONS_TOMORROW:mL,FILTERS_CONDITIONS_YESTERDAY:pL,FILTERS_DIVS_FILTER_BY_CONDITION:vL,FILTERS_DIVS_FILTER_BY_VALUE:wL,FILTERS_LABELS_CONJUNCTION:yL,FILTERS_LABELS_DISJUNCTION:BR,FILTERS_NAMESPACE:os,FILTERS_VALUES_BLANK_CELLS:R_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const AJ={languageCode:"en-US",[cH]:"No available options",[uH]:"Insert row above",[hH]:"Insert row below",[fH]:"Insert column left",[dH]:"Insert column right",[gH]:["Remove row","Remove rows"],[mH]:["Remove column","Remove columns"],[pH]:"Undo",[vH]:"Redo",[E_]:"Read only",[wH]:"Clear column",[OH]:"Alignment",[MH]:"Left",[NH]:"Center",[DH]:"Right",[FH]:"Justify",[HH]:"Top",[LH]:"Middle",[$H]:"Bottom",[_H]:"Freeze column",[EH]:"Unfreeze column",[BH]:"Borders",[VH]:"Top",[WH]:"Right",[jH]:"Bottom",[UH]:"Left",[zH]:"Remove border(s)",[kH]:"Add comment",[PH]:"Edit comment",[AH]:"Delete comment",[IH]:"Read-only comment",[RH]:"Merge cells",[TH]:"Unmerge cells",[yH]:"Copy",[CH]:["Copy with header","Copy with headers"],[SH]:["Copy with group header","Copy with group headers"],[xH]:["Copy header only","Copy headers only"],[bH]:"Cut",[GH]:"Insert child row",[YH]:"Detach from parent",[KH]:["Hide column","Hide columns"],[XH]:["Show column","Show columns"],[qH]:["Hide row","Hide rows"],[JH]:["Show row","Show rows"],[$R]:"None",[QH]:"Is empty",[ZH]:"Is not empty",[eL]:"Is equal to",[tL]:"Is not equal to",[rL]:"Begins with",[nL]:"Ends with",[iL]:"Contains",[sL]:"Does not contain",[oL]:"Greater than",[aL]:"Greater than or equal to",[lL]:"Less than",[cL]:"Less than or equal to",[uL]:"Is between",[hL]:"Is not between",[fL]:"After",[dL]:"Before",[gL]:"Today",[mL]:"Tomorrow",[pL]:"Yesterday",[R_]:"Blank cells",[vL]:"Filter by condition",[wL]:"Filter by value",[yL]:"And",[BR]:"Or",[CL]:"Select all",[SL]:"Clear",[xL]:"OK",[bL]:"Cancel",[_L]:"Search",[EL]:"Value",[RL]:"Second value",[kL]:"Checked",[PL]:"Unchecked"},X3e=K3e,VM=AJ.languageCode,{register:q3e,getItem:IJ,hasItem:J3e,getValues:Q3e}=Zo("languagesDictionaries");OJ(AJ);function OJ(t,e){let r=t,n=e;return Ct(t)&&(n=t,r=n.languageCode),Z3e(r,n),q3e(r,ns(n)),ns(n)}function Z3e(t,e){t!==VM&&V3e(e,IJ(VM))}function MJ(t){return AL(t)?ns(IJ(t)):null}function AL(t){return J3e(t)}function eBe(){return Q3e()}function NJ(t,e,r){const n=MJ(t);if(n===null)return null;const i=n[e];if(Dr(i))return null;const s=tBe(i,r);return Array.isArray(s)?s[0]:s}function tBe(t,e){let r=t;return Z(G3e(),n=>{r=n(t,e)}),r}function rBe(t){let e=TJ(t);return AL(e)||(e=VM,kJ(t)),e}function nBe(t,e,r){return(e=iBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iBe(t){var e=sBe(t,"string");return typeof e=="symbol"?e:e+""}function sBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cu extends fJ{constructor(e,r){super(e,null),nBe(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,n,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function OP(t){let{activeHeaderClassName:e,...r}=t;return new cu({className:e,...r,selectionType:dJ})}function oBe(t){let{areaCornerVisible:e,...r}=t;return new cu({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:KF})}function aBe(t){let{...e}=t;return new cu({className:"highlight",...e,selectionType:KF})}function lBe(t){let{columnClassName:e,...r}=t;return new cu({className:e,...r,selectionType:p4e})}function cBe(t){let{cellCornerVisible:e,...r}=t;return new cu({className:"current",headerAttributes:[kF()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:__})}function uBe(t){let{border:e,visualCellRange:r,...n}=t;return new cu({...e,...n,selectionType:v4e},r)}function hBe(t){let{...e}=t;return new cu({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:g4e})}function $8(t){let{headerClassName:e,...r}=t;return new cu({className:e,...r,selectionType:YF})}function fBe(t){let{rowClassName:e,...r}=t;return new cu({className:e,...r,selectionType:m4e})}function dBe(t,e){gBe(t,e),e.add(t)}function gBe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cs(t,e,r){return(e=mBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mBe(t){var e=pBe(t,"string");return typeof e=="symbol"?e:e+""}function pBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ec(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var el=new WeakSet;class vBe{constructor(e){dBe(this,el),cs(this,"options",void 0),cs(this,"layerLevel",0),cs(this,"focus",void 0),cs(this,"fill",void 0),cs(this,"layeredAreas",new Map),cs(this,"areas",new Map),cs(this,"rowHeaders",new Map),cs(this,"columnHeaders",new Map),cs(this,"activeRowHeaders",new Map),cs(this,"activeColumnHeaders",new Map),cs(this,"activeCornerHeaders",new Map),cs(this,"rowHighlights",new Map),cs(this,"columnHighlights",new Map),cs(this,"customSelections",[]),this.options=e,this.focus=cBe(e),this.fill=hBe(e)}isEnabledFor(e,r){let n=e;e===__&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return ec(el,this,tc).call(this,this.layeredAreas,oBe)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return ec(el,this,tc).call(this,this.areas,aBe)}getAreas(){return[...this.areas.values()]}createRowHeader(){return ec(el,this,tc).call(this,this.rowHeaders,$8)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return ec(el,this,tc).call(this,this.columnHeaders,$8)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return ec(el,this,tc).call(this,this.activeRowHeaders,OP)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return ec(el,this,tc).call(this,this.activeColumnHeaders,OP)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return ec(el,this,tc).call(this,this.activeCornerHeaders,OP)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return ec(el,this,tc).call(this,this.rowHighlights,fBe)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return ec(el,this,tc).call(this,this.columnHighlights,lBe)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(uBe({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Z(this.areas.values(),e=>void e.clear()),Z(this.layeredAreas.values(),e=>void e.clear()),Z(this.rowHeaders.values(),e=>void e.clear()),Z(this.columnHeaders.values(),e=>void e.clear()),Z(this.activeRowHeaders.values(),e=>void e.clear()),Z(this.activeColumnHeaders.values(),e=>void e.clear()),Z(this.activeCornerHeaders.values(),e=>void e.clear()),Z(this.rowHighlights.values(),e=>void e.clear()),Z(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function tc(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function B8(t,e,r){return(e=wBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wBe(t){var e=yBe(t,"string");return typeof e=="symbol"?e:e+""}function yBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IL{constructor(e){B8(this,"ranges",[]),B8(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new IL(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function CBe(t,e){DJ(t,e),e.add(t)}function MP(t,e,r){DJ(t,e),e.set(t,r)}function DJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ht(t,e){return t.get(_n(t,e))}function tS(t,e,r){return t.set(_n(t,e),r),r}function _n(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rS=new WeakMap,Cr=new WeakMap,Na=new WeakMap,Hn=new WeakSet;class WM{constructor(e,r){CBe(this,Hn),MP(this,rS,void 0),MP(this,Cr,void 0),MP(this,Na,{x:0,y:0}),tS(rS,this,e),tS(Cr,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ht(Cr,this).createCellCoords(e,r);let s=Ht(rS,this).current().highlight;const o=Ht(Cr,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:c,height:u}=_n(Hn,this,FJ).call(this),{row:h,col:f}=_n(Hn,this,W8).call(this,s),d=Ht(Cr,this).fixedRowsBottom(),g=Ht(Cr,this).minSpareRows(),m=Ht(Cr,this).minSpareCols(),p=Ht(Cr,this).autoWrapRow(),w=Ht(Cr,this).autoWrapCol(),v=Ht(Cr,this).createCellCoords(h+i.row,f+i.col);if(v.row>=u){const T=eo(n&&g>0&&d===0),E=v.col+1,x=Ht(Cr,this).createCellCoords(v.row-u,E>=c?E-c:E);this.runLocalHooks("beforeColumnWrap",T,_n(Hn,this,Eg).call(this,x),E>=c),T.value?this.runLocalHooks("insertRowRequire",Ht(Cr,this).countRenderableRows()):w&&v.assign(x)}else if(v.row<0){const T=eo(w),E=v.col-1,x=Ht(Cr,this).createCellCoords(u+v.row,E<0?c+E:E);this.runLocalHooks("beforeColumnWrap",T,_n(Hn,this,Eg).call(this,x),E<0),w&&v.assign(x)}if(v.col>=c){const T=eo(n&&m>0),E=v.row+1,x=Ht(Cr,this).createCellCoords(E>=u?E-u:E,v.col-c);this.runLocalHooks("beforeRowWrap",T,_n(Hn,this,Eg).call(this,x),E>=u),T.value?this.runLocalHooks("insertColRequire",Ht(Cr,this).countRenderableColumns()):p&&v.assign(x)}else if(v.col<0){const T=eo(p),E=v.row-1,x=Ht(Cr,this).createCellCoords(E<0?u+E:E,c+v.col);this.runLocalHooks("beforeRowWrap",T,_n(Hn,this,Eg).call(this,x),E<0),p&&v.assign(x)}const{rowDir:y,colDir:b}=_n(Hn,this,V8).call(this,v);a=y,l=b,s=_n(Hn,this,Eg).call(this,v)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,r){const n=Ht(Cr,this).createCellCoords(e,r),i=Ht(rS,this).current(),s=Ht(Cr,this).visualToRenderableCoords(i.highlight),o=_n(Hn,this,NP).call(this,i.to.row,i.from.row),a=_n(Hn,this,DP).call(this,i.to.col,i.from.col),l=i.to.clone();let c=0,u=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:f}=_n(Hn,this,W8).call(this,i.highlight),d=Ht(Cr,this).createCellCoords(o+n.row,a+n.col),g=i.getTopStartCorner(),m=i.getTopEndCorner(),p=i.getBottomEndCorner();if(n.col<0&&a>=f&&d.col<f){const b=d.col-f;d.col=_n(Hn,this,DP).call(this,g.col,m.col)+b}else if(n.col>0&&a<=f&&d.col>f){const b=_n(Hn,this,DP).call(this,m.col,g.col),T=Math.max(d.col-b,1);d.col=b+T}if(n.row<0&&o>=h&&d.row<h){const b=d.row-h;d.row=_n(Hn,this,NP).call(this,g.row,p.row)+b}else if(n.row>0&&o<=h&&d.row>h){const b=_n(Hn,this,NP).call(this,p.row,g.row),T=Math.max(d.row-b,1);d.row=b+T}const{rowDir:w,colDir:v}=_n(Hn,this,V8).call(this,d);c=w,u=v;const y=_n(Hn,this,Eg).call(this,d);n.row===0&&n.col!==0?l.col=y.col:n.row!==0&&n.col===0?l.row=y.row:(l.row=y.row,l.col=y.col)}return this.runLocalHooks("afterTransformEnd",l,c,u),l}setOffsetSize(e){let{x:r,y:n}=e;tS(Na,this,{x:r,y:n})}resetOffsetSize(){tS(Na,this,{x:0,y:0})}}function V8(t){const{width:e,height:r}=_n(Hn,this,FJ).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function FJ(){return{width:Ht(Na,this).x+Ht(Cr,this).countRenderableColumns(),height:Ht(Na,this).y+Ht(Cr,this).countRenderableRows()}}function NP(t,e){const r=Ht(Cr,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:Ht(Na,this).y+r}function DP(t,e){const r=Ht(Cr,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:Ht(Na,this).x+r}function W8(t){const{row:e,col:r}=Ht(Cr,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return Ht(Cr,this).createCellCoords(Ht(Na,this).y+e,Ht(Na,this).x+r)}function Eg(t){const e=t.clone();return e.col=t.col-Ht(Na,this).x,e.row=t.row-Ht(Na,this).y,Ht(Cr,this).renderableToVisualCoords(e)}ur(WM,fi);const VR=0,WR=1,HJ=2,OL=3,SBe=[OL,HJ],xBe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],FP=Symbol("root"),j8=Symbol("child");function xp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:FP;if(e!==FP&&e!==j8)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===FP;let i=VR;if(r){const s=t[0];t.length===0?i=WR:n&&s instanceof b1?i=OL:n&&Array.isArray(s)?i=xp(s,j8):t.length>=2&&t.length<=4&&!t.some((a,l)=>!xBe[l].includes(typeof a))&&(i=HJ)}return i}function by(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SBe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===OL;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],c=o?s.to.row:s[2],u=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof u=="string"&&(u=i(u))),Dr(c)&&(c=a),Dr(u)&&(u=l),!n){const d=a,g=l,m=c,p=u;a=Math.min(d,m),l=Math.min(g,p),c=Math.max(d,m),u=Math.max(g,p)}const h=e(a,l),f=e(c,u);return r(h,h,f)}}function bBe(t){const e=xp(t.getSelected());if(e===VR||e===WR)return[];const r=by(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;Z(t.getSelected(),o=>{const{from:a,to:l}=r(o),c=Math.max(a.col,0),u=l.col-c+1;Z(Array.from(new Array(u),(h,f)=>c+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Ns(i,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function _Be(t){const e=xp(t.getSelected());if(e===VR||e===WR)return[];const r=by(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;Z(t.getSelected(),o=>{const{from:a,to:l}=r(o),c=Math.max(a.row,0),u=l.row-c+1;Z(Array.from(new Array(u),(h,f)=>c+f),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Ns(i,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Rg(t,e,r){EBe(t,e),e.set(t,r)}function EBe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rf(t,e,r){return(e=RBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RBe(t){var e=TBe(t,"string");return typeof e=="symbol"?e:e+""}function TBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function br(t,e){return t.get(LJ(t,e))}function tl(t,e,r){return t.set(LJ(t,e),r),r}function LJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pi=new WeakMap,nf=new WeakMap,nS=new WeakMap,L0=new WeakMap,iS=new WeakMap,$0=new WeakMap;class $J{constructor(e,r){var n=this;rf(this,"settings",void 0),rf(this,"tableProps",void 0),rf(this,"inProgress",!1),rf(this,"selectedRange",new IL((i,s,o)=>this.tableProps.createCellRange(i,s,o))),rf(this,"highlight",void 0),Rg(this,pi,void 0),Rg(this,nf,void 0),rf(this,"selectedByRowHeader",new Set),rf(this,"selectedByColumnHeader",new Set),Rg(this,nS,!1),Rg(this,L0,!1),Rg(this,iS,"unknown"),Rg(this,$0,-1),this.settings=e,this.tableProps=r,this.highlight=new vBe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[kF()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),tl(pi,this,new WM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),tl(nf,this,new WM(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),br(pi,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),br(pi,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),br(pi,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),br(pi,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),br(pi,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),br(pi,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)}),br(pi,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...s)}),br(pi,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...s)}),br(nf,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),br(nf,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){tl(iS,this,e)}markEndSource(){tl(iS,this,"unknown")}getSelectionSource(){return br(iS,this)}setExpectedLayers(e){tl($0,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,tl($0,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=Dr(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();tl(nS,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!s||s&&!o&&Dr(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!s||i===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),c=o.getVerticalDirection(),u=this.isMultiple();o.setTo(r),u&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),u&&(c!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=br($0,this)===-1||this.selectedRange.size()===br($0,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(Z(this.highlight.getAreas(),g=>void g.clear()),Z(this.highlight.getLayeredAreas(),g=>void g.clear()),Z(this.highlight.getRowHeaders(),g=>void g.clear()),Z(this.highlight.getColumnHeaders(),g=>void g.clear()),Z(this.highlight.getActiveRowHeaders(),g=>void g.clear()),Z(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),Z(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),Z(this.highlight.getRowHighlights(),g=>void g.clear()),Z(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),c.clear(),u.clear(),h.clear(),f.clear(),d.clear(),this.highlight.isEnabledFor(KF,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(YF,e.highlight)){if(!e.isSingleHeader()){const p=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),w=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),y=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(p).commit(),l.add(v).commit(),f.add(p).commit(),d.add(v).commit()):(a.add(p).add(w).commit(),l.add(v).add(y).commit(),f.add(p).add(w).commit(),d.add(v).add(y).commit())}const g=!br(L0,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),m=!br(L0,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());g&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),m&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&m&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(__,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(tl(nS,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?br(pi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):br(pi,this).resetOffsetSize(),this.setRangeStart(br(pi,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?br(pi,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):br(pi,this).resetOffsetSize(),this.setRangeEnd(br(pi,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:s}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?br(nf,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):br(nf,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=br(nf,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=c?-1:0,h=c?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(Mt(i.row+h,u,a-1),i.col),d=this.tableProps.createCellCoords(Mt(s.row+r,u,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(Mt(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const f=this.tableProps.createCellCoords(i.row,Mt(i.col+h,u,a-1)),d=this.tableProps.createCellCoords(s.row,Mt(s.col+r,u,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(f,!0,this.tableProps.createCellCoords(o.row,Mt(o.col+r,0,a-1))):this.setRangeStartOnly(f,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const r=eo(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&br(nS,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),c=n?-l:0,u=r?-a:0;if(c===0&&u===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:d}=i;tl(L0,this,d),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords(Mt(f.row,c,s-1),Mt(f.col,u,o-1)));const g=this.tableProps.createCellCoords(c,u),m=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,h),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.finish(),tl(L0,this,!1)}selectCells(e){var r=this;const n=xp(e);if(n===WR)return!1;if(n===VR)throw new Error(Qt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=by(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const c=i(l),u=c.isValid(o);return!(u&&!c.containsHeaders()||u&&c.containsHeaders()&&c.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),Z(e,l=>{const{from:c,to:u}=i(l);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(u.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),c=l===0?0:-l,u=this.tableProps.createCellCoords(c,i),h=this.tableProps.createCellCoords(o-1,s),f=this.tableProps.createCellRange(u,u,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){let d=0,g=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(d=Mt(n.row,c,o-1),g=Mt(n.col,Math.min(i,s),Math.max(i,s))):(d=Mt(n,c,o-1),g=i);const m=this.tableProps.createCellCoords(d,g),p=l===0?0:Mt(m.row,c,-1),w=o-1,v=this.tableProps.createCellCoords(p,i),y=this.tableProps.createCellCoords(w,s);this.runLocalHooks("beforeSelectColumns",v,y,m),v.row=p,y.row=w,this.setRangeStartOnly(v,void 0,m),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectColumns",v,y,m),this.finish()}return f}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),c=this.tableProps.createCellCoords(r,s-1),u=this.tableProps.createCellRange(l,l,c).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(u){let h=0,f=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=Mt(n.row,Math.min(e,r),Math.max(e,r)),f=Mt(n.col,a,s-1)):(h=e,f=Mt(n,a,s-1));const d=this.tableProps.createCellCoords(h,f),g=o===0?0:Mt(d.col,a,-1),m=s-1,p=this.tableProps.createCellCoords(e,g),w=this.tableProps.createCellCoords(r,m);this.runLocalHooks("beforeSelectRows",p,w,d),p.col=g,w.col=m,this.setRangeStartOnly(p,void 0,d),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",p,w,d),this.finish()}return u}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(o=>{const{from:a,to:l,highlight:c}=o,u=e-1,h=r-1;c.assign({row:Mt(c.row,this.settings.navigableHeaders?-1/0:0,u),col:Mt(c.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Mt(a.row,-1/0,u),col:Mt(a.col,-1/0,h)}),l.assign({row:Mt(l.row,-1/0,u),col:Mt(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,c),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(__,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),c.commit(),u.commit(),h.commit(),f.commit(),d.commit()}this.highlight.useLayerLevel(r)}}ur($J,fi);const U8=/^(\r\n|\n\r|\r|\n)/,kBe=/^[^\t\r\n]+/,z8=/^\t/;function PBe(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(z8))t=t.replace(z8,""),r+=1,e[n][r]="";else if(t.match(U8))t=t.replace(U8,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(kBe);s=o?o[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function aw(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function sf(t,e,r){return(e=ABe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ABe(t){var e=IBe(t,"string");return typeof e=="symbol"?e:e+""}function IBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mm{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){sf(this,"hot",void 0),sf(this,"metaManager",void 0),sf(this,"tableMeta",void 0),sf(this,"dataSource",void 0),sf(this,"duckSchema",void 0),sf(this,"colToPropCache",void 0),sf(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){const a=AF(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=o?r(n):r[n];if(Ct(a)){if(typeof a.data<"u"){const l=o?s:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return SJ(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&St(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&Le(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(Le(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?yy(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||o===null)return{delta:0};const u=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<r&&s+a<u;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=ns(this.getSchema()):(g=[],je(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},PR(g,this.getSchema())),f.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,f);const d=this.hot.toVisualRow(o);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",d,a,n),{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),c=this.hot.countSourceRows(),u=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",u,r,n)===!1)return{delta:0};const h=u<l?this.hot.toPhysicalColumn(u):a,f=i==="end"?Math.min(h+1,a):h;let d=0;for(let g=f;d<r&&l+d<o;g++){if(typeof u!="number"||u>=l+d)if(c>0)for(let m=0;m<c;m+=1)typeof s[m]>"u"&&(s[m]=[]),s[m].push(null);else s.push([null]);else for(let m=0;m<c;m++)s[m].splice(g,0,null);d+=1}return d>0&&(e==null?this.metaManager.createColumn(null,d):n!=="auto"&&this.metaManager.createColumn(f,r)),this.hot.columnIndexMapper.insertIndexes(u,d,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(f),d,n),this.refreshDuckSchema(),{delta:d,startPhysicalIndex:f}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const u=Le(this.tableMeta.columns)||Le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!u&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((u,h)=>h-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let l=!0;const c=o.length,u=this.dataSource;for(let h=0;h<c;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)u[h].splice(s[0],r),h===0&&this.metaManager.removeColumn(s[0],r);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let d=0;d<c;d++)u[h].splice(o[d],1),h===0&&this.metaManager.removeColumn(o[d],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];_W(l,o);let u=0;for(;u<n;)l.push(null),u+=1;return fNe(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];_W(l,o);let u=0;for(;u<n;)l.push(null),u+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Pn(i,r))a=i[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const c=r.split(".");for(let u=0,h=c.length;u<h;u++)if(l=l[c[u]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=eo(a);this.hot.runHooks("modifyData",e,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const c=eo(s);this.hot.runHooks("modifyData",e,this.propToCol(r),c,"set"),c.isTouched()&&(s=c.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Pn(o,r))o[r]=s;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let c=o,u=0,h;const f=r.split(".");for(u=0,h=f.length-1;u<h;u++){if(f[u]==="__proto__"||f[u]==="constructor"||f[u]==="prototype")return;typeof c[f[u]]>"u"&&(c[f[u]]={}),c=c[f[u]]}c[f[u]]=s}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],s);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;o[r]=s}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,o=r;for(;s<n&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Mm.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,o,a;const l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];const u=n===Mm.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),f=Math.min(Math.max(c-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=h;s++){a=[];const d=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=f&&d!==null;o++)a.push(u.call(this,s,this.colToProp(o)));d!==null&&i.push(a)}return i}getText(e,r){return aw(this.getRange(e,r,Mm.DESTINATION_RENDERER))}getCopyableText(e,r){return aw(this.getRange(e,r,Mm.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:OBe,getItem:MBe,hasItem:BJ,getNames:zrt,getValues:Grt}=Zo("cellTypes");function NBe(t){if(!BJ(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return MBe(t)}function fa(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&Bs(t,r),n&&_o(t,n),i&&sm(t,i),OBe(t,e)}function DBe(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Pn(e,t)}function jR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?NBe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&St(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!Ct(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};St(n,(s,o)=>{if(DBe(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),In(t,i)}function FBe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}iDe(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Kx(t){return Number.isInteger(t)&&t>=0}function Xx(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function sS(t){return t==null}const VJ=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),an(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),an(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),PF(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function G8(t,e,r){return(e=HBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HBe(t){var e=LBe(t,"string");return typeof e=="symbol"?e:e+""}function LBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Be(){return class{}}class BBe{constructor(e){G8(this,"metaCtor",$Be()),G8(this,"meta",void 0),this.meta=this.metaCtor.prototype,In(this.meta,VJ()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;In(this.meta,e),jR(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function VBe(t,e,r){return(e=WBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WBe(t){var e=jBe(t,"string");return typeof e=="symbol"?e:e+""}function jBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UBe{constructor(e){VBe(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){In(this.meta,e),jR(this.meta,e,e)}}function oS(t,e,r){return(e=zBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zBe(t){var e=GBe(t,"string");return typeof e=="symbol"?e:e+""}function GBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_{constructor(e){oS(this,"valueFactory",void 0),oS(this,"data",[]),oS(this,"index",[]),oS(this,"holes",new Set),this.valueFactory=e}obtain(e){Xx(()=>Kx(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xx(()=>Kx(e)||sS(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);const s=sS(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Xx(()=>Kx(e)||sS(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(sS(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Y8(t,e,r){return(e=YBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YBe(t){var e=KBe(t,"string");return typeof e=="symbol"?e:e+""}function KBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XBe=["data","width"];class qBe{constructor(e){Y8(this,"globalMeta",void 0),Y8(this,"metas",new T_(()=>this._createMeta())),this.globalMeta=e,this.metas=new T_(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);In(n,r),jR(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return FBe(this.globalMeta.getMetaConstructor(),XBe).prototype}}function K8(t,e,r){return(e=JBe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JBe(t){var e=QBe(t,"string");return typeof e=="symbol"?e:e+""}function QBe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZBe{constructor(e){K8(this,"columnMeta",void 0),K8(this,"metas",new T_(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);In(i,n),jR(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)Le(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Xx(()=>Kx(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new T_(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class WJ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new BBe(e),this.tableMeta=new UBe(this.globalMeta),this.columnMeta=new qBe(this.globalMeta),this.cellMeta=new ZBe(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ur(WJ,fi);function X8(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:c,firstRun:u}=n,h=$a(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":er(f.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${h}`,t,u,l);const d=new Mm(i,t,c);if(e(d),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=d.getSchema();t=[];let m,p=0,w=0;for(p=0,w=f.startRows;p<w;p++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)m=ns(g),t.push(m);else if(i.dataType==="array")m=ns(g[0]),t.push(m);else{m=[];for(let v=0,y=f.startCols;v<y;v++)m.push(null);t.push(m)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,d.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=d.colToProp.bind(d),o.propToCol=d.propToCol.bind(d),o.countCachedColumns=d.countCachedColumns.bind(d),r(d),i.runHooks(`after${h}`,t,u,l),u||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&et(i.rootElement,[mq(-1),kR(i.countCols()+(i.view?i.countRowHeaders():0))])}function q8(t,e,r){return(e=eVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eVe(t){var e=tVe(t,"string");return typeof e=="symbol"?e:e+""}function tVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rVe{constructor(e){var r=this;q8(this,"metaManager",void 0),q8(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),Fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const c=Pn(e,"type")?e.type:null;let u=er(e.cells)?e.cells(n,i,l):null;if(c)if(u){var h;u.type=(h=u.type)!==null&&h!==void 0?h:c}else u={type:c};u&&this.metaManager.updateCellMeta(n,i,u),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function nVe(t,e,r){iVe(t,e),e.set(t,r)}function iVe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HP(t,e,r){return(e=sVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sVe(t){var e=oVe(t,"string");return typeof e=="symbol"?e:e+""}function oVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aVe(t,e){return t.get(lVe(t,e))}function lVe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var J8=new WeakMap;class cVe{constructor(e){HP(this,"metaManager",void 0),HP(this,"usageTracker",new Set),HP(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),nVe(this,J8,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,l,s),o&&this.installPropWatcher(i,l,s)):n&&(this.installPropWatcher(r,l,aVe(J8,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}const jJ="gridDefault",Uh="editorManager.handlingEditor",uVe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},hVe="hooksRefRegisterer",UJ={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Z(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){St(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};lu(UJ,"MIXIN_NAME",hVe,{writable:!1,enumerable:!1});function aa(t,e,r){return(e=fVe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fVe(t){var e=dVe(t,"string");return typeof e=="symbol"?e:e+""}function dVe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gVe="base",en=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Jp{static get EDITOR_TYPE(){return gVe}constructor(e){aa(this,"hot",void 0),aa(this,"state",en.VIRGIN),aa(this,"_opened",!1),aa(this,"_fullEditMode",!1),aa(this,"_closeCallback",null),aa(this,"TD",null),aa(this,"row",null),aa(this,"col",null),aa(this,"prop",null),aa(this,"originalValue",null),aa(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:en.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[n,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==en.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=en.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Fr(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),n.view.scrollViewport(n._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===en.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===en.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=en.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=en.FINISHED,this.discardEditor(o)}):(this.state=en.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=en.FINISHED,this.discardEditor()}discardEditor(e){this.state===en.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=en.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=en.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===en.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=Ai(r),a=mn(r),l=Ai(this.hot.rootElement),c=mn(this.hot.rootElement),u=n.topOverlay.holder,h=n.inlineStartOverlay.holder,f=u!==s?u.scrollTop:0,d=h!==s?h.scrollLeft:0,g=s.innerWidth-l.left-c,{wtTable:m}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,p=m.name,w=["master","inline_start"].includes(p)?f:0,v=["master","top","bottom"].includes(p)?d:0,y=o.top===l.top?0:1;let b=o.top-l.top-y-w,T=0;this.hot.isRtl()?T=s.innerWidth-o.left-a-g-1+v:T=o.left-l.left-1-v,["top","top_inline_start_corner"].includes(p)&&(b+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(T+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const E=this.hot.hasColHeaders(),x=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),P=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),O=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&x<=0||x===O)&&(b+=1),P<=0&&(T+=1);const Y=i.rowsRenderCalculator.startPosition,B=i.columnsRenderCalculator.startPosition,ie=Math.abs(n.inlineStartOverlay.getScrollPosition()),ue=n.topOverlay.getScrollPosition(),he=ei(this.hot.rootDocument);let Ee=r.offsetTop;if(["inline_start","master"].includes(p)&&(Ee+=Y-ue),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:X,wtTable:ee}=n.bottomOverlay.clone;Ee+=X.getWorkspaceHeight()-ee.getHeight()-he}let Ce=r.offsetLeft;this.hot.isRtl()?(Ce>=0?Ce=m.getWidth()-r.offsetLeft:Ce=Math.abs(Ce),Ce+=B-ie-a):["top","master","bottom"].includes(p)&&(Ce+=B-ie);const ge=s.getComputedStyle(this.TD),Q=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ye=parseInt(ge[Q],10)>0?0:1,Re=parseInt(ge.borderTopWidth,10)>0?0:1,j=mn(r)+ye,C=An(r)+Re,S=Nq(u)?he:0,_=Dq(h)?he:0,D=this.hot.view.maximumVisibleElementWidth(Ce)-S+ye,U=Math.max(this.hot.view.maximumVisibleElementHeight(Ee)-_+Re,this.hot.stylesHandler.getDefaultRowHeight());return{top:b,start:T,height:C,maxHeight:U,width:j,maxWidth:D}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}ur(Jp,UJ);const mVe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===en.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},pVe={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},vVe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},wVe={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},yVe={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),Ua(e))}};function CVe(){return[uVe,mVe,pVe,vVe,wVe,yVe]}const SVe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},xVe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),s=r.getNearestNotHiddenIndex(i,-1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},bVe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},_Ve={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},EVe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},RVe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},TVe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},kVe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},PVe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},AVe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},IVe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},OVe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},MVe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},NVe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),s=r.getNearestNotHiddenIndex(i,1);if(s!==null){const o=t._createCellCoords(s,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function DVe(){return[SVe,xVe,bVe,_Ve,EVe,RVe,TVe,kVe,PVe,AVe,IVe,OVe,MVe,NVe]}const FVe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},HVe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?1:s,i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},LVe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},$Ve={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},BVe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},VVe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},WVe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},jVe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}},UVe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},zVe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,s)),e.markEndSource()}},GVe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},YVe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},KVe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},XVe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},qVe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},JVe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?-1:-s,i===-n?s=-1:i+s<n&&(s=-(i+n)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function QVe(){return[FVe,HVe,LVe,$Ve,BVe,VVe,WVe,jVe,UVe,zVe,GVe,YVe,KVe,XVe,qVe,JVe]}const ZVe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},eWe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,n),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const u=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-u,0)}if(e.row>=0){const u=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-u,0)}t.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},tWe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},rWe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},nWe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:c}=t.getCellMeta(a,l);c||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}},iWe=[...CVe(),...DVe(),...QVe(),ZVe,eWe,tWe,rWe,nWe];function zJ(t){const e={};return iWe.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function sWe(t){const e=t.getShortcutManager().addContext("editor"),r=zJ(t),n={group:Uh};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function oWe(t){const e=t.getShortcutManager().addContext("grid"),r=zJ(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:jJ};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:Uh,runOnlyIf:()=>Le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function aWe(t){[oWe,sWe].forEach(e=>e(t))}function lWe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=Q8(t),i=Q8(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.before(n),r.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function Q8(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&et(r,[wp("Focus catcher")]),r}function cWe(t){const e=uWe(t);let r;const{activate:n,deactivate:i}=lWe(t,{onFocusFromTop(){var h;const f=(h=e(r))!==null&&h!==void 0?h:jM(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_above",f),t.selectCell(f.row,f.col)),t.listen()},onFocusFromBottom(){var h;const f=(h=e(r))!==null&&h!==void 0?h:UM(t);f&&(t.runHooks("modifyFocusOnTabNavigation","from_below",f),t.selectCell(f.row,f.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,f,d,g,m)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,m.value=!0),o){var p;r=(p=t.getSelectedRangeLast())===null||p===void 0?void 0:p.highlight}}),t.addHook("beforeRowWrap",(h,f,d)=>{s.wrapped=!0,s.flipped=d});function c(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:jJ,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...u,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...u,callback:h=>{const{tabNavigation:f,autoWrapRow:d}=t.getSettings();if(a=!1,o=!0,!f||!t.selection.isSelected()||d&&s.wrapped&&s.flipped||!d&&s.wrapped)return d&&s.wrapped&&s.flipped&&(r=h.shiftKey?jM(t):UM(t)),c(),!1;h.preventDefault()},position:"after"}])}function jM(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function UM(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function uWe(t){return e=>{if(!e)return null;const r=jM(t),n=UM(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function Qp(t){Bc(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function UR(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),s=r.getFirstFullyVisibleColumn(),o=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,c=a<=s,u=l>=o,h=r.getFirstFullyVisibleRow(),f=r.getLastFullyVisibleRow(),d=n.getTopStartCorner().row,g=n.getBottomEndCorner().row,m=d<=h,p=g>=f;return{getComputedColumnTarget(w){return i==="mouse"||i==="keyboard"?w.col:c&&u?n.highlight.col:c?a:u?l:w.col},getComputedRowTarget(w){return i==="mouse"||i==="keyboard"?w.row:m&&p?n.highlight.row:m?d:p?g:w.row}}}function hWe(t){return e=>{const r=UR(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;Qp(t.getCell(n?-1:0,r,!0))})}}function fWe(){return()=>{}}function dWe(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;Qp(t.getCell(r,n,!0))})}}function gWe(t){return e=>{const r=UR(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;Qp(t.getCell(i,s,!0))})}}function mWe(t){return e=>{const r=UR(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;Qp(t.getCell(i,s,!0))})}}function pWe(t){return e=>{const r=UR(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;Qp(t.getCell(r,n?-1:0,!0))})}}function vWe(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,s=()=>{Qp(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},s);else if(i<0&&n>=0)t.scrollViewportTo({row:n},s);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},s)}}}function wWe(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let o;e.isFocusSelectionChanged()?o=dWe(t):e.isSelectedByCorner()?o=fWe():e.isSelectedByRowHeader()?o=pWe(t):e.isSelectedByColumnHeader()?o=hWe(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=gWe(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=vWe(t):e.getSelectedRange().size()>1&&(o=mWe(t)),(s=o)===null||s===void 0||s(i)}}}const Z8=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),aS=t=>t.map(e=>{const r=e.toLowerCase();return Z8.has(r)?Z8.get(r):r}).sort().join("+"),yWe=t=>t.split("+"),ej=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),LP=t=>{let{which:e,key:r}=t;if(ej.has(e))return ej.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},GJ=Symbol("shortcut-context");function YJ(t){return Ct(t)&&t.__kindOf===GJ}const CWe=t=>{const e=NR({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:c,group:u,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:d=!0,stopPropagation:g=!1,relativeToGroup:m,position:p,forwardToContext:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Dr(u))throw new Error("You need to define the shortcut's group.");if(er(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Qt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:c,group:u,runOnlyIf:h,captureCtrl:f,preventDefault:d,stopPropagation:g};Le(m)&&(v.relativeToGroup=m,v.position=p),YJ(w)&&(v.forwardToContext=w),l.forEach(y=>{const b=aS(y);if(e.hasItem(b)){const E=e.getItem(b);let x=E.findIndex(P=>P.group===m);x!==-1?p==="before"?x-=1:x+=1:x=E.length,E.splice(x,0,v)}else e.addItem(b,[v])})},n=function(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{St(c,(h,f)=>{Object.prototype.hasOwnProperty.call(u,f)===!1&&(u[f]=c[f])}),r(u)})},i=l=>{const c=aS(l);e.removeItem(c)};return{__kindOf:GJ,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const c=aS(l),u=e.getItem(c);return Le(u)?u.slice():[]},hasShortcut:l=>{const c=aS(l);return e.hasItem(c)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[h,f]=u;const d=f.filter(g=>g.group!==l);d.length===0?i(yWe(h)):(f.length=0,f.push(...d))})}}};function SWe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const xWe=["meta","alt","shift","control"],B0=SWe(),V0=[];let lS=0;function bWe(t,e,r,n,i){const s=d=>xWe.includes(d),o=function(d){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return d.altKey&&m.push("alt"),g&&(d.ctrlKey||d.metaKey)?m.push("control/meta"):(d.ctrlKey&&m.push("control"),d.metaKey&&m.push("meta")),d.shiftKey&&m.push("shift"),m},a=d=>{if(e(d)===!1||r(d)===!1||d.keyCode===229||typeof d.key!="string"||jf(d))return;const m=LP(d);let p=[];s(m)||(p=o(d));const w=[m].concat(p);!i(d,w)&&(UW()&&p.includes("meta")||!UW()&&p.includes("control"))&&i(d,[m].concat(o(d,!0))),n(d)},l=d=>{if(typeof d.key=="string"){const g=LP(d);s(g)&&B0.press(g)}},c=d=>{if(typeof d.key=="string"){const g=LP(d);s(g)&&B0.release(g)}},u=()=>{B0.releaseAll()};return{mount:()=>{let d=t;for(lS+=1;d;)lS===1&&(d.document.documentElement.addEventListener("keydown",l),V0.push({event:"keydown",listener:l}),d.document.documentElement.addEventListener("keyup",c),V0.push({event:"keyup",listener:c})),d.document.documentElement.addEventListener("keydown",a),d.document.documentElement.addEventListener("blur",u),d=yp(d)},unmount:()=>{let d=t;for(lS-=1;d;){if(lS===0){for(let g=0;g<V0.length;g++){const{event:m,listener:p}=V0[g];d.document.documentElement.removeEventListener(m,p)}V0.length=0}d.document.documentElement.removeEventListener("keydown",a),d.document.documentElement.removeEventListener("blur",u),d=yp(d)}},isPressed:d=>B0.isPressed(d),releasePressedKeys:()=>B0.releaseAll()}}const _We=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=NR({errorIdExists:g=>`The "${g}" context name is already registered.`});let o="grid";const a=g=>{const m=CWe(g);return s.addItem(g,m),m},l=()=>o,c=g=>s.getItem(g),u=g=>{if(!s.hasItem(g))throw new Error(Qt`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=g};let h=!1;const f=function(g,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const w=YJ(p)?p:c(p);let v=!1;if(!w.hasShortcut(m))return v;const y=w.getShortcuts(m);for(let b=0;b<y.length;b++){const{callback:T,runOnlyIf:E,preventDefault:x,stopPropagation:P,captureCtrl:A,forwardToContext:O}=y[b];if(E(g)===!0){if(h=A,v=T(g,m)===!1,h=!1,x&&g.preventDefault(),P&&(Ua(g),g.stopPropagation()),v)break;O&&f(g,m,O)}}return v},d=bWe(e,r,n,i,f);return d.mount(),{addContext:a,getActiveContextName:l,getContext:c,setActiveContextName:u,isCtrlPressed:()=>!h&&(d.isPressed("control")||d.isPressed("meta")),releasePressedKeys:()=>d.releasePressedKeys(),destroy:()=>d.unmount()}};function tj(t){const{classNames:e}=mDe(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function EWe(t,e){KJ(t,e),e.add(t)}function of(t,e,r){KJ(t,e),e.set(t,r)}function KJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xi(t,e){return t.get(Sa(t,e))}function Po(t,e,r){return t.set(Sa(t,e),r),r}function Sa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const rj=23;var af=new WeakMap,k_=new WeakMap,ML=new WeakMap,zM=new WeakMap,Nu=new WeakMap,Iv=new WeakMap,_y=new WeakMap,wl=new WeakSet;class RWe{constructor(e,r){EWe(this,wl),of(this,af,void 0),of(this,k_,void 0),of(this,ML,void 0),of(this,zM,void 0),of(this,Nu,!0),of(this,Iv,{}),of(this,_y,{}),Po(k_,this,e),Po(zM,this,r)}isClassicTheme(){return xi(Nu,this)}getCSSVariableValue(e){var r;if(xi(Nu,this))return null;if(xi(Iv,this)[`--ht-${e}`])return xi(Iv,this)[`--ht-${e}`];const n=(r=Sa(wl,this,PWe).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Sa(wl,this,XJ).call(this,`--ht-${e}`);if(n!==null)return xi(Iv,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=xi(_y,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(xi(Nu,this))return rj;const e=Sa(wl,this,TWe).call(this);return e||rj}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Po(af,this,void 0),Po(Nu,this,!0),Sa(wl,this,$P).call(this);return}if(e&&e!==xi(af,this)){if(!/ht-theme-.*/.test(e)){zt(`Invalid theme name: ${e}. Please provide a valid theme name.`),Po(af,this,void 0),Po(Nu,this,!1),Sa(wl,this,$P).call(this);return}xi(af,this)&&Sa(wl,this,AWe).call(this),Po(af,this,e),Po(Nu,this,!1),Sa(wl,this,$P).call(this)}}getThemeName(){return xi(af,this)}}function TWe(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function $P(){this.isClassicTheme()||Po(ML,this,getComputedStyle(xi(k_,this)));const t=Sa(wl,this,kWe).call(this,["box-sizing","border-bottom-width"]);xi(_y,this).td={...xi(_y,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function kWe(t){const e=xi(zM,this),r=xi(k_,this),n=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),i.appendChild(s),i.appendChild(o),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),c={};return t.forEach(u=>{c[u]=l.getPropertyValue(u)}),r.removeChild(n),c}function PWe(t){const e=Math.ceil(parseFloat(Sa(wl,this,XJ).call(this,t)));return Number.isNaN(e)?null:e}function XJ(t){const e=xi(ML,this).getPropertyValue(t);return e===""?null:e}function AWe(){Po(_y,this,{}),Po(Iv,this,{}),Po(Nu,this,!0)}function IWe(t,e){qJ(t,e),e.add(t)}function nj(t,e,r){qJ(t,e),e.set(t,r)}function qJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ij(t,e){return t.get(bp(t,e))}function sj(t,e,r){return t.set(bp(t,e),r),r}function bp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var GM=new WeakMap,YM=new WeakMap,lw=new WeakSet;class OWe{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;IWe(this,lw),nj(this,GM,void 0),nj(this,YM,void 0),sj(GM,this,r),sj(YM,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=bp(lw,this,oj).call(this,e.from,r,n);if(i===null)return null;const s=bp(lw,this,oj).call(this,e.to,-r,-n);if(s===null)return null;const o=e.clone();return o.from=i,o.to=s,o.includes(e.highlight)||(o.highlight=i),o}}function oj(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=bp(lw,this,aj).call(this,ij(GM,this),t.row,e);if(n===null)return null;const i=bp(lw,this,aj).call(this,ij(YM,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function aj(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let BP=null;const VP=new Map;function JJ(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new Ba(s);let a,l,c,u,h,f,d=!0;G4e(i)&&z4e(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=om(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,om(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Se(this.rootElement,"ht-wrapper"),Se(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),Se(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",m=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new RWe(s.rootElement,s.rootDocument),e.language=rBe(e.language);const p=Object.fromEntries(Object.entries(e).filter(C=>{let[S]=C;return!(Fe.getSingleton().isRegistered(S)||Fe.getSingleton().isDeprecated(S))})),w=new WJ(s,p,[rVe,cVe]),v=w.getTableMeta(),y=w.getGlobalMeta(),b=NR();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),om(this)&&vNe(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${lq()}`,VP.set(this.guid,this),this.columnIndexMapper=new BM,this.rowIndexMapper=new BM,this.columnIndexMapper.addLocalHook("indexesSequenceChange",C=>{s.runHooks("afterColumnSequenceChange",C)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",C=>{s.runHooks("afterRowSequenceChange",C)}),o.addEventListener(this.rootDocument.documentElement,"compositionstart",C=>{s.runHooks("beforeCompositionStart",C)}),l=new d3e(s);const T=Zo(this.guid);T.register("cellRangeMapper",new OWe({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const E=C=>{const{row:S,col:_}=C;return s._createCellCoords(S>=0?s.rowIndexMapper.getRenderableFromVisualIndex(S):S,_>=0?s.columnIndexMapper.getRenderableFromVisualIndex(_):_)},x=C=>{const{row:S,col:_}=C;return s._createCellCoords(S>=0?s.rowIndexMapper.getVisualFromRenderableIndex(S):S,_>=0?s.columnIndexMapper.getVisualFromRenderableIndex(_):_)},P=(C,S)=>{const _=S>C?1:-1,D=Math.min(C,S),U=Math.max(C,S),X=s.rowIndexMapper.getNearestNotHiddenIndex(C,_);return X===null||_===1&&X>U||_===-1&&X<D?null:X>=0?s.rowIndexMapper.getRenderableFromVisualIndex(X):X},A=(C,S)=>{const _=S>C?1:-1,D=Math.min(C,S),U=Math.max(C,S),X=s.columnIndexMapper.getNearestNotHiddenIndex(C,_);return X===null||_===1&&X>U||_===-1&&X<D?null:X>=0?s.columnIndexMapper.getRenderableFromVisualIndex(X):X};let O=new $J(v,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:C=>a.propToCol(C),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(C,S)=>s._createCellCoords(C,S),createCellRange:(C,S,_)=>s._createCellRange(C,S,_),visualToRenderableCoords:E,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:P,findFirstNonHiddenRenderableColumn:A,isDisabledCellSelection:(C,S)=>C<0||S<0?s.getSettings().disableVisualSelection:s.getCellMeta(C,S).disableVisualSelection});this.selection=O;const Y=C=>{let{hiddenIndexesChanged:S}=C;this.forceFullRender=!0,S&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Y),this.rowIndexMapper.addLocalHook("cacheUpdated",Y),this.selection.addLocalHook("afterSetRangeEnd",(C,S)=>{const _=eo(!1),D=this.selection.getSelectedRange(),{from:U,to:X}=D.current(),ee=D.size()-1;this.runHooks("afterSelection",U.row,U.col,X.row,X.col,_,ee),this.runHooks("afterSelectionByProp",U.row,s.colToProp(U.col),X.row,s.colToProp(X.col),_,ee),S&&(!_.isTouched()||_.isTouched()&&!_.value)&&f.scrollTo(C);const k=O.isSelectedByRowHeader(),M=O.isSelectedByColumnHeader();k&&M?Se(this.rootElement,["ht__selection--rows","ht__selection--columns"]):k?(Je(this.rootElement,"ht__selection--columns"),Se(this.rootElement,"ht__selection--rows")):M?(Je(this.rootElement,"ht__selection--rows"),Se(this.rootElement,"ht__selection--columns")):Je(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(O.getSelectionSource())||u.closeEditor(null),O.getSelectionSource()!=="refresh"&&(s.view.render(),u.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",C=>{this.runHooks("beforeSelectionFocusSet",C.row,C.col)}),this.selection.addLocalHook("afterSetFocus",C=>{const S=eo(!1);this.runHooks("afterSelectionFocusSet",C.row,C.col,S),(!S.isTouched()||S.isTouched()&&!S.value)&&f.scrollTo(C),u.closeEditor(),s.view.render(),u.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",C=>{const S=C.length-1,{from:_,to:D}=C[S];this.runHooks("afterSelectionEnd",_.row,_.col,D.row,D.col,S),this.runHooks("afterSelectionEndByProp",_.row,s.colToProp(_.col),D.row,s.colToProp(D.col),S),O.getSelectionSource()==="refresh"&&(s.view.render(),u.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",C=>{const S=this.runHooks("afterIsMultipleSelection",C.value);C.value&&(C.value=S)}),this.selection.addLocalHook("afterDeselect",()=>{u.closeEditor(),s.view.render(),Je(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSetRangeStart",...S)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSetRangeStartOnly",...S)}).addLocalHook("beforeSetRangeEnd",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSetRangeEnd",...S)}).addLocalHook("beforeSelectColumns",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSelectColumns",...S)}).addLocalHook("afterSelectColumns",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterSelectColumns",...S)}).addLocalHook("beforeSelectRows",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeSelectRows",...S)}).addLocalHook("afterSelectRows",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterSelectRows",...S)}).addLocalHook("beforeModifyTransformStart",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("modifyTransformStart",...S)}).addLocalHook("afterModifyTransformStart",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterModifyTransformStart",...S)}).addLocalHook("beforeModifyTransformFocus",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("modifyTransformFocus",...S)}).addLocalHook("afterModifyTransformFocus",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterModifyTransformFocus",...S)}).addLocalHook("beforeModifyTransformEnd",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("modifyTransformEnd",...S)}).addLocalHook("afterModifyTransformEnd",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("afterModifyTransformEnd",...S)}).addLocalHook("beforeRowWrap",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeRowWrap",...S)}).addLocalHook("beforeColumnWrap",function(){for(var C=arguments.length,S=new Array(C),_=0;_<C;_++)S[_]=arguments[_];return n.runHooks("beforeColumnWrap",...S)}).addLocalHook("insertRowRequire",C=>this.alter("insert_row_above",C,1,"auto")).addLocalHook("insertColRequire",C=>this.alter("insert_col_start",C,1,"auto")),c={alter(C,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;const X=ee=>{if(ee.length===0)return[];const k=[...ee];return k.sort((R,W)=>{let[q]=R,[J]=W;return q===J?0:q>J?1:-1}),Ns(k,(R,W)=>{let[q,J]=W;const re=R[R.length-1],[V,te]=re,oe=V+te;if(q<=oe){const ae=Math.max(J-(oe-q),0);re[1]+=ae}else R.push([q,J]);return R},[k[0]])};switch(C){case"insert_row_below":case"insert_row_above":const ee=s.countSourceRows();if(v.maxRows===ee)return;const k=C==="insert_row_below"?"below":"above";S=S??(k==="below"?ee:0);const{delta:M,startPhysicalIndex:R}=a.createRow(S,_,{source:D,mode:k});O.shiftRows(s.toVisualRow(R),M);break;case"insert_col_start":case"insert_col_end":const W=C==="insert_col_end"?"end":"start";S=S??(W==="end"?s.countSourceCols():0);const{delta:q,startPhysicalIndex:J}=a.createCol(S,_,{source:D,mode:W});if(q){if(Array.isArray(v.colHeaders)){const te=[s.toVisualColumn(J),0];te.length+=q,Array.prototype.splice.apply(v.colHeaders,te)}O.shiftColumns(s.toVisualColumn(J),q)}break;case"remove_row":const re=te=>{let oe=0;Z(te,ae=>{let[fe,Me]=ae;const Ne=an(fe)?s.countRows()-1:Math.max(fe-oe,0);if(Number.isInteger(fe)&&(fe=Math.max(fe-oe,0)),!a.removeRow(fe,Me,D))return;if(O.isSelected()){const{row:We}=s.getSelectedRangeLast().highlight;We>=fe&&We<=fe+Me-1&&u.closeEditor(!0)}const ot=s.countRows(),at=v.fixedRowsTop;at>=Ne+1&&(v.fixedRowsTop-=Math.min(Me,at-Ne));const rt=v.fixedRowsBottom;if(rt&&Ne>=ot-rt&&(v.fixedRowsBottom-=Math.min(Me,rt)),ot===0)O.deselect();else if(D==="ContextMenu.removeRow"){const We=O.getSelectedRange(),ft=We.pop();We.clear().set(ft.from).current().setTo(ft.to),O.refresh()}else O.shiftRows(fe,-Me);oe+=Me})};Array.isArray(S)?re(X(S)):re([[S,_]]);break;case"remove_col":const V=te=>{let oe=0;Z(te,ae=>{let[fe,Me]=ae;const Ne=an(fe)?s.countCols()-1:Math.max(fe-oe,0);let ze=s.toPhysicalColumn(Ne);if(Number.isInteger(fe)&&(fe=Math.max(fe-oe,0)),!a.removeCol(fe,Me,D))return;if(O.isSelected()){const{col:We}=s.getSelectedRangeLast().highlight;We>=fe&&We<=fe+Me-1&&u.closeEditor(!0)}if(s.countCols()===0)O.deselect();else if(D==="ContextMenu.removeColumn"){const We=O.getSelectedRange(),ft=We.pop();We.clear().set(ft.from).current().setTo(ft.to),O.refresh()}else O.shiftColumns(fe,-Me);const rt=v.fixedColumnsStart;rt>=Ne+1&&(v.fixedColumnsStart-=Math.min(Me,rt-Ne)),Array.isArray(v.colHeaders)&&(typeof ze>"u"&&(ze=-1),v.colHeaders.splice(ze,Me)),oe+=Me})};Array.isArray(S)?V(X(S)):V([[S,_]]);break;default:throw new Error(`There is no such action "${C}"`)}U||c.adjustRowsAndCols(),s.view.render(),s.view.adjustElementsSize()},adjustRowsAndCols(){const C=v.minRows,S=v.minSpareRows,_=v.minCols,D=v.minSpareCols;if(C){const U=s.countRows();U<C&&a.createRow(U,C-U,{source:"auto"})}if(S){const U=s.countEmptyRows(!0);if(U<S){const X=S-U,ee=Math.min(X,v.maxRows-s.countSourceRows());a.createRow(s.countRows(),ee,{source:"auto"})}}{let U;(_||D)&&(U=s.countEmptyCols(!0));let X=s.countCols();if(_&&!v.columns&&X<_){const ee=_-X;U+=ee,a.createCol(X,ee,{source:"auto"})}if(D&&!v.columns&&s.dataType==="array"&&U<D){X=s.countCols();const ee=D-U,k=Math.min(ee,v.maxCols-X);a.createCol(X,k,{source:"auto"})}}},populateFromArray(C,S,_,D,U){let X,ee,k,M;const R=[],W={},q=[],J=C.row,re=C.col;if(ee=S.length,ee===0)return!1;let V=0,te=0;switch(Ct(_)&&(V=_.col-re+1,te=_.row-J+1),U){case"shift_down":const oe=zx(S),ae=oe.length,fe=Math.max(ae,V),Me=s.getData().slice(J),Ne=zx(Me).slice(re,re+fe);for(k=0;k<fe;k+=1)if(k<ae){for(X=0,ee=oe[k].length;X<te-ee;X+=1)oe[k].push(oe[k][X%ee]);k<Ne.length?q.push(oe[k].concat(Ne[k])):q.push(oe[k].concat(new Array(Me.length).fill(null)))}else q.push(oe[k%ae].concat(Ne[k]));s.populateFromArray(J,re,zx(q));break;case"shift_right":const ze=S.length,ot=Math.max(ze,te),at=s.getData().slice(J).map(Bt=>Bt.slice(re));for(X=0;X<ot;X+=1)if(X<ze){for(k=0,M=S[X].length;k<V-M;k+=1)S[X].push(S[X][k%M]);if(X<at.length)for(let Bt=0;Bt<at[X].length;Bt+=1)S[X].push(at[X][Bt]);else S[X].push(...new Array(at[0].length).fill(null))}else S.push(S[X%ee].slice(0,ot).concat(at[X]));s.populateFromArray(J,re,S);break;case"overwrite":default:W.row=C.row,W.col=C.col;let rt=0,We=0,ft=!0,Ze;const qt=function(gr){let hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Nt=S[gr%S.length];return hr!==null?Nt[hr%Nt.length]:Nt},Or=S.length,xt=_?_.row-C.row+1:0;for(_?ee=xt:ee=Math.max(Or,xt),X=0;X<ee&&!(_&&W.row>_.row&&xt>Or||!v.allowInsertRow&&W.row>s.countRows()-1||W.row>=v.maxRows);X++){const Bt=X-rt,gr=qt(Bt).length,hr=_?_.col-C.col+1:0;if(_?M=hr:M=Math.max(gr,hr),W.col=C.col,Ze=s.getCellMeta(W.row,W.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Ze.skipRowOnPaste){rt+=1,W.row+=1,ee+=1;continue}for(We=0,k=0;k<M&&!(_&&W.col>_.col&&hr>gr||!v.allowInsertColumn&&W.col>s.countCols()-1||W.col>=v.maxCols);k++){if(Ze=s.getCellMeta(W.row,W.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&Ze.skipColumnOnPaste){We+=1,W.col+=1,M+=1;continue}if(Ze.readOnly&&D!=="UndoRedo.undo"){W.col+=1;continue}const Nt=k-We;let Hi=qt(Bt,Nt),Un=s.getDataAtCell(W.row,W.col);if(Hi!==null&&typeof Hi=="object")if(Array.isArray(Hi)&&Un===null&&(Un=[]),Un===null||typeof Un!="object")ft=!1;else{const za=yy(Array.isArray(Un)?Un:Un[0]||Un),lg=yy(Array.isArray(Hi)?Hi:Hi[0]||Hi);PF(za,lg)||Array.isArray(za)&&Array.isArray(lg)?Hi=ns(Hi):ft=!1}else Un!==null&&typeof Un=="object"&&(ft=!1);ft&&R.push([W.row,W.col,Hi]),ft=!0,W.col+=1}W.row+=1}s.setDataAtCell(R,null,null,D||"populateFromArray");break}}};function B(C){const S=TJ(C);AL(S)?(s.runHooks("beforeLanguageChange",S),y.language=S,s.runHooks("afterLanguageChange",S)):kJ(C)}function ie(C,S){const _=C==="className"?s.rootElement:s.table;if(d)Se(_,S);else{let D=[],U=[];y[C]&&(D=Array.isArray(y[C])?y[C]:RW(y[C])),S&&(U=Array.isArray(S)?S:RW(S));const X=EW(D,U),ee=EW(U,D);X.length&&Je(_,X),ee.length&&Se(_,ee)}y[C]=S}this.init=function(){l.setData(v.data),s.runHooks("beforeInit"),(Il()||Eq())&&Se(s.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new q4e(this);const C=v.themeName||tj(s.rootContainer);s.useTheme(C),u=DM.getInstance(s,v,O),f=wWe(s),h=new xFe(s),om(this)&&cWe(s),s.runHooks("init"),this.render(),d&&s.rootElement.offsetParent===null&&bDe(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof d=="object"&&(s.runHooks("afterChange",d[0],d[1]),d=!1),s.runHooks("afterInit")};function ue(){let C=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,C=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&C===!1&&(C=!0,this.onQueueEmpty(this.valid))}}}function he(C){const S=C.replace(",",".");return isNaN(parseFloat(S))===!1?parseFloat(S):C}function Ee(C,S,_){if(!C.length){_();return}const D=s.getActiveEditor(),U=new ue;let X=!0;U.onQueueEmpty=()=>{D&&X&&D.cancelChanges(),_()};for(let ee=C.length-1;ee>=0;ee--){const[k,M]=C[ee],R=a.propToCol(M);let W;Number.isInteger(R)?W=s.getCellMeta(k,R):W={...Object.getPrototypeOf(v),...v},s.getCellValidator(W)&&(U.addValidatorToQueue(),s.validateCell(C[ee][3],W,function(q,J){return function(re){if(typeof re!="boolean")throw new Error("Validation error: result is not boolean");re===!1&&J.allowInvalid===!1&&(X=!1,C.splice(q,1),J.valid=!0),U.removeValidatorFormQueue()}}(ee,W),S))}U.checkIfQueueIsEmpty()}function Ce(C,S){for(let D=C.length-1;D>=0;D--){let U=!1;if(C[D]===null){C.splice(D,1);continue}if(!((C[D][2]===null||C[D][2]===void 0)&&(C[D][3]===null||C[D][3]===void 0))){if(v.allowInsertRow)for(;C[D][0]>s.countRows()-1;){const{delta:X}=a.createRow(void 0,void 0,{source:"auto"});if(X===0){U=!0;break}}if(s.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(C[D][1])>s.countCols()-1;){const{delta:X}=a.createCol(void 0,void 0,{source:"auto"});if(X===0){U=!0;break}}U||a.set(C[D][0],C[D][1],C[D][3])}}if(C.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",C,S),u.closeEditor(),s.render(),u.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",C,S||"edit");const D=s.getActiveEditor();D&&Le(D.refreshValue)&&D.refreshValue()}else s.render()}this._createCellCoords=function(C,S){return s.view._wt.createCellCoords(C,S)},this._createCellRange=function(C,S,_){return s.view._wt.createCellRange(C,S,_)},this.validateCell=function(C,S,_,D){let U=s.getCellValidator(S);function X(ee){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||S.hidden===!0){_(ee);return}const M=S.visualCol,R=S.visualRow,W=s.getCell(R,M,!0);if(W&&W.nodeName!=="TH"){const q=s.rowIndexMapper.getRenderableFromVisualIndex(R),J=s.columnIndexMapper.getRenderableFromVisualIndex(M);s.view._wt.getSetting("cellRenderer",q,J,W)}_(ee)}gNe(U)&&(U=function(ee){return function(k,M){M(ee.test(k))}}(U)),er(U)?(C=s.runHooks("beforeValidate",C,S.visualRow,S.prop,D),s._registerImmediate(()=>{U.call(S,C,ee=>{s&&(ee=s.runHooks("afterValidate",ee,C,S.visualRow,S.prop,D),S.valid=ee,X(ee),s.runHooks("postAfterValidate",ee,C,S.visualRow,S.prop,D))})})):s._registerImmediate(()=>{S.valid=!0,X(S.valid,!1)})};function ge(C,S,_){return Array.isArray(C)?C:[[C,S,_]]}function Q(C,S){const _=s.runHooks("beforeChange",C,S||"edit"),D=C.filter(X=>X!==null);if(_===!1||D.length===0){var U;return(U=s.getActiveEditor())===null||U===void 0||U.cancelChanges(),[]}for(let X=D.length-1;X>=0;X--){const[ee,k,,M]=D[X],R=a.propToCol(k);let W;Number.isInteger(R)?W=s.getCellMeta(ee,R):W={...Object.getPrototypeOf(v),...v};const{type:q,checkedTemplate:J,uncheckedTemplate:re}=W;if(q==="numeric"&&typeof M=="string"&&wHe(M)&&(D[X][3]=he(M)),q==="checkbox"){const V=Fr(M),te=V===Fr(J),oe=V===Fr(re);(te||oe)&&(D[X][3]=te?J:re)}}return D}this.setDataAtCell=function(C,S,_,D){const U=ge(C,S,_),X=[];let ee=D,k,M,R;for(k=0,M=U.length;k<M;k++){if(typeof U[k]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof U[k][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");U[k][1]>=this.countCols()?R=U[k][1]:R=a.colToProp(U[k][1]),X.push([U[k][0],R,l.getAtCell(this.toPhysicalRow(U[k][0]),U[k][1]),U[k][2]])}!ee&&typeof C=="object"&&(ee=S);const W=Q(X,ee);s.runHooks("afterSetDataAtCell",W,ee),Ee(W,ee,()=>{Ce(W,ee)})},this.setDataAtRowProp=function(C,S,_,D){const U=ge(C,S,_),X=[];let ee=D,k,M;for(k=0,M=U.length;k<M;k++)X.push([U[k][0],U[k][1],l.getAtCell(this.toPhysicalRow(U[k][0]),U[k][1]),U[k][2]]);!ee&&typeof C=="object"&&(ee=S);const R=Q(X,D);s.runHooks("afterSetDataAtRowProp",R,ee),Ee(R,ee,()=>{Ce(R,ee)})},this.listen=function(){s&&!s.isListening()&&(VP.forEach(C=>{s!==C&&C.unlisten()}),BP=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(BP=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return BP===s.guid},this.destroyEditor=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.closeEditor(C),s.view.render(),S&&O.isSelected()&&u.prepareEditor()},this.populateFromArray=function(C,S,_,D,U,X,ee){if(!(typeof _=="object"&&typeof _[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const k=typeof D=="number"?s._createCellCoords(D,U):null;return c.populateFromArray(s._createCellCoords(C,S),_,k,X,ee)},this.spliceCol=function(C,S,_){for(var D=arguments.length,U=new Array(D>3?D-3:0),X=3;X<D;X++)U[X-3]=arguments[X];return a.spliceCol(C,S,_,...U)},this.spliceRow=function(C,S,_){for(var D=arguments.length,U=new Array(D>3?D-3:0),X=3;X<D;X++)U[X-3]=arguments[X];return a.spliceRow(C,S,_,...U)},this.getSelected=function(){if(O.isSelected())return At(O.getSelectedRange(),C=>{let{from:S,to:_}=C;return[S.row,S.col,_.row,_.col]})},this.getSelectedLast=function(){const C=this.getSelected();let S;return C&&C.length>0&&(S=C[C.length-1]),S},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){const C=this.getSelectedRange();let S;return C&&C.length>0&&(S=C[C.length-1]),S},this.emptySelectedCells=function(C){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;const S=[];Z(O.getSelectedRange(),_=>{if(_.isSingleHeader())return;const D=_.getTopStartCorner(),U=_.getBottomEndCorner();je(D.row,U.row,X=>{je(D.col,U.col,ee=>{this.getCellMeta(X,ee).readOnly||S.push([X,ee,null])})})}),S.length>0&&this.setDataAtCell(S,C)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const C=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(C,0),!this.isRenderSuspended()&&C===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(C){this.suspendRender();const S=C();return this.resumeRender(),S},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(S,0),(!this.isExecutionSuspended()&&S===this.executionSuspendedCounter||C)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const _=C();return this.resumeExecution(S),_},this.batch=function(C){this.suspendRender(),this.suspendExecution();const S=C();return this.resumeExecution(),this.resumeRender(),S},this.refreshDimensions=function(){if(!s.view)return;const C=s.view,{width:S,height:_}=C.getLastSize(),{width:D,height:U}=s.rootElement.getBoundingClientRect(),X=D!==S||U!==_;s.runHooks("beforeRefreshDimensions",{width:S,height:_},{width:D,height:U},X)!==!1&&((X||C._wt.wtOverlays.scrollableElement===s.rootWindow)&&(C.setLastSize(D,U),s.render(),C.adjustElementsSize()),s.runHooks("afterRefreshDimensions",{width:S,height:_},{width:D,height:U},X))},this.updateData=function(C,S){X8(C,_=>{a=_},_=>{a=_,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),O.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:S,metaManager:w,firstRun:d})},this.loadData=function(C,S){X8(C,_=>{a=_},()=>{w.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),O.refresh(),d&&(d=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:S,metaManager:w,firstRun:d})},this.getInitialColumnCount=function(){const C=v.columns;let S=0;if(Array.isArray(C))S=C.length;else if(er(C))if(s.dataType==="array"){const _=this.countSourceCols();for(let D=0;D<_;D+=1)C(D)&&(S+=1)}else(s.dataType==="object"||s.dataType==="function")&&(S=a.colToPropCache.length);else if(Le(v.dataSchema)){const _=a.getSchema();S=Array.isArray(_)?_.length:AF(_)}else S=this.countSourceCols();return S},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(C,S,_,D){return Dr(C)?a.getAll():a.getRange(s._createCellCoords(C,S),s._createCellCoords(_,D),a.DESTINATION_RENDERER)},this.getCopyableText=function(C,S,_,D){return a.getCopyableText(s._createCellCoords(C,S),s._createCellCoords(_,D))},this.getCopyableData=function(C,S){return a.getCopyable(C,a.colToProp(S))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const _=(d?s.loadData:s.updateData).bind(this);let D=!1,U,X;if(Le(C.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Le(C.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Le(C.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');C.language&&B(C.language);for(U in C)if(!(U==="data"||U==="language"))if(U==="className")ie("className",C.className);else if(U==="tableClassName"&&s.table)ie("tableClassName",C.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(Fe.getSingleton().isRegistered(U)||Fe.getSingleton().isDeprecated(U)){const W=C[U];er(W)?(Fe.getSingleton().addAsFixed(U,W,s),v[U]=W):Array.isArray(W)&&(Fe.getSingleton().add(U,W,s),v[U]=W)}else!S&&Pn(C,U)&&(y[U]=C[U]);C.data===void 0&&v.data===void 0?_(null,"updateSettings"):C.data!==void 0?_(C.data,"updateSettings"):C.columns!==void 0&&(a.createMap(),s.initIndexMappers());const ee=s.countCols(),k=v.columns;if(k&&er(k)&&(D=!0),(C.cell!==void 0||C.cells!==void 0||C.columns!==void 0)&&w.clearCache(),ee>0)for(U=0,X=0;U<ee;U++){if(k){const W=D?k(U):k[X];W&&w.updateColumnMeta(X,W)}X+=1}Le(C.cell)&&St(C.cell,W=>{s.setCellMetaObject(W.row,W.col,W)}),s.runHooks("afterCellMetaReset");let M=s.rootElement.style.height;M!==""&&(M=parseInt(s.rootElement.style.height,10));let R=C.height;if(er(R)&&(R=R()),S&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),R===null){const W=s.rootElement.getAttribute("data-initialstyle");W&&(W.indexOf("height")>-1||W.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",W):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else R!==void 0&&(s.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,s.rootElement.style.overflow="hidden");if(typeof C.width<"u"){let W=C.width;er(W)&&(W=W()),s.rootElement.style.width=isNaN(W)?`${W}`:`${W}px`}if(!S){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const W=s.getCurrentThemeName();Pn(C,"themeName")&&W!==C.themeName&&s.useTheme(C.themeName)}s.runHooks("afterUpdateSettings",C)}c.adjustRowsAndCols(),s.view&&!d&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!S&&s.view&&(M===""||R===""||R===void 0)&&M!==R&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const C=s.getSelectedLast();if(v.getValue){if(er(v.getValue))return v.getValue.call(s);if(C)return s.getData()[C[0][0]][v.getValue]}else if(C)return s.getDataAtCell(C[0],C[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(C,S,_,D,U){c.alter(C,S,_,D,U)},this.getCell=function(C,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=S,U=C;if(S>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(S)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(S)}if(C>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(C)))return null;U=this.rowIndexMapper.getRenderableFromVisualIndex(C)}return U===null||D===null||U===void 0||D===void 0?null:s.view.getCellAtCoords(s._createCellCoords(U,D),_)},this.getCoords=function(C){const S=this.view._wt.wtTable.getCoords(C);if(S===null)return null;const{row:_,col:D}=S;let U=_,X=D;return _>=0&&(U=this.rowIndexMapper.getVisualFromRenderableIndex(_)),D>=0&&(X=this.columnIndexMapper.getVisualFromRenderableIndex(D)),s._createCellCoords(U,X)},this.colToProp=function(C){return a.colToProp(C)},this.propToCol=function(C){return a.propToCol(C)},this.toVisualRow=C=>this.rowIndexMapper.getVisualFromPhysicalIndex(C),this.toVisualColumn=C=>this.columnIndexMapper.getVisualFromPhysicalIndex(C),this.toPhysicalRow=C=>this.rowIndexMapper.getPhysicalFromVisualIndex(C),this.toPhysicalColumn=C=>this.columnIndexMapper.getPhysicalFromVisualIndex(C),this.getDataAtCell=function(C,S){return a.get(C,a.colToProp(S))},this.getDataAtRowProp=function(C,S){return a.get(C,S)},this.getDataAtCol=function(C){const S=[],_=a.getRange(s._createCellCoords(0,C),s._createCellCoords(v.data.length-1,C),a.DESTINATION_RENDERER);for(let D=0;D<_.length;D+=1)for(let U=0;U<_[D].length;U+=1)S.push(_[D][U]);return S},this.getDataAtProp=function(C){const S=[],_=a.getRange(s._createCellCoords(0,a.propToCol(C)),s._createCellCoords(v.data.length-1,a.propToCol(C)),a.DESTINATION_RENDERER);for(let D=0;D<_.length;D+=1)for(let U=0;U<_[D].length;U+=1)S.push(_[D][U]);return S},this.getSourceData=function(C,S,_,D){let U;return C===void 0?U=l.getData():U=l.getByRange(s._createCellCoords(C,S),s._createCellCoords(_,D)),U},this.getSourceDataArray=function(C,S,_,D){let U;return C===void 0?U=l.getData(!0):U=l.getByRange(s._createCellCoords(C,S),s._createCellCoords(_,D),!0),U},this.getSourceDataAtCol=function(C){return l.getAtColumn(C)},this.setSourceDataAtCell=function(C,S,_,D){const U=ge(C,S,_),X=this.hasHook("afterSetSourceDataAtCell"),ee=[];X&&Z(U,M=>{let[R,W,q]=M;ee.push([R,W,l.getAtCell(R,W),q])}),Z(U,M=>{let[R,W,q]=M;l.setAtCell(R,W,q)}),X&&this.runHooks("afterSetSourceDataAtCell",ee,D),this.render();const k=s.getActiveEditor();k&&Le(k.refreshValue)&&k.refreshValue()},this.getSourceDataAtRow=function(C){return l.getAtRow(C)},this.getSourceDataAtCell=function(C,S){return l.getAtCell(C,S)},this.getDataAtRow=function(C){return a.getRange(s._createCellCoords(C,0),s._createCellCoords(C,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(C,S,_,D){const U=C===void 0?[0,0,this.countRows(),this.countCols()]:[C,S,_,D],[X,ee]=U;let[,,k,M]=U,R=null,W=null;k===void 0&&(k=X),M===void 0&&(M=ee);let q="mixed";return je(Math.max(Math.min(X,k),0),Math.max(X,k),J=>{let re=!0;return je(Math.max(Math.min(ee,M),0),Math.max(ee,M),V=>(W=this.getCellMeta(J,V).type,R?re=R===W:R=W,re)),q=re?W:"mixed",re}),q},this.removeCellMeta=function(C,S,_){const[D,U]=[this.toPhysicalRow(C),this.toPhysicalColumn(S)];let X=w.getCellMetaKeyValue(D,U,_);s.runHooks("beforeRemoveCellMeta",C,S,_,X)!==!1&&(w.removeCellMeta(D,U,_),s.runHooks("afterRemoveCellMeta",C,S,_,X)),X=null},this.spliceCellsMeta=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var _=arguments.length,D=new Array(_>2?_-2:0),U=2;U<_;U++)D[U-2]=arguments[U];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");S>0&&w.removeRow(this.toPhysicalRow(C),S),D.length>0&&Z(D.reverse(),X=>{w.createRow(this.toPhysicalRow(C)),Z(X,(ee,k)=>this.setCellMetaObject(C,k,ee))}),s.render()},this.setCellMetaObject=function(C,S,_){typeof _=="object"&&St(_,(D,U)=>{this.setCellMeta(C,S,U,D)})},this.setCellMeta=function(C,S,_,D){if(s.runHooks("beforeSetCellMeta",C,S,_,D)===!1)return;let X=C,ee=S;C<this.countRows()&&(X=this.toPhysicalRow(C)),S<this.countCols()&&(ee=this.toPhysicalColumn(S)),w.setCellMeta(X,ee,_,D),s.runHooks("afterSetCellMeta",C,S,_,D)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(C,S){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},D=this.toPhysicalRow(C),U=this.toPhysicalColumn(S);return D===null&&(D=C),U===null&&(U=S),w.getCellMeta(D,U,{visualRow:C,visualColumn:S,..._})},this.getColumnMeta=function(C){return w.getColumnMeta(this.toPhysicalColumn(C))},this.getCellMetaAtRow=function(C){return w.getCellsMetaAtRow(C)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||v.columns)},this.getCellRenderer=function(C,S){const _=typeof C=="number"?s.getCellMeta(C,S).renderer:C.renderer;return typeof _=="string"?LM(_):Dr(_)?LM("text"):_},this.getCellEditor=function(C,S){const _=typeof C=="number"?s.getCellMeta(C,S).editor:C.editor;return typeof _=="string"?NM(_):Dr(_)?NM("text"):_},this.getCellValidator=function(C,S){const _=typeof C=="number"?s.getCellMeta(C,S).validator:C.validator;return typeof _=="string"?DHe(_):_},this.validateCells=function(C){this._validateCells(C)},this.validateRows=function(C,S){if(!Array.isArray(C))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(S,C)},this.validateColumns=function(C,S){if(!Array.isArray(C))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(S,void 0,C)},this._validateCells=function(C,S,_){const D=new ue;C&&(D.onQueueEmpty=C);let U=s.countRows()-1;for(;U>=0;){if(S!==void 0&&S.indexOf(U)===-1){U-=1;continue}let X=s.countCols()-1;for(;X>=0;){if(_!==void 0&&_.indexOf(X)===-1){X-=1;continue}D.addValidatorToQueue(),s.validateCell(s.getDataAtCell(U,X),s.getCellMeta(U,X),ee=>{if(typeof ee!="boolean")throw new Error("Validation error: result is not boolean");ee===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),X-=1}U-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(C){let S=v.rowHeaders,_=C;return _!==void 0&&(_=s.runHooks("modifyRowHeader",_)),_===void 0?(S=[],je(s.countRows()-1,D=>{S.push(s.getRowHeader(D))})):Array.isArray(S)&&S[_]!==void 0?S=S[_]:er(S)?S=S(_):S&&typeof S!="string"&&typeof S!="number"&&(S=_+1),S},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let C=0,S=s.countCols();C<S;C++)if(s.getColHeader(C))return!0;return!1},this.getColHeader=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const _=s.runHooks("modifyColHeader",C);if(_===void 0){const k=[],M=s.countCols();for(let R=0;R<M;R++)k.push(s.getColHeader(R));return k}let D=v.colHeaders;const U=function(k){const M=[],R=s.countCols();let W=0;for(;W<R;W++)er(v.columns)&&v.columns(W)&&M.push(W);return M[k]},X=s.toPhysicalColumn(_),ee=U(X);return v.colHeaders===!1?D=null:v.columns&&er(v.columns)&&v.columns(ee)&&v.columns(ee).title?D=v.columns(ee).title:v.columns&&v.columns[X]&&v.columns[X].title?D=v.columns[X].title:Array.isArray(v.colHeaders)&&v.colHeaders[X]!==void 0?D=v.colHeaders[X]:er(v.colHeaders)?D=v.colHeaders(X):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(D=l3e(_)),D=s.runHooks("modifyColumnHeaderValue",D,C,S),D},this._getColWidthFromSettings=function(C){let S;if(C>=0&&(S=s.getCellMeta(0,C).width),(S===void 0||S===v.width)&&(S=v.colWidths),S!=null){switch(typeof S){case"object":S=S[C];break;case"function":S=S(C);break}typeof S=="string"&&(S=parseInt(S,10))}return S},this.getColWidth=function(C,S){let _=s._getColWidthFromSettings(C);return _=s.runHooks("modifyColWidth",_,C,S),_===void 0&&(_=Sp),_},this._getRowHeightFromSettings=function(C){const S=s.stylesHandler.getDefaultRowHeight();let _=v.rowHeights;if(_!=null){switch(typeof _){case"object":_=_[C];break;case"function":_=_(C);break}typeof _=="string"&&(_=parseInt(_,10))}return _!=null&&_<S?S:_},this.getRowHeight=function(C,S){let _=s._getRowHeightFromSettings(C);return _=s.runHooks("modifyRowHeight",_,C,S),_},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const C=v.maxCols,S=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(C,S)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return i8(s.countRows()-1,_=>{if(s.isEmptyRow(_))S+=1;else if(C===!0)return!1}),S},this.countEmptyCols=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,S=0;return i8(s.countCols()-1,_=>{if(s.isEmptyCol(_))S+=1;else if(C===!0)return!1}),S},this.isEmptyRow=function(C){return v.isEmptyRow.call(s,C)},this.isEmptyCol=function(C){return v.isEmptyCol.call(s,C)},this.selectCell=function(C,S,_,D){let U=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,X=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Dr(C)||Dr(S)?!1:this.selectCells([[C,S,_,D]],U,X)},this.selectCells=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;S===!1&&f.suspend();const D=O.selectCells(C);return D&&_&&s.listen(),f.resume(),D},this.selectColumns=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,_=arguments.length>2?arguments[2]:void 0;return O.selectColumns(C,S,_)},this.selectRows=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,_=arguments.length>2?arguments[2]:void 0;return O.selectRows(C,S,_)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C,_=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),O.selectAll(C,S,_)};const ye=(C,S)=>C.getNearestNotHiddenIndex(S,1,!0);this.scrollViewportTo=function(C,S){if(typeof C=="number"){var _;C={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(_=arguments[4])!==null&&_!==void 0?_:!0}}const{row:D,col:U,considerHiddenIndexes:X}=C??{};let ee=D,k=U;if(er(S)&&this.addHookOnce("afterScroll",S),X===void 0||X){const q=Number.isInteger(D)&&D>=0,J=Number.isInteger(U)&&U>=0,re=q?ye(this.rowIndexMapper,D):void 0,V=J?ye(this.columnIndexMapper,U):void 0;if(re===null||V===null)return!1;ee=q?s.rowIndexMapper.getRenderableFromVisualIndex(re):D,k=J?s.columnIndexMapper.getRenderableFromVisualIndex(V):U}const M=Number.isInteger(ee),R=Number.isInteger(k);let W=!1;return M&&ee>=0&&R&&k>=0?W=s.view.scrollViewport(s._createCellCoords(ee,k),C.horizontalSnap,C.verticalSnap):M&&ee>=0&&(R&&k<0||!R)?W=s.view.scrollViewportVertically(ee,C.verticalSnap):R&&k>=0&&(M&&ee<0||!M)&&(W=s.view.scrollViewportHorizontally(k,C.horizontalSnap)),er(S)&&(W?this.view.render():(this.removeHook("afterScroll",S),this._registerMicrotask(()=>S()))),W},this.scrollToFocusedCell=function(C){if(!this.selection.isSelected())return!1;er(C)&&this.addHookOnce("afterScroll",C);const{highlight:S}=this.getSelectedRangeLast(),_=this.scrollViewportTo(S.toObject());return _?this.view.render():er(C)&&(this.removeHook("afterScroll",C),this._registerMicrotask(()=>C())),_},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),T.clear(),w.clearCache(),VP.delete(this.guid),o.destroy(),u&&u.destroy(),s.rootContainer&&Xc(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),b.getItems().forEach(C=>{let[,S]=C;S.destroy()}),b.clear(),s.runHooks("afterDestroy")},!0),Fe.getSingleton().destroy(s),St(s,(C,S,_)=>{er(C)?_[S]=Re(S):S!=="guid"&&(_[S]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,c=null,O=null,u=null,s=null};function Re(C){return()=>{throw new Error(`The "${C}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(C){return b.getItem($a(C))},this.getPluginName=function(C){return C===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:b.getId(C)},this.getInstance=function(){return s},this.addHook=function(C,S,_){Fe.getSingleton().add(C,S,s,_)},this.hasHook=function(C){return Fe.getSingleton().has(C,s)||Fe.getSingleton().has(C)},this.addHookOnce=function(C,S,_){Fe.getSingleton().once(C,S,s,_)},this.removeHook=function(C,S){Fe.getSingleton().remove(C,S,s)},this.runHooks=function(C,S,_,D,U,X,ee){return Fe.getSingleton().run(s,C,S,_,D,U,X,ee)},this.getTranslatedPhrase=function(C,S){return NJ(v.language,C,S)},this.toHTML=()=>r8(this),this.toTableElement=()=>{const C=this.rootDocument.createElement("div");return C.insertAdjacentHTML("afterbegin",r8(this)),C.firstElementChild},this.timeouts=[],this.useTheme=C=>{const S=!!d;this.stylesHandler.useTheme(C);const _=this.stylesHandler.getThemeName();om(this)&&(Je(this.rootWrapperElement,/ht-theme-.*/g),Je(this.rootPortalElement,/ht-theme-.*/g),_&&(Se(this.rootWrapperElement,_),Se(this.rootPortalElement,_),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||zt(`The "${_}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),S||(s.render(),s.scrollViewportTo(0,0),tj(this.rootContainer)&&(Je(this.rootContainer,/ht-theme-.*/g),_&&Se(this.rootContainer,_))),this.runHooks("afterSetTheme",_,S)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(C){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=C;typeof _=="function"&&(_=setTimeout(_,S)),this.timeouts.push(_)},this._clearTimeouts=function(){Z(this.timeouts,C=>{clearTimeout(C)})},this.immediates=[],this._registerImmediate=function(C){this.immediates.push(setImmediate(C))},this._clearImmediates=function(){Z(this.immediates,C=>{clearImmediate(C)})},this._registerMicrotask=function(C){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||C()})},this._getEditorManager=function(){return u};const j=_We({handleEvent(){return s.isListening()},beforeKeyDown:C=>this.runHooks("beforeKeyDown",C),afterKeyDown:C=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",C)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",C=>{C.ctrlKey===!1&&C.metaKey===!1&&j.releasePressedKeys()}),this.getShortcutManager=function(){return j},this.getFocusManager=function(){return h},Zq().forEach(C=>{const S=BF(C);b.addItem(C,new S(this))}),aWe(s),j.setActiveContextName("grid"),Fe.getSingleton().run(s,"construct")}function lj(t,e,r){t.addEventListener(e,r,!1)}function cj(t,e,r){t.removeEventListener(e,r,!1)}function cS(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function QJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),s=t.createElement("span");let o;function a(){var h,f;i.textContent=r.textContent(o),s.style.position="absolute",s.style.fontSize=cS(o).fontSize,s.style.fontFamily=cS(o).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);const d=parseInt(((h=cS(o))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((f=cS(o))===null||f===void 0?void 0:f.paddingInlineEnd)||0,10),m=s.clientWidth+d+g+1;n.removeChild(s);const p=o.style;p.height=`${r.minHeight}px`,r.minWidth>m?p.width=`${r.minWidth}px`:m>r.maxWidth?p.width=`${r.maxWidth}px`:p.width=`${m}px`;const w=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>w?p.height=`${r.minHeight}px`:r.maxHeight<w?(p.height=`${r.maxHeight}px`,p.overflowY="visible"):p.height=`${w}px`}function l(){t.defaultView.setTimeout(a,0)}function c(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=o.clientHeight;else{const f=parseInt(h.minHeight,10);isNaN(f)||(r.minHeight=f)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{const f=parseInt(h.maxHeight,10);isNaN(f)||(r.maxHeight=f)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=o.clientWidth;else{const f=parseInt(h.minWidth,10);isNaN(f)||(r.minWidth=f)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{const f=parseInt(h.maxWidth,10);isNaN(f)||(r.maxWidth=f)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function u(h,f){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=h,c(f),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),d&&(lj(o,"input",a),lj(o,"keydown",l)),a()}return{init:u,resize:a,unObserve(){cj(o,"input",a),cj(o,"keydown",l)}}}function uj(t,e){const r=Oq(e),n=e.value.split(`
`);let i=r,s=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(s+=n[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),r<=l)break}AR(e,i)}function lf(t,e,r){return(e=MWe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MWe(t){var e=NWe(t,"string");return typeof e=="symbol"?e:e+""}function NWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DWe="ht_editor_visible",uS="ht_editor_hidden",hj="textEditor",FWe="text";class ag extends Jp{static get EDITOR_TYPE(){return FWe}constructor(e){super(e),lf(this,"eventManager",new Ba(this)),lf(this,"autoResize",QJ(this.hot.rootDocument)),lf(this,"TEXTAREA",void 0),lf(this,"textareaStyle",void 0),lf(this,"TEXTAREA_PARENT",void 0),lf(this,"textareaParentStyle",void 0),lf(this,"layerClass",void 0),this.eventManager=new Ba(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Gx(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,o){const a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==en.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===en.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),AR(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),et(this.TEXTAREA,[["data-hot-input",""],Vh(-1)]),Se(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Se(this.TEXTAREA_PARENT,"handsontableInputHolder"),tt(this.TEXTAREA_PARENT,this.layerClass)&&Je(this.TEXTAREA_PARENT,this.layerClass),Se(this.TEXTAREA_PARENT,uS),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){fDe()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Je(this.TEXTAREA_PARENT,this.layerClass),Se(this.TEXTAREA_PARENT,uS)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;je(e.length-1,n=>{const i=e[n];if(tt(i,"handsontableEditor"))return r=!0,!1}),tt(this.TEXTAREA_PARENT,uS)&&Je(this.TEXTAREA_PARENT,uS),r?(this.layerClass=DWe,Se(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Se(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==en.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){_q()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===en.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>Le(this.hot.getSelected()),group:hj},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;uj(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;uj(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(hj)}}const HWe="base",LWe="htTextEllipsis";function T1(t,e,r,n,i,s,o){const a=o.ariaTags,l=[],c=[],u=[],h=[];o.className&&Se(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(OW())):a&&u.push(OW()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(MW())):(c.push(o.invalidCellClassName),a&&u.push(MW()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),o.textEllipsis&&l.push(LWe),Je(e,c),Se(e,l),Kp(e,u),et(e,h)}T1.RENDERER_TYPE=HWe;const $We="text";function uu(t,e,r,n,i,s,o){T1.apply(this,[t,e,r,n,i,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=Fr(a),o.trimWhitespace&&(a=a.trim()),Nd(e,a)}uu.RENDERER_TYPE=$We;const BWe="text",ZJ={CELL_TYPE:BWe,editor:ag,renderer:uu};fa(ZJ);_t.editors={BaseEditor:Jp};function _t(t,e){const r=new JJ(t,e||{},rH);return r.init(),r}_t.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new JJ(t,e,rH)};_t.DefaultSettings=VJ();_t.hooks=Fe.getSingleton();_t.CellCoords=Fd;_t.CellRange=b1;_t.packageName="handsontable";_t.buildDate="10/07/2025 10:59:01";_t.version="16.0.1";_t.languages={dictionaryKeys:X3e,getLanguageDictionary:MJ,getLanguagesDictionaries:eBe,registerLanguageDictionary:OJ,getTranslatedPhrase:NJ};function KM(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function VWe(t){if(Array.isArray(t))return KM(t)}function WWe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ey(t,e,r){return e=P_(e),XWe(t,eQ()?Reflect.construct(e,r||[],P_(t).constructor):e.apply(t,r))}function _p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tQ(n.key),n)}}function Ep(t,e,r){return e&&fj(t.prototype,e),r&&fj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jWe(t,e,r){return(e=tQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P_(t){return P_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P_(t)}function Ry(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XM(t,e)}function eQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eQ=function(){return!!t})()}function UWe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function GWe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dj(Object(r),!0).forEach(function(n){jWe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YWe(t,e){if(t==null)return{};var r,n,i=KWe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function KWe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function XWe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WWe(t)}function XM(t,e){return XM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},XM(t,e)}function qWe(t){return VWe(t)||UWe(t)||QWe(t)||zWe()}function JWe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function tQ(t){var e=JWe(t,"string");return typeof e=="symbol"?e:e+""}function QWe(t,e){if(t){if(typeof t=="string")return KM(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?KM(t,e):void 0}}var WP=null,ZWe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",e8e="The Handsontable instance bound to this component was destroyed and cannot be used properly.",A_="global",t8e="hot-wrapper-editor-container";function r8e(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function qM(t,e){var r=Ge.Children.toArray(t),n=Ge.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(s){return s.props[e]!==void 0})),i||null}function rQ(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function nQ(t,e){if(typeof t>"u"||e===null)return null;var r=sQ(e.props,!1);return r.className="".concat(t8e," ").concat(r.className),qz.createPortal(Ge.createElement("div",Object.assign({},r),e),t.body)}function iQ(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:A_,n=qM(t,"hot-editor"),i=rQ(n);return n?Ge.cloneElement(n,{emitEditorInstance:function(o,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??A_,o)},editorColumnScope:r,isEditor:!0}):null}function n8e(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;r||(r=document),WP||(WP=r.createDocumentFragment());var s=i??r.createElement("DIV");WP.appendChild(s);var o=Ge.cloneElement(t,GWe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:qz.createPortal(o,s,n),portalContainer:s}}function sQ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function i8e(){return typeof window<"u"}var oQ=function(){function t(){_p(this,t)}return Ep(t,null,[{key:"getSettings",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.prevProps,s=i===void 0?{}:i,o=n.isInit,a=o===void 0?!1:o,l=n.initOnlySettingKeys,c=l===void 0?[]:l,u=function(p){return!a&&c.includes(p)?s[p]===r[p]:!1},h={};if(r.settings){var f=r.settings;for(var d in f)f.hasOwnProperty(d)&&!u(d)&&(h[d]=f[d])}for(var g in r)g!=="settings"&&g!=="children"&&!u(g)&&r.hasOwnProperty(g)&&(h[g]=r[g]);return h}}])}(),s8e=function(t){function e(){return _p(this,e),Ey(this,e,arguments)}return Ry(e,t),Ep(e,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!n.internalProps.includes(i)}).reduce(function(i,s){return i[s]=n.props[s],i},{})}},{key:"getLocalEditorElement",value:function(){return iQ(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=oQ.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),i=nQ(n,this.getLocalEditorElement());return Ge.createElement(Ge.Fragment,null,i)}}])}(Ge.Component),o8e=function(t){function e(){var r;return _p(this,e),r=Ey(this,e,arguments),r.state={portals:[]},r}return Ry(e,t),Ep(e,[{key:"render",value:function(){return Ge.createElement(Ge.Fragment,null,this.state.portals)}}])}(Ge.Component),a8e="16.0.1";function l8e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aQ={exports:{}},jP,gj;function c8e(){if(gj)return jP;gj=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return jP=t,jP}var UP,mj;function u8e(){if(mj)return UP;mj=1;var t=c8e();function e(){}function r(){}return r.resetWarningCache=e,UP=function(){function i(a,l,c,u,h,f){if(f!==t){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}i.isRequired=i;function s(){return i}var o={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},UP}aQ.exports=u8e()();var h8e=aQ.exports,zP=l8e(h8e),NL=function(t){function e(){var r;return _p(this,e),r=Ey(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return Ry(e,t),Ep(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(e8e),null)},set:function(n){this.__hotInstance=n}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return i8e()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var i=this;return function(o,a,l,c,u,h,f){var d=i.getRenderedCellCache(),g=i.getPortalContainerCache(),m="".concat(l,"-").concat(c),p=o.guid,w="".concat(p,"-").concat(m),v="".concat(m,"-").concat(p);if(d.has(m)&&(a.innerHTML=d.get(m).innerHTML),a&&!a.getAttribute("ghost-table")){for(var y=i.portalCache.get(v),b=g.get(w);a.firstChild;)a.removeChild(a.firstChild);if(y&&b)a.appendChild(b);else{var T=n8e(n,{TD:a,row:l,col:c,prop:u,value:h,cellProperties:f,isRenderer:!0},a.ownerDocument,v,b),E=T.portal,x=T.portalContainer;g.set(w,x),a.appendChild(x),i.portalCache.set(v,E)}}return d.set(m,a),a}}},{key:"getEditorClass",value:function(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A_,o=rQ(n),a=(i=this.getEditorCache().get(o))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(n){var i=function(s){function o(a){var l;return _p(this,o),l=Ey(this,o,[a]),n.hotCustomEditorInstance=l,l.editorComponent=n,l}return Ry(o,s),Ep(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(_t.editors.BaseEditor);return Object.getOwnPropertyNames(_t.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var o,a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return(o=n[s]).call.apply(o,[n].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return qM(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return iQ(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((n=this.hotInstance)===null||n===void 0||(n=n.getSettings())===null||n===void 0?void 0:n._initOnlySettings)||[],a=oQ.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:o}),l=this.getGlobalRendererElement(),c=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,c)a.editor=this.getEditorClass(c,A_);else{var u;this.props.editor||(u=this.props.settings)!==null&&u!==void 0&&u.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=NM("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var h;this.props.renderer||(h=this.props.settings)!==null&&h!==void 0&&h.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=LM("text")}return a}},{key:"displayAutoSizeWarning",value:function(n){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&r8e(ZWe)}},{key:"setHotColumnSettings",value:function(n,i){this.columnSettings[i]=n}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:qWe(this.portalCache.values())})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new _t.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(n){this.clearCache();var i=this.createNewGlobalSettings(!1,n);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,i=function(u){return u.type===s8e},s=Ge.Children.toArray(this.props.children),o=s.filter(function(c){return i(c)}).map(function(c,u){return Ge.cloneElement(c,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:u,_getChildElementByType:qM.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:c.props.children})}),a=sQ(this.props),l=nQ(this.getOwnerDocument(),this.getGlobalEditorElement());return Ge.createElement(Ge.Fragment,null,Ge.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),o),Ge.createElement(o8e,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return a8e}}])}(Ge.Component);NL.propTypes={style:zP.object,id:zP.string,className:zP.string};var f8e=["children"],lQ=Ge.forwardRef(function(t,e){var r,n=t.children,i=YWe(t,f8e),s=typeof Ge.useId=="function"?Ge.useId():void 0,o=(r=i.id)!==null&&r!==void 0?r:s;return Ge.createElement(NL,Object.assign({id:o},i,{ref:e}),n)});lQ.version=NL.version;Ge.Component;function pj(t,e,r){return(e=d8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d8e(t){var e=g8e(t,"string");return typeof e=="symbol"?e:e+""}function g8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vj="handsontableEditor",m8e="handsontable";class DL extends ag{constructor(){super(...arguments),pj(this,"isFlippedVertically",!1),pj(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return m8e}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),AR(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(c,u){const h=this.getSourceData(u.row,u.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&In(l,o.handsontable),this.htOptions=l}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+a,0)}const i=this.getDropdownHeight(),s=e.getWorkspaceHeight()-n-r.height,o=i>s&&n>s+r.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:n,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.start+r.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;n=Math.max(n+a,0)}const i=this.getDropdownWidth(),s=e.getWorkspaceWidth()-n+r.width,o=i>s&&n>s;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:n,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:r}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-r)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:vj,relativeToGroup:Uh,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),Ua(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&this.isFlippedVertically?a=o.countRows()-1:o.getSelectedLast()&&(this.isFlippedVertically?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(o.getSelectedLast()){if(this.isFlippedVertically)a=o.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const c=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(c,l+1)}}return i(a,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(vj)}}function p8e(t,e){cQ(t,e),e.add(t)}function wj(t,e,r){cQ(t,e),e.set(t,r)}function cQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hS(t,e,r){return(e=v8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v8e(t){var e=w8e(t,"string");return typeof e=="symbol"?e:e+""}function w8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GP(t,e){return t.get(JM(t,e))}function JM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const y8e="autocomplete";var YP=new WeakMap,yj=new WeakMap,KP=new WeakSet;class FL extends DL{constructor(){super(...arguments),p8e(this,KP),hS(this,"query",null),hS(this,"strippedChoices",[]),hS(this,"rawChoices",[]),wj(this,YP,this.hot.guid.slice(0,9)),wj(this,yj,OR(()=>{this.focus()},100)),hS(this,"sortByRelevance",function(e,r,n){const i=[],s=[],o=e.length;let a=r.length,l,c,u,h;if(o===0){for(u=0;u<a;u++)s.push(u);return s}for(u=0;u<a;u++){if(c=IW(Fr(r[u])),n)h=c.indexOf(e);else{const f=this.cellProperties.locale;h=c.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=c.length-h-o,i.push({baseIndex:u,index:h,charsLeft:l,value:c}))}for(i.sort((f,d)=>{if(d.index===-1)return-1;if(f.index===-1)return 1;if(f.index<d.index)return-1;if(d.index<f.index)return 1;if(f.index===d.index){if(f.charsLeft<d.charsLeft)return-1;if(f.charsLeft>d.charsLeft)return 1}return 0}),u=0,a=i.length;u<a;u++)s.push(i[u].baseIndex);return s})}static get EDITOR_TYPE(){return y8e}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return Le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Se(this.htContainer,"autocompleteEditor"),Se(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&et(this.TEXTAREA,[ONe(),TNe(),gq("listbox"),FNe()])}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.hot.getSettings().ariaTags&&et(this.TEXTAREA,[jo("false"),HNe(`${GP(YP,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=n==null?void 0:n.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",GP(yj,this)),this.htEditor.updateSettings({colWidths:e?[mn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,c,u,h,f,d)=>{uu(a,l,c,u,h,f,d);const{filteringCaseSensitive:g,allowHtml:m,locale:p}=this.cellProperties,w=this.query;let v=Fr(f),y,b;v&&!m&&(y=g===!0?v.indexOf(w):v.toLocaleLowerCase(p).indexOf(w.toLocaleLowerCase(p)),y!==-1&&(b=v.substr(y,w.length),v=v.replace(b,`<strong>${b}</strong>`))),r&&et(l,[kNe(),...n?[VNe(i)]:[],...n?[WNe(n.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${u}`]]),l.innerHTML=v},afterSelectionEnd:(a,l)=>{if(r){const c=h=>{et(h,[kF()]),et(this.TEXTAREA,...LNe(h.id))},u=this.htEditor.getCell(a,l,!0);u!==null?c(u):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);c(h)})}}}),r&&(et(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...kc()),et(this.htEditor.rootElement,[dq(),$Ne("polite"),BNe("text"),["id",`${GP(YP,this)}-listbox-${s}-${o}`]]),et(this.TEXTAREA,...jo("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&et(this.TEXTAREA,[jo("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=Oq(this.TEXTAREA),n=SDe(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(o)?o.length:0;if(s===!1)c&&(a=o[0]);else{const u=[];for(let h=0,f=l.length;h<f&&!(i&&c<=h);h++)c?u.push(l[o[h]]):u.push(l[h]);a=0,l=u}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(zx([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),AR(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:r,spaceAbove:n,spaceBelow:i}=e;return this.limitDropdownIfNeeded(r?n:i),e}limitDropdownIfNeeded(e){const r=this.getDropdownHeight();if(r>e){let n=0,i=0,s=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),n+=i;while(n<e);s=n-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-s}px`),this.setDropdownHeight(n-i)}}updateDropdownDimensions(){const e=Mq(),r=this.getTargetEditorWidth()+e,n=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:r,height:n}),JM(KP,this,Cj).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),JM(KP,this,Cj).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(i,s)=>s).reduce((i,s)=>{const o=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return i+o},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderInlineStartWidth,10)+parseInt(r.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=At(e,s=>Fr(s));return At(n,s=>r?s:IW(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),n={row:r?r.from.row:-1};let i=!1;return e===Ke.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(i=!0),e===Ke.ARROW_UP&&n.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(TDe(e.keyCode)||e.keyCode===Ke.BACKSPACE||e.keyCode===Ke.DELETE||e.keyCode===Ke.INSERT){let r=10;if(e.keyCode===Ke.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}function Cj(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+ei(this.hot.rootDocument)})}const C8e="checkbox";class uQ extends Jp{static get EDITOR_TYPE(){return C8e}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');tt(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ih=()=>window,Mo=()=>window.document,QM=(t,e)=>window.setTimeout(t,e),ml=function(t,e,r,n){t.addEventListener(e,r,!!n)},rc=function(t,e,r,n){t.removeEventListener(e,r,!!n)},S8e=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},$s=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},XP=function(t,e){$s(t,e)||(t.className=t.className===""?e:t.className+" "+e)},qP=function(t,e){t.className=S8e((" "+t.className+" ").replace(" "+e+" "," "))},HL=function(t){return/Array/.test(Object.prototype.toString.call(t))},Us=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},x8e=function(t){let e=t.getDay();return e===0||e===6},b8e=function(t){return t%4===0&&t%100!==0||t%400===0},Sj=function(t,e){return[31,b8e(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},fS=function(t){Us(t)&&t.setHours(0,0,0,0)},dS=function(t,e){return t.getTime()===e.getTime()},I_=function(t,e,r){let n,i;for(n in e)i=t[n]!==void 0,i&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?Us(e[n])?r&&(t[n]=new Date(e[n].getTime())):HL(e[n])?r&&(t[n]=e[n].slice(0)):t[n]=I_({},e[n],r):(r||!i)&&(t[n]=e[n]);return t},xj=function(t,e,r){let n=Mo().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=I_(n,r),t.dispatchEvent(n)},bj=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},rl={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},_j=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},_8e=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},E8e=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),n=t.getDay(),i=e,s=i-1,o=7,a=function(f){return(f+o-1)%o};t.setDate(r+s-a(n));let l=new Date(t.getFullYear(),0,i),c=24*60*60*1e3,u=(t.getTime()-l.getTime())/c;return 1+Math.round((u-s+a(l.getDay()))/o)},R8e=function(t,e,r,n,i){let s=new Date(n,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():E8e(s,i))+"</td>"},T8e=function(t,e,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},k8e=function(t){return"<tbody>"+t.join("")+"</tbody>"},P8e=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+_j(t,e)+'">'+_j(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},A8e=function(t,e,r,n,i,s){let o,a,l,c=t._o,u=r===c.minYear,h=r===c.maxYear,f='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',d,g,m=!0,p=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(r===i?o-e:12+o-e)+'"'+(o===n?' selected="selected"':"")+(u&&o<c.minMonth||h&&o>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[o]+"</option>");for(d='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",HL(c.yearRange)?(o=c.yearRange[0],a=c.yearRange[1]+1):(o=r-c.yearRange,a=1+r+c.yearRange),l=[];o<a&&o<=c.maxYear;o++)o>=c.minYear&&l.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+r+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",c.showMonthAfterYear?f+=g+d:f+=d+g,u&&(n===0||c.minMonth>=n)&&(m=!1),h&&(n===11||c.maxMonth<=n)&&(p=!1),e===0&&(f+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(f+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),f+="</div>"},I8e=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+P8e(t)+k8e(e)+"</table>"};function ZM(t){let e=this,r=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||ih().event;let s=i.target||i.srcElement;if(s)if($s(s,"is-disabled")||($s(s,"pika-button")&&!$s(s,"is-empty")&&!$s(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&QM(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):$s(s,"pika-prev")?e.prevMonth():$s(s,"pika-next")&&e.nextMonth()),$s(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||ih().event;let s=i.target||i.srcElement;s&&($s(s,"pika-select-month")?e.gotoMonth(s.value):$s(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||ih().event,e.isVisible())switch(i.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let i=this.moment(r.field.value,r.format,r.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),Us(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Mo().activeElement;do if($s(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=QM(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||ih().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&$s(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),ml(s,"change",e._onChange)));do if($s(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&s!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=Mo().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),ml(e.el,"mousedown",e._onMouseDown,!0),ml(e.el,"touchend",e._onMouseDown,!0),ml(e.el,"change",e._onChange),r.keyboardInput&&ml(Mo(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Mo().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),ml(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;Us(n)?r.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",ml(r.trigger,"click",e._onInputClick),ml(r.trigger,"focus",e._onInputFocus),ml(r.trigger,"blur",e._onInputBlur)):this.show()}ZM.prototype={config:function(t){this._o||(this._o=I_({},rl,!0));let e=I_(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,Us(e.minDate)||(e.minDate=!1),Us(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),HL(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||rl.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Us(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Us(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",xj(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Us(t))return;let r=this._o.minDate,n=this._o.maxDate;Us(r)&&t<r?t=r:Us(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),fS(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),xj(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Us(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<r.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(r.valueOf()+n):t==="subtract"&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=bj(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=bj({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(fS(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=rl.minDate,this._o.minYear=rl.minYear,this._o.minMonth=rl.minMonth,this._o.startRange=rl.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(fS(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=rl.maxDate,this._o.maxYear=rl.maxYear,this._o.maxMonth=rl.maxMonth,this._o.endRange=rl.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,n=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=r&&(this._y=r,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+A8e(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&QM(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,n,i,s,o,a,l,c,u;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,n=ih().innerWidth||Mo().documentElement.clientWidth,i=ih().innerHeight||Mo().documentElement.clientHeight,s=Mo().body.scrollTop||Mo().documentElement.scrollTop,c=!0,u=!0,l=t.getBoundingClientRect(),o=l.left+ih().pageXOffset,a=l.bottom+ih().pageYOffset,(this._o.reposition&&o+e>n||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,c=!1),(this._o.reposition&&a+r>i+s||this._o.position.indexOf("top")>-1&&a-r-t.offsetHeight>0)&&(a=a-r-t.offsetHeight,u=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",XP(this.el,c?"left-aligned":"right-aligned"),XP(this.el,u?"bottom-aligned":"top-aligned"),qP(this.el,c?"right-aligned":"left-aligned"),qP(this.el,u?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let n=this._o,i=new Date,s=Sj(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];fS(i),n.firstDay>0&&(o-=n.firstDay,o<0&&(o+=7));let c=e===0?11:e-1,u=e===11?0:e+1,h=e===0?t-1:t,f=e===11?t+1:t,d=Sj(h,c),g=s+o,m=g;for(;m>7;)m-=7;g+=7-m;let p=!1;for(let w=0,v=0;w<g;w++){let y=new Date(t,e,1+(w-o)),b=Us(this._d)?dS(y,this._d):!1,T=dS(y,i),E=n.events.indexOf(y.toDateString())!==-1,x=w<o||w>=s+o,P=1+(w-o),A=e,O=t,Y=n.startRange&&dS(n.startRange,y),B=n.endRange&&dS(n.endRange,y),ie=n.startRange&&n.endRange&&n.startRange<y&&y<n.endRange,ue=n.minDate&&y<n.minDate||n.maxDate&&y>n.maxDate||n.disableWeekends&&x8e(y)||n.disableDayFn&&n.disableDayFn(y);x&&(w<o?(P=d+P,A=c,O=h):(P=P-s,A=u,O=f));let he={day:P,month:A,year:O,hasEvent:E,isSelected:b,isToday:T,isDisabled:ue,isEmpty:x,isStartRange:Y,isEndRange:B,isInRange:ie,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&b&&(p=!0),l.push(_8e(he)),++v===7&&(n.showWeekNumber&&l.unshift(R8e(this,w-o,e,t,n.firstWeekOfYearMinDays)),a.push(T8e(l,n.isRTL,n.pickWholeWeek,p)),l=[],v=0,p=!1)}return I8e(n,a,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),qP(this.el,"is-hidden"),this._o.bound&&(ml(Mo(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&rc(Mo(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),XP(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),rc(this.el,"mousedown",this._onMouseDown,!0),rc(this.el,"touchend",this._onMouseDown,!0),rc(this.el,"change",this._onChange),t.keyboardInput&&rc(Mo(),"keydown",this._onKeyChange),t.field&&(rc(t.field,"change",this._onInputChange),t.bound&&(rc(t.trigger,"click",this._onInputClick),rc(t.trigger,"focus",this._onInputFocus),rc(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function O8e(t,e){M8e(t,e),e.add(t)}function M8e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ej(t,e,r){return(e=N8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N8e(t){var e=D8e(t,"string");return typeof e=="symbol"?e:e+""}function D8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const hQ="date",Rj="dateEditor",F8e="DD/MM/YYYY";var gS=new WeakSet;class fQ extends ag{constructor(){super(...arguments),O8e(this,gS),Ej(this,"parentDestroyed",!1),Ej(this,"$datePicker",null)}static get EDITOR_TYPE(){return hQ}init(){if(typeof _e!="function")throw new Error("You need to include moment.js to your project.");if(typeof ZM!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Se(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{tt(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:Rj})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Rj),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=JP(gS,this,QP).call(this),n=this.hot.view.isMouseDown(),i=e?Vq(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new ZM(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(_e),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,_e(s,r,!0).isValid()&&this.$datePicker.setMoment(_e(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!n&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,_e(s,r,!0).isValid()&&this.$datePicker.setMoment(_e(s,r),!0),!i&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const r=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&PR(n,this.cellProperties.datePickerConfig);const i=n.onSelect,s=n.onClose;return n.field=r,n.trigger=r,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=(e=n.format)!==null&&e!==void 0?e:JP(gS,this,QP).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=_e(a).format(JP(gS,this,QP).call(this))),this.setValue(a),i&&i(),Il()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},n}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==en.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,a=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),c=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),u=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=c&&this.col<=u){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+An(this.TD)}px`;let f=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?f+=h.right-mn(this.datePicker):f+=h.left,this.datePickerStyle.left=`${f}px`}else this.hideDatepicker()}}function QP(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:F8e}const H8e="dropdown";class dQ extends FL{static get EDITOR_TYPE(){return H8e}prepare(e,r,n,i,s,o){o.filter=!1,o.strict=!0,super.prepare(e,r,n,i,s,o)}}const L8e="numeric";class gQ extends ag{static get EDITOR_TYPE(){return L8e}}function $8e(t,e,r){return(e=B8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B8e(t){var e=V8e(t,"string");return typeof e=="symbol"?e:e+""}function V8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const W8e="password";class mQ extends ag{constructor(){super(...arguments),$8e(this,"autoResize",QJ(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return W8e}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Xc(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Vh(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ZP="ht_editor_visible",Tj="selectEditor",j8e="select";class pQ extends Jp{static get EDITOR_TYPE(){return j8e}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...sg()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),Se(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",tt(this.selectWrapper,ZP)&&Je(this.selectWrapper,ZP),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Xc(this.select),St(l,(c,u)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=u,Xp(h,c),this.select.appendChild(h)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==en.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",Se(this.selectWrapper,ZP)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:Tj};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Tj)}}const U8e="time";class vQ extends ag{static get EDITOR_TYPE(){return U8e}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.TEXTAREA.dir="ltr"}}function z8e(){Bs(Jp),Bs(FL),Bs(uQ),Bs(fQ),Bs(dQ),Bs(DL),Bs(gQ),Bs(mQ),Bs(pQ),Bs(ag),Bs(vQ)}const G8e="html";function LL(t,e,r,n,i,s,o){T1.apply(this,[t,e,r,n,i,s,o]),Xp(e,s??"",!1)}LL.RENDERER_TYPE=G8e;const Y8e="autocomplete";function Zp(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=o.allowHtml?LL:uu,c=a.createElement("DIV"),u=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...sg()),c.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,r,n,i,s,o]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(c,e.firstChild),Se(e,"htAutocomplete"),!t.acArrowListener){const h=new Ba(t);t.acArrowListener=function(f){tt(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Zp.RENDERER_TYPE=Y8e;const K8e="dropdown";function $L(t,e,r,n,i,s,o){Zp.apply(this,[t,e,r,n,i,s,o])}$L.RENDERER_TYPE=K8e;const kj=new WeakMap,Pj=new WeakMap,X8e="htBadValue",Rp="data-row",Tp="data-col",q8e="checkboxRenderer",wQ="checkbox";Fe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:o,prop:a}=e;if(i===wQ){if(n){const{value:l,property:c}=n;let u=r;if(l)u=typeof l=="function"?l(s,o,a,r):l;else if(c){const h=this.getDataAtRowProp(s,c);u=h!==null?h:r}t=u}return t}});function BL(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;T1.apply(this,[t,e,r,n,i,s,o]),J8e(t);let c=Q8e(a);const u=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Xc(e),s===o.checkedTemplate||Fr(s).toLocaleLowerCase(o.locale)===Fr(o.checkedTemplate).toLocaleLowerCase(o.locale)?c.checked=!0:s===o.uncheckedTemplate||Fr(s).toLocaleLowerCase(o.locale)===Fr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?c.checked=!1:an(s)?Se(c,"noValue"):(c.style.display="none",Se(c,X8e),h=!0),et(c,[[Rp,r],[Tp,n]]),l&&et(c,[wp(c.checked?t.getTranslatedPhrase(kL):t.getTranslatedPhrase(PL)),vq(c.checked),PNe()]),!h&&u){let m="";if(u.value)m=typeof u.value=="function"?u.value.call(this,r,n,i,s):u.value;else if(u.property){const w=t.getDataAtRowProp(r,u.property);m=w!==null?w:""}const p=Z8e(a,m,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(p),e.appendChild(c)):(p.appendChild(c),c=p):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(c),e.appendChild(p)):(p.insertBefore(c,p.firstChild),c=p))}(!u||u&&!u.separated)&&e.appendChild(c),h&&e.appendChild(a.createTextNode("#bad-value#")),kj.has(t)||(kj.set(t,!0),f());function f(){const p=t.getShortcutManager().getContext("grid"),w={group:q8e,relativeToGroup:Uh,position:"before"};p.addShortcuts([{keys:[["space"]],callback:()=>(d(),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!g()),runOnlyIf:()=>{const v=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(v==null?void 0:v.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!g()),runOnlyIf:()=>{var v;return(v=t.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight.isCell()}}],w)}function d(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=t.getSelectedRange(),w=[],v=new Map;let y=[],b=0;if(p){for(let T=0;T<p.length;T++){const{row:E,col:x}=p[T].getTopStartCorner(),{row:P,col:A}=p[T].getBottomEndCorner();for(let O=E;O<=P;O+=1)for(let Y=x;Y<=A;Y+=1){const B=t.getCellMeta(O,Y);if(B.hidden)continue;const ie={checkedTemplate:B.checkedTemplate,uncheckedTemplate:B.uncheckedTemplate};if(B.type!=="checkbox"){m===!0&&!B.readOnly&&(v.has(w.length)?v.set(w.length,[...v.get(w.length),[O,Y,null]]):v.set(w.length,[[O,Y,null]]));continue}if(B.readOnly===!0)continue;typeof B.checkedTemplate>"u"&&(B.checkedTemplate=!0),typeof B.uncheckedTemplate>"u"&&(B.uncheckedTemplate=!1);const ue=t.getDataAtCell(O,Y);m===!1?[B.checkedTemplate,B.checkedTemplate.toString()].includes(ue)?y.push([O,Y,B.uncheckedTemplate,ie]):[B.uncheckedTemplate,B.uncheckedTemplate.toString(),null,void 0].includes(ue)&&y.push([O,Y,B.checkedTemplate,ie]):y.push([O,Y,B.uncheckedTemplate,ie]),b+=1}w.push(b),b=0}y.every(T=>{let[,,E]=T;return E===y[0][2]})?y=y.map(T=>{let[E,x,P]=T;return[E,x,P]}):y=y.map(T=>{let[E,x,,P]=T;return[E,x,P.checkedTemplate]}),y.length>0&&w.forEach((T,E)=>{let x=y.splice(0,T);v.size&&v.has(E)&&(x=[...x,...v.get(E)]),t.setDataAtCell(x)})}}function g(){const m=t.getSelectedRange();if(m){for(let p=0;p<m.length;p++){const w=m[p].getTopStartCorner(),v=m[p].getBottomEndCorner();for(let y=w.row;y<=v.row;y++)for(let b=w.col;b<=v.col;b++){if(t.getCellMeta(y,b).readOnly)continue;const E=t.getCell(y,b);if(Bc(E)&&E.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}BL.RENDERER_TYPE=wQ;function J8e(t){let e=Pj.get(t);if(!e){const{rootElement:r}=t;e=new Ba(t),e.addEventListener(r,"click",n=>tje(n,t)),e.addEventListener(r,"mouseup",n=>eje(n,t)),e.addEventListener(r,"change",n=>rje(n,t)),Pj.set(t,e)}return e}function Q8e(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Z8e(t,e,r){const n=t.createElement("label");n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`;const i=t.createTextNode(e);if(r){const s=t.createElement("span");s.appendChild(i),n.appendChild(s)}else n.appendChild(i);return n.cloneNode(!0)}function eje(t,e){const{target:r}=t;VL(r)&&(!r.hasAttribute(Rp)||!r.hasAttribute(Tp)||setTimeout(e.listen,10))}function tje(t,e){const{target:r}=t;if(!VL(r)||!r.hasAttribute(Rp)||!r.hasAttribute(Tp))return;const n=parseInt(r.getAttribute(Rp),10),i=parseInt(r.getAttribute(Tp),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function rje(t,e){const{target:r}=t;if(!VL(r)||!r.hasAttribute(Rp)||!r.hasAttribute(Tp))return;const n=parseInt(r.getAttribute(Rp),10),i=parseInt(r.getAttribute(Tp),10),s=e.getCellMeta(n,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function VL(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const nje="handsontable";function WL(t,e,r,n,i,s,o){Zp.apply(this,[t,e,r,n,i,s,o])}WL.RENDERER_TYPE=nje;var ije=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sje(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var eA,Aj;function oje(){return Aj||(Aj=1,eA={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),eA}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var tA,Ij;function yQ(){if(Ij)return tA;Ij=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(l,c,u,h,f,d,g){if(!isNaN(+l))return+l;let m="",p=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(p!==l)return-1*r(p,c,u,h,f,d);for(let E=0;E<t.length;E++){let x=t[E];if(m=l.replace(RegExp(`([0-9 ])(${x.key})$`),"$1"),m!==l)return r(m,c,u,h,f,d)*x.factor}if(m=l.replace("%",""),m!==l)return r(m,c,u,h,f,d)/100;let w=parseFloat(l);if(isNaN(w))return;let v=h(w);if(v&&v!=="."&&(m=l.replace(new RegExp(`${e(v)}$`),""),m!==l))return r(m,c,u,h,f,d);let y={};Object.keys(d).forEach(E=>{y[d[E]]=E});let b=Object.keys(y).sort().reverse(),T=b.length;for(let E=0;E<T;E++){let x=b[E],P=y[x];if(m=l.replace(x,""),m!==l){let A;switch(P){case"thousand":A=Math.pow(10,3);break;case"million":A=Math.pow(10,6);break;case"billion":A=Math.pow(10,9);break;case"trillion":A=Math.pow(10,12);break}return r(m,c,u,h,f,d)*A}}}function n(l,c,u){let h=l.replace(u,"");return h=h.replace(new RegExp(`([0-9])${e(c.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(c.decimal,"."),h}function i(l,c,u="",h,f,d,g){if(l==="")return;if(l===f)return 0;let m=n(l,c,u);return r(m,c,u,h,f,d)}function s(l,c){if(!(l.indexOf(":")&&c.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let f=+h[0],d=+h[1],g=+h[2];return!isNaN(f)&&!isNaN(d)&&!isNaN(g)}function o(l){let c=l.split(":"),u=+c[0],h=+c[1];return+c[2]+60*h+3600*u}function a(l,c){const u=zL();let h=u.currentDelimiters(),f=u.currentCurrency().symbol,d=u.currentOrdinal(),g=u.getZeroFormat(),m=u.currentAbbreviations(),p;if(typeof l=="string")s(l,h)?p=o(l):p=i(l,h,f,d,g,m);else if(typeof l=="number")p=l;else return;if(p!==void 0)return p}return tA={unformat:a},tA}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var rA,Oj;function jL(){if(Oj)return rA;Oj=1;let t=yQ();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],n=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},c={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(p,w)=>w.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:p=>p.output==="byte"},characteristic:{type:"number",restriction:p=>p>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:n},average:"boolean",lowPrecision:{type:"boolean",restriction:(p,w)=>w.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:p=>p>=0,message:"value must be positive"},{restriction:(p,w)=>!w.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:p=>p>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(p,w)=>w.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:p=>p.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p,w){let v=f(p),y=g(w);return v&&y}function f(p){return t.unformat(p)!==void 0}function d(p,w,v,y=!1){let b=Object.keys(p).map(T=>{if(!w[T])return console.error(`${v} Invalid key: ${T}`),!1;let E=p[T],x=w[T];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!d(E,c,`[Validate ${T}]`,!0))return!1}else if(typeof E!==x.type)return console.error(`${v} ${T} type mismatched: "${x.type}" expected, "${typeof E}" provided`),!1;if(x.restrictions&&x.restrictions.length){let P=x.restrictions.length;for(let A=0;A<P;A++){let{restriction:O,message:Y}=x.restrictions[A];if(!O(E,p))return console.error(`${v} ${T} invalid value: ${Y}`),!1}}return x.restriction&&!x.restriction(E,p)?(console.error(`${v} ${T} invalid value: ${x.message}`),!1):x.validValues&&x.validValues.indexOf(E)===-1?(console.error(`${v} ${T} invalid value: must be among ${JSON.stringify(x.validValues)}, "${E}" provided`),!1):!(x.children&&!d(E,x.children,`[Validate ${T}]`))});return y||b.push(...Object.keys(w).map(T=>{let E=w[T];if(typeof E=="string"&&(E={type:E}),E.mandatory){let x=E.mandatory;if(typeof x=="function"&&(x=x(p)),x&&p[T]===void 0)return console.error(`${v} Missing mandatory key "${T}"`),!1}return!0})),b.reduce((T,E)=>T&&E,!0)}function g(p){return d(p,c,"[Validate format]")}function m(p){return d(p,u,"[Validate language]")}return rA={validate:h,validateFormat:g,validateInput:f,validateLanguage:m},rA}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function aje(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function lje(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function cje(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function uje(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function hje(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function fje(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function dje(t,e){let n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}function gje(t,e){let r=t.split(".")[1];if(r){let n=r.match(/0+/);n&&(e.mantissa=n[0].length)}}function mje(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function pje(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function vje(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function wje(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function yje(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function Cje(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Sje(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function xje(t,e={}){return typeof t!="string"?t:(t=aje(t,e),t=lje(t,e),cje(t,e),fje(t,e),dje(t,e),yje(t,e),pje(t,e),vje(t,e),gje(t,e),wje(t,e),mje(t,e),uje(t,e),hje(t,e),Cje(t,e),Sje(t,e),e)}var UL={parseFormat:xje};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var nA,Mj;function zL(){if(Mj)return nA;Mj=1;const t=oje(),e=jL(),r=UL;let n={},i,s={},o=null,a={};function l(u){i=u}function c(){return s[i]}return n.languages=()=>Object.assign({},s),n.currentLanguage=()=>i,n.currentBytes=()=>c().bytes||{},n.currentCurrency=()=>c().currency,n.currentAbbreviations=()=>c().abbreviations,n.currentDelimiters=()=>c().delimiters,n.currentOrdinal=()=>c().ordinal,n.currentDefaults=()=>Object.assign({},c().defaults,a),n.currentOrdinalDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().ordinalFormat),n.currentByteDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().byteFormat),n.currentPercentageDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().percentageFormat),n.currentCurrencyDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().currencyFormat),n.currentTimeDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().timeFormat),n.setDefaults=u=>{u=r.parseFormat(u),e.validateFormat(u)&&(a=u)},n.getZeroFormat=()=>o,n.setZeroFormat=u=>o=typeof u=="string"?u:null,n.hasZeroFormat=()=>o!==null,n.languageData=u=>{if(u){if(s[u])return s[u];throw new Error(`Unknown tag "${u}"`)}return c()},n.registerLanguage=(u,h=!1)=>{if(!e.validateLanguage(u))throw new Error("Invalid language data");s[u.languageTag]=u,h&&l(u.languageTag)},n.setLanguage=(u,h=t.languageTag)=>{if(!s[u]){let f=u.split("-")[0],d=Object.keys(s).find(g=>g.split("-")[0]===f);if(!s[d]){l(h);return}l(d);return}l(u)},n.registerLanguage(t),i=t.languageTag,nA=n,nA}function bje(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function _je(t,e){t.forEach(r=>{let n;try{n=bje(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}n&&e.registerLanguage(n)})}var Eje=t=>({loadLanguagesInNode:e=>_je(e,t)}),CQ={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,u=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,d=1e9;function g(E){var x,P,A,O=S.prototype={constructor:S,toString:null,valueOf:null},Y=new S(1),B=20,ie=4,ue=-7,he=21,Ee=-1e7,Ce=1e7,ge=!1,Q=1,ye=0,Re={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},j="0123456789abcdefghijklmnopqrstuvwxyz",C=!0;function S(k,M){var R,W,q,J,re,V,te,oe,ae=this;if(!(ae instanceof S))return new S(k,M);if(M==null){if(k&&k._isBigNumber===!0){ae.s=k.s,!k.c||k.e>Ce?ae.c=ae.e=null:k.e<Ee?ae.c=[ae.e=0]:(ae.e=k.e,ae.c=k.c.slice());return}if((V=typeof k=="number")&&k*0==0){if(ae.s=1/k<0?(k=-k,-1):1,k===~~k){for(J=0,re=k;re>=10;re/=10,J++);J>Ce?ae.c=ae.e=null:(ae.e=J,ae.c=[k]);return}oe=String(k)}else{if(!n.test(oe=String(k)))return A(ae,oe,V);ae.s=oe.charCodeAt(0)==45?(oe=oe.slice(1),-1):1}(J=oe.indexOf("."))>-1&&(oe=oe.replace(".","")),(re=oe.search(/e/i))>0?(J<0&&(J=re),J+=+oe.slice(re+1),oe=oe.substring(0,re)):J<0&&(J=oe.length)}else{if(v(M,2,j.length,"Base"),M==10&&C)return ae=new S(k),X(ae,B+ae.e+1,ie);if(oe=String(k),V=typeof k=="number"){if(k*0!=0)return A(ae,oe,V,M);if(ae.s=1/k<0?(oe=oe.slice(1),-1):1,S.DEBUG&&oe.replace(/^0\.0*|\./,"").length>15)throw Error(a+k)}else ae.s=oe.charCodeAt(0)===45?(oe=oe.slice(1),-1):1;for(R=j.slice(0,M),J=re=0,te=oe.length;re<te;re++)if(R.indexOf(W=oe.charAt(re))<0){if(W=="."){if(re>J){J=te;continue}}else if(!q&&(oe==oe.toUpperCase()&&(oe=oe.toLowerCase())||oe==oe.toLowerCase()&&(oe=oe.toUpperCase()))){q=!0,re=-1,J=0;continue}return A(ae,String(k),V,M)}V=!1,oe=P(oe,M,10,ae.s),(J=oe.indexOf("."))>-1?oe=oe.replace(".",""):J=oe.length}for(re=0;oe.charCodeAt(re)===48;re++);for(te=oe.length;oe.charCodeAt(--te)===48;);if(oe=oe.slice(re,++te)){if(te-=re,V&&S.DEBUG&&te>15&&(k>u||k!==s(k)))throw Error(a+ae.s*k);if((J=J-re-1)>Ce)ae.c=ae.e=null;else if(J<Ee)ae.c=[ae.e=0];else{if(ae.e=J,ae.c=[],re=(J+1)%c,J<0&&(re+=c),re<te){for(re&&ae.c.push(+oe.slice(0,re)),te-=c;re<te;)ae.c.push(+oe.slice(re,re+=c));re=c-(oe=oe.slice(re)).length}else re-=te;for(;re--;oe+="0");ae.c.push(+oe)}}else ae.c=[ae.e=0]}S.clone=g,S.ROUND_UP=0,S.ROUND_DOWN=1,S.ROUND_CEIL=2,S.ROUND_FLOOR=3,S.ROUND_HALF_UP=4,S.ROUND_HALF_DOWN=5,S.ROUND_HALF_EVEN=6,S.ROUND_HALF_CEIL=7,S.ROUND_HALF_FLOOR=8,S.EUCLID=9,S.config=S.set=function(k){var M,R;if(k!=null)if(typeof k=="object"){if(k.hasOwnProperty(M="DECIMAL_PLACES")&&(R=k[M],v(R,0,d,M),B=R),k.hasOwnProperty(M="ROUNDING_MODE")&&(R=k[M],v(R,0,8,M),ie=R),k.hasOwnProperty(M="EXPONENTIAL_AT")&&(R=k[M],R&&R.pop?(v(R[0],-d,0,M),v(R[1],0,d,M),ue=R[0],he=R[1]):(v(R,-d,d,M),ue=-(he=R<0?-R:R))),k.hasOwnProperty(M="RANGE"))if(R=k[M],R&&R.pop)v(R[0],-d,-1,M),v(R[1],1,d,M),Ee=R[0],Ce=R[1];else if(v(R,-d,d,M),R)Ee=-(Ce=R<0?-R:R);else throw Error(o+M+" cannot be zero: "+R);if(k.hasOwnProperty(M="CRYPTO"))if(R=k[M],R===!!R)if(R)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ge=R;else throw ge=!R,Error(o+"crypto unavailable");else ge=R;else throw Error(o+M+" not true or false: "+R);if(k.hasOwnProperty(M="MODULO_MODE")&&(R=k[M],v(R,0,9,M),Q=R),k.hasOwnProperty(M="POW_PRECISION")&&(R=k[M],v(R,0,d,M),ye=R),k.hasOwnProperty(M="FORMAT"))if(R=k[M],typeof R=="object")Re=R;else throw Error(o+M+" not an object: "+R);if(k.hasOwnProperty(M="ALPHABET"))if(R=k[M],typeof R=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(R))C=R.slice(0,10)=="0123456789",j=R;else throw Error(o+M+" invalid: "+R)}else throw Error(o+"Object expected: "+k);return{DECIMAL_PLACES:B,ROUNDING_MODE:ie,EXPONENTIAL_AT:[ue,he],RANGE:[Ee,Ce],CRYPTO:ge,MODULO_MODE:Q,POW_PRECISION:ye,FORMAT:Re,ALPHABET:j}},S.isBigNumber=function(k){if(!k||k._isBigNumber!==!0)return!1;if(!S.DEBUG)return!0;var M,R,W=k.c,q=k.e,J=k.s;e:if({}.toString.call(W)=="[object Array]"){if((J===1||J===-1)&&q>=-d&&q<=d&&q===s(q)){if(W[0]===0){if(q===0&&W.length===1)return!0;break e}if(M=(q+1)%c,M<1&&(M+=c),String(W[0]).length==M){for(M=0;M<W.length;M++)if(R=W[M],R<0||R>=l||R!==s(R))break e;if(R!==0)return!0}}}else if(W===null&&q===null&&(J===null||J===1||J===-1))return!0;throw Error(o+"Invalid BigNumber: "+k)},S.maximum=S.max=function(){return D(arguments,-1)},S.minimum=S.min=function(){return D(arguments,1)},S.random=function(){var k=9007199254740992,M=Math.random()*k&2097151?function(){return s(Math.random()*k)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(R){var W,q,J,re,V,te=0,oe=[],ae=new S(Y);if(R==null?R=B:v(R,0,d),re=i(R/c),ge)if(crypto.getRandomValues){for(W=crypto.getRandomValues(new Uint32Array(re*=2));te<re;)V=W[te]*131072+(W[te+1]>>>11),V>=9e15?(q=crypto.getRandomValues(new Uint32Array(2)),W[te]=q[0],W[te+1]=q[1]):(oe.push(V%1e14),te+=2);te=re/2}else if(crypto.randomBytes){for(W=crypto.randomBytes(re*=7);te<re;)V=(W[te]&31)*281474976710656+W[te+1]*1099511627776+W[te+2]*4294967296+W[te+3]*16777216+(W[te+4]<<16)+(W[te+5]<<8)+W[te+6],V>=9e15?crypto.randomBytes(7).copy(W,te):(oe.push(V%1e14),te+=7);te=re/7}else throw ge=!1,Error(o+"crypto unavailable");if(!ge)for(;te<re;)V=M(),V<9e15&&(oe[te++]=V%1e14);for(re=oe[--te],R%=c,re&&R&&(V=h[c-R],oe[te]=s(re/V)*V);oe[te]===0;oe.pop(),te--);if(te<0)oe=[J=0];else{for(J=-1;oe[0]===0;oe.splice(0,1),J-=c);for(te=1,V=oe[0];V>=10;V/=10,te++);te<c&&(J-=c-te)}return ae.e=J,ae.c=oe,ae}}(),S.sum=function(){for(var k=1,M=arguments,R=new S(M[0]);k<M.length;)R=R.plus(M[k++]);return R},P=function(){var k="0123456789";function M(R,W,q,J){for(var re,V=[0],te,oe=0,ae=R.length;oe<ae;){for(te=V.length;te--;V[te]*=W);for(V[0]+=J.indexOf(R.charAt(oe++)),re=0;re<V.length;re++)V[re]>q-1&&(V[re+1]==null&&(V[re+1]=0),V[re+1]+=V[re]/q|0,V[re]%=q)}return V.reverse()}return function(R,W,q,J,re){var V,te,oe,ae,fe,Me,Ne,ze,ot=R.indexOf("."),at=B,rt=ie;for(ot>=0&&(ae=ye,ye=0,R=R.replace(".",""),ze=new S(W),Me=ze.pow(R.length-ot),ye=ae,ze.c=M(T(p(Me.c),Me.e,"0"),10,q,k),ze.e=ze.c.length),Ne=M(R,W,q,re?(V=j,k):(V=k,j)),oe=ae=Ne.length;Ne[--ae]==0;Ne.pop());if(!Ne[0])return V.charAt(0);if(ot<0?--oe:(Me.c=Ne,Me.e=oe,Me.s=J,Me=x(Me,ze,at,rt,q),Ne=Me.c,fe=Me.r,oe=Me.e),te=oe+at+1,ot=Ne[te],ae=q/2,fe=fe||te<0||Ne[te+1]!=null,fe=rt<4?(ot!=null||fe)&&(rt==0||rt==(Me.s<0?3:2)):ot>ae||ot==ae&&(rt==4||fe||rt==6&&Ne[te-1]&1||rt==(Me.s<0?8:7)),te<1||!Ne[0])R=fe?T(V.charAt(1),-at,V.charAt(0)):V.charAt(0);else{if(Ne.length=te,fe)for(--q;++Ne[--te]>q;)Ne[te]=0,te||(++oe,Ne=[1].concat(Ne));for(ae=Ne.length;!Ne[--ae];);for(ot=0,R="";ot<=ae;R+=V.charAt(Ne[ot++]));R=T(R,oe,V.charAt(0))}return R}}(),x=function(){function k(W,q,J){var re,V,te,oe,ae=0,fe=W.length,Me=q%f,Ne=q/f|0;for(W=W.slice();fe--;)te=W[fe]%f,oe=W[fe]/f|0,re=Ne*te+oe*Me,V=Me*te+re%f*f+ae,ae=(V/J|0)+(re/f|0)+Ne*oe,W[fe]=V%J;return ae&&(W=[ae].concat(W)),W}function M(W,q,J,re){var V,te;if(J!=re)te=J>re?1:-1;else for(V=te=0;V<J;V++)if(W[V]!=q[V]){te=W[V]>q[V]?1:-1;break}return te}function R(W,q,J,re){for(var V=0;J--;)W[J]-=V,V=W[J]<q[J]?1:0,W[J]=V*re+W[J]-q[J];for(;!W[0]&&W.length>1;W.splice(0,1));}return function(W,q,J,re,V){var te,oe,ae,fe,Me,Ne,ze,ot,at,rt,We,ft,Ze,qt,Or,xt,Bt,gr=W.s==q.s?1:-1,hr=W.c,Nt=q.c;if(!hr||!hr[0]||!Nt||!Nt[0])return new S(!W.s||!q.s||(hr?Nt&&hr[0]==Nt[0]:!Nt)?NaN:hr&&hr[0]==0||!Nt?gr*0:gr/0);for(ot=new S(gr),at=ot.c=[],oe=W.e-q.e,gr=J+oe+1,V||(V=l,oe=m(W.e/c)-m(q.e/c),gr=gr/c|0),ae=0;Nt[ae]==(hr[ae]||0);ae++);if(Nt[ae]>(hr[ae]||0)&&oe--,gr<0)at.push(1),fe=!0;else{for(qt=hr.length,xt=Nt.length,ae=0,gr+=2,Me=s(V/(Nt[0]+1)),Me>1&&(Nt=k(Nt,Me,V),hr=k(hr,Me,V),xt=Nt.length,qt=hr.length),Ze=xt,rt=hr.slice(0,xt),We=rt.length;We<xt;rt[We++]=0);Bt=Nt.slice(),Bt=[0].concat(Bt),Or=Nt[0],Nt[1]>=V/2&&Or++;do{if(Me=0,te=M(Nt,rt,xt,We),te<0){if(ft=rt[0],xt!=We&&(ft=ft*V+(rt[1]||0)),Me=s(ft/Or),Me>1)for(Me>=V&&(Me=V-1),Ne=k(Nt,Me,V),ze=Ne.length,We=rt.length;M(Ne,rt,ze,We)==1;)Me--,R(Ne,xt<ze?Bt:Nt,ze,V),ze=Ne.length,te=1;else Me==0&&(te=Me=1),Ne=Nt.slice(),ze=Ne.length;if(ze<We&&(Ne=[0].concat(Ne)),R(rt,Ne,We,V),We=rt.length,te==-1)for(;M(Nt,rt,xt,We)<1;)Me++,R(rt,xt<We?Bt:Nt,We,V),We=rt.length}else te===0&&(Me++,rt=[0]);at[ae++]=Me,rt[0]?rt[We++]=hr[Ze]||0:(rt=[hr[Ze]],We=1)}while((Ze++<qt||rt[0]!=null)&&gr--);fe=rt[0]!=null,at[0]||at.splice(0,1)}if(V==l){for(ae=1,gr=at[0];gr>=10;gr/=10,ae++);X(ot,J+(ot.e=ae+oe*c-1)+1,re,fe)}else ot.e=oe,ot.r=+fe;return ot}}();function _(k,M,R,W){var q,J,re,V,te;if(R==null?R=ie:v(R,0,8),!k.c)return k.toString();if(q=k.c[0],re=k.e,M==null)te=p(k.c),te=W==1||W==2&&(re<=ue||re>=he)?b(te,re):T(te,re,"0");else if(k=X(new S(k),M,R),J=k.e,te=p(k.c),V=te.length,W==1||W==2&&(M<=J||J<=ue)){for(;V<M;te+="0",V++);te=b(te,J)}else if(M-=re,te=T(te,J,"0"),J+1>V){if(--M>0)for(te+=".";M--;te+="0");}else if(M+=J-V,M>0)for(J+1==V&&(te+=".");M--;te+="0");return k.s<0&&q?"-"+te:te}function D(k,M){for(var R,W,q=1,J=new S(k[0]);q<k.length;q++)W=new S(k[q]),(!W.s||(R=w(J,W))===M||R===0&&J.s===M)&&(J=W);return J}function U(k,M,R){for(var W=1,q=M.length;!M[--q];M.pop());for(q=M[0];q>=10;q/=10,W++);return(R=W+R*c-1)>Ce?k.c=k.e=null:R<Ee?k.c=[k.e=0]:(k.e=R,k.c=M),k}A=function(){var k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,M=/^([^.]+)\.$/,R=/^\.([^.]+)$/,W=/^-?(Infinity|NaN)$/,q=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(J,re,V,te){var oe,ae=V?re:re.replace(q,"");if(W.test(ae))J.s=isNaN(ae)?null:ae<0?-1:1;else{if(!V&&(ae=ae.replace(k,function(fe,Me,Ne){return oe=(Ne=Ne.toLowerCase())=="x"?16:Ne=="b"?2:8,!te||te==oe?Me:fe}),te&&(oe=te,ae=ae.replace(M,"$1").replace(R,"0.$1")),re!=ae))return new S(ae,oe);if(S.DEBUG)throw Error(o+"Not a"+(te?" base "+te:"")+" number: "+re);J.s=null}J.c=J.e=null}}();function X(k,M,R,W){var q,J,re,V,te,oe,ae,fe=k.c,Me=h;if(fe){e:{for(q=1,V=fe[0];V>=10;V/=10,q++);if(J=M-q,J<0)J+=c,re=M,te=fe[oe=0],ae=s(te/Me[q-re-1]%10);else if(oe=i((J+1)/c),oe>=fe.length)if(W){for(;fe.length<=oe;fe.push(0));te=ae=0,q=1,J%=c,re=J-c+1}else break e;else{for(te=V=fe[oe],q=1;V>=10;V/=10,q++);J%=c,re=J-c+q,ae=re<0?0:s(te/Me[q-re-1]%10)}if(W=W||M<0||fe[oe+1]!=null||(re<0?te:te%Me[q-re-1]),W=R<4?(ae||W)&&(R==0||R==(k.s<0?3:2)):ae>5||ae==5&&(R==4||W||R==6&&(J>0?re>0?te/Me[q-re]:0:fe[oe-1])%10&1||R==(k.s<0?8:7)),M<1||!fe[0])return fe.length=0,W?(M-=k.e+1,fe[0]=Me[(c-M%c)%c],k.e=-M||0):fe[0]=k.e=0,k;if(J==0?(fe.length=oe,V=1,oe--):(fe.length=oe+1,V=Me[c-J],fe[oe]=re>0?s(te/Me[q-re]%Me[re])*V:0),W)for(;;)if(oe==0){for(J=1,re=fe[0];re>=10;re/=10,J++);for(re=fe[0]+=V,V=1;re>=10;re/=10,V++);J!=V&&(k.e++,fe[0]==l&&(fe[0]=1));break}else{if(fe[oe]+=V,fe[oe]!=l)break;fe[oe--]=0,V=1}for(J=fe.length;fe[--J]===0;fe.pop());}k.e>Ce?k.c=k.e=null:k.e<Ee&&(k.c=[k.e=0])}return k}function ee(k){var M,R=k.e;return R===null?k.toString():(M=p(k.c),M=R<=ue||R>=he?b(M,R):T(M,R,"0"),k.s<0?"-"+M:M)}return O.absoluteValue=O.abs=function(){var k=new S(this);return k.s<0&&(k.s=1),k},O.comparedTo=function(k,M){return w(this,new S(k,M))},O.decimalPlaces=O.dp=function(k,M){var R,W,q,J=this;if(k!=null)return v(k,0,d),M==null?M=ie:v(M,0,8),X(new S(J),k+J.e+1,M);if(!(R=J.c))return null;if(W=((q=R.length-1)-m(this.e/c))*c,q=R[q])for(;q%10==0;q/=10,W--);return W<0&&(W=0),W},O.dividedBy=O.div=function(k,M){return x(this,new S(k,M),B,ie)},O.dividedToIntegerBy=O.idiv=function(k,M){return x(this,new S(k,M),0,1)},O.exponentiatedBy=O.pow=function(k,M){var R,W,q,J,re,V,te,oe,ae,fe=this;if(k=new S(k),k.c&&!k.isInteger())throw Error(o+"Exponent not an integer: "+ee(k));if(M!=null&&(M=new S(M)),V=k.e>14,!fe.c||!fe.c[0]||fe.c[0]==1&&!fe.e&&fe.c.length==1||!k.c||!k.c[0])return ae=new S(Math.pow(+ee(fe),V?k.s*(2-y(k)):+ee(k))),M?ae.mod(M):ae;if(te=k.s<0,M){if(M.c?!M.c[0]:!M.s)return new S(NaN);W=!te&&fe.isInteger()&&M.isInteger(),W&&(fe=fe.mod(M))}else{if(k.e>9&&(fe.e>0||fe.e<-1||(fe.e==0?fe.c[0]>1||V&&fe.c[1]>=24e7:fe.c[0]<8e13||V&&fe.c[0]<=9999975e7)))return J=fe.s<0&&y(k)?-0:0,fe.e>-1&&(J=1/J),new S(te?1/J:J);ye&&(J=i(ye/c+2))}for(V?(R=new S(.5),te&&(k.s=1),oe=y(k)):(q=Math.abs(+ee(k)),oe=q%2),ae=new S(Y);;){if(oe){if(ae=ae.times(fe),!ae.c)break;J?ae.c.length>J&&(ae.c.length=J):W&&(ae=ae.mod(M))}if(q){if(q=s(q/2),q===0)break;oe=q%2}else if(k=k.times(R),X(k,k.e+1,1),k.e>14)oe=y(k);else{if(q=+ee(k),q===0)break;oe=q%2}fe=fe.times(fe),J?fe.c&&fe.c.length>J&&(fe.c.length=J):W&&(fe=fe.mod(M))}return W?ae:(te&&(ae=Y.div(ae)),M?ae.mod(M):J?X(ae,ye,ie,re):ae)},O.integerValue=function(k){var M=new S(this);return k==null?k=ie:v(k,0,8),X(M,M.e+1,k)},O.isEqualTo=O.eq=function(k,M){return w(this,new S(k,M))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(k,M){return w(this,new S(k,M))>0},O.isGreaterThanOrEqualTo=O.gte=function(k,M){return(M=w(this,new S(k,M)))===1||M===0},O.isInteger=function(){return!!this.c&&m(this.e/c)>this.c.length-2},O.isLessThan=O.lt=function(k,M){return w(this,new S(k,M))<0},O.isLessThanOrEqualTo=O.lte=function(k,M){return(M=w(this,new S(k,M)))===-1||M===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(k,M){var R,W,q,J,re=this,V=re.s;if(k=new S(k,M),M=k.s,!V||!M)return new S(NaN);if(V!=M)return k.s=-M,re.plus(k);var te=re.e/c,oe=k.e/c,ae=re.c,fe=k.c;if(!te||!oe){if(!ae||!fe)return ae?(k.s=-M,k):new S(fe?re:NaN);if(!ae[0]||!fe[0])return fe[0]?(k.s=-M,k):new S(ae[0]?re:ie==3?-0:0)}if(te=m(te),oe=m(oe),ae=ae.slice(),V=te-oe){for((J=V<0)?(V=-V,q=ae):(oe=te,q=fe),q.reverse(),M=V;M--;q.push(0));q.reverse()}else for(W=(J=(V=ae.length)<(M=fe.length))?V:M,V=M=0;M<W;M++)if(ae[M]!=fe[M]){J=ae[M]<fe[M];break}if(J&&(q=ae,ae=fe,fe=q,k.s=-k.s),M=(W=fe.length)-(R=ae.length),M>0)for(;M--;ae[R++]=0);for(M=l-1;W>V;){if(ae[--W]<fe[W]){for(R=W;R&&!ae[--R];ae[R]=M);--ae[R],ae[W]+=l}ae[W]-=fe[W]}for(;ae[0]==0;ae.splice(0,1),--oe);return ae[0]?U(k,ae,oe):(k.s=ie==3?-1:1,k.c=[k.e=0],k)},O.modulo=O.mod=function(k,M){var R,W,q=this;return k=new S(k,M),!q.c||!k.s||k.c&&!k.c[0]?new S(NaN):!k.c||q.c&&!q.c[0]?new S(q):(Q==9?(W=k.s,k.s=1,R=x(q,k,0,3),k.s=W,R.s*=W):R=x(q,k,0,Q),k=q.minus(R.times(k)),!k.c[0]&&Q==1&&(k.s=q.s),k)},O.multipliedBy=O.times=function(k,M){var R,W,q,J,re,V,te,oe,ae,fe,Me,Ne,ze,ot,at,rt=this,We=rt.c,ft=(k=new S(k,M)).c;if(!We||!ft||!We[0]||!ft[0])return!rt.s||!k.s||We&&!We[0]&&!ft||ft&&!ft[0]&&!We?k.c=k.e=k.s=null:(k.s*=rt.s,!We||!ft?k.c=k.e=null:(k.c=[0],k.e=0)),k;for(W=m(rt.e/c)+m(k.e/c),k.s*=rt.s,te=We.length,fe=ft.length,te<fe&&(ze=We,We=ft,ft=ze,q=te,te=fe,fe=q),q=te+fe,ze=[];q--;ze.push(0));for(ot=l,at=f,q=fe;--q>=0;){for(R=0,Me=ft[q]%at,Ne=ft[q]/at|0,re=te,J=q+re;J>q;)oe=We[--re]%at,ae=We[re]/at|0,V=Ne*oe+ae*Me,oe=Me*oe+V%at*at+ze[J]+R,R=(oe/ot|0)+(V/at|0)+Ne*ae,ze[J--]=oe%ot;ze[J]=R}return R?++W:ze.splice(0,1),U(k,ze,W)},O.negated=function(){var k=new S(this);return k.s=-k.s||null,k},O.plus=function(k,M){var R,W=this,q=W.s;if(k=new S(k,M),M=k.s,!q||!M)return new S(NaN);if(q!=M)return k.s=-M,W.minus(k);var J=W.e/c,re=k.e/c,V=W.c,te=k.c;if(!J||!re){if(!V||!te)return new S(q/0);if(!V[0]||!te[0])return te[0]?k:new S(V[0]?W:q*0)}if(J=m(J),re=m(re),V=V.slice(),q=J-re){for(q>0?(re=J,R=te):(q=-q,R=V),R.reverse();q--;R.push(0));R.reverse()}for(q=V.length,M=te.length,q-M<0&&(R=te,te=V,V=R,M=q),q=0;M;)q=(V[--M]=V[M]+te[M]+q)/l|0,V[M]=l===V[M]?0:V[M]%l;return q&&(V=[q].concat(V),++re),U(k,V,re)},O.precision=O.sd=function(k,M){var R,W,q,J=this;if(k!=null&&k!==!!k)return v(k,1,d),M==null?M=ie:v(M,0,8),X(new S(J),k,M);if(!(R=J.c))return null;if(q=R.length-1,W=q*c+1,q=R[q]){for(;q%10==0;q/=10,W--);for(q=R[0];q>=10;q/=10,W++);}return k&&J.e+1>W&&(W=J.e+1),W},O.shiftedBy=function(k){return v(k,-u,u),this.times("1e"+k)},O.squareRoot=O.sqrt=function(){var k,M,R,W,q,J=this,re=J.c,V=J.s,te=J.e,oe=B+4,ae=new S("0.5");if(V!==1||!re||!re[0])return new S(!V||V<0&&(!re||re[0])?NaN:re?J:1/0);if(V=Math.sqrt(+ee(J)),V==0||V==1/0?(M=p(re),(M.length+te)%2==0&&(M+="0"),V=Math.sqrt(+M),te=m((te+1)/2)-(te<0||te%2),V==1/0?M="5e"+te:(M=V.toExponential(),M=M.slice(0,M.indexOf("e")+1)+te),R=new S(M)):R=new S(V+""),R.c[0]){for(te=R.e,V=te+oe,V<3&&(V=0);;)if(q=R,R=ae.times(q.plus(x(J,q,oe,1))),p(q.c).slice(0,V)===(M=p(R.c)).slice(0,V))if(R.e<te&&--V,M=M.slice(V-3,V+1),M=="9999"||!W&&M=="4999"){if(!W&&(X(q,q.e+B+2,0),q.times(q).eq(J))){R=q;break}oe+=4,V+=4,W=1}else{(!+M||!+M.slice(1)&&M.charAt(0)=="5")&&(X(R,R.e+B+2,1),k=!R.times(R).eq(J));break}}return X(R,R.e+B+1,ie,k)},O.toExponential=function(k,M){return k!=null&&(v(k,0,d),k++),_(this,k,M,1)},O.toFixed=function(k,M){return k!=null&&(v(k,0,d),k=k+this.e+1),_(this,k,M)},O.toFormat=function(k,M,R){var W,q=this;if(R==null)k!=null&&M&&typeof M=="object"?(R=M,M=null):k&&typeof k=="object"?(R=k,k=M=null):R=Re;else if(typeof R!="object")throw Error(o+"Argument not an object: "+R);if(W=q.toFixed(k,M),q.c){var J,re=W.split("."),V=+R.groupSize,te=+R.secondaryGroupSize,oe=R.groupSeparator||"",ae=re[0],fe=re[1],Me=q.s<0,Ne=Me?ae.slice(1):ae,ze=Ne.length;if(te&&(J=V,V=te,te=J,ze-=J),V>0&&ze>0){for(J=ze%V||V,ae=Ne.substr(0,J);J<ze;J+=V)ae+=oe+Ne.substr(J,V);te>0&&(ae+=oe+Ne.slice(J)),Me&&(ae="-"+ae)}W=fe?ae+(R.decimalSeparator||"")+((te=+R.fractionGroupSize)?fe.replace(new RegExp("\\d{"+te+"}\\B","g"),"$&"+(R.fractionGroupSeparator||"")):fe):ae}return(R.prefix||"")+W+(R.suffix||"")},O.toFraction=function(k){var M,R,W,q,J,re,V,te,oe,ae,fe,Me,Ne=this,ze=Ne.c;if(k!=null&&(V=new S(k),!V.isInteger()&&(V.c||V.s!==1)||V.lt(Y)))throw Error(o+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+ee(V));if(!ze)return new S(Ne);for(M=new S(Y),oe=R=new S(Y),W=te=new S(Y),Me=p(ze),J=M.e=Me.length-Ne.e-1,M.c[0]=h[(re=J%c)<0?c+re:re],k=!k||V.comparedTo(M)>0?J>0?M:oe:V,re=Ce,Ce=1/0,V=new S(Me),te.c[0]=0;ae=x(V,M,0,1),q=R.plus(ae.times(W)),q.comparedTo(k)!=1;)R=W,W=q,oe=te.plus(ae.times(q=oe)),te=q,M=V.minus(ae.times(q=M)),V=q;return q=x(k.minus(R),W,0,1),te=te.plus(q.times(oe)),R=R.plus(q.times(W)),te.s=oe.s=Ne.s,J=J*2,fe=x(oe,W,J,ie).minus(Ne).abs().comparedTo(x(te,R,J,ie).minus(Ne).abs())<1?[oe,W]:[te,R],Ce=re,fe},O.toNumber=function(){return+ee(this)},O.toPrecision=function(k,M){return k!=null&&v(k,1,d),_(this,k,M,2)},O.toString=function(k){var M,R=this,W=R.s,q=R.e;return q===null?W?(M="Infinity",W<0&&(M="-"+M)):M="NaN":(k==null?M=q<=ue||q>=he?b(p(R.c),q):T(p(R.c),q,"0"):k===10&&C?(R=X(new S(R),B+q+1,ie),M=T(p(R.c),R.e,"0")):(v(k,2,j.length,"Base"),M=P(T(p(R.c),q,"0"),10,k,W,!0)),W<0&&R.c[0]&&(M="-"+M)),M},O.valueOf=O.toJSON=function(){return ee(this)},O._isBigNumber=!0,E!=null&&S.set(E),S}function m(E){var x=E|0;return E>0||E===x?x:x-1}function p(E){for(var x,P,A=1,O=E.length,Y=E[0]+"";A<O;){for(x=E[A++]+"",P=c-x.length;P--;x="0"+x);Y+=x}for(O=Y.length;Y.charCodeAt(--O)===48;);return Y.slice(0,O+1||1)}function w(E,x){var P,A,O=E.c,Y=x.c,B=E.s,ie=x.s,ue=E.e,he=x.e;if(!B||!ie)return null;if(P=O&&!O[0],A=Y&&!Y[0],P||A)return P?A?0:-ie:B;if(B!=ie)return B;if(P=B<0,A=ue==he,!O||!Y)return A?0:!O^P?1:-1;if(!A)return ue>he^P?1:-1;for(ie=(ue=O.length)<(he=Y.length)?ue:he,B=0;B<ie;B++)if(O[B]!=Y[B])return O[B]>Y[B]^P?1:-1;return ue==he?0:ue>he^P?1:-1}function v(E,x,P,A){if(E<x||E>P||E!==s(E))throw Error(o+(A||"Argument")+(typeof E=="number"?E<x||E>P?" out of range: ":" not an integer: ":" not a primitive number: ")+String(E))}function y(E){var x=E.c.length-1;return m(E.e/c)==x&&E.c[x]%2!=0}function b(E,x){return(E.length>1?E.charAt(0)+"."+E.slice(1):E)+(x<0?"e":"e+")+x}function T(E,x,P){var A,O;if(x<0){for(O=P+".";++x;O+=P);E=O+E}else if(A=E.length,++x>A){for(O=P,x-=A;--x;O+=P);E+=O}else x<A&&(E=E.slice(0,x)+"."+E.slice(x));return E}r=g(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(ije)})(CQ);var SQ=CQ.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ma=zL(),Rje=jL(),Tje=UL,kje=SQ,ni={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},k1={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:xQ,decimalSuffixes:O_}=ma.currentBytes(),GL={general:{scale:1024,suffixes:O_},binary:{scale:1024,suffixes:xQ},decimal:{scale:1e3,suffixes:O_}};function Pje(t,e={},r){if(typeof e=="string"&&(e=Tje.parseFormat(e)),!Rje.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",o=Aje(t,e,r);return o=Xje(o,i),o=qje(o,s),o}function Aje(t,e,r){switch(e.output){case"currency":return e=am(e,ma.currentCurrencyDefaultFormat()),Lje(t,e,ma);case"percent":return e=am(e,ma.currentPercentageDefaultFormat()),Hje(t,e,ma,r);case"byte":return e=am(e,ma.currentByteDefaultFormat()),Nje(t,e,ma,r);case"time":return e=am(e,ma.currentTimeDefaultFormat()),Fje(t);case"ordinal":return e=am(e,ma.currentOrdinalDefaultFormat()),Dje(t,e,ma);case"number":default:return P1({instance:t,providedFormat:e})}}function Ije(t){let e=GL.decimal;return zR(t._value,e.suffixes,e.scale).suffix}function Oje(t){let e=GL.binary;return zR(t._value,e.suffixes,e.scale).suffix}function Mje(t){let e=GL.general;return zR(t._value,e.suffixes,e.scale).suffix}function zR(t,e,r){let n=e[0],i=Math.abs(t);if(i>=r){for(let s=1;s<e.length;++s){let o=Math.pow(r,s),a=Math.pow(r,s+1);if(i>=o&&i<a){n=e[s],t=t/o;break}}n===e[0]&&(t=t/Math.pow(r,e.length-1),n=e[e.length-1])}return{value:t,suffix:n}}function Nje(t,e,r,n){let i=e.base||"binary",s=Object.assign({},k1,e);const{binarySuffixes:o,decimalSuffixes:a}=r.currentBytes();let c={general:{scale:1024,suffixes:a||O_,marker:"bd"},binary:{scale:1024,suffixes:o||xQ,marker:"b"},decimal:{scale:1e3,suffixes:a||O_,marker:"d"}}[i],{value:u,suffix:h}=zR(t._value,c.suffixes,c.scale);return`${P1({instance:n(u),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${h}`}function Dje(t,e,r){let n=r.currentOrdinal(),i=Object.assign({},k1,e),s=P1({instance:t,providedFormat:e,state:r}),o=n(t._value);return`${s}${i.spaceSeparated?" ":""}${o}`}function Fje(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),n=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${n<10?"0":""}${n}`}function Hje(t,e,r,n){let i=e.prefixSymbol,s=P1({instance:n(t._value*100),providedFormat:e,state:r}),o=Object.assign({},k1,e);return i?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function Lje(t,e,r){const n=r.currentCurrency();let i=Object.assign({},e),s=Object.assign({},k1,i),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,c=i.currencyPosition||n.position,u=i.currencySymbol||n.symbol;const h=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),c==="infix"&&(o=a+u+a);let f=P1({instance:t,providedFormat:i,state:r,decimalSeparator:o});return c==="prefix"&&(t._value<0&&s.negative==="sign"?f=`-${a}${u}${f.slice(1)}`:t._value>0&&s.forceSign?f=`+${a}${u}${f.slice(1)}`:f=u+a+f),(!c||c==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,f=f+a+u),f}function $je({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:n,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(t),c=-1;if(e&&n[e]&&ni[e]?(a=n[e],t=t/ni[e]):l>=ni.trillion||r&&o(l/ni.trillion)===1?(a=n.trillion,t=t/ni.trillion):l<ni.trillion&&l>=ni.billion||r&&o(l/ni.billion)===1?(a=n.billion,t=t/ni.billion):l<ni.billion&&l>=ni.million||r&&o(l/ni.million)===1?(a=n.million,t=t/ni.million):(l<ni.million&&l>=ni.thousand||r&&o(l/ni.thousand)===1)&&(a=n.thousand,t=t/ni.thousand),a&&(a=(i?" ":"")+a),s){let h=t<0,f=t.toString().split(".")[0],d=h?f.length-1:f.length;c=Math.max(s-d,0)}return{value:t,abbreviation:a,mantissaPrecision:c}}function Bje({value:t,characteristicPrecision:e}){let[r,n]=t.toExponential().split("e"),i=+r;if(!e)return{value:i,abbreviation:`e${n}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),n=+n-(e-s),n=n>=0?`+${n}`:n),{value:i,abbreviation:`e${n}`}}function mS(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function Vje(t,e){let r=t.toString(),[n,i]=r.split("e"),[s,o=""]=n.split(".");if(+i>0)r=s+o+mS(i-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=(mS(-i-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=mS(e-l.length)),r=a+l}return+i>0&&e>0&&(r+=`.${mS(e)}`),r}function Wje(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?Vje(t,e):new kje(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function jje(t,e,r,n,i,s){if(n===-1)return t;let o=Wje(e,n,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(r||i))return a;let c=l.match(/0+$/);return i&&c?`${a}.${l.toString().slice(0,c.index)}`:o.toString()}function Uje(t,e,r,n){let i=t,[s,o]=i.toString().split(".");if(s.match(/^-?0$/)&&r)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),i=i.slice(1)),s.length<n){let l=n-s.length;for(let c=0;c<l;c++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function zje(t,e){let r=[],n=0;for(let i=t;i>0;i--)n===e&&(r.unshift(i),n=0),n++;return r}function Gje(t,e,r,n,i){let s=n.currentDelimiters(),o=s.thousands;i=i||s.decimal;let a=s.thousandsSize||3,l=t.toString(),c=l.split(".")[0],u=l.split(".")[1];const h=e<0&&c.indexOf("-")===0;return r&&(h&&(c=c.slice(1)),zje(c.length,a).forEach((d,g)=>{c=c.slice(0,d+g)+o+c.slice(d+g)}),h&&(c=`-${c}`)),u?l=c+i+u:l=c,l}function Yje(t,e){return t+e}function Kje(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function Xje(t,e){return e+t}function qje(t,e){return t+e}function P1({instance:t,providedFormat:e,state:r=ma,decimalSeparator:n,defaults:i=r.currentDefaults()}){let s=t._value;if(s===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},k1,i,e),a=o.totalLength,l=a?0:o.characteristic,c=o.optionalCharacteristic,u=o.forceAverage,h=o.lowPrecision,f=!!a||!!u||o.average,d=a?-1:f&&e.mantissa===void 0?0:o.mantissa,g=a?!1:e.optionalMantissa===void 0?d===-1:o.optionalMantissa,m=o.trimMantissa,p=o.thousandSeparated,w=o.spaceSeparated,v=o.negative,y=o.forceSign,b=o.exponential,T=o.roundingFunction,E="";if(f){let P=$je({value:s,forceAverage:u,lowPrecision:h,abbreviations:r.currentAbbreviations(),spaceSeparated:w,roundingFunction:T,totalLength:a});s=P.value,E+=P.abbreviation,a&&(d=P.mantissaPrecision)}if(b){let P=Bje({value:s,characteristicPrecision:l});s=P.value,E=P.abbreviation+E}let x=jje(s.toString(),s,g,d,m,T);return x=Uje(x,s,c,l),x=Gje(x,s,p,r,n),(f||b)&&(x=Yje(x,E)),(y||s<0)&&(x=Kje(x,s,v)),x}function am(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var Jje=t=>({format:(...e)=>Pje(...e,t),getByteUnit:(...e)=>Mje(...e,t),getBinaryByteUnit:(...e)=>Oje(...e,t),getDecimalByteUnit:(...e)=>Ije(...e,t),formatOrDefault:am});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const qc=SQ;function Qje(t,e,r){let n=new qc(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new qc(i),t._value=n.plus(i).toNumber(),t}function bQ(t,e,r){let n=new qc(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new qc(i),t._value=n.minus(i).toNumber(),t}function Zje(t,e,r){let n=new qc(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new qc(i),t._value=n.times(i).toNumber(),t}function e6e(t,e,r){let n=new qc(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new qc(i),t._value=n.dividedBy(i).toNumber(),t}function t6e(t,e,r){let n=e;return r.isNumbro(e)&&(n=e._value),t._value=n,t}function r6e(t,e,r){let n=r(t._value);return bQ(n,e,r),Math.abs(n._value)}var n6e=t=>({add:(e,r)=>Qje(e,r,t),subtract:(e,r)=>bQ(e,r,t),multiply:(e,r)=>Zje(e,r,t),divide:(e,r)=>e6e(e,r,t),set:(e,r)=>t6e(e,r,t),difference:(e,r)=>r6e(e,r,t),BigNumber:qc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const i6e="2.5.0",Yl=zL(),s6e=jL(),o6e=Eje(cn),a6e=yQ();let cf=Jje(cn),Lf=n6e(cn);const l6e=UL;class _Q{constructor(e){this._value=e}clone(){return cn(this._value)}format(e={}){return cf.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=l6e.parseFormat(e)),e=cf.formatOrDefault(e,Yl.currentCurrencyDefaultFormat()),e.output="currency",cf.format(this,e)}formatTime(e={}){return e.output="time",cf.format(this,e)}binaryByteUnits(){return cf.getBinaryByteUnit(this)}decimalByteUnits(){return cf.getDecimalByteUnit(this)}byteUnits(){return cf.getByteUnit(this)}difference(e){return Lf.difference(this,e)}add(e){return Lf.add(this,e)}subtract(e){return Lf.subtract(this,e)}multiply(e){return Lf.multiply(this,e)}divide(e){return Lf.divide(this,e)}set(e){return Lf.set(this,EQ(e))}value(){return this._value}valueOf(){return this._value}}function EQ(t){let e=t;return cn.isNumbro(t)?e=t._value:typeof t=="string"?e=cn.unformat(t):isNaN(t)&&(e=NaN),e}function cn(t){return new _Q(EQ(t))}cn.version=i6e;cn.isNumbro=function(t){return t instanceof _Q};cn.language=Yl.currentLanguage;cn.registerLanguage=Yl.registerLanguage;cn.setLanguage=Yl.setLanguage;cn.languages=Yl.languages;cn.languageData=Yl.languageData;cn.zeroFormat=Yl.setZeroFormat;cn.defaultFormat=Yl.currentDefaults;cn.setDefaults=Yl.setDefaults;cn.defaultCurrencyFormat=Yl.currentCurrencyDefaultFormat;cn.validate=s6e.validate;cn.loadLanguagesInNode=o6e.loadLanguagesInNode;cn.unformat=a6e.unformat;cn.BigNumber=Lf.BigNumber;var c6e=cn,uf=sje(c6e);const u6e="numeric";function RQ(t,e){if(Ji(t)){const r=e.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if(typeof n<"u"&&!uf.languages()[n]){const s=n.replace("-",""),o=uf.allLanguages?uf.allLanguages[n]:uf[s];o&&uf.registerLanguage(o)}uf.setLanguage(n),t=uf(t).format(i||"0")}return t}function YL(t,e,r,n,i,s,o){let a=s;if(Ji(a)){let c=[];if(Array.isArray(o.className))c=o.className;else{var l;const u=(l=o.className)!==null&&l!==void 0?l:"";u.length&&(c=u.split(" "))}a=RQ(a,o),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),o.className=c.join(" "),e.dir="ltr"}uu(t,e,r,n,i,a,o)}YL.RENDERER_TYPE=u6e;const h6e="password";function KL(t,e,r,n,i,s,o){uu.apply(this,[t,e,r,n,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let c="";je(a-1,()=>{c+=l}),Xp(e,c)}KL.RENDERER_TYPE=h6e;const f6e="select";function XL(t,e,r,n,i,s,o){uu.apply(this,[t,e,r,n,i,s,o])}XL.RENDERER_TYPE=f6e;const d6e="time";function qL(t,e,r,n,i,s,o){uu.apply(this,[t,e,r,n,i,s,o]),e.dir="ltr"}qL.RENDERER_TYPE=d6e;function g6e(){_o(Zp),_o(T1),_o(BL),_o($L),_o(WL),_o(LL),_o(YL),_o(KL),_o(XL),_o(uu),_o(qL)}const m6e="autocomplete";function GR(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,Nj(r,e)):Nj(r,e)(this.source):e(!0)}GR.VALIDATOR_TYPE=m6e;function Nj(t,e){const r=t;return function(n){let i=!1;for(let s=0,o=n.length;s<o;s++)if(r===n[s]){i=!0;break}e(i)}}function p6e(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const v6e="date";function JL(t,e){const r=zq(hQ,this.instance);let n=t,i=!0;n==null&&(n="");let s=_e(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=_e(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=w6e(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}JL.VALIDATOR_TYPE=v6e;function w6e(t,e){const r=_e(p6e(t)),n=_e(t,e),i=t.search(/[A-Za-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const y6e="dropdown";function QL(t,e){GR.apply(this,[t,e])}QL.VALIDATOR_TYPE=y6e;const C6e="numeric";function ZL(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Ji(t))}ZL.VALIDATOR_TYPE=C6e;const S6e=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],x6e="time";function e$(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=_e(i,S6e,!0).isValid()?_e(i):_e(i,r);let a=o.isValid(),l=_e(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(n=!1),!a&&l&&(n=!0),a&&!l)if(this.correctFormat===!0){const c=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),n=!0}else n=!1;e(n)}e$.VALIDATOR_TYPE=x6e;function b6e(){sm(GR),sm(QL),sm(JL),sm(ZL),sm(e$)}const _6e="autocomplete",E6e={CELL_TYPE:_6e,editor:FL,renderer:Zp,validator:GR},R6e="checkbox",T6e={CELL_TYPE:R6e,editor:uQ,renderer:BL},k6e="date";function TQ(t,e,r,n,i,s,o){Zp.apply(this,[t,e,r,n,i,s,o])}TQ.RENDERER_TYPE=k6e;const P6e="date",A6e={CELL_TYPE:P6e,editor:fQ,renderer:TQ,validator:JL},I6e="dropdown",O6e={CELL_TYPE:I6e,editor:dQ,renderer:$L,validator:QL,filter:!1,strict:!0},M6e="handsontable",N6e={CELL_TYPE:M6e,editor:DL,renderer:WL},D6e="numeric",F6e={CELL_TYPE:D6e,editor:gQ,renderer:YL,validator:ZL,dataType:"number"},H6e="password",L6e={CELL_TYPE:H6e,editor:mQ,renderer:KL,copyable:!1},$6e="select",B6e={CELL_TYPE:$6e,editor:pQ,renderer:XL},V6e="time",W6e={CELL_TYPE:V6e,editor:vQ,renderer:qL,validator:e$};function j6e(){fa(E6e),fa(T6e),fa(A6e),fa(O6e),fa(N6e),fa(F6e),fa(L6e),fa(B6e),fa(ZJ),fa(W6e)}function U6e(t,e){kQ(t,e),e.add(t)}function z6e(t,e,r){kQ(t,e),e.set(t,r)}function kQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tg(t,e,r){return(e=G6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G6e(t){var e=Y6e(t,"string");return typeof e=="symbol"?e:e+""}function Y6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kg(t,e){return t.get(PQ(t,e))}function PQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Dj=new Map([["plugin",kHe],["cell-type",BJ],["editor",Uq],["renderer",eJ],["validator",tJ]]),AQ=Symbol("mainSetting"),K6e="base",pS=[];let hf=null;var ff=new WeakMap,Fj=new WeakSet;class Gt{static get PLUGIN_KEY(){return K6e}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){U6e(this,Fj),Tg(this,"eventManager",new Ba(this)),Tg(this,"pluginName",null),Tg(this,"pluginsInitializedCallbacks",[]),Tg(this,"isPluginsReady",!1),Tg(this,"enabled",!1),Tg(this,"initialized",!1),z6e(this,ff,{}),lu(this,"hot",e,{writable:!1}),hf=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[o,a]=s.split(":");if(!Dj.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);Dj.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");pS.push(s)}}if(hf||(hf=Zq()),hf.indexOf(this.pluginName)>=0&&hf.splice(hf.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),hf.length===0){if(pS.length>0){const i=[`${pS.join(`
`)}
`,"You have to import and register them manually."].join("");throw pS.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||Ct(r))&&n[AQ]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(Ct(r)){var s;return(s=r[e])!==null&&s!==void 0?s:n[e]}return n[e]}addHook(e,r,n){kg(ff,this)[e]=kg(ff,this)[e]||[];const i=kg(ff,this)[e];this.hot.addHook(e,r,n),i.push(r),kg(ff,this)[e]=i}removeHooks(e){Z(kg(ff,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=kg(ff,this);St(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Z(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=PQ(Fj,this,X6e).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),St(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function X6e(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function df(t,e,r){return(e=q6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q6e(t){var e=J6e(t,"string");return typeof e=="symbol"?e:e+""}function J6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let IQ=class{constructor(e){df(this,"hot",null),df(this,"container",null),df(this,"injected",!1),df(this,"rows",[]),df(this,"columns",[]),df(this,"samples",null),df(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Se(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Z(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),Z(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{Z(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{Z(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),c=this.hot.getCellRenderer(l),u=r.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),o.value,l),n.appendChild(u)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{Z(i.strings,s=>{const o=s.col,a=e.createElement("th");n.push([o,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),Z(n,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{Z(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),c=r.createElement("td"),u=r.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,o,e,this.hot.colToProp(e),s.value,a),u.appendChild(c),n.appendChild(u)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return n.style.width=`${s}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),o=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),c=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(c),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),Se(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return Se(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function vS(t,e,r){return(e=Q6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q6e(t){var e=Z6e(t,"string");return typeof e=="symbol"?e:e+""}function Z6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YR{static get SAMPLE_COUNT(){return 3}constructor(e){vS(this,"samples",null),vS(this,"dataFactory",null),vS(this,"customSampleCount",null),vS(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:YR.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:o}=typeof n=="number"?{from:n,to:n}:n;return je(s,o,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return je(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:c,bundleSeed:u}=l,h=typeof u=="string"&&u.length>0;let f;h?f=u:Ct(c)?f=`${Object.keys(c).length}`:Array.isArray(c)?f=`${c.length}`:f=`${Fr(c).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const d=i.get(f);d.needed&&(!(o.indexOf(c)>-1)||this.allowDuplicates||h)&&(d.strings.push({value:c,[s]:a}),o.push(c),d.needed-=1)}),i}}function eUe(t,e){OQ(t,e),e.add(t)}function iA(t,e,r){OQ(t,e),e.set(t,r)}function OQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W0(t,e,r){return(e=tUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tUe(t){var e=rUe(t,"string");return typeof e=="symbol"?e:e+""}function rUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sh(t,e){return t.get(ys(t,e))}function M_(t,e,r){return t.set(ys(t,e),r),r}function ys(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("modifyAutoColumnSizeSeed");const sA="autoColumnSize",nUe=10,iUe="autoColumnSize";var t$=new WeakMap,lm=new WeakMap,kp=new WeakMap,Ws=new WeakSet;class cw extends Gt{static get PLUGIN_KEY(){return sA}static get PLUGIN_PRIORITY(){return nUe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),eUe(this,Ws),W0(this,"ghostTable",new IQ(this.hot)),W0(this,"samplesGenerator",new YR((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(r,n);let a="";o.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),W0(this,"inProgress",!1),W0(this,"measuredColumns",0),W0(this,"columnWidthsMap",new jh),iA(this,t$,!1),iA(this,lm,[]),iA(this,kp,[]),this.hot.columnIndexMapper.registerMap(iUe,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>ys(Ws,this,Hj).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[sA]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ys(Ws,e,aUe).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ys(Ws,e,lUe).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ys(Ws,e,uUe).call(e,...i)}),this.addHook("beforeRender",()=>ys(Ws,this,oUe).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>ys(Ws,this,cUe).call(this)),super.enablePlugin()}updatePlugin(){M_(kp,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>ys(Ws,this,Hj).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;je(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&ys(Ws,this,MQ).call(this,o,s)}),this.ghostTable.columns.length&&(ys(Ws,this,NQ).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){C_(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+cw.CALCULATION_STEP,i)},e,r),n=n+cw.CALCULATION_STEP+1,n<i?s=y_(o):(C_(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[sA];let r=cw.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Ct(e)&&(r=e.syncLimit,cq(r)?r=qq(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Sp))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,s)=>{const o=sh(lm,this).length;return(o-1<s||sh(lm,this)[s]!==i)&&n.push(this.hot.toVisualColumn(s)),o-1<s?sh(lm,this).push(i):sh(lm,this)[s]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function sUe(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||ys(Ws,this,MQ).call(this,r,e))}),this.ghostTable.columns.length&&(ys(Ws,this,NQ).call(this),this.ghostTable.clean())}function MQ(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function NQ(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function oUe(){this.calculateVisibleColumnsWidth(),this.inProgress||(ys(Ws,this,sUe).call(this,sh(kp,this)),M_(kp,this,[]))}function aUe(t,e){e||this.recalculateAllColumnsWidth()}function lUe(t){const e=t.reduce((r,n)=>{let[,i]=n;const s=this.hot.propToCol(i);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);sh(kp,this).push(...e)}function Hj(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function cUe(){M_(lm,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),M_(t$,this,!0)}function uUe(t){if(!sh(t$,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);sh(kp,this).push(...e)}const Zf={horizontal:"horizontal",vertical:"vertical"};function hUe(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function fUe(t){const e={};return t===!0?(e.directions=Object.keys(Zf),e.autoInsertRow=!0):Ct(t)?(Le(t.autoInsertRow)?t.direction===Zf.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Zf)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function dUe(t,e){gUe(t,e),e.add(t)}function gUe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pg(t,e,r){return(e=mUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mUe(t){var e=pUe(t,"string");return typeof e=="symbol"?e:e+""}function pUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("modifyAutofillRange");Fe.getSingleton().register("beforeAutofill");Fe.getSingleton().register("afterAutofill");const Lj="autofill",vUe=20,wUe=["fillHandle"],yUe="insert_row_below",CUe=200;var Ag=new WeakSet;class SUe extends Gt{constructor(){super(...arguments),dUe(this,Ag),Pg(this,"addingStarted",!1),Pg(this,"mouseDownOnCellCorner",!1),Pg(this,"mouseDragOutside",!1),Pg(this,"handleDraggedCells",0),Pg(this,"directions",[]),Pg(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return Lj}static get PLUGIN_PRIORITY(){return vUe}static get SETTING_KEYS(){return[Lj,...wUe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>j0(Ag,this,bUe).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>j0(Ag,this,xUe).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>j0(Ag,this,_Ue).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:n,endRow:i,endCol:s}]),a=[],l=[],c=[];return Z(o,u=>{for(let h=u.startRow;h<=u.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=u.startCol;h<=u.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),Z(a,u=>{const h=[];Z(l,f=>{h.push(this.hot.getCopyableData(u,f))}),c.push(h)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(a.row,n),Math.max(a.col,i)],l),{directionOfDrag:u,startOfDragCoords:h,endOfDragCoords:f}=hUe(l,c,(d,g)=>this.hot._createCellCoords(d,g));if(h&&h.row>-1&&h.col>-1){const d=this.getSelectionData(),g=s.clone(),m=this.hot._createCellRange(h,h,f),p=this.hot.runHooks("beforeAutofill",d,g,m,u);if(p===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let w=p;const v=p;if(["up","left"].indexOf(u)>-1&&!(v.length===1&&v[0].length===0))if(w=[],u==="up"){const y=f.row-h.row+1,b=y%v.length;for(let T=0;T<y;T++)w.push(v[(T+(v.length-b))%v.length])}else{const y=f.col-h.col+1,b=y%v[0].length;for(let T=0;T<v.length;T++){w.push([]);for(let E=0;E<y;E++)w[T].push(v[T][(E+(v[T].length-b))%v[T].length])}}this.hot.populateFromArray(h.row,h.col,w,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",w,g,m,u),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(Zf.vertical)&&this.directions.includes(Zf.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(Zf.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(Zf.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(yUe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},CUe)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let l=e[1];l<=e[3];l++){const c=r[s][l];if(!an(c))return-1}const o=r[s][e[1]-1],a=r[s][e[3]+1];(!an(o)||!an(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...At(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=Ai(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+An(this.hot.table),i=Ai(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+mn(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>j0(Ag,this,EUe).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>j0(Ag,this,RUe).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=fUe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function xUe(){this.selectAdjacent()&&this.fillIn()}function bUe(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _Ue(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function EUe(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function RUe(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function TUe(t,e){DQ(t,e),e.add(t)}function $j(t,e,r){DQ(t,e),e.set(t,r)}function DQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ig(t,e,r){return(e=kUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kUe(t){var e=PUe(t,"string");return typeof e=="symbol"?e:e+""}function PUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FQ(t,e,r){return t.set(xl(t,e),r),r}function N_(t,e){return t.get(xl(t,e))}function xl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oA="autoRowSize",AUe=40,IUe="autoRowSize";var Ty=new WeakMap,r$=new WeakMap,uc=new WeakSet;class uw extends Gt{static get PLUGIN_KEY(){return oA}static get PLUGIN_PRIORITY(){return AUe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),TUe(this,uc),Ig(this,"headerHeight",null),Ig(this,"ghostTable",new IQ(this.hot)),Ig(this,"samplesGenerator",new YR((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||r>=0&&n>=0&&this.hot.getCellMeta(r,n).hidden)return!1;let o;return r>=0?o=this.hot.getDataAtCell(r,n):r===-1&&(o=this.hot.getColHeader(n)),{value:o}})),Ig(this,"inProgress",!1),Ig(this,"measuredRows",0),Ig(this,"rowHeightsMap",new jh),$j(this,Ty,[]),$j(this,r$,!1),this.hot.rowIndexMapper.registerMap(IUe,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>xl(uc,this,Bj).call(this,r,n,i))}isEnabled(){const e=this.hot.getSettings()[oA];return e===!0||Ct(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return xl(uc,e,NUe).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return xl(uc,e,DUe).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return xl(uc,e,HUe).call(e,...i)}),this.addHook("beforeRender",()=>xl(uc,this,MUe).call(this)),this.addHook("modifyRowHeight",(n,i)=>this.getRowHeight(i,n)),this.addHook("init",()=>xl(uc,this,FUe).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,n)=>xl(uc,this,Bj).call(this,e,r,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:r},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}je(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(n||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((c,u)=>this.ghostTable.addRow(u,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){C_(s),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+uw.CALCULATION_STEP,i)},e,r),n=n+uw.CALCULATION_STEP+1,n<i?s=y_(o):(C_(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,r),n=a+1),n<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[oA];let r=uw.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return Ct(e)&&(r=e.syncLimit,cq(r)?r=qq(n,r):r>>=0),Math.min(r,n)}getRowHeight(e,r){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=r;return n!==null&&n>(r||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{je(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function OUe(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{const i=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function MUe(){this.calculateVisibleRowsHeight(),this.inProgress||(xl(uc,this,OUe).call(this,N_(Ty,this)),FQ(Ty,this,[]))}function Bj(t,e,r){let n=t;return r&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function NUe(t,e){e||this.recalculateAllRowsHeight()}function DUe(t){const e=t.reduce((r,n)=>{let[i]=n;return r.indexOf(i)===-1&&r.push(i),r},[]);N_(Ty,this).push(...e)}function FUe(){this.recalculateAllRowsHeight(),FQ(r$,this,!0)}function HUe(t){if(!N_(r$,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);N_(Ty,this).push(...e)}const{getListWithInsertedItems:LUe,getListWithRemovedItems:$Ue}=xJ("physicallyIndexed");class BUe extends og{constructor(){super(e=>e)}insert(e,r){const n=aH(this.indexedValues,r);this.indexedValues=LUe(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=$Ue(this.indexedValues,e);this.indexedValues=oH(r,e),super.remove(e)}}const{getListWithInsertedItems:VUe,getListWithRemovedItems:WUe}=xJ("physicallyIndexed");class jUe extends og{constructor(){super(e=>e)}insert(e,r){this.indexedValues=VUe(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=WUe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function UUe(t,e){zUe(t,e),e.add(t)}function zUe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GUe(t,e,r){return(e=YUe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YUe(t){var e=KUe(t,"string");return typeof e=="symbol"?e:e+""}function KUe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XUe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Vj="bindRowsWithHeaders",qUe=210,JUe="loose",Wj=new Map([["loose",BUe],["strict",jUe]]);var jj=new WeakSet;class QUe extends Gt{constructor(){super(...arguments),UUe(this,jj),GUe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Vj}static get PLUGIN_PRIORITY(){return qUe}isEnabled(){return!!this.hot.getSettings()[Vj]}enablePlugin(){var e;if(this.enabled)return;const r=(e=Wj.get(this.getSetting()))!==null&&e!==void 0?e:Wj.get(JUe);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>XUe(jj,this,ZUe).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function ZUe(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function e5e(t,e){HQ(t,e),e.add(t)}function t5e(t,e,r){HQ(t,e),e.set(t,r)}function HQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uj(t,e,r){return(e=r5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r5e(t){var e=n5e(t,"string");return typeof e=="symbol"?e:e+""}function n5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zj(t,e){return t.get(Nm(t,e))}function aA(t,e,r){return t.set(Nm(t,e),r),r}function Nm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const qx="collapsibleColumns",i5e=290,s5e=["nestedHeaders"],ep="collapsibleIndicator",Gj=qx,Yj=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Og=new WeakMap,U0=new WeakSet;class o5e extends Gt{constructor(){super(...arguments),e5e(this,U0),Uj(this,"nestedHeadersPlugin",null),Uj(this,"headerStateManager",null),t5e(this,Og,null)}static get PLUGIN_KEY(){return qx}static get PLUGIN_PRIORITY(){return i5e}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[qx,...s5e]}isEnabled(){return!!this.hot.getSettings()[qx]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||zt("You need to configure the Nested Headers plugin in order to use collapsible headers."),aA(Og,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Nm(U0,this,c5e).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Nm(U0,e,u5e).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Nm(U0,e,a5e).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>Nm(U0,this,l5e).call(this,n,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),aA(Og,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,n))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:Gj,relativeToGroup:Uh,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Gj)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};je(0,e-1,o=>{const a=r.childNodes[o],l=n.childNodes[o],c=i?i.childNodes[o]:null;je(0,a.childNodes.length-1,u=>{let h=a.childNodes[u].querySelector(`.${ep}`);s(h),l&&l.childNodes[u]&&(h=l.childNodes[u].querySelector(`.${ep}`),s(h)),i&&c&&c.childNodes[u]&&(h=c.childNodes[u].querySelector(`.${ep}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=n;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!Yj.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=Od(e,d=>{let{row:g}=d;return g<0});let i=n.length>0;Z(n,d=>{var g;let{row:m,col:p}=d;const{collapsible:w,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(m,p))!==null&&g!==void 0?g:{};if(!w||v&&r==="collapse"||!v&&r==="expand")return i=!1,!1});const s=[],o=[];i&&Z(n,d=>{let{row:g,col:m}=d;const{colspanCompensation:p,affectedColumns:w,rollbackModification:v}=this.headerStateManager.triggerNodeModification(r,g,m);p>0&&(o.push(...w),s.push(v))});const a=this.getCollapsedColumns();let l=[];r==="collapse"?l=dNe([...a,...o]):r==="expand"&&(l=Od(a,d=>!o.includes(d)));const c=Yj.get(r);if(this.hot.runHooks(c.beforeHook,a,l,i)===!1){Z(s,d=>{d()});return}this.hot.batchExecution(()=>{Z(o,d=>{zj(Og,this).setValueAtIndex(this.hot.toPhysicalColumn(d),c.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,f=this.hot.getSelectedRangeLast();if(r==="collapse"&&h&&f){const{row:d,col:g}=f.highlight;if((this.hot.rowIndexMapper.isHidden(d)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const p=d>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(d,1,!0):d,w=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;p!==null&&w!==null&&this.hot.selectCell(p,w)}}this.hot.runHooks(c.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return zj(Og,this).getHiddenIndexes()}destroy(){aA(Og,this,null),super.destroy()}}function a5e(t,e,r){var n;const{collapsible:i,origColspan:s,isCollapsed:o}=(n=this.headerStateManager.getHeaderSettings(r,t))!==null&&n!==void 0?n:{},a=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${ep}`);if(Kp(e,[jo("")[0]]),a)c||(c=this.hot.rootDocument.createElement("div"),Se(c,ep),e.querySelector("div:first-child").appendChild(c)),Je(c,["collapsed","expanded"]),o?(Se(c,"collapsed"),Nd(c,"+"),l&&et(e,...jo(!1))):(Se(c,"expanded"),Nd(c,"-"),l&&et(e,...jo(!0))),l&&et(c,...sg());else{var u;(u=c)===null||u===void 0||u.remove()}}function l5e(t,e){tt(t.target,ep)&&(tt(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):tt(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ua(t))}function c5e(){this.updatePlugin()}function u5e(t,e){e||this.updatePlugin()}function gf(t,e,r){return(e=h5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h5e(t){var e=f5e(t,"string");return typeof e=="symbol"?e:e+""}function f5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const d5e=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],g5e=!1,m5e=!0,p5e=!0;class v5e{constructor(e,r){gf(this,"hot",void 0),gf(this,"sortingStates",new LR),gf(this,"sortEmptyCells",g5e),gf(this,"indicator",m5e),gf(this,"headerAction",p5e),gf(this,"compareFunctionFactory",void 0),gf(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){Ct(e)&&St(e,(r,n)=>{d5e.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ct(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(Le(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function LQ(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:o}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?Fl:an(i)?an(s)?Fl:o&&t==="asc"?jr:Ur:an(s)?o&&t==="asc"?Ur:jr:isNaN(i)&&!isNaN(s)?t==="asc"?Ur:jr:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?jr:Ur:i>s?t==="asc"?Ur:jr:Fl}}const $Q="default";function w5e(t,e,r){return function(n,i){const s=parseFloat(n),o=parseFloat(i),{sortEmptyCells:a}=r;if(s===o||isNaN(s)&&isNaN(o))return Fl;if(a){if(an(n))return t==="asc"?jr:Ur;if(an(i))return t==="asc"?Ur:jr}return isNaN(s)?Ur:isNaN(o)?jr:s<o?t==="asc"?jr:Ur:s>o?t==="asc"?Ur:jr:Fl}}const y5e="numeric";function C5e(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(o,a){const l=an(o),c=an(a),u=l?i:o,h=c?i:a,f=u===i||u===n,d=h===i||h===n;if(s===!1){if(l&&c===!1)return Ur;if(l===!1&&c)return jr}return f===!1&&d?t==="asc"?jr:Ur:f&&d===!1?t==="asc"?Ur:jr:f===!1&&d===!1?LQ(t,e,r)(o,a):u===i&&h===n?t==="asc"?jr:Ur:u===n&&h===i?t==="asc"?Ur:jr:Fl}}const S5e="checkbox";function x5e(t,e,r){return zQ(t,e.dateFormat,r)}const b5e="date";function _5e(t,e,r){return zQ(t,e.timeFormat,r)}const E5e="time",{register:A1,getItem:Kj,hasItem:R5e}=Zo("sorting.compareFunctionFactory"),{register:BQ,getItem:T5e}=Zo("sorting.mainSortComparator");function VQ(t){return R5e(t)?Kj(t):Kj($Q)}A1(S5e,C5e);A1(b5e,x5e);A1($Q,LQ);A1(y5e,w5e);A1(E5e,_5e);const Fl=0,jr=-1,Ur=1;function k5e(t,e){const r=T5e(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}const D_="asc",F_="desc",WQ="colHeader";function P5e(t){if(Ct(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[D_,F_].includes(r)}function A5e(t){if(t.some(r=>P5e(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function Xj(t){if(t!==F_)return t===D_?F_:D_}function jQ(t){return t.querySelector(`.${WQ}`)}function UQ(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function n$(t,e,r){return t===-1&&e>=0&&Dd(r)===!1}function zQ(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return Fl;if(an(n))return an(i)?Fl:s&&t==="asc"?jr:Ur;if(an(i))return s&&t==="asc"?Ur:jr;const o=_e(n,e),a=_e(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?jr:Ur:a.isBefore(o)?t==="asc"?Ur:jr:Fl:jr:Ur}}function I5e(t,e){zt(Qt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const O5e="ascending",M5e="descending",GQ="indicatorDisabled",YQ="columnSorting",KQ="sortAction",XQ=new Map([[D_,O5e],[F_,M5e]]);function N5e(t,e,r,n){const i=[YQ];if(n&&i.push(KQ),r===!1)return i.push(GQ),i;const s=t.getSortOrderOfColumn(e);return Le(s)&&i.push(XQ.get(s)),i}function D5e(){return Array.from(XQ.values()).concat(KQ,GQ,YQ)}function F5e(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(a){const l=t[a],c=e[a],u=i[a],h=s[a],f=c.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:VQ(c.type))(l,c,f)(u,h)}(0)}}function H5e(t,e){L5e(t,e),e.add(t)}function L5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wS(t,e,r){return(e=$5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $5e(t){var e=B5e(t,"string");return typeof e=="symbol"?e:e+""}function B5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const H_="columnSorting",V5e=50,L_="append",W5e="replace",qj=H_;BQ(H_,F5e);Fe.getSingleton().register("beforeColumnSort");Fe.getSingleton().register("afterColumnSort");const z0=new WeakMap;var $f=new WeakSet;class qQ extends Gt{constructor(){super(...arguments),H5e(this,$f),wS(this,"columnStatesManager",null),wS(this,"columnMetaCache",null),wS(this,"pluginKey",H_),wS(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return H_}static get PLUGIN_PRIORITY(){return V5e}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(z0.has(this.hot)&&z0.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),I5e(z0.get(this.hot),this.pluginKey);return}this.enabled||(z0.set(this.hot,this.pluginKey),this.columnStatesManager=new v5e(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new jh(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>cm($f,this,j5e).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return cm($f,e,z5e).call(e,...n)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>cm($f,this,e2).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return cm($f,e,U5e).call(e,...n)}),this.hot.view&&cm($f,this,e2).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=jQ(n);UQ(r,n)===!1||i===null||this.updateHeaderClasses(i)};z0.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:Uh,position:"before",group:qj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qj)}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new bJ),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return A5e(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};r.initialConfig=At(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return Le(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=At(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(Le(r)){const i=Xj(r);return Le(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:Xj()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:L_;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(Dr(o))return[...s.slice(0,n),...s.slice(n+1)];if(r===L_)return[...s.slice(0,n),...s.slice(n+1),o];if(r===W5e)return[...s.slice(0,n),o,...s.slice(n+1)]}return Le(o)?s.concat(o):s}getPluginColumnConfig(e){if(Ct(e)){const r=e[this.pluginKey];if(Ct(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):er(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],n=this.hot.countRows(),i=c=>At(e,u=>this.hot.getDataAtCell(c,u.column));for(let c=0;c<this.getNumberOfRowsToSort(n);c+=1)r.push([this.hot.toPhysicalRow(c)].concat(i(c)));const s=At(r,c=>c[0]);k5e(r,this.pluginKey,At(e,c=>c.sortOrder),At(e,c=>this.getFirstCellSettings(c.column)));for(let c=r.length;c<n;c+=1)r.push([c].concat(i(c)));const o=At(r,c=>c[0]),a=new Map(At(s,(c,u)=>[c,o[u]])),l=At(this.hot.rowIndexMapper.getIndexesSequence(),c=>a.has(c)?a.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ct(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||Ct(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(Je(e,D5e()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];Se(e,N5e(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&tt(e.target,WQ)}onAfterOnCellMouseDown(e,r){if(n$(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const n=this.hot.getActiveEditor(),i=this.getColumnNextConfig(r.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function e2(){const t=this.getAllSavedSortSettings();if(Ct(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function j5e(t,e){const r=jQ(e);if(UQ(t,e)===!1||r===null)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);et(e,...DNe(o?`${o}ending`:"none"))}}function U5e(t){t===!0&&this.hot.view&&cm($f,this,e2).call(this)}function z5e(t,e,r,n){n$(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function mf(t,e,r){return(e=G5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G5e(t){var e=Y5e(t,"string");return typeof e=="symbol"?e:e+""}function Y5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K5e{constructor(e,r){mf(this,"plugin",void 0),mf(this,"hot",void 0),mf(this,"endpoints",[]),mf(this,"settings",void 0),mf(this,"settingsType","array"),mf(this,"currentEndpoint",null),mf(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),Z(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();Z(s,o=>{i==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=n:e==="remove_row"&&(o.alterRowOffset=-1*n)),i==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=n:e==="remove_col"&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),u=e.indexOf("move_row")===0,h=r;Z(c,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*n),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*n)}),this.resetAllEndpoints(c,!u),u?Z(c,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):Z(c,f=>{this.shiftEndpointCoordinates(f,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){Z(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];Z(r,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),Z(i,s=>{let o=[];Z(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),n.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),n.push(o))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,Z(e.ranges,n=>{Z(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],Z(e,i=>{this.resetEndpointValue(i,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Z(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],Z(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&Z(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&r.indexOf(a)===-1&&r.push(a)})}),Z(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const n=this.hot.getCellMeta(r,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){zt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function lA(t){return t==null||isNaN(t)}function X5e(t,e){q5e(t,e),e.add(t)}function q5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J5e(t,e,r){return(e=Q5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q5e(t){var e=Z5e(t,"string");return typeof e=="symbol"?e:e+""}function Z5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cA="columnSummary",eze=220;var G0=new WeakSet;class tze extends Gt{constructor(){super(...arguments),X5e(this,G0),J5e(this,"endpoints",null)}static get PLUGIN_KEY(){return cA}static get PLUGIN_PRIORITY(){return eze}isEnabled(){return!!this.hot.getSettings()[cA]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[cA],this.endpoints=new K5e(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return yS(G0,e,rze).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return yS(G0,e,ize).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return yS(G0,e,nze).call(e,...n)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return yS(G0,e,sze).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return St(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,r),s=lA(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,r){let n=null;return St(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,r),o=lA(o)?null:o,i===null)i=o;else if(o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=lA(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return St(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);r+=s,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),o="";if(n!==null&&i!==null&&(o=this.hot.getCellMeta(n,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Qt`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function rze(){this.endpoints.initEndpoints()}function nze(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function ize(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function sze(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function oze(t,e){JQ(t,e),e.add(t)}function uA(t,e,r){JQ(t,e),e.set(t,r)}function JQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function um(t,e){return t.get(i$(t,e))}function t2(t,e,r){return t.set(i$(t,e),r),r}function i$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $_=new WeakMap,CS=new WeakMap,SS=new WeakMap,Jj=new WeakSet;class QQ{constructor(){oze(this,Jj),uA(this,$_,!0),uA(this,CS,null),uA(this,SS,new ResizeObserver(e=>i$(Jj,this,aze).call(this,e)))}setObservedElement(e){t2(CS,this,e)}unobserve(){um(SS,this).unobserve(um(CS,this))}observe(){t2($_,this,!0),um(SS,this).observe(um(CS,this))}destroy(){um(SS,this).disconnect()}}function aze(t){if(um($_,this)||!Array.isArray(t)||!t.length){t2($_,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:n,blockSize:i}=r[0];this.runLocalHooks("resize",n,i)})}ur(QQ,fi);function Cu(t,e,r){lze(t,e),e.set(t,r)}function lze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nr(t,e){return t.get(ZQ(t,e))}function nl(t,e,r){return t.set(ZQ(t,e),r),r}function ZQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Mg=new WeakMap,hA=new WeakMap,fA=new WeakMap,nc=new WeakMap,Su=new WeakMap,xu=new WeakMap,xS=new WeakMap,Ng=new WeakMap;class ed{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r,n){var i=this;Cu(this,Mg,void 0),Cu(this,hA,void 0),Cu(this,fA,!1),Cu(this,nc,null),Cu(this,Su,void 0),Cu(this,xu,void 0),Cu(this,xS,!0),Cu(this,Ng,new QQ),nl(Mg,this,e),nl(hA,this,n),nl(fA,this,r),nl(Su,this,this.createEditor()),nl(xu,this,nr(Su,this).style),nr(Ng,this).setObservedElement(this.getInputElement()),nr(Ng,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,r){nr(xu,this).left=`${e}px`,nr(xu,this).top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:mn(this.getInputElement()),height:An(this.getInputElement())}}observeSize(){nr(Ng,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){nr(xu,this).display="block",nl(xS,this,!1)}hide(){nr(Ng,this).unobserve(),nr(xS,this)||(nr(xu,this).display="none"),nl(xS,this,!0)}isVisible(){return nr(xu,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return nr(Mg,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=nr(Mg,this).createElement("div"),r=nr(Mg,this).createElement("textarea");return e.style.display="none",nl(nc,this,nr(Mg,this).createElement("div")),nr(nc,this).setAttribute("dir",nr(fA,this)?"rtl":"ltr"),Se(nr(nc,this),ed.CLASS_EDITOR_CONTAINER),nr(hA,this).appendChild(nr(nc,this)),Se(e,ed.CLASS_EDITOR),Se(r,ed.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),nr(nc,this).appendChild(e),e}getInputElement(){return nr(Su,this).querySelector(`.${ed.CLASS_INPUT}`)}getEditorElement(){return nr(Su,this)}destroy(){const e=nr(nc,this)?nr(nc,this).parentNode:null;nr(Su,this).parentNode.removeChild(nr(Su,this)),nl(Su,this,null),nl(xu,this,null),nr(Ng,this).destroy(),e&&e.removeChild(nr(nc,this))}}ur(ed,fi);function dA(t,e,r){return(e=cze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cze(t){var e=uze(t,"string");return typeof e=="symbol"?e:e+""}function uze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hze=250,fze=250;class eZ{constructor(e){dA(this,"wasLastActionShow",!0),dA(this,"showDebounced",null),dA(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},fze)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hze;this.showDebounced=OR(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}ur(eZ,fi);function dze(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function gze(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function pf(t,e){const r={};return Z(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function Du(t,e,r,n,i){Z(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&mze(o,a,e,r,n,i)})})}function mze(t,e,r,n,i,s){const o=i(t,e);let a=n;o.className&&(r==="vertical"?a=dze(o.className,n):a=gze(o.className,n)),s(t,e,"className",a)}function tZ(t){return`<span class="selected">✓</span>${t}`}function Jx(t,e){let r=!1;return Array.isArray(t)&&Z(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function KR(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:s}=n.getBoundingClientRect();r.top=i,r.left=s}return r}const yt="---------";function pze(){return{name:yt}}const Ao="alignment";function vze(){return{key:Ao,name(){return this.getTranslatedPhrase(OH)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ao}:left`,name(){return this.getTranslatedPhrase(MH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Du(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ao}:center`,name(){return this.getTranslatedPhrase(NH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Du(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ao}:right`,name(){return this.getTranslatedPhrase(DH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Du(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ao}:justify`,name(){return this.getTranslatedPhrase(FH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Du(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:yt},{key:`${Ao}:top`,name(){return this.getTranslatedPhrase(HH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Du(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ao}:middle`,name(){return this.getTranslatedPhrase(LH)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Du(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Ao}:bottom`,name(){return this.getTranslatedPhrase($H)},callback(){const t=this.getSelectedRange(),e=pf(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Du(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const XR="clear_column";function wze(){return{key:XR,name(){return this.getTranslatedPhrase(wH)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const I1="col_left";function yze(){return{key:I1,name(){return this.getTranslatedPhrase(fH)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const O1="col_right";function Cze(){return{key:O1,name(){return this.getTranslatedPhrase(dH)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const M1="make_read_only";function Sze(){return{key:M1,checkable:!0,ariaChecked(){return Jx(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(E_)},name(){let t=this.getTranslatedPhrase(E_);return Jx(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=tZ(t)),t},callback(){const t=this.getSelectedRange(),e=Jx(t,(r,n)=>this.getCellMeta(r,n).readOnly);Z(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const qR="redo";function xze(){return{key:qR,name(){return this.getTranslatedPhrase(vH)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const N1="remove_col";function bze(){return{key:N1,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(mH,e)},callback(){this.alter("remove_col",bBe(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const JR="remove_row";function _ze(){return{key:JR,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(gH,e)},callback(){this.alter("remove_row",_Be(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const QR="row_above";function Eze(){return{key:QR,name(){return this.getTranslatedPhrase(uH)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const ZR="row_below";function Rze(){return{key:ZR,name(){return this.getTranslatedPhrase(hH)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const ky="no_items";function Tze(){return{key:ky,name(){return this.getTranslatedPhrase(cH)},disabled:!0,isCommand:!1}}const eT="undo";function kze(){return{key:eT,name(){return this.getTranslatedPhrase(pH)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Pze=[QR,ZR,I1,O1,XR,JR,N1,eT,qR,M1,Ao,yt,ky],Aze={[yt]:pze,[ky]:Tze,[QR]:Eze,[ZR]:Rze,[I1]:yze,[O1]:Cze,[XR]:wze,[JR]:_ze,[N1]:bze,[eT]:kze,[qR]:xze,[M1]:Sze,[Ao]:vze};function rZ(){const t={};return St(Aze,(e,r)=>{t[r]=e()}),t}function Ize(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(PH):this.getTranslatedPhrase(kH)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Oze(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(AH)},callback(){this.getSelectedRangeLast().forAll((r,n)=>{r>=0&&n>=0&&t.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Mze(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(IH);return Jx(this.getSelectedRange(),(n,i)=>t.getCommentMeta(n,i,Qx))?tZ(e):e},callback(){this.getSelectedRangeLast().forAll((r,n)=>{if(r>=0&&n>=0){const i=!!t.getCommentMeta(r,n,Qx);t.updateCommentMeta(r,n,{[Qx]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Nze(t,e){nZ(t,e),e.add(t)}function Dg(t,e,r){nZ(t,e),e.set(t,r)}function nZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dze(t,e,r){return(e=Fze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fze(t){var e=Hze(t,"string");return typeof e=="symbol"?e:e+""}function Hze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oh(t,e,r){return t.set(Vs(t,e),r),r}function wt(t,e){return t.get(Vs(t,e))}function Vs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const B_="comments",Lze=60,pc="comment",Ov="value",iZ="style",Qx="readOnly",Y0=B_,r2=`plugin:${B_}`;var sr=new WeakMap,yl=new WeakMap,tT=new WeakMap,Zx=new WeakMap,n2=new WeakMap,V_=new WeakMap,Co=new WeakSet;class $ze extends Gt{constructor(){super(...arguments),Nze(this,Co),Dze(this,"range",{}),Dg(this,sr,null),Dg(this,yl,null),Dg(this,tT,!1),Dg(this,Zx,!1),Dg(this,n2,null),Dg(this,V_,"")}static get PLUGIN_KEY(){return B_}static get PLUGIN_PRIORITY(){return Lze}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[B_]}enablePlugin(){var e=this;this.enabled||(wt(sr,this)||(oh(sr,this,new ed(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),wt(sr,this).addLocalHook("resize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vs(Co,e,Yze).call(e,...n)}),this.hot.addHook("afterSetTheme",(r,n)=>{n||this.hide()})),wt(yl,this)||oh(yl,this,new eZ(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,i,s,o,a)=>Vs(Co,this,Uze).call(this,r,a)),this.addHook("afterScroll",()=>Vs(Co,this,Kze).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>Vs(Co,this,Qj).call(this,r)),this.addHook("beforeCompositionStart",r=>Vs(Co,this,Qj).call(this,r)),wt(yl,this).addLocalHook("hide",()=>this.hide()),wt(yl,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){wt(yl,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),n=e.addContext(r2);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();oh(Zx,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(r2),this.hot._registerTimeout(()=>{oh(Zx,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:Y0}),n.addShortcut({keys:[["Escape"]],callback:()=>{wt(sr,this).setValue(wt(V_,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>wt(sr,this).isVisible()&&wt(sr,this).isFocused(),group:Y0}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>wt(sr,this).isVisible()&&wt(sr,this).isFocused(),group:Y0}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{wt(sr,this).setValue(wt(sr,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:Y0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Y0)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>Vs(Co,this,Wze).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>Vs(Co,this,Bze).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Vs(Co,this,jze).call(this)),this.eventManager.addEventListener(r,"focus",()=>Vs(Co,this,Gze).call(this)),this.eventManager.addEventListener(r,"blur",()=>Vs(Co,this,zze).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",n=>Vs(Co,this,Vze).call(this,n))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=Md(e.target,"TD","TBODY");return!!(r&&tt(r,"htCommentCell")&&Md(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=wt(sr,this).getValue();let n="";e!=null?n=e:r!=null&&(n=r);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[Ov]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,pc),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,Ov)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,Ov)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:n}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return wt(yl,this).cancelHiding(),wt(sr,this).setValue((e=i[pc]?i[pc][Ov]:null)!==null&&e!==void 0?e:""),wt(sr,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){wt(sr,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!wt(sr,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:n}=this.hot,{row:i,col:s}=this.range.from;let o=r.getRenderableFromVisualIndex(i),a=n.getRenderableFromVisualIndex(s);const l=o===null;wt(sr,this).setPosition(0,0),o===null&&(o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1))),a===null&&(a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,-1)));const c=o===null,u=a===null;o=o??0,a=a??0;const{rootWindow:h,view:{_wt:f}}=this.hot,{wtTable:d}=f,g=f.getCell({row:o,col:a},!0),m=this.getCommentMeta(i,s,iZ);m?wt(sr,this).setSize(m.width,m.height):wt(sr,this).resetSize();const p=u?0:d.getColumnWidth(a),w=l&&!c?An(g):0,{left:v,top:y,width:b,height:T}=g.getBoundingClientRect(),{width:E,height:x}=wt(sr,this).getSize(),{innerWidth:P,innerHeight:A}=this.hot.rootWindow,O=this.hot.rootDocument.documentElement,Y=ei(this.hot.rootDocument),B=Nq(this.hot.rootWindow)?Y:0,ie=Dq(this.hot.rootWindow)?Y:0;let ue=v+h.scrollX+p,he=y+h.scrollY+w;this.hot.isRtl()&&(ue-=E+p),this.hot.isLtr()&&v+b+E>P-B?ue=v+h.scrollX-E-1:this.hot.isRtl()&&ue<-(O.scrollWidth-O.clientWidth)&&(ue=v+h.scrollX+p+1),y+x>A-ie&&(he-=x-T+1),wt(sr,this).setPosition(ue,he),wt(sr,this).setReadOnlyState(this.getCommentMeta(i,s,Qx)),wt(sr,this).observeSize()}focusEditor(){wt(sr,this).focus()}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[pc];let s;i?(s=ns(i),PR(s,n)):s=n,this.hot.setCellMeta(e,r,pc,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[pc])return i[pc][n]}addToContextMenu(e){e.items.push({name:yt},Ize(this),Oze(this),Mze(this))}getEditorInputElement(){return wt(sr,this).getInputElement()}destroy(){var e,r;(e=wt(sr,this))===null||e===void 0||e.destroy(),(r=wt(yl,this))===null||r===void 0||r.destroy(),super.destroy()}}function Bze(t){if(!(!this.hot.view||!this.hot.view._wt)&&!wt(tT,this)&&!this.targetIsCommentTextArea(t)){const e=Md(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function Vze(t){t.stopPropagation()}function Wze(t){const{rootDocument:e}=this.hot;if(!(wt(tT,this)||wt(sr,this).isFocused()||tt(t.target,"wtBorder")||wt(n2,this)===t.target||!wt(sr,this)))if(oh(n2,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));wt(yl,this).show(r)}else dd(t.target,e)&&!this.targetIsCommentTextArea(t)&&wt(yl,this).hide()}function jze(){oh(tT,this,!1)}function Uze(t,e){e[pc]&&e[pc][Ov]&&Se(t,e.commentedCellClassName)}function zze(){oh(V_,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Gze(){oh(V_,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(r2)}function Yze(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[iZ]:{width:t,height:e}})}function Qj(t){wt(sr,this).isFocused()&&Ua(t)}function Kze(){wt(Zx,this)||this.hide()}function gA(t,e,r){return(e=Xze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xze(t){var e=qze(t,"string");return typeof e=="symbol"?e:e+""}function qze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sZ{constructor(e){gA(this,"hot",void 0),gA(this,"commands",{}),gA(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=Jze(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Pn(l,"submenu"))return;const c=[];typeof l.callback=="function"&&c.push(l.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),n.unshift(s.join(":")),Z(c,u=>u.apply(this.hot,n))}}function Jze(t,e){let r;return Z(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function mA(t,e,r){return(e=Qze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qze(t){var e=Zze(t,"string");return typeof e=="symbol"?e:e+""}function Zze(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oZ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;mA(this,"hot",void 0),mA(this,"predefinedItems",rZ()),mA(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,St(e,(n,i)=>{let s="";n.name===yt?(r[yt]=n,s=yt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e9e(e,this.defaultOrderPattern,this.predefinedItems)}}function e9e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ct(i)?St(i,(s,o)=>{let a=r[typeof s=="string"?s:o];a||(a=s),Ct(s)?In(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),n.push(a)}):Z(i,(s,o)=>{let a=r[s];!a&&Pze.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),Ct(s)&&In(a,s),a.key===void 0&&(a.key=o),n.push(a))}),n}function bu(t,e,r){return(e=t9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t9e(t){var e=r9e(t,"string");return typeof e=="symbol"?e:e+""}function r9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n9e{constructor(e,r){bu(this,"top",void 0),bu(this,"topRelative",void 0),bu(this,"left",void 0),bu(this,"leftRelative",void 0),bu(this,"scrollTop",void 0),bu(this,"scrollLeft",void 0),bu(this,"cellHeight",void 0),bu(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let s,o,a,l,c,u;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),c=e.height||0,u=e.width||0,o=s,l=a,s+=n,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),c=e.target.clientHeight,u=e.target.clientWidth,o=s-n,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=c,this.cellWidth=u}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function K0(t,e,r){i9e(t,e),e.set(t,r)}function i9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(t,e){return t.get(aZ(t,e))}function bS(t,e,r){return t.set(aZ(t,e),r),r}function aZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Bi=new WeakMap,us=new WeakMap,hs=new WeakMap,pA=new WeakMap,Fg=new WeakMap;class s9e{constructor(e){K0(this,Bi,void 0),K0(this,us,void 0),K0(this,hs,void 0),K0(this,pA,!1),K0(this,Fg,{above:0,below:0,left:0,right:0}),bS(pA,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ut(Fg,this)[e]=r,this}setElement(e){return bS(Bi,this,e),this}setParentElement(e){return bS(us,this,e),this}updatePosition(e){bS(hs,this,new n9e(e,ut(Bi,this).ownerDocument.defaultView)),ut(pA,this)?(ut(hs,this).fitsBelow(ut(Bi,this))?this.setPositionBelowCursor():ut(hs,this).fitsAbove(ut(Bi,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ut(Bi,this).dir==="rtl"?ut(hs,this).fitsOnLeft(ut(Bi,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ut(hs,this).fitsOnRight(ut(Bi,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ut(Fg,this).above+ut(hs,this).top-ut(Bi,this).offsetHeight;if(ut(us,this)){const n=ut(us,this).ownerDocument.defaultView.getComputedStyle(ut(us,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=ut(hs,this).top+ut(hs,this).cellHeight-ut(Bi,this).scrollHeight+i+s}ut(Bi,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ut(Fg,this).below+ut(hs,this).top+1;if(ut(us,this)){const n=ut(us,this).ownerDocument.defaultView.getComputedStyle(ut(us,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=ut(hs,this).top-i-s-1}ut(Bi,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ut(hs,this).left;if(ut(us,this)){const r=ut(us,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ut(us,this).querySelector(".htCore")).borderRightWidth,10);e+=ut(hs,this).cellWidth+n}else e+=ut(Fg,this).right;ut(Bi,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ut(Fg,this).left+ut(hs,this).left-ut(Bi,this).offsetWidth;if(ut(us,this)){const r=ut(us,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ut(us,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ut(Bi,this).style.left=`${e}px`}}function lZ(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const s=new Set;let o=Mt(e,-1,m()-1);function a(w,v){const y=m()-1;return w<0&&(w=y),w>y&&(w=0),s.has(w)?-1:(s.add(w),n(w,!1)===!1&&(w=a(v===1?++w:--w,v)),w)}function l(w){w>-1&&w<m()&&n(w,!0)!==!1&&(o=w)}function c(w){w>-1&&w<m()&&(o=w)}function u(){return o}function h(){m()>0&&(s.clear(),o=a(0,1))}function f(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function g(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(r(),0)}function p(){s.clear(),o=e,i()}return{setCurrentPage:l,setPageCursorAt:c,getCurrentPage:u,toFirstItem:h,toLastItem:f,toNextItem:d,toPreviousItem:g,getSize:m,clear:p}}function o9e(t){return At(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function i2(t){return Pn(t,"submenu")}function s2(t){return new RegExp(yt,"i").test(t.name)}function eb(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function Zj(t){return Pn(t,"disableSelection")}function a9e(t){return tt(t,"htSeparator")}function l9e(t){return tt(t,"htSubmenu")}function c9e(t){return tt(t,"htDisabled")}function u9e(t){return tt(t,"htSelectionDisabled")}function h9e(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function cZ(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function f9e(t,e){let r=t.slice(0);return r.reverse(),r=cZ(r,e),r.reverse(),r}function d9e(t){const e=[];return Z(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function g9e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yt,r=t.slice(0);return r=cZ(r,e),r=f9e(r,e),r=d9e(r),r}function m9e(t){return t.checkable===!0}function p9e(t){return lZ({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||a9e(n)||c9e(n)||u9e(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function v9e(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(n):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const uZ="menu",e6=uZ;function w9e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(v9e(t)),e.forEach(c=>{let{shortcuts:u,contextName:h}=c;i(u,h)});function n(c,u){a(u).addShortcuts(c,{group:uZ})}function i(c,u){const h=a(u);c.forEach(f=>{let{keys:d}=f;d.forEach(g=>h.removeShortcutsByKeys(g))}),r.push({shortcuts:c,contextName:u}),n(c,u)}function s(){return[...r]}function o(c){return c?`${e6}:${c}`:e6}function a(c){var u;const h=t.hotMenu.getShortcutManager(),f=o(c);return(u=h.getContext(f))!==null&&u!==void 0?u:h.addContext(f)}function l(c){t.hotMenu.getShortcutManager().setActiveContextName(o(c))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function y9e(t){return(e,r,n,i,s,o)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),c=typeof o=="function"?o.call(t):o,u=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Xc(r),Se(l,"htItemWrapper"),t.getSettings().ariaTags){const f=!eb(a,t)&&!Zj(a)&&!s2(a);et(r,[...m9e(a)?[RNe(),wp(u),vq(h)]:[ENe(),wp(c)],...f?[Vh(-1)]:[],...eb(a,t)?[MNe()]:[],...i2(a)?[jo(!1)]:[]])}r.className="",r.appendChild(l),s2(a)?Se(r,"htSeparator"):typeof a.renderer=="function"?(Se(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,s,c))):Xp(l,c),eb(a,t)?Se(r,"htDisabled"):Zj(a)?Se(r,"htSelectionDisabled"):i2(a)&&Se(r,"htSubmenu")}}function vA(t,e,r){C9e(t,e),e.set(t,r)}function C9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function il(t,e,r){return(e=S9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S9e(t){var e=x9e(t,"string");return typeof e=="symbol"?e:e+""}function x9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wA(t,e,r){return t.set(hZ(t,e),r),r}function _u(t,e){return t.get(hZ(t,e))}function hZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const t6=215;var Hg=new WeakMap,_S=new WeakMap,ES=new WeakMap;class e0{get tableBorderWidth(){return _u(ES,this)===void 0&&this.hotMenu&&wA(ES,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_u(ES,this)}constructor(e,r){var n=this;il(this,"hot",void 0),il(this,"options",void 0),il(this,"eventManager",new Ba(this)),il(this,"container",void 0),il(this,"positioner",void 0),il(this,"hotMenu",null),il(this,"hotSubMenus",{}),il(this,"parentMenu",void 0),il(this,"menuItems",null),il(this,"origOutsideClickDeselects",null),vA(this,Hg,void 0),vA(this,_S,void 0),vA(this,ES,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:t6,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new s9e(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{this.options.container!==this.hot.rootPortalElement&&(Je(this.options.container,/ht-theme-.*/g),Se(this.options.container,i)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=yp(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return _u(Hg,this)}getKeyboardShortcutsCtrl(){return _u(_S,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=OR(a=>this.openSubMenu(a),300),r=this.options.minWidth||t6;let n=!1,i=Od(this.menuItems,a=>(a.key===ky&&(n=!0),h9e(a,this.hot)));if(i.length<1&&!n)i.push(rZ()[ky]);else if(i.length===0)return;i=g9e(i,yt);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Le(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:y9e(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?_u(Hg,this).setCurrentPage(l.row):_u(Hg,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),PM()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,c,u,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!PM()||!Dd(a))&&s&&this.hasSelectedItem()&&(Il()||Eq()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),wA(Hg,this,p9e(this.hotMenu)),wA(_S,this,w9e(this)),_u(_S,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(_u(Hg,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);et(n,[jo(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!l9e(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new e0(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&et(r,[jo(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&et(i,[jo(!1)])}}closeAllSubMenus(){Z(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?o9e(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||s2(e)||eb(e,this.hot)||i2(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),o=Ns(r,(a,l,c)=>{const h=this.hotMenu.getCell(c,0)?An(this.hotMenu.getCell(c,0)):0;return a+(l.name===yt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${s+3}px`,i.height=`${o+3}px`):(i.width=`${s}px`,i.height=`${o}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(er(n)&&(n=n.call(this.hot),n===null||Dr(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),Se(i,`htMenu handsontable ${this.options.className}`),n&&Se(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&et(this.hotMenu.rootElement,[_Ne(),Vh(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!dd(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!dd(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&tt(e.target,"htCore")&&dd(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ur(e0,fi);function b9e(t,e){_9e(t,e),e.add(t)}function _9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yA(t,e,r){return(e=E9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E9e(t){var e=R9e(t,"string");return typeof e=="symbol"?e:e+""}function R9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Mv="contextMenu",T9e=70,r6=Mv;Fe.getSingleton().register("afterContextMenuDefaultOptions");Fe.getSingleton().register("beforeContextMenuShow");Fe.getSingleton().register("afterContextMenuShow");Fe.getSingleton().register("afterContextMenuHide");Fe.getSingleton().register("afterContextMenuExecute");var X0=new WeakSet;class rT extends Gt{constructor(){super(...arguments),b9e(this,X0),yA(this,"commandExecutor",new sZ(this.hot)),yA(this,"itemsFactory",null),yA(this,"menu",null)}static get PLUGIN_KEY(){return Mv}static get PLUGIN_PRIORITY(){return T9e}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[QR,ZR,yt,I1,O1,yt,JR,N1,yt,eT,qR,yt,M1,yt,Ao]}isEnabled(){return!!this.hot.getSettings()[Mv]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Mv];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new e0(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>RS(X0,this,P9e).call(this)),this.menu.addLocalHook("afterOpen",()=>RS(X0,this,A9e).call(this)),this.menu.addLocalHook("afterClose",()=>RS(X0,this,I9e).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>RS(X0,this,k9e).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=KR(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:r6})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(r6)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;St(n,(s,o)=>{const a=["below","right"].includes(o)?s+1:s-1;this.menu.setOffset(o,i?s:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new oZ(this.hot,rT.DEFAULT_ITEMS);const e=this.hot.getSettings()[Mv],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Z(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function k9e(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),tt(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(s)&&!(tt(s,"current")&&tt(s,"wtBorder"))))return;const o=KR(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function P9e(){this.hot.runHooks("beforeContextMenuShow",this)}function A9e(){this.hot.runHooks("afterContextMenuShow",this)}function I9e(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}rT.SEPARATOR={name:yt};function O9e(t){return{key:"copy",name(){return this.getTranslatedPhrase(yH)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function M9e(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?Mt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(xH,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function N9e(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?Mt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(SH,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function D9e(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?Mt(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CH,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function F9e(t){return{key:"cut",name(){return this.getTranslatedPhrase(bH)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class H9e{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class L9e{constructor(){this.clipboardData=new H9e}preventDefault(){}composedPath(){return[]}}function $9e(t,e){fZ(t,e),e.add(t)}function Lg(t,e,r){fZ(t,e),e.set(t,r)}function fZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ui(t,e){return t.get(Dm(t,e))}function $g(t,e,r){return t.set(Dm(t,e),r),r}function Dm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Eu=new WeakMap,CA=new WeakMap,q0=new WeakMap,o2=new WeakMap,a2=new WeakMap,J0=new WeakMap,Q0=new WeakSet;class B9e{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;$9e(this,Q0),Lg(this,Eu,void 0),Lg(this,CA,void 0),Lg(this,q0,void 0),Lg(this,o2,void 0),Lg(this,a2,void 0),Lg(this,J0,void 0),$g(CA,this,r),$g(q0,this,n),$g(o2,this,i),$g(a2,this,s),$g(J0,this,o)}setSelectedRange(e){$g(Eu,this,e)}getCellsRange(){if(Ui(CA,this).call(this)===0||Ui(q0,this).call(this)===0)return null;const{row:e,col:r}=Ui(Eu,this).getTopStartCorner(),{row:n,col:i}=Ui(Eu,this).getBottomEndCorner(),s=Dm(Q0,this,V9e).call(this,e,n),o=Dm(Q0,this,SA).call(this,r,i);return{isRangeTrimmed:n!==s||i!==o,startRow:e,startCol:r,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Ui(q0,this).call(this)===0||Ui(J0,this).call(this)===0)return null;const{col:e}=Ui(Eu,this).getTopStartCorner(),{col:r}=Ui(Eu,this).getBottomEndCorner(),n=Dm(Q0,this,SA).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Ui(q0,this).call(this)===0||Ui(J0,this).call(this)===0)return null;const{col:e}=Ui(Eu,this).getTopStartCorner(),{col:r}=Ui(Eu,this).getBottomEndCorner(),n=Dm(Q0,this,SA).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Ui(J0,this).call(this),startCol:e,endRow:-1,endCol:n}}}function SA(t,e){return Math.min(e,Math.max(t+Ui(a2,this).call(this)-1,t))}function V9e(t,e){return Math.min(e,Math.max(t+Ui(o2,this).call(this)-1,t))}function dZ(t){const e=[],r=[];return Z(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);je(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);je(o,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function W9e(t,e){gZ(t,e),e.add(t)}function Ru(t,e,r){gZ(t,e),e.set(t,r)}function gZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z0(t,e,r){return(e=j9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j9e(t){var e=U9e(t,"string");return typeof e=="symbol"?e:e+""}function U9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vs(t,e){return t.get(Cs(t,e))}function da(t,e,r){return t.set(Cs(t,e),r),r}function Cs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("afterCopyLimit");Fe.getSingleton().register("modifyCopyableRange");Fe.getSingleton().register("beforeCut");Fe.getSingleton().register("afterCut");Fe.getSingleton().register("beforePaste");Fe.getSingleton().register("afterPaste");Fe.getSingleton().register("beforeCopy");Fe.getSingleton().register("afterCopy");const xA="copyPaste",z9e=80,G9e=["fragmentSelection"],n6=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var l2=new WeakMap,c2=new WeakMap,u2=new WeakMap,Bg=new WeakMap,TS=new WeakMap,kS=new WeakMap,Vg=new WeakMap,W_=new WeakMap,js=new WeakSet;class Y9e extends Gt{constructor(){super(...arguments),W9e(this,js),Z0(this,"columnsLimit",1/0),Z0(this,"rowsLimit",1/0),Z0(this,"pasteMode","overwrite"),Z0(this,"uiContainer",this.hot.rootDocument.body),Ru(this,l2,!1),Ru(this,c2,!1),Ru(this,u2,!1),Ru(this,Bg,"cells-only"),Ru(this,TS,!1),Ru(this,kS,!1),Ru(this,Vg,new B9e({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ru(this,W_,!1),Z0(this,"copyableRanges",[])}static get PLUGIN_KEY(){return xA}static get SETTING_KEYS(){return[xA,...G9e]}static get PLUGIN_PRIORITY(){return z9e}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[xA]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),da(l2,this,this.getSetting("copyColumnHeaders")),da(c2,this,this.getSetting("copyColumnGroupHeaders")),da(u2,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Cs(js,this,q9e).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Cs(js,n,J9e).call(n,...s)}),this.addHook("afterSelectionEnd",()=>Cs(js,this,Q9e).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),Cy()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Cs(js,n,Z9e).call(n,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Cs(js,n,e7e).call(n,...s)}),this.addHook("afterSelection",()=>Cs(js,this,t7e).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";da(Bg,this,e),da(TS,this,!0),Cs(js,this,i6).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){da(kS,this,!0),Cs(js,this,i6).call(this,"cut")}getRangedCopyableData(e){return aw(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=dZ(e);return Z(n,s=>{const o=[];Z(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new L9e;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}vs(Vg,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);vs(Bg,this)==="column-headers-only"?r.set("headers",vs(Vg,this).getMostBottomColumnHeadersRange()):(vs(Bg,this)==="with-column-headers"?r.set("headers",vs(Vg,this).getMostBottomColumnHeadersRange()):vs(Bg,this)==="with-column-group-headers"&&r.set("headers",vs(Vg,this).getAllColumnHeadersRange()),r.set("cells",vs(Vg,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=n;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,s=[],{row:o,col:a}=r.getTopStartCorner(),{row:l,col:c}=r.getBottomEndCorner();let u=o,h=a,f=o,d=a;for(;s.length<n||u<=l;){const{skipRowOnPaste:g,visualRow:m}=this.hot.getCellMeta(u,a);if(u=m+1,g===!0)continue;f=m,h=a;const p=[],w=s.length%n;for(;p.length<i||h<=c;){const{skipColumnOnPaste:v,visualCol:y}=this.hot.getCellMeta(o,h);if(h=y+1,v===!0)continue;d=y;const b=p.length%i;p.push(e[w][b])}s.push(p)}return da(W_,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,f,d]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!vs(TS,this)||this.isEditorOpened()||Bc(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Gx(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),da(TS,this,!1);const s=this.getRangedData(this.copyableRanges),o=Cs(js,this,K9e).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=aw(s);if(e&&e.clipboardData){const c=n8(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[n6,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}da(Bg,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!vs(kS,this)||this.isEditorOpened()||Bc(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Gx(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),da(kS,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=aw(s);if(e&&e.clipboardData){const l=n8(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[n6,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Bc(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Gx(r,this.hot.rootElement)))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const u=RF(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});u&&/(<table)|(<TABLE)/g.test(u)?s=vHe(u,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=PBe(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,c]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function i6(t){if(Cy()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&_De(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function K9e(t){const{rows:e}=dZ(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function X9e(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&Lq(n)}}}function mZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&$q(n)}}}function q9e(t){t.items.push({name:"---------"},O9e(this)),vs(l2,this)&&t.items.push(D9e(this)),vs(c2,this)&&t.items.push(N9e(this)),vs(u2,this)&&t.items.push(M9e(this)),t.items.push(F9e(this))}function J9e(t,e,r,n,i){vs(W_,this)&&(i.value=!0),da(W_,this,!1)}function Q9e(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Z9e(){Cs(js,this,mZ).call(this)}function e7e(){Cs(js,this,X9e).call(this)}function t7e(){Cs(js,this,mZ).call(this)}function pZ(t,e){return`border_row${t}col${e}`}function Nv(){return{width:1,color:"#000"}}function Pc(){return{hide:!0}}function r7e(){return{width:1,color:"#000",cornerVisible:!1}}function bA(t){if(Le(t.start)||Le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Le(t.end)||Le(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function ev(t){return Le(t.start)&&(t.left=t.start),Le(t.end)&&(t.right=t.end),t}function _A(t,e){return{id:pZ(t,e),border:r7e(),row:t,col:e,top:Pc(),bottom:Pc(),start:Pc(),end:Pc()}}function n7e(t,e){return Pn(e,"border")&&e.border&&(t.border=e.border),Pn(e,"top")&&Le(e.top)&&(e.top?(Ct(e.top)||(e.top=Nv()),t.top=e.top):(e.top=Pc(),t.top=e.top)),Pn(e,"bottom")&&Le(e.bottom)&&(e.bottom?(Ct(e.bottom)||(e.bottom=Nv()),t.bottom=e.bottom):(e.bottom=Pc(),t.bottom=e.bottom)),Pn(e,"start")&&Le(e.start)&&(e.start?(Ct(e.start)||(e.start=Nv()),t.start=e.start):(e.start=Pc(),t.start=e.start)),Pn(e,"end")&&Le(e.end)&&(e.end?(Ct(e.end)||(e.end=Nv()),t.end=e.end):(e.end=Pc(),t.end=e.end)),t}function Jc(t,e){let r=!1;return Z(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!Pn(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function nT(t){return`<span class="selected">✓</span>${t}`}function i7e(t){return t.some(e=>Le(e.left)||Le(e.right))}function s7e(t){return t.some(e=>Le(e.start)||Le(e.end))}const o7e=new Map([["left","start"],["right","end"]]);function a7e(t){var e;return(e=o7e.get(t))!==null&&e!==void 0?e:t}function l7e(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(jH);return Jc(this,"bottom")&&(e=nT(e)),e},callback(e,r){const n=Jc(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function c7e(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(UH);return Jc(this,e)&&(r=nT(r)),r},callback(r,n){const i=Jc(this,e);t.prepareBorder(n,e,i)}}}function u7e(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(zH)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!Jc(this)}}}function h7e(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(WH);return Jc(this,e)&&(r=nT(r)),r},callback(r,n){const i=Jc(this,e);t.prepareBorder(n,e,i)}}}function f7e(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(VH);return Jc(this,"top")&&(e=nT(e)),e},callback(e,r){const n=Jc(this,"top");t.prepareBorder(r,"top",n)}}}function d7e(t,e){g7e(t,e),e.add(t)}function g7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m7e(t,e,r){return(e=p7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p7e(t){var e=v7e(t,"string");return typeof e=="symbol"?e:e+""}function v7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tb="customBorders",w7e=90;var EA=new WeakSet;class y7e extends Gt{constructor(){super(...arguments),d7e(this,EA),m7e(this,"savedBorders",[])}static get PLUGIN_KEY(){return tb}static get PLUGIN_PRIORITY(){return w7e}isEnabled(){return!!this.hot.getSettings()[tb]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>s6(EA,this,C7e).call(this,e)),this.addHook("init",()=>s6(EA,this,S7e).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=bA(r));const s=xp(e),o=by(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Z(e,a=>{o(a).forAll((l,c)=>{Z(n,u=>{this.prepareBorderFromCustomAdded(l,c,i,a7e(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=xp(e),n=by(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return Z(e,s=>{n(s).forAll((o,a)=>{Z(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(ev(l))})})}),i}clearBorders(e){e?this.setBorders(e):(Z(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||r>=o)return;let a=_A(e,r);n&&(a=n7e(a,n),Z(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,n),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",ev(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);je(e.from.row,n,s=>{je(e.from.col,i,o=>{const a=_A(s,o);let l=0;s===e.from.row&&Pn(r,"top")&&(l+=1,a.top=r.top),s===e.to.row&&Pn(r,"bottom")&&(l+=1,a.bottom=r.bottom),o===e.from.col&&Pn(r,"start")&&(l+=1,a.start=r.start),o===e.to.col&&Pn(r,"end")&&(l+=1,a.end=r.end),l>0&&(this.hot.setCellMeta(s,o,"borders",ev(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,r){const n=pZ(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=_A(e,r):s=bA(s),i?(s[n]=Pc(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",ev(s)))):(s[n]=Nv(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",ev(s)))}prepareBorder(e,r,n){Z(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":je(s.col,o.col,a=>{je(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":je(s.col,o.col,a=>{this.setBorder(s.row,a,r,n)});break;case"bottom":je(s.col,o.col,a=>{this.setBorder(o.row,a,r,n)});break;case"start":je(s.row,o.row,a=>{this.setBorder(a,s.col,r,n)});break;case"end":je(s.row,o.row,a=>{this.setBorder(a,o.col,r,n)});break}})}createCustomBorders(e){Z(e,r=>{const n=bA(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return Ns([r,n,i,s],(a,l)=>{let c=a;return l&&l.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const r=At(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){Z(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){Z(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=At(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):Z(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return Z(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return Z(o,a=>{a.toggleHiddenClass(r,n)}),i=!0,!1}}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):Z(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),n){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);Z(a,l=>{l.changeBorderStyle(n,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[tb];if(Array.isArray(e)){const r=ns(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=i7e(e),n=s7e(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function C7e(t){this.hot.getSettings()[tb]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(BH)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[f7e(this),h7e(this),l7e(this),c7e(this),u7e(this)]}})}function S7e(){this.changeBorderSettings()}function x7e(t,e){b7e(t,e),e.add(t)}function b7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RA(t,e,r){return(e=_7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _7e(t){var e=E7e(t,"string");return typeof e=="symbol"?e:e+""}function E7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const a6="dragToScroll",R7e=100;var TA=new WeakSet;class T7e extends Gt{constructor(){super(...arguments),x7e(this,TA),RA(this,"boundaries",null),RA(this,"callback",null),RA(this,"listening",!1)}static get PLUGIN_KEY(){return a6}static get PLUGIN_PRIORITY(){return R7e}isEnabled(){return!!this.hot.getSettings()[a6]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>o6(TA,this,l6).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>o6(TA,this,l6).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=yp(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function l6(t){if(Dd(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,n)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(r)*50,a+Math.sign(n)*20)}),this.listen()}function k7e(t,e){vZ(t,e),e.add(t)}function P7e(t,e,r){vZ(t,e),e.set(t,r)}function vZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kA(t,e,r){return(e=A7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A7e(t){var e=I7e(t,"string");return typeof e=="symbol"?e:e+""}function I7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function O7e(t,e){return t.get(Io(t,e))}function wZ(t,e,r){return t.set(Io(t,e),r),r}function Io(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("afterDropdownMenuDefaultOptions");Fe.getSingleton().register("beforeDropdownMenuShow");Fe.getSingleton().register("afterDropdownMenuShow");Fe.getSingleton().register("afterDropdownMenuHide");Fe.getSingleton().register("afterDropdownMenuExecute");const rb="dropdownMenu",M7e=230,Py="changeType",PA=rb;var iT=new WeakMap,pa=new WeakSet;class sT extends Gt{static get PLUGIN_KEY(){return rb}static get PLUGIN_PRIORITY(){return M7e}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[I1,O1,yt,N1,yt,XR,yt,M1,yt,Ao]}constructor(e){super(e),k7e(this,pa),kA(this,"commandExecutor",new sZ(this.hot)),kA(this,"itemsFactory",null),kA(this,"menu",null),P7e(this,iT,!1),this.hot.addHook("afterGetColHeader",(r,n)=>Io(pa,this,D7e).call(this,r,n))}isEnabled(){return this.hot.getSettings()[rb]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new oZ(this.hot,sT.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Io(pa,e,V7e).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Io(pa,e,B7e).call(e,...s)});const r=this.hot.getSettings()[rb],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new e0(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Io(pa,this,F7e).call(this)),this.menu.addLocalHook("afterOpen",()=>Io(pa,this,H7e).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>Io(pa,this,L7e).call(this,s)),this.menu.addLocalHook("afterClose",()=>Io(pa,this,$7e).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),Z(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=KR(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${Py}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:PA},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:PA}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PA)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Io(pa,this,N7e).call(this,e))}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),St(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function yZ(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function N7e(t){if(tt(t.target,Py)){const e=KR(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),wZ(iT,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function D7e(t,e){const r=e.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${Py}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=Py,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(et(o,[sg(),wp(" ")]),et(e,[gq("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function F7e(){this.hot.runHooks("beforeDropdownMenuShow",this)}function H7e(){this.hot.runHooks("afterDropdownMenuShow",this),Io(pa,this,yZ).call(this,this.menu)}function L7e(t){Io(pa,this,yZ).call(this,t)}function $7e(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function B7e(t){return O7e(iT,this)?null:t}function V7e(t){tt(t.target,Py)&&wZ(iT,this,!0)}sT.SEPARATOR={name:yt};function c6(t,e,r){return(e=W7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W7e(t){var e=j7e(t,"string");return typeof e=="symbol"?e:e+""}function j7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U7e{constructor(e){c6(this,"hot",void 0),c6(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,o=[];return je(e,n,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(je(r,i,c=>{!s.exportHiddenColumns&&this._isHiddenColumn(c)||l.push(this.hot.getDataAtCell(a,c))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();je(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();je(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,o=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),o=Math.min(o,e),{startRow:n,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function u6(t,e,r){return(e=z7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z7e(t){var e=G7e(t,"string");return typeof e=="symbol"?e:e+""}function G7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s${static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){u6(this,"dataProvider",void 0),u6(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=$l(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=In($l(s$.DEFAULT_OPTIONS),r),r=In(r,e),r.filename=uq(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}function Y7e(t,e){K7e(t,e),e.add(t)}function K7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const CZ="\r",X7e='"',q7e=`
`,J7e="=",Q7e="+",Z7e="-",eGe="@",tGe="	";var AA=new WeakSet;class rGe extends s${constructor(){super(...arguments),Y7e(this,AA)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(n=At(n,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),Z(r,(l,c)=>{c>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[c],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const u=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=u}),a}_escapeCell(e){let{force:r=!1,sanitizeValue:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Fr(e);return i===""||(n&&(r=!0),n instanceof RegExp?i=h6(AA,this,iGe).call(this,i,n):typeof n=="function"?i=n(i):n&&(i=h6(AA,this,nGe).call(this,i)),(r||i.indexOf(CZ)>=0||i.indexOf(X7e)>=0||i.indexOf(q7e)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function nGe(t){return t.startsWith(J7e)||t.startsWith(Q7e)||t.startsWith(Z7e)||t.startsWith(eGe)||t.startsWith(tGe)||t.startsWith(CZ)?`'${t}`:t}function iGe(t,e){return e.test(t)?`'${t}`:t}const sGe="csv",h2={[sGe]:rGe};function oGe(t,e,r){return typeof h2[t]=="function"?new h2[t](e,r):null}const aGe="exportFile",lGe=240;class cGe extends Gt{static get PLUGIN_KEY(){return aGe}static get PLUGIN_PRIORITY(){return lGe}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),o=this._createBlob(s),a=i.URL||i.webkitURL,l=n.createElement("a"),c=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const u=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",c),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,c)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!h2[e])throw new Error(`Export format type "${e}" is not supported.`);return oGe(e,new U7e(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function Wg(t,e,r){return(e=uGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uGe(t){var e=hGe(t,"string");return typeof e=="symbol"?e:e+""}function hGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D1{constructor(e,r){let{id:n,stateless:i=!0}=r;Wg(this,"hot",void 0),Wg(this,"id",void 0),Wg(this,"elements",[]),Wg(this,"hidden",!1),Wg(this,"stateId",""),Wg(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LR)}getElements(){return this.elements}reset(){Z(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Z(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ur(D1,fi);const Ay={};function Ih(t,e){if(!Ay[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=Ay[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function td(t){if(!Ay[t])throw Error(`Filter condition "${t}" does not exist.`);return Ay[t].descriptor}function yn(t,e,r){r.key=t,Ay[t]={condition:e,descriptor:r}}const qn="none";function fGe(){return!0}yn(qn,fGe,{name:$R,inputsCount:0,showOperators:!1});const hw="empty";function dGe(t){return an(t.value)}yn(hw,dGe,{name:QH,inputsCount:0,showOperators:!0});const nb="not_empty";function gGe(t,e){return!Ih(hw,e)(t)}yn(nb,gGe,{name:ZH,inputsCount:0,showOperators:!0});const fw="eq";function mGe(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale)===Fr(r)}yn(fw,mGe,{name:eL,inputsCount:1,showOperators:!0});const ib="neq";function pGe(t,e){return!Ih(fw,e)(t)}yn(ib,pGe,{name:tL,inputsCount:1,showOperators:!0});const SZ="gt";function vGe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}yn(SZ,vGe,{name:oL,inputsCount:1,showOperators:!0});const xZ="gte";function wGe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}yn(xZ,wGe,{name:aL,inputsCount:1,showOperators:!0});const bZ="lt";function yGe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}yn(bZ,yGe,{name:lL,inputsCount:1,showOperators:!0});const _Z="lte";function CGe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}yn(_Z,CGe,{name:cL,inputsCount:1,showOperators:!0});const o$="date_after";function SGe(t,e){let[r]=e;const n=_e(t.value,t.meta.dateFormat),i=_e(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}yn(o$,SGe,{name:fL,inputsCount:1,showOperators:!0});const a$="date_before";function xGe(t,e){let[r]=e;const n=_e(t.value,t.meta.dateFormat),i=_e(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}yn(a$,xGe,{name:dL,inputsCount:1,showOperators:!0});const j_="between";function bGe(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=Ih(a$,[s]),a=Ih(o$,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}yn(j_,bGe,{name:uL,inputsCount:2,showOperators:!0});const EZ="not_between";function _Ge(t,e){return!Ih(j_,e)(t)}yn(EZ,_Ge,{name:hL,inputsCount:2,showOperators:!0});const RZ="begins_with";function EGe(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Fr(r))}yn(RZ,EGe,{name:rL,inputsCount:1,showOperators:!0});const TZ="ends_with";function RGe(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Fr(r))}yn(TZ,RGe,{name:nL,inputsCount:1,showOperators:!0});const l$="contains";function TGe(t,e){let[r]=e;return Fr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Fr(r))>=0}yn(l$,TGe,{name:iL,inputsCount:1,showOperators:!0});const kZ="not_contains";function kGe(t,e){return!Ih(l$,e)(t)}yn(kZ,kGe,{name:sL,inputsCount:1,showOperators:!0});const PZ="date_tomorrow";function PGe(t){const e=_e(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(_e().subtract(-1,"days").startOf("day"),"d"):!1}yn(PZ,PGe,{name:mL,inputsCount:0});const AZ="date_today";function AGe(t){const e=_e(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(_e().startOf("day"),"d"):!1}yn(AZ,AGe,{name:gL,inputsCount:0});const IZ="date_yesterday";function IGe(t){const e=_e(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(_e().subtract(1,"days").startOf("day"),"d"):!1}yn(IZ,IGe,{name:pL,inputsCount:0});aDe();function OGe(t,e){let r=t;return r===""&&(r=`(${e})`),r}function F1(t){const e=new Set(t);return function(r){return e.has(r)}}function c$(t){return t??""}function f2(t){return Array.from(new Set(t)).map(e=>c$(e)).sort((e,r)=>typeof e=="number"&&typeof r=="number"?e-r:e===r?0:e>r?1:-1)}function f6(t,e,r,n){const i=[],s=t===e;let o;return s||(o=F1(e)),t.forEach(a=>{let l=!1;(s||o(a))&&(l=!0);const c={checked:l,value:a,visualValue:OGe(a,r)};n&&n(c),i.push(c)}),i}const rd="by_value";function MGe(t,e){let[r]=e;return r(t.value)}yn(rd,MGe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[F1(e)]},showOperators:!1});const Iy={};function NGe(t){if(!Iy[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Iy[t].func;return function(r,n){return e(r,n)}}function DGe(t){return Iy[t].name}function u$(t,e,r){Iy[t]={name:e,func:r}}const Sh="conjunction",FGe=yL;function HGe(t,e){return t.every(r=>r.func(e))}u$(Sh,FGe,HGe);const U_="disjunction",LGe=BR;function $Ge(t,e){return t.some(r=>r.func(e))}u$(U_,LGe,$Ge);const h$="disjunctionWithExtraCondition",BGe=BR;function VGe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}u$(h$,BGe,VGe);const WGe="numeric",OZ="text",jGe="date",d6={[WGe]:[qn,yt,hw,nb,yt,fw,ib,yt,SZ,xZ,bZ,_Z,j_,EZ],[OZ]:[qn,yt,hw,nb,yt,fw,ib,yt,RZ,TZ,yt,l$,kZ],[jGe]:[qn,yt,hw,nb,yt,fw,ib,yt,a$,o$,j_,yt,PZ,AZ,IZ]};function UGe(t){const e=[];let r=t;return d6[r]||(r=OZ),Z(d6[r],n=>{let i;n===yt?i={name:yt}:i=$l(td(n)),e.push(i)}),e}function tv(t,e,r){return(e=zGe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zGe(t){var e=GGe(t,"string");return typeof e=="symbol"?e:e+""}function GGe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const IA="built",OA="building",g6=["click","input","keydown","keypress","keyup","focus","blur","change"];let Da=class MZ{static get DEFAULTS(){return $l({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){tv(this,"hot",void 0),tv(this,"eventManager",new Ba(this)),tv(this,"options",void 0),tv(this,"_element",void 0),tv(this,"buildState",void 0),this.hot=e,this.options=In(MZ.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===OA?this._element:this.buildState===IA?(this.update(),this._element):(this.buildState=OA,this.build(),this.buildState=IA,this._element)}isBuilt(){return this.buildState===IA}translateIfPossible(e){return typeof e=="string"&&e.startsWith(os)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=OA),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Se(this._element,this.options.className),this.options.children.length)Z(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),St(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),Z(g6,n=>e(r,n))}else Z(g6,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ur(Da,fi);function YGe(t,e){NZ(t,e),e.add(t)}function KGe(t,e,r){NZ(t,e),e.set(t,r)}function NZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e){return t.get(f$(t,e))}function XGe(t,e,r){return t.set(f$(t,e),r),r}function f$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jg=new WeakMap,m6=new WeakSet;class xh extends Da{static get DEFAULTS(){return $l({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,In(xh.DEFAULTS,r)),YGe(this,m6),KGe(this,jg,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>f$(m6,this,qGe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");XGe(jg,this,this._element.firstChild),Se(this._element,"htUIInput"),Se(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(PS(jg,this).type=this.options.type,PS(jg,this).placeholder=this.translateIfPossible(this.options.placeholder),PS(jg,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&PS(jg,this).focus()}}function qGe(t){this.options.value=t.target.value}function JGe(t,e){DZ(t,e),e.add(t)}function rv(t,e,r){DZ(t,e),e.set(t,r)}function DZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ug(t,e,r){return t.set(dw(t,e),r),r}function Hr(t,e){return t.get(dw(t,e))}function dw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fn=new WeakMap,AS=new WeakMap,IS=new WeakMap,MA=new WeakMap,OS=new WeakMap,MS=new WeakSet;class Oy extends Da{static get DEFAULTS(){return $l({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,In(Oy.DEFAULTS,r)),JGe(this,MS),rv(this,Fn,null),rv(this,AS,[]),rv(this,IS,void 0),rv(this,MA,void 0),rv(this,OS,void 0),this.registerHooks()}getMenu(){return Hr(Fn,this)}registerHooks(){this.addLocalHook("click",()=>dw(MS,this,eYe).call(this))}setItems(e){Ug(AS,this,this.translateNames(e)),Hr(Fn,this)&&Hr(Fn,this).setMenuItems(Hr(AS,this))}translateNames(e){return Z(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),Ug(Fn,this,new e0(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Hr(Fn,this).setMenuItems(Hr(AS,this));const e=new Da(this.hot,{className:"htUISelectCaption"}),r=new Da(this.hot,{className:"htUISelectDropdown"});Ug(IS,this,e),Ug(MA,this,e.element),Ug(OS,this,r),this.hot.getSettings().ariaTags&&(et(r.element,[sg()]),et(this._element,[dq()])),Z([e,r],n=>this._element.appendChild(n.element)),Hr(Fn,this).addLocalHook("select",n=>dw(MS,this,QGe).call(this,n)),Hr(Fn,this).addLocalHook("afterClose",()=>dw(MS,this,ZGe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Hr(Fn,this).hot.getTranslatedPhrase($R),Hr(MA,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Hr(Fn,this)&&(Hr(Fn,this).open(),Hr(Fn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Hr(Fn,this).getNavigator().toFirstItem(),Hr(Fn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Hr(Fn,this)&&Hr(Fn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Hr(Fn,this)&&(Hr(Fn,this).destroy(),Ug(Fn,this,null)),Hr(IS,this)&&Hr(IS,this).destroy(),Hr(OS,this)&&Hr(OS,this).destroy(),super.destroy()}}function QGe(t){t.name!==yt&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function ZGe(){this.runLocalHooks("afterClose")}function eYe(){this.openOptions()}function tYe(t,e){rYe(t,e),e.add(t)}function rYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p6(t,e,r){return(e=nYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nYe(t){var e=iYe(t,"string");return typeof e=="symbol"?e:e+""}function iYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var NA=new WeakSet;class d2 extends D1{constructor(e,r){super(e,{id:r.id,stateless:!1}),tYe(this,NA),p6(this,"name",""),p6(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new Oy(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new xh(this.hot,{placeholder:EL})),this.elements.push(new xh(this.hot,{placeholder:RL})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>v6(NA,this,sYe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),Z(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>v6(NA,this,oYe).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=$l(e.command);r.name.startsWith(qr)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),Z(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||td(qn),r=[];return Z(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=td(e?e.name:qn);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||Z(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Oy)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof xh)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{Se(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Se(r.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Se(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||Z(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[td(qn)];if(e!==null){const{visualIndex:n}=e;r=UGe(this.hot.getDataType(0,n,this.hot.countRows(),n))}Z(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function sYe(t){Z(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function oYe(t){x1(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ua(t))}function w6(t,e,r){aYe(t,e),e.set(t,r)}function aYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nv(t,e){return t.get(FZ(t,e))}function y6(t,e,r){return t.set(FZ(t,e),r),r}function FZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zg=new WeakMap,DA=new WeakMap;class z_ extends Da{static get DEFAULTS(){return $l({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,In(z_.DEFAULTS,r)),w6(this,zg,void 0),w6(this,DA,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),y6(DA,this,e),y6(zg,this,this._element.firstChild),nv(zg,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(nv(DA,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?nv(zg,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(nv(zg,this).checked=e)}focus(){this.isBuilt()&&nv(zg,this).focus()}}function lYe(t,e){cYe(t,e),e.add(t)}function cYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uYe(t,e,r){return(e=hYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hYe(t){var e=fYe(t,"string");return typeof e=="symbol"?e:e+""}function fYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dYe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const C6=0;var S6=new WeakSet;class gYe extends D1{constructor(e,r){super(e,{id:r.id,stateless:!1}),lYe(this,S6),uYe(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Se(r.parentNode,"htFiltersMenuOperators"),Z(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[Sh,U_];Z(e,r=>{const n=new z_(this.hot,{name:"operator",label:{htmlFor:r,textContent:DGe(r)},value:r,checked:r===e[C6],id:r});n.addLocalHook("change",i=>dYe(S6,this,mYe).call(this,i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Qt`Radio button with index ${e} doesn't exist.`);Z(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof z_&&r.isChecked());return e?e.getValue():Sh}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Z(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Sh,r=arguments.length>1?arguments[1]:void 0,n=e;n===h$&&(n=U_),this.state.setValueAtIndex(r,n)}reset(){this.setChecked(C6)}}function mYe(t){this.setState(t.target.value)}function pYe(t,e,r){vYe(t,e),e.set(t,r)}function vYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FA(t,e){return t.get(HZ(t,e))}function wYe(t,e,r){return t.set(HZ(t,e),r),r}function HZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var iv=new WeakMap;class My extends Da{static get DEFAULTS(){return $l({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,In(My.DEFAULTS,r)),pYe(this,iv,void 0)}build(){super.build(),wYe(iv,this,this._element.firstChild)}update(){this.isBuilt()&&(FA(iv,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&FA(iv,this).focus()}activate(){FA(iv,this).click()}}function yYe(t,e){LZ(t,e),e.add(t)}function Gg(t,e,r){LZ(t,e),e.set(t,r)}function LZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(Fm(t,e))}function la(t,e,r){return t.set(Fm(t,e),r),r}function Fm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const x6="multipleSelect.itemBox";var va=new WeakMap,fn=new WeakMap,HA=new WeakMap,ic=new WeakMap,Tu=new WeakMap,ku=new WeakMap,sv=new WeakSet;class Ny extends Da{static get DEFAULTS(){return $l({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,In(Ny.DEFAULTS,r)),yYe(this,sv),Gg(this,va,[]),Gg(this,fn,void 0),Gg(this,HA,void 0),Gg(this,ic,void 0),Gg(this,Tu,void 0),Gg(this,ku,void 0),la(ic,this,new xh(this.hot,{placeholder:_L,className:"htUIMultipleSelectSearch"})),la(Tu,this,new My(this.hot,{textContent:CL,className:"htUISelectAll"})),la(ku,this,new My(this.hot,{textContent:SL,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ht(fn,this)}registerHooks(){ht(ic,this).addLocalHook("keydown",e=>Fm(sv,this,SYe).call(this,e)),ht(ic,this).addLocalHook("input",e=>Fm(sv,this,CYe).call(this,e)),ht(Tu,this).addLocalHook("click",e=>Fm(sv,this,xYe).call(this,e)),ht(ku,this).addLocalHook("click",e=>Fm(sv,this,bYe).call(this,e))}setItems(e){var r;la(va,this,e),(r=ht(fn,this))===null||r===void 0||r.loadData(ht(va,this))}setLocale(e){la(HA,this,e)}getLocale(){return ht(HA,this)}getItems(){return[...ht(va,this)]}getValue(){return EYe(ht(va,this))}getSearchInputElement(){return ht(ic,this)}getSelectAllElement(){return ht(Tu,this)}getClearAllElement(){return ht(ku,this)}isSelectedAllValues(){return ht(va,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),n=new Da(this.hot,{className:"htUISelectionControls",children:[ht(Tu,this),ht(ku,this)]});this._element.appendChild(ht(ic,this).element),this._element.appendChild(n.element),this._element.appendChild(r);const i=s=>{var o;if(!this._element)return;(o=ht(fn,this))===null||o===void 0||o.destroy(),Se(s,"htUIMultipleSelectHot"),la(fn,this,new this.hot.constructor(s,{data:ht(va,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,u,h,f,d,g)=>{c.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ht(fn,this).listen()},modifyColWidth:c=>{const u=ht(fn,this).container.scrollWidth-ei(e);return c!==void 0&&c<u?u:c},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ht(fn,this).init();const l=ht(fn,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:x6}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{ht(fn,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:x6})};i(r),this.hot._registerTimeout(()=>i(r),100)}focus(){this.isBuilt()&&ht(fn,this).listen()}reset(){ht(ic,this).reset(),ht(Tu,this).reset(),ht(ku,this).reset()}update(){this.isBuilt()&&(ht(fn,this).loadData(_Ye(ht(va,this),this.options.value)),super.update())}destroy(){var e;(e=ht(fn,this))===null||e===void 0||e.destroy(),ht(ic,this).destroy(),ht(ku,this).destroy(),ht(Tu,this).destroy(),la(ic,this,null),la(ku,this,null),la(Tu,this,null),la(fn,this,null),la(va,this,null),super.destroy()}}function CYe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...ht(va,this)]:r=ht(va,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),ht(fn,this).loadData(r)}function SYe(t){this.runLocalHooks("keydown",t,this),Bq(x1,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ua(t),ht(fn,this).listen(),ht(fn,this).selectCell(0,0))}function xYe(t){const e=[];t.preventDefault(),ht(fn,this).getSourceData().forEach((r,n)=>{r.checked=!0,e.push(CJ(r,n)[0])}),ht(fn,this).setSourceDataAtCell(e)}function bYe(t){const e=[];t.preventDefault(),ht(fn,this).getSourceData().forEach((r,n)=>{r.checked=!1,e.push(CJ(r,n)[0])}),ht(fn,this).setSourceDataAtCell(e)}function _Ye(t,e){const r=F1(e);return t.map(n=>(n.checked=r(n.value),n))}function EYe(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function RYe(t,e){TYe(t,e),e.add(t)}function TYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kYe(t,e,r){return(e=PYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PYe(t){var e=AYe(t,"string");return typeof e=="symbol"?e:e+""}function AYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ov=new WeakSet;class IYe extends D1{constructor(e,r){super(e,{id:r.id,stateless:!1}),RYe(this,ov),kYe(this,"name",""),this.name=r.name,this.elements.push(new Ny(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>NS(ov,this,OYe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>NS(ov,this,MYe).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===rd){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?qn:rd},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,o,a)=>{const[l]=Od(i,h=>h.name===rd),c={},u=this.hot.getTranslatedPhrase(R_);if(l){const h=o(n,a),f=At(h,v=>v.value),d=new Map(h.map(v=>[v.value,this.hot.getCellMeta(v.meta.visualRow,v.meta.visualCol)])),g=f2(f);s&&(l.args[0]=s);const m=[],p=f6(g,l.args[0],u,v=>{v.checked&&m.push(v.value),NS(ov,this,b6).call(this,v,d)}),w=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,w).locale,c.args=[m],c.command=td(rd),c.itemsSnapshot=p}else c.args=[],c.command=td(qn);this.state.setValueAtIndex(n,c)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ny)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{Se(r.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Se(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||Z(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(R_),r=this._getColumnVisibleValues(),n=r.map(l=>l.value),i=new Map(r.map(l=>[l.value,l.meta])),s=f2(n),o=f6(s,s,e,l=>{NS(ov,this,b6).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:At(this.hot.getDataAtCol(e.visualIndex),(r,n)=>({value:c$(r),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function OYe(t){x1(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ua(t))}function b6(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function MYe(t,e){switch(e.type){case"numeric":return RQ(t,e);default:return t}}var $Z;function NYe(t,e){DYe(t,e),e.add(t)}function DYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FYe(t,e,r){return(e=HYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HYe(t){var e=LYe(t,"string");return typeof e=="symbol"?e:e+""}function LYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Ye(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _6=new WeakSet;class Dy extends D1{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),NYe(this,_6),FYe(this,"name",""),this.name=r.name,this.elements.push(new xh(this.hot,{type:"button",value:xL,className:"htUIButton htUIButtonOK",identifier:Dy.BUTTON_OK})),this.elements.push(new xh(this.hot,{type:"button",value:bL,className:"htUIButton htUIButtonCancel",identifier:Dy.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Z(this.elements,e=>{e.addLocalHook("click",(r,n)=>$Ye(_6,this,BYe).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Se(r.parentNode,"htFiltersMenuActionBar"),Z(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}$Z=Dy;function BYe(t,e){e.options.identifier===$Z.BUTTON_OK?this.accept():this.cancel()}function LA(t,e,r){return(e=VYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VYe(t){var e=WYe(t,"string");return typeof e=="symbol"?e:e+""}function WYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const E6="ConditionCollection.filteringStates";class d${constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;LA(this,"hot",void 0),LA(this,"isMapRegistrable",void 0),LA(this,"filteringStates",new LR),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(E6,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i==null?void 0:i.conditions)!==null&&n!==void 0?n:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sh;return e.length?NGe(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sh,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=r.args.map(u=>typeof u=="string"?u.toLocaleLowerCase(s):u),a=r.name||r.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==n)throw Error(Qt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Dr(Iy[n]))throw new Error(Qt`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:o,func:Ih(a,o)}]},i):c.push({name:a,args:o,func:Ih(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:s.map(o=>{let{name:a,args:l}=o;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(r=>{r.conditions.forEach(n=>this.addCondition(r.column,n))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(E6),this.filteringStates=null,this.clearLocalHooks()}}ur(d$,fi);function R6(t,e,r){return(e=jYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jYe(t){var e=UYe(t,"string");return typeof e=="symbol"?e:e+""}function UYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BZ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];R6(this,"conditionCollection",void 0),R6(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return Z(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return Z(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return Z(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}function zYe(t,e){GYe(t,e),e.add(t)}function GYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vf(t,e,r){return(e=YYe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YYe(t){var e=KYe(t,"string");return typeof e=="symbol"?e:e+""}function KYe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $A(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var DS=new WeakSet;class VZ{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];zYe(this,DS),vf(this,"hot",void 0),vf(this,"conditionCollection",void 0),vf(this,"columnDataFactory",void 0),vf(this,"changes",[]),vf(this,"grouping",!1),vf(this,"latestEditedColumnPosition",-1),vf(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",i=>$A(DS,this,XYe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>$A(DS,this,qYe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>$A(DS,this,JYe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Z(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=EDe(function(u,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const d=new d$(n.hot,!1),g=[].concat(u,f);d.importAllConditions(g);const m=n.columnDataFactory(h);let p;d.isEmpty()?p=m:p=new BZ(d,v=>n.columnDataFactory(v)).filter(),p=At(p,v=>v.meta.visualRow);const w=F1(p);return d.destroy(),Od(m,v=>w(v.meta.visualRow))})(o),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),St(this,(e,r)=>{this[r]=null})}}function XYe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function qYe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function JYe(){Z(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ur(VZ,fi);function QYe(t){return lZ({initialPage:0,size:()=>t.length,onItemSelect:(r,n)=>{const i=t[r];if(i instanceof Ny)return n;if(i.element&&!Cp(i.element))return!1;i.focus()}})}const av="filters";function ZYe(t,e){let r=-1,n;const i=QYe(e),s=h=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(av),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Da&&(h.addLocalHook("click",s(h)),h.addLocalHook("focus",s(h)),h.addLocalHook("afterClose",s(h)))}),l(t);function o(h){const f=n.getKeyboardShortcutsCtrl(),d=h.getKeyboardShortcutsCtrl();i.clear(),d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:f.getContext(av),callback:()=>{h.isSubMenu()&&h.close(),f.listen(av)}}]),!h.isSubMenu()&&f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const m=n.getNavigator();m.getCurrentPage()>-1&&(r=m.getCurrentPage()),m.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const m=e[i.getCurrentPage()];m instanceof Oy&&(m.openOptions(),g.preventDefault()),m instanceof My&&(m.activate(),g.preventDefault()),m instanceof Da||g.preventDefault()}}],av)}function a(){n.focus(),n.getKeyboardShortcutsCtrl().listen(av)}function l(h){h.addLocalHook("afterSelectionChange",f=>{f.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",o),h.addLocalHook("afterOpen",o),n=h}function c(){return n}function u(){return r}return{...i,listen:a,setMenu:l,getMenu:c,getLastMenuPage:u}}function eKe(t,e){WZ(t,e),e.add(t)}function BA(t,e,r){WZ(t,e),e.set(t,r)}function WZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lv(t,e,r){return(e=tKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tKe(t){var e=rKe(t,"string");return typeof e=="symbol"?e:e+""}function rKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sb(t,e,r){return t.set(gs(t,e),r),r}function Oo(t,e){return t.get(gs(t,e))}function gs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const g2="filters",nKe=250,T6=g2;var hc=new WeakMap,m2=new WeakMap,zf=new WeakMap,Ds=new WeakSet;class iKe extends Gt{static get PLUGIN_KEY(){return g2}static get PLUGIN_PRIORITY(){return nKe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var r;super(e),r=this,eKe(this,Ds),lv(this,"dropdownMenuPlugin",null),lv(this,"conditionCollection",null),lv(this,"conditionUpdateObserver",null),lv(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),lv(this,"filtersRowsMap",null),BA(this,hc,void 0),BA(this,m2,new WeakSet),BA(this,zf,[]),this.hot.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return gs(Ds,r,hKe).call(r,...i)})}isEnabled(){return!!this.hot.getSettings()[g2]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new R1),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,n=r&&r.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>gs(Ds,this,k6).call(this,"accept")),a.addLocalHook("cancel",()=>gs(Ds,this,k6).call(this,"cancel")),a.addLocalHook("change",l=>gs(Ds,this,uKe).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(vL)}:`,o=()=>`${this.hot.getTranslatedPhrase(wL)}:`;if(!this.components.get("filter_by_condition")){const a=new d2(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:n});a.addLocalHook("afterClose",()=>gs(Ds,this,P6).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new gYe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new d2(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});a.addLocalHook("afterClose",()=>gs(Ds,this,P6).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new IYe(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Dy(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new d$(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new VZ(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>gs(Ds,this,fKe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return gs(Ds,e,cKe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>gs(Ds,this,lKe).call(this)),this.addHook("afterDropdownMenuShow",()=>gs(Ds,this,oKe).call(this)),this.addHook("afterDropdownMenuHide",()=>gs(Ds,this,aKe).call(this)),this.addHook("afterChange",a=>gs(Ds,this,sKe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Oo(hc,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const c=Oo(hc,this).getMenu(),u=c.getNavigator(),h=Oo(hc,this).getLastMenuPage();c.focus(),h>0?u.setCurrentPage(h):u.toFirstItem()}},...Array.from(this.components).map(c=>{let[,u]=c;return u.getElements()}).flat()];sb(hc,this,ZYe(this.dropdownMenuPlugin.menu,a));const l=c=>{Oo(hc,this).listen(),c.preventDefault(),x1(c.keyCode,"TAB")&&(c.shiftKey?Oo(hc,this).toPreviousItem():Oo(hc,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:T6})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(T6)}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Sh;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const s=this.exportConditions(),o=this.hot.runHooks("beforeFilter",s,Oo(zf,this));if(o!==!1&&n){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=At(r.filter(),c=>c.meta.visualRow);const l=F1(i);je(this.hot.countSourceRows()-1,c=>{l(c)||a.push(c)}),Z(a,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),sb(zf,this,this.exportConditions())}else o!==!1&&!n?(sb(zf,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Oo(zf,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),o!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return Z(this.hot.getSourceDataAtCol(r),(i,s)=>{var o;const{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:f,dateFormat:d,locale:g}=this.hot.getCellMeta(s,r),m=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&o!==void 0?o:i;n.push({meta:{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:f,dateFormat:d,locale:g},value:c$(m)})}),n}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=f2(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===U_&&r.command.key!==qn&&n.command.key!==qn&&i.command.key!==qn?s=h$:i.command.key!==qn&&(r.command.key===qn||n.command.key===qn)&&(s=Sh),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new BZ(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Z(i,o=>{Z(r.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function sKe(t){t&&Z(t,e=>{const[,r]=e,n=this.hot.propToCol(r);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function oKe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function aKe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function lKe(){const t=this.dropdownMenuPlugin.menu;Oo(m2,this).has(t)||Oo(hc,this).setMenu(t),Oo(m2,this).add(t)}function cKe(t){t.items.push({name:yt}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function k6(t){var e;if(t==="accept"){const n=this.getSelectedColumn();if(n===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=n,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(i);c===-1&&(c=void 0),this.conditionCollection.removeConditions(i),s.command.key!==qn&&(this.conditionCollection.addCondition(i,s,l,c),o.command.key!==qn&&this.conditionCollection.addCondition(i,o,l,c)),a.command.key!==qn&&this.conditionCollection.addCondition(i,a,l,c),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function uKe(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===d2&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function P6(){this.setListeningDropdownMenu()}function hKe(t,e,r){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)&&r===this.hot.view.getColumnHeadersCount()-1?Se(e,"htFiltersActive"):Je(e,"htFiltersActive")}function fKe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:n},conditionArgsChange:i}=t;Array.isArray(i)&&sb(zf,this,Oo(zf,this).map(a=>(a.column===n&&r.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const s=r.filter(a=>a.name===rd),o=r.filter(a=>a.name!==rd);if(s.length>=2||o.length>=3)zt(Qt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_operators").updateState(a,n),this.components.get("filter_by_value").updateState(t)}}const jZ="internal-use-in-handsontable",p2={licenseKey:jZ,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function UZ(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Ti])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function zZ(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function dKe(t){var e;const r=t[Ti],n=zZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=UZ(t);return{...p2,...n,...i}}function gKe(t){var e;const r=t[Ti],n=zZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=UZ(t);return{...n,...i}}function mKe(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function oT(){const t="engine_relationship",e=Zo(Ti);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function g$(){const t="shared_engine_usage",e=Zo(Ti);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function pKe(t){const e=t.getSettings(),r=e[Ti],n=r==null?void 0:r.engine;if(r===!0||Dr(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return vKe((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&Dr(n.hyperformula)){const s=oT(),o=g$().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:jZ}),(n.getConfig().leapYear1900!==p2.leapYear1900||PF(n.getConfig().nullDate,p2.nullDate)===!1)&&zt(Qt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function vKe(t,e,r){const n=e[Ti],i=dKe(e),s=oT(),o=g$();wKe(t,n.functions),yKe(t,n.language);const a=t.buildEmpty(i);return s.set(a,[r]),o.set(a,[r.guid]),CKe(a,n.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function A6(t){var e;const r=oT(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function I6(t,e){if(t){const r=oT(),n=r.get(t),i=g$(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function wKe(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(o){zt(o.message)}})}function yKe(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){zt(n.message)}}}function CKe(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:o}=r;try{t.addNamedExpression(n,i,s,o)}catch(a){zt(a.message)}}),t.resumeEvaluation())}function SKe(t,e){return(Dr(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const GZ="DD/MM/YYYY";function xKe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function bKe(t){return xKe(t)?t.substr(1):t}function _Ke(t){return typeof t=="string"&&t.startsWith("=")}function m$(t,e){return typeof t=="string"&&e==="date"}function YZ(t,e){return _e(t,e,!0).isValid()}function KZ(t,e){return _e(t,e,!0).format(GZ)}function EKe(t,e){return _e(t,GZ,!0).format(e)}function XZ(t,e){const n=new Date(Date.UTC(0,0,t+-1));return _e(n).format(e)}function RKe(t,e,r){const n=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function TKe(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function kKe(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function p$(t,e,r){const n=TKe(t,RKe(t,e,r));return kKe(n)}function wf(t,e,r){PKe(t,e),e.set(t,r)}function PKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e){return t.get(qZ(t,e))}function Pu(t,e,r){return t.set(qZ(t,e),r),r}function qZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cv=new WeakMap,Au=new WeakMap,Fs=new WeakMap,FS=new WeakMap,VA=new WeakMap,WA=new WeakMap,HS=new WeakMap;class O6{constructor(e,r,n){wf(this,cv,void 0),wf(this,Au,void 0),wf(this,Fs,void 0),wf(this,FS,[]),wf(this,VA,[]),wf(this,WA,void 0),wf(this,HS,[]),Pu(cv,this,e),Pu(Au,this,r),Pu(Fs,this,n)}setRemovedHfIndexes(e){return Pu(HS,this,e.map(r=>{const n=_r(Au,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),_r(HS,this)}getRemovedHfIndexes(){return _r(HS,this)}getHfIndexFromVisualIndex(e){const r=_r(Au,this).getIndexesSequence(),n=_r(Au,this).getNotTrimmedIndexes();return r.indexOf(n[e],e)}syncMoves(e){const n=`move${$a(_r(cv,this))}s`;_r(Fs,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&_r(Fs,this).getEngine()[n](_r(Fs,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(Pu(VA,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Pu(WA,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(_r(Fs,this).isPerformingUndoRedo()||e===!1||r===!1)return;const n=p$(_r(VA,this),_r(WA,this),_r(Au,this).getNumberOfIndexes());_r(Fs,this).getSheetId()===null?_r(Fs,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${$a(_r(cv,this))}Order`;return r=>{if(_r(Fs,this).isPerformingUndoRedo())return;const n=_r(Au,this).getIndexesSequence();if(r==="update"&&n.length>0){const i=_r(FS,this).map(l=>n.indexOf(l)),s=_r(Fs,this).getEngine().getSheetDimensions(_r(Fs,this).getSheetId());let o;_r(cv,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);_r(Fs,this).getEngine()[e](_r(Fs,this).getSheetId(),i)}Pu(FS,this,n)}}init(){Pu(FS,this,_r(Au,this).getIndexesSequence())}}function yf(t,e,r){AKe(t,e),e.set(t,r)}function AKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sc(t,e){return t.get(JZ(t,e))}function Cf(t,e,r){return t.set(JZ(t,e),r),r}function JZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var LS=new WeakMap,$S=new WeakMap,jA=new WeakMap,UA=new WeakMap,zA=new WeakMap,GA=new WeakMap,YA=new WeakMap;class IKe{constructor(e,r,n){yf(this,LS,void 0),yf(this,$S,void 0),yf(this,jA,void 0),yf(this,UA,!1),yf(this,zA,!1),yf(this,GA,null),yf(this,YA,null),Cf(LS,this,new O6("row",e,this)),Cf($S,this,new O6("column",r,this)),Cf(jA,this,n)}getForAxis(e){return e==="row"?sc(LS,this):sc($S,this)}setPerformUndo(e){Cf(UA,this,e)}setPerformRedo(e){Cf(zA,this,e)}isPerformingUndoRedo(){return sc(UA,this)||sc(zA,this)}getSheetId(){return sc(YA,this)}getEngine(){return sc(GA,this)}getPostponeAction(){return sc(jA,this)}setupSyncEndpoint(e,r){Cf(GA,this,e),Cf(YA,this,r),sc(LS,this).init(),sc($S,this).init()}}function OKe(t,e){QZ(t,e),e.add(t)}function Sf(t,e,r){return(e=MKe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MKe(t){var e=NKe(t,"string");return typeof e=="symbol"?e:e+""}function NKe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KA(t,e,r){QZ(t,e),e.set(t,r)}function QZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oh(t,e,r){return t.set(Ft(t,e),r),r}function gd(t,e){return t.get(Ft(t,e))}function Ft(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Ti="formulas",DKe=["maxRows","maxColumns","language"],FKe=260;Fe.getSingleton().register("afterNamedExpressionAdded");Fe.getSingleton().register("afterNamedExpressionRemoved");Fe.getSingleton().register("afterSheetAdded");Fe.getSingleton().register("afterSheetRemoved");Fe.getSingleton().register("afterSheetRenamed");Fe.getSingleton().register("afterFormulasValuesUpdate");const t0=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Qc=new WeakMap,aT=new WeakMap,uv=new WeakMap,Wt=new WeakSet;class HKe extends Gt{constructor(){var e;super(...arguments),e=this,OKe(this,Wt),KA(this,Qc,!1),KA(this,aT,!1),KA(this,uv,[["valuesUpdated",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ft(Wt,e,ZKe).call(e,...n)}],["namedExpressionAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ft(Wt,e,eXe).call(e,...n)}],["namedExpressionRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ft(Wt,e,tXe).call(e,...n)}],["sheetAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ft(Wt,e,rXe).call(e,...n)}],["sheetRenamed",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ft(Wt,e,nXe).call(e,...n)}],["sheetRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ft(Wt,e,iXe).call(e,...n)}]]),Sf(this,"staticRegister",Zo("formulas")),Sf(this,"engine",null),Sf(this,"sheetId",null),Sf(this,"sheetName",null),Sf(this,"indexSyncer",null),Sf(this,"rowAxisSyncer",null),Sf(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Ti}static get PLUGIN_PRIORITY(){return FKe}static get SETTING_KEYS(){return[Ti,...DKe]}isEnabled(){return!!this.hot.getSettings()[Ti]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=pKe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){zt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&Ft(Wt,this,gw).call(this,n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,M6).call(r,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,N6).call(r,...i)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,M6).call(r,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,N6).call(r,...i)}),this.addHook("modifyData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,VKe).call(r,...i)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,WKe).call(r,...i)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,LKe).call(r,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,jKe).call(r,...i)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,D6).call(r,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,D6).call(r,...i)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,UKe).call(r,...i)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,zKe).call(r,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,KKe).call(r,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,XKe).call(r,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,GKe).call(r,...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,YKe).call(r,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,qKe).call(r,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,JKe).call(r,...i)}),this.indexSyncer=new IKe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("beforeColumnMove",(n,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("afterRowMove",(n,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(n,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,BKe).call(r,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,QKe).call(r,...i)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Ft(Wt,r,$Ke).call(r,...i)}),gd(uv,this).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){gd(uv,this).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),I6(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=gKe(this.hot.getSettings());mKe(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[Ti];if(Le(n)&&Le(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Ti].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const s=this.addSheet(i??void 0,this.hot.getSourceDataArray());Ft(Wt,this,gw).call(this,s)}}super.updatePlugin(e)}destroy(){gd(uv,this).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),Oh(uv,this,null),I6(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(Le(r)&&!c3e(r))return zt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return zt("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return zt(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){DF(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Ft(Wt,this,gw).call(this,e);const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${$a(Ti)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(n.has(o)||n.add(o))}),A6(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var o;const{row:a,col:l,sheet:c}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return Le(c)?`${c}:${a}x${l}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var o,a;const{row:l,col:c}=(o=s.address)!==null&&o!==void 0?o:{};if(Le(l)===!1||Le(c)===!1||l>=this.hot.countRows()||c>=this.hot.countCols())return;const u=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=n(s);if(u!==void 0&&!i.has(h)){const f=A6(this.engine).get(u);if(!f)return;f.validateCell(f.getDataAtCell(l,c),f.getCellMeta(l,c),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){zt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return m$(n,s.type)&&(YZ(n,s.dateFormat)?n=KZ(n,s.dateFormat):_Ke(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function gw(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function LKe(t,e,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(e,n)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},s=this.hot.getCellMeta(e,n);let o=this.engine.getCellValue(i);return s.type==="date"&&Ji(o)&&(o=XZ(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function $Ke(t,e,r){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=r.getTopStartCorner(),{row:c,col:u}=r.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const d=this.engine.getFillRangeData(h,f),{row:g,col:m}=h.start,{row:p,col:w}=h.end,v=p-g+1,y=w-m+1;for(let b=0;b<d.length;b+=1)for(let T=0;T<d[b].length;T+=1){const E=d[b][T],x=g+b%v,P=m+T%y,A=this.hot.getCellMeta(x,P);m$(E,A.type)&&(E.startsWith("'")?d[b][T]=E.slice(1):this.isFormulaCellType(x,P,this.sheetId)===!1&&(d[b][T]=EKe(E,A.dateFormat)))}return d}function M6(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes($a(Ti))||Oh(aT,this,Dr(this.hot.getSettings().data))}function BKe(){if(gd(aT,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((r,n)=>{r.forEach((i,s)=>{const o=this.hot.getCellMeta(n,s,{skipMetaExtension:!0}),a=o.dateFormat;m$(i,o.type)&&(YZ(i,a)?t[n][s]=KZ(i,a):i.startsWith("=")||(t[n][s]=`'${i}`))})}),Oh(Qc,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Oh(Qc,this,!1)}function N6(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(r.includes($a(Ti)))return;const n=SKe(this.engine,this.hot.getSettings()[Ti].sheetName);if(Ft(Wt,this,gw).call(this,n),r!=="updateSettings")if(gd(aT,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Oh(Qc,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Oh(Qc,this,!1)}}}function VKe(t,e,r,n){if(n!=="get"||gd(Qc,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){r.value=bKe(r.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let o=this.engine.getCellValue(s);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Ji(o)&&(o=XZ(o,a.dateFormat)),r.value=typeof o=="object"&&o!==null?o.value:o}function WKe(t,e,r,n){if(n!=="get"||gd(Qc,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null)return;const o=this.getCellType(i,s);if(o==="VALUE"||o==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(l)}function D6(t,e){if(t0(e))return;const r=[],n=[],i=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const c=this.hot.propToCol(a),u=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(c),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};u!==null&&h!==null?this.syncChangeWithEngine(o,c,l):r.push([o,c,l]),n.push({address:f})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(o=>{let[a,l,c]=o;this.syncChangeWithEngine(a,l,c)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function jKe(t,e){if(t0(e))return;const r=[],n=[];t.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!Ji(l))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){zt(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}n.push({address:c}),r.push(...this.engine.setCellContents(c,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function UKe(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function zKe(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function GKe(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function YKe(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function KKe(t,e,r){if(t0(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function XKe(t,e,r){if(t0(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function qKe(t,e,r,n){if(t0(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function JKe(t,e,r,n){if(t0(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function QKe(t,e,r){var n;Oh(Qc,this,!0);const i=this.hot.getSourceDataArray(r,0,r+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());Oh(Qc,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:r+o,sheet:this.sheetId},[[a]])})})}function ZKe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function eXe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function tXe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function rXe(t){this.hot.runHooks("afterSheetAdded",t)}function nXe(t,e){Ft(Wt,this,gw).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function iXe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function sXe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(KH,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function oXe(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(XH,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=At(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(i!==s){const h=s-i+1,f=l-a+1;if(h>f){const d=c.slice(i,s+1);u.push(...d.filter(g=>r.includes(g)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countCols()));else{const h=this.countCols()-1,f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===f&&h>s&&u.push(...c.slice(s+1))}return Z(u,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function aXe(t,e){ZZ(t,e),e.add(t)}function lXe(t,e,r){ZZ(t,e),e.set(t,r)}function ZZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xf(t,e){return t.get($u(t,e))}function F6(t,e,r){return t.set($u(t,e),r),r}function $u(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeHideColumns");Fe.getSingleton().register("afterHideColumns");Fe.getSingleton().register("beforeUnhideColumns");Fe.getSingleton().register("afterUnhideColumns");const H6="hiddenColumns",cXe=310;var sl=new WeakMap,bf=new WeakSet;class uXe extends Gt{constructor(){super(...arguments),aXe(this,bf),lXe(this,sl,null)}static get PLUGIN_KEY(){return H6}static get PLUGIN_PRIORITY(){return cXe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[H6]}enablePlugin(){var e=this;this.enabled||(F6(sl,this,new HR),xf(sl,this).addLocalHook("init",()=>$u(bf,this,pXe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,xf(sl,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $u(bf,e,mXe).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>$u(bf,this,fXe).call(this,r,n,i)),this.addHook("modifyColWidth",(r,n)=>$u(bf,this,hXe).call(this,r,n),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $u(bf,e,gXe).call(e,...n)}),this.addHook("modifyCopyableRange",r=>$u(bf,this,dXe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=xf(sl,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(c=>this.hot.toPhysicalColumn(c));Z(l,c=>{s[c]=!1}),i=Ns(s,(c,u,h)=>(u&&c.push(this.hot.toVisualColumn(h)),c),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&o)!==!1&&(n&&o&&xf(sl,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&o,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{Z(e,o=>{xf(sl,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return At(xf(sl,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return xf(sl,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){Z(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){F6(sl,this,null),super.destroy()}}function hXe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function fXe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenColumn");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function dXe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return Z(t,n=>{let i=!0,s=0;je(n.startCol,n.endCol,o=>{this.isHidden(o)?(i||r(n.startRow,n.endRow,s,o-1),i=!0):(i&&(s=o),o===n.endCol&&r(n.startRow,n.endRow,s,o),i=!1)})}),e}function gXe(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),Se(e,r)}function mXe(t){t.items.push({name:yt},sXe(this),oXe(this))}function pXe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function vXe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(qH,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function wXe(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(JH,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=At(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(i!==s){const h=s-i+1,f=l-a+1;if(h>f){const d=c.slice(i,s+1);u.push(...d.filter(g=>r.includes(g)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countRows()));else{const h=this.countRows()-1,f=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===f&&h>s&&u.push(...c.slice(s+1))}return Z(u,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function yXe(t,e){eee(t,e),e.add(t)}function CXe(t,e,r){eee(t,e),e.set(t,r)}function eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _f(t,e){return t.get(Bu(t,e))}function L6(t,e,r){return t.set(Bu(t,e),r),r}function Bu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeHideRows");Fe.getSingleton().register("afterHideRows");Fe.getSingleton().register("beforeUnhideRows");Fe.getSingleton().register("afterUnhideRows");const $6="hiddenRows",SXe=320;var ol=new WeakMap,Ef=new WeakSet;class xXe extends Gt{constructor(){super(...arguments),yXe(this,Ef),CXe(this,ol,null)}static get PLUGIN_KEY(){return $6}static get PLUGIN_PRIORITY(){return SXe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[$6]}enablePlugin(){var e=this;this.enabled||(L6(ol,this,new HR),_f(ol,this).addLocalHook("init",()=>Bu(Ef,this,kXe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_f(ol,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bu(Ef,e,TXe).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>Bu(Ef,this,_Xe).call(this,r,n,i)),this.addHook("modifyRowHeight",(r,n)=>Bu(Ef,this,bXe).call(this,r,n)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bu(Ef,e,RXe).call(e,...n)}),this.addHook("modifyCopyableRange",r=>Bu(Ef,this,EXe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=_f(ol,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(c=>this.hot.toPhysicalRow(c));Z(l,c=>{s[c]=!1}),i=Ns(s,(c,u,h)=>(u&&c.push(this.hot.toVisualRow(h)),c),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&o)!==!1&&(n&&o&&_f(ol,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&o,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{Z(e,o=>{_f(ol,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return At(_f(ol,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _f(ol,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){Z(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){L6(ol,this,null),super.destroy()}}function bXe(t,e){return this.isHidden(e)?0:t}function _Xe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenRow");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function EXe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return Z(t,n=>{let i=!0,s=0;je(n.startRow,n.endRow,o=>{this.isHidden(o)?(i||r(s,o-1,n.startCol,n.endCol),i=!0):(i&&(s=o),o===n.endRow&&r(s,o,n.startCol,n.endCol),i=!1)})}),e}function RXe(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),Se(e,r)}function TXe(t){t.items.push({name:yt},vXe(this),wXe(this))}function kXe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function PXe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(_H)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function AXe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(EH)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function IXe(t,e){tee(t,e),e.add(t)}function OXe(t,e,r){tee(t,e),e.set(t,r)}function tee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v2(t,e){return t.get(G_(t,e))}function XA(t,e,r){return t.set(G_(t,e),r),r}function G_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeColumnFreeze");Fe.getSingleton().register("afterColumnFreeze");Fe.getSingleton().register("beforeColumnUnfreeze");Fe.getSingleton().register("afterColumnUnfreeze");const B6="manualColumnFreeze",MXe=110;var Bf=new WeakMap,qA=new WeakSet;class NXe extends Gt{constructor(){super(...arguments),IXe(this,qA),OXe(this,Bf,!1)}static get PLUGIN_KEY(){return B6}static get PLUGIN_PRIORITY(){return MXe}isEnabled(){return!!this.hot.getSettings()[B6]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>G_(qA,this,DXe).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>G_(qA,this,FXe).call(this,e,r)),super.enablePlugin())}disablePlugin(){XA(Bf,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;v2(Bf,this)||XA(Bf,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;v2(Bf,this)||XA(Bf,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function DXe(t){t.items.push({name:"---------"},PXe(this),AXe(this))}function FXe(t,e){if(v2(Bf,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(n=>n<r))return!1}}function BS(t,e,r){return(e=HXe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HXe(t){var e=LXe(t,"string");return typeof e=="symbol"?e:e+""}function LXe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const JA=0,V6=1,W6=2,Yg="px";let ree=class{constructor(e){BS(this,"hot",void 0),BS(this,"_element",null),BS(this,"state",JA),BS(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=W6}build(){this.state===JA&&(this._element=this.hot.rootDocument.createElement("div"),this.state=V6)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=JA}isAppended(){return this.state===W6}isBuilt(){return this.state>=V6}setPosition(e,r){Ji(e)&&(this._element.style.top=e+Yg),Ji(r)&&(this._element.style[this.inlineProperty]=r+Yg)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){Ji(e)&&(this._element.style.width=e+Yg),Ji(r)&&(this._element.style.height=r+Yg)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){Ji(e)&&(this._element.style.marginTop=e+Yg),Ji(r)&&(this._element.style[`margin${$a(this.inlineProperty)}`]=r+Yg)}getOffset(){const e=this._element.style,r=`margin${$a(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const $Xe="ht__manualColumnMove--backlight";let BXe=class extends ree{build(){super.build(),Se(this._element,$Xe)}};const VXe="ht__manualColumnMove--guideline";let WXe=class extends ree{build(){super.build(),Se(this._element,VXe)}};function jXe(t,e){nee(t,e),e.add(t)}function ca(t,e,r){nee(t,e),e.set(t,r)}function nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ss(t,e,r){return t.set(Vu(t,e),r),r}function Ve(t,e){return t.get(Vu(t,e))}function Vu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeColumnMove");Fe.getSingleton().register("afterColumnMove");const QA="manualColumnMove",UXe=120,j6="ht__manualColumnMove",Y_="show-ui",w2="on-moving--columns",y2="after-selection--columns";var Xi=new WeakMap,zu=new WeakMap,Ac=new WeakMap,ob=new WeakMap,ah=new WeakMap,Gi=new WeakMap,VS=new WeakMap,Ro=new WeakMap,hm=new WeakMap,K_=new WeakMap,mw=new WeakMap,Rf=new WeakSet;class zXe extends Gt{constructor(){super(...arguments),jXe(this,Rf),ca(this,Xi,new BXe(this.hot)),ca(this,zu,new WXe(this.hot)),ca(this,Ac,[]),ca(this,ob,0),ca(this,ah,!1),ca(this,Gi,{}),ca(this,VS,void 0),ca(this,Ro,void 0),ca(this,hm,void 0),ca(this,K_,void 0),ca(this,mw,void 0)}static get PLUGIN_KEY(){return QA}static get PLUGIN_PRIORITY(){return UXe}isEnabled(){return!!this.hot.getSettings()[QA]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vu(Rf,e,GXe).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vu(Rf,e,KXe).call(e,...n)}),this.addHook("afterScrollVertically",()=>Vu(Rf,this,qXe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vu(Rf,e,JXe).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Se(this.hot.rootElement,j6),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Je(this.hot.rootElement,j6),this.unregisterEvents(),Ve(Xi,this).destroy(),Ve(zu,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=Ve(VS,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,n,i);if(Ss(VS,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=i&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,n,i,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r);return Ss(VS,this,r),this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Ns(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const o=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[QA];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return je(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Ve(Ro,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Ve(Ro,this)-1);const o=r.hider.offsetWidth,a=r.TBODY.offsetLeft,l=Ve(Xi,this).getOffset().start,c=Ve(Xi,this).getSize().width;let u=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,m=mn(this.hot.rootElement),p=g.innerWidth-Ve(hm,this)-m;h=g.innerWidth-Ve(Gi,this).eventPageX-p-(n.scrollX===void 0?i:0)}else h=Ve(Gi,this).eventPageX-(Ve(hm,this)-(n.scrollX===void 0?i:0));if(Ve(K_,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Ve(Ro,this))&&(s+=i),s+=u,Ve(Ro,this)<0)Ve(mw,this)>0?Ve(Gi,this).col=0:Ve(Gi,this).col=e>0?e-1:e;else if(Ve(Gi,this).TD.offsetWidth/2+s<=h){const g=Ve(Ro,this)>=Ve(ob,this)?Ve(ob,this)-1:Ve(Ro,this);Ve(Gi,this).col=g+1,s+=Ve(Gi,this).TD.offsetWidth}else Ve(Gi,this).col=Ve(Ro,this);let f=h,d=s;h+c+l>=o?f=o-c-l:h+l<a+u&&(f=a+u+Math.abs(l)),s>=o-1?d=o-1:d===0?d=1:n.scrollX!==void 0&&Ve(Ro,this)<Ve(mw,this)&&(d-=Ve(hm,this)<=n.scrollX?Ve(hm,this):0),Ve(Xi,this).setPosition(null,f),Ve(zu,this).setPosition(null,d)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Vu(Rf,this,YXe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Vu(Rf,this,XXe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ve(Xi,this).build(),Ve(zu,this).build()}destroy(){Ve(Xi,this).destroy(),Ve(zu,this).destroy(),super.destroy()}}function GXe(t,e,r,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=tt(t.target,"sortAction");if(!o||!s||Ve(ah,this)||t.button!==0||a){Ss(ah,this,!1),Ve(Ac,this).length=0,Je(this.hot.rootElement,[w2,Y_]);return}const l=Ve(zu,this).isBuilt()&&!Ve(zu,this).isAppended(),c=Ve(Xi,this).isBuilt()&&!Ve(Xi,this).isAppended();l&&c&&(Ve(zu,this).appendTo(i.hider),Ve(Xi,this).appendTo(i.hider));const{from:u,to:h}=o,f=Math.min(u.col,h.col),d=Math.max(u.col,h.col);if(e.row<0&&e.col>=f&&e.col<=d){n.column=!0,Ss(ah,this,!0);const g=r.firstChild?ADe(t,r.firstChild).x:t.offsetX;Ve(Gi,this).eventPageX=t.pageX,Ss(Ro,this,e.col),Ve(Gi,this).TD=r,Ve(Gi,this).col=e.col,Ss(Ac,this,this.prepareColumnsToMoving(f,d)),Ss(K_,this,!!this.hot.getSettings().rowHeaders),Ss(ob,this,this.hot.countCols()),Ss(mw,this,this.hot.getSettings().fixedColumnsStart),Ss(hm,this,Ai(this.hot.rootElement).left);const m=Ve(K_,this)?-1:0,p=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,w=e.col<Ve(mw,this),v=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),y=Math.abs(g-(this.hot.isRtl()?r.offsetWidth:0)),b=this.getColumnsWidth(f,e.col-1)+y,T=this.getColumnsWidth(m,f-1)+(w?v:0)+b;Ve(Xi,this).setPosition(p,T),Ve(Xi,this).setSize(this.getColumnsWidth(f,d),i.hider.offsetHeight-p),Ve(Xi,this).setOffset(null,-b),Se(this.hot.rootElement,w2)}else Je(this.hot.rootElement,y2),Ss(ah,this,!1),Ve(Ac,this).length=0}function YXe(t){Ve(ah,this)&&(Ve(Gi,this).eventPageX=t.pageX,this.refreshPositions())}function KXe(t,e,r,n){!this.hot.getSelectedRangeLast()||!Ve(ah,this)||(Ve(Ac,this).indexOf(e.col)>-1?Je(this.hot.rootElement,Y_):Se(this.hot.rootElement,Y_),n.row=!0,n.column=!0,n.cell=!0,Ss(Ro,this,e.col),Ve(Gi,this).TD=r)}function XXe(){const t=Ve(Gi,this).col,e=Ve(Ac,this).length;if(Ss(Ro,this,void 0),Ss(ah,this,!1),Je(this.hot.rootElement,[w2,Y_,y2]),this.hot.selection.isSelectedByColumnHeader()&&Se(this.hot.rootElement,y2),e<1||t===void 0)return;const r=Ve(Ac,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns(Ve(Ac,this),t);if(Ve(Ac,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(n),o=s+e-1;this.hot.selectColumns(s,o)}}function qXe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,n=e+r;Ve(Xi,this).setPosition(n),Ve(Xi,this).setSize(null,t.hider.offsetHeight-n)}function JXe(){this.moveBySettingsOrLoad()}function QXe(t,e){iee(t,e),e.add(t)}function vi(t,e,r){iee(t,e),e.set(t,r)}function iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tn(t,e,r){return t.set(wa(t,e),r),r}function He(t,e){return t.get(wa(t,e))}function wa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const X_="manualColumnResize",ZXe=130,U6="manualColumnWidths";var vc=new WeakMap,WS=new WeakMap,zs=new WeakMap,q_=new WeakMap,Tl=new WeakMap,eqe=new WeakMap,tp=new WeakMap,jS=new WeakMap,ds=new WeakMap,fc=new WeakMap,Bd=new WeakMap,J_=new WeakMap,pw=new WeakMap,vw=new WeakMap,Ks=new WeakMap,ww=new WeakMap,al=new WeakSet;class tqe extends Gt{static get PLUGIN_KEY(){return X_}static get PLUGIN_PRIORITY(){return ZXe}constructor(e){super(e),QXe(this,al),vi(this,vc,null),vi(this,WS,null),vi(this,zs,[]),vi(this,q_,null),vi(this,Tl,null),vi(this,eqe,null),vi(this,tp,null),vi(this,jS,null),vi(this,ds,this.hot.rootDocument.createElement("DIV")),vi(this,fc,this.hot.rootDocument.createElement("DIV")),vi(this,Bd,null),vi(this,J_,!1),vi(this,pw,0),vi(this,vw,null),vi(this,Ks,void 0),vi(this,ww,void 0),Se(He(ds,this),"manualColumnResizer"),Se(He(fc,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[X_]}enablePlugin(){var e=this;this.enabled||(tn(Ks,this,new jh),He(Ks,this).addLocalHook("init",()=>wa(al,this,rqe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,He(Ks,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return wa(al,e,lqe).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return wa(al,e,cqe).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return wa(al,e,uqe).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tn(ww,this,He(Ks,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",U6,He(Ks,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",U6,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return He(Ks,this).setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);He(Ks,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;tn(vc,this,e);const{_wt:r}=this.hot.view,n=r.wtTable.getCoords(He(vc,this)),i=n.col;if(i<0)return;const s=An(He(vc,this)),o=He(vc,this).getBoundingClientRect(),a=i<r.getSetting("fixedColumnsStart");let l;a&&(l=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(He(vc,this),n.row,n.col)),l||(l=r.wtOverlays.topOverlay.getRelativeCellPosition(He(vc,this),n.row,n.col)),tn(WS,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),tn(zs,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const u=this.hot.getSelectedRange();Z(u,h=>{const f=h.getTopStartCorner().col,d=h.getBottomEndCorner().col;je(f,d,g=>{He(zs,this).includes(g)||He(zs,this).push(g)})})}He(zs,this).includes(He(WS,this))||tn(zs,this,[He(WS,this)]),tn(jS,this,l.start-6),tn(tp,this,parseInt(o.width,10)),He(ds,this).style.top=`${l.top}px`,He(ds,this).style[this.inlineDir]=`${He(jS,this)+He(tp,this)}px`,He(ds,this).style.height=`${s}px`,this.hot.rootElement.appendChild(He(ds,this))}refreshHandlePosition(){He(ds,this).style[this.inlineDir]=`${He(jS,this)+He(q_,this)}px`}setupGuidePosition(){const e=parseInt(An(He(ds,this)),10),r=parseInt(He(ds,this).style.top,10)+e,n=this.hot.view.getTableHeight();Se(He(ds,this),"active"),Se(He(fc,this),"active"),He(fc,this).style.top=`${r}px`,this.refreshGuidePosition(),He(fc,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(He(fc,this))}refreshGuidePosition(){He(fc,this).style[this.inlineDir]=He(ds,this).style[this.inlineDir]}hideHandleAndGuide(){Je(He(ds,this),"active"),Je(He(fc,this),"active")}checkIfColumnHeader(e){const r=Md(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",He(Tl,this),n,!0);s!==void 0&&tn(Tl,this,s),this.setManualSize(n,He(Tl,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",He(Tl,this),n,!0),i&&e()};He(pw,this)>=2&&(He(zs,this).length>1?(Z(He(zs,this),i=>{r(i)}),e()):Z(He(zs,this),i=>{r(i,!0)})),tn(pw,this,0),tn(vw,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>wa(al,this,nqe).call(this,n)),this.eventManager.addEventListener(r,"mousedown",n=>wa(al,this,iqe).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>wa(al,this,sqe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>wa(al,this,oqe).call(this)),this.eventManager.addEventListener(He(ds,this),"contextmenu",()=>wa(al,this,aqe).call(this))}destroy(){super.destroy()}}function rqe(){const t=this.hot.getSettings()[X_],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,n)=>{He(Ks,this).setValueAtIndex(n,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,n)=>{He(Ks,this).setValueAtIndex(n,r)})},!0),tn(ww,this,t)):t===!0&&Array.isArray(He(ww,this))&&this.hot.batchExecution(()=>{He(ww,this).forEach((r,n)=>{He(Ks,this).setValueAtIndex(n,r)})},!0)}function nqe(t){if(!Hq(t.target)&&He(J_,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(He(Bd,this)||this.setupHandlePosition(e))}}function iqe(t){t.target.parentNode===this.hot.rootElement&&tt(t.target,"manualColumnResizer")&&(this.setupHandlePosition(He(vc,this)),this.setupGuidePosition(),tn(Bd,this,!0),He(vw,this)===null&&(tn(vw,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(He(vw,this))),tn(pw,this,He(pw,this)+1),this.startX=t.pageX,tn(Tl,this,He(tp,this)))}function sqe(t){if(He(Bd,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();tn(q_,this,He(tp,this)+e),Z(He(zs,this),r=>{tn(Tl,this,this.setManualSize(r,He(q_,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function oqe(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeColumnResize",He(Tl,this),r,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",He(Tl,this),r,!1)};He(Bd,this)&&(this.hideHandleAndGuide(),tn(Bd,this,!1),He(Tl,this)!==He(tp,this)&&(He(zs,this).length>1?(Z(He(zs,this),n=>{e(n)}),t()):Z(He(zs,this),n=>{e(n,!0)})),this.setupHandlePosition(He(vc,this)))}function aqe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(He(ds,this)),this.hot.rootElement.removeChild(He(fc,this)),tn(Bd,this,!1),tn(J_,this,!0),this.hot._registerImmediate(()=>{tn(J_,this,!1)})}function lqe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalColumn(e),i=He(Ks,this).getValueAtIndex(n);this.hot.getSettings()[X_]&&i&&(r=i)}return r}function cqe(t,e){const r=He(Ks,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function uqe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function ZA(t,e,r){return(e=hqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hqe(t){var e=fqe(t,"string");return typeof e=="symbol"?e:e+""}function fqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eI=0,z6=1,G6=2,Kg="px";let see=class{constructor(e){ZA(this,"hot",void 0),ZA(this,"_element",null),ZA(this,"state",eI),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=G6}build(){this.state===eI&&(this._element=this.hot.rootDocument.createElement("div"),this.state=z6)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=eI}isAppended(){return this.state===G6}isBuilt(){return this.state>=z6}setPosition(e,r){e!==void 0&&(this._element.style.top=e+Kg),r!==void 0&&(this._element.style.left=r+Kg)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+Kg),r&&(this._element.style.height=r+Kg)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+Kg),r&&(this._element.style.marginLeft=r+Kg)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const dqe="ht__manualRowMove--backlight";class gqe extends see{build(){super.build(),Se(this._element,dqe)}}const mqe="ht__manualRowMove--guideline";class pqe extends see{build(){super.build(),Se(this._element,mqe)}}function vqe(t,e){oee(t,e),e.add(t)}function Xg(t,e,r){oee(t,e),e.set(t,r)}function oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nd(t,e,r){return t.set(Wu(t,e),r),r}function lt(t,e){return t.get(Wu(t,e))}function Wu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeRowMove");Fe.getSingleton().register("afterRowMove");const tI="manualRowMove",wqe=140,Y6="ht__manualRowMove",Q_="show-ui",C2="on-moving--rows",S2="after-selection--rows";var qi=new WeakMap,Gu=new WeakMap,Ic=new WeakMap,lh=new WeakMap,xs=new WeakMap,US=new WeakMap,Tf=new WeakSet;class yqe extends Gt{constructor(){super(...arguments),vqe(this,Tf),Xg(this,qi,new gqe(this.hot)),Xg(this,Gu,new pqe(this.hot)),Xg(this,Ic,[]),Xg(this,lh,void 0),Xg(this,xs,{}),Xg(this,US,void 0)}static get PLUGIN_KEY(){return tI}static get PLUGIN_PRIORITY(){return wqe}isEnabled(){return!!this.hot.getSettings()[tI]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Wu(Tf,e,Cqe).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Wu(Tf,e,xqe).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>Wu(Tf,this,_qe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Wu(Tf,e,Eqe).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Se(this.hot.rootElement,Y6),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Je(this.hot.rootElement,Y6),this.unregisterEvents(),lt(qi,this).destroy(),lt(Gu,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=lt(US,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,n,i);if(nd(US,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=i&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,n,i,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r);return nd(US,this,r),this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Ns(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const o=n.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[tI];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),o=Math.max(n.row,i.row);return je(s,o,a=>{r.push(a)}),r}refreshPositions(){const e=lt(xs,this).coords,r=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=lt(xs,this).TD,a=this.hot.rootElement,l=Ai(a),c=Sy(a),u=s.holder.scrollTop,h=this.hot.rootWindow!==c?c.scrollTop:0,f=l.top-h,d=lt(xs,this).eventPageY-f+u,g=s.hider.offsetHeight,m=s.TBODY.offsetTop,p=lt(qi,this).getOffset().top,w=lt(qi,this).getSize().height,v=o.offsetHeight/2,y=o.offsetHeight;let b=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const T=d>=b+v;this.isFixedRowTop(e.row)&&(b+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?lt(xs,this).row=r>0?r-1:r:T?(lt(xs,this).row=e.row+1,b+=e.row===0?y-1:y):lt(xs,this).row=e.row;let E=d,x=b;d+w+p>=g?E=g-w-p:d+p<m&&(E=m+Math.abs(p)),b>=g-1&&(x=g-1),lt(qi,this).setPosition(E),lt(Gu,this).setPosition(x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Wu(Tf,this,Sqe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Wu(Tf,this,bqe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){lt(qi,this).build(),lt(Gu,this).build()}destroy(){lt(qi,this).destroy(),lt(Gu,this).destroy(),super.destroy()}}function Cqe(t,e,r,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||lt(lh,this)||t.button!==0){nd(lh,this,!1),lt(Ic,this).length=0,Je(this.hot.rootElement,[C2,Q_]);return}const l=lt(Gu,this).isBuilt()&&!lt(Gu,this).isAppended(),c=lt(qi,this).isBuilt()&&!lt(qi,this).isAppended();l&&c&&(lt(Gu,this).appendTo(i.hider),lt(qi,this).appendTo(i.hider));const{from:u,to:h}=a,f=Math.min(u.row,h.row),d=Math.max(u.row,h.row);if(e.col<0&&e.row>=f&&e.row<=d){n.row=!0,nd(lh,this,!0),lt(xs,this).eventPageY=t.pageY,lt(xs,this).coords=e,lt(xs,this).TD=r,nd(Ic,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+s.getRowHeaderWidth(),m=this.getRowsHeight(f,e.row-1)+(t.clientY-r.getBoundingClientRect().top);lt(qi,this).setPosition(null,g),lt(qi,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(f,d)),lt(qi,this).setOffset(-m,null),Se(this.hot.rootElement,C2),this.refreshPositions()}else Je(this.hot.rootElement,S2),nd(lh,this,!1),lt(Ic,this).length=0}function Sqe(t){lt(lh,this)&&(lt(xs,this).eventPageY=t.pageY,this.refreshPositions())}function xqe(t,e,r,n){!this.hot.getSelectedRangeLast()||!lt(lh,this)||(lt(Ic,this).indexOf(e.row)>-1?Je(this.hot.rootElement,Q_):Se(this.hot.rootElement,Q_),n.row=!0,n.column=!0,n.cell=!0,lt(xs,this).coords=e,lt(xs,this).TD=r)}function bqe(){const t=lt(xs,this).row,e=lt(Ic,this).length;if(nd(lh,this,!1),Je(this.hot.rootElement,[C2,Q_,S2]),this.hot.selection.isSelectedByRowHeader()&&Se(this.hot.rootElement,S2),e<1||t===void 0)return;const r=lt(Ic,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(lt(Ic,this),t);if(lt(Ic,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(n),o=s+e-1;this.hot.selectRows(s,o)}}function _qe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,n=e+r;lt(qi,this).setPosition(null,n),lt(qi,this).setSize(t.hider.offsetWidth-n)}function Eqe(){this.moveBySettingsOrLoad()}function Rqe(t,e){aee(t,e),e.add(t)}function wi(t,e,r){aee(t,e),e.set(t,r)}function aee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vr(t,e,r){return t.set(wc(t,e),r),r}function De(t,e){return t.get(wc(t,e))}function wc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Z_="manualRowResize",Tqe=30,K6="manualRowHeights";var Cl=new WeakMap,zS=new WeakMap,Gs=new WeakMap,yw=new WeakMap,Yu=new WeakMap,v$=new WeakMap,rp=new WeakMap,GS=new WeakMap,ji=new WeakMap,pl=new WeakMap,Vd=new WeakMap,eE=new WeakMap,Cw=new WeakMap,Sw=new WeakMap,xa=new WeakMap,xw=new WeakMap,Iu=new WeakSet;class kqe extends Gt{static get PLUGIN_KEY(){return Z_}static get PLUGIN_PRIORITY(){return Tqe}constructor(e){super(e),Rqe(this,Iu),wi(this,Cl,null),wi(this,zS,null),wi(this,Gs,[]),wi(this,yw,null),wi(this,Yu,null),wi(this,v$,null),wi(this,rp,null),wi(this,GS,null),wi(this,ji,this.hot.rootDocument.createElement("DIV")),wi(this,pl,this.hot.rootDocument.createElement("DIV")),wi(this,Vd,!1),wi(this,eE,!1),wi(this,Cw,0),wi(this,Sw,null),wi(this,xa,void 0),wi(this,xw,void 0),Se(De(ji,this),"manualRowResizer"),Se(De(pl,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Z_]}enablePlugin(){this.enabled||(Vr(xa,this,new jh),De(xa,this).addLocalHook("init",()=>wc(Iu,this,Dqe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,De(xa,this)),this.addHook("modifyRowHeight",(e,r)=>wc(Iu,this,Nqe).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vr(xw,this,De(xa,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",K6,De(xa,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",K6,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,this.hot.stylesHandler.getDefaultRowHeight());return De(xa,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return De(yw,this)}setupHandlePosition(e){Vr(Cl,this,e);const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(De(Cl,this)),s=i.row;if(s<0)return;const o=mn(De(Cl,this)),a=De(Cl,this).getBoundingClientRect(),l=s<n.getSetting("fixedRowsTop"),c=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let u;l?u=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(De(Cl,this),i.row,i.col):c&&(u=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(De(Cl,this),i.row,i.col)),u||(u=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(De(Cl,this),i.row,i.col)),Vr(zS,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Vr(Gs,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();Z(f,d=>{const g=d.getTopStartCorner().row,m=d.getBottomStartCorner().row;je(g,m,p=>{De(Gs,this).includes(p)||De(Gs,this).push(p)})})}De(Gs,this).includes(De(zS,this))||Vr(Gs,this,[De(zS,this)]),Vr(GS,this,u.top-6),Vr(rp,this,parseInt(a.height,10)),De(ji,this).style.top=`${De(GS,this)+De(rp,this)}px`,De(ji,this).style[this.inlineDir]=`${u.start}px`,De(ji,this).style.width=`${o}px`,this.hot.rootElement.appendChild(De(ji,this))}refreshHandlePosition(){De(ji,this).style.top=`${De(GS,this)+De(yw,this)}px`}setupGuidePosition(){const e=parseInt(mn(De(ji,this)),10),r=parseInt(De(ji,this).style[this.inlineDir],10)+e,n=this.hot.view.getTableWidth();Se(De(ji,this),"active"),Se(De(pl,this),"active"),De(pl,this).style.top=De(ji,this).style.top,De(pl,this).style[this.inlineDir]=`${r}px`,De(pl,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(De(pl,this))}refreshGuidePosition(){De(pl,this).style.top=De(ji,this).style.top}hideHandleAndGuide(){Je(De(ji,this),"active"),Je(De(pl,this),"active")}checkIfRowHeader(e){const r=Md(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&De(Yu,this)<r?r:De(Yu,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&Vr(Yu,this,s),this.setManualSize(n,De(Yu,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};De(Cw,this)>=2&&(De(Gs,this).length>1?(Z(De(Gs,this),i=>{r(i)}),e()):Z(De(Gs,this),i=>{r(i,!0)})),Vr(Cw,this,0),Vr(Sw,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>wc(Iu,this,Pqe).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>wc(Iu,this,Aqe).call(this,n)),this.eventManager.addEventListener(r,"mousemove",n=>wc(Iu,this,Iqe).call(this,n)),this.eventManager.addEventListener(r,"mouseup",()=>wc(Iu,this,Oqe).call(this)),this.eventManager.addEventListener(De(ji,this),"contextmenu",()=>wc(Iu,this,Mqe).call(this))}destroy(){super.destroy()}}function Pqe(t){if(!Hq(t.target)&&De(eE,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(De(Vd,this)||this.setupHandlePosition(e))}}function Aqe(t){tt(t.target,"manualRowResizer")&&(this.setupHandlePosition(De(Cl,this)),this.setupGuidePosition(),Vr(Vd,this,!0),De(Sw,this)===null&&(Vr(Sw,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(De(Sw,this))),Vr(Cw,this,De(Cw,this)+1),Vr(v$,this,t.pageY),Vr(Yu,this,De(rp,this)))}function Iqe(t){De(Vd,this)&&(Vr(yw,this,De(rp,this)+(t.pageY-De(v$,this))),Z(De(Gs,this),e=>{Vr(Yu,this,this.setManualSize(e,De(yw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Oqe(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};De(Vd,this)&&(this.hideHandleAndGuide(),Vr(Vd,this,!1),De(Yu,this)!==De(rp,this)&&(De(Gs,this).length>1?(Z(De(Gs,this),n=>{e(n)}),t()):Z(De(Gs,this),n=>{e(n,!0)})),this.setupHandlePosition(De(Cl,this)))}function Mqe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(De(ji,this)),this.hot.rootElement.removeChild(De(pl,this)),Vr(Vd,this,!1),Vr(eE,this,!0),this.hot._registerImmediate(()=>{Vr(eE,this,!1)})}function Nqe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalRow(e),i=De(xa,this).getValueAtIndex(n);this.hot.getSettings()[Z_]&&i&&(r=i)}return r}function Dqe(){const t=this.hot.getSettings()[Z_],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,n)=>{De(xa,this).setValueAtIndex(n,r)}):Array.isArray(t)?(t.forEach((r,n)=>{De(xa,this).setValueAtIndex(n,r)}),Vr(xw,this,t)):t===!0&&Array.isArray(De(xw,this))&&De(xw,this).forEach((r,n)=>{De(xa,this).setValueAtIndex(n,r)})},!0)}var Fqe=MR;Fqe("flatMap");var Hqe=Mn,X6=Dn,Lqe=Ul,$qe=KD,Bqe=function(t,e){(!e||typeof t!="string")&&X6(t);var r=$qe(t);return Lqe(X6(r!==void 0?Hqe(r,t):t))},Vqe=wr,x2=Mn,Wqe=Os,b2=Dn,jqe=Ul,Uqe=Bqe,zqe=eF,_2=Ms,Gqe=tF,Yqe=Bh,lee=!Gqe("flatMap",function(){}),E2=!lee&&Yqe("flatMap",TypeError),Kqe=lee||E2,Xqe=zqe(function(){for(var t=this.iterator,e=this.mapper,r,n;;){if(n=this.inner)try{if(r=b2(x2(n.next,n.iterator)),!r.done)return r.value;this.inner=null}catch(i){_2(t,"throw",i)}if(r=b2(x2(this.next,t)),this.done=!!r.done)return;try{this.inner=Uqe(e(r.value,this.counter++),!1)}catch(i){_2(t,"throw",i)}}});Vqe({target:"Iterator",proto:!0,real:!0,forced:Kqe},{flatMap:function(e){b2(this);try{Wqe(e)}catch(r){_2(this,"throw",r)}return E2?x2(E2,this,e):new Xqe(jqe(this),{mapper:e,inner:null})}});function qqe(t,e,r){Jqe(t,e),e.set(t,r)}function Jqe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kf(t,e,r){return(e=Qqe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qqe(t){var e=Zqe(t,"string");return typeof e=="symbol"?e:e+""}function Zqe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q6(t,e){return t.get(cee(t,e))}function YS(t,e,r){return t.set(cee(t,e),r),r}function cee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pf=new WeakMap;class Sl{constructor(e,r,n,i,s,o){kf(this,"row",void 0),kf(this,"col",void 0),kf(this,"rowspan",void 0),kf(this,"colspan",void 0),kf(this,"removed",!1),kf(this,"cellCoordsFactory",void 0),kf(this,"cellRangeFactory",void 0),qqe(this,Pf,null),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return Qt`The merged cell declared with {row: ${r}, col: ${n},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:n}=e;return Qt`The merged cell declared at [${r}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:n}=e;return Qt`The merged cell declared at [${r}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:n}=e;return Qt`The merged cell declared at [${r}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return r<0||n<0||i<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:n}=e;return n===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:n}=e;return n===0||r===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),YS(Pf,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(r,i),l=Math.max(r,i),c=this[o],u=this[o]+this[s]-1;if(c>=r&&(this[o]+=n),n>0)r<=u&&r>c&&(this[s]+=n);else if(n<0){if(a<=c&&l>=u)return this.removed=!0,YS(Pf,this,null),!1;if(c>=a&&c<=l){const h=l-c+1,f=Math.abs(n)-h;this[o]-=f+n,this[s]-=h}else if(c<=a&&u>=l)this[s]+=n;else if(c<=a&&u>=a&&u<l){const h=u-a+1;this[s]-=h}}return YS(Pf,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return q6(Pf,this)||YS(Pf,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),q6(Pf,this)}}function eJe(t,e){tJe(t,e),e.add(t)}function tJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KS(t,e,r){return(e=rJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rJe(t){var e=nJe(t,"string");return typeof e=="symbol"?e:e+""}function nJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Af(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ou=new WeakSet;class tE{constructor(e){eJe(this,Ou),KS(this,"plugin",void 0),KS(this,"mergedCells",[]),KS(this,"mergedCellsMatrix",new Map),KS(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:n}=e;return Qt`The merged cell declared at [${r}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(r))!==null&&n!==void 0?n:!1}getByRange(e){const{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let l=0;l<o;l++){const c=this.mergedCells[l],{row:u,col:h,rowspan:f,colspan:d}=c;if(u>=r&&u+f-1<=i&&h>=n&&h+d-1<=s){a=c;break}}return a}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let c=s;c<s+l;c++)for(let u=o;u<o+a;u++)r.add(`r${c},c${u}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,c=new Set;let u=!1;for(let h=s;h<s+l;h++){for(let f=o;f<o+a;f++){const d=`r${h},c${f}`;if(r.has(d)){zt(tE.IS_OVERLAPPING_WARNING(i)),u=!0;break}c.add(d)}if(u)break}return u||r.add(...c),!u})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=n;l<=s;l++)for(let c=i;c<=o;c++){const u=this.get(l,c);u&&(r||!r&&u.row===l&&u.col===c)&&a.push(u)}return a}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new Sl(n,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,i),c=r?!1:this.isOverlapping(a);return!l&&!c?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Af(Ou,this,J6).call(this,a),a):(c&&zt(tE.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,r){const n=this.get(e,r),i=n?this.mergedCells.indexOf(n):-1;return n&&i!==-1?(this.mergedCells.splice(i,1),Af(Ou,this,iJe).call(this,n),n):!1}clear(){Z(this.mergedCells,e=>{let{row:r,col:n,rowspan:i,colspan:s}=e;je(r,r+i,o=>{je(n,n+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);if(!n)return!1;const{row:i,col:s,rowspan:o,colspan:a}=n,l=this.hot.view.getActiveOverlayName(),c=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),u=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Mt(c,i,i+o-1),f=Mt(u,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(f,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,r){const n=Af(Ou,this,XS).call(this,e,"col",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getEndMostColumnIndex(e,r){const n=Af(Ou,this,XS).call(this,e,"col",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}getTopMostRowIndex(e,r){const n=Af(Ou,this,XS).call(this,e,"row",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getBottomMostRowIndex(e,r){const n=Af(Ou,this,XS).call(this,e,"row",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,r),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{Af(Ou,this,J6).call(this,o)})}}function XS(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,i=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=i.row;r===1?o<=s.row:o>=s.row;o+=r)for(let a=i.col;r===1?a<=s.col:a>=s.col;a+=r){const l=e==="row"?o:a,c=this.get(o,a);let u=l;c&&(u=r===1?c[e]+c[`${e}span`]-1:c[e]),n.has(l)||n.set(l,new Set),n.get(l).add(u)}return Array.from(new Set(Array.from(n.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function J6(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function iJe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function rI(t,e,r){return(e=sJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sJe(t){var e=oJe(t,"string");return typeof e=="symbol"?e:e+""}function oJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aJe{constructor(e){rI(this,"plugin",void 0),rI(this,"mergedCellsCollection",void 0),rI(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),o=this.getAutofillSize(e,r,n),[a,l,c,u]=e,f=["up","down"].indexOf(n)>-1?c-a+1:u-l+1,d=Math.floor(o/f)*f,g=o-d,m=this.getFarthestCollection(e,r,n,i);if(m){if(n==="down"){const p=m.row+m.rowspan-a-g;s[2]+p>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?p:0}else if(n==="right"){const p=m.col+m.colspan-l-g;s[3]+p>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?p:0}else if(n==="up"){const p=c-g-m.row+1;s[0]+p<0?s[0]+=g:s[0]-=g?p:0}else if(n==="left"){const p=u-g-m.col+1;s[1]+p<0?s[1]+=g:s[1]-=g?p:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:f}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),In(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,o,a]=e,[l,c,u,h]=r;switch(n){case"up":return i-l;case"down":return u-o;case"left":return s-c;case"right":return h-a;default:return null}}getDragArea(e,r,n){const[i,s,o,a]=e,[l,c,u,h]=r;switch(n){case"up":return[l,c,i-1,a];case"down":{const f=this.mergedCellsCollection.get(u,a),d=f?f.rowspan-1:0;return[o+1,s,u+d,a]}case"left":return[l,c,o,s-1];case"right":{const f=this.mergedCellsCollection.get(u,a),d=f?f.colspan-1:0;return[i,a+d,u,h]}default:return null}}getFarthestCollection(e,r,n,i){const[s,o,a,l]=e,c=["up","down"].indexOf(n)>-1,u=c?a:l,h=c?s:o,f=this.getAutofillSize(e,r,n),d=c?a-s+1:l-o+1,g=Math.floor(f/d)*d,m=f-g;let p=null,w=null,v=null;switch(n){case"up":p="includesVertically",v=u-m+1;break;case"left":p="includesHorizontally",v=u-m+1;break;case"down":p="includesVertically",v=h+m-1;break;case"right":p="includesHorizontally",v=h+m-1;break}return Z(i,y=>{y[p](v)&&y.isFarther(w,n)&&(w=y)}),w}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(c,u)=>{switch(i){case"up":return c.row-u>=r.from.row;case"down":return c.row+c.rowspan-1+u<=r.to.row;case"left":return c.col-u>=r.from.column;case"right":return c.col+c.colspan-1+u<=r.to.column;default:return null}};let o=0,a=null,l=1;do for(let c=0;c<n.length;c+=1){if(a=n[c],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0);break}c===n.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return Z(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,o,a,l]=i,c=this.plugin.hot._createCellCoords(s,o),u=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(c,c,u);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const d=this.mergedCellsCollection.getWithinRange(h,!1);return d.length===0?!0:n==="up"||n==="down"?!d.every(g=>{let{colspan:m}=g;return m===h.getWidth()}):!d.every(g=>{let{rowspan:m}=g;return m===h.getHeight()})}}function nI(t,e,r){return(e=lJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lJe(t){var e=cJe(t,"string");return typeof e=="symbol"?e:e+""}function cJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uJe{constructor(e){nI(this,"plugin",void 0),nI(this,"hot",void 0),nI(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const u=this.plugin.mergedCellsCollection.get(e,r);if(!u)return;const h=u.getLastRow(),f=u.getLastColumn();if(s<=u.row&&o<=u.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let o=0;o<r.length;o+=1)s[o]=r[o].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function hJe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(TH)}return this.getTranslatedPhrase(RH)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?Sl.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function bw(t,e,r){return(e=fJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fJe(t){var e=dJe(t,"string");return typeof e=="symbol"?e:e+""}function dJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q6{constructor(e){bw(this,"data",void 0),bw(this,"next",null),bw(this,"prev",null),this.data=e}}class qS{constructor(){bw(this,"first",null),bw(this,"last",null)}push(e){const r=new Q6(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.last;this.last=r,r.prev=n,n.next=r}return r}unshift(e){const r=new Q6(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.first;this.first=r,r.next=n,n.prev=r}}inorder(e){let r=this.first;for(;r;){const n=e(r);if(r===this.last||n===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,n,i;for(;r;){if(r.data===e)return n=r.next,i=r.prev,n&&(n.prev=i),i&&(i.next=n),r===this.first&&(this.first=n),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,i){i&&(e(i,i.next),i.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,n;for(;e;)n=e.next,e.next=r,r.prev=e,r=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=r,this.last=n}}function gJe(t,e){uee(t,e),e.add(t)}function If(t,e,r){uee(t,e),e.set(t,r)}function uee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jt(t,e){return t.get(rE(t,e))}function Hs(t,e,r){return t.set(rE(t,e),r),r}function rE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ll=new WeakMap,cl=new WeakMap,ul=new WeakMap,hl=new WeakMap,R2=new WeakMap,JS=new WeakMap,QS=new WeakMap,iI=new WeakSet;class mJe{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:n,columnIndexMapper:i}=e;gJe(this,iI),If(this,ll,new qS),If(this,cl,new qS),If(this,ul,null),If(this,hl,null),If(this,R2,null),If(this,JS,null),If(this,QS,null),Hs(R2,this,r),Hs(JS,this,n),Hs(QS,this,i)}getCurrentVerticalNode(){return Jt(hl,this).data}getFirstVerticalNode(){return Jt(cl,this).first.data}getNextVerticalNode(){return Jt(hl,this).next.data}getPrevVerticalNode(){return Jt(hl,this).prev.data}getCurrentHorizontalNode(){return Jt(ul,this).data}getFirstHorizontalNode(){return Jt(ll,this).first.data}getNextHorizontalNode(){return Jt(ul,this).next.data}getPrevHorizontalNode(){return Jt(ul,this).prev.data}setPrevNodeAsActive(){Hs(hl,this,Jt(hl,this).prev),Hs(ul,this,Jt(ul,this).prev)}setNextNodeAsActive(){Hs(hl,this,Jt(hl,this).next),Hs(ul,this,Jt(ul,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),n=e.getBottomEndCorner(),i=new WeakSet;Hs(ll,this,new qS);for(let o=r.row;o<=n.row;o++)if(!Jt(JS,this).isHidden(o))for(let a=r.col;a<=n.col;a++){if(Jt(QS,this).isHidden(a))continue;const l=rE(iI,this,Z6).call(this,e,Jt(ll,this),i,o,a);l&&Hs(ul,this,l)}Jt(ll,this).first&&(Jt(ll,this).first.prev=Jt(ll,this).last,Jt(ll,this).last.next=Jt(ll,this).first);const s=new WeakSet;Hs(cl,this,new qS);for(let o=r.col;o<=n.col;o++)if(!Jt(QS,this).isHidden(o))for(let a=r.row;a<=n.row;a++){if(Jt(JS,this).isHidden(a))continue;const l=rE(iI,this,Z6).call(this,e,Jt(cl,this),s,a,o);l&&Hs(hl,this,l)}Jt(cl,this).first&&(Jt(cl,this).first.prev=Jt(cl,this).last,Jt(cl,this).last.next=Jt(cl,this).first)}setActiveNode(e,r){return Jt(ll,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return Hs(ul,this,n),!1}),Jt(cl,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return Hs(hl,this,n),!1}),this}}function Z6(t,e,r,n,i){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=Jt(R2,this).call(this,n,i);if(l&&r.has(l))return null;const c={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(l){if(r.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;c.colStart=l.col,c.colEnd=l.col+l.colspan-1,c.rowStart=l.row,c.rowEnd=l.row+l.rowspan-1}const u=e.push(c);return n===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?u:null}function hee(t,e,r){const{rowIndexMapper:n,stylesHandler:i}=t,s=i.getDefaultRowHeight();let o=0;for(let l=e;l<e+r;l++)if(!n.isHidden(l)){var a;o+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:s,l===0&&!i.isClassicTheme()&&(o+=1)}return o}function pJe(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:n}=e,i=new Map;function s(){}function o(a,l,c){const u=t.mergedCellsCollection.get(l,c);if(!Ct(u)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Cy()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:f,colspan:d,rowspan:g}=u,[m,p]=t.translateMergedCellToRenderable(h,g,f,d),w=t.getSetting("virtualized");if(Cy()&&f===0&&!e.getSettings().rowHeaders){const O=hee(e,h,g);i.set(l,O/g)}const v=r.getRenderableFromVisualIndex(l),y=n.getRenderableFromVisualIndex(c),b=m-v+1,T=p-y+1;let E=r.getNearestNotHiddenIndex(h,1),x=n.getNearestNotHiddenIndex(f,1);if(w){const O=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(O)||(E=Math.max(E,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(O)||(x=Math.max(x,e.getFirstRenderedVisibleColumn()))}const P=Math.min(g,b),A=Math.min(d,T);E===l&&x===c?(a.setAttribute("rowspan",P),a.setAttribute("colspan",A)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function vJe(t,e){fee(t,e),e.add(t)}function ZS(t,e,r){fee(t,e),e.set(t,r)}function fee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sI(t,e,r){return(e=wJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wJe(t){var e=yJe(t,"string");return typeof e=="symbol"?e:e+""}function yJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fy(t,e,r){return t.set(Zt(t,e),r),r}function pr(t,e){return t.get(Zt(t,e))}function Zt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Fe.getSingleton().register("beforeMergeCells");Fe.getSingleton().register("afterMergeCells");Fe.getSingleton().register("beforeUnmergeCells");Fe.getSingleton().register("afterUnmergeCells");const T2="mergeCells",CJe=150,eU=T2;var Ho=new WeakMap,Lo=new WeakMap,kl=new WeakMap,tU=new WeakMap,ir=new WeakSet;class SJe extends Gt{constructor(){super(...arguments),vJe(this,ir),sI(this,"mergedCellsCollection",null),sI(this,"autofillCalculations",null),sI(this,"selectionCalculations",null),ZS(this,Ho,null),ZS(this,Lo,{row:0,col:0}),ZS(this,kl,new mJe({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),ZS(this,tU,pJe(this))}static get PLUGIN_KEY(){return T2}static get PLUGIN_PRIORITY(){return CJe}static get DEFAULT_SETTINGS(){return{[AQ]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[T2]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new tE(this),this.autofillCalculations=new aJe(this),this.selectionCalculations=new uJe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,xJe).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,_Je).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,EJe).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,RJe).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,TJe).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,nU).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,nU).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,PJe).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,AJe).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,IJe).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,rU).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,rU).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,bJe).call(e,...n)}),this.addHook("afterRenderer",function(){return pr(tU,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,kJe).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,OJe).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,MJe).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,NJe).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,DJe).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,FJe).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,HJe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,LJe).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,$Je).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,BJe).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,VJe).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,WJe).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,jJe).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,UJe).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Zt(ir,e,zJe).call(e,...n)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!bq())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let o=i+1;o<i+s;o++)r.push(o)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=x_(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{var i;n.style.background=(i=x_(n,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Sl.containsNegativeValues(e)?(zt(Sl.NEGATIVE_VALUES_WARNING(e)),!1):Sl.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(zt(Sl.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Sl.isSingleCell(e)?(zt(Sl.IS_SINGLE_CELL(e)),!1):Sl.containsZeroSpan(e)?(zt(Sl.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];r.forEach(i=>{const{row:s,col:o,rowspan:a,colspan:l}=i,c=this.hot._createCellCoords(s,o),u=this.hot._createCellCoords(s+a-1,o+l-1),h=this.hot._createCellRange(c,c,u);this.mergeRange(h,!0,!0);for(let f=s;f<s+a;f++)for(let d=o;d<o+l;d++)(f!==s||d!==o)&&n.push([f,d,null])}),n.length!==0&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),je(0,o.rowspan-1,u=>{je(0,o.colspan-1,h=>{let f=null;a[u]||(a[u]=[]),u===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+u,o.col+h,"hidden",!0),a[u][h]=f})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(n?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),l):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),Z(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),je(0,i.rowspan-1,s=>{je(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const{from:r,to:n}=e.clone().normalize(),i=this.mergedCellsCollection.get(r.row,r.col);i.row===r.row&&i.col===r.col&&i.row+i.rowspan-1===n.row&&i.col+i.colspan-1===n.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:eU})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eU)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(Ct(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(Ct(o)){const a=o.row+o.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(Ct(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(Ct(o)){const a=o.col+o.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;r===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?l=o.getNearestNotHiddenIndex(n,1):l=o.getNearestNotHiddenIndex(n+i-1,-1);const c=e>=0?s.getRenderableFromVisualIndex(a):e,u=n>=0?o.getRenderableFromVisualIndex(l):n;return[c,u]}}function xJe(){this.generateFromSettings(),this.hot.render()}function bJe(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(n.row===e[s].row&&n.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function _Je(t){pr(Lo,this).row=t.row,pr(Lo,this).col=t.col}function EJe(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;pr(Ho,this)&&(i.getRenderableFromVisualIndex(pr(Ho,this).row)!==null&&(r.row=pr(Ho,this).row),n.getRenderableFromVisualIndex(pr(Ho,this).col)!==null&&(r.col=pr(Ho,this).col),Fy(Ho,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const u=r.col>=o&&r.col<=a?o-1:a,h=n.getNearestNotHiddenIndex(u,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,r.col)-1,1)}else if(t.col>0){const u=r.col>=o&&r.col<=a?a+1:o,h=n.getNearestNotHiddenIndex(u,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,h)-1,1)}const l=s.row,c=s.row+s.rowspan-1;if(t.row<0){const u=r.row>=l&&r.row<=c?l-1:c,h=i.getNearestNotHiddenIndex(u,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,r.row)-1,1)}else if(t.row>0){const u=r.row>=l&&r.row<=c?c+1:l,h=i.getNearestNotHiddenIndex(u,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,h)-1,1)}}function RJe(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{r.expand(this.hot._createCellCoords(a,l));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(a=r.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,n.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(a=r.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(a=r.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,n.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(a=r.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,l)-1,1))}}function TJe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Fy(Ho,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);Fy(Ho,this,e.clone()),r&&e.assign(r)}function rU(t,e,r,n){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:s,col:o,colspan:a,rowspan:l}=i,c=s,u=o,h=s+l-1,f=o+a-1;if(n==="render"&&this.getSetting("virtualized")){const d=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(d)?0:this.hot.getFirstRenderedVisibleRow(),m=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(d)?0:this.hot.getFirstRenderedVisibleColumn();return[Mt(g,c,h),Mt(m,u,f),Mt(this.hot.getLastRenderedVisibleRow(),c,h),Mt(this.hot.getLastRenderedVisibleColumn(),u,f)]}return[c,u,h,f]}function kJe(t){t.items.push({name:"---------"},hJe(this))}function nU(){Fy(Ho,this,null)}function PJe(){if(pr(Ho,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),n=pr(Ho,this).clone().normalize();pr(kl,this).setActiveNode(n.row,n.col),pr(Lo,this).row>0||pr(Lo,this).col>0?pr(kl,this).setPrevNodeAsActive():(r==="E-W"&&pr(Lo,this).col<0||e==="S-N"&&pr(Lo,this).row<0)&&pr(kl,this).setNextNodeAsActive()}function AJe(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let s=null,o=null;if(pr(Lo,this).col<0){const{rowEnd:a,colEnd:l}=pr(kl,this).getPrevHorizontalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(pr(Lo,this).col>0){const{rowStart:a,colStart:l}=pr(kl,this).getNextHorizontalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(pr(Lo,this).row<0){const{rowEnd:a,colEnd:l}=pr(kl,this).getPrevVerticalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(pr(Lo,this).row>0){const{rowStart:a,colStart:l}=pr(kl,this).getNextVerticalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),c=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):r.highlight.assign(a),c.clear(),c.add(a).commit()}pr(kl,this).setActiveNode(t,e),Fy(Lo,this,{row:0,col:0})}function IJe(){this.hot.getSelectedRangeLast().isHeader()||pr(kl,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function OJe(t,e,r){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function MJe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function NJe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function DJe(t,e){const r=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,r))return e;const n=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(n,n,i),o=this.mergedCellsCollection.getWithinRange(s);return o.length===0?t:this.autofillCalculations.snapDragArea(e,t,r,o)}function FJe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function HJe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function LJe(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function $Je(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function BJe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function VJe(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(r);Z(n,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function WJe(t,e,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,n)}function jJe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function UJe(t,e,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function zJe(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let n,i;if(r==="master")n=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const f=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(f.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(f.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return t;const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),c=this.mergedCellsCollection.getWithinRange(l,!0),u=c.reduce((f,d)=>{let{rowspan:g}=d;return Math.max(f,g)},1);let h=0;return c.length>1&&c[0].rowspan<u&&(h=u-c[0].rowspan),c.forEach(f=>{let{rowspan:d}=f,g=0;r==="top"||r==="top_inline_start_corner"?g=Math.min(u,this.hot.view.countNotHiddenFixedRowsTop()-e):g=d-h,t=Math.max(t??0,hee(this.hot,e,g))}),t}function GJe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function o(a){const l=t[a],c=e[a],u=i[a],h=s[a],f=c.multiColumnSorting,g=(f.compareFunctionFactory?f.compareFunctionFactory:VQ(c.type))(l,c,f)(u,h);if(g===Fl){const m=a+1;if(typeof e[m]<"u")return o(m)}return g}(0)}}const dee="sort";function YJe(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${dee}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function KJe(t){const e=t.className.split(" "),r=new RegExp(`^${dee}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}function XJe(t,e,r){return(e=qJe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qJe(t){var e=JJe(t,"string");return typeof e=="symbol"?e:e+""}function JJe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nE="multiColumnSorting",QJe=170,iU=nE;BQ(nE,GJe);class ZJe extends qQ{constructor(){super(...arguments),XJe(this,"pluginKey",nE)}static get PLUGIN_KEY(){return nE}static get PLUGIN_PRIORITY(){return QJe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,L_)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:Uh,position:"before",group:iU})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iU)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),Je(e,KJe(e)),this.enabled!==!1&&Se(e,YJe(...n))}onAfterOnCellMouseDown(e,r){n$(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,L_))):this.sort(this.getColumnNextConfig(r.col)))}}function sU(t,e,r){return(e=eQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eQe(t){var e=tQe(t,"string");return typeof e=="symbol"?e:e+""}function tQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rQe="multipleSelectionHandles",nQe=160;class iQe extends Gt{constructor(){super(...arguments),sU(this,"dragged",[]),sU(this,"lastSetCell",null)}static get PLUGIN_KEY(){return rQe}static get PLUGIN_PRIORITY(){return nQe}isEnabled(){return Il()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(tt(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(tt(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(tt(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(tt(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,c,u,h;if(e.dragged.length===0)return;const f=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(o=e.hot.getCoords(f),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection(),l===1&&c===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,u,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),c=e.getTopEndCorner();let u={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?u={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":s==="bottom"&&(u={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?u={start:r,end:l}:u.end=r;break;case"NW-SE":s==="top"?u={start:r,end:a}:u.end=r;break;case"SE-NW":s==="top"?u={start:r,end:o}:u.end=r;break;case"SW-NE":s==="top"?u={start:r,end:c}:u.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(l.row,r.col)}:u={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SW-NE":s==="top"?u={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)}:u={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":s==="bottom"?u={start:this.hot._createCellCoords(r.row,c.col),end:this.hot._createCellCoords(o.row,r.col)}:s==="top"&&(u={start:l,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(u.end=r);break;case"SE-NW":s==="top"?u.end=r:u={start:r,end:o};break}break}return u}isDragged(){return this.dragged.length>0}}function k2(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:c}}function gee(){return{label:"",isPlaceholder:!0}}function sQe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;Z(t,i=>{const s=[];let o=0;r.push(s),Z(i,a=>{const l=k2();if(Ct(a)){const{label:u,colspan:h,headerClassName:f}=a;l.label=Fr(u),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof f=="string"&&(l.headerClassNames=[...f.split(" ")])}else l.label=Fr(a);o+=l.origColspan;let c=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,c=!0),s.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)s.push(gee());return!c})});const n=Math.max(...At(r,i=>i.length));return Z(r,i=>{if(i.length<n){const s=At(new Array(n-i.length),()=>k2());i.splice(i.length,0,...s)}}),r}function oI(t,e,r){oQe(t,e),e.set(t,r)}function oQe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(t,e){return t.get(mee(t,e))}function hv(t,e,r){return t.set(mee(t,e),r),r}function mee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oU=["label","collapsible"];var oc=new WeakMap,Of=new WeakMap,aI=new WeakMap;class aQe{constructor(){oI(this,oc,[]),oI(this,Of,0),oI(this,aI,1/0)}setColumnsLimit(e){hv(aI,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];hv(oc,this,sQe(e,ua(aI,this))),hv(Of,this,ua(oc,this).length)}getData(){return ua(oc,this)}mergeWith(e){Z(e,r=>{let{row:n,col:i,...s}=r;const o=this.getHeaderSettings(n,i);o!==null&&In(o,s,oU)})}map(e){Z(ua(oc,this),r=>{Z(r,n=>{const i=e({...n});Ct(i)&&In(n,i,oU)})})}getHeaderSettings(e,r){var n;if(e>=ua(Of,this)||e<0)return null;const i=ua(oc,this)[e];return Array.isArray(i)===!1||r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=ua(Of,this)||e<0)return i;const s=ua(oc,this)[e];let o=0;for(let a=r;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return ua(Of,this)}getColumnsCount(){return ua(Of,this)>0?ua(oc,this)[0].length:0}clear(){hv(oc,this,[]),hv(Of,this,0)}}function lI(t,e,r){return(e=lQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lQe(t){var e=cQe(t,"string");return typeof e=="symbol"?e:e+""}function cQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pee="DF-pre-order";function vee(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=vee.call(this.childs[n],t,e)}return r}const uQe="DF-post-order";function wee(t,e){for(let r=0;r<this.childs.length;r++)if(wee.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const yee="BF";function hQe(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const fQe=yee,aU=new Map([[pee,vee],[uQe,wee],[yee,hQe]]);class iE{constructor(e){lI(this,"data",{}),lI(this,"parent",null),lI(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new iE({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fQe;if(!aU.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);aU.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function cI(t,e,r){dQe(t,e),e.set(t,r)}function dQe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vi(t,e){return t.get(Cee(t,e))}function gQe(t,e,r){return t.set(Cee(t,e),r),r}function Cee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qg=new WeakMap,Mf=new WeakMap,Jg=new WeakMap;class mQe{constructor(e){cI(this,qg,new Map),cI(this,Mf,new Map),cI(this,Jg,null),gQe(Jg,this,e)}getRoots(){return Array.from(Vi(qg,this).values())}getRootByColumn(e){let r;return Vi(Mf,this).has(e)&&(r=Vi(qg,this).get(Vi(Mf,this).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-Vi(Mf,this).get(r);let s=0,o;return n.walkDown(a=>{const{data:{origColspan:l,headerLevel:c}}=a;if(e===c){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=r===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Vi(Mf,this).clear(),Z(Vi(qg,this),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)Vi(Mf,this).set(i,e);e+=n})}buildTree(){this.clear();const e=Vi(Jg,this).getColumnsCount();let r=0;for(;r<e;){const n=Vi(Jg,this).getHeaderSettings(0,r),i=new iE;Vi(qg,this).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Vi(Jg,this).getHeadersSettings(n,r,i);n+=1,Z(s,o=>{const a={...o,headerLevel:n-1,columnIndex:r};let l;n===1?(e.data=a,l=e):(l=new iE(a),e.addChild(l)),n<Vi(Jg,this).getLayersCount()&&this.buildLeaves(l,r,n,o.origColspan),r+=o.origColspan})}clear(){Vi(qg,this).clear(),Vi(Mf,this).clear()}}function See(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function sE(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function oE(t){return sE(t,"origColspan")===t.data.origColspan}function w$(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(oE(t))return w$(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let o=0;if(i.length>0)Z(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,See(a,c=>{s.add(c)})});else{const{colspan:a,origColspan:l,columnIndex:c}=e;o=l-a;for(let u=1;u<l;u++)s.add(c+u)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):oE(a)&&(l.isCollapsed=sE(a,"isCollapsed"))}),{rollbackModification:()=>y$(t),affectedColumns:Array.from(s),colspanCompensation:o}}function y$(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(oE(t))return y$(n[0]);r.isCollapsed=!0;const s=n.slice(1),o=new Set;if(s.length>0)Z(s,l=>{See(l,c=>{o.add(c)}),l.data.clonedTree=l.cloneTree(),l.walkDown(c=>{let{data:u}=c;u.isHidden=!0})});else{const{origColspan:l,columnIndex:c}=r;for(let u=1;u<l;u++){const h=c+u;o.add(h)}}const a=r.colspan-((e=sE(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:c}=l;c.colspan-=a,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):oE(l)&&(c.isCollapsed=sE(l,"isCollapsed"))}),{rollbackModification:()=>w$(t),affectedColumns:Array.from(o),colspanCompensation:a}}function pQe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Qt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function vQe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Qt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const lU=new Map([["collapse",y$],["expand",w$],["hide-column",pQe],["show-column",vQe]]);function wQe(t,e,r){if(!lU.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return lU.get(t)(e,r)}function ex(t){const e=[];return Z(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,c=CQe(e,a);let u=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||u)c.push(gee());else{const d=yQe(i);d.isRoot=!0,c.push(d),u=!0}})}),e}function yQe(t){const{crossHiddenColumns:e,...r}=k2(t);return r}function CQe(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function uI(t,e,r){SQe(t,e),e.set(t,r)}function SQe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fv(t,e,r){return t.set(xee(t,e),r),r}function Lr(t,e){return t.get(xee(t,e))}function xee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fl=new WeakMap,fs=new WeakMap,Nf=new WeakMap;class xQe{constructor(){uI(this,fl,new aQe),uI(this,fs,new mQe(Lr(fl,this))),uI(this,Nf,[[]])}setState(e){Lr(fl,this).setData(e);let r=!1;try{Lr(fs,this).buildTree()}catch{Lr(fs,this).clear(),Lr(fl,this).clear(),r=!0}return fv(Nf,this,ex(Lr(fs,this).getRoots())),r}setColumnsLimit(e){Lr(fl,this).setColumnsLimit(e)}mergeStateWith(e){const r=At(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});Lr(fl,this).mergeWith(r),Lr(fs,this).buildTree(),fv(Nf,this,ex(Lr(fs,this).getRoots()))}mapState(e){Lr(fl,this).map(e),Lr(fs,this).buildTree(),fv(Nf,this,ex(Lr(fs,this).getRoots()))}mapNodes(e){return Ns(Lr(fs,this).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=Lr(fs,this).getNode(r,n);let s;return i&&(s=wQe(e,i,n),fv(Nf,this,ex(Lr(fs,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=Lr(Nf,this)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){const n=this.getHeaderTreeNode(e,r);return n?{...n.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=Lr(fs,this).getNode(e,r);return n||null}findTopMostEntireHeaderLevel(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const n=r-e+1;let i=!1,s=null;for(let o=e;o<=r;o++){const a=Lr(fs,this).getRootByColumn(o);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:c,headerLevel:u,origColspan:h,isHidden:f}=l.data;f||h<=n&&c>=e&&c+h-1<=r&&(s===null||u<s)&&(s=u)},pee)}return i&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,r){var n;const{isRoot:i,origColspan:s}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(i)return r+s-1;let o=r+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return Lr(fl,this).getLayersCount()}getColumnsCount(){return Lr(fl,this).getColumnsCount()}clear(){fv(Nf,this,[]),Lr(fl,this).clear(),Lr(fs,this).clear()}}function dv(t,e,r){return(e=bQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bQe(t){var e=_Qe(t,"string");return typeof e=="symbol"?e:e+""}function _Qe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EQe{constructor(e,r){dv(this,"hot",void 0),dv(this,"nestedHeaderSettingsGetter",void 0),dv(this,"layersCount",0),dv(this,"container",void 0),dv(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(let i=0;i<n;i++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const c=r.createElement("tr");for(let u=0;u<a;u++){let h=n.getVisualFromRenderableIndex(u);h===null&&(h=u);const f=r.createElement("th"),d=this.nestedHeaderSettingsGetter(l,h);if(d&&(!d.isPlaceholder||d.isHidden)){let g=d.label;o&&(g+='<button class="changeType"></button>'),Xp(f,g),f.colSpan=d.colspan,c.appendChild(f)}}s.appendChild(c)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function RQe(t,e){bee(t,e),e.add(t)}function cU(t,e,r){return(e=TQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TQe(t){var e=kQe(t,"string");return typeof e=="symbol"?e:e+""}function kQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gv(t,e,r){bee(t,e),e.set(t,r)}function bee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oc(t,e,r){return t.set($r(t,e),r),r}function Tt(t,e){return t.get($r(t,e))}function $r(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const uU="nestedHeaders",PQe=280;var tr=new WeakMap,Mu=new WeakMap,_w=new WeakMap,lT=new WeakMap,aE=new WeakMap,Qr=new WeakSet;class AQe extends Gt{constructor(){super(...arguments),RQe(this,Qr),gv(this,tr,new xQe),gv(this,Mu,null),gv(this,_w,null),gv(this,lT,!1),gv(this,aE,null),cU(this,"ghostTable",new EQe(this.hot,(e,r)=>this.getHeaderSettings(e,r))),cU(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return uU}static get PLUGIN_PRIORITY(){return PQe}isEnabled(){return!!this.hot.getSettings()[uU]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&zt(Qt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>$r(Qr,this,GQe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,YQe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,NQe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,DQe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,FQe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,HQe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,LQe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,$Qe).call(e,...i)}),this.addHook("afterSelection",()=>$r(Qr,this,tx).call(this)),this.addHook("afterSelectionFocusSet",()=>$r(Qr,this,tx).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,IQe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",n=>$r(Qr,this,VQe).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,jQe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,UQe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,OQe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,MQe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,BQe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,WQe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return $r(Qr,e,zQe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>$r(Qr,this,tx).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>$r(Qr,this,tx).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Tt(tr,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Tt(tr,this).setState(e)),this.detectedOverlappedHeaders&&zt(Qt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";Tt(tr,this).triggerColumnModification(i,n)}),!Tt(Mu,this)&&this.enabled&&Oc(Mu,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:o}=n;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Tt(tr,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Tt(tr,this).clear(),Tt(Mu,this).unsubscribe(),Oc(Mu,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Tt(tr,this)}getLayersCount(){return Tt(tr,this).getLayersCount()}getHeaderSettings(e,r){return Tt(tr,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const a=n.childNodes[o];if(!a)break;const l=i.childNodes[o],c=s?s.childNodes[o]:null;for(let u=0,h=a.childNodes.length;u<h;u++)a.childNodes[u].removeAttribute("colspan"),Je(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),Je(l.childNodes[u],"hiddenHeader")),s&&c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),Je(c.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let c=a.getVisualFromRenderableIndex(i);c===null&&(c=i),s.removeAttribute("colspan"),Je(s,"hiddenHeader"),Je(s,"hiddenHeaderText");const{colspan:u,isHidden:h,isPlaceholder:f,headerClassNames:d}=(o=Tt(tr,this).getHeaderSettings(e,c))!==null&&o!==void 0?o:{};if(f||h)Se(s,"hiddenHeader");else if(u>1){var g,m,p;const{wtOverlays:w}=l._wt,v=(g=w.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),y=(m=w.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s);((p=w.topOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s))&&c<n&&Se(s,"hiddenHeaderText");const T=v||y?Math.min(u,n-i):u;T>1&&s.setAttribute("colspan",T)}if(this.hot.view.appendColHeader(c,s,function(){return r.getColumnHeaderValue(...arguments)},e),!f&&!h){const w=s.querySelector("div.relative");w&&d&&d.length>0&&(Je(w,this.hot.getColumnMeta(c).headerClassName),Se(w,d))}}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=Tt(tr,this).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}destroy(){Oc(tr,this,null),Tt(Mu,this)!==null&&(Tt(Mu,this).unsubscribe(),Oc(Mu,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Tt(tr,this).getHeaderTreeNodeData(e.row,e.col)}}function tx(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const i=Tt(tr,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function IQe(t,e){var r;const n=this.hot.getSelectedRangeLast();if(!n)return t;const{highlight:i}=n,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?i.row:(r=Tt(aE,this))===null||r===void 0?void 0:r.row,l=o?t:i.col,c=a<0&&l>=0;if(Oc(aE,this,null),!c)return t;const u=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),f=h-u+1,d=Tt(tr,this).findLeftMostColumnIndex(a,l),g=Tt(tr,this).findRightMostColumnIndex(a,l),m=g-d+1;if(d<u&&g>h)return d;if(o){let p=null;return d>=u&&g>h?m>f?(e.value="start",p=d):(e.value="end",p=g):d<u&&g<=h&&(m>f?(e.value="end",p=g):(e.value="start",p=d)),p}return d<=u?d:g}function OQe(t,e,r){const n=Tt(tr,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:o}=r,{isRoot:a,colspan:l}=Tt(tr,this).getHeaderSettings(e,t);if(s===YF){if(!a)return n.columnIndex}else if(s===dJ&&(l>o-i||!a))return null;return t}function MQe(t,e,r){let{columnHeadersCount:n}=r;if(n!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:c}=e[s],u=l-o+1,h=a-c+1;if(o>=0||h===1)break;for(let f=a;f<=c;f++)for(let d=o;d<=l;d++){var i;const g=u+d,m=f-a;if(m===0)continue;((i=Tt(tr,this).getHeaderTreeNodeData(d,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][m]="")}}}function NQe(t,e,r,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function DQe(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;Oc(_w,this,e.clone()),Oc(lT,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=r,l=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(NF(t)||Dd(t)&&l||PDe(t))&&s.push(o,o+a-1,e.row),n.selectColumns(...s)}function FQe(t,e,r,n){if(!this.hot.view.isMouseDown()||n.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:u}=a;n.column=!0,n.cell=!0;const h=[],f=Mt(e.row,-1/0,-1);e.col<u.col?h.push(c.col,s,f):e.col>u.col?h.push(l.col,s+o-1,f):h.push(s,s+o-1,f),this.hot.selection.selectColumns(...h)}function HQe(){Oc(lT,this,!1)}function LQe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Tt(lT,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Tt(tr,this).getHeaderTreeNodeData(Tt(_w,this).row,Tt(_w,this).col);if(e.setHighlight(Tt(_w,this)),s>e.getWidth()||i<r||i+s-1>n){const o=Tt(tr,this).findTopMostEntireHeaderLevel(Mt(r,i,i+s-1),Mt(n,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function $Qe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const i=Tt(tr,this).findLeftMostColumnIndex(r.row,r.col),s=Tt(tr,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function BQe(t,e,r){const n=t.row,i=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});Oc(aE,this,r.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function VQe(t){if(Tt(tr,this).getLayersCount()>0){t.length=0;for(let e=0;e<Tt(tr,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function WQe(t){const e=Tt(tr,this).getLayersCount();let r=t.startColumn,n=!!e;for(let i=0;i<e;i++){const s=Tt(tr,this).findLeftMostColumnIndex(i,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(n=!1),Ji(o)&&o<t.startColumn){r=o;break}}t.startColumn=n?Tt(tr,this).getHeaderTreeNodeData(0,r).columnIndex:r}function jQe(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function UQe(t,e,r){var n;const{label:i}=(n=Tt(tr,this).getHeaderTreeNodeData(r,e))!==null&&n!==void 0?n:{label:""};return i}function zQe(t,e){if(t<0)return this.hot.getCell(t,Tt(tr,this).findLeftMostColumnIndex(t,e),!0)}function GQe(){this.updatePlugin()}function YQe(t,e){e||this.updatePlugin()}function mv(t,e,r){return(e=KQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KQe(t){var e=XQe(t,"string");return typeof e=="symbol"?e:e+""}function XQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qQe{constructor(e,r){mv(this,"hot",void 0),mv(this,"data",null),mv(this,"plugin",void 0),mv(this,"parentReference",new WeakMap),mv(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},je(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&Z(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,o=r;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),n!=null&&o===n?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&Z(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,n,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return St(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(Z(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const a=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(je(e[0],e[2],f=>{const d=this.translateTrimmedRow(f);i.push(this.getDataObject(d))}),je(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),o=this.countChildren(n),a=this.getRowIndexWithinParent(n),l=this.getRowParent(n),c=this.getRowParent(l),u=this.getRowIndex(c);let h=null;if(this.hot.runHooks("beforeDetachChild",l,n),a!=null){const f=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,f,this.plugin.pluginName),c){h=u+this.countChildren(c);const d=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),c.__children.push(n)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];Z(n,s=>{i.push(this.getDataObject(s))}),Z(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(o,r,...n):s.__children.splice(o,r):n?this.data.splice(o,r,...n):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=r;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),c=e>r;let u=s?this.getRowParent(r-1):this.getRowParent(r);u==null&&(u=this.getRowParent(r-1)),u==null&&(u=this.getDataObject(r-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(r),u.__children=[]);const h=s||n||i?u.__children.length:this.getRowIndexWithinParent(r),f=o===u;u.__children.splice(h,0,l[0]),o.__children.splice(a+(c&&f?1:0),1),this.syncRowWithRawSource(o),f||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function hU(t,e,r){return(e=JQe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JQe(t){var e=QQe(t,"string");return typeof e=="symbol"?e:e+""}function QQe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C${constructor(e,r){hU(this,"hot",void 0),hU(this,"plugin",void 0),this.hot=r,this.plugin=e}}class bl extends C${static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(n),s=this.dataManager.getDataObject(n),o=r.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(Z(l,u=>{u&&o.removeChild(u)}),Se(r,bl.CSS_CLASSES.indicatorContainer),i){const{rootDocument:u}=this.hot,h=a.cloneNode(!0);o.innerHTML="",je(0,i-1,()=>{const f=u.createElement("SPAN");Se(f,bl.CSS_CLASSES.emptyIndicator),o.appendChild(f)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const u=this.hot.rootDocument.createElement("DIV");c&&et(u,[sg()]),Se(r,bl.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Se(u,`${bl.CSS_CLASSES.button} ${bl.CSS_CLASSES.expandButton}`),c&&et(r,[jo(!1)])):(Se(u,`${bl.CSS_CLASSES.button} ${bl.CSS_CLASSES.collapseButton}`),c&&et(r,[jo(!0)])),o.appendChild(u)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);let n=11;this.hot.stylesHandler.isClassicTheme()||(n=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,n+10*r+25),this.hot.render()}}class ZQe extends C${constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),Z(n.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(n.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{je(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&Z(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),n&&this.trimRows(a),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];Z(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return Z(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);Z(i.__children,s=>{const o=this.dataManager.getRowIndex(s);r.push(o),this.collapseChildRows(o,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return Z(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);Z(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);r.push(o),this.expandChildRows(o,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&Z(s.__children,l=>{const c=this.dataManager.getRowIndex(l);i.push(c)}),a=this.expandRows(i,!0,!1),n&&this.untrimRows(a),r&&this.renderAndAdjust(),a}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];Z(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];Z(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];Z(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{Z(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{Z(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&Z(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);tt(e.target,bl.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Ua(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function eZe(t,e,r){tZe(t,e),e.set(t,r)}function tZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rZe(t,e,r){return(e=nZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nZe(t){var e=iZe(t,"string");return typeof e=="symbol"?e:e+""}function iZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sZe(t,e){return t.get(oZe(t,e))}function oZe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fU=new WeakMap;class aZe extends C${constructor(){super(...arguments),rZe(this,"dataManager",this.plugin.dataManager),eZe(this,fU,{row_above:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(GH)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(YH)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return je(0,e.items.length-1,n=>{if(n===0)return Z(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return je(0,e.items.length-1,r=>{const n=sZe(fU,this)[e.items[r].key];n!=null&&(e.items[r].callback=n)}),e}}function rx(t,e,r){return(e=lZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lZe(t){var e=cZe(t,"string");return typeof e=="symbol"?e:e+""}function cZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uZe{constructor(e){rx(this,"plugin",void 0),rx(this,"hot",void 0),rx(this,"dataManager",void 0),rx(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=n===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let l=!0;const c=e.map(g=>{if(!l)return!1;const m=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(m,a),m}),u=c.indexOf(a)===-1;if(!l||!u)return!1;const h=this.getBaseParent(c),f=this.getTargetParent(o,a),d=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,a,d),this.moveRows(c,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(c,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let o=!1;return Dr(i)&&(zt(Qt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0;if(this.movedToCollapsed){let o=null;e[n-1]<r?o=this.dataManager.translateTrimmedRow(r-n):o=this.dataManager.translateTrimmedRow(r);const a=this.dataManager.getRowParent(o===null?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);this.hot.selectCells([[i,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}function hZe(t,e){_ee(t,e),e.add(t)}function dU(t,e,r){_ee(t,e),e.set(t,r)}function _ee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hI(t,e,r){return(e=fZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fZe(t){var e=dZe(t,"string");return typeof e=="symbol"?e:e+""}function dZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ab(t,e){return t.get(Ln(t,e))}function lE(t,e,r){return t.set(Ln(t,e),r),r}function Ln(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cE="nestedRows",gZe=300,gU=cE,mZe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var cT=new WeakMap,Qg=new WeakMap,Gn=new WeakSet;class pZe extends Gt{constructor(){super(...arguments),hZe(this,Gn),hI(this,"dataManager",null),hI(this,"headersUI",null),hI(this,"collapsedRowsMap",null),dU(this,cT,!1),dU(this,Qg,!1)}static get PLUGIN_KEY(){return cE}static get PLUGIN_PRIORITY(){return gZe}isEnabled(){return!!this.hot.getSettings()[cE]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new R1),this.dataManager=new qQe(this,this.hot),this.collapsingUI=new ZQe(this,this.hot),this.headersUI=new bl(this,this.hot),this.contextMenuUI=new aZe(this,this.hot),this.rowMoveController=new uZe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,AZe).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,IZe).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,yZe).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,CZe).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,SZe).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,wZe).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,_Ze).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,bZe).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,EZe).call(e,...n)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,RZe).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,TZe).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,kZe).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,xZe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,PZe).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ln(Gn,e,vZe).call(e,...n)}),this.addHook("beforeLoadData",r=>Ln(Gn,this,mU).call(this,r)),this.addHook("beforeUpdateData",r=>Ln(Gn,this,mU).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:gU,relativeToGroup:Uh,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gU)}disableCoreAPIModifiers(){lE(Qg,this,!0)}enableCoreAPIModifiers(){lE(Qg,this,!1)}onModifyRowData(e){if(!ab(Qg,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!ab(Qg,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return ab(Qg,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}destroy(){super.destroy()}}function vZe(t,e,r,n){return this.rowMoveController.onBeforeRowMove(t,e,r,n)}function wZe(t,e,r){this.collapsingUI.toggleState(t,e,r)}function yZe(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),lE(cT,this,!0),this.dataManager.getData().slice()}function CZe(t){return this.contextMenuUI.appendOptions(t)}function SZe(t,e){this.headersUI.appendLevelIndicators(t,e)}function xZe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function bZe(t,e,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{lE(cT,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _Ze(t,e,r){const n=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));r.length=0,r.push(...n)}function EZe(){this.collapsingUI.collapsedRowsStash.stash()}function RZe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function TZe(){this.collapsingUI.collapsedRowsStash.stash()}function kZe(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function PZe(){this.dataManager.rewriteCache()}function AZe(){this.headersUI.updateRowHeaderWidth()}function IZe(t,e){ab(cT,this)&&(e.skipRender=!0)}function mU(t){if(!u3e(t)){DF(mZe),this.hot.getSettings()[cE]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function fI(t,e,r){return(e=OZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OZe(t){var e=MZe(t,"string");return typeof e=="symbol"?e:e+""}function MZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NZe{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;fI(this,"rootWindow",void 0),fI(this,"prefix",void 0),fI(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Z(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function DZe(t,e,r){return(e=FZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FZe(t){var e=HZe(t,"string");return typeof e=="symbol"?e:e+""}function HZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Fe.getSingleton().register("persistentStateSave");Fe.getSingleton().register("persistentStateLoad");Fe.getSingleton().register("persistentStateReset");const pU="persistentState",LZe=0;class $Ze extends Gt{constructor(){super(...arguments),DZe(this,"storage",void 0)}static get PLUGIN_KEY(){return pU}static get PLUGIN_PRIORITY(){return LZe}isEnabled(){return!!this.hot.getSettings()[pU]}enablePlugin(){this.enabled||(this.storage||(this.storage=new NZe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function BZe(t,e){VZe(t,e),e.add(t)}function VZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dI(t,e,r){return(e=WZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WZe(t){var e=jZe(t,"string");return typeof e=="symbol"?e:e+""}function jZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vU(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const gI="search",UZe=190,zZe="htSearchResult",GZe=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},YZe=function(t,e,r){return Dr(t)||t===null||!t.toLocaleLowerCase||t.length===0||Dr(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var mI=new WeakSet;class KZe extends Gt{constructor(){super(...arguments),BZe(this,mI),dI(this,"callback",GZe),dI(this,"queryMethod",YZe),dI(this,"searchResultClass",zZe)}static get PLUGIN_KEY(){return gI}static get PLUGIN_PRIORITY(){return UZe}isEnabled(){return this.hot.getSettings()[gI]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[gI];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return vU(mI,e,wU).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return vU(mI,e,wU).call(e,...i)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return je(0,i-1,l=>{je(0,s-1,c=>{const u=this.hot.getDataAtCell(l,c),h=this.hot.getCellMeta(l,c),f=h.search.callback||r,g=(h.search.queryMethod||n)(e,u,h);if(g){const m={row:l,col:c,data:u};o.push(m)}f&&f(a,l,c,u,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ct(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function wU(t,e,r,n,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function nx(t,e,r){return(e=XZe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XZe(t){var e=qZe(t,"string");return typeof e=="symbol"?e:e+""}function qZe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eee{constructor(e){nx(this,"viewportWidth",void 0),nx(this,"overwriteColumnWidthFn",void 0),nx(this,"baseWidths",new Map),nx(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class JZe extends Eee{calculate(){const e=Array.from(this.baseWidths).reduce((h,f)=>{let[,d]=f;return h+d},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const n=this.viewportWidth/e,i=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,f)=>{const d=Math.round(h*n),g=this.overwriteColumnWidthFn(d,f);d===g&&d>=Sp?(i.push([f,g]),a+=g):d!==g&&(i.push([f,g]),s.push(f),o-=g)}),o<=Sp){this.stretchedWidths.clear();return}const l=o/a;let c=-1,u=0;i.forEach((h,f)=>{let[d,g]=h,m=g;s.includes(d)||(m=Math.round(g*l)),this.stretchedWidths.set(d,m),c=d,f<i.length-1&&(u+=m)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(c,Math.round(this.viewportWidth-u))}}function yU(t,e,r){QZe(t,e),e.set(t,r)}function QZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pI(t,e){return t.get(Ree(t,e))}function ix(t,e,r){return t.set(Ree(t,e),r),r}function Ree(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var sx=new WeakMap,pv=new WeakMap;class ZZe extends Eee{constructor(){super(...arguments),yU(this,sx,0),yU(this,pv,-1)}prepare(e){super.prepare(e),ix(sx,this,0),ix(pv,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),ix(pv,this,e),ix(sx,this,r)}calculate(){if(pI(pv,this)===-1)return;const e=Array.from(this.baseWidths).reduce((n,i)=>{let[,s]=i;return n+s},0),r=Math.max(this.viewportWidth-e+pI(sx,this),0);this.stretchedWidths.set(pI(pv,this),r)}}function eet(t,e){Tee(t,e),e.add(t)}function ox(t,e,r){Tee(t,e),e.set(t,r)}function Tee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zr(t,e){return t.get(Hm(t,e))}function vI(t,e,r){return t.set(Hm(t,e),r),r}function Hm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tet="stretchColumns";var Si=new WeakMap,Zg=new WeakMap,wI=new WeakMap,ax=new WeakMap,vv=new WeakSet;class ret{constructor(e){eet(this,vv),ox(this,Si,void 0),ox(this,Zg,void 0),ox(this,wI,new Map([["all",new JZe(Hm(vv,this,CU).bind(this))],["last",new ZZe(Hm(vv,this,CU).bind(this))]])),ox(this,ax,"none"),vI(Si,this,e),vI(Zg,this,Zr(Si,this).columnIndexMapper.createAndRegisterIndexMap(tet,"physicalIndexToValue"))}useStrategy(e){vI(ax,this,Zr(wI,this).has(e)?e:"none")}refreshStretching(){if(Zr(ax,this)==="none"){Zr(Zg,this).clear();return}Zr(Si,this).batchExecution(()=>{Zr(Zg,this).clear();const e=Zr(wI,this).get(Zr(ax,this));let n=Zr(Si,this).view.getViewportWidth();Hm(vv,this,net).call(this)&&(n-=ei(Zr(Si,this).rootDocument)),e.prepare({viewportWidth:n});for(let i=0;i<Zr(Si,this).countCols();i++)Zr(Si,this).columnIndexMapper.isHidden(Zr(Si,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Hm(vv,this,iet).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,o]=i;Zr(Zg,this).setValueAtIndex(Zr(Si,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return Zr(Zg,this).getValueAtIndex(Zr(Si,this).toPhysicalColumn(e))}}function net(){const{view:t,stylesHandler:e}=Zr(Si,this);if(t.isVerticallyScrollableByWindow())return!1;const r=t.getViewportHeight(),n=Zr(Si,this).countRows(),i=e.getDefaultRowHeight();let s=0,o=!1;for(let l=0;l<n;l++){var a;if(s+=((a=Zr(Si,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),s>r){o=!0;break}}return o}function iet(t){var e;return(e=Zr(Si,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Sp}function CU(t,e){return Zr(Si,this).runHooks("beforeStretchingColumnWidth",t,e)}function set(t,e){kee(t,e),e.add(t)}function yI(t,e,r){kee(t,e),e.set(t,r)}function kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CI(t,e,r){return t.set(uE(t,e),r),r}function dc(t,e){return t.get(uE(t,e))}function uE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oet="stretchColumns",aet=155;var fm=new WeakMap,lx=new WeakMap,wv=new WeakMap,SI=new WeakSet;class cet extends Gt{constructor(){super(...arguments),set(this,SI),yI(this,fm,new ret(this.hot)),yI(this,lx,null),yI(this,wv,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(n=>{let{contentRect:i}=n;dc(lx,this)!==null&&dc(lx,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),CI(lx,this,i.width)})})}))}static get PLUGIN_KEY(){return oet}static get PLUGIN_PRIORITY(){return aet}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(dc(fm,this).useStrategy(this.hot.getSettings().stretchH),dc(wv,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return uE(SI,e,het).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return uE(SI,e,uet).call(e,...n)},10),super.enablePlugin())}updatePlugin(){dc(fm,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),dc(wv,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return dc(fm,this).getStretchedWidth(e)}destroy(){dc(wv,this).disconnect(),CI(wv,this,null),CI(fm,this,null),super.destroy()}}function uet(t,e,r){if(r===this.pluginName)return;const n=this.getColumnWidth(e);return typeof n=="number"?n:t}function het(t){t&&dc(fm,this).refreshStretching()}function fet(t,e){det(t,e),e.add(t)}function det(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cx(t,e,r){return(e=get(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function get(t){var e=met(t,"string");return typeof e=="symbol"?e:e+""}function met(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const pet="touchScroll",vet=200;var ux=new WeakSet;class wet extends Gt{constructor(){super(...arguments),fet(this,ux),cx(this,"scrollbars",[]),cx(this,"clones",[]),cx(this,"lockedCollection",!1),cx(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return pet}static get PLUGIN_PRIORITY(){return vet}static get SETTING_KEYS(){return!0}isEnabled(){return xq()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>xI(ux,this,yet).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>xI(ux,this,Cet).call(this)),this.addHook("afterMomentumScroll",()=>xI(ux,this,xet).call(this))}}function yet(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Cet(){this.freezeOverlays=!0,Z(this.clones,t=>{Se(t,"hide-tween")})}function xet(){this.freezeOverlays=!1,Z(this.clones,t=>{Je(t,"hide-tween"),Se(t,"show-tween")}),this.hot._registerTimeout(()=>{Z(this.clones,t=>{Je(t,"show-tween")})},400),Z(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function bet(t,e){_et(t,e),e.add(t)}function _et(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eet(t,e,r){return(e=Ret(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ret(t){var e=Tet(t,"string");return typeof e=="symbol"?e:e+""}function Tet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ket(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const lb="trimRows",Pet=330;var SU=new WeakSet;class Aet extends Gt{constructor(){super(...arguments),bet(this,SU),Eet(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return lb}static get PLUGIN_PRIORITY(){return Pet}isEnabled(){return!!this.hot.getSettings()[lb]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new R1),this.trimmedRowsMap.addLocalHook("init",()=>ket(SU,this,Iet).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[lb];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),Z(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{Z(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(Z(e,l=>{s[l]=!1}),i=Ns(s,(l,c,u)=>(c&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&o)!==!1&&(n&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&o,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}destroy(){super.destroy()}}function Iet(){const t=this.hot.getSettings()[lb];Array.isArray(t)&&this.hot.batchExecution(()=>{Z(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function Oet(t,e,r){return(e=Met(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Met(t){var e=Net(t,"string");return typeof e=="symbol"?e:e+""}function Net(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ea{constructor(e){Oet(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function hx(t,e,r){return(e=Det(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Det(t){var e=Fet(t,"string");return typeof e=="symbol"?e:e+""}function Fet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S$ extends ea{constructor(e){let{stateBefore:r,range:n,type:i,alignment:s}=e;super("cell_alignment"),hx(this,"stateBefore",void 0),hx(this,"range",void 0),hx(this,"type",void 0),hx(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=s}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,s,o)=>{r.done(()=>new S$({stateBefore:n,range:i,type:s,alignment:o}))})}undo(e,r){Z(this.range,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&e.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){Du(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,s,o)=>e.setCellMeta(n,i,s,o)),e.addHookOnce("afterViewRender",r),e.render()}}function xU(t,e,r){return(e=Het(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Het(t){var e=Let(t,"string");return typeof e=="symbol"?e:e+""}function Let(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x$ extends ea{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),xU(this,"columns",void 0),xU(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new x$({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),p$(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),n.moveColumn(a,o)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function bU(t,e,r){return(e=$et(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $et(t){var e=Bet(t,"string");return typeof e=="symbol"?e:e+""}function Bet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b$ extends ea{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),bU(this,"previousSortState",void 0),bU(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,s)=>{s&&r.done(()=>new b$({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),s=i.isEnabled()?i:n;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function _U(t,e,r){return(e=Vet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vet(t){var e=Wet(t,"string");return typeof e=="symbol"?e:e+""}function Wet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _$ extends ea{constructor(e){let{index:r,amount:n}=e;super("insert_col"),_U(this,"index",void 0),_U(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,s)=>{r.done(()=>new _$({index:n,amount:i}),s)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function EU(t,e,r){return(e=jet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jet(t){var e=Uet(t,"string");return typeof e=="symbol"?e:e+""}function Uet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E$ extends ea{constructor(e){let{index:r,amount:n}=e;super("insert_row"),EU(this,"index",void 0),EU(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,s)=>{r.done(()=>new E$({index:n,amount:i}),s)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function fx(t,e,r){return(e=zet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zet(t){var e=Get(t,"string");return typeof e=="symbol"?e:e+""}function Get(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R$ extends ea{constructor(e){let{changes:r,selected:n,countCols:i,countRows:s}=e;super("change"),fx(this,"changes",void 0),fx(this,"selected",void 0),fx(this,"countCols",void 0),fx(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=s}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const s=n&&n.length;if(!s||!n.find(l=>{const[,,c,u]=l;return c!==u}))return;const a=()=>{const l=n.reduce((u,h)=>(u.push([...h]),u),[]);l.forEach(u=>{u[1]=e.propToCol(u[1])});const c=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new R$({changes:l,selected:c,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=ns(this.changes);for(let o=0,a=n.length;o<a;o++)n[o].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const n=ns(this.changes);for(let i=0,s=n.length;i<s;i++)n[i].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function RU(t,e,r){return(e=Yet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yet(t){var e=Ket(t,"string");return typeof e=="symbol"?e:e+""}function Ket(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T$ extends ea{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),RU(this,"conditionsStack",void 0),RU(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new T$({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function Xet(t,e,r){return(e=qet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qet(t){var e=Jet(t,"string");return typeof e=="symbol"?e:e+""}function Jet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k$ extends ea{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),Xet(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const s=n.getTopStartCorner(),o=n.getBottomEndCorner(),a=e.getData(s.row,s.col,o.row,o.col);r.done(()=>new k$({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function Pee(t,e,r,n,i){const s=["visualRow","visualCol","row","col","prop"],o=s.length,a=[];return je(n,i,l=>{je(e,r,c=>{const u=t.getCellMeta(c,l);if(Object.keys(u).length!==o){const h=Object.fromEntries(Object.entries(u).filter(f=>{let[d]=f;return s.includes(d)===!1}));a.push([u.visualRow,u.visualCol,h])}})}),a}function ac(t,e,r){return(e=Qet(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qet(t){var e=Zet(t,"string");return typeof e=="symbol"?e:e+""}function Zet(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P$ extends ea{constructor(e){let{index:r,indexes:n,data:i,amount:s,headers:o,columnPositions:a,rowPositions:l,fixedColumnsStart:c,removedCellMetas:u}=e;super("remove_col"),ac(this,"index",void 0),ac(this,"indexes",void 0),ac(this,"data",void 0),ac(this,"amount",void 0),ac(this,"headers",void 0),ac(this,"columnPositions",void 0),ac(this,"rowPositions",void 0),ac(this,"fixedColumnsStart",void 0),ac(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=s,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=c,this.removedCellMetas=u}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,s,o)=>{const a=()=>{const l=e.getSourceDataArray(),c=(e.countCols()+n)%e.countCols(),u=c+i-1,h=[],f=[],d=[];return je(l.length-1,g=>{const m=[],p=l[g];je(c,u,w=>{m.push(p[e.toPhysicalColumn(w)])}),h.push(m)}),je(i-1,g=>{d.push(e.toPhysicalColumn(c+g))}),Array.isArray(e.getSettings().colHeaders)&&je(i-1,g=>{f.push(e.getSettings().colHeaders[e.toPhysicalColumn(c+g)]||null)}),new P$({index:c,indexes:d,data:h,amount:i,headers:f,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:Pee(e,0,e.countRows(),c,u)})};r.done(a,o)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),s=(u,h,f)=>f[this.indexes.indexOf(i[h])],o=this.data.length,a=[];for(let u=0;u<o;u++)a.push(At(this.data[u],s));const l=At(this.headers,s),c=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),Z(e.getSourceDataArray(),(u,h)=>{Z(i,(f,d)=>{u[f]=a[h][d],c.push([h,f,u[f]])})}),typeof this.headers<"u"&&Z(l,(u,h)=>{e.getSettings().colHeaders[i[h]]=u}),this.removedCellMetas.forEach(u=>{let[h,f,d]=u;e.setCellMetaObject(h,f,d)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(c,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function em(t,e,r){return(e=ett(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ett(t){var e=ttt(t,"string");return typeof e=="symbol"?e:e+""}function ttt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A$ extends ea{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:s,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),em(this,"index",void 0),em(this,"data",void 0),em(this,"fixedRowsBottom",void 0),em(this,"fixedRowsTop",void 0),em(this,"rowIndexesSequence",void 0),em(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=s,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,s,o)=>{const a=()=>{const l=e.toPhysicalRow(n),c=l+i-1,u=ns(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new A$({index:l,data:u,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:Pee(e,l,c,0,e.countCols()-1)})};r.done(a,o)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);i.push([this.index+o,isNaN(l)?a:l,s[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;e.setCellMetaObject(o,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function TU(t,e,r){return(e=rtt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rtt(t){var e=ntt(t,"string");return typeof e=="symbol"?e:e+""}function ntt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I$ extends ea{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),TU(this,"rows",void 0),TU(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new I$({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),p$(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),n.moveRow(a,o)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function itt(t,e,r){return(e=stt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function stt(t){var e=ott(t,"string");return typeof e=="symbol"?e:e+""}function ott(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O$ extends ea{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),itt(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new O$({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function att(t,e){[S$,x$,b$,_$,E$,R$,T$,k$,P$,A$,I$,O$].forEach(r=>r.startRegisteringEvents(t,e))}function ltt(t,e){ctt(t,e),e.add(t)}function ctt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bI(t,e,r){return(e=utt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function utt(t){var e=htt(t,"string");return typeof e=="symbol"?e:e+""}function htt(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _I(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const kU="undoRedo",ftt="undoRedo",dtt=1e3;Fe.getSingleton().register("beforeUndo");Fe.getSingleton().register("afterUndo");Fe.getSingleton().register("beforeRedo");Fe.getSingleton().register("afterRedo");const PU=new Set;var dx=new WeakSet;class gtt extends Gt{static get PLUGIN_KEY(){return ftt}static get PLUGIN_PRIORITY(){return dtt}static get SETTING_KEYS(){return!0}constructor(e){super(e),ltt(this,dx),bI(this,"doneActions",[]),bI(this,"undoneActions",[]),bI(this,"ignoreNewActions",!1),att(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return _I(dx,e,mtt).call(e,...n)}),this.registerShortcuts(),_I(dx,this,ptt).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),_I(dx,this,vtt).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:kU};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kU)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const o=e(),a=this.undoneActions.slice();this.doneActions.push(o),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=ns(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=ns(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function mtt(t,e){e==="loadData"&&this.clear()}function ptt(){const t=e=>{PU.has(e)||(zt(Qt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),PU.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function vtt(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function wtt(){Dt(cw),Dt(SUe),Dt(uw),Dt(QUe),Dt(o5e),Dt(qQ),Dt(tze),Dt($ze),Dt(rT),Dt(Y9e),Dt(y7e),Dt(T7e),Dt(sT),Dt(cGe),Dt(iKe),Dt(HKe),Dt(uXe),Dt(xXe),Dt(NXe),Dt(zXe),Dt(tqe),Dt(yqe),Dt(kqe),Dt(SJe),Dt(ZJe),Dt(iQe),Dt(AQe),Dt(pZe),Dt($Ze),Dt(KZe),Dt(cet),Dt(wet),Dt(Aet),Dt(gtt)}function ytt(){z8e(),g6e(),b6e(),j6e(),wtt()}ytt();const ta=({title:t,sheetName:e,data:r,setData:n})=>{const i=me.useRef(null),[s,o]=me.useState(""),[a,l]=me.useState(""),c=E=>{l(E),setTimeout(()=>l(""),2e3)},u=()=>{var E;return(E=i.current)==null?void 0:E.hotInstance},h=()=>{const E=u();return E?E.getPlugin("CopyPaste")??null:null},f=E=>{const x=E.getSelected();if(!x)return null;const[P,A,O,Y]=x[0],B=Math.min(P,O),ie=Math.max(P,O),ue=Math.min(A,Y),he=Math.max(A,Y);return{r1:B,r2:ie,c1:ue,c2:he}},d=E=>{const x=f(E);if(!x)return"";const{r1:P,r2:A,c1:O,c2:Y}=x,B=[];for(let ie=P;ie<=A;ie++){const ue=[];for(let he=O;he<=Y;he++)ue.push(E.getDataAtCell(ie,he)??"");B.push(ue)}return B.map(ie=>ie.join("	")).join(`
`)},g=(E,x,P,A)=>{const O=x+A.length,Y=P+Math.max(0,...A.map(ue=>ue.length)),B=E.map(ue=>[...ue]),ie=Math.max(Y,Math.max(0,...B.map(ue=>ue.length)));for(let ue=0;ue<B.length;ue++)B[ue].length<ie&&(B[ue]=[...B[ue],...Array(ie-B[ue].length).fill("")]);for(;B.length<O;)B.push(Array(ie).fill(""));return B},m=E=>{var A;const x=(A=E.target.files)==null?void 0:A[0];if(!x)return;o(x.name);const P=new FileReader;P.onload=O=>{var ge;const Y=(ge=O.target)==null?void 0:ge.result;if(!Y)return;const B=hy(Y,{type:"array"}),ie=B.SheetNames[0],ue=B.Sheets[ie],he=th.sheet_to_json(ue,{header:1}),Ee=Math.max(0,...he.map(Q=>Q.length)),Ce=he.map(Q=>Array.from({length:Ee},(ye,Re)=>Q[Re]??""));n(Ce),c("Файл загружен")},P.readAsArrayBuffer(x)},p=()=>{const E=th.aoa_to_sheet(r),x=th.book_new();th.book_append_sheet(x,E,e),a_(x,`${e}.xlsx`),c("Файл экспортирован")},w=()=>{var E;n([...r,Array(((E=r[0])==null?void 0:E.length)||1).fill("")]),c("Строка добавлена")},v=()=>{r.length>1&&(n(r.slice(0,-1)),c("Строка удалена"))},y=async()=>{const E=h(),x=u();if(E&&x){E.copy(),c("Скопировано");return}if(x){const P=d(x);if(P)try{await navigator.clipboard.writeText(P),c("Скопировано")}catch{c("Не удалось скопировать")}}},b=async()=>{const E=h(),x=u();if(E&&x){E.cut(),c("Вырезано");return}if(x){const P=f(x),A=d(x);try{A&&await navigator.clipboard.writeText(A)}catch{}if(P){const{r1:O,r2:Y,c1:B,c2:ie}=P,ue=r.map(he=>[...he]);for(let he=O;he<=Y;he++)for(let Ee=B;Ee<=ie;Ee++)ue[he]||(ue[he]=[]),ue[he][Ee]="";n(ue)}c("Вырезано")}},T=async()=>{const E=h(),x=u();if(x)try{const P=await navigator.clipboard.readText();if(E&&typeof E.paste=="function"){E.paste(P),c("Вставлено");return}const A=P.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).map(ue=>ue.split("	")),O=x.getSelected();if(!O)return;const[Y,B]=O[0];let ie=g(r,Y,B,A);A.forEach((ue,he)=>{ue.forEach((Ee,Ce)=>{const ge=Y+he,Q=B+Ce;ie[ge]||(ie[ge]=[]),ie[ge][Q]=Ee})}),n(ie),c("Вставлено")}catch(P){console.error("Ошибка чтения буфера обмена:",P),c("Не удалось вставить")}};return F.jsxs("div",{children:[F.jsx("h3",{style:{marginBottom:10},children:t}),F.jsx(lQ,{ref:i,data:r,colHeaders:!0,rowHeaders:!0,width:"100%",height:"400px",stretchH:"all",autoColumnSize:!0,licenseKey:"non-commercial-and-evaluation",copyPaste:!0,afterChange:(E,x)=>{x!=="loadData"&&E&&n([...r])}}),F.jsxs("div",{style:{marginTop:15,display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[F.jsxs("label",{style:{cursor:"pointer"},children:[F.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:m,style:{display:"none"}}),F.jsx("span",{style:{padding:"6px 12px",border:"1px solid #ccc",borderRadius:4},children:"Выберите файл"})]}),s&&F.jsxs("span",{style:{fontSize:14},children:["📄 ",s]}),F.jsx("button",{onClick:p,children:"Экспорт текущей"}),F.jsx("button",{onClick:w,children:"Добавить строку"}),F.jsx("button",{onClick:v,children:"Удалить строку"}),F.jsx("button",{onClick:y,children:"Скопировать"}),F.jsx("button",{onClick:b,children:"Вырезать"}),F.jsx("button",{onClick:T,children:"Вставить"})]}),a&&F.jsx("div",{style:{position:"fixed",bottom:20,right:20,background:"#333",color:"#fff",padding:"10px 15px",borderRadius:8,fontSize:14,boxShadow:"0 2px 6px rgba(0,0,0,0.3)",opacity:.95,zIndex:9999},children:a})]})},AU=({data:t,setData:e})=>F.jsx(ta,{title:"Основное",sheetName:"Основное",data:t,setData:e}),Ctt=({data:t,setData:e})=>F.jsx(ta,{title:"Каталог скважин",sheetName:"Каталог скважин",data:t,setData:e}),Stt=({data:t,setData:e})=>F.jsx(ta,{title:"Каталог скважин для термометрии",sheetName:"Каталог термоскважин",data:t,setData:e}),xtt=({data:t,setData:e})=>F.jsx(ta,{title:"Каталог ВЭЗ",sheetName:"Каталог ВЭЗ",data:t,setData:e}),btt=({data:t,setData:e})=>F.jsx(ta,{title:"Каталог БТ",sheetName:"Каталог БТ",data:t,setData:e}),_tt=({data:t,setData:e})=>F.jsx(ta,{title:"Литологический разрез",sheetName:"Литология",data:t,setData:e}),Ett=({data:t,setData:e})=>F.jsx(ta,{title:"Данные термометрии",sheetName:"Термометрия",data:t,setData:e}),Rtt=({data:t,setData:e})=>F.jsx(ta,{title:"Данные ВЭЗ",sheetName:"Данные ВЭЗ",data:t,setData:e}),Ttt=({data:t,setData:e})=>F.jsx(ta,{title:"Данные БТ",sheetName:"Данные БТ",data:t,setData:e}),ktt=({data:t,setData:e})=>F.jsx(ta,{title:"Региональные данные",sheetName:"Региональные",data:t,setData:e}),Ptt=({data:t,setData:e})=>F.jsx(ta,{title:"Перечень ИГЭ",sheetName:"ИГЭ",data:t,setData:e}),Att=({data:t,setData:e})=>F.jsx(ta,{title:"Выводы",sheetName:"Выводы",data:t,setData:e}),EI="my-profgeo-tables",IU=["Основное","Каталог скважин","Каталог скважин для термометрии","Каталог ВЭЗ","Каталог БТ","Литологический разрез","Данные термометрии","Данные ВЭЗ","Данные БТ","Региональные данные","Перечень ИГЭ","Выводы"],OU=[[["ID","Название","Описание"],[1,"Проект А","Основные данные"]],[["ID","Скважина","Глубина"]],[["ID","Скважина термо","Глубина"]],[["ID","ВЭЗ"]],[["ID","БТ"]],[["ID","Литология"]],[["ID","Температура"]],[["ID","Данные ВЭЗ"]],[["ID","Данные БТ"]],[["ID","Регион"]],[["ID","ИГЭ"]],[["Выводы"]]],Itt=()=>{const[t,e]=me.useState(0),[r,n]=me.useState(OU);me.useEffect(()=>{const l=localStorage.getItem(EI);if(l)try{const c=JSON.parse(l);Array.isArray(c)&&n(c)}catch(c){console.error("Ошибка загрузки данных из localStorage:",c)}},[]),me.useEffect(()=>{localStorage.setItem(EI,JSON.stringify(r))},[r]);const i=(l,c)=>{n(u=>{const h=[...u];return h[l]=c,h})},s=()=>{const l=th.book_new();r.forEach((c,u)=>{const h=th.aoa_to_sheet(c);th.book_append_sheet(l,h,IU[u])}),a_(l,"all_tables.xlsx")},o=()=>{window.confirm("Вы уверены, что хотите очистить все таблицы?")&&(n(OU),localStorage.removeItem(EI))},a=()=>{const l={data:r[t],setData:c=>i(t,c)};switch(t){case 0:return F.jsx(AU,{...l});case 1:return F.jsx(Ctt,{...l});case 2:return F.jsx(Stt,{...l});case 3:return F.jsx(xtt,{...l});case 4:return F.jsx(btt,{...l});case 5:return F.jsx(_tt,{...l});case 6:return F.jsx(Ett,{...l});case 7:return F.jsx(Rtt,{...l});case 8:return F.jsx(Ttt,{...l});case 9:return F.jsx(ktt,{...l});case 10:return F.jsx(Ptt,{...l});case 11:return F.jsx(Att,{...l});default:return F.jsx(AU,{...l})}};return F.jsxs("div",{style:{padding:20},children:[F.jsx("div",{style:{display:"flex",overflowX:"auto",marginBottom:15,gap:"10px"},children:IU.map((l,c)=>F.jsx("button",{onClick:()=>e(c),style:{padding:"8px 12px",background:t===c?"#1976d2":"#eee",color:t===c?"#fff":"#000",borderRadius:6,cursor:"pointer"},children:l},c))}),a(),F.jsxs("div",{style:{marginTop:20,display:"flex",gap:10},children:[F.jsx("button",{onClick:s,children:"Экспортировать все таблицы"}),F.jsx("button",{onClick:o,style:{background:"#e53935",color:"#fff"},children:"Сбросить все данные"})]})]})},Ott=()=>F.jsxs("div",{className:"min-h-screen flex flex-col",children:[F.jsx(Poe,{}),F.jsx(Aoe,{}),F.jsxs(_ie,{children:[F.jsx(Wi,{path:"/",element:F.jsx(Aue,{})}),F.jsx(Wi,{path:"/login",element:F.jsx(lhe,{})}),F.jsx(Wi,{path:"/register",element:F.jsx(fhe,{})}),F.jsxs(Wi,{path:"/lk",element:F.jsx(j3,{children:F.jsx(Koe,{})}),children:[F.jsx(Wi,{index:!0,element:F.jsx(gce,{})}),F.jsx(Wi,{path:"objects",element:F.jsx(bue,{})}),F.jsx(Wi,{path:"objects/create",element:F.jsx(_ue,{})}),F.jsx(Wi,{path:"account",element:F.jsx(Eue,{})}),F.jsx(Wi,{path:"subscription",element:F.jsx(Rue,{})}),F.jsx(Wi,{path:"users",element:F.jsx(Tue,{})}),F.jsx(Wi,{path:"settings",element:F.jsx(kue,{})})]}),F.jsx(Wi,{path:"/work",element:F.jsx(j3,{children:F.jsx(oae,{})}),children:F.jsx(Wi,{path:"app1",element:F.jsx(Itt,{})})}),F.jsx(Wi,{path:"*",element:F.jsx("div",{style:{padding:24},children:"Страница не найдена"})})]}),F.jsx(bse,{position:"bottom-right",autoClose:5e3})]});var M$="persist:",N$="persist/FLUSH",uT="persist/REHYDRATE",D$="persist/PAUSE",F$="persist/PERSIST",H$="persist/PURGE",L$="persist/REGISTER",Mtt=-1;function cb(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cb=function(r){return typeof r}:cb=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},cb(t)}function MU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ntt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MU(r,!0).forEach(function(n){Dtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MU(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Dtt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ftt(t,e,r,n){n.debug;var i=Ntt({},r);return t&&cb(t)==="object"&&Object.keys(t).forEach(function(s){s!=="_persist"&&e[s]===r[s]&&(i[s]=t[s])}),i}function Htt(t){var e=t.blacklist||null,r=t.whitelist||null,n=t.transforms||[],i=t.throttle||0,s="".concat(t.keyPrefix!==void 0?t.keyPrefix:M$).concat(t.key),o=t.storage,a;t.serialize===!1?a=function(T){return T}:typeof t.serialize=="function"?a=t.serialize:a=Ltt;var l=t.writeFailHandler||null,c={},u={},h=[],f=null,d=null,g=function(T){Object.keys(T).forEach(function(E){w(E)&&c[E]!==T[E]&&h.indexOf(E)===-1&&h.push(E)}),Object.keys(c).forEach(function(E){T[E]===void 0&&w(E)&&h.indexOf(E)===-1&&c[E]!==void 0&&h.push(E)}),f===null&&(f=setInterval(m,i)),c=T};function m(){if(h.length===0){f&&clearInterval(f),f=null;return}var b=h.shift(),T=n.reduce(function(E,x){return x.in(E,b,c)},c[b]);if(T!==void 0)try{u[b]=a(T)}catch(E){console.error("redux-persist/createPersistoid: error serializing state",E)}else delete u[b];h.length===0&&p()}function p(){Object.keys(u).forEach(function(b){c[b]===void 0&&delete u[b]}),d=o.setItem(s,a(u)).catch(v)}function w(b){return!(r&&r.indexOf(b)===-1&&b!=="_persist"||e&&e.indexOf(b)!==-1)}function v(b){l&&l(b)}var y=function(){for(;h.length!==0;)m();return d||Promise.resolve()};return{update:g,flush:y}}function Ltt(t){return JSON.stringify(t)}function $tt(t){var e=t.transforms||[],r="".concat(t.keyPrefix!==void 0?t.keyPrefix:M$).concat(t.key),n=t.storage;t.debug;var i;return t.deserialize===!1?i=function(o){return o}:typeof t.deserialize=="function"?i=t.deserialize:i=Btt,n.getItem(r).then(function(s){if(s)try{var o={},a=i(s);return Object.keys(a).forEach(function(l){o[l]=e.reduceRight(function(c,u){return u.out(c,l,a)},i(a[l]))}),o}catch(l){throw l}else return})}function Btt(t){return JSON.parse(t)}function Vtt(t){var e=t.storage,r="".concat(t.keyPrefix!==void 0?t.keyPrefix:M$).concat(t.key);return e.removeItem(r,Wtt)}function Wtt(t){}function NU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function lc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NU(r,!0).forEach(function(n){jtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NU(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jtt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Utt(t,e){if(t==null)return{};var r=ztt(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ztt(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var Gtt=5e3;function Ytt(t,e){var r=t.version!==void 0?t.version:Mtt;t.debug;var n=t.stateReconciler===void 0?Ftt:t.stateReconciler,i=t.getStoredState||$tt,s=t.timeout!==void 0?t.timeout:Gtt,o=null,a=!1,l=!0,c=function(h){return h._persist.rehydrated&&o&&!l&&o.update(h),h};return function(u,h){var f=u||{},d=f._persist,g=Utt(f,["_persist"]),m=g;if(h.type===F$){var p=!1,w=function(P,A){p||(h.rehydrate(t.key,P,A),p=!0)};if(s&&setTimeout(function(){!p&&w(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},s),l=!1,o||(o=Htt(t)),d)return lc({},e(m,h),{_persist:d});if(typeof h.rehydrate!="function"||typeof h.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return h.register(t.key),i(t).then(function(x){var P=t.migrate||function(A,O){return Promise.resolve(A)};P(x,r).then(function(A){w(A)},function(A){w(void 0,A)})},function(x){w(void 0,x)}),lc({},e(m,h),{_persist:{version:r,rehydrated:!1}})}else{if(h.type===H$)return a=!0,h.result(Vtt(t)),lc({},e(m,h),{_persist:d});if(h.type===N$)return h.result(o&&o.flush()),lc({},e(m,h),{_persist:d});if(h.type===D$)l=!0;else if(h.type===uT){if(a)return lc({},m,{_persist:lc({},d,{rehydrated:!0})});if(h.key===t.key){var v=e(m,h),y=h.payload,b=n!==!1&&y!==void 0?n(y,u,v,t):v,T=lc({},b,{_persist:lc({},d,{rehydrated:!0})});return c(T)}}}if(!d)return e(u,h);var E=e(m,h);return E===m?u:c(lc({},E,{_persist:d}))}}function DU(t){return qtt(t)||Xtt(t)||Ktt()}function Ktt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Xtt(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function qtt(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function FU(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function P2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?FU(r,!0).forEach(function(n){Jtt(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):FU(r).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jtt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Aee={registry:[],bootstrapped:!1},Qtt=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Aee,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case L$:return P2({},e,{registry:[].concat(DU(e.registry),[r.key])});case uT:var n=e.registry.indexOf(r.key),i=DU(e.registry);return i.splice(n,1),P2({},e,{registry:i,bootstrapped:i.length===0});default:return e}};function Ztt(t,e,r){var n=kN(Qtt,Aee,void 0),i=function(l){n.dispatch({type:L$,key:l})},s=function(l,c,u){var h={type:uT,payload:c,err:u,key:l};t.dispatch(h),n.dispatch(h)},o=P2({},n,{purge:function(){var l=[];return t.dispatch({type:H$,result:function(u){l.push(u)}}),Promise.all(l)},flush:function(){var l=[];return t.dispatch({type:N$,result:function(u){l.push(u)}}),Promise.all(l)},pause:function(){t.dispatch({type:D$})},persist:function(){t.dispatch({type:F$,register:i,rehydrate:s})}});return o.persist(),o}var $$={},B$={};B$.__esModule=!0;B$.default=rrt;function ub(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ub=function(r){return typeof r}:ub=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ub(t)}function RI(){}var ert={getItem:RI,setItem:RI,removeItem:RI};function trt(t){if((typeof self>"u"?"undefined":ub(self))!=="object"||!(t in self))return!1;try{var e=self[t],r="redux-persist ".concat(t," test");e.setItem(r,"test"),e.getItem(r),e.removeItem(r)}catch{return!1}return!0}function rrt(t){var e="".concat(t,"Storage");return trt(e)?self[e]:ert}$$.__esModule=!0;$$.default=srt;var nrt=irt(B$);function irt(t){return t&&t.__esModule?t:{default:t}}function srt(t){var e=(0,nrt.default)(t);return{getItem:function(n){return new Promise(function(i,s){i(e.getItem(n))})},setItem:function(n,i){return new Promise(function(s,o){s(e.setItem(n,i))})},removeItem:function(n){return new Promise(function(i,s){i(e.removeItem(n))})}}}var Iee=void 0,ort=art($$);function art(t){return t&&t.__esModule?t:{default:t}}var lrt=(0,ort.default)("local");Iee=lrt;const crt=S9({auth:poe,objectForm:jle}),urt={key:"root",storage:Iee,whitelist:["auth"]},hrt=Ytt(urt,crt),Oee=Kse({reducer:hrt,middleware:t=>t({serializableCheck:{ignoredActions:[N$,uT,D$,F$,H$,L$]}})}),frt=Ztt(Oee),drt="/my-profgeo-app",grt=TI.createRoot(document.getElementById("root"));grt.render(F.jsx(Ge.StrictMode,{children:F.jsx(kne,{store:Oee,children:F.jsx(d9,{loading:null,persistor:frt,children:F.jsx(Oie,{basename:drt,children:F.jsx(Ott,{})})})})}))});export default mrt();
